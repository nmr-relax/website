<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: r25100 &#45; /trunk/gui/analyses/auto_relax_disp.py -->
<!--X-From-R13: "Sqjneq q'Ohiretar" &#60;rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Wed, 20 Aug 2014 17:07:59 +0200 -->
<!--X-Message-Id: CAED9pY_Mpc4B1E6cH=dzbJHW0BbZ8ca+hQjXsjZKPsMEdReTXw@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: E1XK6a4&#45;0003BY&#45;Kl@subversion.gna.org -->
<!--X-Reference: CAED9pY92CregSDcsmZ=dKVC8nLM9uo&#45;5&#45;H&#45;JFt+Cz5q5_1KUtw@mail.gmail.com -->
<!--X-Reference: CA+CBx2PnMGoMy8O89No&#45;gC=pBxw92GwtmaqKsnYccF=pDb9s&#45;Q@mail.gmail.com -->
<!--X-Reference: CAED9pY_k&#45;3vT+orhuCRsuq3uRXaf35LDjQ4c&#45;euDT&#45;vxGLR9bQ@mail.gmail.com -->
<!--X-Reference: CA+CBx2N_kjW=RnE0n9ziBaBN5dZuQEhqBpWuza5TctqNsVjy2w@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: r25100 - /trunk/gui/analyses/auto_relax_disp.py -- August 20, 2014 - 17:07</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: r25100 - /trunk/gui/analyses/auto_relax_disp.py</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00181" class="tabs">Index by Date</a> | <a href="threads.html#00181" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00180.html">Date Prev</a>] [<a href="msg00182.html">Date Next</a>] [<a href="msg00180.html">Thread Prev</a>] [<a href="msg00182.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Wed, 20 Aug 2014 17:07:28 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113; h=mime-version:sender:in-reply-to:references:date:message-id:subject :from:to:cc:content-type:content-transfer-encoding; bh=DD3w7BFx533ITmXwcvRz9wYEFiAZ5x+UiFfDJQesoIs=; b=JKU/hqCFvBV9RWnLfM/Yl4NNjD+rUN6mY5bLhkmAod2121aegLbYhXcd33jBfBM/Sz j7zKuPSjdAd45DOp/DN1963GyOkoxwEBgi2PpEhjx+uq/pNMN2wmbzeRt3+6arK/mJ+I O4eML1V2nUKd/HwxgOW9NGPWZ49GwtNFxqyXz9F0/bnW/WY8N/1E4ZSmoYTb5MyRGAsQ na9bhH5LtCA5p2bSQu2xUdnbTGecq1R3ob4CKOaYElh0+q+ZLzcMoPZ7i/VW+oKG0Xoh aSOOj6Hr4hgsAxeobift8Mq56R6Lqclz5spAcL4+n4idqnqbYJpFyVD6wCfgV66QiuxE X59w==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;CAED9pY_Mpc4B1E6cH=dzbJHW0BbZ8ca+hQjXsjZKPsMEdReTXw@mail.gmail.com&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;E1XK6a4-0003BY-Kl@subversion.gna.org&gt; &lt;CAED9pY92CregSDcsmZ=dKVC8nLM9uo-5-H-JFt+Cz5q5_1KUtw@mail.gmail.com&gt; &lt;CA+CBx2PnMGoMy8O89No-gC=pBxw92GwtmaqKsnYccF=pDb9s-Q@mail.gmail.com&gt; &lt;<a href="msg00179.html">CAED9pY_k-3vT+orhuCRsuq3uRXaf35LDjQ4c-euDT-vxGLR9bQ@mail.gmail.com</a>&gt; &lt;CA+CBx2N_kjW=RnE0n9ziBaBN5dZuQEhqBpWuza5TctqNsVjy2w@mail.gmail.com&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on August 20, 2014 - 17:07:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi,

Not loading the R1 data and then fitting it is good, especially if it
is automatic.  As long as a RelaxWarning is printed out to inform the
user.  The target function switching is much simpler than the model
name translation.  For example simply send in a r1_fit flag to the
target function __init__() method and then add some more if statements
to the end of that method.  It would make it even more automatic from
the perspective of the user.

As I said, you've already done the hard part.  The infrastructure you
added is there now for handling this.  You have implemented all
required target functions and associated functions for handling the R1
fitting.  The changes we are discussing are trivial in comparison.

Regards,

Edward



On 20 August 2014 16:56, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Edward.

I actually think it is a quite elegant solution, that if one does not
load R1 data, then the R1 parameter is fitted.

I think it is a better solution than the previous suggestion.

It involves less coding, and the logic is sound.

And the system is still &quot;open&quot; for weird stuff, whereby you by
scripting can analyse with and without fitting R1 in same analyses.

I think this is best.

But in the end. Potato, tomato.
If this solution prevents any further implementation, then this could
also be done.

Best
Troels


2014-08-20 16:48 GMT+02:00 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">An easy system test would be to load a set of CPMG data and a set of
R1rho data, and then see if this can be analysed assuming no exchange
via the 'No Rex' models.  There are no other models for this yet, but
it would show what is missing.  You've added the infrastructure which
is the hardest part.  What remains to allow this is actually not much
at all now that the infrastructure is in place.  Just a bit of gluing
code.

On a related note, what is your opinion on the suggestions you made in
sr #3135 at <a  rel="nofollow" href="https://gna.org/support/?3135#comment0">https://gna.org/support/?3135#comment0</a> &quot;Optimisation of
the R1 relaxation rate for the off-resonance R1rho relaxation
dispersion models.&quot;?  Namely that we let the user choose if R1 values
are optimised or not for off-resonance data, whether or not R1 values
were loaded.  So then the '* R1 fit' models are merged into the
non-fitted models, and the target function switching occurs without
the user knowing.  You should note that the target function switching
is far simpler than the current model name translation system.  It
just requires a few more if statements at the end of the target
function __init__() method to alias the correct self.func_*() method.

Regards,

Edward


On 20 August 2014 16:36, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt; 
wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Edward.

I think I in the start tried following this path.

But I realised with all the &quot;R1 fit&quot; models, that the very important,
relax_disp.select_model(model)

setup all information for this model.

As this was also a new model implementation, I also wanted the
flexibility to be able to select the desired model, and
be able to compare.

I would suggest that this functionality is not digged further down the
code, before more experience is collected.

Best
Troels



2014-08-20 16:22 GMT+02:00 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

What would be even more powerful would be to shift this functionality
even deeper down and merging the 'No Rex' and 'No Rex R1rho off res'
models into one, just as the 'R2eff' model covers both the exponential
curve-fitting via minimisation and the two-point approximation by
calculation.  Rather than switching the model name for the user, the
target function can be switched.  The 'No Rex R1 fit' model could then
be created (by simply renaming 'No Rex R1rho off res R1 fit') and this
would then eventually handle CPMG data as well.

The reason for this is simple.  In the future, certain interested
parties (you probably know who) plans on developing a combined CPMG
and R1rho model and on analysing this data together.  This will need a
'No Rex' model for statistical comparisons.  The splitting of 'No Rex'
into two models as is currently coded is incompatible with this.  A
'No Rex' model which has a loop over experiment types &quot;for ei in
range(self.NE):&quot; switching to the different functionality would be a
better solution.

Regards,

Edward


On 20 August 2014 16:09,  &lt;tlinnet@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Author: tlinnet
Date: Wed Aug 20 16:09:40 2014
New Revision: 25100

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=25100&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=25100&amp;view=rev</a>
Log:
Made the GUI selection of models for relaxation dispersion more simple.

After the implementation of a function which will translate the models, 
the
'No Rex' model will be converted to the 'No Rex' model for R1rho 
off-resonance.

Also the corresponding 'R1 fit' model will be chosen istead, if R1 data 
has not been loaded.

This makes the model selection easier in the GUI interface.

Modified:
    trunk/gui/analyses/auto_relax_disp.py

Modified: trunk/gui/analyses/auto_relax_disp.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/gui/analyses/auto_relax_disp.py?rev=25100&amp;r1=25099&amp;r2=25100&amp;view=diff">http://svn.gna.org/viewcvs/relax/trunk/gui/analyses/auto_relax_disp.py?rev=25100&amp;r1=25099&amp;r2=25100&amp;view=diff</a>
==============================================================================
--- trunk/gui/analyses/auto_relax_disp.py       (original)
+++ trunk/gui/analyses/auto_relax_disp.py       Wed Aug 20 16:09:40 2014
@@ -715,8 +715,8 @@
         MODEL_R2EFF,
         None,
         MODEL_NOREX,
-        MODEL_NOREX_R1RHO,
-        MODEL_NOREX_R1RHO_FIT_R1,
+#        MODEL_NOREX_R1RHO,
+#        MODEL_NOREX_R1RHO_FIT_R1,
         None,
         MODEL_LM63,
         MODEL_LM63_3SITE,
@@ -735,15 +735,15 @@
         MODEL_M61,
         MODEL_M61B,
         MODEL_DPL94,
-        MODEL_DPL94_FIT_R1,
+#        MODEL_DPL94_FIT_R1,
         MODEL_TP02,
-        MODEL_TP02_FIT_R1,
+#        MODEL_TP02_FIT_R1,
         MODEL_TAP03,
-        MODEL_TAP03_FIT_R1,
+#        MODEL_TAP03_FIT_R1,
         MODEL_MP05,
-        MODEL_MP05_FIT_R1,
+#        MODEL_MP05_FIT_R1,
         MODEL_NS_R1RHO_2SITE,
-        MODEL_NS_R1RHO_2SITE_FIT_R1,
+#        MODEL_NS_R1RHO_2SITE_FIT_R1,
         MODEL_NS_R1RHO_3SITE_LINEAR,
         MODEL_NS_R1RHO_3SITE,
         None,
@@ -756,8 +756,8 @@
         &quot;{%s/%s, %s}&quot; % (r2eff, r1rho, i0),
         None,
         &quot;{%s, ...}&quot; % (r2),
-        &quot;{%s, ...}&quot; % (r2),
-        &quot;{%s, %s, ...}&quot; % (r1, r2),
+#        &quot;{%s, ...}&quot; % (r2),
+#        &quot;{%s, %s, ...}&quot; % (r1, r2),
         None,
         &quot;{%s, ..., %s, %s}&quot; % (r2, phi_ex, kex),
         &quot;{%s, ..., %s, kB, %s, kC}&quot; % (r2, phi_exB, phi_exC),
@@ -776,15 +776,15 @@
         &quot;{%s, ..., %s, %s}&quot; % (r1rho_prime, phi_ex, kex),
         &quot;{%s, ..., pA, %s, %s}&quot; % (r1rho_prime, dw, kex),
         &quot;{%s, ..., %s, %s}&quot; % (r1rho_prime, phi_ex, kex),
-        &quot;{%s, %s, ..., %s, %s}&quot; % (r1, r1rho_prime, phi_ex, kex),
+#        &quot;{%s, %s, ..., %s, %s}&quot; % (r1, r1rho_prime, phi_ex, kex),
         &quot;{%s, ..., pA, %s, %s}&quot; % (r1rho_prime, dw, kex),
-        &quot;{%s, %s, ..., pA, %s, %s}&quot; % (r1, r1rho_prime, dw, kex),
+#        &quot;{%s, %s, ..., pA, %s, %s}&quot; % (r1, r1rho_prime, dw, kex),
         &quot;{%s, ..., pA, %s, %s}&quot; % (r1rho_prime, dw, kex),
-        &quot;{%s, %s, ..., pA, %s, %s}&quot; % (r1, r1rho_prime, dw, kex),
+#        &quot;{%s, %s, ..., pA, %s, %s}&quot; % (r1, r1rho_prime, dw, kex),
         &quot;{%s, ..., pA, %s, %s}&quot; % (r1rho_prime, dw, kex),
-        &quot;{%s, %s, ..., pA, %s, %s}&quot; % (r1, r1rho_prime, dw, kex),
+#        &quot;{%s, %s, ..., pA, %s, %s}&quot; % (r1, r1rho_prime, dw, kex),
         &quot;{%s, ..., pA, %s, %s}&quot; % (r1rho_prime, dw, kex),
-        &quot;{%s, %s, ..., pA, %s, %s}&quot; % (r1, r1rho_prime, dw, kex),
+#        &quot;{%s, %s, ..., pA, %s, %s}&quot; % (r1, r1rho_prime, dw, kex),
         &quot;{%s, ..., pA, %s, %s, pB, %s, %s}&quot; % (r1rho_prime, dw_AB, 
kAB, dw_BC, kBC),
         &quot;{%s, ..., pA, %s, %s, pB, %s, %s, %s}&quot; % (r1rho_prime, dw_AB, 
kAB, dw_BC, kBC, kAC),
         None,
@@ -797,8 +797,8 @@
         &quot;The base model for determining the %s/%s values and errors 
for all other models.&quot; % (r2eff, r1rho),
         None,
         &quot;The model for no chemical exchange relaxation.&quot;,
-        &quot;The model for no chemical exchange being present, for 
off-resonance R1rho-type experiments.  R1rho = R1 * cos(theta)^2 + 
r1rho_prime * sin(theta)^2.&quot;,
-        &quot;The model for no chemical exchange being present, for 
off-resonance R1rho-type experiments whereby R1 is fit.  R1rho = R1 * 
cos(theta)^2 + r1rho_prime * sin(theta)^2.&quot;,
+#        &quot;The model for no chemical exchange being present, for 
off-resonance R1rho-type experiments.  R1rho = R1 * cos(theta)^2 + 
r1rho_prime * sin(theta)^2.&quot;,
+#        &quot;The model for no chemical exchange being present, for 
off-resonance R1rho-type experiments whereby R1 is fit.  R1rho = R1 * 
cos(theta)^2 + r1rho_prime * sin(theta)^2.&quot;,
         None,
         &quot;The original Luz and Meiboom (1963) 2-site fast exchange 
equation.&quot;,
         &quot;The original Luz and Meiboom (1963) 3-site fast exchange 
equation.&quot;,
@@ -817,15 +817,15 @@
         &quot;The Meiboom (1961) 2-site fast exchange equation.&quot;,
         &quot;The Meiboom (1961) 2-site equation for all time scales with 
pA &gt;&gt; pB.&quot;,
         &quot;The Davis, Perlman and London (1994) 2-site fast exchange 
equation.&quot;,
-        &quot;The Davis, Perlman and London (1994) 2-site fast exchange 
equation, whereby R1 is fit.&quot;,
+#        &quot;The Davis, Perlman and London (1994) 2-site fast exchange 
equation, whereby R1 is fit.&quot;,
         &quot;The Trott and Palmer (2002) 2-site equation for all time 
scales.&quot;,
-        &quot;The Trott and Palmer (2002) 2-site equation for all time 
scales, whereby R1 is fit.&quot;,
+#        &quot;The Trott and Palmer (2002) 2-site equation for all time 
scales, whereby R1 is fit.&quot;,
         &quot;The Trott, Abergel and Palmer (2003) off-resonance 2-site 
equation for all time scales.&quot;,
-        &quot;The Trott, Abergel and Palmer (2003) off-resonance 2-site 
equation for all time scales, whereby R1 is fit.&quot;,
+#        &quot;The Trott, Abergel and Palmer (2003) off-resonance 2-site 
equation for all time scales, whereby R1 is fit.&quot;,
         &quot;The Miloushev and Palmer (2005) off-resonance 2-site equation 
for all time scales.&quot;,
-        &quot;The Miloushev and Palmer (2005) off-resonance 2-site equation 
for all time scales, whereby R1 is fit.&quot;,
+#        &quot;The Miloushev and Palmer (2005) off-resonance 2-site 
equation for all time scales, whereby R1 is fit.&quot;,
         &quot;The 2-site numerical solution using 3D magnetisation 
vectors.&quot;,
-        &quot;The 2-site numerical solution using 3D magnetisation vectors, 
whereby R1 is fit.&quot;,
+#        &quot;The 2-site numerical solution using 3D magnetisation 
vectors, whereby R1 is fit.&quot;,
         &quot;The 3-site linearised numerical solution using 3D 
magnetisation vectors.&quot;,
         &quot;The 3-site numerical solution using 3D magnetisation 
vectors.&quot;,
         None,


_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-commits mailing list
relax-commits@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-commits">https://mail.gna.org/listinfo/relax-commits</a>
</pre></blockquote><pre style="margin: 0em;">

_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-devel mailing list
relax-devel@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a>
</pre></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00182" href="msg00182.html">Re: r25100 - /trunk/gui/analyses/auto_relax_disp.py</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00175" href="msg00175.html">Re: r25100 - /trunk/gui/analyses/auto_relax_disp.py</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00178" href="msg00178.html">Re: r25100 - /trunk/gui/analyses/auto_relax_disp.py</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00179" href="msg00179.html">Re: r25100 - /trunk/gui/analyses/auto_relax_disp.py</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00180" href="msg00180.html">Re: r25100 - /trunk/gui/analyses/auto_relax_disp.py</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Wed Aug 20 17:20:15 2014</div>  
</body>
</html>
