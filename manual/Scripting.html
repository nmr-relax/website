<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.1//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Scripting</TITLE>
<META NAME="description" CONTENT="Scripting">
<META NAME="keywords" CONTENT="relax">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">

  <!--Google analytics JS-->
  <script type="text/javascript">
  
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30096326-1']);
    _gaq.push(['_setDomainName', 'nmr-relax.com']);
    _gaq.push(['_trackPageview']);
  
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  
  </script>

<LINK REL="STYLESHEET" HREF="relax.css">

<LINK REL="next" HREF="The_test_suite.html">
<LINK REL="previous" HREF="The_spin_and_interatomic_data_containers.html">
<LINK REL="up" HREF="How_to_use_relax.html">
<LINK REL="next" HREF="The_test_suite.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html5172"
  HREF="The_test_suite.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Next" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html5166"
  HREF="How_to_use_relax.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Up" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html5160"
  HREF="The_spin_and_interatomic_data_containers.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Previous" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html5168"
  HREF="Contents.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Contents" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html5170"
  HREF="Index.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Index" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html1"
  HREF="http://download.gna.org/relax/manual/relax.pdf"><IMG
 ALIGN="BOTTOM" BORDER="0" SRC="http://www.nmr-relax.com/images/pdf_icon_nav.png"
 ALT="pdf_icon_nav.png"></A><A NAME="tex2html2"
  HREF="http://www.nmr-relax.com"><IMG
 ALIGN="BOTTOM" BORDER="0" SRC="http://www.nmr-relax.com/images/relax_logo_nav.png"
 ALT="relax_logo_nav.png"></A>
<BR>
<B> Next:</B> <A NAME="tex2html5173"
  HREF="The_test_suite.html">The test suite</A>
<B> Up:</B> <A NAME="tex2html5167"
  HREF="How_to_use_relax.html">How to use relax</A>
<B> Previous:</B> <A NAME="tex2html5161"
  HREF="The_spin_and_interatomic_data_containers.html">The spin and interatomic</A>
 &nbsp; <B>  <A NAME="tex2html5169"
  HREF="Contents.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html5171"
  HREF="Index.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><A NAME="tex2html5174"
  HREF="Scripting.html#SECTION04128100000000000000">Sample scripts</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H2><A NAME="SECTION04128000000000000000"></A> <A NAME="sect:_scripting"></A><A NAME="1785"></A>
<BR>
Scripting
</H2>

<P>
What ever is done within the prompt is also accessible through scripting (Figure&nbsp;<A HREF="Python.html#fig:_relax_script">1.2</A>).
First type your commands into a text file ending in <TT>*.py</TT>.
To use this mode of relax, you will need to open up a terminal in your respective operating system:
<DL>
<DT><STRONG>GNU/Linux:</STRONG></DT>
<DD>Here you have an incredible number of choices.
    If you don't have a preferred shell already, you could try one of <TT>Konsole</TT>, <TT>GNOME Terminal</TT> or even <TT>XTerm</TT> if you are a masochist.
  
</DD>
<DT><STRONG>Mac OS X:</STRONG></DT>
<DD>This is as simple as in GNU/Linux - just launch <TT>Terminal.app</TT> from the <TT>Utilities</TT> folder.
  
</DD>
<DT><STRONG>MS Windows:</STRONG></DT>
<DD>If your system supports it, you should install and use <TT>Windows PowerShell</TT>.
    The alternative is the nasty <TT>cmd</TT> command line terminal program which comes installed by default on all Windows versions.
    The <TT>PowerShell</TT>, although no where near as powerful as the Linux and Mac terminals, is a huge improvement on the ancient <TT>cmd</TT> program and will make relax much better to use on MS Windows.
</DD>
</DL>

<P>
Once your terminal is running, go to the directory containing your script using the <TT>cd</TT> command (if you do not know what this is, please see the documentation for your terminal program to understand some of its basic usage).
Once you are in the correct directory, within the terminal type:

<P>
<BR> <SMALL CLASS="FOOTNOTESIZE"><TT>$ relax your_script.py</TT></SMALL>

<P>
You will need to replace <TT>your_script.py</TT> with the name of your script.
In most cases you would probably like to keep a log of all of the messages, warnings and errors relax produces for future reference.
To active logging within relax, type:

<P>
<BR> <SMALL CLASS="FOOTNOTESIZE"><TT>$ relax -log log your_script.py</TT></SMALL>

<P>
This will place all output (both STDOUT and STDERR) into the <TT>log</TT> file (you can choose any name for this log file).
Alternatively you can both log the output and simultaneously see the messages in your terminal by typing:

<P>
<BR> <SMALL CLASS="FOOTNOTESIZE"><TT>$ relax -tee log your_script.py</TT></SMALL>

<P>
These command line arguments could be replaced by IO redirection if this is a familiar concept to you, but note that these arguments are active also in the GUI mode whereby IO redirection in the terminal will have no effect.
An example of a simple script which will minimise the model-free model ``m4'' after loading six relaxation data sets is

<P>
<PRE>
# Create the data pipe.
name = 'm4'
pipe.create(name, 'mf')

# Load the PDB file.
structure.read_pdb('1f3y.pdb')

# Set up the 15N and 1H spins.
structure.load_spins('@N', ave_pos=True)
structure.load_spins('@H', ave_pos=True)
spin.isotope('15N', spin_id='@N')
spin.isotope('1H', spin_id='@H')

# Load the relaxation data.
relax_data.read(ri_id='R1_600',  ri_type='R1',  frq=600.0*1e6, file='r1.600.out', res_num_col=1, data_col=3, error_col=4)
relax_data.read(ri_id='R2_600',  ri_type='R2',  frq=600.0*1e6, file='r2.600.out', res_num_col=1, data_col=3, error_col=4)
relax_data.read(ri_id='NOE_600', ri_type='NOE', frq=600.0*1e6, file='noe.600.out', res_num_col=1, data_col=3, error_col=4)
relax_data.read(ri_id='R1_500',  ri_type='R1',  frq=500.0*1e6, file='r1.500.out', res_num_col=1, data_col=3, error_col=4)
relax_data.read(ri_id='R2_500',  ri_type='R2',  frq=500.0*1e6, file='r2.500.out', res_num_col=1, data_col=3, error_col=4)
relax_data.read(ri_id='NOE_500', ri_type='NOE', frq=500.0*1e6, file='noe.500.out', res_num_col=1, data_col=3, error_col=4)

# Initialise the diffusion tensor.
diffusion_tensor.init((2e-8, 1.3, 60, 290), spheroid_type='prolate', param_types=2, fixed=True)

# Create all attached protons.
sequence.attach_protons()

# Define the magnetic dipole-dipole relaxation interaction.
interatom.define(spin_id1='@N', spin_id2='@H', direct_bond=True)
interatom.set_dist(spin_id1='@N', spin_id2='@H', ave_dist=1.02 * 1e-10)
interatom.unit_vectors()

# Define the CSA relaxation interaction.
value.set(-172 * 1e-6, 'csa')

# Select a preset model-free model.
model_free.select_model(model=name)

# Grid search.
minimise.grid_search(inc=11)

# Minimise.
minimise.execute('newton')

# Finish.
results.write(file='results', force=True)
state.save('save', force=True)
</PRE>

<P>
Scripting is much more powerful than the prompt as advanced Python<A NAME="1807"></A> programming can be employed (see the file <TT>relax_curve_diff.py</TT> in the <TT>sample_scripts</TT> directory for an example).

<P>

<H3><A NAME="SECTION04128100000000000000"></A>
<A NAME="1812"></A>
<BR>
Sample scripts
</H3>

<P>
A few sample scripts have been provided in the directory <TT>sample_scripts</TT>.
These can be copied and modified for different types of data analysis.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html5172"
  HREF="The_test_suite.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Next" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html5166"
  HREF="How_to_use_relax.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Up" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html5160"
  HREF="The_spin_and_interatomic_data_containers.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Previous" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html5168"
  HREF="Contents.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Contents" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html5170"
  HREF="Index.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Index" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html1"
  HREF="http://download.gna.org/relax/manual/relax.pdf"><IMG
 ALIGN="BOTTOM" BORDER="0" SRC="http://www.nmr-relax.com/images/pdf_icon_nav.png"
 ALT="pdf_icon_nav.png"></A><A NAME="tex2html2"
  HREF="http://www.nmr-relax.com"><IMG
 ALIGN="BOTTOM" BORDER="0" SRC="http://www.nmr-relax.com/images/relax_logo_nav.png"
 ALT="relax_logo_nav.png"></A>
<BR>
<B> Next:</B> <A NAME="tex2html5173"
  HREF="The_test_suite.html">The test suite</A>
<B> Up:</B> <A NAME="tex2html5167"
  HREF="How_to_use_relax.html">How to use relax</A>
<B> Previous:</B> <A NAME="tex2html5161"
  HREF="The_spin_and_interatomic_data_containers.html">The spin and interatomic</A>
 &nbsp; <B>  <A NAME="tex2html5169"
  HREF="Contents.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html5171"
  HREF="Index.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
The <a href="http://www.nmr-relax.com">relax</a> <a href="http://www.nmr-relax.com/manual/">user manual</a> (<a href="http://download.gna.org/relax/manual/relax.pdf">PDF</a>), created 2016-10-28.
</ADDRESS>
</BODY>
</HTML>
