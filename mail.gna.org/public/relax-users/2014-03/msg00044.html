<!-- MHonArc v2.6.18 -->
<!--X-Subject: RE: Model&#45;free analysis error -->
<!--X-From-R13: Winaubr Zrhat &#60;vinaubr.yrhatNpurz.bk.np.hx> -->
<!--X-Date: Tue, 25 Mar 2014 16:34:52 +0100 -->
<!--X-Message-Id: 57E7794ED2439341B1ED0B47DBB1D89D60DDEA5A@MBX10.ad.oak.ox.ac.uk -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: loom.20140207T152903&#45;876@post.gmane.org -->
<!--X-Reference: CAED9pY&#45;&#45;SKVNqRYj1PXBJX0BV5eO7aBQxaOPQS7xV8e&#45;ecfXfA@mail.gmail.com -->
<!--X-Reference: 57E7794ED2439341B1ED0B47DBB1D89D32C52C20@MBX10.ad.oak.ox.ac.uk -->
<!--X-Reference: CAED9pY8TfdoOqQ9i=PsqS3Y2dtsjBniH28c69m2XMTzjPUGR2g@mail.gmail.com -->
<!--X-Reference: 57E7794ED2439341B1ED0B47DBB1D89D60DDE9FE@MBX10.ad.oak.ox.ac.uk -->
<!--X-Reference: CAED9pY97OBK=M95LdxzC+UMNmRYGFHZZAXHCGwKu1+JMExxoqQ@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>RE: Model-free analysis error -- March 25, 2014 - 16:34</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />RE: Model-free analysis error</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00044" class="tabs">Index by Date</a> | <a href="threads.html#00044" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00043.html">Date Prev</a>] [<a href="msg00045.html">Date Next</a>] [<a href="msg00042.html">Thread Prev</a>] [<a href="msg00048.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Tue, 25 Mar 2014 15:34:22 +0000</li>
<li class="menuitem">
<em>Accept-language</em>: en-GB, en-US</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-users@xxxxxxx&quot; &lt;relax-users@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00044.html">57E7794ED2439341B1ED0B47DBB1D89D60DDEA5A@MBX10.ad.oak.ox.ac.uk</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;loom.20140207T152903-876@post.gmane.org&gt; &lt;CAED9pY--SKVNqRYj1PXBJX0BV5eO7aBQxaOPQS7xV8e-ecfXfA@mail.gmail.com&gt; &lt;57E7794ED2439341B1ED0B47DBB1D89D32C52C20@MBX10.ad.oak.ox.ac.uk&gt; &lt;CAED9pY8TfdoOqQ9i=PsqS3Y2dtsjBniH28c69m2XMTzjPUGR2g@mail.gmail.com&gt; &lt;<a href="msg00041.html">57E7794ED2439341B1ED0B47DBB1D89D60DDE9FE@MBX10.ad.oak.ox.ac.uk</a>&gt;, &lt;CAED9pY97OBK=M95LdxzC+UMNmRYGFHZZAXHCGwKu1+JMExxoqQ@mail.gmail.com&gt;</li>
<li class="menuitem">
<em>Thread-index</em>: AQHPJCFzZiKa8vW0iEWKStgk0wYOJJquVIHqgABYHICAQ3drAIAABM6AgAAOKLY=</li>
<li class="menuitem">
<em>Thread-topic</em>: Model-free analysis error</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Ivanhoe Leung</strong> on March 25, 2014 - 16:34:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Dear Edward,

I have submitted a bug report as requested

<a  rel="nofollow" href="https://web.archive.org/web/https://gna.org/bugs/index.php?21862">https://gna.org/bugs/index.php?21862</a>

Thanks

Ivan


________________________________________
From: edward.dauvergne@xxxxxxxxx [edward.dauvergne@xxxxxxxxx] on behalf of 
Edward d'Auvergne [edward@xxxxxxxxxxxxx]
Sent: 25 March 2014 14:43
To: Ivanhoe Leung
Cc: relax-users@xxxxxxx
Subject: Re: Model-free analysis error

Hi Ivan,

If you could create a bug report using the link
<a  rel="nofollow" href="https://web.archive.org/web/https://gna.org/bugs/?func=additem&amp;group=relax">https://gna.org/bugs/?func=additem&amp;group=relax</a>, that would be
appreciated.  Please try to include as much information as possible.
The best would be if you could attach a truncated data set, the
minimum required to trigger the bug (slightly randomised if you would
like to keep it private).  If I can reproduce the bug myself, I can
normally have a fix for it within 5-10 minutes.  Oh, it would be good
to check that you are using the latest version of relax - currently
3.1.6 (<a  rel="nofollow" href="http://www.nmr-relax.com/download.html">http://www.nmr-relax.com/download.html</a>) - just in case the bug
has already been fixed.

Cheers,

Edward



On 25 March 2014 15:33, Ivanhoe Leung &lt;ivanhoe.leung@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Dear Edward,

I have now conducted measurements (T1, T2 and NOE) in two seperate fields 
(600 and 700 MHz) as suggested in your previous email.

I have upload six different files onto the &quot;Relaxation Data List&quot;. The data 
is in the following format

2 ALA 5.49631746729691 N
3 ASP 3.74279511939516 N
4 ASP 6.12594952217594 N
6 SER 6.75812664729337 N

However, after I click the &quot;Dipolar relaxation&quot; button, the programme 
freezes up when I press &quot;Apply&quot; or &quot;Next&quot;.

I encountered no problem with the other three buttons (CSA relaxation / X 
isotope / H isotope)

I wonder if it is because I am not supplying the right type of data to the 
software, or if this is a python problem?

Thanks and I hope to hear back from you soon!

Ivan



________________________________________
From: edward.dauvergne@xxxxxxxxx [edward.dauvergne@xxxxxxxxx] on behalf of 
Edward d'Auvergne [edward@xxxxxxxxxxxxx]
Sent: 10 February 2014 16:09
To: Ivanhoe Leung
Cc: relax-users@xxxxxxx
Subject: Re: Model-free analysis error

Hi Ivan,

To continue:

</pre><blockquote class="blockquote"><pre style="margin: 0em;">On another note, I wonder if it is possible to modify the nmr-relax 
programme so that I can do model-free analysis with data from only one 
field strength? Alternatively, do you know of any programme (that can be 
installed on Windows) that can do such analysis? My work focused mainly on 
small molecule and ligand-based NMR and I have only just very recently 
started looking in to protein dynamics so I am still experimentinng 
different software and data treatment etc.
</pre></blockquote><pre style="margin: 0em;">

Firstly, the subject of single field strength data has been discussed
numerous times on this mailing list.  I would recommend you read my
previous responses to questions relating to single field strength
data, and look the other messages in those threads.  You will find
these discussions quite informative and highly detailed:

- Martin Ballaschk:
<a  rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.user/1409/focus=1438">http://thread.gmane.org/gmane.science.nmr.relax.user/1409/focus=1438</a>
- Shantanu Bhattacharyya:
<a  rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.user/1367/focus=1369">http://thread.gmane.org/gmane.science.nmr.relax.user/1367/focus=1369</a>
- Mengjun Xue:
<a  rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.user/1276/focus=1277">http://thread.gmane.org/gmane.science.nmr.relax.user/1276/focus=1277</a>
- Fernando Amador: <a  rel="nofollow" href="http://article.gmane.org/gmane.science.nmr.relax.user/84">http://article.gmane.org/gmane.science.nmr.relax.user/84</a>
- Shantanu Bhattacharyya:
<a  rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.user/1086/focus=1087">http://thread.gmane.org/gmane.science.nmr.relax.user/1086/focus=1087</a>
- Dhanasekaran Muthu:
<a  rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.user/1152/focus=1153">http://thread.gmane.org/gmane.science.nmr.relax.user/1152/focus=1153</a>
- Vitaly Vostrikov:
<a  rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.user/1147/focus=1150">http://thread.gmane.org/gmane.science.nmr.relax.user/1147/focus=1150</a>
- Aldino Viegas:
<a  rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.user/1127/focus=1128">http://thread.gmane.org/gmane.science.nmr.relax.user/1127/focus=1128</a>
- Pierre-Yves Savard:
<a  rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.user/724/focus=725">http://thread.gmane.org/gmane.science.nmr.relax.user/724/focus=725</a>
- Keith Constantine:
<a  rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.user/513/focus=517">http://thread.gmane.org/gmane.science.nmr.relax.user/513/focus=517</a>
- Clare-Louise Evans:
<a  rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.user/326/focus=332">http://thread.gmane.org/gmane.science.nmr.relax.user/326/focus=332</a>
- Hongyan Li:  
<a  rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.devel/694/focus=701">http://thread.gmane.org/gmane.science.nmr.relax.devel/694/focus=701</a>

These will have lots of additional information.  This is just a
selection of possibly the most useful messages.


You will soon see that this is a complicated topic.  Note that relax
is capable of performing 100% of the functionality of Modelfree4 (with
or without the Fast-Modelfree GUI interface), Dasha, Tensor2, and
DYNAMICS.  If you play with the optimisation settings you can even
find identical results to within machine precision - relax can mimic
these other softwares.

The key is that the full analysis protocol is rather complicated -
many people don't understand this - and that these softwares do not
implement the full iterative protocol.  Therefore you either have to
perform it manually or write a script to perform all of the steps.
The protocol is described in the relax manual in figure 7.2
(<a  rel="nofollow" href="http://www.nmr-relax.com/manual/diffusion_seeded_paradigm.html">http://www.nmr-relax.com/manual/diffusion_seeded_paradigm.html</a>).  In
summary:

a)  Find an initial diffusion tensor estimate (you can do this in
relax by only using model m0).  This requires all non-mobile residues
and side chain spins to be excluded, and this can be problematic.  See
the d'Auvergne and Gooley, 2008b paper at
<a  rel="nofollow" href="http://dx.doi.org/10.1007/s10858-007-9213-3">http://dx.doi.org/10.1007/s10858-007-9213-3</a> for an example of the
catastrophic failure that this initial estimate can result in.  Or the
bacteriorhodopsin fragment of Korzhnev et al., 1999
(<a  rel="nofollow" href="http://dx.doi.org/10.1023/a:1008356809071">http://dx.doi.org/10.1023/a:1008356809071</a>) where this complete
failure was earlier demonstrated.

b)  Optimise all of the model-free models from m0 to m9.  This
requires high precision optimisation, for a comparison of all the
softwares see the d'Auvergne and Gooley, 2008a model-free optimisation
paper at <a  rel="nofollow" href="http://dx.doi.org/10.1007/s10858-007-9214-2">http://dx.doi.org/10.1007/s10858-007-9214-2</a>.  Only relax and
Dasha implement the full range of model-free models, though the models
m6, m7, and m8 cannot be used if only single field strength data is
used (m6 is the original 2-time scale motion model of Clore et al.,
1990).

c)  Eliminate failed models (this is only available in relax, see the
d'Auvergne and Gooley, 2006 model elimination paper at
<a  rel="nofollow" href="http://dx.doi.org/10.1007/s10858-006-9007-z">http://dx.doi.org/10.1007/s10858-006-9007-z</a>).

d)  Select the best model-free model for each spin system.  This again
requires precision modern techniques, with the best being AIC model
select (see the d'Auvergne and Gooley, 2003 model-free model selection
paper at <a  rel="nofollow" href="http://dx.doi.org/10.1023/A:1021902006114">http://dx.doi.org/10.1023/A:1021902006114</a>).  If you are
unaware that ANOVA statistics for model selection (hypothesis testing
via chi-squared, F- and t-tests) was abandoned by the field of model
selection over 100 years ago (a field which makes the NMR field look
very, very small), then you should really look at that paper.

e)  Optimise the global model.  This is the diffusion tensor plus the
model-free models for all spin systems.

f)  Check for convergence (identical chi-squared values to a previous
iteration, and not necessarily the last one).  If no, then go back to
b) and repeat.  Note that the chi-squared value can go up
significantly between iterations, but this is because the model is
simplifying itself at a much faster rate by loosing parameters - it's
Occam's razor at work.  Again see the d'Auvergne and Gooley, 2008b
paper at <a  rel="nofollow" href="http://dx.doi.org/10.1007/s10858-007-9213-3">http://dx.doi.org/10.1007/s10858-007-9213-3</a> for figures
demonstrating this.  The concept as to what is happening during this
combined model-free optimisation and model selection algorithm is
described in the d'Auvergne and Gooley, 2007 MolBiosyst paper at
<a  rel="nofollow" href="http://dx.doi.org/10.1039/b702202f">http://dx.doi.org/10.1039/b702202f</a>.  It can take up to 20 iterations
or more to reach convergence, depending upon the quality of the
relaxation data and the 3D structure or the system in study.

g)  Once steps a-f have been completed for all global models
(characterised by the spheroid, prolate spheroid, oblate spheroid, and
ellipsoid diffusion tensors), then model selection between the
different global models needs to be performed.

h)  Monte Carlo simulations for error analysis must be performed at the end.

i)  Elimination of failed Monte Carlo simulations is essential for
keeping the errors to reasonable values for certain spin systems.
This is also a relax-only feature (see the d'Auvergne and Gooley, 2007
model elimination paper at
<a  rel="nofollow" href="http://dx.doi.org/10.1007/s10858-006-9007-z">http://dx.doi.org/10.1007/s10858-006-9007-z</a>).

These steps must be implemented independently of which software you
use, as NONE implement the full protocol.  Note however that the
protocol I developed (in the d'Auvergne and Gooley, 2007 theory paper
at <a  rel="nofollow" href="http://dx.doi.org/10.1039/b702202f">http://dx.doi.org/10.1039/b702202f</a> and the d'Auvergne and Gooley,
2008b paper at <a  rel="nofollow" href="http://dx.doi.org/10.1007/s10858-007-9213-3">http://dx.doi.org/10.1007/s10858-007-9213-3</a>) is fully
implemented in relax, however this required multiple field strength
data.  This is a rather large script located at
auto_anlayses/dauvergne_protocol.py.  This protocol is used by the
GUI.  So one option would be to copy this
auto_anlayses/dauvergne_protocol.py script and modify it for the
figure 7.2 protocol.


*** Note *** I must warn you about using single field strength data.
It is now quite difficult to publish a model-free analysis with only
single field strength data as most of the field know about the
catastrophic analysis failures resulting in large amounts of
artificial motion.  These failures can also be much more subtle.  Many
reviewers will ask for such data to be collected as the results cannot
not be trusted otherwise.  For a model-free analysis, it is almost
essential to collect data at multiple field strengths, otherwise it
can be sometimes impossible to distinguish between the anisotropic
part of the Brownian tumbling of the molecule and internal motion -
specifically due to the NH vectors in secondary structure elements all
pointing in a similar direction.  I have a much better explanation, as
well as citations to all the relevant literature in:

d'Auvergne E. J., Gooley P. R. (2007). Set theory formulation of the
model-free problem and the diffusion seeded model-free paradigm. Mol.
Biosyst., 3(7), 483-494. (<a  rel="nofollow" href="http://dx.doi.org/10.1039/b702202f">http://dx.doi.org/10.1039/b702202f</a>)

In this paper, you will see reviewed both the artificial nanosecond
motions of the Schurr 1994 paper and the artifical Rex motions of the
Tjandra 1995 paper.

Finally, you will probably find it much easier to spend the 7-8 days
collecting data at another field strength than to implement the
protocol of steps a-i in a relax, Modelfree4, or Dasha script (or via
multiple iterations of the GUI programs), as well as study all of the
relevant literature to understand all of the types of failures than
only occurs with single field strength data.  With multiple field
strength data you can perform Sebastien Morin's consistency testing
analysis in relax (<a  rel="nofollow" href="http://dx.doi.org/10.1007/s10858-009-9381-4">http://dx.doi.org/10.1007/s10858-009-9381-4</a> and
<a  rel="nofollow" href="http://www.nmr-relax.com/manual/Consistency_testing.html">http://www.nmr-relax.com/manual/Consistency_testing.html</a>).  That way
you can see if your per-experiment temperature calibration and
per-experiment temperature control techniques have works sufficiently
well (<a  rel="nofollow" href="http://www.nmr-relax.com/manual/Temperature_control_calibration.html">http://www.nmr-relax.com/manual/Temperature_control_calibration.html</a>)
and if you have used long enough recycle delays.  Collecting data at a
second field would probably save you significant amounts of time, and
has the additional benefit that it would guarantee that the dynamics
you see at the end will be real.  I cannot emphasize enough how
important it is to collect data at multiple fields, most importantly
the NOE and R2 data.

Regards,

Edward
</pre></blockquote><pre style="margin: 0em;">

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00048" href="msg00048.html">Re: Model-free analysis error</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00041" href="msg00041.html">RE: Model-free analysis error</a></strong>
<ul><li><em>From:</em> Ivanhoe Leung</li></ul></li>
<li><strong><a name="00042" href="msg00042.html">Re: Model-free analysis error</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Tue Mar 25 18:40:13 2014</div>  
</body>
</html>
