<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: r13121 &#45; in /branches/xyz: generic_fns/structure/internal.py	test_suite/system_tests/structure.py -->
<!--X-From-R13: Vna Eha <unfhNaze.zcvocp.zct.qr> -->
<!--X-Date: Mon, 20 Jun 2011 10:47:34 +0200 -->
<!--X-Message-Id: CBE4466A&#45;6B78&#45;42C1&#45;AD41&#45;B00D4A58EAB5@nmr.mpibpc.mpg.de -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: E1QYZWC&#45;0005iI&#45;2k@subversion.gna.org -->
<!--X-Reference: BANLkTimcH_ZVcgU5+DJD_hAAqhS6gsaeiA@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: r13121 - in /branches/xyz: generic_fns/structure/internal.py	test_suite/system_tests/structure.py -- June 20, 2011 - 10:47</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: r13121 - in /branches/xyz: generic_fns/structure/internal.py	test_suite/system_tests/structure.py</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00212" class="tabs">Index by Date</a> | <a href="threads.html#00212" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00211.html">Date Prev</a>] [<a href="msg00213.html">Date Next</a>] [<a href="msg00211.html">Thread Prev</a>] [<a href="msg00213.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Edward d'Auvergne&quot; &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Mon, 20 Jun 2011 10:48:52 +0200</li>
<li class="menuitem">
<em>Cc</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00212.html">CBE4466A-6B78-42C1-AD41-B00D4A58EAB5@nmr.mpibpc.mpg.de</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;E1QYZWC-0005iI-2k@xxxxxxxxxxxxxxxxxx&gt;	&lt;BANLkTimcH_ZVcgU5+DJD_hAAqhS6gsaeiA@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Han Sun</strong> on June 20, 2011 - 10:47:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Hi Edward,

</pre><tt>That is the problem. In the xyz file you can probably have several  
</tt><tt>molecules, but you can not recognized that. There is no parameter to  
</tt><tt>define the molecule or the residue like in the pdb file.
</tt><pre style="margin: 0em;">

Best,
Han

On Jun 20, 2011, at 10:41 AM, Edward d'Auvergne wrote:

</pre><blockquote class="blockquote"><pre style="margin: 0em;">
Hi Han,

It's now working, your ssh access :)  I was just wondering why you had
the statement:

if mol_index==0:

This could be problematic if you have multiple molecules in the XYZ
file.  Is it possible to have more than one in the format?

Cheers,

Edward



On 20 June 2011 10:07,  &lt;hasu@xxxxxxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">
Author: han87
Date: Mon Jun 20 10:07:35 2011
New Revision: 13121

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=13121&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=13121&amp;view=rev</a>
Log:
</pre><tt>Debugging the user functions load_xyz() and test_read_xyz_internal2 
</tt><tt>().
</tt><pre style="margin: 0em;">

</pre><tt>The user functions load_xyz() in 'generic_fns/structure/ 
</tt><tt>internal.py' and test_read_xyz_internal2() in 'test_suite/ 
</tt><tt>system_tests/structure.py' have been changed so that the molecule  
</tt><tt>name can be read properly.
</tt><pre style="margin: 0em;">

Modified:
   branches/xyz/generic_fns/structure/internal.py
   branches/xyz/test_suite/system_tests/structure.py

Modified: branches/xyz/generic_fns/structure/internal.py
</pre><tt>URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/xyz/generic_fns/">http://svn.gna.org/viewcvs/relax/branches/xyz/generic_fns/</a> 
</tt><tt>structure/internal.py?rev=13121&amp;r1=13120&amp;r2=13121&amp;view=diff
</tt><tt>===================================================================== 
</tt><tt>=========
</tt><pre style="margin: 0em;">
--- branches/xyz/generic_fns/structure/internal.py (original)
</pre><tt>+++ branches/xyz/generic_fns/structure/internal.py Mon Jun 20  
</tt><tt>10:07:35 2011
</tt><pre style="margin: 0em;">
@@ -853,8 +853,9 @@
            if set_mol_name:
                new_mol_name.append(set_mol_name[mol_index])
            else:
</pre><tt>-                # Set the name to the file name plus the  
</tt><tt>structure number.
</tt><tt>-                new_mol_name.append(file_root(file) + '_mol' +  
</tt><tt>repr(mol_index))
</tt><pre style="margin: 0em;">
+                if mol_index==0:
</pre><tt>+                   #Set the name to the file name plus the  
</tt><tt>structure number.
</tt><tt>+                   new_mol_name.append(file_root(file) + '_mol' +  
</tt><tt>repr(mol_index+1))
</tt><pre style="margin: 0em;">

            # Store the original mol number.
            orig_mol_num.append(mol_index)
@@ -874,7 +875,8 @@

            # Increment the model index.
            model_index = model_index + 1
-
+
+        orig_mol_num=[0]
        # Create the structural data data structures.
</pre><tt>        self.pack_structs(mol_conts,  
</tt><tt>orig_model_num=orig_model_num, set_model_num=set_model_num,  
</tt><tt>orig_mol_num=orig_mol_num, set_mol_name=new_mol_name,  
</tt><tt>file_name=file, file_path=path)
</tt><pre style="margin: 0em;">


Modified: branches/xyz/test_suite/system_tests/structure.py
</pre><tt>URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/xyz/test_suite/">http://svn.gna.org/viewcvs/relax/branches/xyz/test_suite/</a> 
</tt><tt>system_tests/structure.py?rev=13121&amp;r1=13120&amp;r2=13121&amp;view=diff
</tt><tt>===================================================================== 
</tt><tt>=========
</tt><pre style="margin: 0em;">
--- branches/xyz/test_suite/system_tests/structure.py (original)
</pre><tt>+++ branches/xyz/test_suite/system_tests/structure.py Mon Jun 20  
</tt><tt>10:07:35 2011
</tt><pre style="margin: 0em;">
@@ -659,10 +659,10 @@
</pre><tt>        self.interpreter.structure.read_xyz(file='SSS-cluster4-new- 
</tt><tt>test.xyz', dir=path)
</tt><pre style="margin: 0em;">

        # Test the molecule name.
</pre><tt>-        self.assertEqual(cdp.structure.structural_data[0].mol 
</tt><tt>[0].mol_name, 'SSS-cluster4-new-test')
</tt><tt>+        self.assertEqual(cdp.structure.structural_data[0].mol 
</tt><tt>[0].mol_name, 'SSS-cluster4-new-test_mol1')
</tt><pre style="margin: 0em;">

        # Load a single atom and test it.
</pre><tt>-        self.interpreter.structure.load_spins('SSS-cluster4-new- 
</tt><tt>test:3@C')
</tt><tt>+        self.interpreter.structure.load_spins('SSS-cluster4-new- 
</tt><tt>test_mol1:@C')
</tt><pre style="margin: 0em;">
        self.assertEqual(count_spins(), 1)

        # Try loading a few protons.


_______________________________________________
relax (<a  rel="nofollow" href="http://nmr-relax.com">http://nmr-relax.com</a>)

This is the relax-commits mailing list
relax-commits@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="http://www.nmr-relax.com/mail.gna.org/listinfo/relax-commits">https://mail.gna.org/listinfo/relax-commits</a>

</pre></blockquote><pre style="margin: 0em;">

_______________________________________________
relax (<a  rel="nofollow" href="http://nmr-relax.com">http://nmr-relax.com</a>)

This is the relax-devel mailing list
relax-devel@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="http://www.nmr-relax.com/mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a>
</pre></blockquote><pre style="margin: 0em;">



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00213" href="msg00213.html">Re: r13121 - in /branches/xyz: generic_fns/structure/internal.py	test_suite/system_tests/structure.py</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00211" href="msg00211.html">Re: r13121 - in /branches/xyz: generic_fns/structure/internal.py	test_suite/system_tests/structure.py</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Mon Jun 20 11:00:22 2011</div>  
</body>
</html>
