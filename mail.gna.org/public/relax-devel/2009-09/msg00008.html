<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: [bug #13259] full analysis&#45;high Te values -->
<!--X-From-R13: Eéonfgvra [beva <fronfgvra.zbeva.1Nhyniny.pn> -->
<!--X-Date: Fri, 04 Sep 2009 17:19:30 +0200 -->
<!--X-Message-Id: 4AA12FF8.90409@ulaval.ca -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20090325&#45;210128.sv0.81383@gna.org -->
<!--X-Reference: 7f080ed10903260836q6e17dbbam42ce3d76e79c1bc@mail.gmail.com -->
<!--X-Reference: 7f080ed10903260841o5666fc6asd509c157a11e8a18@mail.gmail.com -->
<!--X-Reference: 49CBA382.7090208@ulaval.ca -->
<!--X-Reference: 7f080ed10903260911y706db58cqb7082cb987b1284e@mail.gmail.com -->
<!--X-Reference: 49CBBE90.6060705@ulaval.ca -->
<!--X-Reference: 7f080ed10907200448s38c60af5vfcc8e1212388a59e@mail.gmail.com -->
<!--X-Reference: 4A92F21D.8040309@ulaval.ca -->
<!--X-Reference: 7f080ed10909020524w1dd859d4q67fe62f20c0f988d@mail.gmail.com -->
<!--X-Reference: 4AA03598.7050204@ulaval.ca -->
<!--X-Reference: 7f080ed10909040220i1e0085a5j50695e2415f19614@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [bug #13259] full analysis-high Te values -- September 04, 2009 - 17:19</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: [bug #13259] full analysis-high Te values</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00008" class="tabs">Index by Date</a> | <a href="threads.html#00008" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00007.html">Date Prev</a>] [<a href="msg00009.html">Date Next</a>] [<a href="msg00006.html">Thread Prev</a>] [<a href="msg00005.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Fri, 04 Sep 2009 11:19:20 -0400</li>
<li class="menuitem">
<em>Cc</em>: Pierre-Yves Savard &lt;Pierre-Yves.Savard@xxxxxxxxxxxxx&gt;,	&quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00008.html">4AA12FF8.90409@ulaval.ca</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;20090325-210128.sv0.81383@xxxxxxx&gt;	&lt;7f080ed10903260836q6e17dbbam42ce3d76e79c1bc@xxxxxxxxxxxxxx&gt;	&lt;7f080ed10903260841o5666fc6asd509c157a11e8a18@xxxxxxxxxxxxxx&gt;	&lt;49CBA382.7090208@xxxxxxxxx&gt;	&lt;7f080ed10903260911y706db58cqb7082cb987b1284e@xxxxxxxxxxxxxx&gt;	&lt;49CBBE90.6060705@xxxxxxxxx&gt;	&lt;7f080ed10907200448s38c60af5vfcc8e1212388a59e@xxxxxxxxxxxxxx&gt;	&lt;4A92F21D.8040309@xxxxxxxxx&gt;	&lt;7f080ed10909020524w1dd859d4q67fe62f20c0f988d@xxxxxxxxxxxxxx&gt;	&lt;4AA03598.7050204@xxxxxxxxx&gt;	&lt;7f080ed10909040220i1e0085a5j50695e2415f19614@xxxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>User-agent</em>: Thunderbird 2.0.0.23 (X11/20090827)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Sébastien Morin</strong> on September 04, 2009 - 17:19:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi,

I just posted a minimal dataset to reproduce the bug.

I agree that the dataset could be included in the system tests suite.

Regards,


Séb  :)




Edward d'Auvergne wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

This is very strange - it should be eliminated but isn't.  I've now
reopened the bug report.  If you could post the minimal set of files
(with absolute minimal data) that reproduces this bug, I can then test
this.  If the calculation only takes a few seconds, or can be made to
be very short, we can add this to the test suite to speed up debugging
and prevent this bug from ever coming back.

Cheers,

Edward


2009/9/3 Sébastien Morin &lt;sebastien.morin.1@xxxxxxxxx&gt;:
  
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Ed,

I just switched to the new script and modified it accordingly so the
diffusion tensor used is not the previously optimised one, but one with
fixed values:

   diffusion_tensor.init((1.01080149044e-08, 5151140.07277,
2.08830790275, 0.123449330356), param_types=0, spheroid_type='prolate',
fixed=True)

This (with other changes) has the advantage of allowing the test script
to start after round_1 and execute only round_2 with this specified
diffusion tensor in order to create the bug.

Here are the differences (using the command &quot;diff &quot;):

===============
161c161
&lt; MF_MODELS = ['m1', 'm8']
---
    
</pre><blockquote class="blockquote"><pre style="margin: 0em;">MF_MODELS = ['m0', 'm1', 'm2', 'm3', 'm4', 'm5', 'm6', 'm7', 'm8', 'm9']
      
</pre></blockquote><pre style="margin: 0em;">296,298c294
&lt;                     pipe.create('previous', 'mf')
&lt;                     diffusion_tensor.init((1.01080149044e-08,
5151140.07277, 2.08830790275, 0.123449330356), param_types=0,
spheroid_type='prolate', fixed=True)
---
    
</pre><blockquote class="blockquote"><pre style="margin: 0em;">                    self.load_tensor()
      
</pre></blockquote><pre style="margin: 0em;">304c300
&lt;                     self.model_selection(modsel_pipe='final',
dir=self.base_dir + 'aic')
---
    
</pre><blockquote class="blockquote"><pre style="margin: 0em;">                    self.model_selection(modsel_pipe='aic',
      
</pre></blockquote><pre style="margin: 0em;">dir=self.base_dir + 'aic')

===============


The bug is still present (as of r9463), i.e. a value of 1e-8 is obtained
for ts and is not eliminated prior to model selection...

...

Of course, if the script is used as is (with the optimised diffusion
tensor from every previous runs), the bug is not seen. However, this
does not mean that the bug is not present, but that the optimised
tensors don't give rise to ts of 1e-8 (at least in the 20 rounds I made).

So there is still a problem with model elimination... However, it is
probably in the script as I verified that model elimination worked
properly for ts using the system test framework (which, if you approve,
I could expand to include all possible model elimination issues).

Any idea ?
Maybe I could post the files to reproduce the bug in the bug report..?


Séb  :)







Edward d'Auvergne wrote:
    
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

If I remember correctly, the bug was in the full_analysis.py script
and not in relax proper.  Are you testing using the old script?  If
so, the new repository version should be fixed.  If not, then I'll
have to look at this again!

Cheers,

Edward




2009/8/24 Sébastien Morin &lt;sebastien.morin.1@xxxxxxxxx&gt;:
      
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Ed,

I just tested if the problem was still present using the same machine
and the same script, however with an updated version of the 1.3 line
(r9387).

The problem is still present...

============================
&lt;ts desc=&quot;Slower motion effective internal correlation time (seconds)&quot;
ieee_754_byte_array=&quot;[177, 90, 65, 161, 240, 180, 85, 62]&quot;&gt;
2.0216029808800001e-08
&lt;/ts&gt;
============================

Regards,


Séb  :)




Edward d'Auvergne wrote:
        
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

I was just wondering if this is still a problem?  From memory this was
found to be a problem in the full_analysis.py script which is now
fixed.  If you could confirm this, it would be much appreciated.

Cheers,

Edward


On Thu, Mar 26, 2009 at 7:42 PM, Sébastien
Morin&lt;sebastien.morin.1@xxxxxxxxx&gt; wrote:

          
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Ed,

Tests #2 and #3 are now completed.

Both tests show the bug is still present... (as seen in the 'aic' 
directory,
'm8' is selected for residue A44).

In the log, there is no place where the eliminate() function is 
called...

Moreover, and this could have saved time, the test case (submitted 
with the
bug report) also fails to eliminate model 'm8' for A44... I was sure 
we had
tested that before doing the much longer tests (with datasets for all
residues) after r9003...

Hence, this problem is due to r9003.

Any idea..?


Séb  :)






Edward d'Auvergne wrote:

            
</pre><blockquote class="blockquote"><pre style="margin: 0em;">You're welcome.  The test case files attached to the bug made the work
much less for me, so thanks for that Pierre-Yves.

Bye,

Edward


On Thu, Mar 26, 2009 at 4:47 PM, Sébastien Morin
&lt;sebastien.morin.1@xxxxxxxxx&gt; wrote:


              
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Ed,

It is indeed fixed !!! Now, we'll have to wait for the rounds to 
complete
(for all three tests) so we are certain that no other problem was
introduced...

Edward, sorry for taking so much of your time right before the ENC ! 
PY
and
I really appreciate your help ! Thanks a lot for your devotion !!!


Séb  :)


Edward d'Auvergne wrote:


                
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Right, it might be fixed now.

Edward


On Thu, Mar 26, 2009 at 4:36 PM, Edward d'Auvergne
&lt;edward@xxxxxxxxxxxxx&gt;
wrote:



                  
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

The bug you see there is the regression.  I'm working on the fix 
right
now.  Should have some code to test soon.

Cheers,

Edward


On Thu, Mar 26, 2009 at 4:26 PM, Sébastien Morin
&lt;sebastien.morin.1@xxxxxxxxx&gt; wrote:



                    
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Ed,

Pierre-Yves and I are now testing the fix...

We set-up three different tests including all datasets (for all 
~150
residues). After the first round of prolate completed, we will 
know if
residue 44 is still associated with a ts of ~20 ns in model 'm8' 
or if
this
model is eliminated...

1.
Start from scratch with full_analysis.py. The local_tm run will be
done
and,
after, the prolate run.

2.
Use the old local_tm directory (from analysis before the bug 
report of
yesterday) and only make the prolate run...

3.
Use the old prolate directory (from analysis before the bug 
report of
yesterday) including the init and round_1 sub-directories and only
make
round 2.

We will have to wait to see if everything looks normal.

However, there seems to be a problem, already. For test #2, we 
get the
following error in the inital round of optimisation for the 
diffusion
tensor
(init round):

==============
relax&gt; diffusion_tensor.init(params=(1e-08, 0, 0, 0), 
time_scale=1.0,
d_scale=1.0, angle_units='deg', param_types=0,
spheroid_type='prolate',
fixed=False)

relax&gt; fix(element='all_spins', fixed=True)

relax&gt; grid_search(lower=None, upper=None, inc=11, 
constraints=True,
verbosity=1)
The diffusion tensor parameters together with the model-free
parameters
for
all spins will be used.
Unconstrained grid search size:


3483241635926760276239670296061783033856385373964443346380512727207030807448244020315627244532223540371618455651157976598330893796730564039193972812374440994792715667315064916696072753116546554132476003724628552320667084135787252303417928004684992625923335554734448200360162656232011377981776056433588143239686879331L
(constraints may decrease this size).

RelaxError: A grid search of size


3483241635926760276239670296061783033856385373964443346380512727207030807448244020315627244532223540371618455651157976598330893796730564039193972812374440994792715667315064916696072753116546554132476003724628552320667084135787252303417928004684992625923335554734448200360162656232011377981776056433588143239686879331L
is too large.
==============

This problem also arises when not making the change at line 303
(self.model_selection(modsel_pipe='final', dir=self.base_dir +
'aic')).

So, my guess is that this problem might be due to changes in 
r8999.

Regards,


Séb  :)




Edward d'Auvergne wrote:



                      
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Actually, this will cause a problem.  I've closely looked at the
script, and it appears that your suggestion is correct:





                        
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">I just tried something using the files in the bug report, as
well
as
with
the up-to-date 1.3 repository (r9001)...

I modified line 303 of the script from:

                self.model_selection(modsel_pipe='final',
dir=self.base_dir + 'aic')

to:

                self.model_selection(modsel_pipe='aic',
dir=self.base_dir + 'aic')

With this change, model 'm8' is eliminated and model 'm1' is
selected
instead.




                                  
</pre></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">This data pipe is for AIC model selection and the results go 
into the
'aic' directory.  This is followed by the 'opt' data pipe for
diffusion tensor optimisation.  So I'll make the change to the
repository.  But could you check if all works with the changes 
that
were made to the 1.3 line?  I think these changes were logical, 
but
there is a regression causing a system test to fail.

Cheers,

Edward





                        
</pre></blockquote><pre style="margin: 0em;">--
Sébastien Morin
PhD Student
S. Gagné NMR Laboratory
Université Laval &amp; PROTEO
Québec, Canada





                      
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">--
Sébastien Morin
PhD Student
S. Gagné NMR Laboratory
Université Laval &amp; PROTEO
Québec, Canada




                
</pre></blockquote></blockquote><pre style="margin: 0em;">--
Sébastien Morin
PhD Student
S. Gagné NMR Laboratory
Université Laval &amp; PROTEO
Québec, Canada



            
</pre></blockquote></blockquote><pre style="margin: 0em;">--
Sébastien Morin
PhD Student
S. Gagné NMR Laboratory
Université Laval &amp; PROTEO
Québec, Canada


        
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">

  
</pre></blockquote><pre style="margin: 0em;">


-- 
Sébastien Morin
PhD Student
S. Gagné NMR Laboratory
Université Laval &amp; PROTEO
Québec, Canada




</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00004" href="msg00004.html">Re: [bug #13259] full analysis-high Te values</a></strong>
<ul><li><em>From:</em> Sébastien Morin</li></ul></li>
<li><strong><a name="00006" href="msg00006.html">Re: [bug #13259] full analysis-high Te values</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Sat Sep 05 07:20:31 2009</div>  
</body>
</html>
