<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: r23083 &#45; /trunk/docs/latex/dispersion_software.tex -->
<!--X-From-R13: "Sqjneq q'Ohiretar" &#60;rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Thu, 08 May 2014 16:24:20 +0200 -->
<!--X-Message-Id: CAED9pY9_z2SCPSOetuSstUOMMb8OKNwRkmOAWtskeSHmgi5_4g@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: E1WiNpq&#45;0005Jb&#45;PA@subversion.gna.org -->
<!--X-Reference: CAED9pY_mosC_Y8uoMt=cXLL=75M&#45;sovi8ZpLvkva1C=u+NNL8w@mail.gmail.com -->
<!--X-Reference: CA+CBx2NbGESADfuUBudHjot8sDRoz2HDt2xegL59qvvz3h5yEQ@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: r23083 - /trunk/docs/latex/dispersion_software.tex -- May 08, 2014 - 16:24</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: r23083 - /trunk/docs/latex/dispersion_software.tex</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00249" class="tabs">Index by Date</a> | <a href="threads.html#00249" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00248.html">Date Prev</a>] [<a href="msg00250.html">Date Next</a>] [<a href="msg00245.html">Thread Prev</a>] [<a href="msg00251.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Thu, 8 May 2014 16:23:29 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113; h=mime-version:sender:in-reply-to:references:date:message-id:subject :from:to:cc:content-type:content-transfer-encoding; bh=1FgIR+NSTKs+qzEd/o7IRd7okSdTrQO3RmPjBn6CD/w=; b=CsAT/UZap9ePLLNygsNXl6Tm7NENof+OkWsxdDp769XwjBFM2jYLDwAC261bQYgg7O fy4/cP/ogZcemLWnDwKWuNte7lD/q6zUqCf2U1YOK9sP71dzxazzahMJ9gUlNnD38G6u esEHnw37FFzOnS0QDbPXhR9KoAZR/Oxf1jt+G2G9JHCmiPnC5b3jtScKtlEfNLL7Zzne JLY2w56O6XsiQ2I+63WcNEk9Qm0DHdMBdkonZWg0dm3McwUB0LuVYpbsU2/Sf1AEGYxv ABZ82uUV03Vz+dzyjDoxTRJT/JDe2lJA6mie53dWJEe0dVCWGQYq3/Y4ruRIZ3X9IaJu /hww==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00249.html">CAED9pY9_z2SCPSOetuSstUOMMb8OKNwRkmOAWtskeSHmgi5_4g@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;E1WiNpq-0005Jb-PA@subversion.gna.org&gt; &lt;CAED9pY_mosC_Y8uoMt=cXLL=75M-sovi8ZpLvkva1C=u+NNL8w@mail.gmail.com&gt; &lt;<a href="msg00245.html">CA+CBx2NbGESADfuUBudHjot8sDRoz2HDt2xegL59qvvz3h5yEQ@mail.gmail.com</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on May 08, 2014 - 16:24:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi,

On 8 May 2014 15:12, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Yep, I have just done it.

I could wish that the features:
1) sr #3138: Interpolating theta through spin-lock offset [Omega],
rather than spin-lock field strength [w1]
<a  rel="nofollow" href="https://gna.org/support/index.php?3138">https://gna.org/support/index.php?3138</a>
</pre></blockquote><pre style="margin: 0em;">

This isn't too difficult or too much work, but it will require a bit
of pre-planning.  It'll be very easy to head down the wrong path!


</pre><blockquote class="blockquote"><pre style="margin: 0em;">2) sr #3124: Grace graphs production for R1rho analysis with R2_eff as
function of Omega_eff
<a  rel="nofollow" href="https://gna.org/support/index.php?3124">https://gna.org/support/index.php?3124</a>
</pre></blockquote><pre style="margin: 0em;">

This will be similar in concept to sr #3138.  With pre-planning, i.e.
discussing on the mailing list so I can point you in the right
direction as needed, this and the above sr would take less time to
implement than the B14 models.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">But I dont have so much time for it now, so it must be later.
</pre></blockquote><pre style="margin: 0em;">

Add it as you need it :)


</pre><blockquote class="blockquote"><pre style="margin: 0em;">There are still some issues with;
bug #22017: LinAlgError, for all numerical CPMG models.
<a  rel="nofollow" href="https://web.archive.org/web/https://gna.org/bugs/?22017">https://gna.org/bugs/?22017</a>
And the B14 also blows up with nan.
</pre></blockquote><pre style="margin: 0em;">

These are separate issues.  They are not related - for bug #22017 you
identified R*tcp[i] as containing NaNs, but using print statements I
can identify these NaNs as originating much earlier in the code!  You
should try the same to find the origin - temporary printouts are a
useful debugging tool.  You'll be surprised what the origin is ;)

As for NaNs, almost all dispersion models had the NaN problem until I
fixed them!  Here is a demo of some of these problems:

import numpy
a = numpy.zeros(2)
print(1/a)
a = numpy.array([None, None], numpy.float64)
print(a)


</pre><blockquote class="blockquote"><pre style="margin: 0em;">These bugs can probably soon be closed, as Wont-Fix, since it is not a
problem of relax. ;-)
<a  rel="nofollow" href="https://web.archive.org/web/https://gna.org/bugs/?22024">https://gna.org/bugs/?22024</a>
 #22024 Minimisation space for CR72 is catastrophic. The chi2 surface
over dw and pA is bounded.

<a  rel="nofollow" href="https://web.archive.org/web/https://gna.org/bugs/?22021">https://gna.org/bugs/?22021</a>
 #22021 Model B14 shows bad fitting to data.
</pre></blockquote><pre style="margin: 0em;">

True, there's nothing to fix there.


</pre><blockquote class="blockquote"><pre style="margin: 0em;"><a  rel="nofollow" href="https://web.archive.org/web/https://gna.org/bugs/?21799">https://gna.org/bugs/?21799</a>
bug #21799: Insufficient recommendations/Warning message for the
execution of dauvergne protocol with 1 field is incomplete

Something should be done here. Just a little notits of the number of
fields at least.
But the GUI check, can be added later.
</pre></blockquote><pre style="margin: 0em;">

This is already in the GUI.  The problem is that some users just
refuse to measure at multiple fields and like to complain hard!
There's absolutely nothing we can do in the software that will change
such stubborn refusals ;)  The single field strength issue is
documented (see the 'About' button).  The second sentence is
&quot;Importantly, data at multiple magnetic field strengths is essential
for this analysis.&quot;.  This is also in the manual.  And if you look at
gui/analyses/auto_model_free.py, you will see from line 373:

        # Relaxation data.
        if not hasattr(cdp, 'ri_ids') or len(cdp.ri_ids) == 0:
            missing.append(&quot;Relaxation data&quot;)

        # Insufficient data.
        if hasattr(cdp, 'ri_ids') and len(cdp.ri_ids) &lt;= 3:
            missing.append(&quot;Insufficient relaxation data, 4 or more
data sets are essential for the execution of the dauvergne_protocol
auto-analysis.&quot;)

This will block the execution of the analysis, popping up the missing
data window.  It's also mentioned in the relax manual.  But I've just
added a few more sentences mentioning it in more prominent places in
the manual, just so you can close this thing and have less to do.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">And then these two:
 #21788 Only Warning is raised for missing loading R1 relaxation rate
for the off-resonance R1rho relaxation dispersion models. Confirmed
None Thu 13 Mar 2014 12:38:58 PM UTC
</pre></blockquote><pre style="margin: 0em;">

This is a trivial 3-4 line fix ;)  Really, this is incredibly easy!


</pre><blockquote class="blockquote"><pre style="margin: 0em;"> #22019 The IT99 model is listed with parameter kex instead of tex.
</pre></blockquote><pre style="margin: 0em;">

This is also rather easy :)  Though it is spread out in various parts of 
relax.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">Phew....
</pre></blockquote><pre style="margin: 0em;">

It sounds like a lot, but it should only be a few days to whack the
entire lot.  I believe that you are now capable enough with relax that
you could knock off the last 5 in this list in 10 min!  3 are simple
bug closures.  The Omega_eff part is a bit more work, but not too
much.  You just need to understand the data structures used at that
point in relax.  And the maths domain checking is important but with
the --numpy-raise flag, it's easy to work out the failure points and
fix them.  Unfortunately such checks do make the code slower!

Regards,

Edward


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00243" href="msg00243.html">Re: r23083 - /trunk/docs/latex/dispersion_software.tex</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00245" href="msg00245.html">Re: r23083 - /trunk/docs/latex/dispersion_software.tex</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu May 08 16:40:10 2014</div>  
</body>
</html>
