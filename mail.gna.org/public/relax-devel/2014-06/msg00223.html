<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: r23952 &#45; /branches/disp_spin_speed/lib/dispersion/ns_cpmg_2site_3d.py -->
<!--X-From-R13: "Sqjneq q'Ohiretar" &#60;rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Sun, 15 Jun 2014 10:34:23 +0200 -->
<!--X-Message-Id: CAED9pY9iWNhomp6v0Kv7&#45;=CYBkr0p=ohZ6LhxTGEC5kOP5EBgg@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: E1Ww4Jv&#45;0008P5&#45;7q@subversion.gna.org -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: r23952 - /branches/disp_spin_speed/lib/dispersion/ns_cpmg_2site_3d.py -- June 15, 2014 - 10:34</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: r23952 - /branches/disp_spin_speed/lib/dispersion/ns_cpmg_2site_3d.py</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00223" class="tabs">Index by Date</a> | <a href="threads.html#00223" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00222.html">Date Prev</a>] [<a href="msg00224.html">Date Next</a>] [<a href="msg00221.html">Thread Prev</a>] [<a href="msg00230.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Sun, 15 Jun 2014 10:33:52 +0200</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113; h=mime-version:sender:in-reply-to:references:date:message-id:subject :from:to:content-type; bh=os/4eipv8sec3tUbYENA2uCaZIAUtuF/N7q5d3yeKRQ=; b=bdsq/1ua9K88+iJtHtcT9lRskoFesAHmrWNpuMrf8+h5NrbpG8S2WU7Vn2MhDVd/UA rLCXP+MzCCdM4ZoUwMJbAmHFXzSIPkPV3u8PJPSPDU7qwsP6EvAr/ciSv7YPsGhB8ndS kjW0fs5B17ewFJxs3+e88ZPA9xRmfOuzxRkxd9ilccZXzv/79QzmRbzmuMDY8TQe9kZs /vQODSWLN/sa9ZCfLdTw70o7VnRQYX/PeZrHTIIArcdAxMf4BeCWQxvYbqq1rNyNLob1 HX36e3txRRhmZJAJoM6bW/divMAMctwx4vTuMONNhb85Fs5/yTJJxBo9Q3yfpEl89N/z re9Q==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;CAED9pY9iWNhomp6v0Kv7-=CYBkr0p=ohZ6LhxTGEC5kOP5EBgg@mail.gmail.com&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;E1Ww4Jv-0008P5-7q@subversion.gna.org&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on June 15, 2014 - 10:34:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi Troels,

Is this actually faster?  I just wrote a script to test this at
<a  rel="nofollow" href="https://gna.org/task/index.php?7807#comment199">https://gna.org/task/index.php?7807#comment199</a>.  The log file with the
results is also attached.  This is also archived at
<a  rel="nofollow" href="http://article.gmane.org/gmane.science.nmr.relax.devel/6240">http://article.gmane.org/gmane.science.nmr.relax.devel/6240</a>.  If you
look at that, I think I can show a way to make the numeric models up
to twice as fast.  And that is simply to use the out argument for the
dot product.  At least it will minimise the time required for the dot
products, and maybe remove this as the bottleneck.

Regards,

Edward



On 15 June 2014 08:53,  &lt;tlinnet@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Author: tlinnet
Date: Sun Jun 15 08:53:38 2014
New Revision: 23952

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=23952&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=23952&amp;view=rev</a>
Log:
Changed linked matrix/vector inner products into chained dot expressions.

Task #7807 (<a  rel="nofollow" href="https://gna.org/task/index.php?7807">https://gna.org/task/index.php?7807</a>): Speed-up of dispersion 
models for Clustered analysis.

Modified:
    branches/disp_spin_speed/lib/dispersion/ns_cpmg_2site_3d.py

Modified: branches/disp_spin_speed/lib/dispersion/ns_cpmg_2site_3d.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/disp_spin_speed/lib/dispersion/ns_cpmg_2site_3d.py?rev=23952&amp;r1=23951&amp;r2=23952&amp;view=diff">http://svn.gna.org/viewcvs/relax/branches/disp_spin_speed/lib/dispersion/ns_cpmg_2site_3d.py?rev=23952&amp;r1=23951&amp;r2=23952&amp;view=diff</a>
==============================================================================
--- branches/disp_spin_speed/lib/dispersion/ns_cpmg_2site_3d.py (original)
+++ branches/disp_spin_speed/lib/dispersion/ns_cpmg_2site_3d.py Sun Jun 15 
08:53:38 2014
@@ -56,6 +56,7 @@
 # Python module imports.
 from numpy import dot, fabs, isfinite, log, min, ones, ndarray
 from numpy.ma import fix_invalid, masked_less_equal, masked_where
+import numpy as np

 # relax module imports.
 from lib.dispersion.ns_matrices import rcpmg_3d
@@ -138,9 +139,7 @@

         # Loop over the CPMG elements, propagating the magnetisation.
         for j in range(2*power[i]):
-            Mint = dot(Rexpo, Mint)
-            Mint = dot(r180x, Mint)
-            Mint = dot(Rexpo, Mint)
+            Mint = Rexpo.dot(r180x).dot(Rexpo).dot(Mint)

         # The next lines calculate the R2eff using a two-point 
approximation, i.e. assuming that the decay is mono-exponential.
         Mx = Mint[1] / pA


_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-commits mailing list
relax-commits@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-commits">https://mail.gna.org/listinfo/relax-commits</a>
</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00230" href="msg00230.html">Re: r23952 - /branches/disp_spin_speed/lib/dispersion/ns_cpmg_2site_3d.py</a></strong>
<ul><li><em>From:</em> Troels Emtek√¶r Linnet</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Sun Jun 15 15:20:13 2014</div>  
</body>
</html>
