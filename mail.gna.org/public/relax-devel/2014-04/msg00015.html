<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: Paper describing exact solution of CMPG, 130 faster than numerical solution -->
<!--X-From-R13: @vxbynv Exelaavxbi &#60;avxbynvNcheqhr.rqh> -->
<!--X-Date: Tue, 22 Apr 2014 13:40:03 +0200 -->
<!--X-Message-Id: 535654F0.3090505@purdue.edu -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: CA+CBx2M30CtdSe3o5zv6dNazHjoFYUggjpMA57vmYOx_7LQabw@mail.gmail.com -->
<!--X-Reference: CAED9pY9nUX6veHERTFxUhVBU=R6EXpJ6Mx&#45;s9V59hgAtpDEcRQ@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Paper describing exact solution of CMPG, 130 faster than numerical solution -- April 22, 2014 - 13:40</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Paper describing exact solution of CMPG, 130 faster than numerical solution</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00015" class="tabs">Index by Date</a> | <a href="threads.html#00015" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00014.html">Date Prev</a>] [<a href="msg00016.html">Date Next</a>] [<a href="msg00014.html">Thread Prev</a>] [<a href="msg00018.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Edward d'Auvergne&quot; &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Tue, 22 Apr 2014 07:39:28 -0400</li>
<li class="menuitem">
<em>Cc</em>: Dominique Marion &lt;Dominique.Marion@xxxxxx&gt;, &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;, Martin Tollinger &lt;Martin.Tollinger@xxxxxxxxxx&gt;, Paul Schanda &lt;paul.schanda@xxxxxx&gt;</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00015.html">535654F0.3090505@purdue.edu</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;<a href="msg00012.html">CA+CBx2M30CtdSe3o5zv6dNazHjoFYUggjpMA57vmYOx_7LQabw@mail.gmail.com</a>&gt; &lt;CAED9pY9nUX6veHERTFxUhVBU=R6EXpJ6Mx-s9V59hgAtpDEcRQ@mail.gmail.com&gt;</li>
<li class="menuitem">
<em>User-agent</em>: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:12.0) Gecko/20120428 Thunderbird/12.0.1</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Nikolai Skrynnikov</strong> on April 22, 2014 - 13:40:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Hello all,

</pre><tt>I had had a lengthy discussion with Andy about our model (Tollinger et 
</tt><tt>al.).
</tt><tt>In the first version of his paper Andy chose to simply ignore it 
</tt><tt>(although he
</tt><pre style="margin: 0em;">
worked with the code). Upon my request he included the description, but
</pre><tt>insisted that our model is approximate. I looked into this and found 
</tt><tt>that our
</tt><tt>model can indeed generate round-off errors, but this happens under 
</tt><tt>contrived
</tt><tt>conditions (never encountered in real life) and the problem goes away if 
</tt><tt>one
</tt><pre style="margin: 0em;">
runs computations with increased precision.

I think the current version of the text is also unfair toward our model -
</pre><tt>it puts a great emphasis on numeric errors that are, quite frankly, 
</tt><tt>inconsequential.
</tt><tt>I should say in this respect Andy has been consistently not nice... But 
</tt><tt>his code
</tt><tt>must be better - it is more compact and ca. 10-times faster (according 
</tt><tt>to Andy).
</tt><tt>So in the case when one wants to run some sort of extensive global 
</tt><tt>fitting, Andy's
</tt><pre style="margin: 0em;">
code should be helpful.

Cheers,

--n


On 4/22/2014 6:28 AM, Edward d'Auvergne wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">
Hi,

That looks interesting.  I've CC'ed a few others who might also find
this paper interesting.  Though Andrew Baldwin's words are very strong
- probably stronger than needed to justify the creation of a new
dispersion model.  Note that reference 37 is:

Tollinger, M., Skrynnikov, N. R., Mulder, F. A., Forman-Kay, J. D.&amp;
Kay, L. E. Slow dynamics in folded and unfolded states of an SH3
domain. J Am Chem Soc 123, 11341-11352, (2001).

This is what he is referring to with the text &quot;As described in
Supplementary Section 8, while exact, this algorithm can lead to
significant errors...&quot;.  This is the 'NS CPMG 2-site expanded' model
used as the default numeric model in relax
(<a  rel="nofollow" href="http://wiki.nmr-relax.com/NS_CPMG_2-site_expanded">http://wiki.nmr-relax.com/NS_CPMG_2-site_expanded</a>) and the Maple code
was donated by Martin Tollinger and Nikolai Shrynnikov.  It was
translated to Python code by Mathilde Lescanne, Paul Schanda, and
Dominique Marion.  I then reformatted it to fit into the relax library
(<a  rel="nofollow" href="http://www.nmr-relax.com/api/3.1/lib.dispersion.ns_cpmg_2site_expanded-module.html">http://www.nmr-relax.com/api/3.1/lib.dispersion.ns_cpmg_2site_expanded-module.html</a>).

Anyway, if this is really an exact analytic solution for all
timescales and populations, and is numerically stable in the fast
exchange regime, then this would be very useful.  It obviously won't
handle off-resonance effects like CATIA can, and which relax might in
the future.  But it would replace the LM63
(<a  rel="nofollow" href="http://wiki.nmr-relax.com/LM63">http://wiki.nmr-relax.com/LM63</a>), CR72
(<a  rel="nofollow" href="http://wiki.nmr-relax.com/CR72">http://wiki.nmr-relax.com/CR72</a>), IT99
(<a  rel="nofollow" href="http://wiki.nmr-relax.com/IT99">http://wiki.nmr-relax.com/IT99</a>) and TSMFK01
(<a  rel="nofollow" href="http://wiki.nmr-relax.com/TSMFK01">http://wiki.nmr-relax.com/TSMFK01</a>) models.  And it would give
identical results to the numeric models, but would be orders of
magnitude faster.  It would be interesting to test against.  Note
those quotes you gave, if the previous is true then such statements
are not necessary and are just aggressive hyperbole.  What does
&quot;significant errors when evaluated at double floating point precision&quot;
even mean?  There's no citation or figure demonstrating this, and this
goes against what people would have seen in the field.  I have not
seen parameter errors that are not justified by the experimental
errors.  Anyway, an exact 2-site analytic solution for CPMG-type
experiments for all situations requires no justification for its
significance.

Would you be interested in adding a new dispersion model to relax?  If
yes, then you know what to do -
<a  rel="nofollow" href="http://wiki.nmr-relax.com/Tutorial_for_adding_relaxation_dispersion_models_to_relax">http://wiki.nmr-relax.com/Tutorial_for_adding_relaxation_dispersion_models_to_relax</a>
;)  Adding dispersion models to relax is a rather easy process,
especially if you are already a developer.  Going by the current
naming in relax, it would have the name of 'B14'.  It's a bit too late
to include in the relax relaxation dispersion paper though
(<a  rel="nofollow" href="http://dx.doi.org/10.1093/bioinformatics/btu166">http://dx.doi.org/10.1093/bioinformatics/btu166</a>).

Regards,

Edward


On 22 April 2014 11:32, Troels Emtek√¶r Linnet&lt;tlinnet@xxxxxxxxxxxxx&gt;  wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">
Hi Edward.

An interesting paper I just found in the alerts.

<a  rel="nofollow" href="http://dx.doi.org/10.1016/j.jmr.2014.02.023">http://dx.doi.org/10.1016/j.jmr.2014.02.023</a>

An exact solution for R2,eff in CPMG experiments in the case of two site
chemical exchange
By Andrew J. Baldwin


Specifically these lines in the introduction took my attention:
- <a  rel="nofollow" href="http://wiki.nmr-relax.com/CR72">http://wiki.nmr-relax.com/CR72</a>
&quot; When the population of the minor state exceeds approximately 1%,
calculation errors that are
larger than the experimental uncertainty can accumulate when the
Carver-Richards equation is used (Figure 1), which can lead to errors in the
extracted parameters.&quot;

- <a  rel="nofollow" href="http://wiki.nmr-relax.com/NS_CPMG_2-site_expanded">http://wiki.nmr-relax.com/NS_CPMG_2-site_expanded</a>
&quot;As described in Supplementary Section 8, while exact, this algorithm can
lead to significant errors when evaluated at double floating point
precision, as used by software such as MATLAB&quot;.

&quot;an exact solution for the effective transverse relaxation rate in a CPMG
experiment, R2,eff, in the commonly encountered scenario of two-site
exchange of in-phase magnetisation (Equation (50)) is derived. The result is
expressed as a linear correction to the Carver Richards equation (summarised
in Appendix 1), and algorithms based on this have significant advantages in
both precision and speed over existing formulaic approaches.&quot;

Best
Troels

_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-devel mailing list
relax-devel@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a>

</pre></blockquote></blockquote><pre style="margin: 0em;">


--
Nikolai R. Skrynnikov
Associate Professor
Department of Chemistry
Purdue University
560 Oval Drive
West Lafayette, IN 47907-2084
USA

phone: 765 - 494 8519
fax: 765 - 494 0239
e-mail: nikolai@xxxxxxxxxx




</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00018" href="msg00018.html">Re: Paper describing exact solution of CMPG, 130 faster than numerical solution</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00012" href="msg00012.html">Paper describing exact solution of CMPG, 130 faster than numerical solution</a></strong>
<ul><li><em>From:</em> Troels Emtek√¶r Linnet</li></ul></li>
<li><strong><a name="00014" href="msg00014.html">Re: Paper describing exact solution of CMPG, 130 faster than numerical solution</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Tue Apr 22 15:00:15 2014</div>  
</body>
</html>
