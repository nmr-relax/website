<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [task #7807] Speed&#45;up of dispersion models for Clustered analysis -->
<!--X-From-R13: "Sqjneq q'Ohiretar" &#60;rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Wed, 18 Jun 2014 11:55:41 +0200 -->
<!--X-Message-Id: CAED9pY9trxFi6+YeKUQoDWNihF5iV=9fGiKiENUPqp=T&#45;cd+Ow@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20140606&#45;164034.sv20529.18004@gna.org -->
<!--X-Reference: 20140606&#45;203152.sv20529.82733@gna.org -->
<!--X-Reference: 20140607&#45;192042.sv20529.55008@gna.org -->
<!--X-Reference: 20140608&#45;115339.sv20529.22097@gna.org -->
<!--X-Reference: 20140608&#45;175211.sv20529.15019@gna.org -->
<!--X-Reference: 20140608&#45;182605.sv20529.57278@gna.org -->
<!--X-Reference: 20140608&#45;183428.sv20529.91269@gna.org -->
<!--X-Reference: 20140608&#45;184803.sv20529.12856@gna.org -->
<!--X-Reference: 20140608&#45;214642.sv20529.45231@gna.org -->
<!--X-Reference: 20140608&#45;224658.sv20529.82233@gna.org -->
<!--X-Reference: 20140609&#45;230256.sv20529.53904@gna.org -->
<!--X-Reference: 20140610&#45;170645.sv20529.74988@gna.org -->
<!--X-Reference: 20140611&#45;154047.sv2782.24206@gna.org -->
<!--X-Reference: 20140615&#45;083021.sv2782.41765@gna.org -->
<!--X-Reference: 20140615&#45;193016.sv2782.64447@gna.org -->
<!--X-Reference: 20140616&#45;073736.sv2782.63937@gna.org -->
<!--X-Reference: 20140617&#45;183115.sv20529.58952@gna.org -->
<!--X-Reference: CAED9pY9L55wz0DhvELFcU2i9_wtcdbDL8r5Ytf9d8K+_RajHMQ@mail.gmail.com -->
<!--X-Reference: CA+CBx2P=XZvfv+f_UF1D=LPr5a&#45;d9u04zp87O4qdtb&#45;K_c47gQ@mail.gmail.com -->
<!--X-Reference: CAED9pY8VgworKFWBD6UFfu2STF54cKMOfbrrKk7f7Xg8Jf&#45;LSA@mail.gmail.com -->
<!--X-Reference: CAED9pY&#45;K8M8R1a2aZfZoMBOkvPruEQ8Joibjwpdz1L2MwvgDmg@mail.gmail.com -->
<!--X-Reference: CAED9pY8+2te=3m8fFeuFyUW8vPyO8avFYDoWWjr3VoDye1BvAg@mail.gmail.com -->
<!--X-Reference: CA+CBx2P&#45;UkzpGcZ8VB8CQY3NKcXdYNPSZPn2VefJ5wW8ypJF4A@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [task #7807] Speed-up of dispersion models for Clustered analysis -- June 18, 2014 - 11:55</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: [task #7807] Speed-up of dispersion models for Clustered analysis</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00346" class="tabs">Index by Date</a> | <a href="threads.html#00346" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00345.html">Date Prev</a>] [<a href="msg00347.html">Date Next</a>] [<a href="msg00343.html">Thread Prev</a>] [<a href="msg00347.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Wed, 18 Jun 2014 11:55:09 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;Troels E. Linnet&quot; &lt;NO-REPLY.INVALID-ADDRESS@xxxxxxx&gt;, &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113; h=mime-version:sender:in-reply-to:references:date:message-id:subject :from:to:cc:content-type:content-transfer-encoding; bh=NJBjvfCeB1ks5jQQJtGydqiXjInMUsdcEpoyuf1HI3Y=; b=MdA5V4glRit0Rd+yun2cSi4aw3jcTRDgAikzH1K+IGLw5C4iKaF8AfqlJSJ+XRTFjc U7Pe2EkK9PeL52Bxepfr8WpGGVXfnKj+/AigtSoWxM1U1O2anX7djEFWYGALpRXGFVJA UAU6TaHB+pQoQIbol6oV6gqNX7eix8FxDtfqQ+wWyzb1SPlHKb6O/8wlZTdWU/kvTtBf uZ5Lu1ITs5Qm8TK6vFAOJ41yxHDk/jApXDTo1oLmNhViQMzsSuHNHx8neMEeTGJsoVLg OrSJXbOY1wnpCQNZjZEIwVsyxLeKX5nn8gP/vd84CE5q3db0JJLvPl+MSWuqs45nwIaC /RWQ==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;CAED9pY9trxFi6+YeKUQoDWNihF5iV=9fGiKiENUPqp=T-cd+Ow@mail.gmail.com&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;<a href="msg00069.html">20140606-164034.sv20529.18004@gna.org</a>&gt; &lt;<a href="msg00071.html">20140606-203152.sv20529.82733@gna.org</a>&gt; &lt;<a href="msg00072.html">20140607-192042.sv20529.55008@gna.org</a>&gt; &lt;<a href="msg00073.html">20140608-115339.sv20529.22097@gna.org</a>&gt; &lt;<a href="msg00074.html">20140608-175211.sv20529.15019@gna.org</a>&gt; &lt;<a href="msg00075.html">20140608-182605.sv20529.57278@gna.org</a>&gt; &lt;<a href="msg00076.html">20140608-183428.sv20529.91269@gna.org</a>&gt; &lt;<a href="msg00077.html">20140608-184803.sv20529.12856@gna.org</a>&gt; &lt;<a href="msg00078.html">20140608-214642.sv20529.45231@gna.org</a>&gt; &lt;<a href="msg00079.html">20140608-224658.sv20529.82233@gna.org</a>&gt; &lt;<a href="msg00082.html">20140609-230256.sv20529.53904@gna.org</a>&gt; &lt;<a href="msg00131.html">20140610-170645.sv20529.74988@gna.org</a>&gt; &lt;<a href="msg00177.html">20140611-154047.sv2782.24206@gna.org</a>&gt; &lt;<a href="msg00222.html">20140615-083021.sv2782.41765@gna.org</a>&gt; &lt;<a href="msg00245.html">20140615-193016.sv2782.64447@gna.org</a>&gt; &lt;<a href="msg00248.html">20140616-073736.sv2782.63937@gna.org</a>&gt; &lt;<a href="msg00306.html">20140617-183115.sv20529.58952@gna.org</a>&gt; &lt;<a href="msg00317.html">CAED9pY9L55wz0DhvELFcU2i9_wtcdbDL8r5Ytf9d8K+_RajHMQ@mail.gmail.com</a>&gt; &lt;CA+CBx2P=XZvfv+f_UF1D=LPr5a-d9u04zp87O4qdtb-K_c47gQ@mail.gmail.com&gt; &lt;<a href="msg00323.html">CAED9pY8VgworKFWBD6UFfu2STF54cKMOfbrrKk7f7Xg8Jf-LSA@mail.gmail.com</a>&gt; &lt;<a href="msg00325.html">CAED9pY-K8M8R1a2aZfZoMBOkvPruEQ8Joibjwpdz1L2MwvgDmg@mail.gmail.com</a>&gt; &lt;CAED9pY8+2te=3m8fFeuFyUW8vPyO8avFYDoWWjr3VoDye1BvAg@mail.gmail.com&gt; &lt;<a href="msg00343.html">CA+CBx2P-UkzpGcZ8VB8CQY3NKcXdYNPSZPn2VefJ5wW8ypJF4A@mail.gmail.com</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on June 18, 2014 - 11:55:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Sounds like some special masking is required to allow the r2eff/r1rho
values to be calculated for all, even with numpy warnings, but then
reset to the r20/r1rho_prime values for the spins with dw == 0.0.
Should this be considered a bug?  Will this be a problem if I merge
the branch back to the trunk?

Cheers,

Edward



On 18 June 2014 11:42, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi ed.

Comment to
&quot;Wait for replacement, since this is spin specific.&quot;

When doing a clustered analysis, some of the spins can have
dw = 0.0

I cannot just throw the whole result back as r20, if just some of the spins
have
dw = 0.0.

Best
Troels



2014-06-18 9:04 GMT+02:00 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:

</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

I'll make a running list of things to be done prior to merger of the
branch.  These include my previous points, and a few new ones:

- Shift once off parameter conversions to lib.dispersion.

- DPL94 profiling script is broken.  This is not essential but it
would show far more impressive speed ups than the current scripts -
really a lot more.

- Replace &quot;##&quot; with &quot;#&quot;.

- You need to add your name to the copyright notice of all
lib.dispersion modules, appending to the bottom of the current list of
authors (these are sorted by date).

- Write a script for running all profiling scripts and making a table
of speed ups to present in the release messages (I'll do that, it's an
easy job :).

- For the dw == 0.0 checks, you have the comment text &quot;Wait for
replacement, since this is spin specific.&quot;.  What does this mean?

- For the 'MMQ CR72' model, for a little speed and for consistency,
the eta_scale variable can be shifted out of the function just like
you have done with the 'CR72' model.

To obtain the fastest Python code possible there are still a number of
minor speed ups though, compared to the current changes, they are
nothing.  But they can be reserved for a future date.  Anyway, I'll
keep looking at the code and expand the list as needed.

Cheers!

Edward


On 18 June 2014 08:30, Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Oh, and the DPL94 profiling script is not in a functional state.  So
only analytic CPMG models are covered.  One R1rho model would be
useful as the speed up there, if there are many offsets, could be up
to an order of magnitude faster than the CPMG models!  I think you
will see a speed up of over 100 times.

Regards,

Edward

On 18 June 2014 08:19, Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

I'll look into it, it should only take me a few minutes to script up.
I can copy the disp_spin_speed branch scripts directly into the trunk,
and they run if I remove the *_orig arguments to the r2eff_*()
functions.  The reason I asked if you had more plans for the profiling
scripts is because you only have the B14, CR72, DPL94, and TSMFK01
models covered.

Regards,

Edward


On 17 June 2014 23:39, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt;
wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Edward.

This does indeed sound very good. It would weight much for me, to know
how
much my effort have paid off. But I can't allocate more time for
anything
strictly needed.

Best
Troels

On 17 Jun 2014 22:55, &quot;Edward d'Auvergne&quot; &lt;edward@xxxxxxxxxxxxx&gt;
wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">

Not quite yet ;)  I have to merge this back to trunk.  But first I
need to
see if there is anything to clean up (whitespace, comments,
formatting,
naming consistency, API consistency, etc.).  And then this needs to
be
released to all relax users, either as relax 3.2.3, or as 3.2.4 with
3.2.3
being reserved for all other trunk changes.

For presenting this, I was thinking of a timing table from you
profiling
scripts.  Do you intend on creating a few more?  Maybe for a numeric
model
were I think there are speed ups, though no where near what you are
seeing
for the analytic models.  I was thinking of witing one master script
that
runs all your profiling scripts, one after the other, then repeating
this 10
times.  The log would be captured by the script, and then there will
be
timing statistics for each (grepping just for the func_*() target
functions
for a single number to use), so that an average and standard
deviation can
be presented for relax 3.2.2 vs. the new code.  Then in the release
message,
it would look like:

Speed comparison for relax-3.2.2 vs. relax-3.2.3:

Single spin analysis:
CR72:  3.2+/-0.3 s vs. 2.8+/-0.2 s -&gt; 1.14x faster
LM63: ...

Cluster of 100 spins:
CR72:  53.5+/-2.4 s vs. 3.6+/-0.2 s -&gt; 14.9x faster

This would be a great way to strongly present these insane speed ups.
What do you think?

Regards,

Edward



On Tuesday, 17 June 2014, Troels E. Linnet
&lt;NO-REPLY.INVALID-ADDRESS@xxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">

Update of task #7807 (project relax):

        Percent Complete:                      0% =&gt; 100%
             Open/Closed:                    Open =&gt; Closed
                  Effort:                    0.00 =&gt; 100

    _______________________________________________________

Follow-up Comment #263:

This now complete.

    _______________________________________________________

Reply to this item at:

  &lt;<a  rel="nofollow" href="http://gna.org/task/?7807">http://gna.org/task/?7807</a>&gt;

_______________________________________________
  Message sent via/by Gna!
  <a  rel="nofollow" href="http://gna.org/">http://gna.org/</a>

</pre></blockquote></blockquote><pre style="margin: 0em;">

</pre></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">


</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00347" href="msg00347.html">Re: [task #7807] Speed-up of dispersion models for Clustered analysis</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00069" href="msg00069.html">[task #7807] Speed-up of dispersion models for Clustered analysis</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00071" href="msg00071.html">[task #7807] Speed-up of dispersion models for Clustered analysis</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00072" href="msg00072.html">[task #7807] Speed-up of dispersion models for Clustered analysis</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00073" href="msg00073.html">[task #7807] Speed-up of dispersion models for Clustered analysis</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00074" href="msg00074.html">[task #7807] Speed-up of dispersion models for Clustered analysis</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00075" href="msg00075.html">[task #7807] Speed-up of dispersion models for Clustered analysis</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00076" href="msg00076.html">[task #7807] Speed-up of dispersion models for Clustered analysis</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00077" href="msg00077.html">[task #7807] Speed-up of dispersion models for Clustered analysis</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00078" href="msg00078.html">[task #7807] Speed-up of dispersion models for Clustered analysis</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00079" href="msg00079.html">[task #7807] Speed-up of dispersion models for Clustered analysis</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00082" href="msg00082.html">[task #7807] Speed-up of dispersion models for Clustered analysis</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00131" href="msg00131.html">[task #7807] Speed-up of dispersion models for Clustered analysis</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00177" href="msg00177.html">[task #7807] Speed-up of dispersion models for Clustered analysis</a></strong>
<ul><li><em>From:</em> Edward d Auvergne</li></ul></li>
<li><strong><a name="00222" href="msg00222.html">[task #7807] Speed-up of dispersion models for Clustered analysis</a></strong>
<ul><li><em>From:</em> Edward d Auvergne</li></ul></li>
<li><strong><a name="00245" href="msg00245.html">[task #7807] Speed-up of dispersion models for Clustered analysis</a></strong>
<ul><li><em>From:</em> Edward d Auvergne</li></ul></li>
<li><strong><a name="00248" href="msg00248.html">[task #7807] Speed-up of dispersion models for Clustered analysis</a></strong>
<ul><li><em>From:</em> Edward d Auvergne</li></ul></li>
<li><strong><a name="00306" href="msg00306.html">[task #7807] Speed-up of dispersion models for Clustered analysis</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00317" href="msg00317.html">Re: [task #7807] Speed-up of dispersion models for Clustered analysis</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00322" href="msg00322.html">Re: [task #7807] Speed-up of dispersion models for Clustered analysis</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00323" href="msg00323.html">Re: [task #7807] Speed-up of dispersion models for Clustered analysis</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00325" href="msg00325.html">Re: [task #7807] Speed-up of dispersion models for Clustered analysis</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00326" href="msg00326.html">Re: [task #7807] Speed-up of dispersion models for Clustered analysis</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00343" href="msg00343.html">Re: [task #7807] Speed-up of dispersion models for Clustered analysis</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Wed Jun 18 12:20:41 2014</div>  
</body>
</html>
