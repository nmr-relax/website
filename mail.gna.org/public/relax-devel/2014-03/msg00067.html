<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: Optimisation of the R1 relaxation rate for the off&#45;resonance R1rho relaxation dispersion models. -->
<!--X-From-R13: "Sqjneq q'Ohiretar" &#60;rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Thu, 13 Mar 2014 12:24:37 +0100 -->
<!--X-Message-Id: CAED9pY&#45;oD5+V5k&#45;mLa=X1pL3citFMwctPGcB59q&#45;JpNsNtYsPw@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: CAED9pY_=_w2TnOPeH9dQtqQjRq8X78Kb0=kSphWu0CX2g5DkeQ@mail.gmail.com -->
<!--X-Reference: CA+CBx2NoJtL25=j+nZKfrn743iN&#45;=Y5v5SOrT8_qyUMV0ctriQ@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Optimisation of the R1 relaxation rate for the off-resonance R1rho relaxation dispersion models. -- March 13, 2014 - 12:24</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Optimisation of the R1 relaxation rate for the off-resonance R1rho relaxation dispersion models.</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00067" class="tabs">Index by Date</a> | <a href="threads.html#00067" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00066.html">Date Prev</a>] [<a href="msg00068.html">Date Next</a>] [<a href="msg00066.html">Thread Prev</a>] [<a href="msg00068.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Thu, 13 Mar 2014 12:24:05 +0100</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113; h=mime-version:sender:in-reply-to:references:date:message-id:subject :from:to:cc:content-type; bh=WjO4mJDIlUT05TeLpCJSGsTNvwScBulFkBq1jZWYQ+A=; b=VQfyXwNaTmd7kmuf8OSLtQ5EmkHXiku5H7Nt7kkq9xNgZfSkil+a3rnCsyhJWUHmS4 MTbAjmScfUDTvJDXnAyAyjSu9mi5tStVvtUdPUhh4VlYpUO3cfff+o+nysLqMmzRZbq8 sosqjjXJT29X6T3RO09oFWWnULxFjpgFYnC1//jNC0Ohvfsv8XaiFjPW7nGotHZ4ShFy uE4MiwBUB/oK9XlHZ4NAqLkXxZ2eg3jZSd5Jp4sRhIV0oPKcfOg4RPT3uhgHY6VuaXsT 6i7MIqfJIA6pwchIE25fQpfDAUzS0QorJQsiSaxnTc+tA7qepgxLTezY6lWLa/NocLEq e/Kg==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;CAED9pY-oD5+V5k-mLa=X1pL3citFMwctPGcB59q-JpNsNtYsPw@mail.gmail.com&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;CAED9pY_=_w2TnOPeH9dQtqQjRq8X78Kb0=kSphWu0CX2g5DkeQ@mail.gmail.com&gt; &lt;CA+CBx2NoJtL25=j+nZKfrn743iN-=Y5v5SOrT8_qyUMV0ctriQ@mail.gmail.com&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on March 13, 2014 - 12:24:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi,

Please see below:

</pre><blockquote class="blockquote"><pre style="margin: 0em;">As you may are aware, I am trying to reproduce parameters from the
article of Kjaergaard et al. <a  rel="nofollow" href="http://dx.doi.org/10.1021/bi4001062">http://dx.doi.org/10.1021/bi4001062</a>

In this article, the R1 rate was fitted in the model of DPL94.

At the moment, I am reading in the R1 fitted values from this article, to
be used at relax R1 values.
</pre></blockquote><pre style="margin: 0em;">

I had forgotten that this was your plan of attack.  If it doesn't work
with direct R1 input, then optimising R1 would be pointless.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">I have a little trouble to reach the same fitted parameters, and my first
idea is to produce graphs, which will convince me that my input values
are correct.
</pre></blockquote><pre style="margin: 0em;">

This is a good check.  These graphs would also be of general benefit
to all relax users (well, those performing a dispersion analysis).
Now that the hard part is out of the way - the infrastructure - you
should have the R2eff dispersion plots functional very soon.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">Whether or not this implementation is good, I have a little trouble
figuring out.
</pre></blockquote><pre style="margin: 0em;">

</pre><blockquote class="blockquote"><pre style="margin: 0em;">From the commits so far it looks good.  You now have all of the base
</pre></blockquote><pre style="margin: 0em;">data at hand that you need for the plots.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">I have now spent around 2 weeks, just to produce graphs, and implementing
the TSMFK01 model took me around 3 weeks?
So spending my time is really an issue here.
</pre></blockquote><pre style="margin: 0em;">

The time depends on the task.  As you have implemented some very
important infrastructure, this always takes a bit longer.  And the
amount of learning of the code base and the entire relax
infrastructure must have been a large part of that time.  Especially
starting with the TSMFK01 model.  I'm actually pleasantly surprised by
the speed of things as it often takes developers longer to familiarise
themselves with the project - especially considering how many areas in
relax you have touched.  You will probably find that implementing the
R1 optimisation will be much quicker, especially if we plan it all out
in advance.  Planning might take a few days - this will be the longest
step.  But then I think you are now capable enough to have the code
and new system tests (via copying) implemented within 1-2 days.
Anyway, reproducing the results with fixed R1 values is more important
for now.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">The smallest implementation, would be implementing a DPL94 model where
R1 is also fitted.
By adding R1fit as a parameter in relax and write a new target function.
I have no goal to implement this for other models.
</pre></blockquote><pre style="margin: 0em;">

With planning, I think I can see how the code changes would
automatically apply to all models ;)  The code separation of the
specific_analyses, target_functions and relax library packages will be
a huge advantage for this and should make the task rather trivial.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">Whether or not this model should be available as a standard model in
the GUI is up for discussion.
</pre></blockquote><pre style="margin: 0em;">

This is where planning is useful.  Maybe a relax_disp user function
could be added to activate R1 optimisation (this would be model
independent).  It could have a flag which could be set to True or
False to allow this to be turned on or off.  Then the R1 button in the
GUI could have a new wizard added, where the first page presents a
choice - load R1 or optimise R1, with text telling the user that it is
far more favourable to collect the data so as to simplify optimisation
and minimise parameter errors.  If 'load R1' is chosen, then the
current relax_data.read user function is presented.  If 'optimise R1'
is chosen, then a flag is stored in the current data pipe and the
wizard exits.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">I think I would have to return to this issue after producing graphs,
running a global fit for the
15 residues, inspect results, double check input values and units
before considering this issue again.
</pre></blockquote><pre style="margin: 0em;">

True.  I'm sure you are close though!


</pre><blockquote class="blockquote"><pre style="margin: 0em;">I do think that relax should raise an Error rather than Warning, when
no R1 data is loaded in.
The warning message is lost in the long logfile, and setting the R1
value to 0, is dangerous.
</pre></blockquote><pre style="margin: 0em;">

I think this is a good idea.  Is it really only giving a warning?
That is really not good!  If the user wants R1 values of 0, they can
create a file full of zeros and read that in.  This must be a result
of implementing the R1rho dispersion models - I must have set this for
debugging purposes and forgotten about it.  Feel free to fix!

Also, have a look at the missing list in the assemble_data() method in
the gui.analyses.auto_relax_disp module.  Here the R1 data should be
added to the missing list, if missing (with the same checks as for the
RelaxWarning which should be a RelaxError).  Then this will
automatically present a window to the user when they click on
&quot;Execute&quot; saying that the R1 data is missing.  That is a better way to
communicate to the user in the GUI and is how I have implemented this
for all GUI analysis types.  For simplicity, the R1 check for the
RelaxError could be shifted into specific_analyses.relax_disp.checks
and then reused for the GUI to add text to the missing list.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">One could consider the two possibilities for the missing of reading R1 
values.
Either relax should change to the model, where R1 is fitted of the
user should actively
chose the model where R1 is fitted.
I prefer the last option.
</pre></blockquote><pre style="margin: 0em;">

User input into the subject is best.  We can never know what a user
really wants, so forcing them to say what they want is best.  And if
it is a mistake, a RelaxError should be raised explaining to the user
the exact problem.  I think that having a new relax_disp user function
allowing the user to say that R1 should be optimised is the simplest
implementation and easiest to understand.  Then we change the
specific_analyses annd target_functions code to handle this (the lib
package will require no changes :).

Regards,

Edward


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00065" href="msg00065.html">Optimisation of the R1 relaxation rate for the off-resonance R1rho relaxation dispersion models.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00066" href="msg00066.html">Re: Optimisation of the R1 relaxation rate for the off-resonance R1rho relaxation dispersion models.</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu Mar 13 13:40:24 2014</div>  
</body>
</html>
