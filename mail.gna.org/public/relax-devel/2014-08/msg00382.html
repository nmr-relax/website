<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: Comparison of Monte Carlo simulations vs. covariance matrix. -->
<!--X-From-R13: "Sqjneq q'Ohiretar" &#60;rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Fri, 29 Aug 2014 17:06:54 +0200 -->
<!--X-Message-Id: CAED9pY8a8vgvArU_6=KdAa3KO86Bi+0JXYGeeaSgJEGzcuNJrQ@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: CAED9pY_k8MJ4f6qooeZFPGRXyKyjzE7CcQpSv7Wav38M5Kaa9A@mail.gmail.com -->
<!--X-Reference: CA+CBx2MyL+iLPLCqnc5PUaeHX&#45;a=L64cP0smaqSmhU=E4z3_EQ@mail.gmail.com -->
<!--X-Reference: CAED9pY&#45;ZEV&#45;WQ9rdZDypBcEyuaqntMhDQ4mAsQ6Mc+8oMM=eVA@mail.gmail.com -->
<!--X-Reference: CA+CBx2PePmQpGr_7bzW&#45;ck5uNnKp8RejmLuQbrOTo9bn5O0q_A@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Comparison of Monte Carlo simulations vs. covariance matrix. -- August 29, 2014 - 17:06</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Comparison of Monte Carlo simulations vs. covariance matrix.</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00382" class="tabs">Index by Date</a> | <a href="threads.html#00382" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00381.html">Date Prev</a>] [<a href="msg00383.html">Date Next</a>] [<a href="msg00381.html">Thread Prev</a>] [<a href="msg00389.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Fri, 29 Aug 2014 17:06:24 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113; h=mime-version:sender:in-reply-to:references:date:message-id:subject :from:to:cc:content-type:content-transfer-encoding; bh=yRqHBBgBnIBAm56AjL0Vq4o5Sf5v8QEJnjDDRXD3tdI=; b=HeibQFYybtWQULLxu/rTp0xVbpuYIs4mZeavkEK+LFbiUbjsa1b/x4iQvsdrca5P+R w4Ow3zd+hwg5APqow1OQT3GVx0GUwVRKwGm3IyOnEEnNW45fVKsf7w/aZpM4Y93P8ks6 0dENJ8KJmqYxXuM+NzypYrXUqlx24s2/3jlADjsWGnotaGIrGuP96S6w2ZBL7Utc2Li/ fw9inEOBL0yfJWYpGeYikOTMQA561kjEHF53f9bSQ0k6jqOZ3gQ4+zO6UIna1+sbdaEx 0HWNnWOT52F1P3O0hZGtIDMmkIeULkHA4pIzybtbZaQzRPMUFBKX2+RnbERYry2JzSWt +dAA==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;CAED9pY8a8vgvArU_6=KdAa3KO86Bi+0JXYGeeaSgJEGzcuNJrQ@mail.gmail.com&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;<a href="msg00376.html">CAED9pY_k8MJ4f6qooeZFPGRXyKyjzE7CcQpSv7Wav38M5Kaa9A@mail.gmail.com</a>&gt; &lt;CA+CBx2MyL+iLPLCqnc5PUaeHX-a=L64cP0smaqSmhU=E4z3_EQ@mail.gmail.com&gt; &lt;CAED9pY-ZEV-WQ9rdZDypBcEyuaqntMhDQ4mAsQ6Mc+8oMM=eVA@mail.gmail.com&gt; &lt;<a href="msg00381.html">CA+CBx2PePmQpGr_7bzW-ck5uNnKp8RejmLuQbrOTo9bn5O0q_A@mail.gmail.com</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on August 29, 2014 - 17:06:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">I've just added the 2D Grace plots for this to the repository (r25444,
<a  rel="nofollow" href="http://article.gmane.org/gmane.science.nmr.relax.scm/23194">http://article.gmane.org/gmane.science.nmr.relax.scm/23194</a>).  They are
also attached to the task for easier access
(<a  rel="nofollow" href="https://gna.org/task/index.php?7822#comment107">https://gna.org/task/index.php?7822#comment107</a>).  From these plots I
see that the I0 error appears to be reasonable, but that the R2eff
errors are overestimated by 1.9555.

The plots are very, very different.  It is clear that
chi2_jacobian=True just gives rubbish.  It is also clear that there is
a perfect correlation in R2eff when chi2_jacobian=False.  The plot
shows absolutely no scattering, therefore this indicates a crystal
clear mathematical error somewhere.  I wonder where that could be.  It
may not be a factor of 2, as the correlation is 1.9555.  So it might
be a bug that is more complicated.  In any case, overestimating the
errors by ~2 and performing a dispersion analysis is not possible.
This will significantly change the curvature of the optimisation space
and will also have a huge effect on statistical comparisons between
models.

Regards,

Edward



On 29 August 2014 16:56, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">The default is now chi2_jacobian=False.

You will hopefully see, that the errors are double.

Best
Troels

2014-08-29 16:43 GMT+02:00 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Terrible ;)  For R2eff, the correlation is 2.748 and the points are
spread out all over the place.  For I0, the correlation is 3.5 and the
points are also spread out everywhere.  Maybe I should try with the
change from:

relax_disp.r2eff_err_estimate(chi2_jacobian=True)

to:

relax_disp.r2eff_err_estimate(chi2_jacobian=False)

How should this be used?

Cheers,

Edward



On 29 August 2014 16:33, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt; 
wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Do you mean terrible or double?

Best
Troels

2014-08-29 16:15 GMT+02:00 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Troels,

I really cannot follow and judge how the techniques compare.  I must
be getting old.  So to remedy this, I have created the
test_suite/shared_data/dispersion/Kjaergaard_et_al_2013/exp_error_analysis/
directory (r25437,
<a  rel="nofollow" href="http://article.gmane.org/gmane.science.nmr.relax.scm/23187">http://article.gmane.org/gmane.science.nmr.relax.scm/23187</a>).  This
contains 3 scripts for comparing R2eff and I0 parameters for the 2
parameter exponential curve-fitting:

1)  A simple script to perform Monte Carlo simulation error analysis.
This is run with 10,000 simulations to act as the gold standard.

2)  A simple script to perform covariance matrix error analysis.

3)  A simple script to generate 2D Grace plots to visualise the
differences.  Now I can see how good the covariance matrix technique
is :)

Could you please check and see if I have used the
relax_disp.r2eff_err_estimate user function correctly?  The Grace
plots show that the error estimates are currently terrible.

Cheers,

Edward

_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-devel mailing list
relax-devel@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a>
</pre></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00389" href="msg00389.html">Re: Comparison of Monte Carlo simulations vs. covariance matrix.</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00376" href="msg00376.html">Comparison of Monte Carlo simulations vs. covariance matrix.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00378" href="msg00378.html">Re: Comparison of Monte Carlo simulations vs. covariance matrix.</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00379" href="msg00379.html">Re: Comparison of Monte Carlo simulations vs. covariance matrix.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00381" href="msg00381.html">Re: Comparison of Monte Carlo simulations vs. covariance matrix.</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Fri Aug 29 21:40:15 2014</div>  
</body>
</html>
