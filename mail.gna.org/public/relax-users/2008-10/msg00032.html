<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: Relax_fit.py problem -->
<!--X-From-R13: Flyre Drqql <FDSRRKNROZ.QO> -->
<!--X-Date: Wed, 15 Oct 2008 19:34:12 +0200 -->
<!--X-Message-Id: 20081015143028.k839mry41tcsg0ko@my5.dal.ca -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20081008120727.ydgz29n4sf4gowww@my4.dal.ca -->
<!--X-Reference: 7f080ed10810080943g4228140ev43c8f481ccac0a37@mail.gmail.com -->
<!--X-Reference: 20081013144416.y8sycmhkxqg488og@my6.dal.ca -->
<!--X-Reference: 7f080ed10810141250y26c6889bu8686a3139d9d02bc@mail.gmail.com -->
<!--X-Reference: 20081015105356.9thn6ozzyxqwcsos@my5.dal.ca -->
<!--X-Reference: 20081015115624.g6nz5yvwoo4ksk4k@my1.dal.ca -->
<!--X-Reference: 7f080ed10810150931j7a1a3886i6ec686352f53e2f3@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Relax_fit.py problem -- October 15, 2008 - 19:34</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Relax_fit.py problem</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00032" class="tabs">Index by Date</a> | <a href="threads.html#00032" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00031.html">Date Prev</a>] [<a href="msg00033.html">Date Next</a>] [<a href="msg00031.html">Thread Prev</a>] [<a href="msg00033.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Edward d'Auvergne&quot; &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Wed, 15 Oct 2008 14:30:28 -0300</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-users@xxxxxxx&quot; &lt;relax-users@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00032.html">20081015143028.k839mry41tcsg0ko@my5.dal.ca</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;20081008120727.ydgz29n4sf4gowww@xxxxxxxxxx&gt;	&lt;7f080ed10810080943g4228140ev43c8f481ccac0a37@xxxxxxxxxxxxxx&gt;	&lt;20081013144416.y8sycmhkxqg488og@xxxxxxxxxx&gt;	&lt;7f080ed10810141250y26c6889bu8686a3139d9d02bc@xxxxxxxxxxxxxx&gt;	&lt;20081015105356.9thn6ozzyxqwcsos@xxxxxxxxxx&gt;	&lt;20081015115624.g6nz5yvwoo4ksk4k@xxxxxxxxxx&gt;	&lt;7f080ed10810150931j7a1a3886i6ec686352f53e2f3@xxxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>User-agent</em>: Internet Messaging Program (IMP) H3 (4.0.3)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Tyler Reddy</strong> on October 15, 2008 - 19:34:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Okay, so I'll basically just need to get the rms noise (NOT S/N) for my T1 and
T2 spectra at various fields. I've been using S/N values for the NOE
calculations so that explains why those errors seemed so large. I'd like to
find a reference for the rms equation which seems to be:

[sqrt(2)]*(baseline noise height)/4

</pre><tt>Ignoring the stuff with duplicate spectra, it's actually a rather nice 
</tt><tt>situation
</tt><pre style="margin: 0em;">
with only peak height and baseline noise height being the information required
for the calculation of NOE, R1, R2, and the propagation of their respective
errors. Presumably this would then be enough to begin the model-free analysis
in relax?

Tyler



Quoting Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:

</pre><blockquote class="blockquote"><pre style="margin: 0em;">
On Wed, Oct 15, 2008 at 4:56 PM, Tyler Reddy &lt;TREDDY@xxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">
Hey,

Farrow et al. (1994) Biochemistry, 33: 5984-6003 also draw a similar
conclusion
(paragraph starting at bottom left of p. 5988) and apply the RMS value of
the
noise as an estimate of the standard deviation of peak intensity. If I'm not
mistaken this is the exact assumption made by relax for steady-state NOE
error
propagation by the sum of squares equation from this paper as well.
</pre></blockquote><pre style="margin: 0em;">

That is another reference I am very familiar with.  It influenced my
choice of not using the sqrt(2) factor for the NOE.  And there is the
NOE error equation I used!  There is another publication which has
this equation, but in quite a different form (it almost looks like a
different equation).  It's also given in general form at
<a  rel="nofollow" href="http://en.wikipedia.org/wiki/Error_propagation">http://en.wikipedia.org/wiki/Error_propagation</a> as the variance of the
ratio of two random variables.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">
Also of interest on p. 5988,

&quot;The distribution of the difference in intensities of identical peaks in
duplicate spectra should have a standard deviation [sqrt(2)] times greater
than
the standard deviation of the individual peaks.&quot;
</pre></blockquote><pre style="margin: 0em;">

I'll have to check the source code, but from memory this factor was
not used when using duplicate spectra.  Let me see...  Ok, relax is
not dividing by sqrt(2) when calculating one error value from a
duplicated spectrum.  I have to think about this because relax is not
calculating the standard deviation of a distribution of differences,
as talked about in Palmer et al., 1991 and Farrow et al., 1994.  It's
calculating the population standard deviation for each spin - this
allows for triplicate spectra - and averaging this value for all
spins.  It's all described in the relax_fit.mean_and_error() user
function documentation.

I think this may not be the correct method and that this needs more
investigation!  relax is averaging the standard deviations whereas I
think that in reality we should be averaging the variances (the square
root of the sum of squared standard deviations).  This should occur
for the single duplicated (or triplicated) spectrum and for the
averaging across all spectra when not all are in duplicate.  This
might be seen as R1 and R2 error differences between relax and Art
Palmer's curvefit program, although Jackknife vs. Monte Carlo
simulation differences are also present.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">
They again conclude that duplicate and RMS baseline data errors are
consistent
within those bounds. If the Kay and Palmer labs are going with this
conclusion
(even if it doesn't really tell us which error is more appropriate), it
seems
like it's a good bet that you can estimate standard deviation this way.
</pre></blockquote><pre style="margin: 0em;">

For base plane RMSD, this is what the NOE is doing and what the new
code will do for the relaxation curve fitting.  I think I need to
revisit the statistics of the duplicated spectra though.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">
However, I'm sill not clear on the relationship between curve fit errors and
the
errors measured directly from the spectra. I'm not sure how the nonlinear
fitting error factors in for relax R1, R2 curve-fitting scripts. Certainly,
if
curve-fit error alone could be used that would make things easier since no
error measurement on the T1/T2 experiment spectra would be needed, you could
just dump the peak heights to relax.
</pre></blockquote><pre style="margin: 0em;">

It could be used, but it is less accurate and much more work to
implement.  Monte Carlo simulations are the gold standard for error
propagation in non-linear problems.  A reference is
<a  rel="nofollow" href="http://en.wikipedia.org/wiki/Error_propagation#Caveats_and_warnings">http://en.wikipedia.org/wiki/Error_propagation#Caveats_and_warnings</a>,
but this description of the problem is technical and not very good.
Wikipedia's description of error propagation is interesting, but is
missing the descriptions of using the covariance matrix, Jackknife
simulations, Bootstrapping simulations, and Monte Carlo simulations
(these are the main techniques, but others exist).  The Numerical
Receipes book is much clearer on the subject.

Regards,

Edward

</pre></blockquote><pre style="margin: 0em;">





</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00033" href="msg00033.html">Re: Relax_fit.py problem</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00016" href="msg00016.html">Relax_fit.py problem</a></strong>
<ul><li><em>From:</em> Tyler Reddy</li></ul></li>
<li><strong><a name="00019" href="msg00019.html">Re: Relax_fit.py problem</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00026" href="msg00026.html">Re: Relax_fit.py problem</a></strong>
<ul><li><em>From:</em> Tyler Reddy</li></ul></li>
<li><strong><a name="00027" href="msg00027.html">Re: Relax_fit.py problem</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00028" href="msg00028.html">Re: Relax_fit.py problem</a></strong>
<ul><li><em>From:</em> Tyler Reddy</li></ul></li>
<li><strong><a name="00029" href="msg00029.html">Re: Relax_fit.py problem</a></strong>
<ul><li><em>From:</em> Tyler Reddy</li></ul></li>
<li><strong><a name="00031" href="msg00031.html">Re: Relax_fit.py problem</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Wed Oct 15 20:20:56 2008</div>  
</body>
</html>
