<!-- MHonArc v2.6.16 -->
<!--X-Subject: r15252 &#45; in /branches/inversion&#45;recovery: ./ generic_fns/	sample_scripts/ specific_fns/ test_suite/shared_data/jw_mapping/ t... -->
<!--X-From-R13: rqjneqNaze&#45;erynk.pbz -->
<!--X-Date: Wed, 25 Jan 2012 15:02:17 +0100 -->
<!--X-Message-Id: E1Rq3QW&#45;0002LJ&#45;VI@subversion.gna.org -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>r15252 - in /branches/inversion-recovery: ./ generic_fns/	sample_scripts/ specific_fns/ test_suite/shared_data/jw_mapping/ t... -- January 25, 2012 - 15:02</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />r15252 - in /branches/inversion-recovery: ./ generic_fns/	sample_scripts/ specific_fns/ test_suite/shared_data/jw_mapping/ t...</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00136" class="tabs">Index by Date</a> | <a href="threads.html#00136" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00135.html">Date Prev</a>] [<a href="msg00137.html">Date Next</a>] [<a href="msg00135.html">Thread Prev</a>] [<a href="msg00137.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: relax-commits@xxxxxxx</li>
<li class="menuitem">
<em>Date</em>: Wed, 25 Jan 2012 14:02:16 -0000</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00136.html">E1Rq3QW-0002LJ-VI@subversion.gna.org</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>edward</strong> on January 25, 2012 - 15:02:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Author: bugman
Date: Wed Jan 25 15:02:16 2012
New Revision: 15252

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=15252&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=15252&amp;view=rev</a>
Log:
Merged revisions 15236,15238,15245-15249 via svnmerge from 
svn+ssh://bugman@xxxxxxxxxxx/svn/relax/1.3

........
  r15236 | bugman | 2012-01-24 19:25:14 +0100 (Tue, 24 Jan 2012) | 5 lines
  
  More speed ups for the Selection.__contains_mol_res_spin_containers() 
method.
  
  Certain unnecessary tests are now skipped.
........
  r15238 | bugman | 2012-01-24 21:04:14 +0100 (Tue, 24 Jan 2012) | 3 lines
  
  Speed up for the generic_fns.relax_re.search() function.
........
  r15245 | bugman | 2012-01-25 14:24:25 +0100 (Wed, 25 Jan 2012) | 3 lines
  
  Indentation fix.
........
  r15246 | bugman | 2012-01-25 14:32:40 +0100 (Wed, 25 Jan 2012) | 5 lines
  
  Modified the J(w) mapping test data to include relaxation values of None.
  
  This should trigger bug #19329 (<a  rel="nofollow" href="https://gna.org/bugs/index.php?19329">https://gna.org/bugs/index.php?19329</a>) in 
the test suite.
........
  r15247 | bugman | 2012-01-25 14:39:13 +0100 (Wed, 25 Jan 2012) | 6 lines
  
  Fix for bug #19329 (<a  rel="nofollow" href="https://gna.org/bugs/index.php?19329">https://gna.org/bugs/index.php?19329</a>).
  
  The spin is now deselected if there is really less than three data points, 
excluding data points of
  None.
........
  r15248 | bugman | 2012-01-25 14:43:54 +0100 (Wed, 25 Jan 2012) | 3 lines
  
  Added some value.write user functions to the J(w) mapping sample script.
........
  r15249 | bugman | 2012-01-25 14:50:54 +0100 (Wed, 25 Jan 2012) | 3 lines
  
  Added value.write uf calls to the J(w) mapping system test script.
........

Modified:
    branches/inversion-recovery/   (props changed)
    branches/inversion-recovery/generic_fns/mol_res_spin.py
    branches/inversion-recovery/generic_fns/relax_re.py
    branches/inversion-recovery/sample_scripts/jw_mapping.py
    branches/inversion-recovery/specific_fns/jw_mapping.py
    branches/inversion-recovery/test_suite/shared_data/jw_mapping/R1.dat
    branches/inversion-recovery/test_suite/shared_data/jw_mapping/R2.dat
    branches/inversion-recovery/test_suite/shared_data/jw_mapping/noe.dat
    branches/inversion-recovery/test_suite/system_tests/scripts/jw_mapping.py

Propchange: branches/inversion-recovery/
------------------------------------------------------------------------------
--- svnmerge-integrated (original)
+++ svnmerge-integrated Wed Jan 25 15:02:16 2012
@@ -1,1 +1,1 @@
-/1.3:1-15233
+/1.3:1-15249

Modified: branches/inversion-recovery/generic_fns/mol_res_spin.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/inversion-recovery/generic_fns/mol_res_spin.py?rev=15252&amp;r1=15251&amp;r2=15252&amp;view=diff">http://svn.gna.org/viewcvs/relax/branches/inversion-recovery/generic_fns/mol_res_spin.py?rev=15252&amp;r1=15251&amp;r2=15252&amp;view=diff</a>
==============================================================================
--- branches/inversion-recovery/generic_fns/mol_res_spin.py (original)
+++ branches/inversion-recovery/generic_fns/mol_res_spin.py Wed Jan 25 
15:02:16 2012
@@ -223,6 +223,10 @@
             # No molecule container sent in, therefore the molecule is 
assumed to match.
             select_mol = True
 
+        # Quick exit.
+        if not select_mol:
+            return False
+
         # Residue container.
         if res:
             # No residues in selection object, therefore default to a match.
@@ -235,6 +239,10 @@
         else:
             # No residue container sent in, therefore the residue is assumed 
to match.
             select_res = True
+
+        # Quick exit.
+        if not select_res:
+            return False
 
         # Spin container.
         if spin:

Modified: branches/inversion-recovery/generic_fns/relax_re.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/inversion-recovery/generic_fns/relax_re.py?rev=15252&amp;r1=15251&amp;r2=15252&amp;view=diff">http://svn.gna.org/viewcvs/relax/branches/inversion-recovery/generic_fns/relax_re.py?rev=15252&amp;r1=15251&amp;r2=15252&amp;view=diff</a>
==============================================================================
--- branches/inversion-recovery/generic_fns/relax_re.py (original)
+++ branches/inversion-recovery/generic_fns/relax_re.py Wed Jan 25 15:02:16 
2012
@@ -67,6 +67,10 @@
         # Force a conversion to str.
         pattern = str(pattern)
 
+        # Quick string check.
+        if id == pattern:
+            return True
+
         # First replace any '*' with '.*' (relax to re conversion).
         pattern_re = replace(pattern, '*', '.*')
         id_re =      replace(id,      '*', '.*')

Modified: branches/inversion-recovery/sample_scripts/jw_mapping.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/inversion-recovery/sample_scripts/jw_mapping.py?rev=15252&amp;r1=15251&amp;r2=15252&amp;view=diff">http://svn.gna.org/viewcvs/relax/branches/inversion-recovery/sample_scripts/jw_mapping.py?rev=15252&amp;r1=15251&amp;r2=15252&amp;view=diff</a>
==============================================================================
--- branches/inversion-recovery/sample_scripts/jw_mapping.py (original)
+++ branches/inversion-recovery/sample_scripts/jw_mapping.py Wed Jan 25 
15:02:16 2012
@@ -64,6 +64,11 @@
 grace.view(file='jwx.agr')
 grace.view(file='jwh.agr')
 
+# Write out the values.
+value.write(param='j0', file='j0.txt', force=True)
+value.write(param='jwx', file='jwx.txt', force=True)
+value.write(param='jwh', file='jwh.txt', force=True)
+
 # Finish.
 results.write(file='results', force=True)
 state.save('save', force=True)

Modified: branches/inversion-recovery/specific_fns/jw_mapping.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/inversion-recovery/specific_fns/jw_mapping.py?rev=15252&amp;r1=15251&amp;r2=15252&amp;view=diff">http://svn.gna.org/viewcvs/relax/branches/inversion-recovery/specific_fns/jw_mapping.py?rev=15252&amp;r1=15251&amp;r2=15252&amp;view=diff</a>
==============================================================================
--- branches/inversion-recovery/specific_fns/jw_mapping.py (original)
+++ branches/inversion-recovery/specific_fns/jw_mapping.py Wed Jan 25 
15:02:16 2012
@@ -314,9 +314,17 @@
                 spin.select = False
 
             # Require 3 or more data points.
-            elif len(spin.ri_data) &lt; 3:
-                warn(RelaxDeselectWarning(spin_id, 'insufficient relaxation 
data, 3 or more data points are required'))
-                spin.select = False
+            else:
+                # Count the points.
+                data_points = 0
+                for id in cdp.ri_ids:
+                    if spin.ri_data.has_key(id) and spin.ri_data[id] != None:
+                        data_points += 1
+
+                # Not enough.
+                if data_points &lt; 3:
+                    warn(RelaxDeselectWarning(spin_id, 'insufficient 
relaxation data, 3 or more data points are required'))
+                    spin.select = False
 
 
     return_data_name_doc = [&quot;Reduced spectral density mapping data type 
string matching patterns&quot;, &quot;&quot;&quot;
@@ -391,7 +399,7 @@
 
         # Skip deselected spins.
         if not spin.select:
-                return
+            return
 
         # Return J(0) sim data.
         if index == 0:

Modified: branches/inversion-recovery/test_suite/shared_data/jw_mapping/R1.dat
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/inversion-recovery/test_suite/shared_data/jw_mapping/R1.dat?rev=15252&amp;r1=15251&amp;r2=15252&amp;view=diff">http://svn.gna.org/viewcvs/relax/branches/inversion-recovery/test_suite/shared_data/jw_mapping/R1.dat?rev=15252&amp;r1=15251&amp;r2=15252&amp;view=diff</a>
==============================================================================
--- branches/inversion-recovery/test_suite/shared_data/jw_mapping/R1.dat 
(original)
+++ branches/inversion-recovery/test_suite/shared_data/jw_mapping/R1.dat Wed 
Jan 25 15:02:16 2012
@@ -1,2 +1,3 @@
 -2 Gly 1.0 0.05
 -1 Gly 0.9 0.05
+1  Gly None None

Modified: branches/inversion-recovery/test_suite/shared_data/jw_mapping/R2.dat
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/inversion-recovery/test_suite/shared_data/jw_mapping/R2.dat?rev=15252&amp;r1=15251&amp;r2=15252&amp;view=diff">http://svn.gna.org/viewcvs/relax/branches/inversion-recovery/test_suite/shared_data/jw_mapping/R2.dat?rev=15252&amp;r1=15251&amp;r2=15252&amp;view=diff</a>
==============================================================================
--- branches/inversion-recovery/test_suite/shared_data/jw_mapping/R2.dat 
(original)
+++ branches/inversion-recovery/test_suite/shared_data/jw_mapping/R2.dat Wed 
Jan 25 15:02:16 2012
@@ -1,3 +1,4 @@
 -2 Gly 15.0 0.5
 -1 Gly 13.9 0.8
 0  Gly 12.0 0.5
+1  Gly None None

Modified: 
branches/inversion-recovery/test_suite/shared_data/jw_mapping/noe.dat
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/inversion-recovery/test_suite/shared_data/jw_mapping/noe.dat?rev=15252&amp;r1=15251&amp;r2=15252&amp;view=diff">http://svn.gna.org/viewcvs/relax/branches/inversion-recovery/test_suite/shared_data/jw_mapping/noe.dat?rev=15252&amp;r1=15251&amp;r2=15252&amp;view=diff</a>
==============================================================================
--- branches/inversion-recovery/test_suite/shared_data/jw_mapping/noe.dat 
(original)
+++ branches/inversion-recovery/test_suite/shared_data/jw_mapping/noe.dat Wed 
Jan 25 15:02:16 2012
@@ -1,3 +1,4 @@
 -2 Gly 0.90 0.05
 -1 Gly 0.79 0.05
 0  Gly 0.6  0.1
+1  Gly None None

Modified: 
branches/inversion-recovery/test_suite/system_tests/scripts/jw_mapping.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/inversion-recovery/test_suite/system_tests/scripts/jw_mapping.py?rev=15252&amp;r1=15251&amp;r2=15252&amp;view=diff">http://svn.gna.org/viewcvs/relax/branches/inversion-recovery/test_suite/system_tests/scripts/jw_mapping.py?rev=15252&amp;r1=15251&amp;r2=15252&amp;view=diff</a>
==============================================================================
--- branches/inversion-recovery/test_suite/system_tests/scripts/jw_mapping.py 
(original)
+++ branches/inversion-recovery/test_suite/system_tests/scripts/jw_mapping.py 
Wed Jan 25 15:02:16 2012
@@ -45,6 +45,11 @@
 grace.write(y_data_type='jwx', file='devnull', force=True)
 grace.write(y_data_type='jwh', file='devnull', force=True)
 
+# Value writing.
+value.write(param='j0', file='devnull', force=True)
+value.write(param='jwx', file='devnull', force=True)
+value.write(param='jwh', file='devnull', force=True)
+
 # Finish.
 results.write(file='devnull', force=True)
 state.save('devnull', force=True)



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Wed Jan 25 15:20:02 2012</div>  
</body>
</html>
