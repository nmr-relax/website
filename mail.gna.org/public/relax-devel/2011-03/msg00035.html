<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: CST branch -->
<!--X-From-R13: Bniry Ynqrenirx <cniry.xnqrenirxNtznvy.pbz> -->
<!--X-Date: Tue, 22 Mar 2011 09:19:00 +0100 -->
<!--X-Message-Id: AANLkTinQgpwatnHtjeuLiLvv5uWJrY47_OZTQNHDjsnb@mail.gmail.com -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: p2l6052a51004080823g94a64268lf8af8d3e332c2a03@mail.gmail.com -->
<!--X-Reference: j2i7f080ed11004120000r80bba9bch9556be67b0c1707@mail.gmail.com -->
<!--X-Reference: g2v6052a51004131048sb5c01509sfc9a77045ad33310@mail.gmail.com -->
<!--X-Reference: r2g7f080ed11004131113mb209905eh63ff1eb61c171fee@mail.gmail.com -->
<!--X-Reference: l2q6052a51004301221h9ad09886ha016465129beb516@mail.gmail.com -->
<!--X-Reference: g2m7f080ed11005050153y2ad8b4bfjb4eb8191b0efd0cc@mail.gmail.com -->
<!--X-Reference: AANLkTin4nzkkOCxs94vUKCpT00R7ak22gLaL5rK&#45;VjPN@mail.gmail.com -->
<!--X-Reference: AANLkTinF4yNXoJQS&#45;rd81VBi3keRURUNeb&#45;_GdkxqqsG@mail.gmail.com -->
<!--X-Reference: AANLkTinibyBQvsoG1&#45;0vmzOXFmRJxD95VMF3eGxzSMMB@mail.gmail.com -->
<!--X-Reference: AANLkTimFT0&#45;Kbgdz_U5LeOW5Ln22mPBZBC8FL68n6CeF@mail.gmail.com -->
<!--X-Reference: AANLkTikhknBoHTc7B7GCRULkrEnxSx+PpqPP=x6KrDOH@mail.gmail.com -->
<!--X-Reference: AANLkTim0B&#45;E6kMW9Nn47o+u+atxrm38540u1Xhaoe6j0@mail.gmail.com -->
<!--X-Reference: AANLkTi=m5S08Nd1F5VDnMGTOu2s+j2Euz1t&#45;ytw0zOAf@mail.gmail.com -->
<!--X-Reference: AANLkTinxUWLu2N19dc3eaPgh22igv_SGy=6qmVnJN=Qj@mail.gmail.com -->
<!--X-Reference: AANLkTik0K3B7huKE8hJtAkXL_yzJmNa9BFxfczu8Sfx9@mail.gmail.com -->
<!--X-Reference: AANLkTin1JfUtMoVqR4c&#45;5dRHTf58N&#45;FAcv4_bc=LpH2b@mail.gmail.com -->
<!--X-Reference: AANLkTimBsSm504qysJd8&#45;e0O_thUdcwvciKrNhMTdoQW@mail.gmail.com -->
<!--X-Reference: AANLkTikf&#45;g23EPV+R2&#45;7inSpXbT5fqv5vDO8nL+DZrwA@mail.gmail.com -->
<!--X-Reference: AANLkTikNh5FTMmeQPqkSiX8ieG5oUw5UcuG83k8PeAiM@mail.gmail.com -->
<!--X-Reference: AANLkTimADCpNAJG4Pg02_UukH5hFW5eQfr&#45;SymzqXrc=@mail.gmail.com -->
<!--X-Reference: AANLkTi=8_288HiMhVQDwpFUCqMp+aBotECez44s44q7z@mail.gmail.com -->
<!--X-Reference: AANLkTi=vSTA2B&#45;jpTzShJab84W=&#45;z1YBzvhW10wTXg_P@mail.gmail.com -->
<!--X-Reference: AANLkTikXiEtqtDWOycdJdyYSG+KfxAARiXhtDwrQm_v+@mail.gmail.com -->
<!--X-Reference: AANLkTinWS1m+j069Y+sTXrae&#45;J5DamkkNTp&#45;Wx8u7OTX@mail.gmail.com -->
<!--X-Reference: AANLkTinNsF7fA3Va=&#45;63bYBE3EoOeZ21OOO8ZYunU0uR@mail.gmail.com -->
<!--X-Reference: AANLkTinw8sg3staDqr+=mBGqLgB0joQwKzKbFNGY_5sF@mail.gmail.com -->
<!--X-Reference: AANLkTi=aZJDUcj0+p_0Or_P1v3xwSvk=7=s=+DjHFRcA@mail.gmail.com -->
<!--X-Reference: AANLkTinB0kczjTRe5etQtviQ0p9sxu&#45;fmeh3FJ&#45;Lx6Pg@mail.gmail.com -->
<!--X-Reference: AANLkTikwqUH6Z&#45;NmxNmj02ysSaYYAQ_cuS5&#45;kJ6K4U5u@mail.gmail.com -->
<!--X-Reference: AANLkTikZXALuxeob=_YvJjE5&#45;ZyRrLTNqG&#45;wTf_nxgqf@mail.gmail.com -->
<!--X-Reference: AANLkTi=o2jzDfj+Y=WMMBTL=YpOT++n2X0sN=G4_S25+@mail.gmail.com -->
<!--X-Reference: AANLkTimthyxNok+Fsv94fnF8JVdia6VXJ6M0sDQYAAzT@mail.gmail.com -->
<!--X-Reference: AANLkTinydi7mCO0EeWvGOOyOw1a_h3f3618tC_+9FOF5@mail.gmail.com -->
<!--X-Reference: AANLkTimyoJqYWVk8Y7x3Y5UDWr_GaMa_dDVJ9492OEht@mail.gmail.com -->
<!--X-Reference: AANLkTi=DQ9KGP+e0ONhZ66XhSzKhuQzFoQcQNwXnVsgG@mail.gmail.com -->
<!--X-Reference: AANLkTind0EOBhSi_G=M_+LVY_WmLC=03f0&#45;TMrvzs6zs@mail.gmail.com -->
<!--X-Reference: AANLkTim1gTBVKDQPK=+aM1SHnuF7ZyKQTUzjpqBMt4xo@mail.gmail.com -->
<!--X-Reference: AANLkTinE=fRfL=&#45;dfe&#45;Uj6NAVuL9AOK9ENLC58C_&#45;1iu@mail.gmail.com -->
<!--X-Reference: AANLkTinaaQTrpANe1zqD&#45;pH3OGsk=sA8p7pWa4_GfrUb@mail.gmail.com -->
<!--X-Reference: AANLkTimFewU0=snUOZVVD==0d40oRuS4zNbdUsoEKMVM@mail.gmail.com -->
<!--X-Reference: AANLkTi=U0rRm2Rv+ynBehBgcJ58gOcyGpZRu5vBGM1Pv@mail.gmail.com -->
<!--X-Reference: AANLkTi=E2tq_mP1soRPB&#45;1c67a0cX&#45;NmXBYqVvot+aFA@mail.gmail.com -->
<!--X-Reference: AANLkTinBO3eWruVYxHj6g1m1Fbxr5BNC=FBo=a948V&#45;q@mail.gmail.com -->
<!--X-Reference: AANLkTikPLDbCmJRKfn+1j0epx&#45;=FAHq2eCBspBqwqizg@mail.gmail.com -->
<!--X-Reference: AANLkTintdOt63AWrtS4_7R5C64j7aXZ0u8T41UaSRpGJ@mail.gmail.com -->
<!--X-Reference: AANLkTikDPM+srXqbPRUxv9ehk2NfGQ5HA6ODWueN4FWB@mail.gmail.com -->
<!--X-Reference: AANLkTim0uEyEEmu1V3Rx8SN1hmWMThpxrORZr7RQDZ++@mail.gmail.com -->
<!--X-Reference: AANLkTi=D0wxL=MhE3AaSmW3b1cMR_btPNH&#45;BbrQhQC&#45;o@mail.gmail.com -->
<!--X-Reference: AANLkTinakhPRhkfj86B9ZS=h26WEqW9SbTvjGBDsNnUS@mail.gmail.com -->
<!--X-Reference: AANLkTikLWef6s46v1SJX6c05SnL4XFn4ZJVu4pCZ6F7Y@mail.gmail.com -->
<!--X-Reference: AANLkTimT4STLo&#45;0VawEDBSLRxSYywVnGQe4NpJNzV8hk@mail.gmail.com -->
<!--X-Reference: AANLkTimHnFmLtnO1jMXtd=LqC+y&#45;C27C8z7suigZVEh3@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: CST branch -- March 22, 2011 - 09:19</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: CST branch</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00035" class="tabs">Index by Date</a> | <a href="threads.html#00035" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00034.html">Date Prev</a>] [<a href="msg00036.html">Date Next</a>] [<a href="msg00027.html">Thread Prev</a>] [<a href="msg00037.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Edward d'Auvergne&quot; &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Tue, 22 Mar 2011 09:18:29 +0100</li>
<li class="menuitem">
<em>Cc</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;	h=domainkey-signature:mime-version:in-reply-to:references:date	:message-id:subject:from:to:cc:content-type;	bh=JuZi97H1M31BcVzr0aU4+Oj0Vr8qmZKzMtG/tBABURw=;	b=B0YLqL49l/SQ10AsdQStvRkMyA2wC5HfcR0UdypBF+xLLAZsSk6YTeX1Tgqa+XusKd	75Rt09WT1vUYKML0kVJTdW9Jc7GLkdA286StZ4mojfm5ZXtp2g2nWiUVZSKZRSOHS6zB	lbukwR8Jo8/mWT9NVl3N80xaKX9OeupLkwbfY=</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00035.html">AANLkTinQgpwatnHtjeuLiLvv5uWJrY47_OZTQNHDjsnb@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;p2l6052a51004080823g94a64268lf8af8d3e332c2a03@xxxxxxxxxxxxxx&gt;	&lt;j2i7f080ed11004120000r80bba9bch9556be67b0c1707@xxxxxxxxxxxxxx&gt;	&lt;g2v6052a51004131048sb5c01509sfc9a77045ad33310@xxxxxxxxxxxxxx&gt;	&lt;r2g7f080ed11004131113mb209905eh63ff1eb61c171fee@xxxxxxxxxxxxxx&gt;	&lt;l2q6052a51004301221h9ad09886ha016465129beb516@xxxxxxxxxxxxxx&gt;	&lt;g2m7f080ed11005050153y2ad8b4bfjb4eb8191b0efd0cc@xxxxxxxxxxxxxx&gt;	&lt;AANLkTin4nzkkOCxs94vUKCpT00R7ak22gLaL5rK-VjPN@xxxxxxxxxxxxxx&gt;	&lt;AANLkTinF4yNXoJQS-rd81VBi3keRURUNeb-_GdkxqqsG@xxxxxxxxxxxxxx&gt;	&lt;AANLkTinibyBQvsoG1-0vmzOXFmRJxD95VMF3eGxzSMMB@xxxxxxxxxxxxxx&gt;	&lt;AANLkTimFT0-Kbgdz_U5LeOW5Ln22mPBZBC8FL68n6CeF@xxxxxxxxxxxxxx&gt;	&lt;AANLkTikhknBoHTc7B7GCRULkrEnxSx+PpqPP=x6KrDOH@xxxxxxxxxxxxxx&gt;	&lt;AANLkTim0B-E6kMW9Nn47o+u+atxrm38540u1Xhaoe6j0@xxxxxxxxxxxxxx&gt;	&lt;AANLkTi=m5S08Nd1F5VDnMGTOu2s+j2Euz1t-ytw0zOAf@xxxxxxxxxxxxxx&gt;	&lt;AANLkTinxUWLu2N19dc3eaPgh22igv_SGy=6qmVnJN=Qj@xxxxxxxxxxxxxx&gt;	&lt;AANLkTik0K3B7huKE8hJtAkXL_yzJmNa9BFxfczu8Sfx9@xxxxxxxxxxxxxx&gt;	&lt;AANLkTin1JfUtMoVqR4c-5dRHTf58N-FAcv4_bc=LpH2b@xxxxxxxxxxxxxx&gt;	&lt;AANLkTimBsSm504qysJd8-e0O_thUdcwvciKrNhMTdoQW@xxxxxxxxxxxxxx&gt;	&lt;AANLkTikf-g23EPV+R2-7inSpXbT5fqv5vDO8nL+DZrwA@xxxxxxxxxxxxxx&gt;	&lt;AANLkTikNh5FTMmeQPqkSiX8ieG5oUw5UcuG83k8PeAiM@xxxxxxxxxxxxxx&gt;	&lt;AANLkTimADCpNAJG4Pg02_UukH5hFW5eQfr-SymzqXrc=@xxxxxxxxxxxxxx&gt;	&lt;AANLkTi=8_288HiMhVQDwpFUCqMp+aBotECez44s44q7z@xxxxxxxxxxxxxx&gt;	&lt;AANLkTi=vSTA2B-jpTzShJab84W=-z1YBzvhW10wTXg_P@xxxxxxxxxxxxxx&gt;	&lt;AANLkTikXiEtqtDWOycdJdyYSG+KfxAARiXhtDwrQm_v+@xxxxxxxxxxxxxx&gt;	&lt;AANLkTinWS1m+j069Y+sTXrae-J5DamkkNTp-Wx8u7OTX@xxxxxxxxxxxxxx&gt;	&lt;AANLkTinNsF7fA3Va=-63bYBE3EoOeZ21OOO8ZYunU0uR@xxxxxxxxxxxxxx&gt;	&lt;AANLkTinw8sg3staDqr+=mBGqLgB0joQwKzKbFNGY_5sF@xxxxxxxxxxxxxx&gt;	&lt;AANLkTi=aZJDUcj0+p_0Or_P1v3xwSvk=7=s=+DjHFRcA@xxxxxxxxxxxxxx&gt;	&lt;AANLkTinB0kczjTRe5etQtviQ0p9sxu-fmeh3FJ-Lx6Pg@xxxxxxxxxxxxxx&gt;	&lt;AANLkTikwqUH6Z-NmxNmj02ysSaYYAQ_cuS5-kJ6K4U5u@xxxxxxxxxxxxxx&gt;	&lt;AANLkTikZXALuxeob=_YvJjE5-ZyRrLTNqG-wTf_nxgqf@xxxxxxxxxxxxxx&gt;	&lt;AANLkTi=o2jzDfj+Y=WMMBTL=YpOT++n2X0sN=G4_S25+@xxxxxxxxxxxxxx&gt;	&lt;AANLkTimthyxNok+Fsv94fnF8JVdia6VXJ6M0sDQYAAzT@xxxxxxxxxxxxxx&gt;	&lt;AANLkTinydi7mCO0EeWvGOOyOw1a_h3f3618tC_+9FOF5@xxxxxxxxxxxxxx&gt;	&lt;AANLkTimyoJqYWVk8Y7x3Y5UDWr_GaMa_dDVJ9492OEht@xxxxxxxxxxxxxx&gt;	&lt;AANLkTi=DQ9KGP+e0ONhZ66XhSzKhuQzFoQcQNwXnVsgG@xxxxxxxxxxxxxx&gt;	&lt;AANLkTind0EOBhSi_G=M_+LVY_WmLC=03f0-TMrvzs6zs@xxxxxxxxxxxxxx&gt;	&lt;AANLkTim1gTBVKDQPK=+aM1SHnuF7ZyKQTUzjpqBMt4xo@xxxxxxxxxxxxxx&gt;	&lt;AANLkTinE=fRfL=-dfe-Uj6NAVuL9AOK9ENLC58C_-1iu@xxxxxxxxxxxxxx&gt;	&lt;AANLkTinaaQTrpANe1zqD-pH3OGsk=sA8p7pWa4_GfrUb@xxxxxxxxxxxxxx&gt;	&lt;AANLkTimFewU0=snUOZVVD==0d40oRuS4zNbdUsoEKMVM@xxxxxxxxxxxxxx&gt;	&lt;AANLkTi=U0rRm2Rv+ynBehBgcJ58gOcyGpZRu5vBGM1Pv@xxxxxxxxxxxxxx&gt;	&lt;AANLkTi=E2tq_mP1soRPB-1c67a0cX-NmXBYqVvot+aFA@xxxxxxxxxxxxxx&gt;	&lt;AANLkTinBO3eWruVYxHj6g1m1Fbxr5BNC=FBo=a948V-q@xxxxxxxxxxxxxx&gt;	&lt;AANLkTikPLDbCmJRKfn+1j0epx-=FAHq2eCBspBqwqizg@xxxxxxxxxxxxxx&gt;	&lt;AANLkTintdOt63AWrtS4_7R5C64j7aXZ0u8T41UaSRpGJ@xxxxxxxxxxxxxx&gt;	&lt;AANLkTikDPM+srXqbPRUxv9ehk2NfGQ5HA6ODWueN4FWB@xxxxxxxxxxxxxx&gt;	&lt;AANLkTim0uEyEEmu1V3Rx8SN1hmWMThpxrORZr7RQDZ++@xxxxxxxxxxxxxx&gt;	&lt;AANLkTi=D0wxL=MhE3AaSmW3b1cMR_btPNH-BbrQhQC-o@xxxxxxxxxxxxxx&gt;	&lt;AANLkTinakhPRhkfj86B9ZS=h26WEqW9SbTvjGBDsNnUS@xxxxxxxxxxxxxx&gt;	&lt;AANLkTikLWef6s46v1SJX6c05SnL4XFn4ZJVu4pCZ6F7Y@xxxxxxxxxxxxxx&gt;	&lt;AANLkTimT4STLo-0VawEDBSLRxSYywVnGQe4NpJNzV8hk@xxxxxxxxxxxxxx&gt;	&lt;AANLkTimHnFmLtnO1jMXtd=LqC+y-C27C8z7suigZVEh3@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Pavel Kaderavek</strong> on March 22, 2011 - 09:19:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
Hi,<br><br>Please see below:<br><br><div class="gmail_quote">On 10 March 2011 18:55, Edward d&#39;Auvergne <span dir="ltr">&lt;<a rel="nofollow" href="mailto:edward@xxxxxxxxxxxxx">edward@xxxxxxxxxxxxx</a>&gt;</span> wrote:<br><blockquote class="gmail_quote" style="border-left: 1px solid rgb(204, 204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;">
Hi,<br>
<br>
Please see below:<br>
<div><div></div><div class="h5"><br>
<br>
On 10 March 2011 18:09, Pavel Kaderavek &lt;<a rel="nofollow" href="mailto:pavel.kaderavek@xxxxxxxxx">pavel.kaderavek@xxxxxxxxx</a>&gt; wrote:<br>
&gt; Hi,<br>
&gt;<br>
&gt; Within this mail we need to discuss several related problems we faced when<br>
&gt; we started to think about the following patch. If it will be discussed<br>
&gt; separately the connection would be lost, therefore we decided to send it<br>
&gt; together. Of course we don&#39;t assume that everything will be put into the<br>
&gt; code in one huge patch, but it will be split into several parts.<br>
&gt;<br>
&gt; Originally, we wanted to discuss the selection of the equation in the<br>
&gt; function setup_equations in class Mf (maths_fns/mf.py). Currently, the<br>
&gt; equation for calculation physical constants and linear combination of<br>
&gt; spectral densities are selected just based on the type of relaxation rate<br>
&gt; (R1,R2,NOE).<br>
&gt;<br>
&gt;        for i in xrange(data.num_ri):<br>
&gt;             # The R1 equations.<br>
&gt;              if data.ri_labels[i] == &#39;R1&#39;:<br>
&gt;                 data.create_csa_func[i] = comp_r1_csa_const<br>
&gt;                 data.create_csa_grad[i] = comp_r1_csa_const<br>
&gt;                 data.create_csa_hess[i] = comp_r1_csa_const<br>
&gt;                 data.create_dip_jw_func[i] = comp_r1_dip_jw<br>
&gt;                 data.create_dip_jw_grad[i] = comp_r1_dip_jw<br>
&gt;                 data.create_dip_jw_hess[i] = comp_r1_dip_jw<br>
&gt;                 data.create_csa_jw_func[i] = comp_r1_csa_jw<br>
&gt;                 data.create_csa_jw_grad[i] = comp_r1_csa_jw<br>
&gt;                 data.create_csa_jw_hess[i] = comp_r1_csa_jw<br>
&gt;<br>
&gt;             # The R2 equations.<br>
&gt;             elif data.ri_labels[i] == &#39;R2&#39;:<br>
&gt;                 data.create_dip_func[i] = comp_r2_dip_const<br>
&gt;                 data.create_dip_grad[i] = comp_r2_dip_const<br>
&gt;                 data.create_dip_hess[i] = comp_r2_dip_const<br>
&gt;                 data.create_csa_func[i] = comp_r2_csa_const<br>
&gt;                 data.create_csa_grad[i] = comp_r2_csa_const<br>
&gt;                 data.create_csa_hess[i] = comp_r2_csa_const<br>
&gt;                 data.create_rex_func[i] = comp_rex_const_func<br>
&gt;                 data.create_rex_grad[i] = comp_rex_const_grad<br>
&gt;                 data.create_dip_jw_func[i] = comp_r2_dip_jw<br>
&gt;                 data.create_dip_jw_grad[i] = comp_r2_dip_jw<br>
&gt;                 data.create_dip_jw_hess[i] = comp_r2_dip_jw<br>
&gt;                 data.create_csa_jw_func[i] = comp_r2_csa_jw<br>
&gt;                 data.create_csa_jw_grad[i] = comp_r2_csa_jw<br>
&gt;                 data.create_csa_jw_hess[i] = comp_r2_csa_jw<br>
&gt;<br>
&gt;             # The NOE equations.<br>
&gt;             elif data.ri_labels[i] == &#39;NOE&#39;:<br>
&gt;                 data.create_dip_jw_func[i] = comp_sigma_noe_dip_jw<br>
&gt;                 data.create_dip_jw_grad[i] = comp_sigma_noe_dip_jw<br>
&gt;                 data.create_dip_jw_hess[i] = comp_sigma_noe_dip_jw<br>
&gt;                 data.create_ri[i] = calc_noe<br>
&gt;                 data.create_dri[i] = calc_dnoe<br>
&gt;                 data.create_d2ri[i] = calc_d2noe<br>
&gt;                 if data.noe_r1_table[i] == None:<br>
&gt;                     data.get_r1[i] = calc_r1<br>
&gt;                     data.get_dr1[i] = calc_dr1<br>
&gt;                     data.get_d2r1[i] = calc_d2r1<br>
&gt;                 else:<br>
&gt;                     data.get_r1[i] = extract_r1<br>
&gt;                     data.get_dr1[i] = extract_dr1<br>
&gt;                     data.get_d2r1[i] = extract_d2r1<br>
&gt;<br>
&gt; It is necessary to select the equation based on both type of relaxation rate<br>
&gt; and also interaction type in the new code design. Therefore we suggest to<br>
&gt; change the code in following way:<br>
&gt;<br>
&gt;         for i in xrange(data.num_ri):<br>
&gt;             # The R1 equations.<br>
&gt;             if data.ri_labels[i] == &#39;R1&#39;:<br>
&gt;                 if data.interactions == &quot;dip&quot;<br>
&gt;                    data.create_const_func[i] = comp_dip_const_func<br>
&gt;                    data.create_const_grad[i] = comp_dip_const_grad<br>
&gt;                    data.create_const_hess[i] = comp_dip_const_hess<br>
&gt;                    data.create_jw_func[i] = comp_r1_dip_jw<br>
&gt;                    data.create_jw_grad[i] = comp_r1_dip_jw<br>
&gt;                    data.create_jw_hess[i] = comp_r1_dip_jw<br>
&gt;                 elif data.interactions == &quot;CSA&quot;<br>
&gt;                    data.create_const_func[i] = comp_csa_const_func<br>
&gt;                    data.create_const_grad[i] = comp_csa_const_grad<br>
&gt;                    data.create_const_hess[i] = comp_csa_const_hess<br>
&gt;                    data.create_jw_func[i] = comp_r1_csa_jw<br>
&gt;                    data.create_jw_grad[i] = comp_r1_csa_jw<br>
&gt;                    data.create_jw_hess[i] = comp_r1_csa_jw<br>
&gt;                 elif data.interactions == &quot;Rex&quot;<br>
&gt;                    data.create_const_func[i] = comp_rex_const_func<br>
&gt;                    data.create_const_grad[i] = comp_rex_const_grad<br>
&gt;                    data.create_const_hess[i] = comp_rex_const_hess<br>
&gt;                 elif data.interactions == &quot;cross-CSA-CSA&quot;<br>
&gt;                    data.create_const_func[i] = comp_cross_csa_csa_const_func<br>
&gt;                    data.create_const_grad[i] = comp_cross_csa_csa_const_grad<br>
&gt;                    data.create_const_hess[i] = comp_cross_csa_csa_const_hess<br>
&gt;                    data.create_jw_func[i] = comp_r1_cross_csa_csa_jw<br>
&gt;                    data.create_jw_grad[i] = comp_r1_cross_csa_csa_jw<br>
&gt;                    data.create_jw_hess[i] = comp_r1_cross_csa_csa_jw<br>
&gt;<br>
&gt;             # The R2 equations.<br>
&gt;             elif data.ri_labels[i] == &#39;R2&#39;:<br>
&gt;                 if data.interactions == &quot;dip&quot;<br>
&gt;                    data.create_const_func[i] = comp_dip_const_func<br>
&gt;                    data.create_const_grad[i] = comp_dip_const_grad<br>
&gt;                    data.create_const_hess[i] = comp_dip_const_hess<br>
&gt;                    data.create_jw_func[i] = comp_r2_dip_jw<br>
&gt;                    data.create_jw_grad[i] = comp_r2_dip_jw<br>
&gt;                    data.create_jw_hess[i] = comp_r2_dip_jw<br>
&gt;                 elif data.interactions == &quot;CSA&quot;<br>
&gt;                    data.create_const_func[i] = comp_csa_const_func<br>
&gt;                    data.create_const_grad[i] = comp_csa_const_grad<br>
&gt;                    data.create_const_hess[i] = comp_csa_const_hess<br>
&gt;                    data.create_jw_func[i] = comp_r2_csa_jw<br>
&gt;                    data.create_jw_grad[i] = comp_r2_csa_jw<br>
&gt;                    data.create_jw_hess[i] = comp_r2_csa_jw<br>
&gt;                 elif data.interactions == &quot;Rex&quot;<br>
&gt;                    data.create_const_func[i] = comp_rex_const_func<br>
&gt;                    data.create_const_grad[i] = comp_rex_const_grad<br>
&gt;                    data.create_const_hess[i] = comp_rex_const_hess<br>
&gt;                 elif data.interactions == &quot;cross-CSA-CSA&quot;<br>
&gt;                    data.create_const_func[i] = comp_cross_csa_csa_const_func<br>
&gt;                    data.create_const_grad[i] = comp_cross_csa_csa_const_grad<br>
&gt;                    data.create_const_hess[i] = comp_cross_csa_csa_const_hess<br>
&gt;                    data.create_jw_func[i] = comp_r2_cross_csa_csa_jw<br>
&gt;                    data.create_jw_grad[i] = comp_r2_cross_csa_csa_jw<br>
&gt;                    data.create_jw_hess[i] = comp_r2_cross_csa_csa_jw<br>
&gt;<br>
&gt;             # The NOE equations.<br>
&gt;             elif data.ri_labels[i] == &#39;NOE&#39;:<br>
&gt;                 if data.interactions == &quot;dip&quot;<br>
&gt;                    data.create_const_func[i] = comp_dip_const_func<br>
&gt;                    data.create_const_grad[i] = comp_dip_const_grad<br>
&gt;                    data.create_const_hess[i] = comp_dip_const_hess<br>
&gt;                    data.create_jw_func[i] = comp_sigma_noe_dip_jw<br>
&gt;                    data.create_jw_grad[i] = comp_sigma_noe_dip_jw<br>
&gt;                    data.create_jw_hess[i] = comp_sigma_noe_dip_jw<br>
&gt;<br>
&gt;                 data.create_ri[i] = calc_noe<br>
&gt;                 data.create_dri[i] = calc_dnoe<br>
&gt;                 data.create_d2ri[i] = calc_d2noe<br>
&gt;                 if data.noe_r1_table[i] == None:<br>
&gt;                     data.get_r1[i] = calc_r1<br>
&gt;                     data.get_dr1[i] = calc_dr1<br>
&gt;                     data.get_d2r1[i] = calc_d2r1<br>
&gt;                 else:<br>
&gt;                     data.get_r1[i] = extract_r1<br>
&gt;                     data.get_dr1[i] = extract_dr1<br>
&gt;                     data.get_d2r1[i] = extract_d2r1<br>
<br>
</div></div>This seems to be the correct way to go.  This setting up function is<br>
quite complex, but it does save incredible amounts of computation<br>
time.  So complexity here is not an issue.  With proper system and<br>
unit testing, any problems should be quick to locate.  Speaking of a<br>
system test, one should be designed for this new cst branch so that we<br>
know when the code is fully functional.<br>
<div class="im"><br></div></blockquote><div><br>Alright, so we will prepare next patch with the above changes.<br><br></div><blockquote class="gmail_quote" style="border-left: 1px solid rgb(204, 204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;">
<div class="im">
<br>
&gt; At this point we would like to address a related question. Currently the<br>
&gt; calculation of physical constant is done in a several steps. First, the<br>
&gt; physical constant is calculated and the value is stored in the<br>
&gt; data.dip_const_func or data.csa_const_func (grad, hess). Then, when the<br>
&gt; relaxation rates are calculated, the physical constant is recalculated by<br>
&gt; the function create_dip_func or create_csa_func (grad, hess) (method<br>
&gt; setup_equations in class Mf, maths_fns/mf.py).<br>
&gt;<br>
&gt;             comp_dip_const_func(data, data.bond_length)<br>
&gt;             comp_csa_const_func(data, data.csa)<br>
&gt;             for i in xrange(data.num_ri):<br>
&gt;                 data.dip_comps_func[i] = data.dip_const_func<br>
&gt;                 if data.create_dip_func[i]:<br>
&gt;                     data.dip_comps_func[i] =<br>
&gt; data.create_dip_func[i](data.dip_const_func)<br>
&gt;                 if data.create_csa_func[i]:<br>
&gt;                     data.csa_comps_func[i] =<br>
&gt; data.create_csa_func[i](data.csa_const_func[data.remap_table[i]])<br>
&gt;<br>
&gt; There is one exception, the dipolar physical constant is not recalculated in<br>
&gt; the case of calculation R1 relaxation rate, because the function<br>
&gt; create_dip_func does not exist in this case. We do not see a reason for such<br>
&gt; a recalculation.<br>
<br>
</div>The reason is because of the m10 to m39 models built into relax.  I<br>
have made it possible to optimise the bond length and CSA information.<br>
 However these models are not stable with the current relaxation data.<br>
 I do plan on working with these in the future though, so it would be<br>
useful to keep them.  Note that for models m0 to m9, the<br>
data.create_dip_func[i] and data.create_csa_func[i] function pointers<br>
are set to None.  Therefore for normal model-free analysis the<br>
constant is not recalculated.<br>
<div class="im"><br>
<br>
&gt; It seems better to us to just change the coefficient in the<br>
&gt; functions comp_r1_dip_jw, comp_r2_dip_jw, comp_r1_csa_jw, comp_r2_csa_jw<br>
&gt; (maths_fns/ri_comps.py). I guess, that this design was dedicated to avoid<br>
&gt; multiple calculation of the same interaction constant for each measured<br>
&gt; relaxation rate. We would suggest to reach the same effect by this<br>
&gt; construction:<br>
&gt;<br>
&gt;             for i in xrange(data.num_ri):<br>
&gt;                 if data.const_func[0]:<br>
&gt;                     data.const_func[i] = data.const_func[0]<br>
&gt;                 else<br>
&gt;                     data.create_const_func(data)<br>
<br>
</div>For models m10 to m39, this construct will not work.  The constants<br>
are already pre-calculated for models m0 to m9 so this is not needed.<br>
<div class="im"><br>
<br>
&gt; Note, the comp_dip_const_func and comp_csa_const_func should be change so<br>
&gt; that, it is possible to call them just with the argument data<br>
&gt; (maths_fns/ri_comps.py). Instead of:<br>
&gt;<br>
&gt;<br>
&gt; def comp_dip_const_func(data, bond_length):<br>
&gt;     &quot;&quot;&quot;Calculate the dipolar constant.<br>
&gt;<br>
&gt;    ...<br>
&gt;<br>
&gt;     if bond_length == 0.0:<br>
&gt;         data.dip_const_func = 1e99<br>
&gt;     else:<br>
&gt;         data.dip_const_func = 0.25 * data.dip_const_fixed * bond_length**-6<br>
&gt;<br>
&gt;<br>
&gt; It should look like:<br>
&gt;<br>
&gt; def comp_dip_const_func(data):<br>
&gt;     &quot;&quot;&quot;Calculate the dipolar constant.<br>
&gt;<br>
&gt;    ...<br>
&gt;<br>
&gt;     if data.internuclei_distance == 0.0:<br>
&gt;         data.const_func = 1e99<br>
&gt;     else:<br>
&gt;         data.const_func = 0.25 * data.dip_const_fixed *<br>
&gt; data.internuclei_distance**-6<br>
<br>
</div>The bond_length arg was designed so that the bond length could either<br>
come from a fixed value supplied by the user or from the parameter<br>
vector when bond lengths or CSA values are optimised.  This behaviour<br>
might have to be preserved.<br>
<div class="im"><br>
<br>
&gt; data.dip_const_func were renamed to more general data.const_func and instead<br>
&gt; of bond_length the function directly takes  the internuclei distance for the<br>
&gt; current dipole-dipole interaction. The change of data.dip_const_func to<br>
&gt; data.const_func later simplify the code design in the maths_fns/ri_prime.py<br>
&gt; . It will be reduced just to a multiplication of constant and the linear<br>
&gt; combination of spectral density functions.<br>
<br>
</div>For models m10 to m39, I&#39;m not sure if this design would work.  Could<br>
we redesign this in another way in which these complex models are<br>
still functional?<br>
<div class="im"><br></div></blockquote><div><br>Then, we would suggest to call the function  comp_dip_const_func, comp_csa_const_func ... with full set of possible parameters, i.e.<br>comp_dip_const_func(data,internuclei_distance,csa1,csa2,rex)<br>
comp_csa_const_func(data,internuclei_distance,csa1,csa2,rex)<br>...<br>If we would call the function with just physically relevant arguments then we would have to use yet another condition to decide the type of the interaction in the loop
where individual interaction contributions are calculated. The physical quantities irrelevent for the given interaction (for
example csa1,csa2,rex for the dipole-dipole interaction) are None from
the initialization and will not be used by the function anyway.<br><br></div><blockquote class="gmail_quote" style="border-left: 1px solid rgb(204, 204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;"><div class="im">

<br>
&gt; Moreover, there is an unanswered question about the NOE and the additional<br>
&gt; dipolar interaction. I am not sure if the suggested design is physically<br>
&gt; correct, rather not. During the NOE experiment, the protons are saturated in<br>
&gt; order to reach the steady state. Then a complete set cross relaxation rates<br>
&gt; between all interacting spin pairs should be taken into the account, not<br>
&gt; only between the spin of interest and all other interacting nuclei. On the<br>
&gt; other hand this is probably beyond the aim of the program relax. What do you<br>
&gt; think about that?<br>
<br>
</div>This is getting quite complex as you would need to take the<br>
cross-correlated relaxation rates between the different relaxation<br>
interactions into account, as well as the motion of all spins if they<br>
are not directly bonded.  Is this needed for the current work?  Of<br>
course anything is accepted into relax, especially if you would like<br>
to probe this area (with a paper in mind), but it has to play nicely<br>
with the rest of relax and not be a burden on the relax developers to<br>
maintain in the future (as well as not make the current number<br>
crunching code slower than it already is).  The code would therefore<br>
need to be designed in public.  So if you would like to tackle such a<br>
task, I would first recommend finishing off the cst branch, and then<br>
make a new branch for this work.<br></blockquote><div><br>Then, I will design the code as I suggested. So, the sigma_noe will be calculated separately for all dipole-dipole interactions with the central spin (assuming they are isolated spin pairs). The total sigma_noe will be calculated as a sum of all individual sigma_noe contributions.<br>
<br></div><blockquote class="gmail_quote" style="border-left: 1px solid rgb(204, 204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;">
<br>
Regards,<br>
<font color="#888888"><br>
Edward<br></font></blockquote><div><br>Best regards,<br>Pavel <br></div></div><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00037" href="msg00037.html">Re: CST branch</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00000" href="msg00000.html">Re: CST branch</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00001" href="msg00001.html">Re: CST branch</a></strong>
<ul><li><em>From:</em> Pavel Kaderavek</li></ul></li>
<li><strong><a name="00002" href="msg00002.html">Re: CST branch</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00004" href="msg00004.html">Re: CST branch</a></strong>
<ul><li><em>From:</em> Pavel Kaderavek</li></ul></li>
<li><strong><a name="00005" href="msg00005.html">Re: CST branch</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00026" href="msg00026.html">Re: CST branch</a></strong>
<ul><li><em>From:</em> Pavel Kaderavek</li></ul></li>
<li><strong><a name="00027" href="msg00027.html">Re: CST branch</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Tue Mar 22 12:40:12 2011</div>  
</body>
</html>
