<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: Proposed solution to bug #6503. -->
<!--X-From-R13: Quevf [npDnvyq <p.n.znpenvyqNyrrqf.np.hx> -->
<!--X-Date: Wed, 09 Aug 2006 18:20:14 +0200 -->
<!--X-Message-Id: 1155140351.28764.463.camel@fbsdpcu021 -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 7f080ed10608082240r114cf35an60af62836fcc81bf@mail.gmail.com -->
<!--X-Reference: 1155116086.28764.393.camel@fbsdpcu021 -->
<!--X-Reference: 7f080ed10608090248i5c3a5832h166bc8c07f2cbc93@mail.gmail.com -->
<!--X-Reference: 1155120829.28764.436.camel@fbsdpcu021 -->
<!--X-Reference: 7f080ed10608090842g3a1a6e55k6033b44ba17bf29d@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Proposed solution to bug #6503. -- August 09, 2006 - 18:20</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Proposed solution to bug #6503.</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00048" class="tabs">Index by Date</a> | <a href="threads.html#00048" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00047.html">Date Prev</a>] [<a href="msg00049.html">Date Next</a>] [<a href="msg00041.html">Thread Prev</a>] [<a href="msg00049.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Wed, 09 Aug 2006 17:19:11 +0100</li>
<li class="menuitem">
<em>Cc</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00048.html">1155140351.28764.463.camel@fbsdpcu021</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;<a href="msg00029.html">7f080ed10608082240r114cf35an60af62836fcc81bf@mail.gmail.com</a>&gt;	&lt;<a href="msg00031.html">1155116086.28764.393.camel@fbsdpcu021</a>&gt;	&lt;<a href="msg00032.html">7f080ed10608090248i5c3a5832h166bc8c07f2cbc93@mail.gmail.com</a>&gt;	&lt;<a href="msg00034.html">1155120829.28764.436.camel@fbsdpcu021</a>&gt;	&lt;<a href="msg00041.html">7f080ed10608090842g3a1a6e55k6033b44ba17bf29d@mail.gmail.com</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Chris MacRaild</strong> on August 09, 2006 - 18:20:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">On Thu, 2006-08-10 at 01:42 +1000, Edward d'Auvergne wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">On 8/9/06, Chris MacRaild wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">On Wed, 2006-08-09 at 19:48 +1000, Edward d'Auvergne wrote:
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">As the function 'self.grid_search()' executes 'self.minimise()' this
single change will cover both the grid search and minimisation.  The
function 'isnan()' currently non-existent but could be implemented 
as
Gary previously mentioned by checking the hex bit pattern of NaN.
</pre></blockquote><pre style="margin: 0em;">

If isnan() is to be implimented in this way, then a similar isinf() is
by far the best way to go. float('inf') is platform dependent, and
certainly will not work under Windows (I think I'm right in saying
windows has no valid string representation of inf or nan that would 
work
in that context).
</pre></blockquote><pre style="margin: 0em;">

That one I didn't know about.  I thought Python handled inf correctly
but checking the bit value should be easy.  What about checking that
the value is less than 1e300 instead, as that is the arbitrary
starting point for the grid search?
</pre></blockquote><pre style="margin: 0em;">

In practise I'm fairly sure that will work. The purist might say that
the starting value should be INF, and the test should be for INF, but I
can't imagine anyone wanting to accept a grid search with Chi2 &gt; 1e300
</pre></blockquote><pre style="margin: 0em;">

Using this test means that the isinf() bit pattern testing function
doesn't need to be implemented.

</pre><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">

</pre><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">This avoids fpconst.py and the switch from Numeric to Numpy.  The
question is whether to use the RelaxErrors or set some warning?  
Would
this be alleviated by Gary's proposal of saving the program state 
just
prior to throwing the error?  For example using the function
'self.save()' within 'generic_fns/state.py', printing the error
message, then quitting.
</pre></blockquote><pre style="margin: 0em;">

Saving state as part of the exception handling is a nice idea, but has
its limitations. Because the error could be thrown before, during or
after some change to the program state, the state which is saved will 
be
undefined and possibly inconsistent. As such a saved state may be of
limited use to most users. It would be a very valuable tool for
debugging, though.
</pre></blockquote><pre style="margin: 0em;">

I suppose it will probably leave too many temporary files lying
around.  relax tends to throw errors if you do the slightest thing
wrong.
</pre></blockquote><pre style="margin: 0em;">

True. One option would be to leave the current behaviour as default, and
have an optional debugging mode which would allow for saving of state on
exceptions. Another feature which might be modified in debugging mode is
the suppression of tracebacks on KeyboardInterupt - it is sometimes nice
to know exactly what you have interupted when you are forced to ctrl-c
</pre></blockquote><pre style="margin: 0em;">

That's a an idea, dump the state if relax is run with the --debug
flag.  I'm not sure I follow what you mean with the behaviour of the
keyboard interrupt?  Do you mean that when ctrl-c is hit when run with
the --debug flag the program instantly and silently terminates without
printing the KeyboardInterrupt message?
</pre></blockquote><pre style="margin: 0em;">

Not exactly what I mean. If I ctrl-c from within Python, I get a
traceback similar to what I get if an exception is raised (because
KeyboardInterrupt is just another exception as far as Python is
concerned). In relax, when running from a script, KeyboardInterupt is
caught and the traceback is suppressed. The change I suggest is in
prompt/interpreter.py line 341:

except KeyboardInterrupt:
    if Debug:
        raise
    else:
        sys.stderr.write(&quot;\nScript execution cancelled.\n&quot;)

I used a this hack to workout the location of the infinite loop in the
line-search: ctrl-c when stuck in the loop and the traceback told me
exactly where I was in relax.

</pre><blockquote class="blockquote"><pre style="margin: 0em;">

Edward

</pre></blockquote><pre style="margin: 0em;">



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00049" href="msg00049.html">Re: Proposed solution to bug #6503.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00029" href="msg00029.html">Proposed solution to bug #6503.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00031" href="msg00031.html">Re: Proposed solution to bug #6503.</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00032" href="msg00032.html">Re: Proposed solution to bug #6503.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00034" href="msg00034.html">Re: Proposed solution to bug #6503.</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00041" href="msg00041.html">Re: Proposed solution to bug #6503.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Wed Aug 09 18:40:30 2006</div>  
</body>
</html>
