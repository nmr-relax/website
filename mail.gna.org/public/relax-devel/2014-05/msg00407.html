<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: r23277 &#45; in /branches/disp_speed: lib/dispersion/m61.py target_functions/relax_disp.py -->
<!--X-From-R13: "Sqjneq q'Ohiretar" &#60;rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Wed, 21 May 2014 09:54:27 +0200 -->
<!--X-Message-Id: CAED9pY8N&#45;GC5wO4XuT5vGzPLM5uKudChQFHmxnG1ogK=DH2D&#45;w@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: E1WmqfZ&#45;0007A5&#45;9H@subversion.gna.org -->
<!--X-Reference: CAED9pY_DLnydV9g8S1ew1wJVauvjL3sg1CZZcj+vxuAF=xa&#45;_Q@mail.gmail.com -->
<!--X-Reference: CA+CBx2OE+a2ngp29pDsxxEchD9Z=qwzeOBZGV+xAS1fFL=Z9Pg@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: r23277 - in /branches/disp_speed: lib/dispersion/m61.py target_functions/relax_disp.py -- May 21, 2014 - 09:54</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: r23277 - in /branches/disp_speed: lib/dispersion/m61.py target_functions/relax_disp.py</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00407" class="tabs">Index by Date</a> | <a href="threads.html#00407" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00406.html">Date Prev</a>] [<a href="msg00408.html">Date Next</a>] [<a href="msg00406.html">Thread Prev</a>] [<a href="msg00408.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Wed, 21 May 2014 09:53:36 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113; h=mime-version:sender:in-reply-to:references:date:message-id:subject :from:to:cc:content-type; bh=QHeRUalOM0Yi4VHz+hpj+ej8FtmBN4vzCTAS/gX5liI=; b=Mkt/St2fLBiAX791cQywUFxQcoXIo2UvrBKtuxgK9vAvkAyTybvz4u/P76+J5T8zBg IC59Hyx1T20dQvoDmHPfVQag9WMR2+Mn1zy3jjV0LCDvwTCrf7HCUy6R40Qc1zbghdU2 L8GvMRtUFd5lWxxSbK6O3SML2YCngA8f7MpCT1EKQtQy9+uSfL0pptlaS6VuZLRkIj4T 4lChgRJQAUidYRw9hj3b8qCC4PYXm/H69IJmvPf6+lt6S0rXHYS4Yt5k1X/KgfQ2vJvv NaQPq6KwDyYnbhBPQwgkIcuheIUHyOO4bvJoT/dpIry8Sojw335UGdQWowl9M2ZHVLfG zzAw==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;CAED9pY8N-GC5wO4XuT5vGzPLM5uKudChQFHmxnG1ogK=DH2D-w@mail.gmail.com&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;E1WmqfZ-0007A5-9H@subversion.gna.org&gt; &lt;CAED9pY_DLnydV9g8S1ew1wJVauvjL3sg1CZZcj+vxuAF=xa-_Q@mail.gmail.com&gt; &lt;CA+CBx2OE+a2ngp29pDsxxEchD9Z=qwzeOBZGV+xAS1fFL=Z9Pg@mail.gmail.com&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on May 21, 2014 - 09:54:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi,

Before making the changes, I have some points.  Especially about your point 
1).


</pre><blockquote class="blockquote"><pre style="margin: 0em;">Thanks for all the suggestions for correcting the error cathing.

I am looking into it, and I am very happy that you catch my errors.
</pre></blockquote><pre style="margin: 0em;">

No problems.  Code review is always useful!  Pity no one sees all the
bugs I add to the code.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">The reason why I did not split up the commit in two, as you have
suggested several times now,
was that I would not have been able to do the return command.

          But that was rubbish thinking!!!

I could have implemented the return command first for all models, and
then afterwards do all the error catching.
That could have made it easy for myself to revert the commits which
only deals with the error catching.
Sigh...., my logic thinking suffers from late night working. And my
stubbornness have here back-fired.
</pre></blockquote><pre style="margin: 0em;">

Oh well, that happens.  The practice with the late night working will
probably be useful when you are into the thesis writing state, so not
all is lost.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">And I am also sorry for the trouble this causes, when you have to
review all the commits to be put into the announcement with the list
of code changes.
One can probably not fathom this amount of work, and cursing, before
one have done itself. :-)
</pre></blockquote><pre style="margin: 0em;">

Well, if you have time one day and have interest, you could give it a
go yourself, following the instructions at docs/Release_Checklist.
The current relax 3.2.0 CHANGES file is huge right now and it is many
hours of work to sort that one out - deleting insignificant message,
fixing links, spelling mistakes, missing punctuation, capitalisation,
spacing, etc.  The minor releases are always a lot easier.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">Allright.

Line-up of work.
1) I will compare with trunk, and I will only implement the error
cathing which was as before.
</pre></blockquote><pre style="margin: 0em;">

Actually, you don't have to do this for all.  Implementing 2) below
will mean that most tests will now be redundant and removing them will
make the code faster :)


</pre><blockquote class="blockquote"><pre style="margin: 0em;">2) I will add:
# Catch parameter values that will result in no exchange, returning
flat R2eff = R20 lines.
if dw == 0.0 or pA == 1.0 or kex == 0.0:
    return array([R20]*num_points)
</pre></blockquote><pre style="margin: 0em;">

This would need some modification for R1rho and when R20A != R20B.
And for models which have different parameter sets.  It might be
possible to come up with some other original parameter checks at the
start so that all the later checks can be eliminated.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">3) I will keep this check, as a &quot;last line of defense&quot;.
    # Catch errors, taking a sum over array is the fastest way to check for
    # +/- inf (infinity) and nan (not a number).
    if not isfinite(sum(R2eff)):
        R2eff = array([1e100]*num_points)
</pre></blockquote><pre style="margin: 0em;">

This is useful.  If an optimisation algorithm hits an Inf or NaN
value, it will often never be able to recover.  Maybe I should have
added such error checking to minfx itself
(<a  rel="nofollow" href="https://gna.org/projects/minfx/">https://gna.org/projects/minfx/</a>) as I was developing it (as an aside,
did you know that I spent an entire year of my PhD reading the book
&quot;Numerical optimization&quot; by Nocedal and Wright, implementing each
algorithm one-by-one to learn everything about optimisation so that I
could understand why the other model-free optimisation software was so
often failing).


</pre><blockquote class="blockquote"><pre style="margin: 0em;">I hope you can bear with me, and I will again try to switch on the brain. 
:-)
</pre></blockquote><pre style="margin: 0em;">

It's ok as everything is in a branch, so there are no breakages in the trunk!

Regards,

Edward


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00405" href="msg00405.html">Re: r23277 - in /branches/disp_speed: lib/dispersion/m61.py target_functions/relax_disp.py</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00406" href="msg00406.html">Re: r23277 - in /branches/disp_speed: lib/dispersion/m61.py target_functions/relax_disp.py</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Wed May 21 13:00:18 2014</div>  
</body>
</html>
