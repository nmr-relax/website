<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: Peak list reading -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Sat, 21 Dec 2013 13:14:44 +0100 -->
<!--X-Message-Id: CAED9pY8pHtTTf_YAs6Uf&#45;6TcwLXctXLHfEt6p7UePEBbb7B=UQ@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: BLU177&#45;DS8226D46B9BA61A6D3651EC9C40@phx.gbl -->
<!--X-Reference: CA+CBx2OTnWWPB5YsfGh50tv4vqf8Da3PPDLKrmMuR4R3OdVT+A@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Peak list reading -- December 21, 2013 - 13:14</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Peak list reading</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00005" class="tabs">Index by Date</a> | <a href="threads.html#00005" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00004.html">Date Prev</a>] [<a href="msg00006.html">Date Next</a>] [<a href="msg00004.html">Thread Prev</a>] [<a href="msg00006.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Sat, 21 Dec 2013 13:14:13 +0100</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-users@xxxxxxx&quot; &lt;relax-users@xxxxxxx&gt;,	Min-Kyu Cho &lt;min-kyu.cho@xxxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113;	h=mime-version:sender:in-reply-to:references:date:message-id:subject	:from:to:cc:content-type:content-transfer-encoding;	bh=DEc3NUHwgReVr4rxhKqyrz61goBZyWRU8qf7GYiuRi8=;	b=Igqq5jOHO2QbEFpDkfI+CIlvAw75zYxJdh89v61kBHsMJyPQ3D8OxI00AUouqAGKu3	ZUphx1ZHnnVbMybrhBiaY7/wX4zp2KNF0xRzx51wyvYphVYSA5yUoV5j3hlbK0SnRGCh	cjHx7ZquvhmO0u0eQO2sYmSAnwb7VBPY318pAtnmF8gbzU6w+yBIX1UvZpSGllL63UBr	wmhtek8hcFJBdvEEYFwIHdhPP9IeIQJahxRRpI++XvOpC48J1oXyyAoHquHmeSfMNfu0	wn3Jhh9dce1AUB12x85A/u9ycv2Re9OnuAh8akAEXf0YUrMxqB7krelscWC0FWpHHhkt	IIUQ==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00005.html">CAED9pY8pHtTTf_YAs6Uf-6TcwLXctXLHfEt6p7UePEBbb7B=UQ@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;BLU177-DS8226D46B9BA61A6D3651EC9C40@xxxxxxx&gt;	&lt;CA+CBx2OTnWWPB5YsfGh50tv4vqf8Da3PPDLKrmMuR4R3OdVT+A@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on December 21, 2013 - 13:14:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi Min-Kyu and Troels,

</pre><blockquote class="blockquote"><pre style="margin: 0em;">From the messages, I can see 4 potential issues:
</pre></blockquote><pre style="margin: 0em;">

1)  The assignment:

568?-?  123.445 8.765 3.45E06

is ambiguous, as it could be any spin pair.  It is best to assign the
atoms properly, otherwise relax cannot tell if it is a N-H pair, the
Trp NE1-HE1 pair, or something more exotic.  Note that you can analyse
your Trp NE1 data at the same time as the backbone N data.  Troels, on
line 108 of the ./lib/spectrum/sparky.py file (as well as the other
peak list files in that package), maybe it is worth searching for the
&quot;?-?&quot; string in the assignment rather than matching &quot;?-?&quot; to skip the
line of data?  Actually it might be best if we just skip every single
assignment containing &quot;?&quot;, and just give a warning that the line is
being skipped as the assignment has a question mark in it.


2)  The Sparky assignment format is:

[Group][atom1]-[Group][atom2]-[Group][atom3]

The group is optional for the 2nd, 3rd, etc. dimensions.  The format
of the &quot;Group&quot; is not defined in Sparky, but in its manual it uses the
convention of letters for the residue name followed by the residue
number.  However despite the warnings from relax about the missing
residue name, I would assume that the data would be nevertheless read.
 The spectrum.read_intensities user function will print out a list of
all the intensities read into the program at the end, so you will be
able to tell what has been read or skipped.


3)  For you Troels - could you have a look at line 172 of the
./lib/spectrum/sparky.py file?  It has the confusing text &quot;Improperly
formatted NMRPipe SeriesTab file&quot; which is probably a copy and paste
error from the ./lib/spectrum/nmrpipe.py file.


4)  The &quot;IndexError: list index out of range&quot; might be due to the
badly formatted header line, as Troels mentioned.  Min-Kyu, if you fix
that, does the error go away?  Alternatively, it could be that one
line in the file is differently formatted, for some unknown reason.
This can be tested by deleting lines out of the file one by one until
the error goes away (except for the header which is needed to
determine the &quot;Data Height&quot; column).  If you do find that there is a
problem with the file, could you submit a bug report at
<a  rel="nofollow" href="https://gna.org/bugs/?func=additem&amp;group=relax">https://gna.org/bugs/?func=additem&amp;group=relax</a> and attach the
truncated peak list which still causes the error?  With this, I can
construct a system test for relax and also make sure that an
informative RelaxError or RelaxWarning is given so that the user knows
exactly what the problem is and how it should be fixed.


As for the FASTA format, this is not supported by relax yet.  This is
not a great format as you don't know the residue numbering and it will
very likely not start at one.  But as Troels mentioned, you can load
the sequence from your peak lists.  It might then be worth having the
amino acid names in the group part of the Sparky assignment if you
would like residue names to be present.

Regards,

Edward


P. S.  I may not be able to do much until after the new year so, if
you don't hear from me until then, I wish you a merry Christmas and
happy new year!




On 21 December 2013 02:41, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt; 
wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Min-Kyu.

I believe you probably need to define the right header
for the file.
ex:
      Assignment         w1         w2   Data Height

And see if you can fix the question marks.
568N-HN

Have a look in the test-suite for some typical definition of peaks files.
test_suite/shared_data/peak_lists

If you have a peak list, the new 3.1.1 version allow you to define the spins
from
a typical peak list.
spectrum.read_spins(file='peak_file.list', dir='/path/to/file')

Cheers



2013/12/20 Min-Kyu Cho &lt;min-kyu.cho@xxxxxxxx&gt;
</pre><blockquote class="blockquote"><pre style="margin: 0em;">

Hi ,





I got sparky peak list file written as



568?-?  123.445 8.765 3.45E06

. . . . .





When I tried to read in this file through GUI, it complains

----------

Sparky formatted data file.



Number of header lines found: 1

2D peak list detected.

RelaxWarning: Improperly formatted Sparky file, cannot process the residue
name for dimension 1 in assignment: 546N-H. Setting residue name to None.

RelaxWarning: Improperly formatted NMRPipe SeriesTab file, cannot process
the residue name for dimension 2 in assignment: 546N-H. Setting residue 
name
to None.

Traceback (most recent call last):

  File &quot;/home/mkc9/Programs/RELAX/relax-3.1.1/gui/wizards/wiz_objects.py&quot;,
line 161, in _apply

    self.exec_status = self.on_execute()

  File &quot;/home/mkc9/Programs/RELAX/relax-3.1.1/gui/uf_objects.py&quot;, line
883, in on_execute

    return_status = self.execute(self.name, **kargs)

  File &quot;/home/mkc9/Programs/RELAX/relax-3.1.1/gui/uf_objects.py&quot;, line
805, in execute

    return_status = interpreter.apply(uf, *args, **kwds)

  File &quot;/home/mkc9/Programs/RELAX/relax-3.1.1/gui/interpreter.py&quot;, line
109, in apply

    apply(fn, args, kwds)

  File &quot;/home/mkc9/Programs/RELAX/relax-3.1.1/pipe_control/spectrum.py&quot;,
line 530, in read

    peak_list = read_peak_list(file=file, dir=dir, int_col=int_col,
spin_id_col=spin_id_col, mol_name_col=mol_name_col, 
res_num_col=res_num_col,
res_name_col=res_name_col, spin_num_col=spin_num_col,
spin_name_col=spin_name_col, sep=sep, spin_id=spin_id)

  File &quot;/home/mkc9/Programs/RELAX/relax-3.1.1/lib/spectrum/peak_list.py&quot;,
line 208, in read_peak_list

    sparky.read_list(peak_list=peak_list, file_data=file_data)

  File &quot;/home/mkc9/Programs/RELAX/relax-3.1.1/lib/spectrum/sparky.py&quot;,
line 203, in read_list

    intensity = float(line[int_col])

IndexError: list index out of range

-----



Since I already made sequence &amp; spin system with correct residue number, I
expected the residue number in Sparky file should be enough.



So,my questions are:



1. the sparky file format for relax should be made as written in the
manual?



2. Can relax recognize FASTA sequence and automatically generate Spin
system?



Thanks and Happy Holiday!



Min-Kyu




_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-users mailing list
relax-users@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-users">https://mail.gna.org/listinfo/relax-users</a>

</pre></blockquote><pre style="margin: 0em;">


_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-users mailing list
relax-users@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-users">https://mail.gna.org/listinfo/relax-users</a>

</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00006" href="msg00006.html">Re: Peak list reading</a></strong>
<ul><li><em>From:</em> MK Cho</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00003" href="msg00003.html">Peak list reading</a></strong>
<ul><li><em>From:</em> Min-Kyu Cho</li></ul></li>
<li><strong><a name="00004" href="msg00004.html">Re: Peak list reading</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Sat Dec 21 15:40:06 2013</div>  
</body>
</html>
