<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>generic_fns.structure.main</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
  <!--Google analytics JS-->
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30096326-1']);
    _gaq.push(['_setDomainName', 'nmr-relax.com']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://www.nmr-relax.com">relax</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="generic_fns-module.html">Package&nbsp;generic_fns</a> ::
        <a href="generic_fns.structure-module.html">Package&nbsp;structure</a> ::
        Module&nbsp;main
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="generic_fns.structure.main-pysrc.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<h1 class="epydoc">Source Code for <a href="generic_fns.structure.main-module.html">Module generic_fns.structure.main</a></h1>
<pre class="py-src">
<a name="L1"></a><tt class="py-lineno">  1</tt>  <tt class="py-line"><tt class="py-comment">###############################################################################</tt> </tt>
<a name="L2"></a><tt class="py-lineno">  2</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L3"></a><tt class="py-lineno">  3</tt>  <tt class="py-line"><tt class="py-comment"># Copyright (C) 2003-2011 Edward d'Auvergne                                   #</tt> </tt>
<a name="L4"></a><tt class="py-lineno">  4</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L5"></a><tt class="py-lineno">  5</tt>  <tt class="py-line"><tt class="py-comment"># This file is part of the program relax.                                     #</tt> </tt>
<a name="L6"></a><tt class="py-lineno">  6</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L7"></a><tt class="py-lineno">  7</tt>  <tt class="py-line"><tt class="py-comment"># relax is free software; you can redistribute it and/or modify               #</tt> </tt>
<a name="L8"></a><tt class="py-lineno">  8</tt>  <tt class="py-line"><tt class="py-comment"># it under the terms of the GNU General Public License as published by        #</tt> </tt>
<a name="L9"></a><tt class="py-lineno">  9</tt>  <tt class="py-line"><tt class="py-comment"># the Free Software Foundation; either version 2 of the License, or           #</tt> </tt>
<a name="L10"></a><tt class="py-lineno"> 10</tt>  <tt class="py-line"><tt class="py-comment"># (at your option) any later version.                                         #</tt> </tt>
<a name="L11"></a><tt class="py-lineno"> 11</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L12"></a><tt class="py-lineno"> 12</tt>  <tt class="py-line"><tt class="py-comment"># relax is distributed in the hope that it will be useful,                    #</tt> </tt>
<a name="L13"></a><tt class="py-lineno"> 13</tt>  <tt class="py-line"><tt class="py-comment"># but WITHOUT ANY WARRANTY; without even the implied warranty of              #</tt> </tt>
<a name="L14"></a><tt class="py-lineno"> 14</tt>  <tt class="py-line"><tt class="py-comment"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the               #</tt> </tt>
<a name="L15"></a><tt class="py-lineno"> 15</tt>  <tt class="py-line"><tt class="py-comment"># GNU General Public License for more details.                                #</tt> </tt>
<a name="L16"></a><tt class="py-lineno"> 16</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L17"></a><tt class="py-lineno"> 17</tt>  <tt class="py-line"><tt class="py-comment"># You should have received a copy of the GNU General Public License           #</tt> </tt>
<a name="L18"></a><tt class="py-lineno"> 18</tt>  <tt class="py-line"><tt class="py-comment"># along with relax; if not, write to the Free Software                        #</tt> </tt>
<a name="L19"></a><tt class="py-lineno"> 19</tt>  <tt class="py-line"><tt class="py-comment"># Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA   #</tt> </tt>
<a name="L20"></a><tt class="py-lineno"> 20</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L21"></a><tt class="py-lineno"> 21</tt>  <tt class="py-line"><tt class="py-comment">###############################################################################</tt> </tt>
<a name="L22"></a><tt class="py-lineno"> 22</tt>  <tt class="py-line"> </tt>
<a name="L23"></a><tt class="py-lineno"> 23</tt>  <tt class="py-line"><tt class="py-comment"># Python module imports.</tt> </tt>
<a name="L24"></a><tt class="py-lineno"> 24</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">math</tt> <tt class="py-keyword">import</tt> <tt class="py-name">sqrt</tt> </tt>
<a name="L25"></a><tt class="py-lineno"> 25</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-0" class="py-name" targets="Package minfx=minfx-module.html"><a title="minfx" class="py-name" href="#" onclick="return doclink('link-0', 'minfx', 'link-0');">minfx</a></tt><tt class="py-op">.</tt><tt id="link-1" class="py-name" targets="Module minfx.generic=minfx.generic-module.html,Module test_suite.system_tests.generic=test_suite.system_tests.generic-module.html"><a title="minfx.generic
test_suite.system_tests.generic" class="py-name" href="#" onclick="return doclink('link-1', 'generic', 'link-1');">generic</a></tt> <tt class="py-keyword">import</tt> <tt id="link-2" class="py-name" targets="Function minfx.generic.generic_minimise()=minfx.generic-module.html#generic_minimise"><a title="minfx.generic.generic_minimise" class="py-name" href="#" onclick="return doclink('link-2', 'generic_minimise', 'link-2');">generic_minimise</a></tt> </tt>
<a name="L26"></a><tt class="py-lineno"> 26</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">numpy</tt> <tt class="py-keyword">import</tt> <tt class="py-name">array</tt><tt class="py-op">,</tt> <tt class="py-name">dot</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">,</tt> <tt class="py-name">ndarray</tt><tt class="py-op">,</tt> <tt class="py-name">zeros</tt> </tt>
<a name="L27"></a><tt class="py-lineno"> 27</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">numpy</tt><tt class="py-op">.</tt><tt class="py-name">linalg</tt> <tt class="py-keyword">import</tt> <tt class="py-name">norm</tt> </tt>
<a name="L28"></a><tt class="py-lineno"> 28</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">os</tt> <tt class="py-keyword">import</tt> <tt class="py-name">F_OK</tt><tt class="py-op">,</tt> <tt class="py-name">access</tt> </tt>
<a name="L29"></a><tt class="py-lineno"> 29</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">re</tt> <tt class="py-keyword">import</tt> <tt id="link-3" class="py-name" targets="Function generic_fns.relax_re.search()=generic_fns.relax_re-module.html#search"><a title="generic_fns.relax_re.search" class="py-name" href="#" onclick="return doclink('link-3', 'search', 'link-3');">search</a></tt> </tt>
<a name="L30"></a><tt class="py-lineno"> 30</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">string</tt> <tt class="py-keyword">import</tt> <tt class="py-name">replace</tt> </tt>
<a name="L31"></a><tt class="py-lineno"> 31</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">sys</tt> </tt>
<a name="L32"></a><tt class="py-lineno"> 32</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">warnings</tt> <tt class="py-keyword">import</tt> <tt class="py-name">warn</tt> </tt>
<a name="L33"></a><tt class="py-lineno"> 33</tt>  <tt class="py-line"> </tt>
<a name="L34"></a><tt class="py-lineno"> 34</tt>  <tt class="py-line"><tt class="py-comment"># relax module imports.</tt> </tt>
<a name="L35"></a><tt class="py-lineno"> 35</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-4" class="py-name" targets="Package generic_fns=generic_fns-module.html"><a title="generic_fns" class="py-name" href="#" onclick="return doclink('link-4', 'generic_fns', 'link-4');">generic_fns</a></tt> <tt class="py-keyword">import</tt> <tt id="link-5" class="py-name" targets="Module generic_fns.molmol=generic_fns.molmol-module.html,Module gui.user_functions.molmol=gui.user_functions.molmol-module.html,Module prompt.molmol=prompt.molmol-module.html,Module specific_fns.model_free.molmol=specific_fns.model_free.molmol-module.html"><a title="generic_fns.molmol
gui.user_functions.molmol
prompt.molmol
specific_fns.model_free.molmol" class="py-name" href="#" onclick="return doclink('link-5', 'molmol', 'link-5');">molmol</a></tt><tt class="py-op">,</tt> <tt id="link-6" class="py-name" targets="Module generic_fns.relax_re=generic_fns.relax_re-module.html"><a title="generic_fns.relax_re" class="py-name" href="#" onclick="return doclink('link-6', 'relax_re', 'link-6');">relax_re</a></tt> </tt>
<a name="L36"></a><tt class="py-lineno"> 36</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-7" class="py-name"><a title="generic_fns" class="py-name" href="#" onclick="return doclink('link-7', 'generic_fns', 'link-4');">generic_fns</a></tt><tt class="py-op">.</tt><tt id="link-8" class="py-name" targets="Module data.mol_res_spin=data.mol_res_spin-module.html,Module generic_fns.mol_res_spin=generic_fns.mol_res_spin-module.html,Module gui.user_functions.mol_res_spin=gui.user_functions.mol_res_spin-module.html"><a title="data.mol_res_spin
generic_fns.mol_res_spin
gui.user_functions.mol_res_spin" class="py-name" href="#" onclick="return doclink('link-8', 'mol_res_spin', 'link-8');">mol_res_spin</a></tt> <tt class="py-keyword">import</tt> <tt id="link-9" class="py-name" targets="Function generic_fns.mol_res_spin.create_spin()=generic_fns.mol_res_spin-module.html#create_spin,Method gui.spin_viewer.tree.Mol_res_spin_tree.create_spin()=gui.spin_viewer.tree.Mol_res_spin_tree-class.html#create_spin"><a title="generic_fns.mol_res_spin.create_spin
gui.spin_viewer.tree.Mol_res_spin_tree.create_spin" class="py-name" href="#" onclick="return doclink('link-9', 'create_spin', 'link-9');">create_spin</a></tt><tt class="py-op">,</tt> <tt id="link-10" class="py-name" targets="Function generic_fns.mol_res_spin.exists_mol_res_spin_data()=generic_fns.mol_res_spin-module.html#exists_mol_res_spin_data"><a title="generic_fns.mol_res_spin.exists_mol_res_spin_data" class="py-name" href="#" onclick="return doclink('link-10', 'exists_mol_res_spin_data', 'link-10');">exists_mol_res_spin_data</a></tt><tt class="py-op">,</tt> <tt id="link-11" class="py-name" targets="Function generic_fns.mol_res_spin.generate_spin_id()=generic_fns.mol_res_spin-module.html#generate_spin_id"><a title="generic_fns.mol_res_spin.generate_spin_id" class="py-name" href="#" onclick="return doclink('link-11', 'generate_spin_id', 'link-11');">generate_spin_id</a></tt><tt class="py-op">,</tt> <tt id="link-12" class="py-name" targets="Function generic_fns.mol_res_spin.linear_ave()=generic_fns.mol_res_spin-module.html#linear_ave"><a title="generic_fns.mol_res_spin.linear_ave" class="py-name" href="#" onclick="return doclink('link-12', 'linear_ave', 'link-12');">linear_ave</a></tt><tt class="py-op">,</tt> <tt id="link-13" class="py-name" targets="Function generic_fns.mol_res_spin.return_molecule()=generic_fns.mol_res_spin-module.html#return_molecule"><a title="generic_fns.mol_res_spin.return_molecule" class="py-name" href="#" onclick="return doclink('link-13', 'return_molecule', 'link-13');">return_molecule</a></tt><tt class="py-op">,</tt> <tt id="link-14" class="py-name" targets="Function generic_fns.mol_res_spin.return_residue()=generic_fns.mol_res_spin-module.html#return_residue"><a title="generic_fns.mol_res_spin.return_residue" class="py-name" href="#" onclick="return doclink('link-14', 'return_residue', 'link-14');">return_residue</a></tt><tt class="py-op">,</tt> <tt id="link-15" class="py-name" targets="Function generic_fns.mol_res_spin.return_spin()=generic_fns.mol_res_spin-module.html#return_spin"><a title="generic_fns.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-15', 'return_spin', 'link-15');">return_spin</a></tt><tt class="py-op">,</tt> <tt id="link-16" class="py-name" targets="Function generic_fns.mol_res_spin.spin_loop()=generic_fns.mol_res_spin-module.html#spin_loop"><a title="generic_fns.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-16', 'spin_loop', 'link-16');">spin_loop</a></tt> </tt>
<a name="L37"></a><tt class="py-lineno"> 37</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-17" class="py-name"><a title="generic_fns" class="py-name" href="#" onclick="return doclink('link-17', 'generic_fns', 'link-4');">generic_fns</a></tt> <tt class="py-keyword">import</tt> <tt id="link-18" class="py-name" targets="Module generic_fns.pipes=generic_fns.pipes-module.html,Module test_suite.system_tests.pipes=test_suite.system_tests.pipes-module.html"><a title="generic_fns.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-18', 'pipes', 'link-18');">pipes</a></tt> </tt>
<a name="L38"></a><tt class="py-lineno"> 38</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-19" class="py-name"><a title="generic_fns" class="py-name" href="#" onclick="return doclink('link-19', 'generic_fns', 'link-4');">generic_fns</a></tt><tt class="py-op">.</tt><tt id="link-20" class="py-name" targets="Package bmrblib.structure=bmrblib.structure-module.html,Package generic_fns.structure=generic_fns.structure-module.html,Module gui.user_functions.structure=gui.user_functions.structure-module.html,Module prompt.structure=prompt.structure-module.html,Module test_suite.system_tests.structure=test_suite.system_tests.structure-module.html"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-20', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-21" class="py-name" targets="Module generic_fns.structure.api_base=generic_fns.structure.api_base-module.html,Module specific_fns.api_base=specific_fns.api_base-module.html"><a title="generic_fns.structure.api_base
specific_fns.api_base" class="py-name" href="#" onclick="return doclink('link-21', 'api_base', 'link-21');">api_base</a></tt> <tt class="py-keyword">import</tt> <tt id="link-22" class="py-name" targets="Class generic_fns.structure.api_base.Displacements=generic_fns.structure.api_base.Displacements-class.html"><a title="generic_fns.structure.api_base.Displacements" class="py-name" href="#" onclick="return doclink('link-22', 'Displacements', 'link-22');">Displacements</a></tt> </tt>
<a name="L39"></a><tt class="py-lineno"> 39</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-23" class="py-name"><a title="generic_fns" class="py-name" href="#" onclick="return doclink('link-23', 'generic_fns', 'link-4');">generic_fns</a></tt><tt class="py-op">.</tt><tt id="link-24" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-24', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-25" class="py-name" targets="Module generic_fns.structure.internal=generic_fns.structure.internal-module.html"><a title="generic_fns.structure.internal" class="py-name" href="#" onclick="return doclink('link-25', 'internal', 'link-25');">internal</a></tt> <tt class="py-keyword">import</tt> <tt id="link-26" class="py-name" targets="Class generic_fns.structure.internal.Internal=generic_fns.structure.internal.Internal-class.html"><a title="generic_fns.structure.internal.Internal" class="py-name" href="#" onclick="return doclink('link-26', 'Internal', 'link-26');">Internal</a></tt> </tt>
<a name="L40"></a><tt class="py-lineno"> 40</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-27" class="py-name"><a title="generic_fns" class="py-name" href="#" onclick="return doclink('link-27', 'generic_fns', 'link-4');">generic_fns</a></tt><tt class="py-op">.</tt><tt id="link-28" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-28', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-29" class="py-name" targets="Module generic_fns.structure.scientific=generic_fns.structure.scientific-module.html"><a title="generic_fns.structure.scientific" class="py-name" href="#" onclick="return doclink('link-29', 'scientific', 'link-29');">scientific</a></tt> <tt class="py-keyword">import</tt> <tt id="link-30" class="py-name" targets="Class generic_fns.structure.scientific.Scientific_data=generic_fns.structure.scientific.Scientific_data-class.html"><a title="generic_fns.structure.scientific.Scientific_data" class="py-name" href="#" onclick="return doclink('link-30', 'Scientific_data', 'link-30');">Scientific_data</a></tt> </tt>
<a name="L41"></a><tt class="py-lineno"> 41</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-31" class="py-name"><a title="generic_fns" class="py-name" href="#" onclick="return doclink('link-31', 'generic_fns', 'link-4');">generic_fns</a></tt><tt class="py-op">.</tt><tt id="link-32" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-32', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-33" class="py-name" targets="Method auto_analyses.stereochem_analysis.Stereochem_analysis.superimpose()=auto_analyses.stereochem_analysis.Stereochem_analysis-class.html#superimpose,Function generic_fns.structure.main.superimpose()=generic_fns.structure.main-module.html#superimpose,Module generic_fns.structure.superimpose=generic_fns.structure.superimpose-module.html,Method prompt.structure.Structure.superimpose()=prompt.structure.Structure-class.html#superimpose"><a title="auto_analyses.stereochem_analysis.Stereochem_analysis.superimpose
generic_fns.structure.main.superimpose
generic_fns.structure.superimpose
prompt.structure.Structure.superimpose" class="py-name" href="#" onclick="return doclink('link-33', 'superimpose', 'link-33');">superimpose</a></tt> <tt class="py-keyword">import</tt> <tt id="link-34" class="py-name" targets="Function generic_fns.structure.superimpose.fit_to_first()=generic_fns.structure.superimpose-module.html#fit_to_first"><a title="generic_fns.structure.superimpose.fit_to_first" class="py-name" href="#" onclick="return doclink('link-34', 'fit_to_first', 'link-34');">fit_to_first</a></tt><tt class="py-op">,</tt> <tt id="link-35" class="py-name" targets="Function generic_fns.structure.superimpose.fit_to_mean()=generic_fns.structure.superimpose-module.html#fit_to_mean"><a title="generic_fns.structure.superimpose.fit_to_mean" class="py-name" href="#" onclick="return doclink('link-35', 'fit_to_mean', 'link-35');">fit_to_mean</a></tt><tt class="py-op">,</tt> <tt id="link-36" class="py-name" targets="Class generic_fns.structure.superimpose.Pivot_finder=generic_fns.structure.superimpose.Pivot_finder-class.html"><a title="generic_fns.structure.superimpose.Pivot_finder" class="py-name" href="#" onclick="return doclink('link-36', 'Pivot_finder', 'link-36');">Pivot_finder</a></tt> </tt>
<a name="L42"></a><tt class="py-lineno"> 42</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-37" class="py-name" targets="Module relax_errors=relax_errors-module.html"><a title="relax_errors" class="py-name" href="#" onclick="return doclink('link-37', 'relax_errors', 'link-37');">relax_errors</a></tt> <tt class="py-keyword">import</tt> <tt id="link-38" class="py-name" targets="Class relax_errors.RelaxError=relax_errors.RelaxError-class.html"><a title="relax_errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-38', 'RelaxError', 'link-38');">RelaxError</a></tt><tt class="py-op">,</tt> <tt id="link-39" class="py-name" targets="Class relax_errors.RelaxFileError=relax_errors.RelaxFileError-class.html"><a title="relax_errors.RelaxFileError" class="py-name" href="#" onclick="return doclink('link-39', 'RelaxFileError', 'link-39');">RelaxFileError</a></tt><tt class="py-op">,</tt> <tt id="link-40" class="py-name" targets="Class relax_errors.RelaxNoPdbError=relax_errors.RelaxNoPdbError-class.html"><a title="relax_errors.RelaxNoPdbError" class="py-name" href="#" onclick="return doclink('link-40', 'RelaxNoPdbError', 'link-40');">RelaxNoPdbError</a></tt><tt class="py-op">,</tt> <tt id="link-41" class="py-name" targets="Class relax_errors.RelaxNoSequenceError=relax_errors.RelaxNoSequenceError-class.html"><a title="relax_errors.RelaxNoSequenceError" class="py-name" href="#" onclick="return doclink('link-41', 'RelaxNoSequenceError', 'link-41');">RelaxNoSequenceError</a></tt> </tt>
<a name="L43"></a><tt class="py-lineno"> 43</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-42" class="py-name" targets="Module relax_io=relax_io-module.html"><a title="relax_io" class="py-name" href="#" onclick="return doclink('link-42', 'relax_io', 'link-42');">relax_io</a></tt> <tt class="py-keyword">import</tt> <tt id="link-43" class="py-name" targets="Function relax_io.get_file_path()=relax_io-module.html#get_file_path"><a title="relax_io.get_file_path" class="py-name" href="#" onclick="return doclink('link-43', 'get_file_path', 'link-43');">get_file_path</a></tt><tt class="py-op">,</tt> <tt id="link-44" class="py-name" targets="Function relax_io.open_write_file()=relax_io-module.html#open_write_file"><a title="relax_io.open_write_file" class="py-name" href="#" onclick="return doclink('link-44', 'open_write_file', 'link-44');">open_write_file</a></tt><tt class="py-op">,</tt> <tt id="link-45" class="py-name" targets="Function relax_io.write_spin_data()=relax_io-module.html#write_spin_data"><a title="relax_io.write_spin_data" class="py-name" href="#" onclick="return doclink('link-45', 'write_spin_data', 'link-45');">write_spin_data</a></tt> </tt>
<a name="L44"></a><tt class="py-lineno"> 44</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-46" class="py-name" targets="Module relax_warnings=relax_warnings-module.html"><a title="relax_warnings" class="py-name" href="#" onclick="return doclink('link-46', 'relax_warnings', 'link-46');">relax_warnings</a></tt> <tt class="py-keyword">import</tt> <tt id="link-47" class="py-name" targets="Class relax_warnings.RelaxWarning=relax_warnings.RelaxWarning-class.html"><a title="relax_warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-47', 'RelaxWarning', 'link-47');">RelaxWarning</a></tt><tt class="py-op">,</tt> <tt id="link-48" class="py-name" targets="Class relax_warnings.RelaxNoPDBFileWarning=relax_warnings.RelaxNoPDBFileWarning-class.html"><a title="relax_warnings.RelaxNoPDBFileWarning" class="py-name" href="#" onclick="return doclink('link-48', 'RelaxNoPDBFileWarning', 'link-48');">RelaxNoPDBFileWarning</a></tt><tt class="py-op">,</tt> <tt id="link-49" class="py-name" targets="Class relax_warnings.RelaxZeroVectorWarning=relax_warnings.RelaxZeroVectorWarning-class.html"><a title="relax_warnings.RelaxZeroVectorWarning" class="py-name" href="#" onclick="return doclink('link-49', 'RelaxZeroVectorWarning', 'link-49');">RelaxZeroVectorWarning</a></tt> </tt>
<a name="L45"></a><tt class="py-lineno"> 45</tt>  <tt class="py-line"> </tt>
<a name="L46"></a><tt class="py-lineno"> 46</tt>  <tt class="py-line"> </tt>
<a name="add_atom"></a><div id="add_atom-def"><a name="L47"></a><tt class="py-lineno"> 47</tt> <a class="py-toggle" href="#" id="add_atom-toggle" onclick="return toggle('add_atom');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.main-module.html#add_atom">add_atom</a><tt class="py-op">(</tt><tt class="py-param">mol_name</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">atom_name</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">res_name</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">res_num</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">pos</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-param">element</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">atom_num</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">chain_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">segment_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">pdb_record</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="add_atom-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="add_atom-expanded"><a name="L48"></a><tt class="py-lineno"> 48</tt>  <tt class="py-line">    <tt class="py-docstring">"""Add a new atom to the structural data object.</tt> </tt>
<a name="L49"></a><tt class="py-lineno"> 49</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L50"></a><tt class="py-lineno"> 50</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword mol_name:      The name of the molecule.</tt> </tt>
<a name="L51"></a><tt class="py-lineno"> 51</tt>  <tt class="py-line"><tt class="py-docstring">    @type mol_name:         str</tt> </tt>
<a name="L52"></a><tt class="py-lineno"> 52</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_name:     The atom name, e.g. 'H1'.</tt> </tt>
<a name="L53"></a><tt class="py-lineno"> 53</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_name:        str or None</tt> </tt>
<a name="L54"></a><tt class="py-lineno"> 54</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword res_name:      The residue name.</tt> </tt>
<a name="L55"></a><tt class="py-lineno"> 55</tt>  <tt class="py-line"><tt class="py-docstring">    @type res_name:         str or None</tt> </tt>
<a name="L56"></a><tt class="py-lineno"> 56</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword res_num:       The residue number.</tt> </tt>
<a name="L57"></a><tt class="py-lineno"> 57</tt>  <tt class="py-line"><tt class="py-docstring">    @type res_num:          int or None</tt> </tt>
<a name="L58"></a><tt class="py-lineno"> 58</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pos:           The position vector of coordinates.</tt> </tt>
<a name="L59"></a><tt class="py-lineno"> 59</tt>  <tt class="py-line"><tt class="py-docstring">    @type pos:              list (length = 3)</tt> </tt>
<a name="L60"></a><tt class="py-lineno"> 60</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword element:       The element symbol.</tt> </tt>
<a name="L61"></a><tt class="py-lineno"> 61</tt>  <tt class="py-line"><tt class="py-docstring">    @type element:          str or None</tt> </tt>
<a name="L62"></a><tt class="py-lineno"> 62</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_num:      The atom number.</tt> </tt>
<a name="L63"></a><tt class="py-lineno"> 63</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_num:         int or None</tt> </tt>
<a name="L64"></a><tt class="py-lineno"> 64</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword chain_id:      The chain identifier.</tt> </tt>
<a name="L65"></a><tt class="py-lineno"> 65</tt>  <tt class="py-line"><tt class="py-docstring">    @type chain_id:         str or None</tt> </tt>
<a name="L66"></a><tt class="py-lineno"> 66</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword segment_id:    The segment identifier.</tt> </tt>
<a name="L67"></a><tt class="py-lineno"> 67</tt>  <tt class="py-line"><tt class="py-docstring">    @type segment_id:       str or None</tt> </tt>
<a name="L68"></a><tt class="py-lineno"> 68</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pdb_record:    The optional PDB record name, e.g. 'ATOM' or 'HETATM'.</tt> </tt>
<a name="L69"></a><tt class="py-lineno"> 69</tt>  <tt class="py-line"><tt class="py-docstring">    @type pdb_record:       str or None</tt> </tt>
<a name="L70"></a><tt class="py-lineno"> 70</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L71"></a><tt class="py-lineno"> 71</tt>  <tt class="py-line"> </tt>
<a name="L72"></a><tt class="py-lineno"> 72</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L73"></a><tt class="py-lineno"> 73</tt>  <tt class="py-line">    <tt id="link-50" class="py-name"><a title="generic_fns.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-50', 'pipes', 'link-18');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-51" class="py-name" targets="Method bmrblib.pystarlib.TextTest.AllChecks.test()=bmrblib.pystarlib.TextTest.AllChecks-class.html#test,Method bmrblib.pystarlib.UtilsTest.AllChecks.test()=bmrblib.pystarlib.UtilsTest.AllChecks-class.html#test,Function generic_fns.pipes.test()=generic_fns.pipes-module.html#test"><a title="bmrblib.pystarlib.TextTest.AllChecks.test
bmrblib.pystarlib.UtilsTest.AllChecks.test
generic_fns.pipes.test" class="py-name" href="#" onclick="return doclink('link-51', 'test', 'link-51');">test</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L74"></a><tt class="py-lineno"> 74</tt>  <tt class="py-line"> </tt>
<a name="L75"></a><tt class="py-lineno"> 75</tt>  <tt class="py-line">    <tt class="py-comment"># Place the structural object into the relax data store if needed.</tt> </tt>
<a name="L76"></a><tt class="py-lineno"> 76</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L77"></a><tt class="py-lineno"> 77</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-52" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-52', 'structure', 'link-20');">structure</a></tt> <tt class="py-op">=</tt> <tt id="link-53" class="py-name"><a title="generic_fns.structure.internal.Internal" class="py-name" href="#" onclick="return doclink('link-53', 'Internal', 'link-26');">Internal</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L78"></a><tt class="py-lineno"> 78</tt>  <tt class="py-line"> </tt>
<a name="L79"></a><tt class="py-lineno"> 79</tt>  <tt class="py-line">    <tt class="py-comment"># Add the atoms.</tt> </tt>
<a name="L80"></a><tt class="py-lineno"> 80</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-54" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-54', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-55" class="py-name" targets="Method generic_fns.structure.api_base.Base_struct_API.add_atom()=generic_fns.structure.api_base.Base_struct_API-class.html#add_atom,Method generic_fns.structure.internal.Internal.add_atom()=generic_fns.structure.internal.Internal-class.html#add_atom,Function generic_fns.structure.main.add_atom()=generic_fns.structure.main-module.html#add_atom,Method prompt.structure.Structure.add_atom()=prompt.structure.Structure-class.html#add_atom"><a title="generic_fns.structure.api_base.Base_struct_API.add_atom
generic_fns.structure.internal.Internal.add_atom
generic_fns.structure.main.add_atom
prompt.structure.Structure.add_atom" class="py-name" href="#" onclick="return doclink('link-55', 'add_atom', 'link-55');">add_atom</a></tt><tt class="py-op">(</tt><tt class="py-name">mol_name</tt><tt class="py-op">=</tt><tt class="py-name">mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt class="py-name">atom_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">res_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt><tt class="py-op">=</tt><tt class="py-name">pos</tt><tt class="py-op">,</tt> <tt id="link-56" class="py-name" targets="Method gui.user_functions.spin.Spin.element()=gui.user_functions.spin.Spin-class.html#element,Method prompt.spin.Spin.element()=prompt.spin.Spin-class.html#element"><a title="gui.user_functions.spin.Spin.element
prompt.spin.Spin.element" class="py-name" href="#" onclick="return doclink('link-56', 'element', 'link-56');">element</a></tt><tt class="py-op">=</tt><tt id="link-57" class="py-name"><a title="gui.user_functions.spin.Spin.element
prompt.spin.Spin.element" class="py-name" href="#" onclick="return doclink('link-57', 'element', 'link-56');">element</a></tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">,</tt> <tt class="py-name">chain_id</tt><tt class="py-op">=</tt><tt class="py-name">chain_id</tt><tt class="py-op">,</tt> <tt class="py-name">segment_id</tt><tt class="py-op">=</tt><tt class="py-name">segment_id</tt><tt class="py-op">,</tt> <tt class="py-name">pdb_record</tt><tt class="py-op">=</tt><tt class="py-name">pdb_record</tt><tt class="py-op">)</tt> </tt>
</div><a name="L81"></a><tt class="py-lineno"> 81</tt>  <tt class="py-line"> </tt>
<a name="L82"></a><tt class="py-lineno"> 82</tt>  <tt class="py-line"> </tt>
<a name="connect_atom"></a><div id="connect_atom-def"><a name="L83"></a><tt class="py-lineno"> 83</tt> <a class="py-toggle" href="#" id="connect_atom-toggle" onclick="return toggle('connect_atom');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.main-module.html#connect_atom">connect_atom</a><tt class="py-op">(</tt><tt class="py-param">index1</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">index2</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="connect_atom-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="connect_atom-expanded"><a name="L84"></a><tt class="py-lineno"> 84</tt>  <tt class="py-line">    <tt class="py-docstring">"""Connect two atoms.</tt> </tt>
<a name="L85"></a><tt class="py-lineno"> 85</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L86"></a><tt class="py-lineno"> 86</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword index1:    The global index of the first atom.</tt> </tt>
<a name="L87"></a><tt class="py-lineno"> 87</tt>  <tt class="py-line"><tt class="py-docstring">    @type index1:       str</tt> </tt>
<a name="L88"></a><tt class="py-lineno"> 88</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword index2:    The global index of the first atom.</tt> </tt>
<a name="L89"></a><tt class="py-lineno"> 89</tt>  <tt class="py-line"><tt class="py-docstring">    @type index2:       str</tt> </tt>
<a name="L90"></a><tt class="py-lineno"> 90</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L91"></a><tt class="py-lineno"> 91</tt>  <tt class="py-line"> </tt>
<a name="L92"></a><tt class="py-lineno"> 92</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L93"></a><tt class="py-lineno"> 93</tt>  <tt class="py-line">    <tt id="link-58" class="py-name"><a title="generic_fns.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-58', 'pipes', 'link-18');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-59" class="py-name"><a title="bmrblib.pystarlib.TextTest.AllChecks.test
bmrblib.pystarlib.UtilsTest.AllChecks.test
generic_fns.pipes.test" class="py-name" href="#" onclick="return doclink('link-59', 'test', 'link-51');">test</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L94"></a><tt class="py-lineno"> 94</tt>  <tt class="py-line"> </tt>
<a name="L95"></a><tt class="py-lineno"> 95</tt>  <tt class="py-line">    <tt class="py-comment"># Place the structural object into the relax data store if needed.</tt> </tt>
<a name="L96"></a><tt class="py-lineno"> 96</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L97"></a><tt class="py-lineno"> 97</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-60" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-60', 'structure', 'link-20');">structure</a></tt> <tt class="py-op">=</tt> <tt id="link-61" class="py-name"><a title="generic_fns.structure.internal.Internal" class="py-name" href="#" onclick="return doclink('link-61', 'Internal', 'link-26');">Internal</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L98"></a><tt class="py-lineno"> 98</tt>  <tt class="py-line"> </tt>
<a name="L99"></a><tt class="py-lineno"> 99</tt>  <tt class="py-line">    <tt class="py-comment"># Add the atoms.</tt> </tt>
<a name="L100"></a><tt class="py-lineno">100</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-62" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-62', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-63" class="py-name" targets="Method generic_fns.structure.api_base.Base_struct_API.connect_atom()=generic_fns.structure.api_base.Base_struct_API-class.html#connect_atom,Method generic_fns.structure.internal.Internal.connect_atom()=generic_fns.structure.internal.Internal-class.html#connect_atom,Function generic_fns.structure.main.connect_atom()=generic_fns.structure.main-module.html#connect_atom,Method prompt.structure.Structure.connect_atom()=prompt.structure.Structure-class.html#connect_atom"><a title="generic_fns.structure.api_base.Base_struct_API.connect_atom
generic_fns.structure.internal.Internal.connect_atom
generic_fns.structure.main.connect_atom
prompt.structure.Structure.connect_atom" class="py-name" href="#" onclick="return doclink('link-63', 'connect_atom', 'link-63');">connect_atom</a></tt><tt class="py-op">(</tt><tt class="py-name">index1</tt><tt class="py-op">=</tt><tt class="py-name">index1</tt><tt class="py-op">,</tt> <tt class="py-name">index2</tt><tt class="py-op">=</tt><tt class="py-name">index2</tt><tt class="py-op">)</tt> </tt>
</div><a name="L101"></a><tt class="py-lineno">101</tt>  <tt class="py-line"> </tt>
<a name="L102"></a><tt class="py-lineno">102</tt>  <tt class="py-line"> </tt>
<a name="delete"></a><div id="delete-def"><a name="L103"></a><tt class="py-lineno">103</tt> <a class="py-toggle" href="#" id="delete-toggle" onclick="return toggle('delete');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.main-module.html#delete">delete</a><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="delete-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="delete-expanded"><a name="L104"></a><tt class="py-lineno">104</tt>  <tt class="py-line">    <tt class="py-docstring">"""Simple function for deleting all structural data."""</tt> </tt>
<a name="L105"></a><tt class="py-lineno">105</tt>  <tt class="py-line"> </tt>
<a name="L106"></a><tt class="py-lineno">106</tt>  <tt class="py-line">    <tt class="py-comment"># Run the object method.</tt> </tt>
<a name="L107"></a><tt class="py-lineno">107</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-64" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-64', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-65" class="py-name" targets="Function generic_fns.align_tensor.delete()=generic_fns.align_tensor-module.html#delete,Function generic_fns.diffusion_tensor.delete()=generic_fns.diffusion_tensor-module.html#delete,Function generic_fns.pcs.delete()=generic_fns.pcs-module.html#delete,Function generic_fns.pipes.delete()=generic_fns.pipes-module.html#delete,Function generic_fns.rdc.delete()=generic_fns.rdc-module.html#delete,Function generic_fns.relax_data.delete()=generic_fns.relax_data-module.html#delete,Function generic_fns.spectrum.delete()=generic_fns.spectrum-module.html#delete,Method generic_fns.structure.api_base.Base_struct_API.delete()=generic_fns.structure.api_base.Base_struct_API-class.html#delete,Method generic_fns.structure.internal.Internal.delete()=generic_fns.structure.internal.Internal-class.html#delete,Function generic_fns.structure.main.delete()=generic_fns.structure.main-module.html#delete,Method gui.analyses.auto_model_free.Auto_model_free.delete()=gui.analyses.auto_model_free.Auto_model_free-class.html#delete,Method gui.analyses.auto_noe.Auto_noe.delete()=gui.analyses.auto_noe.Auto_noe-class.html#delete,Method gui.analyses.auto_rx_base.Auto_rx.delete()=gui.analyses.auto_rx_base.Auto_rx-class.html#delete,Method gui.components.relax_data.Relax_data_list.delete()=gui.components.relax_data.Relax_data_list-class.html#delete,Method gui.components.spectrum.Spectra_list.delete()=gui.components.spectrum.Spectra_list-class.html#delete,Method gui.user_functions.molecule.Molecule.delete()=gui.user_functions.molecule.Molecule-class.html#delete,Method gui.user_functions.pipe.Pipe.delete()=gui.user_functions.pipe.Pipe-class.html#delete,Method gui.user_functions.relax_data.Relax_data.delete()=gui.user_functions.relax_data.Relax_data-class.html#delete,Method gui.user_functions.residue.Residue.delete()=gui.user_functions.residue.Residue-class.html#delete,Method gui.user_functions.spectrum.Spectrum.delete()=gui.user_functions.spectrum.Spectrum-class.html#delete,Method gui.user_functions.spin.Spin.delete()=gui.user_functions.spin.Spin-class.html#delete,Method gui.user_functions.structure.Structure.delete()=gui.user_functions.structure.Structure-class.html#delete,Method prompt.align_tensor.Align_tensor.delete()=prompt.align_tensor.Align_tensor-class.html#delete,Method prompt.diffusion_tensor.Diffusion_tensor.delete()=prompt.diffusion_tensor.Diffusion_tensor-class.html#delete,Method prompt.model_free.Model_free.delete()=prompt.model_free.Model_free-class.html#delete,Method prompt.molecule.Molecule.delete()=prompt.molecule.Molecule-class.html#delete,Method prompt.pcs.PCS.delete()=prompt.pcs.PCS-class.html#delete,Method prompt.pipe.Pipe.delete()=prompt.pipe.Pipe-class.html#delete,Method prompt.rdc.RDC.delete()=prompt.rdc.RDC-class.html#delete,Method prompt.relax_data.Relax_data.delete()=prompt.relax_data.Relax_data-class.html#delete,Method prompt.residue.Residue.delete()=prompt.residue.Residue-class.html#delete,Method prompt.spectrum.Spectrum.delete()=prompt.spectrum.Spectrum-class.html#delete,Method prompt.spin.Spin.delete()=prompt.spin.Spin-class.html#delete,Method prompt.structure.Structure.delete()=prompt.structure.Structure-class.html#delete,Function relax_io.delete()=relax_io-module.html#delete"><a title="generic_fns.align_tensor.delete
generic_fns.diffusion_tensor.delete
generic_fns.pcs.delete
generic_fns.pipes.delete
generic_fns.rdc.delete
generic_fns.relax_data.delete
generic_fns.spectrum.delete
generic_fns.structure.api_base.Base_struct_API.delete
generic_fns.structure.internal.Internal.delete
generic_fns.structure.main.delete
gui.analyses.auto_model_free.Auto_model_free.delete
gui.analyses.auto_noe.Auto_noe.delete
gui.analyses.auto_rx_base.Auto_rx.delete
gui.components.relax_data.Relax_data_list.delete
gui.components.spectrum.Spectra_list.delete
gui.user_functions.molecule.Molecule.delete
gui.user_functions.pipe.Pipe.delete
gui.user_functions.relax_data.Relax_data.delete
gui.user_functions.residue.Residue.delete
gui.user_functions.spectrum.Spectrum.delete
gui.user_functions.spin.Spin.delete
gui.user_functions.structure.Structure.delete
prompt.align_tensor.Align_tensor.delete
prompt.diffusion_tensor.Diffusion_tensor.delete
prompt.model_free.Model_free.delete
prompt.molecule.Molecule.delete
prompt.pcs.PCS.delete
prompt.pipe.Pipe.delete
prompt.rdc.RDC.delete
prompt.relax_data.Relax_data.delete
prompt.residue.Residue.delete
prompt.spectrum.Spectrum.delete
prompt.spin.Spin.delete
prompt.structure.Structure.delete
relax_io.delete" class="py-name" href="#" onclick="return doclink('link-65', 'delete', 'link-65');">delete</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L108"></a><tt class="py-lineno">108</tt>  <tt class="py-line"> </tt>
<a name="L109"></a><tt class="py-lineno">109</tt>  <tt class="py-line">    <tt class="py-comment"># Then remove any spin specific structural info.</tt> </tt>
<a name="L110"></a><tt class="py-lineno">110</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-66" class="py-name" targets="Method gui.user_functions.deselect.Deselect.spin()=gui.user_functions.deselect.Deselect-class.html#spin,Method gui.user_functions.select.Select.spin()=gui.user_functions.select.Select-class.html#spin,Module gui.user_functions.spin=gui.user_functions.spin-module.html,Method prompt.deselect.Deselect.spin()=prompt.deselect.Deselect-class.html#spin,Method prompt.select.Select.spin()=prompt.select.Select-class.html#spin,Module prompt.spin=prompt.spin-module.html,Module test_suite.unit_tests._generic_fns.spin=test_suite.unit_tests._generic_fns.spin-module.html"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-66', 'spin', 'link-66');">spin</a></tt> <tt class="py-keyword">in</tt> <tt id="link-67" class="py-name"><a title="generic_fns.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-67', 'spin_loop', 'link-16');">spin_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L111"></a><tt class="py-lineno">111</tt>  <tt class="py-line">        <tt class="py-comment"># Delete positional information.</tt> </tt>
<a name="L112"></a><tt class="py-lineno">112</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-68" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-68', 'spin', 'link-66');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pos'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L113"></a><tt class="py-lineno">113</tt>  <tt class="py-line">            <tt class="py-keyword">del</tt> <tt id="link-69" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-69', 'spin', 'link-66');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pos</tt> </tt>
<a name="L114"></a><tt class="py-lineno">114</tt>  <tt class="py-line"> </tt>
<a name="L115"></a><tt class="py-lineno">115</tt>  <tt class="py-line">        <tt class="py-comment"># Delete bond vectors.</tt> </tt>
<a name="L116"></a><tt class="py-lineno">116</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-70" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-70', 'spin', 'link-66');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'bond_vect'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L117"></a><tt class="py-lineno">117</tt>  <tt class="py-line">            <tt class="py-keyword">del</tt> <tt id="link-71" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-71', 'spin', 'link-66');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">bond_vect</tt> </tt>
<a name="L118"></a><tt class="py-lineno">118</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-72" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-72', 'spin', 'link-66');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'xh_vect'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L119"></a><tt class="py-lineno">119</tt>  <tt class="py-line">            <tt class="py-keyword">del</tt> <tt id="link-73" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-73', 'spin', 'link-66');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">xh_vect</tt> </tt>
</div><a name="L120"></a><tt class="py-lineno">120</tt>  <tt class="py-line"> </tt>
<a name="L121"></a><tt class="py-lineno">121</tt>  <tt class="py-line"> </tt>
<a name="displacement"></a><div id="displacement-def"><a name="L122"></a><tt class="py-lineno">122</tt> <a class="py-toggle" href="#" id="displacement-toggle" onclick="return toggle('displacement');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.main-module.html#displacement">displacement</a><tt class="py-op">(</tt><tt class="py-param">model_from</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">model_to</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">centroid</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="displacement-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="displacement-expanded"><a name="L123"></a><tt class="py-lineno">123</tt>  <tt class="py-line">    <tt class="py-docstring">"""Calculate the rotational and translational displacement between two structural models.</tt> </tt>
<a name="L124"></a><tt class="py-lineno">124</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L125"></a><tt class="py-lineno">125</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword model_from:        The optional model number for the starting position of the displacement.</tt> </tt>
<a name="L126"></a><tt class="py-lineno">126</tt>  <tt class="py-line"><tt class="py-docstring">    @type model_from:           int or None</tt> </tt>
<a name="L127"></a><tt class="py-lineno">127</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword model_to:          The optional model number for the ending position of the displacement.</tt> </tt>
<a name="L128"></a><tt class="py-lineno">128</tt>  <tt class="py-line"><tt class="py-docstring">    @type model_to:             int or None</tt> </tt>
<a name="L129"></a><tt class="py-lineno">129</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_id:           The molecule, residue, and atom identifier string.  This matches the spin ID string format.</tt> </tt>
<a name="L130"></a><tt class="py-lineno">130</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_id:              str or None</tt> </tt>
<a name="L131"></a><tt class="py-lineno">131</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword centroid:          An alternative position of the centroid, used for studying pivoted systems.</tt> </tt>
<a name="L132"></a><tt class="py-lineno">132</tt>  <tt class="py-line"><tt class="py-docstring">    @type centroid:             list of float or numpy rank-1, 3D array</tt> </tt>
<a name="L133"></a><tt class="py-lineno">133</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L134"></a><tt class="py-lineno">134</tt>  <tt class="py-line"> </tt>
<a name="L135"></a><tt class="py-lineno">135</tt>  <tt class="py-line">    <tt class="py-comment"># Convert the model_from and model_to args to lists, is supplied.</tt> </tt>
<a name="L136"></a><tt class="py-lineno">136</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">model_from</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L137"></a><tt class="py-lineno">137</tt>  <tt class="py-line">        <tt class="py-name">model_from</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-name">model_from</tt><tt class="py-op">]</tt> </tt>
<a name="L138"></a><tt class="py-lineno">138</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">model_to</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L139"></a><tt class="py-lineno">139</tt>  <tt class="py-line">        <tt class="py-name">model_to</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-name">model_to</tt><tt class="py-op">]</tt> </tt>
<a name="L140"></a><tt class="py-lineno">140</tt>  <tt class="py-line"> </tt>
<a name="L141"></a><tt class="py-lineno">141</tt>  <tt class="py-line">    <tt class="py-comment"># Create a list of all models.</tt> </tt>
<a name="L142"></a><tt class="py-lineno">142</tt>  <tt class="py-line">    <tt id="link-74" class="py-name" targets="Variable gui.analyses.auto_model_free.Local_tm_list.models=gui.analyses.auto_model_free.Local_tm_list-class.html#models,Variable gui.analyses.auto_model_free.Mf_list.models=gui.analyses.auto_model_free.Mf_list-class.html#models"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models" class="py-name" href="#" onclick="return doclink('link-74', 'models', 'link-74');">models</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L143"></a><tt class="py-lineno">143</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">model</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-75" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-75', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-76" class="py-name" targets="Method generic_fns.structure.api_base.Base_struct_API.model_loop()=generic_fns.structure.api_base.Base_struct_API-class.html#model_loop,Method specific_fns.api_base.API_base.model_loop()=specific_fns.api_base.API_base-class.html#model_loop,Method specific_fns.frame_order.Frame_order.model_loop()=specific_fns.frame_order.Frame_order-class.html#model_loop,Method specific_fns.hybrid.Hybrid.model_loop()=specific_fns.hybrid.Hybrid-class.html#model_loop,Method specific_fns.model_free.main.Model_free_main.model_loop()=specific_fns.model_free.main.Model_free_main-class.html#model_loop"><a title="generic_fns.structure.api_base.Base_struct_API.model_loop
specific_fns.api_base.API_base.model_loop
specific_fns.frame_order.Frame_order.model_loop
specific_fns.hybrid.Hybrid.model_loop
specific_fns.model_free.main.Model_free_main.model_loop" class="py-name" href="#" onclick="return doclink('link-76', 'model_loop', 'link-76');">model_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L144"></a><tt class="py-lineno">144</tt>  <tt class="py-line">        <tt id="link-77" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models" class="py-name" href="#" onclick="return doclink('link-77', 'models', 'link-74');">models</a></tt><tt class="py-op">.</tt><tt id="link-78" class="py-name" targets="Method data.align_tensor.AlignTensorSimList.append()=data.align_tensor.AlignTensorSimList-class.html#append,Method data.diff_tensor.DiffTensorSimList.append()=data.diff_tensor.DiffTensorSimList-class.html#append"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-78', 'append', 'link-78');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">model</tt><tt class="py-op">.</tt><tt class="py-name">num</tt><tt class="py-op">)</tt> </tt>
<a name="L145"></a><tt class="py-lineno">145</tt>  <tt class="py-line"> </tt>
<a name="L146"></a><tt class="py-lineno">146</tt>  <tt class="py-line">    <tt class="py-comment"># Set model_from or model_to to all models if None.</tt> </tt>
<a name="L147"></a><tt class="py-lineno">147</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">model_from</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L148"></a><tt class="py-lineno">148</tt>  <tt class="py-line">        <tt class="py-name">model_from</tt> <tt class="py-op">=</tt> <tt id="link-79" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models" class="py-name" href="#" onclick="return doclink('link-79', 'models', 'link-74');">models</a></tt> </tt>
<a name="L149"></a><tt class="py-lineno">149</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">model_to</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L150"></a><tt class="py-lineno">150</tt>  <tt class="py-line">        <tt class="py-name">model_to</tt> <tt class="py-op">=</tt> <tt id="link-80" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models" class="py-name" href="#" onclick="return doclink('link-80', 'models', 'link-74');">models</a></tt> </tt>
<a name="L151"></a><tt class="py-lineno">151</tt>  <tt class="py-line"> </tt>
<a name="L152"></a><tt class="py-lineno">152</tt>  <tt class="py-line">    <tt class="py-comment"># Initialise the data structure.</tt> </tt>
<a name="L153"></a><tt class="py-lineno">153</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-81" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-81', 'structure', 'link-20');">structure</a></tt><tt class="py-op">,</tt> <tt class="py-string">'displacements'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L154"></a><tt class="py-lineno">154</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-82" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-82', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt class="py-name">displacements</tt> <tt class="py-op">=</tt> <tt id="link-83" class="py-name"><a title="generic_fns.structure.api_base.Displacements" class="py-name" href="#" onclick="return doclink('link-83', 'Displacements', 'link-22');">Displacements</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L155"></a><tt class="py-lineno">155</tt>  <tt class="py-line"> </tt>
<a name="L156"></a><tt class="py-lineno">156</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over the starting models.</tt> </tt>
<a name="L157"></a><tt class="py-lineno">157</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-84" class="py-name" targets="Variable prompt.eliminate.Eliminate.i=prompt.eliminate.Eliminate-class.html#i,Variable prompt.minimisation.Minimisation.i=prompt.minimisation.Minimisation-class.html#i"><a title="prompt.eliminate.Eliminate.i
prompt.minimisation.Minimisation.i" class="py-name" href="#" onclick="return doclink('link-84', 'i', 'link-84');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">model_from</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L158"></a><tt class="py-lineno">158</tt>  <tt class="py-line">        <tt class="py-comment"># Assemble the atomic coordinates.</tt> </tt>
<a name="L159"></a><tt class="py-lineno">159</tt>  <tt class="py-line">        <tt class="py-name">coord_from</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L160"></a><tt class="py-lineno">160</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">pos</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-85" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-85', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-86" class="py-name" targets="Method generic_fns.structure.api_base.Base_struct_API.atom_loop()=generic_fns.structure.api_base.Base_struct_API-class.html#atom_loop,Method generic_fns.structure.internal.Internal.atom_loop()=generic_fns.structure.internal.Internal-class.html#atom_loop,Method generic_fns.structure.scientific.Scientific_data.atom_loop()=generic_fns.structure.scientific.Scientific_data-class.html#atom_loop"><a title="generic_fns.structure.api_base.Base_struct_API.atom_loop
generic_fns.structure.internal.Internal.atom_loop
generic_fns.structure.scientific.Scientific_data.atom_loop" class="py-name" href="#" onclick="return doclink('link-86', 'atom_loop', 'link-86');">atom_loop</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">atom_id</tt><tt class="py-op">,</tt> <tt class="py-name">model_num</tt><tt class="py-op">=</tt><tt class="py-name">model_from</tt><tt class="py-op">[</tt><tt id="link-87" class="py-name"><a title="prompt.eliminate.Eliminate.i
prompt.minimisation.Minimisation.i" class="py-name" href="#" onclick="return doclink('link-87', 'i', 'link-84');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">pos_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L161"></a><tt class="py-lineno">161</tt>  <tt class="py-line">            <tt class="py-name">coord_from</tt><tt class="py-op">.</tt><tt id="link-88" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-88', 'append', 'link-78');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">pos</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L162"></a><tt class="py-lineno">162</tt>  <tt class="py-line"> </tt>
<a name="L163"></a><tt class="py-lineno">163</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the ending models.</tt> </tt>
<a name="L164"></a><tt class="py-lineno">164</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">j</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">model_to</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L165"></a><tt class="py-lineno">165</tt>  <tt class="py-line">            <tt class="py-comment"># Assemble the atomic coordinates.</tt> </tt>
<a name="L166"></a><tt class="py-lineno">166</tt>  <tt class="py-line">            <tt class="py-name">coord_to</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L167"></a><tt class="py-lineno">167</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">pos</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-89" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-89', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-90" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.atom_loop
generic_fns.structure.internal.Internal.atom_loop
generic_fns.structure.scientific.Scientific_data.atom_loop" class="py-name" href="#" onclick="return doclink('link-90', 'atom_loop', 'link-86');">atom_loop</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">atom_id</tt><tt class="py-op">,</tt> <tt class="py-name">model_num</tt><tt class="py-op">=</tt><tt class="py-name">model_to</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">pos_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L168"></a><tt class="py-lineno">168</tt>  <tt class="py-line">                <tt class="py-name">coord_to</tt><tt class="py-op">.</tt><tt id="link-91" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-91', 'append', 'link-78');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">pos</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L169"></a><tt class="py-lineno">169</tt>  <tt class="py-line"> </tt>
<a name="L170"></a><tt class="py-lineno">170</tt>  <tt class="py-line">            <tt class="py-comment"># Send to the base container for the calculations.</tt> </tt>
<a name="L171"></a><tt class="py-lineno">171</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-92" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-92', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt class="py-name">displacements</tt><tt class="py-op">.</tt><tt id="link-93" class="py-name" targets="Method generic_fns.structure.api_base.Displacements._calculate()=generic_fns.structure.api_base.Displacements-class.html#_calculate"><a title="generic_fns.structure.api_base.Displacements._calculate" class="py-name" href="#" onclick="return doclink('link-93', '_calculate', 'link-93');">_calculate</a></tt><tt class="py-op">(</tt><tt class="py-name">model_from</tt><tt class="py-op">=</tt><tt class="py-name">model_from</tt><tt class="py-op">[</tt><tt id="link-94" class="py-name"><a title="prompt.eliminate.Eliminate.i
prompt.minimisation.Minimisation.i" class="py-name" href="#" onclick="return doclink('link-94', 'i', 'link-84');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">model_to</tt><tt class="py-op">=</tt><tt class="py-name">model_to</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">coord_from</tt><tt class="py-op">=</tt><tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">coord_from</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">coord_to</tt><tt class="py-op">=</tt><tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">coord_to</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">centroid</tt><tt class="py-op">=</tt><tt class="py-name">centroid</tt><tt class="py-op">)</tt> </tt>
</div><a name="L172"></a><tt class="py-lineno">172</tt>  <tt class="py-line"> </tt>
<a name="L173"></a><tt class="py-lineno">173</tt>  <tt class="py-line"> </tt>
<a name="find_pivot"></a><div id="find_pivot-def"><a name="L174"></a><tt class="py-lineno">174</tt> <a class="py-toggle" href="#" id="find_pivot-toggle" onclick="return toggle('find_pivot');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.main-module.html#find_pivot">find_pivot</a><tt class="py-op">(</tt><tt class="py-param">models</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">init_pos</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="find_pivot-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="find_pivot-expanded"><a name="L175"></a><tt class="py-lineno">175</tt>  <tt class="py-line">    <tt class="py-docstring">"""Superimpose a set of structural models.</tt> </tt>
<a name="L176"></a><tt class="py-lineno">176</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L177"></a><tt class="py-lineno">177</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword models:    The list of models to use.  If set to None, then all models will be used.</tt> </tt>
<a name="L178"></a><tt class="py-lineno">178</tt>  <tt class="py-line"><tt class="py-docstring">    @type models:       list of int or None</tt> </tt>
<a name="L179"></a><tt class="py-lineno">179</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_id:   The molecule, residue, and atom identifier string.  This matches the spin ID string format.</tt> </tt>
<a name="L180"></a><tt class="py-lineno">180</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_id:      str or None</tt> </tt>
<a name="L181"></a><tt class="py-lineno">181</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword init_pos:  The starting pivot position for the pivot point optimisation.</tt> </tt>
<a name="L182"></a><tt class="py-lineno">182</tt>  <tt class="py-line"><tt class="py-docstring">    @type init_pos:     list of float or numpy rank-1, 3D array</tt> </tt>
<a name="L183"></a><tt class="py-lineno">183</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L184"></a><tt class="py-lineno">184</tt>  <tt class="py-line"> </tt>
<a name="L185"></a><tt class="py-lineno">185</tt>  <tt class="py-line">    <tt class="py-comment"># Initialised the starting position if needed.</tt> </tt>
<a name="L186"></a><tt class="py-lineno">186</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">init_pos</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L187"></a><tt class="py-lineno">187</tt>  <tt class="py-line">        <tt class="py-name">init_pos</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-number">3</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L188"></a><tt class="py-lineno">188</tt>  <tt class="py-line">    <tt class="py-name">init_pos</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">init_pos</tt><tt class="py-op">)</tt> </tt>
<a name="L189"></a><tt class="py-lineno">189</tt>  <tt class="py-line"> </tt>
<a name="L190"></a><tt class="py-lineno">190</tt>  <tt class="py-line">    <tt class="py-comment"># Validate the models.</tt> </tt>
<a name="L191"></a><tt class="py-lineno">191</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-95" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-95', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-96" class="py-name" targets="Method generic_fns.structure.api_base.Base_struct_API.validate_models()=generic_fns.structure.api_base.Base_struct_API-class.html#validate_models,Method generic_fns.structure.internal.Internal.validate_models()=generic_fns.structure.internal.Internal-class.html#validate_models"><a title="generic_fns.structure.api_base.Base_struct_API.validate_models
generic_fns.structure.internal.Internal.validate_models" class="py-name" href="#" onclick="return doclink('link-96', 'validate_models', 'link-96');">validate_models</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L192"></a><tt class="py-lineno">192</tt>  <tt class="py-line"> </tt>
<a name="L193"></a><tt class="py-lineno">193</tt>  <tt class="py-line">    <tt class="py-comment"># Create a list of all models.</tt> </tt>
<a name="L194"></a><tt class="py-lineno">194</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-97" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models" class="py-name" href="#" onclick="return doclink('link-97', 'models', 'link-74');">models</a></tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L195"></a><tt class="py-lineno">195</tt>  <tt class="py-line">        <tt id="link-98" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models" class="py-name" href="#" onclick="return doclink('link-98', 'models', 'link-74');">models</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L196"></a><tt class="py-lineno">196</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">model</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-99" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-99', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-100" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.model_loop
specific_fns.api_base.API_base.model_loop
specific_fns.frame_order.Frame_order.model_loop
specific_fns.hybrid.Hybrid.model_loop
specific_fns.model_free.main.Model_free_main.model_loop" class="py-name" href="#" onclick="return doclink('link-100', 'model_loop', 'link-76');">model_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L197"></a><tt class="py-lineno">197</tt>  <tt class="py-line">            <tt id="link-101" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models" class="py-name" href="#" onclick="return doclink('link-101', 'models', 'link-74');">models</a></tt><tt class="py-op">.</tt><tt id="link-102" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-102', 'append', 'link-78');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">model</tt><tt class="py-op">.</tt><tt class="py-name">num</tt><tt class="py-op">)</tt> </tt>
<a name="L198"></a><tt class="py-lineno">198</tt>  <tt class="py-line"> </tt>
<a name="L199"></a><tt class="py-lineno">199</tt>  <tt class="py-line">    <tt class="py-comment"># Assemble the atomic coordinates of all models.</tt> </tt>
<a name="L200"></a><tt class="py-lineno">200</tt>  <tt class="py-line">    <tt class="py-name">coord</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L201"></a><tt class="py-lineno">201</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">model</tt> <tt class="py-keyword">in</tt> <tt id="link-103" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models" class="py-name" href="#" onclick="return doclink('link-103', 'models', 'link-74');">models</a></tt><tt class="py-op">:</tt> </tt>
<a name="L202"></a><tt class="py-lineno">202</tt>  <tt class="py-line">        <tt class="py-name">coord</tt><tt class="py-op">.</tt><tt id="link-104" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-104', 'append', 'link-78');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L203"></a><tt class="py-lineno">203</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">pos</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-105" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-105', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-106" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.atom_loop
generic_fns.structure.internal.Internal.atom_loop
generic_fns.structure.scientific.Scientific_data.atom_loop" class="py-name" href="#" onclick="return doclink('link-106', 'atom_loop', 'link-86');">atom_loop</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">atom_id</tt><tt class="py-op">,</tt> <tt class="py-name">model_num</tt><tt class="py-op">=</tt><tt class="py-name">model</tt><tt class="py-op">,</tt> <tt class="py-name">pos_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L204"></a><tt class="py-lineno">204</tt>  <tt class="py-line">            <tt class="py-name">coord</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-107" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-107', 'append', 'link-78');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">pos</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L205"></a><tt class="py-lineno">205</tt>  <tt class="py-line">        <tt class="py-name">coord</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">coord</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L206"></a><tt class="py-lineno">206</tt>  <tt class="py-line">    <tt class="py-name">coord</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">coord</tt><tt class="py-op">)</tt> </tt>
<a name="L207"></a><tt class="py-lineno">207</tt>  <tt class="py-line"> </tt>
<a name="L208"></a><tt class="py-lineno">208</tt>  <tt class="py-line">    <tt class="py-comment"># The target function.</tt> </tt>
<a name="L209"></a><tt class="py-lineno">209</tt>  <tt class="py-line">    <tt class="py-name">finder</tt> <tt class="py-op">=</tt> <tt id="link-108" class="py-name"><a title="generic_fns.structure.superimpose.Pivot_finder" class="py-name" href="#" onclick="return doclink('link-108', 'Pivot_finder', 'link-36');">Pivot_finder</a></tt><tt class="py-op">(</tt><tt id="link-109" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models" class="py-name" href="#" onclick="return doclink('link-109', 'models', 'link-74');">models</a></tt><tt class="py-op">,</tt> <tt class="py-name">coord</tt><tt class="py-op">)</tt> </tt>
<a name="L210"></a><tt class="py-lineno">210</tt>  <tt class="py-line">    <tt id="link-110" class="py-name" targets="Module generic_fns.results=generic_fns.results-module.html,Module gui.user_functions.results=gui.user_functions.results-module.html,Module prompt.results=prompt.results-module.html,Module specific_fns.model_free.results=specific_fns.model_free.results-module.html,Module test_suite.system_tests.results=test_suite.system_tests.results-module.html"><a title="generic_fns.results
gui.user_functions.results
prompt.results
specific_fns.model_free.results
test_suite.system_tests.results" class="py-name" href="#" onclick="return doclink('link-110', 'results', 'link-110');">results</a></tt> <tt class="py-op">=</tt> <tt id="link-111" class="py-name"><a title="minfx.generic.generic_minimise" class="py-name" href="#" onclick="return doclink('link-111', 'generic_minimise', 'link-2');">generic_minimise</a></tt><tt class="py-op">(</tt><tt id="link-112" class="py-name" targets="Method generic_fns.structure.superimpose.Pivot_finder.func()=generic_fns.structure.superimpose.Pivot_finder-class.html#func,Method maths_fns.consistency_tests.Consistency.func()=maths_fns.consistency_tests.Consistency-class.html#func,Method maths_fns.jw_mapping.Mapping.func()=maths_fns.jw_mapping.Mapping-class.html#func,Method minfx.constraint_linear.Constraint_linear.func()=minfx.constraint_linear.Constraint_linear-class.html#func"><a title="generic_fns.structure.superimpose.Pivot_finder.func
maths_fns.consistency_tests.Consistency.func
maths_fns.jw_mapping.Mapping.func
minfx.constraint_linear.Constraint_linear.func" class="py-name" href="#" onclick="return doclink('link-112', 'func', 'link-112');">func</a></tt><tt class="py-op">=</tt><tt class="py-name">finder</tt><tt class="py-op">.</tt><tt id="link-113" class="py-name"><a title="generic_fns.structure.superimpose.Pivot_finder.func
maths_fns.consistency_tests.Consistency.func
maths_fns.jw_mapping.Mapping.func
minfx.constraint_linear.Constraint_linear.func" class="py-name" href="#" onclick="return doclink('link-113', 'func', 'link-112');">func</a></tt><tt class="py-op">,</tt> <tt class="py-name">x0</tt><tt class="py-op">=</tt><tt class="py-name">init_pos</tt><tt class="py-op">,</tt> <tt class="py-name">min_algor</tt><tt class="py-op">=</tt><tt class="py-string">'simplex'</tt><tt class="py-op">,</tt> <tt class="py-name">print_flag</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L211"></a><tt class="py-lineno">211</tt>  <tt class="py-line"> </tt>
<a name="L212"></a><tt class="py-lineno">212</tt>  <tt class="py-line">    <tt class="py-comment"># No result.</tt> </tt>
<a name="L213"></a><tt class="py-lineno">213</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-114" class="py-name"><a title="generic_fns.results
gui.user_functions.results
prompt.results
specific_fns.model_free.results
test_suite.system_tests.results" class="py-name" href="#" onclick="return doclink('link-114', 'results', 'link-110');">results</a></tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L214"></a><tt class="py-lineno">214</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> </tt>
<a name="L215"></a><tt class="py-lineno">215</tt>  <tt class="py-line"> </tt>
<a name="L216"></a><tt class="py-lineno">216</tt>  <tt class="py-line">    <tt class="py-comment"># Store the data.</tt> </tt>
<a name="L217"></a><tt class="py-lineno">217</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-115" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-115', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-116" class="py-name" targets="Method prompt.frame_order.Frame_order.pivot()=prompt.frame_order.Frame_order-class.html#pivot"><a title="prompt.frame_order.Frame_order.pivot" class="py-name" href="#" onclick="return doclink('link-116', 'pivot', 'link-116');">pivot</a></tt> <tt class="py-op">=</tt> <tt id="link-117" class="py-name"><a title="generic_fns.results
gui.user_functions.results
prompt.results
specific_fns.model_free.results
test_suite.system_tests.results" class="py-name" href="#" onclick="return doclink('link-117', 'results', 'link-110');">results</a></tt> </tt>
<a name="L218"></a><tt class="py-lineno">218</tt>  <tt class="py-line"> </tt>
<a name="L219"></a><tt class="py-lineno">219</tt>  <tt class="py-line">    <tt class="py-comment"># Print out.</tt> </tt>
<a name="L220"></a><tt class="py-lineno">220</tt>  <tt class="py-line">    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Motional pivot found at:  %s"</tt> <tt class="py-op">%</tt> <tt id="link-118" class="py-name"><a title="generic_fns.results
gui.user_functions.results
prompt.results
specific_fns.model_free.results
test_suite.system_tests.results" class="py-name" href="#" onclick="return doclink('link-118', 'results', 'link-110');">results</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L221"></a><tt class="py-lineno">221</tt>  <tt class="py-line"> </tt>
<a name="L222"></a><tt class="py-lineno">222</tt>  <tt class="py-line"> </tt>
<a name="L223"></a><tt class="py-lineno">223</tt>  <tt class="py-line"> </tt>
<a name="L224"></a><tt class="py-lineno">224</tt>  <tt class="py-line"> </tt>
<a name="get_pos"></a><div id="get_pos-def"><a name="L225"></a><tt class="py-lineno">225</tt> <a class="py-toggle" href="#" id="get_pos-toggle" onclick="return toggle('get_pos');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.main-module.html#get_pos">get_pos</a><tt class="py-op">(</tt><tt class="py-param">spin_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">str_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">ave_pos</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="get_pos-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="get_pos-expanded"><a name="L226"></a><tt class="py-lineno">226</tt>  <tt class="py-line">    <tt class="py-docstring">"""Load the spins from the structural object into the relax data store.</tt> </tt>
<a name="L227"></a><tt class="py-lineno">227</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L228"></a><tt class="py-lineno">228</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword spin_id:           The molecule, residue, and spin identifier string.</tt> </tt>
<a name="L229"></a><tt class="py-lineno">229</tt>  <tt class="py-line"><tt class="py-docstring">    @type spin_id:              str</tt> </tt>
<a name="L230"></a><tt class="py-lineno">230</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword str_id:            The structure identifier.  This can be the file name, model number, or structure number.</tt> </tt>
<a name="L231"></a><tt class="py-lineno">231</tt>  <tt class="py-line"><tt class="py-docstring">    @type str_id:               int or str</tt> </tt>
<a name="L232"></a><tt class="py-lineno">232</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword ave_pos:           A flag specifying if the average atom position or the atom position from all loaded structures is loaded into the SpinContainer.</tt> </tt>
<a name="L233"></a><tt class="py-lineno">233</tt>  <tt class="py-line"><tt class="py-docstring">    @type ave_pos:              bool</tt> </tt>
<a name="L234"></a><tt class="py-lineno">234</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L235"></a><tt class="py-lineno">235</tt>  <tt class="py-line"> </tt>
<a name="L236"></a><tt class="py-lineno">236</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L237"></a><tt class="py-lineno">237</tt>  <tt class="py-line">    <tt id="link-119" class="py-name"><a title="generic_fns.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-119', 'pipes', 'link-18');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-120" class="py-name"><a title="bmrblib.pystarlib.TextTest.AllChecks.test
bmrblib.pystarlib.UtilsTest.AllChecks.test
generic_fns.pipes.test" class="py-name" href="#" onclick="return doclink('link-120', 'test', 'link-51');">test</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L238"></a><tt class="py-lineno">238</tt>  <tt class="py-line"> </tt>
<a name="L239"></a><tt class="py-lineno">239</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the structure exists.</tt> </tt>
<a name="L240"></a><tt class="py-lineno">240</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-121" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-121', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-122" class="py-name" targets="Method generic_fns.structure.api_base.Base_struct_API.num_models()=generic_fns.structure.api_base.Base_struct_API-class.html#num_models"><a title="generic_fns.structure.api_base.Base_struct_API.num_models" class="py-name" href="#" onclick="return doclink('link-122', 'num_models', 'link-122');">num_models</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-123" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-123', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-124" class="py-name" targets="Method generic_fns.structure.api_base.Base_struct_API.num_molecules()=generic_fns.structure.api_base.Base_struct_API-class.html#num_molecules"><a title="generic_fns.structure.api_base.Base_struct_API.num_molecules" class="py-name" href="#" onclick="return doclink('link-124', 'num_molecules', 'link-124');">num_molecules</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L241"></a><tt class="py-lineno">241</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-125" class="py-name"><a title="relax_errors.RelaxNoPdbError" class="py-name" href="#" onclick="return doclink('link-125', 'RelaxNoPdbError', 'link-40');">RelaxNoPdbError</a></tt> </tt>
<a name="L242"></a><tt class="py-lineno">242</tt>  <tt class="py-line"> </tt>
<a name="L243"></a><tt class="py-lineno">243</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over all atoms of the spin_id selection.</tt> </tt>
<a name="L244"></a><tt class="py-lineno">244</tt>  <tt class="py-line">    <tt class="py-name">model_index</tt> <tt class="py-op">=</tt> <tt class="py-op">-</tt><tt class="py-number">1</tt> </tt>
<a name="L245"></a><tt class="py-lineno">245</tt>  <tt class="py-line">    <tt class="py-name">last_model</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L246"></a><tt class="py-lineno">246</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">model_num</tt><tt class="py-op">,</tt> <tt class="py-name">mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">,</tt> <tt id="link-126" class="py-name"><a title="gui.user_functions.spin.Spin.element
prompt.spin.Spin.element" class="py-name" href="#" onclick="return doclink('link-126', 'element', 'link-56');">element</a></tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-127" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-127', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-128" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.atom_loop
generic_fns.structure.internal.Internal.atom_loop
generic_fns.structure.scientific.Scientific_data.atom_loop" class="py-name" href="#" onclick="return doclink('link-128', 'atom_loop', 'link-86');">atom_loop</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">spin_id</tt><tt class="py-op">,</tt> <tt class="py-name">str_id</tt><tt class="py-op">=</tt><tt class="py-name">str_id</tt><tt class="py-op">,</tt> <tt class="py-name">model_num_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">mol_name_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">res_num_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">res_name_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">element_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">pos_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">ave</tt><tt class="py-op">=</tt><tt class="py-name">ave_pos</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L247"></a><tt class="py-lineno">247</tt>  <tt class="py-line">        <tt class="py-comment"># Update the model info.</tt> </tt>
<a name="L248"></a><tt class="py-lineno">248</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">last_model</tt> <tt class="py-op">!=</tt> <tt class="py-name">model_num</tt><tt class="py-op">:</tt> </tt>
<a name="L249"></a><tt class="py-lineno">249</tt>  <tt class="py-line">            <tt class="py-name">model_index</tt> <tt class="py-op">=</tt> <tt class="py-name">model_index</tt> <tt class="py-op">+</tt> <tt class="py-number">1</tt> </tt>
<a name="L250"></a><tt class="py-lineno">250</tt>  <tt class="py-line">            <tt class="py-name">last_model</tt> <tt class="py-op">=</tt> <tt class="py-name">model_num</tt> </tt>
<a name="L251"></a><tt class="py-lineno">251</tt>  <tt class="py-line"> </tt>
<a name="L252"></a><tt class="py-lineno">252</tt>  <tt class="py-line">        <tt class="py-comment"># Remove the '+' regular expression character from the mol, res, and spin names!</tt> </tt>
<a name="L253"></a><tt class="py-lineno">253</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">mol_name</tt> <tt class="py-keyword">and</tt> <tt id="link-129" class="py-name"><a title="generic_fns.relax_re.search" class="py-name" href="#" onclick="return doclink('link-129', 'search', 'link-3');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'\+'</tt><tt class="py-op">,</tt> <tt class="py-name">mol_name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L254"></a><tt class="py-lineno">254</tt>  <tt class="py-line">            <tt class="py-name">mol_name</tt> <tt class="py-op">=</tt> <tt class="py-name">replace</tt><tt class="py-op">(</tt><tt class="py-name">mol_name</tt><tt class="py-op">,</tt> <tt class="py-string">'+'</tt><tt class="py-op">,</tt> <tt class="py-string">''</tt><tt class="py-op">)</tt> </tt>
<a name="L255"></a><tt class="py-lineno">255</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">res_name</tt> <tt class="py-keyword">and</tt> <tt id="link-130" class="py-name"><a title="generic_fns.relax_re.search" class="py-name" href="#" onclick="return doclink('link-130', 'search', 'link-3');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'\+'</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L256"></a><tt class="py-lineno">256</tt>  <tt class="py-line">            <tt class="py-name">res_name</tt> <tt class="py-op">=</tt> <tt class="py-name">replace</tt><tt class="py-op">(</tt><tt class="py-name">res_name</tt><tt class="py-op">,</tt> <tt class="py-string">'+'</tt><tt class="py-op">,</tt> <tt class="py-string">''</tt><tt class="py-op">)</tt> </tt>
<a name="L257"></a><tt class="py-lineno">257</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">atom_name</tt> <tt class="py-keyword">and</tt> <tt id="link-131" class="py-name"><a title="generic_fns.relax_re.search" class="py-name" href="#" onclick="return doclink('link-131', 'search', 'link-3');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'\+'</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L258"></a><tt class="py-lineno">258</tt>  <tt class="py-line">            <tt class="py-name">atom_name</tt> <tt class="py-op">=</tt> <tt class="py-name">replace</tt><tt class="py-op">(</tt><tt class="py-name">atom_name</tt><tt class="py-op">,</tt> <tt class="py-string">'+'</tt><tt class="py-op">,</tt> <tt class="py-string">''</tt><tt class="py-op">)</tt> </tt>
<a name="L259"></a><tt class="py-lineno">259</tt>  <tt class="py-line"> </tt>
<a name="L260"></a><tt class="py-lineno">260</tt>  <tt class="py-line">        <tt class="py-comment"># The spin identification string.  The residue name and spin num is not included to allow molecules with point mutations to be used as different models.</tt> </tt>
<a name="L261"></a><tt class="py-lineno">261</tt>  <tt class="py-line">        <tt id="link-132" class="py-name" targets="Variable generic_fns.structure.api_base.Base_struct_API.id=generic_fns.structure.api_base.Base_struct_API-class.html#id,Variable generic_fns.structure.internal.Internal.id=generic_fns.structure.internal.Internal-class.html#id,Variable generic_fns.structure.scientific.Scientific_data.id=generic_fns.structure.scientific.Scientific_data-class.html#id"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-132', 'id', 'link-132');">id</a></tt> <tt class="py-op">=</tt> <tt id="link-133" class="py-name"><a title="generic_fns.mol_res_spin.generate_spin_id" class="py-name" href="#" onclick="return doclink('link-133', 'generate_spin_id', 'link-11');">generate_spin_id</a></tt><tt class="py-op">(</tt><tt class="py-name">mol_name</tt><tt class="py-op">=</tt><tt class="py-name">mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">spin_name</tt><tt class="py-op">=</tt><tt class="py-name">atom_name</tt><tt class="py-op">)</tt> </tt>
<a name="L262"></a><tt class="py-lineno">262</tt>  <tt class="py-line"> </tt>
<a name="L263"></a><tt class="py-lineno">263</tt>  <tt class="py-line">        <tt class="py-comment"># Get the spin container.</tt> </tt>
<a name="L264"></a><tt class="py-lineno">264</tt>  <tt class="py-line">        <tt class="py-name">spin_cont</tt> <tt class="py-op">=</tt> <tt id="link-134" class="py-name"><a title="generic_fns.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-134', 'return_spin', 'link-15');">return_spin</a></tt><tt class="py-op">(</tt><tt id="link-135" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-135', 'id', 'link-132');">id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L265"></a><tt class="py-lineno">265</tt>  <tt class="py-line"> </tt>
<a name="L266"></a><tt class="py-lineno">266</tt>  <tt class="py-line">        <tt class="py-comment"># Skip the spin if it doesn't exist.</tt> </tt>
<a name="L267"></a><tt class="py-lineno">267</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">spin_cont</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L268"></a><tt class="py-lineno">268</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L269"></a><tt class="py-lineno">269</tt>  <tt class="py-line"> </tt>
<a name="L270"></a><tt class="py-lineno">270</tt>  <tt class="py-line">        <tt class="py-comment"># Add the position vector to the spin container.</tt> </tt>
<a name="L271"></a><tt class="py-lineno">271</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">ave_pos</tt><tt class="py-op">:</tt> </tt>
<a name="L272"></a><tt class="py-lineno">272</tt>  <tt class="py-line">            <tt class="py-name">spin_cont</tt><tt class="py-op">.</tt><tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt class="py-name">pos</tt> </tt>
<a name="L273"></a><tt class="py-lineno">273</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L274"></a><tt class="py-lineno">274</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">spin_cont</tt><tt class="py-op">,</tt> <tt class="py-string">'pos'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L275"></a><tt class="py-lineno">275</tt>  <tt class="py-line">                <tt class="py-name">spin_cont</tt><tt class="py-op">.</tt><tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L276"></a><tt class="py-lineno">276</tt>  <tt class="py-line">            <tt class="py-name">spin_cont</tt><tt class="py-op">.</tt><tt class="py-name">pos</tt><tt class="py-op">.</tt><tt id="link-136" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-136', 'append', 'link-78');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">pos</tt><tt class="py-op">)</tt> </tt>
<a name="L277"></a><tt class="py-lineno">277</tt>  <tt class="py-line"> </tt>
<a name="L278"></a><tt class="py-lineno">278</tt>  <tt class="py-line">    <tt class="py-comment"># Update pseudo-atoms.</tt> </tt>
<a name="L279"></a><tt class="py-lineno">279</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-137" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-137', 'spin', 'link-66');">spin</a></tt> <tt class="py-keyword">in</tt> <tt id="link-138" class="py-name"><a title="generic_fns.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-138', 'spin_loop', 'link-16');">spin_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L280"></a><tt class="py-lineno">280</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-139" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-139', 'spin', 'link-66');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'members'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L281"></a><tt class="py-lineno">281</tt>  <tt class="py-line">            <tt class="py-comment"># Get the spin positions.</tt> </tt>
<a name="L282"></a><tt class="py-lineno">282</tt>  <tt class="py-line">            <tt class="py-name">positions</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L283"></a><tt class="py-lineno">283</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">atom</tt> <tt class="py-keyword">in</tt> <tt id="link-140" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-140', 'spin', 'link-66');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">members</tt><tt class="py-op">:</tt> </tt>
<a name="L284"></a><tt class="py-lineno">284</tt>  <tt class="py-line">                <tt class="py-comment"># Get the spin container.</tt> </tt>
<a name="L285"></a><tt class="py-lineno">285</tt>  <tt class="py-line">                <tt class="py-name">subspin</tt> <tt class="py-op">=</tt> <tt id="link-141" class="py-name"><a title="generic_fns.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-141', 'return_spin', 'link-15');">return_spin</a></tt><tt class="py-op">(</tt><tt class="py-name">atom</tt><tt class="py-op">)</tt> </tt>
<a name="L286"></a><tt class="py-lineno">286</tt>  <tt class="py-line"> </tt>
<a name="L287"></a><tt class="py-lineno">287</tt>  <tt class="py-line">                <tt class="py-comment"># Test that the spin exists.</tt> </tt>
<a name="L288"></a><tt class="py-lineno">288</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">subspin</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L289"></a><tt class="py-lineno">289</tt>  <tt class="py-line">                    <tt class="py-keyword">raise</tt> <tt id="link-142" class="py-name" targets="Class relax_errors.RelaxNoSpinError=relax_errors.RelaxNoSpinError-class.html"><a title="relax_errors.RelaxNoSpinError" class="py-name" href="#" onclick="return doclink('link-142', 'RelaxNoSpinError', 'link-142');">RelaxNoSpinError</a></tt><tt class="py-op">(</tt><tt class="py-name">atom</tt><tt class="py-op">)</tt> </tt>
<a name="L290"></a><tt class="py-lineno">290</tt>  <tt class="py-line"> </tt>
<a name="L291"></a><tt class="py-lineno">291</tt>  <tt class="py-line">                <tt class="py-comment"># Test the position.</tt> </tt>
<a name="L292"></a><tt class="py-lineno">292</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">subspin</tt><tt class="py-op">,</tt> <tt class="py-string">'pos'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">subspin</tt><tt class="py-op">.</tt><tt class="py-name">pos</tt><tt class="py-op">:</tt> </tt>
<a name="L293"></a><tt class="py-lineno">293</tt>  <tt class="py-line">                    <tt class="py-keyword">raise</tt> <tt id="link-143" class="py-name"><a title="relax_errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-143', 'RelaxError', 'link-38');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Positional information is not available for the atom '%s'."</tt> <tt class="py-op">%</tt> <tt class="py-name">atom</tt><tt class="py-op">)</tt> </tt>
<a name="L294"></a><tt class="py-lineno">294</tt>  <tt class="py-line"> </tt>
<a name="L295"></a><tt class="py-lineno">295</tt>  <tt class="py-line">                <tt class="py-comment"># Alias the position.</tt> </tt>
<a name="L296"></a><tt class="py-lineno">296</tt>  <tt class="py-line">                <tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt class="py-name">subspin</tt><tt class="py-op">.</tt><tt class="py-name">pos</tt> </tt>
<a name="L297"></a><tt class="py-lineno">297</tt>  <tt class="py-line"> </tt>
<a name="L298"></a><tt class="py-lineno">298</tt>  <tt class="py-line">                <tt class="py-comment"># Convert to a list of lists if not already.</tt> </tt>
<a name="L299"></a><tt class="py-lineno">299</tt>  <tt class="py-line">                <tt id="link-144" class="py-name" targets="Method auto_analyses.dauvergne_protocol.dAuvergne_protocol.multi_model()=auto_analyses.dauvergne_protocol.dAuvergne_protocol-class.html#multi_model"><a title="auto_analyses.dauvergne_protocol.dAuvergne_protocol.multi_model" class="py-name" href="#" onclick="return doclink('link-144', 'multi_model', 'link-144');">multi_model</a></tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L300"></a><tt class="py-lineno">300</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt id="link-145" class="py-name" targets="Variable info.Bieri11.type=info.Bieri11-class.html#type,Variable info.Clore90.type=info.Clore90-class.html#type,Variable info.Delaglio95.type=info.Delaglio95-class.html#type,Variable info.GoddardKneller.type=info.GoddardKneller-class.html#type,Variable info.LipariSzabo82a.type=info.LipariSzabo82a-class.html#type,Variable info.LipariSzabo82b.type=info.LipariSzabo82b-class.html#type,Variable info.Ref.type=info.Ref-class.html#type,Variable info.dAuvergne06.type=info.dAuvergne06-class.html#type,Variable info.dAuvergneGooley03.type=info.dAuvergneGooley03-class.html#type,Variable info.dAuvergneGooley06.type=info.dAuvergneGooley06-class.html#type,Variable info.dAuvergneGooley07.type=info.dAuvergneGooley07-class.html#type,Variable info.dAuvergneGooley08a.type=info.dAuvergneGooley08a-class.html#type,Variable info.dAuvergneGooley08b.type=info.dAuvergneGooley08b-class.html#type,Method prompt.molecule.Molecule.type()=prompt.molecule.Molecule-class.html#type"><a title="info.Bieri11.type
info.Clore90.type
info.Delaglio95.type
info.GoddardKneller.type
info.LipariSzabo82a.type
info.LipariSzabo82b.type
info.Ref.type
info.dAuvergne06.type
info.dAuvergneGooley03.type
info.dAuvergneGooley06.type
info.dAuvergneGooley07.type
info.dAuvergneGooley08a.type
info.dAuvergneGooley08b.type
prompt.molecule.Molecule.type" class="py-name" href="#" onclick="return doclink('link-145', 'type', 'link-145');">type</a></tt><tt class="py-op">(</tt><tt class="py-name">pos</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt id="link-146" class="py-name" targets="Module float=float-module.html"><a title="float" class="py-name" href="#" onclick="return doclink('link-146', 'float', 'link-146');">float</a></tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L301"></a><tt class="py-lineno">301</tt>  <tt class="py-line">                    <tt id="link-147" class="py-name"><a title="auto_analyses.dauvergne_protocol.dAuvergne_protocol.multi_model" class="py-name" href="#" onclick="return doclink('link-147', 'multi_model', 'link-144');">multi_model</a></tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L302"></a><tt class="py-lineno">302</tt>  <tt class="py-line">                    <tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-name">pos</tt><tt class="py-op">]</tt> </tt>
<a name="L303"></a><tt class="py-lineno">303</tt>  <tt class="py-line"> </tt>
<a name="L304"></a><tt class="py-lineno">304</tt>  <tt class="py-line">                <tt class="py-comment"># Store the position.</tt> </tt>
<a name="L305"></a><tt class="py-lineno">305</tt>  <tt class="py-line">                <tt class="py-name">positions</tt><tt class="py-op">.</tt><tt id="link-148" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-148', 'append', 'link-78');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L306"></a><tt class="py-lineno">306</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt id="link-149" class="py-name"><a title="prompt.eliminate.Eliminate.i
prompt.minimisation.Minimisation.i" class="py-name" href="#" onclick="return doclink('link-149', 'i', 'link-84');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">pos</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L307"></a><tt class="py-lineno">307</tt>  <tt class="py-line">                    <tt class="py-name">positions</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-150" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-150', 'append', 'link-78');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">pos</tt><tt class="py-op">[</tt><tt id="link-151" class="py-name"><a title="prompt.eliminate.Eliminate.i
prompt.minimisation.Minimisation.i" class="py-name" href="#" onclick="return doclink('link-151', 'i', 'link-84');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">tolist</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L308"></a><tt class="py-lineno">308</tt>  <tt class="py-line"> </tt>
<a name="L309"></a><tt class="py-lineno">309</tt>  <tt class="py-line">            <tt class="py-comment"># The averaging.</tt> </tt>
<a name="L310"></a><tt class="py-lineno">310</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-152" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-152', 'spin', 'link-66');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">averaging</tt> <tt class="py-op">==</tt> <tt class="py-string">'linear'</tt><tt class="py-op">:</tt> </tt>
<a name="L311"></a><tt class="py-lineno">311</tt>  <tt class="py-line">                <tt class="py-comment"># Average pos.</tt> </tt>
<a name="L312"></a><tt class="py-lineno">312</tt>  <tt class="py-line">                <tt class="py-name">ave</tt> <tt class="py-op">=</tt> <tt id="link-153" class="py-name"><a title="generic_fns.mol_res_spin.linear_ave" class="py-name" href="#" onclick="return doclink('link-153', 'linear_ave', 'link-12');">linear_ave</a></tt><tt class="py-op">(</tt><tt class="py-name">positions</tt><tt class="py-op">)</tt> </tt>
<a name="L313"></a><tt class="py-lineno">313</tt>  <tt class="py-line"> </tt>
<a name="L314"></a><tt class="py-lineno">314</tt>  <tt class="py-line">                <tt class="py-comment"># Convert to the correct structure.</tt> </tt>
<a name="L315"></a><tt class="py-lineno">315</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt id="link-154" class="py-name"><a title="auto_analyses.dauvergne_protocol.dAuvergne_protocol.multi_model" class="py-name" href="#" onclick="return doclink('link-154', 'multi_model', 'link-144');">multi_model</a></tt><tt class="py-op">:</tt> </tt>
<a name="L316"></a><tt class="py-lineno">316</tt>  <tt class="py-line">                    <tt id="link-155" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-155', 'spin', 'link-66');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt class="py-name">ave</tt> </tt>
<a name="L317"></a><tt class="py-lineno">317</tt>  <tt class="py-line">                <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L318"></a><tt class="py-lineno">318</tt>  <tt class="py-line">                    <tt id="link-156" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-156', 'spin', 'link-66');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt class="py-name">ave</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
</div><a name="L319"></a><tt class="py-lineno">319</tt>  <tt class="py-line"> </tt>
<a name="L320"></a><tt class="py-lineno">320</tt>  <tt class="py-line"> </tt>
<a name="load_spins"></a><div id="load_spins-def"><a name="L321"></a><tt class="py-lineno">321</tt> <a class="py-toggle" href="#" id="load_spins-toggle" onclick="return toggle('load_spins');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.main-module.html#load_spins">load_spins</a><tt class="py-op">(</tt><tt class="py-param">spin_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">str_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">ave_pos</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="load_spins-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="load_spins-expanded"><a name="L322"></a><tt class="py-lineno">322</tt>  <tt class="py-line">    <tt class="py-docstring">"""Load the spins from the structural object into the relax data store.</tt> </tt>
<a name="L323"></a><tt class="py-lineno">323</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L324"></a><tt class="py-lineno">324</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword spin_id:           The molecule, residue, and spin identifier string.</tt> </tt>
<a name="L325"></a><tt class="py-lineno">325</tt>  <tt class="py-line"><tt class="py-docstring">    @type spin_id:              str</tt> </tt>
<a name="L326"></a><tt class="py-lineno">326</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword str_id:            The structure identifier.  This can be the file name, model number, or structure number.</tt> </tt>
<a name="L327"></a><tt class="py-lineno">327</tt>  <tt class="py-line"><tt class="py-docstring">    @type str_id:               int or str</tt> </tt>
<a name="L328"></a><tt class="py-lineno">328</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword ave_pos:           A flag specifying if the average atom position or the atom position from all loaded structures is loaded into the SpinContainer.</tt> </tt>
<a name="L329"></a><tt class="py-lineno">329</tt>  <tt class="py-line"><tt class="py-docstring">    @type ave_pos:              bool</tt> </tt>
<a name="L330"></a><tt class="py-lineno">330</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L331"></a><tt class="py-lineno">331</tt>  <tt class="py-line"> </tt>
<a name="L332"></a><tt class="py-lineno">332</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L333"></a><tt class="py-lineno">333</tt>  <tt class="py-line">    <tt id="link-157" class="py-name"><a title="generic_fns.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-157', 'pipes', 'link-18');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-158" class="py-name"><a title="bmrblib.pystarlib.TextTest.AllChecks.test
bmrblib.pystarlib.UtilsTest.AllChecks.test
generic_fns.pipes.test" class="py-name" href="#" onclick="return doclink('link-158', 'test', 'link-51');">test</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L334"></a><tt class="py-lineno">334</tt>  <tt class="py-line"> </tt>
<a name="L335"></a><tt class="py-lineno">335</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the structure exists.</tt> </tt>
<a name="L336"></a><tt class="py-lineno">336</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-159" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-159', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-160" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.num_models" class="py-name" href="#" onclick="return doclink('link-160', 'num_models', 'link-122');">num_models</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-161" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-161', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-162" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.num_molecules" class="py-name" href="#" onclick="return doclink('link-162', 'num_molecules', 'link-124');">num_molecules</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L337"></a><tt class="py-lineno">337</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-163" class="py-name"><a title="relax_errors.RelaxNoPdbError" class="py-name" href="#" onclick="return doclink('link-163', 'RelaxNoPdbError', 'link-40');">RelaxNoPdbError</a></tt> </tt>
<a name="L338"></a><tt class="py-lineno">338</tt>  <tt class="py-line"> </tt>
<a name="L339"></a><tt class="py-lineno">339</tt>  <tt class="py-line">    <tt class="py-comment"># Print out.</tt> </tt>
<a name="L340"></a><tt class="py-lineno">340</tt>  <tt class="py-line">    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Adding the following spins to the relax data store.\n"</tt><tt class="py-op">)</tt> </tt>
<a name="L341"></a><tt class="py-lineno">341</tt>  <tt class="py-line"> </tt>
<a name="L342"></a><tt class="py-lineno">342</tt>  <tt class="py-line">    <tt class="py-comment"># Init the data for printing out.</tt> </tt>
<a name="L343"></a><tt class="py-lineno">343</tt>  <tt class="py-line">    <tt class="py-name">mol_names</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L344"></a><tt class="py-lineno">344</tt>  <tt class="py-line">    <tt class="py-name">res_nums</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L345"></a><tt class="py-lineno">345</tt>  <tt class="py-line">    <tt class="py-name">res_names</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L346"></a><tt class="py-lineno">346</tt>  <tt class="py-line">    <tt class="py-name">spin_nums</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L347"></a><tt class="py-lineno">347</tt>  <tt class="py-line">    <tt class="py-name">spin_names</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L348"></a><tt class="py-lineno">348</tt>  <tt class="py-line"> </tt>
<a name="L349"></a><tt class="py-lineno">349</tt>  <tt class="py-line">    <tt class="py-comment"># Initialise data for the atom loop.</tt> </tt>
<a name="L350"></a><tt class="py-lineno">350</tt>  <tt class="py-line">    <tt class="py-name">model_index</tt> <tt class="py-op">=</tt> <tt class="py-op">-</tt><tt class="py-number">1</tt> </tt>
<a name="L351"></a><tt class="py-lineno">351</tt>  <tt class="py-line">    <tt class="py-name">last_model</tt> <tt class="py-op">=</tt> <tt class="py-number">1000000</tt> </tt>
<a name="L352"></a><tt class="py-lineno">352</tt>  <tt class="py-line"> </tt>
<a name="L353"></a><tt class="py-lineno">353</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over all atoms of the spin_id selection.</tt> </tt>
<a name="L354"></a><tt class="py-lineno">354</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">model_num</tt><tt class="py-op">,</tt> <tt class="py-name">mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">,</tt> <tt id="link-164" class="py-name"><a title="gui.user_functions.spin.Spin.element
prompt.spin.Spin.element" class="py-name" href="#" onclick="return doclink('link-164', 'element', 'link-56');">element</a></tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-165" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-165', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-166" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.atom_loop
generic_fns.structure.internal.Internal.atom_loop
generic_fns.structure.scientific.Scientific_data.atom_loop" class="py-name" href="#" onclick="return doclink('link-166', 'atom_loop', 'link-86');">atom_loop</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">spin_id</tt><tt class="py-op">,</tt> <tt class="py-name">str_id</tt><tt class="py-op">=</tt><tt class="py-name">str_id</tt><tt class="py-op">,</tt> <tt class="py-name">model_num_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">mol_name_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">res_num_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">res_name_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">element_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">pos_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">ave</tt><tt class="py-op">=</tt><tt class="py-name">ave_pos</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L355"></a><tt class="py-lineno">355</tt>  <tt class="py-line">        <tt class="py-comment"># Update the model info.</tt> </tt>
<a name="L356"></a><tt class="py-lineno">356</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">last_model</tt> <tt class="py-op">!=</tt> <tt class="py-name">model_num</tt><tt class="py-op">:</tt> </tt>
<a name="L357"></a><tt class="py-lineno">357</tt>  <tt class="py-line">            <tt class="py-name">model_index</tt> <tt class="py-op">=</tt> <tt class="py-name">model_index</tt> <tt class="py-op">+</tt> <tt class="py-number">1</tt> </tt>
<a name="L358"></a><tt class="py-lineno">358</tt>  <tt class="py-line">            <tt class="py-name">last_model</tt> <tt class="py-op">=</tt> <tt class="py-name">model_num</tt> </tt>
<a name="L359"></a><tt class="py-lineno">359</tt>  <tt class="py-line"> </tt>
<a name="L360"></a><tt class="py-lineno">360</tt>  <tt class="py-line">        <tt class="py-comment"># Remove the '+' regular expression character from the mol, res, and spin names!</tt> </tt>
<a name="L361"></a><tt class="py-lineno">361</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">mol_name</tt> <tt class="py-keyword">and</tt> <tt id="link-167" class="py-name"><a title="generic_fns.relax_re.search" class="py-name" href="#" onclick="return doclink('link-167', 'search', 'link-3');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'\+'</tt><tt class="py-op">,</tt> <tt class="py-name">mol_name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L362"></a><tt class="py-lineno">362</tt>  <tt class="py-line">            <tt class="py-name">mol_name</tt> <tt class="py-op">=</tt> <tt class="py-name">replace</tt><tt class="py-op">(</tt><tt class="py-name">mol_name</tt><tt class="py-op">,</tt> <tt class="py-string">'+'</tt><tt class="py-op">,</tt> <tt class="py-string">''</tt><tt class="py-op">)</tt> </tt>
<a name="L363"></a><tt class="py-lineno">363</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">res_name</tt> <tt class="py-keyword">and</tt> <tt id="link-168" class="py-name"><a title="generic_fns.relax_re.search" class="py-name" href="#" onclick="return doclink('link-168', 'search', 'link-3');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'\+'</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L364"></a><tt class="py-lineno">364</tt>  <tt class="py-line">            <tt class="py-name">res_name</tt> <tt class="py-op">=</tt> <tt class="py-name">replace</tt><tt class="py-op">(</tt><tt class="py-name">res_name</tt><tt class="py-op">,</tt> <tt class="py-string">'+'</tt><tt class="py-op">,</tt> <tt class="py-string">''</tt><tt class="py-op">)</tt> </tt>
<a name="L365"></a><tt class="py-lineno">365</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">atom_name</tt> <tt class="py-keyword">and</tt> <tt id="link-169" class="py-name"><a title="generic_fns.relax_re.search" class="py-name" href="#" onclick="return doclink('link-169', 'search', 'link-3');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'\+'</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L366"></a><tt class="py-lineno">366</tt>  <tt class="py-line">            <tt class="py-name">atom_name</tt> <tt class="py-op">=</tt> <tt class="py-name">replace</tt><tt class="py-op">(</tt><tt class="py-name">atom_name</tt><tt class="py-op">,</tt> <tt class="py-string">'+'</tt><tt class="py-op">,</tt> <tt class="py-string">''</tt><tt class="py-op">)</tt> </tt>
<a name="L367"></a><tt class="py-lineno">367</tt>  <tt class="py-line"> </tt>
<a name="L368"></a><tt class="py-lineno">368</tt>  <tt class="py-line">        <tt class="py-comment"># Generate a spin ID for the current atom.</tt> </tt>
<a name="L369"></a><tt class="py-lineno">369</tt>  <tt class="py-line">        <tt id="link-170" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-170', 'id', 'link-132');">id</a></tt> <tt class="py-op">=</tt> <tt id="link-171" class="py-name"><a title="generic_fns.mol_res_spin.generate_spin_id" class="py-name" href="#" onclick="return doclink('link-171', 'generate_spin_id', 'link-11');">generate_spin_id</a></tt><tt class="py-op">(</tt><tt class="py-name">mol_name</tt><tt class="py-op">=</tt><tt class="py-name">mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">res_name</tt><tt class="py-op">,</tt> <tt class="py-name">spin_num</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">,</tt> <tt class="py-name">spin_name</tt><tt class="py-op">=</tt><tt class="py-name">atom_name</tt><tt class="py-op">)</tt> </tt>
<a name="L370"></a><tt class="py-lineno">370</tt>  <tt class="py-line"> </tt>
<a name="L371"></a><tt class="py-lineno">371</tt>  <tt class="py-line">        <tt class="py-comment"># Create the spin.</tt> </tt>
<a name="L372"></a><tt class="py-lineno">372</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L373"></a><tt class="py-lineno">373</tt>  <tt class="py-line">            <tt class="py-name">spin_cont</tt> <tt class="py-op">=</tt> <tt id="link-172" class="py-name"><a title="generic_fns.mol_res_spin.create_spin
gui.spin_viewer.tree.Mol_res_spin_tree.create_spin" class="py-name" href="#" onclick="return doclink('link-172', 'create_spin', 'link-9');">create_spin</a></tt><tt class="py-op">(</tt><tt class="py-name">mol_name</tt><tt class="py-op">=</tt><tt class="py-name">mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">res_name</tt><tt class="py-op">,</tt> <tt class="py-name">spin_num</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">,</tt> <tt class="py-name">spin_name</tt><tt class="py-op">=</tt><tt class="py-name">atom_name</tt><tt class="py-op">)</tt> </tt>
<a name="L374"></a><tt class="py-lineno">374</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt id="link-173" class="py-name"><a title="relax_errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-173', 'RelaxError', 'link-38');">RelaxError</a></tt><tt class="py-op">:</tt> </tt>
<a name="L375"></a><tt class="py-lineno">375</tt>  <tt class="py-line">            <tt class="py-comment"># Throw a warning if still on the first model.</tt> </tt>
<a name="L376"></a><tt class="py-lineno">376</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">model_index</tt><tt class="py-op">:</tt> </tt>
<a name="L377"></a><tt class="py-lineno">377</tt>  <tt class="py-line">                <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-174" class="py-name"><a title="relax_warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-174', 'RelaxWarning', 'link-47');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"The spin '%s' already exists."</tt> <tt class="py-op">%</tt> <tt id="link-175" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-175', 'id', 'link-132');">id</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L378"></a><tt class="py-lineno">378</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L379"></a><tt class="py-lineno">379</tt>  <tt class="py-line"> </tt>
<a name="L380"></a><tt class="py-lineno">380</tt>  <tt class="py-line">            <tt class="py-comment"># Otherwise, get the spin container.</tt> </tt>
<a name="L381"></a><tt class="py-lineno">381</tt>  <tt class="py-line">            <tt class="py-name">spin_cont</tt> <tt class="py-op">=</tt> <tt id="link-176" class="py-name"><a title="generic_fns.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-176', 'return_spin', 'link-15');">return_spin</a></tt><tt class="py-op">(</tt><tt id="link-177" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-177', 'id', 'link-132');">id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L382"></a><tt class="py-lineno">382</tt>  <tt class="py-line"> </tt>
<a name="L383"></a><tt class="py-lineno">383</tt>  <tt class="py-line">        <tt class="py-comment"># Append all the spin ID info for the first model for printing later.</tt> </tt>
<a name="L384"></a><tt class="py-lineno">384</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">model_index</tt> <tt class="py-op">==</tt> <tt class="py-number">0</tt><tt class="py-op">:</tt> </tt>
<a name="L385"></a><tt class="py-lineno">385</tt>  <tt class="py-line">            <tt class="py-name">mol_names</tt><tt class="py-op">.</tt><tt id="link-178" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-178', 'append', 'link-78');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">mol_name</tt><tt class="py-op">)</tt> </tt>
<a name="L386"></a><tt class="py-lineno">386</tt>  <tt class="py-line">            <tt class="py-name">res_nums</tt><tt class="py-op">.</tt><tt id="link-179" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-179', 'append', 'link-78');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">res_num</tt><tt class="py-op">)</tt> </tt>
<a name="L387"></a><tt class="py-lineno">387</tt>  <tt class="py-line">            <tt class="py-name">res_names</tt><tt class="py-op">.</tt><tt id="link-180" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-180', 'append', 'link-78');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">res_name</tt><tt class="py-op">)</tt> </tt>
<a name="L388"></a><tt class="py-lineno">388</tt>  <tt class="py-line">            <tt class="py-name">spin_nums</tt><tt class="py-op">.</tt><tt id="link-181" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-181', 'append', 'link-78');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_num</tt><tt class="py-op">)</tt> </tt>
<a name="L389"></a><tt class="py-lineno">389</tt>  <tt class="py-line">            <tt class="py-name">spin_names</tt><tt class="py-op">.</tt><tt id="link-182" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-182', 'append', 'link-78');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_name</tt><tt class="py-op">)</tt> </tt>
<a name="L390"></a><tt class="py-lineno">390</tt>  <tt class="py-line"> </tt>
<a name="L391"></a><tt class="py-lineno">391</tt>  <tt class="py-line">        <tt class="py-comment"># Convert the position vector to a numpy array.</tt> </tt>
<a name="L392"></a><tt class="py-lineno">392</tt>  <tt class="py-line">        <tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">pos</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L393"></a><tt class="py-lineno">393</tt>  <tt class="py-line"> </tt>
<a name="L394"></a><tt class="py-lineno">394</tt>  <tt class="py-line">        <tt class="py-comment"># Average position vector (already averaged across models in the atom_loop).</tt> </tt>
<a name="L395"></a><tt class="py-lineno">395</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">ave_pos</tt><tt class="py-op">:</tt> </tt>
<a name="L396"></a><tt class="py-lineno">396</tt>  <tt class="py-line">            <tt class="py-name">spin_cont</tt><tt class="py-op">.</tt><tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt class="py-name">pos</tt> </tt>
<a name="L397"></a><tt class="py-lineno">397</tt>  <tt class="py-line"> </tt>
<a name="L398"></a><tt class="py-lineno">398</tt>  <tt class="py-line">        <tt class="py-comment"># All positions.</tt> </tt>
<a name="L399"></a><tt class="py-lineno">399</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L400"></a><tt class="py-lineno">400</tt>  <tt class="py-line">            <tt class="py-comment"># Initialise.</tt> </tt>
<a name="L401"></a><tt class="py-lineno">401</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">spin_cont</tt><tt class="py-op">,</tt> <tt class="py-string">'pos'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L402"></a><tt class="py-lineno">402</tt>  <tt class="py-line">                <tt class="py-name">spin_cont</tt><tt class="py-op">.</tt><tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L403"></a><tt class="py-lineno">403</tt>  <tt class="py-line"> </tt>
<a name="L404"></a><tt class="py-lineno">404</tt>  <tt class="py-line">            <tt class="py-comment"># Add the current model's position.</tt> </tt>
<a name="L405"></a><tt class="py-lineno">405</tt>  <tt class="py-line">            <tt class="py-name">spin_cont</tt><tt class="py-op">.</tt><tt class="py-name">pos</tt><tt class="py-op">.</tt><tt id="link-183" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-183', 'append', 'link-78');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">pos</tt><tt class="py-op">)</tt> </tt>
<a name="L406"></a><tt class="py-lineno">406</tt>  <tt class="py-line"> </tt>
<a name="L407"></a><tt class="py-lineno">407</tt>  <tt class="py-line">        <tt class="py-comment"># Add the element.</tt> </tt>
<a name="L408"></a><tt class="py-lineno">408</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">model_index</tt><tt class="py-op">:</tt> </tt>
<a name="L409"></a><tt class="py-lineno">409</tt>  <tt class="py-line">            <tt class="py-name">spin_cont</tt><tt class="py-op">.</tt><tt id="link-184" class="py-name"><a title="gui.user_functions.spin.Spin.element
prompt.spin.Spin.element" class="py-name" href="#" onclick="return doclink('link-184', 'element', 'link-56');">element</a></tt> <tt class="py-op">=</tt> <tt id="link-185" class="py-name"><a title="gui.user_functions.spin.Spin.element
prompt.spin.Spin.element" class="py-name" href="#" onclick="return doclink('link-185', 'element', 'link-56');">element</a></tt> </tt>
<a name="L410"></a><tt class="py-lineno">410</tt>  <tt class="py-line"> </tt>
<a name="L411"></a><tt class="py-lineno">411</tt>  <tt class="py-line">    <tt class="py-comment"># Catch no data.</tt> </tt>
<a name="L412"></a><tt class="py-lineno">412</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">mol_names</tt><tt class="py-op">)</tt> <tt class="py-op">==</tt> <tt class="py-number">0</tt><tt class="py-op">:</tt> </tt>
<a name="L413"></a><tt class="py-lineno">413</tt>  <tt class="py-line">        <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-186" class="py-name"><a title="relax_warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-186', 'RelaxWarning', 'link-47');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"No spins matching the '%s' ID string could be found."</tt> <tt class="py-op">%</tt> <tt class="py-name">spin_id</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L414"></a><tt class="py-lineno">414</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> </tt>
<a name="L415"></a><tt class="py-lineno">415</tt>  <tt class="py-line"> </tt>
<a name="L416"></a><tt class="py-lineno">416</tt>  <tt class="py-line">    <tt class="py-comment"># Print out.</tt> </tt>
<a name="L417"></a><tt class="py-lineno">417</tt>  <tt class="py-line">    <tt id="link-187" class="py-name"><a title="relax_io.write_spin_data" class="py-name" href="#" onclick="return doclink('link-187', 'write_spin_data', 'link-45');">write_spin_data</a></tt><tt class="py-op">(</tt><tt id="link-188" class="py-name" targets="Variable dep_check.file=dep_check-module.html#file"><a title="dep_check.file" class="py-name" href="#" onclick="return doclink('link-188', 'file', 'link-188');">file</a></tt><tt class="py-op">=</tt><tt class="py-name">sys</tt><tt class="py-op">.</tt><tt class="py-name">stdout</tt><tt class="py-op">,</tt> <tt class="py-name">mol_names</tt><tt class="py-op">=</tt><tt class="py-name">mol_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_nums</tt><tt class="py-op">=</tt><tt class="py-name">res_nums</tt><tt class="py-op">,</tt> <tt class="py-name">res_names</tt><tt class="py-op">=</tt><tt class="py-name">res_names</tt><tt class="py-op">,</tt> <tt class="py-name">spin_nums</tt><tt class="py-op">=</tt><tt class="py-name">spin_nums</tt><tt class="py-op">,</tt> <tt class="py-name">spin_names</tt><tt class="py-op">=</tt><tt class="py-name">spin_names</tt><tt class="py-op">)</tt> </tt>
</div><a name="L418"></a><tt class="py-lineno">418</tt>  <tt class="py-line"> </tt>
<a name="L419"></a><tt class="py-lineno">419</tt>  <tt class="py-line"> </tt>
<a name="read_pdb"></a><div id="read_pdb-def"><a name="L420"></a><tt class="py-lineno">420</tt> <a class="py-toggle" href="#" id="read_pdb-toggle" onclick="return toggle('read_pdb');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.main-module.html#read_pdb">read_pdb</a><tt class="py-op">(</tt><tt class="py-param">file</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">dir</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">read_mol</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">set_mol_name</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">read_model</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">set_model_num</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">parser</tt><tt class="py-op">=</tt><tt class="py-string">'internal'</tt><tt class="py-op">,</tt> <tt class="py-param">verbosity</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-param">fail</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="read_pdb-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="read_pdb-expanded"><a name="L421"></a><tt class="py-lineno">421</tt>  <tt class="py-line">    <tt class="py-docstring">"""The PDB loading function.</tt> </tt>
<a name="L422"></a><tt class="py-lineno">422</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L423"></a><tt class="py-lineno">423</tt>  <tt class="py-line"><tt class="py-docstring">    Parsers</tt> </tt>
<a name="L424"></a><tt class="py-lineno">424</tt>  <tt class="py-line"><tt class="py-docstring">    =======</tt> </tt>
<a name="L425"></a><tt class="py-lineno">425</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L426"></a><tt class="py-lineno">426</tt>  <tt class="py-line"><tt class="py-docstring">    A number of parsers are available for reading PDB files.  These include:</tt> </tt>
<a name="L427"></a><tt class="py-lineno">427</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L428"></a><tt class="py-lineno">428</tt>  <tt class="py-line"><tt class="py-docstring">        - 'scientific', the Scientific Python PDB parser.</tt> </tt>
<a name="L429"></a><tt class="py-lineno">429</tt>  <tt class="py-line"><tt class="py-docstring">        - 'internal', a low quality yet fast PDB parser built into relax.</tt> </tt>
<a name="L430"></a><tt class="py-lineno">430</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L431"></a><tt class="py-lineno">431</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L432"></a><tt class="py-lineno">432</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword file:          The name of the PDB file to read.</tt> </tt>
<a name="L433"></a><tt class="py-lineno">433</tt>  <tt class="py-line"><tt class="py-docstring">    @type file:             str</tt> </tt>
<a name="L434"></a><tt class="py-lineno">434</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword dir:           The directory where the PDB file is located.  If set to None, then the file will be searched for in the current directory.</tt> </tt>
<a name="L435"></a><tt class="py-lineno">435</tt>  <tt class="py-line"><tt class="py-docstring">    @type dir:              str or None</tt> </tt>
<a name="L436"></a><tt class="py-lineno">436</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword read_mol:      The molecule(s) to read from the file, independent of model.  The molecules are determined differently by the different parsers, but are numbered consecutively from 1.  If set to None, then all molecules will be loaded.</tt> </tt>
<a name="L437"></a><tt class="py-lineno">437</tt>  <tt class="py-line"><tt class="py-docstring">    @type read_mol:         None, int, or list of int</tt> </tt>
<a name="L438"></a><tt class="py-lineno">438</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword set_mol_name:  Set the names of the molecules which are loaded.  If set to None, then the molecules will be automatically labelled based on the file name or other information.</tt> </tt>
<a name="L439"></a><tt class="py-lineno">439</tt>  <tt class="py-line"><tt class="py-docstring">    @type set_mol_name:     None, str, or list of str</tt> </tt>
<a name="L440"></a><tt class="py-lineno">440</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword read_model:    The PDB model to extract from the file.  If set to None, then all models will be loaded.</tt> </tt>
<a name="L441"></a><tt class="py-lineno">441</tt>  <tt class="py-line"><tt class="py-docstring">    @type read_model:       None, int, or list of int</tt> </tt>
<a name="L442"></a><tt class="py-lineno">442</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword set_model_num: Set the model number of the loaded molecule.  If set to None, then the PDB model numbers will be preserved, if they exist.</tt> </tt>
<a name="L443"></a><tt class="py-lineno">443</tt>  <tt class="py-line"><tt class="py-docstring">    @type set_model_num:    None, int, or list of int</tt> </tt>
<a name="L444"></a><tt class="py-lineno">444</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword parser:        The parser to be used to read the PDB file.</tt> </tt>
<a name="L445"></a><tt class="py-lineno">445</tt>  <tt class="py-line"><tt class="py-docstring">    @type parser:           str</tt> </tt>
<a name="L446"></a><tt class="py-lineno">446</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword fail:          A flag which, if True, will cause a RelaxError to be raised if the PDB file does not exist.  If False, then a RelaxWarning will be trown instead.</tt> </tt>
<a name="L447"></a><tt class="py-lineno">447</tt>  <tt class="py-line"><tt class="py-docstring">    @type fail:             bool</tt> </tt>
<a name="L448"></a><tt class="py-lineno">448</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword verbosity:     The amount of information to print to screen.  Zero corresponds to minimal output while higher values increase the amount of output.  The default value is 1.</tt> </tt>
<a name="L449"></a><tt class="py-lineno">449</tt>  <tt class="py-line"><tt class="py-docstring">    @type verbosity:        int</tt> </tt>
<a name="L450"></a><tt class="py-lineno">450</tt>  <tt class="py-line"><tt class="py-docstring">    @raise RelaxFileError:  If the fail flag is set, then a RelaxError is raised if the PDB file does not exist.</tt> </tt>
<a name="L451"></a><tt class="py-lineno">451</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L452"></a><tt class="py-lineno">452</tt>  <tt class="py-line"> </tt>
<a name="L453"></a><tt class="py-lineno">453</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L454"></a><tt class="py-lineno">454</tt>  <tt class="py-line">    <tt id="link-189" class="py-name"><a title="generic_fns.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-189', 'pipes', 'link-18');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-190" class="py-name"><a title="bmrblib.pystarlib.TextTest.AllChecks.test
bmrblib.pystarlib.UtilsTest.AllChecks.test
generic_fns.pipes.test" class="py-name" href="#" onclick="return doclink('link-190', 'test', 'link-51');">test</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L455"></a><tt class="py-lineno">455</tt>  <tt class="py-line"> </tt>
<a name="L456"></a><tt class="py-lineno">456</tt>  <tt class="py-line">    <tt class="py-comment"># The file path.</tt> </tt>
<a name="L457"></a><tt class="py-lineno">457</tt>  <tt class="py-line">    <tt class="py-name">file_path</tt> <tt class="py-op">=</tt> <tt id="link-191" class="py-name"><a title="relax_io.get_file_path" class="py-name" href="#" onclick="return doclink('link-191', 'get_file_path', 'link-43');">get_file_path</a></tt><tt class="py-op">(</tt><tt id="link-192" class="py-name"><a title="dep_check.file" class="py-name" href="#" onclick="return doclink('link-192', 'file', 'link-188');">file</a></tt><tt class="py-op">,</tt> <tt class="py-name">dir</tt><tt class="py-op">)</tt> </tt>
<a name="L458"></a><tt class="py-lineno">458</tt>  <tt class="py-line"> </tt>
<a name="L459"></a><tt class="py-lineno">459</tt>  <tt class="py-line">    <tt class="py-comment"># Try adding file extensions to the end of the file path, if the file can't be found.</tt> </tt>
<a name="L460"></a><tt class="py-lineno">460</tt>  <tt class="py-line">    <tt class="py-name">file_path_orig</tt> <tt class="py-op">=</tt> <tt class="py-name">file_path</tt> </tt>
<a name="L461"></a><tt class="py-lineno">461</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">access</tt><tt class="py-op">(</tt><tt class="py-name">file_path</tt><tt class="py-op">,</tt> <tt class="py-name">F_OK</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L462"></a><tt class="py-lineno">462</tt>  <tt class="py-line">        <tt class="py-comment"># List of possible extensions.</tt> </tt>
<a name="L463"></a><tt class="py-lineno">463</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-193" class="py-name" targets="Variable bmrblib.nmr_star_dict.NMR_STAR.ext=bmrblib.nmr_star_dict.NMR_STAR-class.html#ext"><a title="bmrblib.nmr_star_dict.NMR_STAR.ext" class="py-name" href="#" onclick="return doclink('link-193', 'ext', 'link-193');">ext</a></tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt class="py-string">'.pdb'</tt><tt class="py-op">,</tt> <tt class="py-string">'.gz'</tt><tt class="py-op">,</tt> <tt class="py-string">'.pdb.gz'</tt><tt class="py-op">,</tt> <tt class="py-string">'.bz2'</tt><tt class="py-op">,</tt> <tt class="py-string">'.pdb.bz2'</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L464"></a><tt class="py-lineno">464</tt>  <tt class="py-line">            <tt class="py-comment"># Add the extension if the file can be found.</tt> </tt>
<a name="L465"></a><tt class="py-lineno">465</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">access</tt><tt class="py-op">(</tt><tt class="py-name">file_path</tt><tt class="py-op">+</tt><tt id="link-194" class="py-name"><a title="bmrblib.nmr_star_dict.NMR_STAR.ext" class="py-name" href="#" onclick="return doclink('link-194', 'ext', 'link-193');">ext</a></tt><tt class="py-op">,</tt> <tt class="py-name">F_OK</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L466"></a><tt class="py-lineno">466</tt>  <tt class="py-line">                <tt class="py-name">file_path</tt> <tt class="py-op">=</tt> <tt class="py-name">file_path</tt> <tt class="py-op">+</tt> <tt id="link-195" class="py-name"><a title="bmrblib.nmr_star_dict.NMR_STAR.ext" class="py-name" href="#" onclick="return doclink('link-195', 'ext', 'link-193');">ext</a></tt> </tt>
<a name="L467"></a><tt class="py-lineno">467</tt>  <tt class="py-line"> </tt>
<a name="L468"></a><tt class="py-lineno">468</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the file exists.</tt> </tt>
<a name="L469"></a><tt class="py-lineno">469</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">access</tt><tt class="py-op">(</tt><tt class="py-name">file_path</tt><tt class="py-op">,</tt> <tt class="py-name">F_OK</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L470"></a><tt class="py-lineno">470</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">fail</tt><tt class="py-op">:</tt> </tt>
<a name="L471"></a><tt class="py-lineno">471</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-196" class="py-name"><a title="relax_errors.RelaxFileError" class="py-name" href="#" onclick="return doclink('link-196', 'RelaxFileError', 'link-39');">RelaxFileError</a></tt><tt class="py-op">(</tt><tt class="py-string">'PDB'</tt><tt class="py-op">,</tt> <tt class="py-name">file_path_orig</tt><tt class="py-op">)</tt> </tt>
<a name="L472"></a><tt class="py-lineno">472</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L473"></a><tt class="py-lineno">473</tt>  <tt class="py-line">            <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-197" class="py-name"><a title="relax_warnings.RelaxNoPDBFileWarning" class="py-name" href="#" onclick="return doclink('link-197', 'RelaxNoPDBFileWarning', 'link-48');">RelaxNoPDBFileWarning</a></tt><tt class="py-op">(</tt><tt class="py-name">file_path</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L474"></a><tt class="py-lineno">474</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
<a name="L475"></a><tt class="py-lineno">475</tt>  <tt class="py-line"> </tt>
<a name="L476"></a><tt class="py-lineno">476</tt>  <tt class="py-line">    <tt class="py-comment"># Check that the parser is the same as the currently loaded PDB files.</tt> </tt>
<a name="L477"></a><tt class="py-lineno">477</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-198" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-198', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-199" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-199', 'id', 'link-132');">id</a></tt> <tt class="py-op">!=</tt> <tt class="py-name">parser</tt><tt class="py-op">:</tt> </tt>
<a name="L478"></a><tt class="py-lineno">478</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-200" class="py-name"><a title="relax_errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-200', 'RelaxError', 'link-38');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The "</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">parser</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">" parser does not match the "</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-201" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-201', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-202" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-202', 'id', 'link-132');">id</a></tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">" parser of the PDB loaded into the current pipe."</tt><tt class="py-op">)</tt> </tt>
<a name="L479"></a><tt class="py-lineno">479</tt>  <tt class="py-line"> </tt>
<a name="L480"></a><tt class="py-lineno">480</tt>  <tt class="py-line">    <tt class="py-comment"># Place the parser specific structural object into the relax data store.</tt> </tt>
<a name="L481"></a><tt class="py-lineno">481</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L482"></a><tt class="py-lineno">482</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">parser</tt> <tt class="py-op">==</tt> <tt class="py-string">'scientific'</tt><tt class="py-op">:</tt> </tt>
<a name="L483"></a><tt class="py-lineno">483</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-203" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-203', 'structure', 'link-20');">structure</a></tt> <tt class="py-op">=</tt> <tt id="link-204" class="py-name"><a title="generic_fns.structure.scientific.Scientific_data" class="py-name" href="#" onclick="return doclink('link-204', 'Scientific_data', 'link-30');">Scientific_data</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L484"></a><tt class="py-lineno">484</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">parser</tt> <tt class="py-op">==</tt> <tt class="py-string">'internal'</tt><tt class="py-op">:</tt> </tt>
<a name="L485"></a><tt class="py-lineno">485</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-205" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-205', 'structure', 'link-20');">structure</a></tt> <tt class="py-op">=</tt> <tt id="link-206" class="py-name"><a title="generic_fns.structure.internal.Internal" class="py-name" href="#" onclick="return doclink('link-206', 'Internal', 'link-26');">Internal</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L486"></a><tt class="py-lineno">486</tt>  <tt class="py-line"> </tt>
<a name="L487"></a><tt class="py-lineno">487</tt>  <tt class="py-line">    <tt class="py-comment"># Load the structures.</tt> </tt>
<a name="L488"></a><tt class="py-lineno">488</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-207" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-207', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-208" class="py-name" targets="Method generic_fns.structure.api_base.Base_struct_API.load_pdb()=generic_fns.structure.api_base.Base_struct_API-class.html#load_pdb,Method generic_fns.structure.internal.Internal.load_pdb()=generic_fns.structure.internal.Internal-class.html#load_pdb,Method generic_fns.structure.scientific.Scientific_data.load_pdb()=generic_fns.structure.scientific.Scientific_data-class.html#load_pdb"><a title="generic_fns.structure.api_base.Base_struct_API.load_pdb
generic_fns.structure.internal.Internal.load_pdb
generic_fns.structure.scientific.Scientific_data.load_pdb" class="py-name" href="#" onclick="return doclink('link-208', 'load_pdb', 'link-208');">load_pdb</a></tt><tt class="py-op">(</tt><tt class="py-name">file_path</tt><tt class="py-op">,</tt> <tt class="py-name">read_mol</tt><tt class="py-op">=</tt><tt class="py-name">read_mol</tt><tt class="py-op">,</tt> <tt class="py-name">set_mol_name</tt><tt class="py-op">=</tt><tt class="py-name">set_mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">read_model</tt><tt class="py-op">=</tt><tt class="py-name">read_model</tt><tt class="py-op">,</tt> <tt class="py-name">set_model_num</tt><tt class="py-op">=</tt><tt class="py-name">set_model_num</tt><tt class="py-op">,</tt> <tt id="link-209" class="py-name" targets="Variable bmrblib.pystarlib.Text.verbosity=bmrblib.pystarlib.Text-module.html#verbosity,Variable bmrblib.pystarlib.verbosity=bmrblib.pystarlib-module.html#verbosity,Variable multi.multi_processor_base.verbosity=multi.multi_processor_base-module.html#verbosity,Variable multi.processor.verbosity=multi.processor-module.html#verbosity"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-209', 'verbosity', 'link-209');">verbosity</a></tt><tt class="py-op">=</tt><tt id="link-210" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-210', 'verbosity', 'link-209');">verbosity</a></tt><tt class="py-op">)</tt> </tt>
<a name="L489"></a><tt class="py-lineno">489</tt>  <tt class="py-line"> </tt>
<a name="L490"></a><tt class="py-lineno">490</tt>  <tt class="py-line">    <tt class="py-comment"># Load into Molmol (if running).</tt> </tt>
<a name="L491"></a><tt class="py-lineno">491</tt>  <tt class="py-line">    <tt id="link-211" class="py-name"><a title="generic_fns.molmol
gui.user_functions.molmol
prompt.molmol
specific_fns.model_free.molmol" class="py-name" href="#" onclick="return doclink('link-211', 'molmol', 'link-5');">molmol</a></tt><tt class="py-op">.</tt><tt id="link-212" class="py-name" targets="Variable generic_fns.molmol.molmol_obj=generic_fns.molmol-module.html#molmol_obj"><a title="generic_fns.molmol.molmol_obj" class="py-name" href="#" onclick="return doclink('link-212', 'molmol_obj', 'link-212');">molmol_obj</a></tt><tt class="py-op">.</tt><tt id="link-213" class="py-name" targets="Method generic_fns.molmol.Molmol.open_pdb()=generic_fns.molmol.Molmol-class.html#open_pdb,Method generic_fns.pymol_control.Pymol.open_pdb()=generic_fns.pymol_control.Pymol-class.html#open_pdb"><a title="generic_fns.molmol.Molmol.open_pdb
generic_fns.pymol_control.Pymol.open_pdb" class="py-name" href="#" onclick="return doclink('link-213', 'open_pdb', 'link-213');">open_pdb</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
</div><a name="L492"></a><tt class="py-lineno">492</tt>  <tt class="py-line"> </tt>
<a name="L493"></a><tt class="py-lineno">493</tt>  <tt class="py-line"> </tt>
<a name="read_xyz"></a><div id="read_xyz-def"><a name="L494"></a><tt class="py-lineno">494</tt> <a class="py-toggle" href="#" id="read_xyz-toggle" onclick="return toggle('read_xyz');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.main-module.html#read_xyz">read_xyz</a><tt class="py-op">(</tt><tt class="py-param">file</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">dir</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">read_mol</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">set_mol_name</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">read_model</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">set_model_num</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">verbosity</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-param">fail</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="read_xyz-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="read_xyz-expanded"><a name="L495"></a><tt class="py-lineno">495</tt>  <tt class="py-line">    <tt class="py-docstring">"""The XYZ loading function.</tt> </tt>
<a name="L496"></a><tt class="py-lineno">496</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L497"></a><tt class="py-lineno">497</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L498"></a><tt class="py-lineno">498</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword file:          The name of the XYZ file to read.</tt> </tt>
<a name="L499"></a><tt class="py-lineno">499</tt>  <tt class="py-line"><tt class="py-docstring">    @type file:             str</tt> </tt>
<a name="L500"></a><tt class="py-lineno">500</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword dir:           The directory where the XYZ file is located.  If set to None, then the</tt> </tt>
<a name="L501"></a><tt class="py-lineno">501</tt>  <tt class="py-line"><tt class="py-docstring">                            file will be searched for in the current directory.</tt> </tt>
<a name="L502"></a><tt class="py-lineno">502</tt>  <tt class="py-line"><tt class="py-docstring">    @type dir:              str or None</tt> </tt>
<a name="L503"></a><tt class="py-lineno">503</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword read_mol:      The molecule(s) to read from the file, independent of model.</tt> </tt>
<a name="L504"></a><tt class="py-lineno">504</tt>  <tt class="py-line"><tt class="py-docstring">                            If set to None, then all molecules will be loaded.</tt> </tt>
<a name="L505"></a><tt class="py-lineno">505</tt>  <tt class="py-line"><tt class="py-docstring">    @type read_mol:         None, int, or list of int</tt> </tt>
<a name="L506"></a><tt class="py-lineno">506</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword set_mol_name:  Set the names of the molecules which are loaded.  If set to None, then</tt> </tt>
<a name="L507"></a><tt class="py-lineno">507</tt>  <tt class="py-line"><tt class="py-docstring">                            the molecules will be automatically labelled based on the file name or</tt> </tt>
<a name="L508"></a><tt class="py-lineno">508</tt>  <tt class="py-line"><tt class="py-docstring">                            other information.</tt> </tt>
<a name="L509"></a><tt class="py-lineno">509</tt>  <tt class="py-line"><tt class="py-docstring">    @type set_mol_name:     None, str, or list of str</tt> </tt>
<a name="L510"></a><tt class="py-lineno">510</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword read_model:    The XYZ model to extract from the file.  If set to None, then all models</tt> </tt>
<a name="L511"></a><tt class="py-lineno">511</tt>  <tt class="py-line"><tt class="py-docstring">                            will be loaded.</tt> </tt>
<a name="L512"></a><tt class="py-lineno">512</tt>  <tt class="py-line"><tt class="py-docstring">    @type read_model:       None, int, or list of int</tt> </tt>
<a name="L513"></a><tt class="py-lineno">513</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword set_model_num: Set the model number of the loaded molecule.  If set to None, then the</tt> </tt>
<a name="L514"></a><tt class="py-lineno">514</tt>  <tt class="py-line"><tt class="py-docstring">                            XYZ model numbers will be preserved, if they exist.</tt> </tt>
<a name="L515"></a><tt class="py-lineno">515</tt>  <tt class="py-line"><tt class="py-docstring">    @type set_model_num:    None, int, or list of int</tt> </tt>
<a name="L516"></a><tt class="py-lineno">516</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword fail:          A flag which, if True, will cause a RelaxError to be raised if the XYZ </tt> </tt>
<a name="L517"></a><tt class="py-lineno">517</tt>  <tt class="py-line"><tt class="py-docstring">                            file does not exist.  If False, then a RelaxWarning will be trown</tt> </tt>
<a name="L518"></a><tt class="py-lineno">518</tt>  <tt class="py-line"><tt class="py-docstring">                            instead.</tt> </tt>
<a name="L519"></a><tt class="py-lineno">519</tt>  <tt class="py-line"><tt class="py-docstring">    @type fail:             bool</tt> </tt>
<a name="L520"></a><tt class="py-lineno">520</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword verbosity:     The amount of information to print to screen.  Zero corresponds to</tt> </tt>
<a name="L521"></a><tt class="py-lineno">521</tt>  <tt class="py-line"><tt class="py-docstring">                            minimal output while higher values increase the amount of output.  The</tt> </tt>
<a name="L522"></a><tt class="py-lineno">522</tt>  <tt class="py-line"><tt class="py-docstring">                            default value is 1.</tt> </tt>
<a name="L523"></a><tt class="py-lineno">523</tt>  <tt class="py-line"><tt class="py-docstring">    @type verbosity:        int</tt> </tt>
<a name="L524"></a><tt class="py-lineno">524</tt>  <tt class="py-line"><tt class="py-docstring">    @raise RelaxFileError:  If the fail flag is set, then a RelaxError is raised if the XYZ file</tt> </tt>
<a name="L525"></a><tt class="py-lineno">525</tt>  <tt class="py-line"><tt class="py-docstring">                            does not exist.</tt> </tt>
<a name="L526"></a><tt class="py-lineno">526</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L527"></a><tt class="py-lineno">527</tt>  <tt class="py-line"> </tt>
<a name="L528"></a><tt class="py-lineno">528</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L529"></a><tt class="py-lineno">529</tt>  <tt class="py-line">    <tt id="link-214" class="py-name"><a title="generic_fns.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-214', 'pipes', 'link-18');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-215" class="py-name"><a title="bmrblib.pystarlib.TextTest.AllChecks.test
bmrblib.pystarlib.UtilsTest.AllChecks.test
generic_fns.pipes.test" class="py-name" href="#" onclick="return doclink('link-215', 'test', 'link-51');">test</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L530"></a><tt class="py-lineno">530</tt>  <tt class="py-line"> </tt>
<a name="L531"></a><tt class="py-lineno">531</tt>  <tt class="py-line">    <tt class="py-comment"># The file path.</tt> </tt>
<a name="L532"></a><tt class="py-lineno">532</tt>  <tt class="py-line">    <tt class="py-name">file_path</tt> <tt class="py-op">=</tt> <tt id="link-216" class="py-name"><a title="relax_io.get_file_path" class="py-name" href="#" onclick="return doclink('link-216', 'get_file_path', 'link-43');">get_file_path</a></tt><tt class="py-op">(</tt><tt id="link-217" class="py-name"><a title="dep_check.file" class="py-name" href="#" onclick="return doclink('link-217', 'file', 'link-188');">file</a></tt><tt class="py-op">,</tt> <tt class="py-name">dir</tt><tt class="py-op">)</tt> </tt>
<a name="L533"></a><tt class="py-lineno">533</tt>  <tt class="py-line"> </tt>
<a name="L534"></a><tt class="py-lineno">534</tt>  <tt class="py-line">    <tt class="py-comment"># Try adding '.xyz' to the end of the file path, if the file can't be found.</tt> </tt>
<a name="L535"></a><tt class="py-lineno">535</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">access</tt><tt class="py-op">(</tt><tt class="py-name">file_path</tt><tt class="py-op">,</tt> <tt class="py-name">F_OK</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L536"></a><tt class="py-lineno">536</tt>  <tt class="py-line">        <tt class="py-name">file_path_orig</tt> <tt class="py-op">=</tt> <tt class="py-name">file_path</tt> </tt>
<a name="L537"></a><tt class="py-lineno">537</tt>  <tt class="py-line">        <tt class="py-name">file_path</tt> <tt class="py-op">=</tt> <tt class="py-name">file_path</tt> <tt class="py-op">+</tt> <tt class="py-string">'.xyz'</tt> </tt>
<a name="L538"></a><tt class="py-lineno">538</tt>  <tt class="py-line"> </tt>
<a name="L539"></a><tt class="py-lineno">539</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the file exists.</tt> </tt>
<a name="L540"></a><tt class="py-lineno">540</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">access</tt><tt class="py-op">(</tt><tt class="py-name">file_path</tt><tt class="py-op">,</tt> <tt class="py-name">F_OK</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L541"></a><tt class="py-lineno">541</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">fail</tt><tt class="py-op">:</tt> </tt>
<a name="L542"></a><tt class="py-lineno">542</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-218" class="py-name"><a title="relax_errors.RelaxFileError" class="py-name" href="#" onclick="return doclink('link-218', 'RelaxFileError', 'link-39');">RelaxFileError</a></tt><tt class="py-op">(</tt><tt class="py-string">'XYZ'</tt><tt class="py-op">,</tt> <tt class="py-name">file_path_orig</tt><tt class="py-op">)</tt> </tt>
<a name="L543"></a><tt class="py-lineno">543</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L544"></a><tt class="py-lineno">544</tt>  <tt class="py-line">            <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-219" class="py-name"><a title="relax_warnings.RelaxNoPDBFileWarning" class="py-name" href="#" onclick="return doclink('link-219', 'RelaxNoPDBFileWarning', 'link-48');">RelaxNoPDBFileWarning</a></tt><tt class="py-op">(</tt><tt class="py-name">file_path</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L545"></a><tt class="py-lineno">545</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
<a name="L546"></a><tt class="py-lineno">546</tt>  <tt class="py-line"> </tt>
<a name="L547"></a><tt class="py-lineno">547</tt>  <tt class="py-line">    <tt class="py-comment"># Place the  structural object into the relax data store.</tt> </tt>
<a name="L548"></a><tt class="py-lineno">548</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L549"></a><tt class="py-lineno">549</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-220" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-220', 'structure', 'link-20');">structure</a></tt> <tt class="py-op">=</tt> <tt id="link-221" class="py-name"><a title="generic_fns.structure.internal.Internal" class="py-name" href="#" onclick="return doclink('link-221', 'Internal', 'link-26');">Internal</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L550"></a><tt class="py-lineno">550</tt>  <tt class="py-line"> </tt>
<a name="L551"></a><tt class="py-lineno">551</tt>  <tt class="py-line">    <tt class="py-comment"># Load the structures.</tt> </tt>
<a name="L552"></a><tt class="py-lineno">552</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-222" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-222', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-223" class="py-name" targets="Method generic_fns.structure.api_base.Base_struct_API.load_xyz()=generic_fns.structure.api_base.Base_struct_API-class.html#load_xyz,Method generic_fns.structure.internal.Internal.load_xyz()=generic_fns.structure.internal.Internal-class.html#load_xyz"><a title="generic_fns.structure.api_base.Base_struct_API.load_xyz
generic_fns.structure.internal.Internal.load_xyz" class="py-name" href="#" onclick="return doclink('link-223', 'load_xyz', 'link-223');">load_xyz</a></tt><tt class="py-op">(</tt><tt class="py-name">file_path</tt><tt class="py-op">,</tt> <tt class="py-name">read_mol</tt><tt class="py-op">=</tt><tt class="py-name">read_mol</tt><tt class="py-op">,</tt> <tt class="py-name">set_mol_name</tt><tt class="py-op">=</tt><tt class="py-name">set_mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">read_model</tt><tt class="py-op">=</tt><tt class="py-name">read_model</tt><tt class="py-op">,</tt> <tt class="py-name">set_model_num</tt><tt class="py-op">=</tt><tt class="py-name">set_model_num</tt><tt class="py-op">,</tt> <tt id="link-224" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-224', 'verbosity', 'link-209');">verbosity</a></tt><tt class="py-op">=</tt><tt id="link-225" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-225', 'verbosity', 'link-209');">verbosity</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L553"></a><tt class="py-lineno">553</tt>  <tt class="py-line"> </tt>
<a name="L554"></a><tt class="py-lineno">554</tt>  <tt class="py-line"> </tt>
<a name="rotate"></a><div id="rotate-def"><a name="L555"></a><tt class="py-lineno">555</tt> <a class="py-toggle" href="#" id="rotate-toggle" onclick="return toggle('rotate');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.main-module.html#rotate">rotate</a><tt class="py-op">(</tt><tt class="py-param">R</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">origin</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">model</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="rotate-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="rotate-expanded"><a name="L556"></a><tt class="py-lineno">556</tt>  <tt class="py-line">    <tt class="py-docstring">"""Rotate the structural data about the origin by the specified forwards rotation.</tt> </tt>
<a name="L557"></a><tt class="py-lineno">557</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L558"></a><tt class="py-lineno">558</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword R:         The forwards rotation matrix.</tt> </tt>
<a name="L559"></a><tt class="py-lineno">559</tt>  <tt class="py-line"><tt class="py-docstring">    @type R:            numpy 3D, rank-2 array or a 3x3 list of floats</tt> </tt>
<a name="L560"></a><tt class="py-lineno">560</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword origin:    The origin of the rotation.  If not supplied, the origin will be set to [0, 0, 0].</tt> </tt>
<a name="L561"></a><tt class="py-lineno">561</tt>  <tt class="py-line"><tt class="py-docstring">    @type origin:       numpy 3D, rank-1 array or list of len 3 or None</tt> </tt>
<a name="L562"></a><tt class="py-lineno">562</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword model:     The model to rotate.  If None, all models will be rotated.</tt> </tt>
<a name="L563"></a><tt class="py-lineno">563</tt>  <tt class="py-line"><tt class="py-docstring">    @type model:        int</tt> </tt>
<a name="L564"></a><tt class="py-lineno">564</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_id:   The molecule, residue, and atom identifier string.  Only atoms matching this selection will be used.</tt> </tt>
<a name="L565"></a><tt class="py-lineno">565</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_id:      str or None</tt> </tt>
<a name="L566"></a><tt class="py-lineno">566</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L567"></a><tt class="py-lineno">567</tt>  <tt class="py-line"> </tt>
<a name="L568"></a><tt class="py-lineno">568</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L569"></a><tt class="py-lineno">569</tt>  <tt class="py-line">    <tt id="link-226" class="py-name"><a title="generic_fns.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-226', 'pipes', 'link-18');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-227" class="py-name"><a title="bmrblib.pystarlib.TextTest.AllChecks.test
bmrblib.pystarlib.UtilsTest.AllChecks.test
generic_fns.pipes.test" class="py-name" href="#" onclick="return doclink('link-227', 'test', 'link-51');">test</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L570"></a><tt class="py-lineno">570</tt>  <tt class="py-line"> </tt>
<a name="L571"></a><tt class="py-lineno">571</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the structure exists.</tt> </tt>
<a name="L572"></a><tt class="py-lineno">572</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-228" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-228', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-229" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.num_models" class="py-name" href="#" onclick="return doclink('link-229', 'num_models', 'link-122');">num_models</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-230" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-230', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-231" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.num_molecules" class="py-name" href="#" onclick="return doclink('link-231', 'num_molecules', 'link-124');">num_molecules</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L573"></a><tt class="py-lineno">573</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-232" class="py-name"><a title="relax_errors.RelaxNoPdbError" class="py-name" href="#" onclick="return doclink('link-232', 'RelaxNoPdbError', 'link-40');">RelaxNoPdbError</a></tt> </tt>
<a name="L574"></a><tt class="py-lineno">574</tt>  <tt class="py-line"> </tt>
<a name="L575"></a><tt class="py-lineno">575</tt>  <tt class="py-line">    <tt class="py-comment"># Set the origin if not supplied.</tt> </tt>
<a name="L576"></a><tt class="py-lineno">576</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">origin</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L577"></a><tt class="py-lineno">577</tt>  <tt class="py-line">        <tt class="py-name">origin</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L578"></a><tt class="py-lineno">578</tt>  <tt class="py-line"> </tt>
<a name="L579"></a><tt class="py-lineno">579</tt>  <tt class="py-line">    <tt class="py-comment"># Convert the args to numpy float data structures.</tt> </tt>
<a name="L580"></a><tt class="py-lineno">580</tt>  <tt class="py-line">    <tt id="link-233" class="py-name" targets="Variable test_suite.unit_tests._maths_fns.test_rotation_matrix.R=test_suite.unit_tests._maths_fns.test_rotation_matrix-module.html#R"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-233', 'R', 'link-233');">R</a></tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt id="link-234" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-234', 'R', 'link-233');">R</a></tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L581"></a><tt class="py-lineno">581</tt>  <tt class="py-line">    <tt class="py-name">origin</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">origin</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L582"></a><tt class="py-lineno">582</tt>  <tt class="py-line"> </tt>
<a name="L583"></a><tt class="py-lineno">583</tt>  <tt class="py-line">    <tt class="py-comment"># Call the specific code.</tt> </tt>
<a name="L584"></a><tt class="py-lineno">584</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-235" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-235', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-236" class="py-name" targets="Method generic_fns.structure.api_base.Base_struct_API.rotate()=generic_fns.structure.api_base.Base_struct_API-class.html#rotate,Method generic_fns.structure.internal.Internal.rotate()=generic_fns.structure.internal.Internal-class.html#rotate,Function generic_fns.structure.main.rotate()=generic_fns.structure.main-module.html#rotate,Method prompt.structure.Structure.rotate()=prompt.structure.Structure-class.html#rotate"><a title="generic_fns.structure.api_base.Base_struct_API.rotate
generic_fns.structure.internal.Internal.rotate
generic_fns.structure.main.rotate
prompt.structure.Structure.rotate" class="py-name" href="#" onclick="return doclink('link-236', 'rotate', 'link-236');">rotate</a></tt><tt class="py-op">(</tt><tt id="link-237" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-237', 'R', 'link-233');">R</a></tt><tt class="py-op">=</tt><tt id="link-238" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-238', 'R', 'link-233');">R</a></tt><tt class="py-op">,</tt> <tt class="py-name">origin</tt><tt class="py-op">=</tt><tt class="py-name">origin</tt><tt class="py-op">,</tt> <tt class="py-name">model</tt><tt class="py-op">=</tt><tt class="py-name">model</tt><tt class="py-op">,</tt> <tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">atom_id</tt><tt class="py-op">)</tt> </tt>
</div><a name="L585"></a><tt class="py-lineno">585</tt>  <tt class="py-line"> </tt>
<a name="L586"></a><tt class="py-lineno">586</tt>  <tt class="py-line"> </tt>
<a name="set_vector"></a><div id="set_vector-def"><a name="L587"></a><tt class="py-lineno">587</tt> <a class="py-toggle" href="#" id="set_vector-toggle" onclick="return toggle('set_vector');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.main-module.html#set_vector">set_vector</a><tt class="py-op">(</tt><tt class="py-param">spin</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">xh_vect</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="set_vector-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="set_vector-expanded"><a name="L588"></a><tt class="py-lineno">588</tt>  <tt class="py-line">    <tt class="py-docstring">"""Place the XH unit vector into the spin container object.</tt> </tt>
<a name="L589"></a><tt class="py-lineno">589</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L590"></a><tt class="py-lineno">590</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword spin:      The spin container object.</tt> </tt>
<a name="L591"></a><tt class="py-lineno">591</tt>  <tt class="py-line"><tt class="py-docstring">    @type spin:         SpinContainer instance</tt> </tt>
<a name="L592"></a><tt class="py-lineno">592</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword xh_vect:   The unit vector parallel to the XH bond.</tt> </tt>
<a name="L593"></a><tt class="py-lineno">593</tt>  <tt class="py-line"><tt class="py-docstring">    @type xh_vect:      array of len 3</tt> </tt>
<a name="L594"></a><tt class="py-lineno">594</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L595"></a><tt class="py-lineno">595</tt>  <tt class="py-line"> </tt>
<a name="L596"></a><tt class="py-lineno">596</tt>  <tt class="py-line">    <tt class="py-comment"># Place the XH unit vector into the container.</tt> </tt>
<a name="L597"></a><tt class="py-lineno">597</tt>  <tt class="py-line">    <tt id="link-239" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-239', 'spin', 'link-66');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">xh_vect</tt> <tt class="py-op">=</tt> <tt class="py-name">xh_vect</tt> </tt>
</div><a name="L598"></a><tt class="py-lineno">598</tt>  <tt class="py-line"> </tt>
<a name="L599"></a><tt class="py-lineno">599</tt>  <tt class="py-line"> </tt>
<a name="superimpose"></a><div id="superimpose-def"><a name="L600"></a><tt class="py-lineno">600</tt> <a class="py-toggle" href="#" id="superimpose-toggle" onclick="return toggle('superimpose');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.main-module.html#superimpose">superimpose</a><tt class="py-op">(</tt><tt class="py-param">models</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">method</tt><tt class="py-op">=</tt><tt class="py-string">'fit to mean'</tt><tt class="py-op">,</tt> <tt class="py-param">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">centroid</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="superimpose-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="superimpose-expanded"><a name="L601"></a><tt class="py-lineno">601</tt>  <tt class="py-line">    <tt class="py-docstring">"""Superimpose a set of structural models.</tt> </tt>
<a name="L602"></a><tt class="py-lineno">602</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L603"></a><tt class="py-lineno">603</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword models:    The list of models to superimpose.  If set to None, then all models will be used.</tt> </tt>
<a name="L604"></a><tt class="py-lineno">604</tt>  <tt class="py-line"><tt class="py-docstring">    @type models:       list of int or None</tt> </tt>
<a name="L605"></a><tt class="py-lineno">605</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword method:    The superimposition method.  It must be one of 'fit to mean' or 'fit to first'.</tt> </tt>
<a name="L606"></a><tt class="py-lineno">606</tt>  <tt class="py-line"><tt class="py-docstring">    @type method:       str</tt> </tt>
<a name="L607"></a><tt class="py-lineno">607</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_id:   The molecule, residue, and atom identifier string.  This matches the spin ID string format.</tt> </tt>
<a name="L608"></a><tt class="py-lineno">608</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_id:      str or None</tt> </tt>
<a name="L609"></a><tt class="py-lineno">609</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword centroid:  An alternative position of the centroid to allow for different superpositions, for example of pivot point motions.</tt> </tt>
<a name="L610"></a><tt class="py-lineno">610</tt>  <tt class="py-line"><tt class="py-docstring">    @type centroid:     list of float or numpy rank-1, 3D array</tt> </tt>
<a name="L611"></a><tt class="py-lineno">611</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L612"></a><tt class="py-lineno">612</tt>  <tt class="py-line"> </tt>
<a name="L613"></a><tt class="py-lineno">613</tt>  <tt class="py-line">    <tt class="py-comment"># Check the method.</tt> </tt>
<a name="L614"></a><tt class="py-lineno">614</tt>  <tt class="py-line">    <tt class="py-name">allowed</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-string">'fit to mean'</tt><tt class="py-op">,</tt> <tt class="py-string">'fit to first'</tt><tt class="py-op">]</tt> </tt>
<a name="L615"></a><tt class="py-lineno">615</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-240" class="py-name" targets="Module bmrblib.experimental_details.method=bmrblib.experimental_details.method-module.html"><a title="bmrblib.experimental_details.method" class="py-name" href="#" onclick="return doclink('link-240', 'method', 'link-240');">method</a></tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt class="py-name">allowed</tt><tt class="py-op">:</tt> </tt>
<a name="L616"></a><tt class="py-lineno">616</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-241" class="py-name"><a title="relax_errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-241', 'RelaxError', 'link-38');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The superimposition method '%s' is unknown.  It must be one of %s."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt id="link-242" class="py-name"><a title="bmrblib.experimental_details.method" class="py-name" href="#" onclick="return doclink('link-242', 'method', 'link-240');">method</a></tt><tt class="py-op">,</tt> <tt class="py-name">allowed</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L617"></a><tt class="py-lineno">617</tt>  <tt class="py-line"> </tt>
<a name="L618"></a><tt class="py-lineno">618</tt>  <tt class="py-line">    <tt class="py-comment"># Validate the models.</tt> </tt>
<a name="L619"></a><tt class="py-lineno">619</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-243" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-243', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-244" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.validate_models
generic_fns.structure.internal.Internal.validate_models" class="py-name" href="#" onclick="return doclink('link-244', 'validate_models', 'link-96');">validate_models</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L620"></a><tt class="py-lineno">620</tt>  <tt class="py-line"> </tt>
<a name="L621"></a><tt class="py-lineno">621</tt>  <tt class="py-line">    <tt class="py-comment"># Create a list of all models.</tt> </tt>
<a name="L622"></a><tt class="py-lineno">622</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-245" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models" class="py-name" href="#" onclick="return doclink('link-245', 'models', 'link-74');">models</a></tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L623"></a><tt class="py-lineno">623</tt>  <tt class="py-line">        <tt id="link-246" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models" class="py-name" href="#" onclick="return doclink('link-246', 'models', 'link-74');">models</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L624"></a><tt class="py-lineno">624</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">model</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-247" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-247', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-248" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.model_loop
specific_fns.api_base.API_base.model_loop
specific_fns.frame_order.Frame_order.model_loop
specific_fns.hybrid.Hybrid.model_loop
specific_fns.model_free.main.Model_free_main.model_loop" class="py-name" href="#" onclick="return doclink('link-248', 'model_loop', 'link-76');">model_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L625"></a><tt class="py-lineno">625</tt>  <tt class="py-line">            <tt id="link-249" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models" class="py-name" href="#" onclick="return doclink('link-249', 'models', 'link-74');">models</a></tt><tt class="py-op">.</tt><tt id="link-250" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-250', 'append', 'link-78');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">model</tt><tt class="py-op">.</tt><tt class="py-name">num</tt><tt class="py-op">)</tt> </tt>
<a name="L626"></a><tt class="py-lineno">626</tt>  <tt class="py-line"> </tt>
<a name="L627"></a><tt class="py-lineno">627</tt>  <tt class="py-line">    <tt class="py-comment"># Assemble the atomic coordinates of all models.</tt> </tt>
<a name="L628"></a><tt class="py-lineno">628</tt>  <tt class="py-line">    <tt class="py-name">coord</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L629"></a><tt class="py-lineno">629</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">model</tt> <tt class="py-keyword">in</tt> <tt id="link-251" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models" class="py-name" href="#" onclick="return doclink('link-251', 'models', 'link-74');">models</a></tt><tt class="py-op">:</tt> </tt>
<a name="L630"></a><tt class="py-lineno">630</tt>  <tt class="py-line">        <tt class="py-name">coord</tt><tt class="py-op">.</tt><tt id="link-252" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-252', 'append', 'link-78');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L631"></a><tt class="py-lineno">631</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">pos</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-253" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-253', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-254" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.atom_loop
generic_fns.structure.internal.Internal.atom_loop
generic_fns.structure.scientific.Scientific_data.atom_loop" class="py-name" href="#" onclick="return doclink('link-254', 'atom_loop', 'link-86');">atom_loop</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">atom_id</tt><tt class="py-op">,</tt> <tt class="py-name">model_num</tt><tt class="py-op">=</tt><tt class="py-name">model</tt><tt class="py-op">,</tt> <tt class="py-name">pos_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L632"></a><tt class="py-lineno">632</tt>  <tt class="py-line">            <tt class="py-name">coord</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-255" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-255', 'append', 'link-78');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">pos</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L633"></a><tt class="py-lineno">633</tt>  <tt class="py-line">        <tt class="py-name">coord</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">coord</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L634"></a><tt class="py-lineno">634</tt>  <tt class="py-line"> </tt>
<a name="L635"></a><tt class="py-lineno">635</tt>  <tt class="py-line">    <tt class="py-comment"># The different algorithms.</tt> </tt>
<a name="L636"></a><tt class="py-lineno">636</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-256" class="py-name"><a title="bmrblib.experimental_details.method" class="py-name" href="#" onclick="return doclink('link-256', 'method', 'link-240');">method</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'fit to mean'</tt><tt class="py-op">:</tt> </tt>
<a name="L637"></a><tt class="py-lineno">637</tt>  <tt class="py-line">        <tt class="py-name">T</tt><tt class="py-op">,</tt> <tt id="link-257" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-257', 'R', 'link-233');">R</a></tt><tt class="py-op">,</tt> <tt id="link-258" class="py-name"><a title="prompt.frame_order.Frame_order.pivot" class="py-name" href="#" onclick="return doclink('link-258', 'pivot', 'link-116');">pivot</a></tt> <tt class="py-op">=</tt> <tt id="link-259" class="py-name"><a title="generic_fns.structure.superimpose.fit_to_mean" class="py-name" href="#" onclick="return doclink('link-259', 'fit_to_mean', 'link-35');">fit_to_mean</a></tt><tt class="py-op">(</tt><tt id="link-260" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models" class="py-name" href="#" onclick="return doclink('link-260', 'models', 'link-74');">models</a></tt><tt class="py-op">=</tt><tt id="link-261" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models" class="py-name" href="#" onclick="return doclink('link-261', 'models', 'link-74');">models</a></tt><tt class="py-op">,</tt> <tt class="py-name">coord</tt><tt class="py-op">=</tt><tt class="py-name">coord</tt><tt class="py-op">,</tt> <tt class="py-name">centroid</tt><tt class="py-op">=</tt><tt class="py-name">centroid</tt><tt class="py-op">)</tt> </tt>
<a name="L638"></a><tt class="py-lineno">638</tt>  <tt class="py-line">    <tt class="py-keyword">elif</tt> <tt id="link-262" class="py-name"><a title="bmrblib.experimental_details.method" class="py-name" href="#" onclick="return doclink('link-262', 'method', 'link-240');">method</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'fit to first'</tt><tt class="py-op">:</tt> </tt>
<a name="L639"></a><tt class="py-lineno">639</tt>  <tt class="py-line">        <tt class="py-name">T</tt><tt class="py-op">,</tt> <tt id="link-263" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-263', 'R', 'link-233');">R</a></tt><tt class="py-op">,</tt> <tt id="link-264" class="py-name"><a title="prompt.frame_order.Frame_order.pivot" class="py-name" href="#" onclick="return doclink('link-264', 'pivot', 'link-116');">pivot</a></tt> <tt class="py-op">=</tt> <tt id="link-265" class="py-name"><a title="generic_fns.structure.superimpose.fit_to_first" class="py-name" href="#" onclick="return doclink('link-265', 'fit_to_first', 'link-34');">fit_to_first</a></tt><tt class="py-op">(</tt><tt id="link-266" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models" class="py-name" href="#" onclick="return doclink('link-266', 'models', 'link-74');">models</a></tt><tt class="py-op">=</tt><tt id="link-267" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models" class="py-name" href="#" onclick="return doclink('link-267', 'models', 'link-74');">models</a></tt><tt class="py-op">,</tt> <tt class="py-name">coord</tt><tt class="py-op">=</tt><tt class="py-name">coord</tt><tt class="py-op">,</tt> <tt class="py-name">centroid</tt><tt class="py-op">=</tt><tt class="py-name">centroid</tt><tt class="py-op">)</tt> </tt>
<a name="L640"></a><tt class="py-lineno">640</tt>  <tt class="py-line"> </tt>
<a name="L641"></a><tt class="py-lineno">641</tt>  <tt class="py-line"> </tt>
<a name="L642"></a><tt class="py-lineno">642</tt>  <tt class="py-line">    <tt class="py-comment"># Update to the new coordinates.</tt> </tt>
<a name="L643"></a><tt class="py-lineno">643</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-268" class="py-name"><a title="prompt.eliminate.Eliminate.i
prompt.minimisation.Minimisation.i" class="py-name" href="#" onclick="return doclink('link-268', 'i', 'link-84');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-269" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models" class="py-name" href="#" onclick="return doclink('link-269', 'models', 'link-74');">models</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L644"></a><tt class="py-lineno">644</tt>  <tt class="py-line">        <tt class="py-comment"># Translate the molecule first (the rotational pivot is defined in the first model).</tt> </tt>
<a name="L645"></a><tt class="py-lineno">645</tt>  <tt class="py-line">        <tt id="link-270" class="py-name" targets="Function bmrblib.misc.translate()=bmrblib.misc-module.html#translate,Method generic_fns.structure.api_base.Base_struct_API.translate()=generic_fns.structure.api_base.Base_struct_API-class.html#translate,Method generic_fns.structure.internal.Internal.translate()=generic_fns.structure.internal.Internal-class.html#translate,Function generic_fns.structure.main.translate()=generic_fns.structure.main-module.html#translate,Method prompt.structure.Structure.translate()=prompt.structure.Structure-class.html#translate"><a title="bmrblib.misc.translate
generic_fns.structure.api_base.Base_struct_API.translate
generic_fns.structure.internal.Internal.translate
generic_fns.structure.main.translate
prompt.structure.Structure.translate" class="py-name" href="#" onclick="return doclink('link-270', 'translate', 'link-270');">translate</a></tt><tt class="py-op">(</tt><tt class="py-name">T</tt><tt class="py-op">=</tt><tt class="py-name">T</tt><tt class="py-op">[</tt><tt id="link-271" class="py-name"><a title="prompt.eliminate.Eliminate.i
prompt.minimisation.Minimisation.i" class="py-name" href="#" onclick="return doclink('link-271', 'i', 'link-84');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">model</tt><tt class="py-op">=</tt><tt id="link-272" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models" class="py-name" href="#" onclick="return doclink('link-272', 'models', 'link-74');">models</a></tt><tt class="py-op">[</tt><tt id="link-273" class="py-name"><a title="prompt.eliminate.Eliminate.i
prompt.minimisation.Minimisation.i" class="py-name" href="#" onclick="return doclink('link-273', 'i', 'link-84');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L646"></a><tt class="py-lineno">646</tt>  <tt class="py-line"> </tt>
<a name="L647"></a><tt class="py-lineno">647</tt>  <tt class="py-line">        <tt class="py-comment"># Rotate the molecule.</tt> </tt>
<a name="L648"></a><tt class="py-lineno">648</tt>  <tt class="py-line">        <tt id="link-274" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.rotate
generic_fns.structure.internal.Internal.rotate
generic_fns.structure.main.rotate
prompt.structure.Structure.rotate" class="py-name" href="#" onclick="return doclink('link-274', 'rotate', 'link-236');">rotate</a></tt><tt class="py-op">(</tt><tt id="link-275" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-275', 'R', 'link-233');">R</a></tt><tt class="py-op">=</tt><tt id="link-276" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-276', 'R', 'link-233');">R</a></tt><tt class="py-op">[</tt><tt id="link-277" class="py-name"><a title="prompt.eliminate.Eliminate.i
prompt.minimisation.Minimisation.i" class="py-name" href="#" onclick="return doclink('link-277', 'i', 'link-84');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">origin</tt><tt class="py-op">=</tt><tt id="link-278" class="py-name"><a title="prompt.frame_order.Frame_order.pivot" class="py-name" href="#" onclick="return doclink('link-278', 'pivot', 'link-116');">pivot</a></tt><tt class="py-op">[</tt><tt id="link-279" class="py-name"><a title="prompt.eliminate.Eliminate.i
prompt.minimisation.Minimisation.i" class="py-name" href="#" onclick="return doclink('link-279', 'i', 'link-84');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">model</tt><tt class="py-op">=</tt><tt id="link-280" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models" class="py-name" href="#" onclick="return doclink('link-280', 'models', 'link-74');">models</a></tt><tt class="py-op">[</tt><tt id="link-281" class="py-name"><a title="prompt.eliminate.Eliminate.i
prompt.minimisation.Minimisation.i" class="py-name" href="#" onclick="return doclink('link-281', 'i', 'link-84');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
</div><a name="L649"></a><tt class="py-lineno">649</tt>  <tt class="py-line"> </tt>
<a name="L650"></a><tt class="py-lineno">650</tt>  <tt class="py-line"> </tt>
<a name="translate"></a><div id="translate-def"><a name="L651"></a><tt class="py-lineno">651</tt> <a class="py-toggle" href="#" id="translate-toggle" onclick="return toggle('translate');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.main-module.html#translate">translate</a><tt class="py-op">(</tt><tt class="py-param">T</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">model</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="translate-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="translate-expanded"><a name="L652"></a><tt class="py-lineno">652</tt>  <tt class="py-line">    <tt class="py-docstring">"""Shift the structural data by the specified translation vector.</tt> </tt>
<a name="L653"></a><tt class="py-lineno">653</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L654"></a><tt class="py-lineno">654</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword T:         The translation vector.</tt> </tt>
<a name="L655"></a><tt class="py-lineno">655</tt>  <tt class="py-line"><tt class="py-docstring">    @type T:            numpy rank-1, 3D array or list of float</tt> </tt>
<a name="L656"></a><tt class="py-lineno">656</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword model:     The model to translate.  If None, all models will be rotated.</tt> </tt>
<a name="L657"></a><tt class="py-lineno">657</tt>  <tt class="py-line"><tt class="py-docstring">    @type model:        int or None</tt> </tt>
<a name="L658"></a><tt class="py-lineno">658</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_id:   The molecule, residue, and atom identifier string.  Only atoms matching this selection will be used.</tt> </tt>
<a name="L659"></a><tt class="py-lineno">659</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_id:      str or None</tt> </tt>
<a name="L660"></a><tt class="py-lineno">660</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L661"></a><tt class="py-lineno">661</tt>  <tt class="py-line"> </tt>
<a name="L662"></a><tt class="py-lineno">662</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L663"></a><tt class="py-lineno">663</tt>  <tt class="py-line">    <tt id="link-282" class="py-name"><a title="generic_fns.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-282', 'pipes', 'link-18');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-283" class="py-name"><a title="bmrblib.pystarlib.TextTest.AllChecks.test
bmrblib.pystarlib.UtilsTest.AllChecks.test
generic_fns.pipes.test" class="py-name" href="#" onclick="return doclink('link-283', 'test', 'link-51');">test</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L664"></a><tt class="py-lineno">664</tt>  <tt class="py-line"> </tt>
<a name="L665"></a><tt class="py-lineno">665</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the structure exists.</tt> </tt>
<a name="L666"></a><tt class="py-lineno">666</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-284" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-284', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-285" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.num_models" class="py-name" href="#" onclick="return doclink('link-285', 'num_models', 'link-122');">num_models</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-286" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-286', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-287" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.num_molecules" class="py-name" href="#" onclick="return doclink('link-287', 'num_molecules', 'link-124');">num_molecules</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L667"></a><tt class="py-lineno">667</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-288" class="py-name"><a title="relax_errors.RelaxNoPdbError" class="py-name" href="#" onclick="return doclink('link-288', 'RelaxNoPdbError', 'link-40');">RelaxNoPdbError</a></tt> </tt>
<a name="L668"></a><tt class="py-lineno">668</tt>  <tt class="py-line"> </tt>
<a name="L669"></a><tt class="py-lineno">669</tt>  <tt class="py-line">    <tt class="py-comment"># Convert the args to numpy float data structures.</tt> </tt>
<a name="L670"></a><tt class="py-lineno">670</tt>  <tt class="py-line">    <tt class="py-name">T</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">T</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L671"></a><tt class="py-lineno">671</tt>  <tt class="py-line"> </tt>
<a name="L672"></a><tt class="py-lineno">672</tt>  <tt class="py-line">    <tt class="py-comment"># Call the specific code.</tt> </tt>
<a name="L673"></a><tt class="py-lineno">673</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-289" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-289', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-290" class="py-name"><a title="bmrblib.misc.translate
generic_fns.structure.api_base.Base_struct_API.translate
generic_fns.structure.internal.Internal.translate
generic_fns.structure.main.translate
prompt.structure.Structure.translate" class="py-name" href="#" onclick="return doclink('link-290', 'translate', 'link-270');">translate</a></tt><tt class="py-op">(</tt><tt class="py-name">T</tt><tt class="py-op">=</tt><tt class="py-name">T</tt><tt class="py-op">,</tt> <tt class="py-name">model</tt><tt class="py-op">=</tt><tt class="py-name">model</tt><tt class="py-op">,</tt> <tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">atom_id</tt><tt class="py-op">)</tt> </tt>
</div><a name="L674"></a><tt class="py-lineno">674</tt>  <tt class="py-line"> </tt>
<a name="L675"></a><tt class="py-lineno">675</tt>  <tt class="py-line"> </tt>
<a name="vectors"></a><div id="vectors-def"><a name="L676"></a><tt class="py-lineno">676</tt> <a class="py-toggle" href="#" id="vectors-toggle" onclick="return toggle('vectors');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.main-module.html#vectors">vectors</a><tt class="py-op">(</tt><tt class="py-param">attached</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">spin_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">model</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">verbosity</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-param">ave</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-param">unit</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="vectors-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="vectors-expanded"><a name="L677"></a><tt class="py-lineno">677</tt>  <tt class="py-line">    <tt class="py-docstring">"""Extract the bond vectors from the loaded structures and store them in the spin container.</tt> </tt>
<a name="L678"></a><tt class="py-lineno">678</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L679"></a><tt class="py-lineno">679</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword attached:      The name of the atom attached to the spin, as given in the structural file.  Regular expression can be used, for example 'H*'.  This uses relax rather than Python regular expression (i.e. shell like syntax).</tt> </tt>
<a name="L680"></a><tt class="py-lineno">680</tt>  <tt class="py-line"><tt class="py-docstring">    @type attached:         str</tt> </tt>
<a name="L681"></a><tt class="py-lineno">681</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword spin_id:       The spin identifier string.</tt> </tt>
<a name="L682"></a><tt class="py-lineno">682</tt>  <tt class="py-line"><tt class="py-docstring">    @type spin_id:          str</tt> </tt>
<a name="L683"></a><tt class="py-lineno">683</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword model:         The model to extract the vector from.  If None, all vectors will be extracted.</tt> </tt>
<a name="L684"></a><tt class="py-lineno">684</tt>  <tt class="py-line"><tt class="py-docstring">    @type model:            str</tt> </tt>
<a name="L685"></a><tt class="py-lineno">685</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword verbosity:     The higher the value, the more information is printed to screen.</tt> </tt>
<a name="L686"></a><tt class="py-lineno">686</tt>  <tt class="py-line"><tt class="py-docstring">    @type verbosity:        int</tt> </tt>
<a name="L687"></a><tt class="py-lineno">687</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword ave:           A flag which if True will cause the average of all vectors to be extracted.</tt> </tt>
<a name="L688"></a><tt class="py-lineno">688</tt>  <tt class="py-line"><tt class="py-docstring">    @type ave:              bool</tt> </tt>
<a name="L689"></a><tt class="py-lineno">689</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword unit:          A flag which if True will cause the function to calculate the unit vectors.</tt> </tt>
<a name="L690"></a><tt class="py-lineno">690</tt>  <tt class="py-line"><tt class="py-docstring">    @type unit:             bool</tt> </tt>
<a name="L691"></a><tt class="py-lineno">691</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L692"></a><tt class="py-lineno">692</tt>  <tt class="py-line"> </tt>
<a name="L693"></a><tt class="py-lineno">693</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the PDB file has been loaded.</tt> </tt>
<a name="L694"></a><tt class="py-lineno">694</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L695"></a><tt class="py-lineno">695</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-291" class="py-name"><a title="relax_errors.RelaxNoPdbError" class="py-name" href="#" onclick="return doclink('link-291', 'RelaxNoPdbError', 'link-40');">RelaxNoPdbError</a></tt> </tt>
<a name="L696"></a><tt class="py-lineno">696</tt>  <tt class="py-line"> </tt>
<a name="L697"></a><tt class="py-lineno">697</tt>  <tt class="py-line">    <tt class="py-comment"># Test if sequence data is loaded.</tt> </tt>
<a name="L698"></a><tt class="py-lineno">698</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-292" class="py-name"><a title="generic_fns.mol_res_spin.exists_mol_res_spin_data" class="py-name" href="#" onclick="return doclink('link-292', 'exists_mol_res_spin_data', 'link-10');">exists_mol_res_spin_data</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L699"></a><tt class="py-lineno">699</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-293" class="py-name"><a title="relax_errors.RelaxNoSequenceError" class="py-name" href="#" onclick="return doclink('link-293', 'RelaxNoSequenceError', 'link-41');">RelaxNoSequenceError</a></tt> </tt>
<a name="L700"></a><tt class="py-lineno">700</tt>  <tt class="py-line"> </tt>
<a name="L701"></a><tt class="py-lineno">701</tt>  <tt class="py-line">    <tt class="py-comment"># Print out.</tt> </tt>
<a name="L702"></a><tt class="py-lineno">702</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-294" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-294', 'verbosity', 'link-209');">verbosity</a></tt><tt class="py-op">:</tt> </tt>
<a name="L703"></a><tt class="py-lineno">703</tt>  <tt class="py-line">        <tt class="py-comment"># Number of models.</tt> </tt>
<a name="L704"></a><tt class="py-lineno">704</tt>  <tt class="py-line">        <tt id="link-295" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.num_models" class="py-name" href="#" onclick="return doclink('link-295', 'num_models', 'link-122');">num_models</a></tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-296" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-296', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-297" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.num_models" class="py-name" href="#" onclick="return doclink('link-297', 'num_models', 'link-122');">num_models</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L705"></a><tt class="py-lineno">705</tt>  <tt class="py-line"> </tt>
<a name="L706"></a><tt class="py-lineno">706</tt>  <tt class="py-line">        <tt class="py-comment"># Multiple models loaded.</tt> </tt>
<a name="L707"></a><tt class="py-lineno">707</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-298" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.num_models" class="py-name" href="#" onclick="return doclink('link-298', 'num_models', 'link-122');">num_models</a></tt> <tt class="py-op">&gt;</tt> <tt class="py-number">1</tt><tt class="py-op">:</tt> </tt>
<a name="L708"></a><tt class="py-lineno">708</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">model</tt><tt class="py-op">:</tt> </tt>
<a name="L709"></a><tt class="py-lineno">709</tt>  <tt class="py-line">                <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-string">"Extracting vectors for model '%s'."</tt> <tt class="py-op">%</tt> <tt class="py-name">model</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L710"></a><tt class="py-lineno">710</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L711"></a><tt class="py-lineno">711</tt>  <tt class="py-line">                <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-string">"Extracting vectors for all %s models."</tt> <tt class="py-op">%</tt> <tt id="link-299" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.num_models" class="py-name" href="#" onclick="return doclink('link-299', 'num_models', 'link-122');">num_models</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L712"></a><tt class="py-lineno">712</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">ave</tt><tt class="py-op">:</tt> </tt>
<a name="L713"></a><tt class="py-lineno">713</tt>  <tt class="py-line">                    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Averaging all vectors."</tt><tt class="py-op">)</tt> </tt>
<a name="L714"></a><tt class="py-lineno">714</tt>  <tt class="py-line"> </tt>
<a name="L715"></a><tt class="py-lineno">715</tt>  <tt class="py-line">        <tt class="py-comment"># Single model loaded.</tt> </tt>
<a name="L716"></a><tt class="py-lineno">716</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L717"></a><tt class="py-lineno">717</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Extracting vectors from the single model."</tt><tt class="py-op">)</tt> </tt>
<a name="L718"></a><tt class="py-lineno">718</tt>  <tt class="py-line"> </tt>
<a name="L719"></a><tt class="py-lineno">719</tt>  <tt class="py-line">        <tt class="py-comment"># Unit vectors.</tt> </tt>
<a name="L720"></a><tt class="py-lineno">720</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">unit</tt><tt class="py-op">:</tt> </tt>
<a name="L721"></a><tt class="py-lineno">721</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Calculating the unit vectors."</tt><tt class="py-op">)</tt> </tt>
<a name="L722"></a><tt class="py-lineno">722</tt>  <tt class="py-line"> </tt>
<a name="L723"></a><tt class="py-lineno">723</tt>  <tt class="py-line">    <tt class="py-comment"># Determine if the attached atom is a proton.</tt> </tt>
<a name="L724"></a><tt class="py-lineno">724</tt>  <tt class="py-line">    <tt class="py-name">proton</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L725"></a><tt class="py-lineno">725</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-300" class="py-name"><a title="generic_fns.relax_re" class="py-name" href="#" onclick="return doclink('link-300', 'relax_re', 'link-6');">relax_re</a></tt><tt class="py-op">.</tt><tt id="link-301" class="py-name"><a title="generic_fns.relax_re.search" class="py-name" href="#" onclick="return doclink('link-301', 'search', 'link-3');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'.*H.*'</tt><tt class="py-op">,</tt> <tt class="py-name">attached</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt id="link-302" class="py-name"><a title="generic_fns.relax_re" class="py-name" href="#" onclick="return doclink('link-302', 'relax_re', 'link-6');">relax_re</a></tt><tt class="py-op">.</tt><tt id="link-303" class="py-name"><a title="generic_fns.relax_re.search" class="py-name" href="#" onclick="return doclink('link-303', 'search', 'link-3');">search</a></tt><tt class="py-op">(</tt><tt class="py-name">attached</tt><tt class="py-op">,</tt> <tt class="py-string">'H'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L726"></a><tt class="py-lineno">726</tt>  <tt class="py-line">        <tt class="py-name">proton</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L727"></a><tt class="py-lineno">727</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-304" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-304', 'verbosity', 'link-209');">verbosity</a></tt><tt class="py-op">:</tt> </tt>
<a name="L728"></a><tt class="py-lineno">728</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">proton</tt><tt class="py-op">:</tt> </tt>
<a name="L729"></a><tt class="py-lineno">729</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"The attached atom is a proton."</tt><tt class="py-op">)</tt> </tt>
<a name="L730"></a><tt class="py-lineno">730</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L731"></a><tt class="py-lineno">731</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"The attached atom is not a proton."</tt><tt class="py-op">)</tt> </tt>
<a name="L732"></a><tt class="py-lineno">732</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">''</tt><tt class="py-op">)</tt> </tt>
<a name="L733"></a><tt class="py-lineno">733</tt>  <tt class="py-line"> </tt>
<a name="L734"></a><tt class="py-lineno">734</tt>  <tt class="py-line">    <tt class="py-comment"># Set the variable name in which the vectors will be stored.</tt> </tt>
<a name="L735"></a><tt class="py-lineno">735</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">proton</tt><tt class="py-op">:</tt> </tt>
<a name="L736"></a><tt class="py-lineno">736</tt>  <tt class="py-line">        <tt class="py-name">object_name</tt> <tt class="py-op">=</tt> <tt class="py-string">'xh_vect'</tt> </tt>
<a name="L737"></a><tt class="py-lineno">737</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L738"></a><tt class="py-lineno">738</tt>  <tt class="py-line">        <tt class="py-name">object_name</tt> <tt class="py-op">=</tt> <tt class="py-string">'bond_vect'</tt> </tt>
<a name="L739"></a><tt class="py-lineno">739</tt>  <tt class="py-line"> </tt>
<a name="L740"></a><tt class="py-lineno">740</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over the spins.</tt> </tt>
<a name="L741"></a><tt class="py-lineno">741</tt>  <tt class="py-line">    <tt class="py-name">no_vectors</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L742"></a><tt class="py-lineno">742</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-305" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-305', 'spin', 'link-66');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt> <tt class="py-keyword">in</tt> <tt id="link-306" class="py-name"><a title="generic_fns.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-306', 'spin_loop', 'link-16');">spin_loop</a></tt><tt class="py-op">(</tt><tt id="link-307" class="py-name" targets="Module generic_fns.selection=generic_fns.selection-module.html"><a title="generic_fns.selection" class="py-name" href="#" onclick="return doclink('link-307', 'selection', 'link-307');">selection</a></tt><tt class="py-op">=</tt><tt class="py-name">spin_id</tt><tt class="py-op">,</tt> <tt class="py-name">full_info</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L743"></a><tt class="py-lineno">743</tt>  <tt class="py-line">        <tt class="py-comment"># Skip deselected spins.</tt> </tt>
<a name="L744"></a><tt class="py-lineno">744</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-308" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-308', 'spin', 'link-66');">spin</a></tt><tt class="py-op">.</tt><tt id="link-309" class="py-name" targets="Function generic_fns.model_selection.select()=generic_fns.model_selection-module.html#select,Module gui.user_functions.select=gui.user_functions.select-module.html,Module prompt.select=prompt.select-module.html"><a title="generic_fns.model_selection.select
gui.user_functions.select
prompt.select" class="py-name" href="#" onclick="return doclink('link-309', 'select', 'link-309');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L745"></a><tt class="py-lineno">745</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L746"></a><tt class="py-lineno">746</tt>  <tt class="py-line"> </tt>
<a name="L747"></a><tt class="py-lineno">747</tt>  <tt class="py-line">        <tt class="py-comment"># The spin identification string.  The residue name and spin num is not included to allow molecules with point mutations to be used as different models.</tt> </tt>
<a name="L748"></a><tt class="py-lineno">748</tt>  <tt class="py-line">        <tt id="link-310" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-310', 'id', 'link-132');">id</a></tt> <tt class="py-op">=</tt> <tt id="link-311" class="py-name"><a title="generic_fns.mol_res_spin.generate_spin_id" class="py-name" href="#" onclick="return doclink('link-311', 'generate_spin_id', 'link-11');">generate_spin_id</a></tt><tt class="py-op">(</tt><tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">spin_name</tt><tt class="py-op">=</tt><tt id="link-312" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-312', 'spin', 'link-66');">spin</a></tt><tt class="py-op">.</tt><tt id="link-313" class="py-name" targets="Variable bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name=bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe-class.html#name,Variable bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name=bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1-class.html#name,Variable bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name=bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name=bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name=bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name=bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name=bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1-class.html#name,Variable generic_fns.pipes.name=generic_fns.pipes-module.html#name,Method gui.user_functions.spin.Spin.name()=gui.user_functions.spin.Spin-class.html#name,Method prompt.molecule.Molecule.name()=prompt.molecule.Molecule-class.html#name,Method prompt.residue.Residue.name()=prompt.residue.Residue-class.html#name,Method prompt.spin.Spin.name()=prompt.spin.Spin-class.html#name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
generic_fns.pipes.name
gui.user_functions.spin.Spin.name
prompt.molecule.Molecule.name
prompt.residue.Residue.name
prompt.spin.Spin.name" class="py-name" href="#" onclick="return doclink('link-313', 'name', 'link-313');">name</a></tt><tt class="py-op">,</tt> <tt class="py-name">spin_num</tt><tt class="py-op">=</tt><tt id="link-314" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-314', 'spin', 'link-66');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">num</tt><tt class="py-op">)</tt> </tt>
<a name="L749"></a><tt class="py-lineno">749</tt>  <tt class="py-line"> </tt>
<a name="L750"></a><tt class="py-lineno">750</tt>  <tt class="py-line">        <tt class="py-comment"># Test that the spin number or name are set (one or both are essential for the identification of the atom).</tt> </tt>
<a name="L751"></a><tt class="py-lineno">751</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-315" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-315', 'spin', 'link-66');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">num</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt> <tt class="py-keyword">and</tt> <tt id="link-316" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-316', 'spin', 'link-66');">spin</a></tt><tt class="py-op">.</tt><tt id="link-317" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
generic_fns.pipes.name
gui.user_functions.spin.Spin.name
prompt.molecule.Molecule.name
prompt.residue.Residue.name
prompt.spin.Spin.name" class="py-name" href="#" onclick="return doclink('link-317', 'name', 'link-313');">name</a></tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L752"></a><tt class="py-lineno">752</tt>  <tt class="py-line">            <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-318" class="py-name"><a title="relax_warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-318', 'RelaxWarning', 'link-47');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"Either the spin number or name must be set for the spin "</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt id="link-319" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-319', 'id', 'link-132');">id</a></tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">" to identify the corresponding atom in the molecule."</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L753"></a><tt class="py-lineno">753</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L754"></a><tt class="py-lineno">754</tt>  <tt class="py-line"> </tt>
<a name="L755"></a><tt class="py-lineno">755</tt>  <tt class="py-line">        <tt class="py-comment"># The bond vector already exists.</tt> </tt>
<a name="L756"></a><tt class="py-lineno">756</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-320" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-320', 'spin', 'link-66');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">object_name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L757"></a><tt class="py-lineno">757</tt>  <tt class="py-line">            <tt class="py-name">obj</tt> <tt class="py-op">=</tt> <tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt id="link-321" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-321', 'spin', 'link-66');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">object_name</tt><tt class="py-op">)</tt> </tt>
<a name="L758"></a><tt class="py-lineno">758</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">obj</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L759"></a><tt class="py-lineno">759</tt>  <tt class="py-line">                <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-322" class="py-name"><a title="relax_warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-322', 'RelaxWarning', 'link-47');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"The bond vector for the spin "</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt id="link-323" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-323', 'id', 'link-132');">id</a></tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">" already exists."</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L760"></a><tt class="py-lineno">760</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L761"></a><tt class="py-lineno">761</tt>  <tt class="py-line"> </tt>
<a name="L762"></a><tt class="py-lineno">762</tt>  <tt class="py-line">        <tt class="py-comment"># Get the bond info.</tt> </tt>
<a name="L763"></a><tt class="py-lineno">763</tt>  <tt class="py-line">        <tt id="link-324" class="py-name" targets="Method generic_fns.structure.api_base.Base_struct_API.bond_vectors()=generic_fns.structure.api_base.Base_struct_API-class.html#bond_vectors,Method generic_fns.structure.internal.Internal.bond_vectors()=generic_fns.structure.internal.Internal-class.html#bond_vectors,Method generic_fns.structure.scientific.Scientific_data.bond_vectors()=generic_fns.structure.scientific.Scientific_data-class.html#bond_vectors"><a title="generic_fns.structure.api_base.Base_struct_API.bond_vectors
generic_fns.structure.internal.Internal.bond_vectors
generic_fns.structure.scientific.Scientific_data.bond_vectors" class="py-name" href="#" onclick="return doclink('link-324', 'bond_vectors', 'link-324');">bond_vectors</a></tt><tt class="py-op">,</tt> <tt class="py-name">attached_name</tt><tt class="py-op">,</tt> <tt class="py-name">warnings</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-325" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-325', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-326" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.bond_vectors
generic_fns.structure.internal.Internal.bond_vectors
generic_fns.structure.scientific.Scientific_data.bond_vectors" class="py-name" href="#" onclick="return doclink('link-326', 'bond_vectors', 'link-324');">bond_vectors</a></tt><tt class="py-op">(</tt><tt id="link-327" class="py-name" targets="Method generic_fns.structure.api_base.Base_struct_API.attached_atom()=generic_fns.structure.api_base.Base_struct_API-class.html#attached_atom,Method generic_fns.structure.scientific.Scientific_data.attached_atom()=generic_fns.structure.scientific.Scientific_data-class.html#attached_atom"><a title="generic_fns.structure.api_base.Base_struct_API.attached_atom
generic_fns.structure.scientific.Scientific_data.attached_atom" class="py-name" href="#" onclick="return doclink('link-327', 'attached_atom', 'link-327');">attached_atom</a></tt><tt class="py-op">=</tt><tt class="py-name">attached</tt><tt class="py-op">,</tt> <tt class="py-name">model_num</tt><tt class="py-op">=</tt><tt class="py-name">model</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">spin_name</tt><tt class="py-op">=</tt><tt id="link-328" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-328', 'spin', 'link-66');">spin</a></tt><tt class="py-op">.</tt><tt id="link-329" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
generic_fns.pipes.name
gui.user_functions.spin.Spin.name
prompt.molecule.Molecule.name
prompt.residue.Residue.name
prompt.spin.Spin.name" class="py-name" href="#" onclick="return doclink('link-329', 'name', 'link-313');">name</a></tt><tt class="py-op">,</tt> <tt class="py-name">spin_num</tt><tt class="py-op">=</tt><tt id="link-330" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-330', 'spin', 'link-66');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">num</tt><tt class="py-op">,</tt> <tt class="py-name">return_name</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">return_warnings</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L764"></a><tt class="py-lineno">764</tt>  <tt class="py-line"> </tt>
<a name="L765"></a><tt class="py-lineno">765</tt>  <tt class="py-line">        <tt class="py-comment"># No attached atom.</tt> </tt>
<a name="L766"></a><tt class="py-lineno">766</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-331" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.bond_vectors
generic_fns.structure.internal.Internal.bond_vectors
generic_fns.structure.scientific.Scientific_data.bond_vectors" class="py-name" href="#" onclick="return doclink('link-331', 'bond_vectors', 'link-324');">bond_vectors</a></tt><tt class="py-op">:</tt> </tt>
<a name="L767"></a><tt class="py-lineno">767</tt>  <tt class="py-line">            <tt class="py-comment"># Warning messages.</tt> </tt>
<a name="L768"></a><tt class="py-lineno">768</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">warnings</tt><tt class="py-op">:</tt> </tt>
<a name="L769"></a><tt class="py-lineno">769</tt>  <tt class="py-line">                <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-332" class="py-name"><a title="relax_warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-332', 'RelaxWarning', 'link-47');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-name">warnings</tt> <tt class="py-op">+</tt> <tt class="py-string">" (atom ID "</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt id="link-333" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-333', 'id', 'link-132');">id</a></tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">")."</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L770"></a><tt class="py-lineno">770</tt>  <tt class="py-line"> </tt>
<a name="L771"></a><tt class="py-lineno">771</tt>  <tt class="py-line">            <tt class="py-comment"># Skip the spin.</tt> </tt>
<a name="L772"></a><tt class="py-lineno">772</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L773"></a><tt class="py-lineno">773</tt>  <tt class="py-line"> </tt>
<a name="L774"></a><tt class="py-lineno">774</tt>  <tt class="py-line">        <tt class="py-comment"># Set the attached atom name.</tt> </tt>
<a name="L775"></a><tt class="py-lineno">775</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-334" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-334', 'spin', 'link-66');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'attached_atom'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L776"></a><tt class="py-lineno">776</tt>  <tt class="py-line">            <tt id="link-335" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-335', 'spin', 'link-66');">spin</a></tt><tt class="py-op">.</tt><tt id="link-336" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.attached_atom
generic_fns.structure.scientific.Scientific_data.attached_atom" class="py-name" href="#" onclick="return doclink('link-336', 'attached_atom', 'link-327');">attached_atom</a></tt> <tt class="py-op">=</tt> <tt class="py-name">attached_name</tt> </tt>
<a name="L777"></a><tt class="py-lineno">777</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt id="link-337" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-337', 'spin', 'link-66');">spin</a></tt><tt class="py-op">.</tt><tt id="link-338" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.attached_atom
generic_fns.structure.scientific.Scientific_data.attached_atom" class="py-name" href="#" onclick="return doclink('link-338', 'attached_atom', 'link-327');">attached_atom</a></tt> <tt class="py-op">!=</tt> <tt class="py-name">attached_name</tt><tt class="py-op">:</tt> </tt>
<a name="L778"></a><tt class="py-lineno">778</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-339" class="py-name"><a title="relax_errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-339', 'RelaxError', 'link-38');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The "</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt id="link-340" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-340', 'spin', 'link-66');">spin</a></tt><tt class="py-op">.</tt><tt id="link-341" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.attached_atom
generic_fns.structure.scientific.Scientific_data.attached_atom" class="py-name" href="#" onclick="return doclink('link-341', 'attached_atom', 'link-327');">attached_atom</a></tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">" atom already attached to the spin does not match the attached atom "</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">attached_name</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">"."</tt><tt class="py-op">)</tt> </tt>
<a name="L779"></a><tt class="py-lineno">779</tt>  <tt class="py-line"> </tt>
<a name="L780"></a><tt class="py-lineno">780</tt>  <tt class="py-line">        <tt class="py-comment"># Initialise the average vector.</tt> </tt>
<a name="L781"></a><tt class="py-lineno">781</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">ave</tt><tt class="py-op">:</tt> </tt>
<a name="L782"></a><tt class="py-lineno">782</tt>  <tt class="py-line">            <tt class="py-name">ave_vector</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-number">3</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L783"></a><tt class="py-lineno">783</tt>  <tt class="py-line"> </tt>
<a name="L784"></a><tt class="py-lineno">784</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the individual vectors.</tt> </tt>
<a name="L785"></a><tt class="py-lineno">785</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-342" class="py-name"><a title="prompt.eliminate.Eliminate.i
prompt.minimisation.Minimisation.i" class="py-name" href="#" onclick="return doclink('link-342', 'i', 'link-84');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">xrange</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-343" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.bond_vectors
generic_fns.structure.internal.Internal.bond_vectors
generic_fns.structure.scientific.Scientific_data.bond_vectors" class="py-name" href="#" onclick="return doclink('link-343', 'bond_vectors', 'link-324');">bond_vectors</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L786"></a><tt class="py-lineno">786</tt>  <tt class="py-line">            <tt class="py-comment"># Unit vector.</tt> </tt>
<a name="L787"></a><tt class="py-lineno">787</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">unit</tt><tt class="py-op">:</tt> </tt>
<a name="L788"></a><tt class="py-lineno">788</tt>  <tt class="py-line">                <tt class="py-comment"># Normalisation factor.</tt> </tt>
<a name="L789"></a><tt class="py-lineno">789</tt>  <tt class="py-line">                <tt class="py-name">norm_factor</tt> <tt class="py-op">=</tt> <tt class="py-name">norm</tt><tt class="py-op">(</tt><tt id="link-344" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.bond_vectors
generic_fns.structure.internal.Internal.bond_vectors
generic_fns.structure.scientific.Scientific_data.bond_vectors" class="py-name" href="#" onclick="return doclink('link-344', 'bond_vectors', 'link-324');">bond_vectors</a></tt><tt class="py-op">[</tt><tt id="link-345" class="py-name"><a title="prompt.eliminate.Eliminate.i
prompt.minimisation.Minimisation.i" class="py-name" href="#" onclick="return doclink('link-345', 'i', 'link-84');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L790"></a><tt class="py-lineno">790</tt>  <tt class="py-line"> </tt>
<a name="L791"></a><tt class="py-lineno">791</tt>  <tt class="py-line">                <tt class="py-comment"># Test for zero length.</tt> </tt>
<a name="L792"></a><tt class="py-lineno">792</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">norm_factor</tt> <tt class="py-op">==</tt> <tt class="py-number">0.0</tt><tt class="py-op">:</tt> </tt>
<a name="L793"></a><tt class="py-lineno">793</tt>  <tt class="py-line">                    <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-346" class="py-name"><a title="relax_warnings.RelaxZeroVectorWarning" class="py-name" href="#" onclick="return doclink('link-346', 'RelaxZeroVectorWarning', 'link-49');">RelaxZeroVectorWarning</a></tt><tt class="py-op">(</tt><tt id="link-347" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-347', 'id', 'link-132');">id</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L794"></a><tt class="py-lineno">794</tt>  <tt class="py-line"> </tt>
<a name="L795"></a><tt class="py-lineno">795</tt>  <tt class="py-line">                <tt class="py-comment"># Calculate the normalised vector.</tt> </tt>
<a name="L796"></a><tt class="py-lineno">796</tt>  <tt class="py-line">                <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L797"></a><tt class="py-lineno">797</tt>  <tt class="py-line">                    <tt id="link-348" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.bond_vectors
generic_fns.structure.internal.Internal.bond_vectors
generic_fns.structure.scientific.Scientific_data.bond_vectors" class="py-name" href="#" onclick="return doclink('link-348', 'bond_vectors', 'link-324');">bond_vectors</a></tt><tt class="py-op">[</tt><tt id="link-349" class="py-name"><a title="prompt.eliminate.Eliminate.i
prompt.minimisation.Minimisation.i" class="py-name" href="#" onclick="return doclink('link-349', 'i', 'link-84');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-350" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.bond_vectors
generic_fns.structure.internal.Internal.bond_vectors
generic_fns.structure.scientific.Scientific_data.bond_vectors" class="py-name" href="#" onclick="return doclink('link-350', 'bond_vectors', 'link-324');">bond_vectors</a></tt><tt class="py-op">[</tt><tt id="link-351" class="py-name"><a title="prompt.eliminate.Eliminate.i
prompt.minimisation.Minimisation.i" class="py-name" href="#" onclick="return doclink('link-351', 'i', 'link-84');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">/</tt> <tt class="py-name">norm_factor</tt> </tt>
<a name="L798"></a><tt class="py-lineno">798</tt>  <tt class="py-line"> </tt>
<a name="L799"></a><tt class="py-lineno">799</tt>  <tt class="py-line">            <tt class="py-comment"># Sum the vectors.</tt> </tt>
<a name="L800"></a><tt class="py-lineno">800</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">ave</tt><tt class="py-op">:</tt> </tt>
<a name="L801"></a><tt class="py-lineno">801</tt>  <tt class="py-line">                <tt class="py-name">ave_vector</tt> <tt class="py-op">=</tt> <tt class="py-name">ave_vector</tt> <tt class="py-op">+</tt> <tt id="link-352" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.bond_vectors
generic_fns.structure.internal.Internal.bond_vectors
generic_fns.structure.scientific.Scientific_data.bond_vectors" class="py-name" href="#" onclick="return doclink('link-352', 'bond_vectors', 'link-324');">bond_vectors</a></tt><tt class="py-op">[</tt><tt id="link-353" class="py-name"><a title="prompt.eliminate.Eliminate.i
prompt.minimisation.Minimisation.i" class="py-name" href="#" onclick="return doclink('link-353', 'i', 'link-84');">i</a></tt><tt class="py-op">]</tt> </tt>
<a name="L802"></a><tt class="py-lineno">802</tt>  <tt class="py-line"> </tt>
<a name="L803"></a><tt class="py-lineno">803</tt>  <tt class="py-line">        <tt class="py-comment"># Average.</tt> </tt>
<a name="L804"></a><tt class="py-lineno">804</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">ave</tt><tt class="py-op">:</tt> </tt>
<a name="L805"></a><tt class="py-lineno">805</tt>  <tt class="py-line">            <tt class="py-name">vector</tt> <tt class="py-op">=</tt> <tt class="py-name">ave_vector</tt> <tt class="py-op">/</tt> <tt id="link-354" class="py-name"><a title="float" class="py-name" href="#" onclick="return doclink('link-354', 'float', 'link-146');">float</a></tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-355" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.bond_vectors
generic_fns.structure.internal.Internal.bond_vectors
generic_fns.structure.scientific.Scientific_data.bond_vectors" class="py-name" href="#" onclick="return doclink('link-355', 'bond_vectors', 'link-324');">bond_vectors</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L806"></a><tt class="py-lineno">806</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L807"></a><tt class="py-lineno">807</tt>  <tt class="py-line">            <tt class="py-name">vector</tt> <tt class="py-op">=</tt> <tt id="link-356" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.bond_vectors
generic_fns.structure.internal.Internal.bond_vectors
generic_fns.structure.scientific.Scientific_data.bond_vectors" class="py-name" href="#" onclick="return doclink('link-356', 'bond_vectors', 'link-324');">bond_vectors</a></tt> </tt>
<a name="L808"></a><tt class="py-lineno">808</tt>  <tt class="py-line"> </tt>
<a name="L809"></a><tt class="py-lineno">809</tt>  <tt class="py-line">        <tt class="py-comment"># Set the vector.</tt> </tt>
<a name="L810"></a><tt class="py-lineno">810</tt>  <tt class="py-line">        <tt class="py-name">setattr</tt><tt class="py-op">(</tt><tt id="link-357" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-357', 'spin', 'link-66');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">object_name</tt><tt class="py-op">,</tt> <tt class="py-name">vector</tt><tt class="py-op">)</tt> </tt>
<a name="L811"></a><tt class="py-lineno">811</tt>  <tt class="py-line"> </tt>
<a name="L812"></a><tt class="py-lineno">812</tt>  <tt class="py-line">        <tt class="py-comment"># We have a vector!</tt> </tt>
<a name="L813"></a><tt class="py-lineno">813</tt>  <tt class="py-line">        <tt class="py-name">no_vectors</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L814"></a><tt class="py-lineno">814</tt>  <tt class="py-line"> </tt>
<a name="L815"></a><tt class="py-lineno">815</tt>  <tt class="py-line">        <tt class="py-comment"># Print out of modified spins.</tt> </tt>
<a name="L816"></a><tt class="py-lineno">816</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-358" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-358', 'verbosity', 'link-209');">verbosity</a></tt><tt class="py-op">:</tt> </tt>
<a name="L817"></a><tt class="py-lineno">817</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-359" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-359', 'spin', 'link-66');">spin</a></tt><tt class="py-op">.</tt><tt id="link-360" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
generic_fns.pipes.name
gui.user_functions.spin.Spin.name
prompt.molecule.Molecule.name
prompt.residue.Residue.name
prompt.spin.Spin.name" class="py-name" href="#" onclick="return doclink('link-360', 'name', 'link-313');">name</a></tt><tt class="py-op">:</tt> </tt>
<a name="L818"></a><tt class="py-lineno">818</tt>  <tt class="py-line">                <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-string">"Extracted "</tt> <tt class="py-op">+</tt> <tt id="link-361" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-361', 'spin', 'link-66');">spin</a></tt><tt class="py-op">.</tt><tt id="link-362" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
generic_fns.pipes.name
gui.user_functions.spin.Spin.name
prompt.molecule.Molecule.name
prompt.residue.Residue.name
prompt.spin.Spin.name" class="py-name" href="#" onclick="return doclink('link-362', 'name', 'link-313');">name</a></tt> <tt class="py-op">+</tt> <tt class="py-string">"-"</tt> <tt class="py-op">+</tt> <tt class="py-name">str</tt><tt class="py-op">(</tt><tt class="py-name">attached_name</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">" vectors for "</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt id="link-363" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-363', 'id', 'link-132');">id</a></tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">'.'</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L819"></a><tt class="py-lineno">819</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L820"></a><tt class="py-lineno">820</tt>  <tt class="py-line">                <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-string">"Extracted "</tt> <tt class="py-op">+</tt> <tt class="py-name">str</tt><tt class="py-op">(</tt><tt id="link-364" class="py-name"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-364', 'spin', 'link-66');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">num</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">"-"</tt> <tt class="py-op">+</tt> <tt class="py-name">str</tt><tt class="py-op">(</tt><tt class="py-name">attached_name</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">" vectors for "</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt id="link-365" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-365', 'id', 'link-132');">id</a></tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">'.'</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L821"></a><tt class="py-lineno">821</tt>  <tt class="py-line"> </tt>
<a name="L822"></a><tt class="py-lineno">822</tt>  <tt class="py-line">    <tt class="py-comment"># Right, catch the problem of missing vectors to prevent massive user confusion!</tt> </tt>
<a name="L823"></a><tt class="py-lineno">823</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">no_vectors</tt><tt class="py-op">:</tt> </tt>
<a name="L824"></a><tt class="py-lineno">824</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-366" class="py-name"><a title="relax_errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-366', 'RelaxError', 'link-38');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"No vectors could be extracted."</tt><tt class="py-op">)</tt> </tt>
</div><a name="L825"></a><tt class="py-lineno">825</tt>  <tt class="py-line"> </tt>
<a name="L826"></a><tt class="py-lineno">826</tt>  <tt class="py-line"> </tt>
<a name="write_pdb"></a><div id="write_pdb-def"><a name="L827"></a><tt class="py-lineno">827</tt> <a class="py-toggle" href="#" id="write_pdb-toggle" onclick="return toggle('write_pdb');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.main-module.html#write_pdb">write_pdb</a><tt class="py-op">(</tt><tt class="py-param">file</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">dir</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">model_num</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">compress_type</tt><tt class="py-op">=</tt><tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-param">force</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="write_pdb-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="write_pdb-expanded"><a name="L828"></a><tt class="py-lineno">828</tt>  <tt class="py-line">    <tt class="py-docstring">"""The PDB writing function.</tt> </tt>
<a name="L829"></a><tt class="py-lineno">829</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L830"></a><tt class="py-lineno">830</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword file:          The name of the PDB file to write.</tt> </tt>
<a name="L831"></a><tt class="py-lineno">831</tt>  <tt class="py-line"><tt class="py-docstring">    @type file:             str</tt> </tt>
<a name="L832"></a><tt class="py-lineno">832</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword dir:           The directory where the PDB file will be placed.  If set to None, then the file will be placed in the current directory.</tt> </tt>
<a name="L833"></a><tt class="py-lineno">833</tt>  <tt class="py-line"><tt class="py-docstring">    @type dir:              str or None</tt> </tt>
<a name="L834"></a><tt class="py-lineno">834</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword model_num:     The model to place into the PDB file.  If not supplied, then all models will be placed into the file.</tt> </tt>
<a name="L835"></a><tt class="py-lineno">835</tt>  <tt class="py-line"><tt class="py-docstring">    @type model_num:        None or int</tt> </tt>
<a name="L836"></a><tt class="py-lineno">836</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword compress_type: The compression type.  The integer values correspond to the compression type: 0, no compression; 1, Bzip2 compression; 2, Gzip compression.</tt> </tt>
<a name="L837"></a><tt class="py-lineno">837</tt>  <tt class="py-line"><tt class="py-docstring">    @type compress_type:    int</tt> </tt>
<a name="L838"></a><tt class="py-lineno">838</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword force:         The force flag which if True will cause the file to be overwritten.</tt> </tt>
<a name="L839"></a><tt class="py-lineno">839</tt>  <tt class="py-line"><tt class="py-docstring">    @type force:            bool</tt> </tt>
<a name="L840"></a><tt class="py-lineno">840</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L841"></a><tt class="py-lineno">841</tt>  <tt class="py-line"> </tt>
<a name="L842"></a><tt class="py-lineno">842</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L843"></a><tt class="py-lineno">843</tt>  <tt class="py-line">    <tt id="link-367" class="py-name"><a title="generic_fns.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-367', 'pipes', 'link-18');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-368" class="py-name"><a title="bmrblib.pystarlib.TextTest.AllChecks.test
bmrblib.pystarlib.UtilsTest.AllChecks.test
generic_fns.pipes.test" class="py-name" href="#" onclick="return doclink('link-368', 'test', 'link-51');">test</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L844"></a><tt class="py-lineno">844</tt>  <tt class="py-line"> </tt>
<a name="L845"></a><tt class="py-lineno">845</tt>  <tt class="py-line">    <tt class="py-comment"># Check if the structural object exists.</tt> </tt>
<a name="L846"></a><tt class="py-lineno">846</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L847"></a><tt class="py-lineno">847</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-369" class="py-name"><a title="relax_errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-369', 'RelaxError', 'link-38');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"No structural data is present in the current data pipe."</tt><tt class="py-op">)</tt> </tt>
<a name="L848"></a><tt class="py-lineno">848</tt>  <tt class="py-line"> </tt>
<a name="L849"></a><tt class="py-lineno">849</tt>  <tt class="py-line">    <tt class="py-comment"># Check if the structural object is writable.</tt> </tt>
<a name="L850"></a><tt class="py-lineno">850</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-370" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-370', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-371" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-371', 'id', 'link-132');">id</a></tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt class="py-string">'scientific'</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L851"></a><tt class="py-lineno">851</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-372" class="py-name"><a title="relax_errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-372', 'RelaxError', 'link-38');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The structures from the "</tt> <tt class="py-op">+</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-373" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-373', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-374" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-374', 'id', 'link-132');">id</a></tt> <tt class="py-op">+</tt> <tt class="py-string">" parser are not writable."</tt><tt class="py-op">)</tt> </tt>
<a name="L852"></a><tt class="py-lineno">852</tt>  <tt class="py-line"> </tt>
<a name="L853"></a><tt class="py-lineno">853</tt>  <tt class="py-line">    <tt class="py-comment"># The file path.</tt> </tt>
<a name="L854"></a><tt class="py-lineno">854</tt>  <tt class="py-line">    <tt class="py-name">file_path</tt> <tt class="py-op">=</tt> <tt id="link-375" class="py-name"><a title="relax_io.get_file_path" class="py-name" href="#" onclick="return doclink('link-375', 'get_file_path', 'link-43');">get_file_path</a></tt><tt class="py-op">(</tt><tt id="link-376" class="py-name"><a title="dep_check.file" class="py-name" href="#" onclick="return doclink('link-376', 'file', 'link-188');">file</a></tt><tt class="py-op">,</tt> <tt class="py-name">dir</tt><tt class="py-op">)</tt> </tt>
<a name="L855"></a><tt class="py-lineno">855</tt>  <tt class="py-line"> </tt>
<a name="L856"></a><tt class="py-lineno">856</tt>  <tt class="py-line">    <tt class="py-comment"># Add '.pdb' to the end of the file path if it isn't there yet.</tt> </tt>
<a name="L857"></a><tt class="py-lineno">857</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-377" class="py-name"><a title="generic_fns.relax_re.search" class="py-name" href="#" onclick="return doclink('link-377', 'search', 'link-3');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">".pdb$"</tt><tt class="py-op">,</tt> <tt class="py-name">file_path</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L858"></a><tt class="py-lineno">858</tt>  <tt class="py-line">        <tt class="py-name">file_path</tt> <tt class="py-op">=</tt> <tt class="py-name">file_path</tt> <tt class="py-op">+</tt> <tt class="py-string">'.pdb'</tt> </tt>
<a name="L859"></a><tt class="py-lineno">859</tt>  <tt class="py-line"> </tt>
<a name="L860"></a><tt class="py-lineno">860</tt>  <tt class="py-line">    <tt class="py-comment"># Open the file for writing.</tt> </tt>
<a name="L861"></a><tt class="py-lineno">861</tt>  <tt class="py-line">    <tt id="link-378" class="py-name"><a title="dep_check.file" class="py-name" href="#" onclick="return doclink('link-378', 'file', 'link-188');">file</a></tt> <tt class="py-op">=</tt> <tt id="link-379" class="py-name"><a title="relax_io.open_write_file" class="py-name" href="#" onclick="return doclink('link-379', 'open_write_file', 'link-44');">open_write_file</a></tt><tt class="py-op">(</tt><tt class="py-name">file_path</tt><tt class="py-op">,</tt> <tt class="py-name">compress_type</tt><tt class="py-op">=</tt><tt class="py-name">compress_type</tt><tt class="py-op">,</tt> <tt class="py-name">force</tt><tt class="py-op">=</tt><tt class="py-name">force</tt><tt class="py-op">)</tt> </tt>
<a name="L862"></a><tt class="py-lineno">862</tt>  <tt class="py-line"> </tt>
<a name="L863"></a><tt class="py-lineno">863</tt>  <tt class="py-line">    <tt class="py-comment"># Write the structures.</tt> </tt>
<a name="L864"></a><tt class="py-lineno">864</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-380" class="py-name"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-380', 'structure', 'link-20');">structure</a></tt><tt class="py-op">.</tt><tt id="link-381" class="py-name" targets="Method generic_fns.structure.api_base.Base_struct_API.write_pdb()=generic_fns.structure.api_base.Base_struct_API-class.html#write_pdb,Method generic_fns.structure.internal.Internal.write_pdb()=generic_fns.structure.internal.Internal-class.html#write_pdb,Function generic_fns.structure.main.write_pdb()=generic_fns.structure.main-module.html#write_pdb,Method gui.user_functions.structure.Structure.write_pdb()=gui.user_functions.structure.Structure-class.html#write_pdb,Method prompt.structure.Structure.write_pdb()=prompt.structure.Structure-class.html#write_pdb"><a title="generic_fns.structure.api_base.Base_struct_API.write_pdb
generic_fns.structure.internal.Internal.write_pdb
generic_fns.structure.main.write_pdb
gui.user_functions.structure.Structure.write_pdb
prompt.structure.Structure.write_pdb" class="py-name" href="#" onclick="return doclink('link-381', 'write_pdb', 'link-381');">write_pdb</a></tt><tt class="py-op">(</tt><tt id="link-382" class="py-name"><a title="dep_check.file" class="py-name" href="#" onclick="return doclink('link-382', 'file', 'link-188');">file</a></tt><tt class="py-op">,</tt> <tt class="py-name">model_num</tt><tt class="py-op">=</tt><tt class="py-name">model_num</tt><tt class="py-op">)</tt> </tt>
</div><a name="L865"></a><tt class="py-lineno">865</tt>  <tt class="py-line"> </tt><script type="text/javascript">
<!--
expandto(location.href);
// -->
</script>
</pre>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://www.nmr-relax.com">relax</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Wed Apr 10 13:32:57 2013
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
