<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: r23074 &#45; /trunk/test_suite/system_tests/scripts/relax_disp/cpmg_synthetic.py -->
<!--X-From-R13: "Sqjneq q'Ohiretar" &#60;rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Thu, 08 May 2014 10:47:21 +0200 -->
<!--X-Message-Id: CAED9pY9A+pCAcfWTM55zb3Hwzej3fJwt5+5fxuu_QmmfkQaOOw@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: E1WiCRc&#45;0006DF&#45;Tj@subversion.gna.org -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: r23074 - /trunk/test_suite/system_tests/scripts/relax_disp/cpmg_synthetic.py -- May 08, 2014 - 10:47</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: r23074 - /trunk/test_suite/system_tests/scripts/relax_disp/cpmg_synthetic.py</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00222" class="tabs">Index by Date</a> | <a href="threads.html#00222" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00221.html">Date Prev</a>] [<a href="msg00223.html">Date Next</a>] [<a href="msg00215.html">Thread Prev</a>] [<a href="msg00224.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Thu, 8 May 2014 10:46:30 +0200</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113; h=mime-version:sender:in-reply-to:references:date:message-id:subject :from:to:content-type; bh=oY4zkpb9647tFcy3xQuanBbgDmSd4ZD/hHu1S6LoG6E=; b=L5NjHE38yX8JQZBxgh5uNyEnmBiEe70YigrB0LOYPi0vl/UR0SuQrmNLCsw9RIJqo2 RPJHn0+5VW/jN/wHP5N11UAR6dqNBrqJFf37us9/R6KoZ1/b8mt8VWabLjlHJrTVvRfP dHNjUt4wcdr5sExEPBWE90Ai+Gw+XhpphYHofsJlEWkIhAeP9kUPcDjyGwI7HJFo47iC TjZtcCubFolWxEViFns90Rxcw8FHnPp9PRrWTW0M0D0yy1yTqFsNyvOlbJjaWuWdJJ9H t0rH7ezthBVdCqO8JR2Cmh35V7lyOCTBirYtUJ36aoO5bDHa2EJV9R9eGiTIdC4eglqP ms2g==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00222.html">CAED9pY9A+pCAcfWTM55zb3Hwzej3fJwt5+5fxuu_QmmfkQaOOw@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;E1WiCRc-0006DF-Tj@subversion.gna.org&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on May 08, 2014 - 10:47:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi Troels,

If you add this OpenDX mapping functionally to a new system test -
which would be awesome as it is not currently tested - then you might
want to set ds.dx_inc to 2 or 3.  Keeping the tests as fast as
possible would be the goal.  You can not load the files into OpenDX to
check them in the system test, but you can check for their exact
contents.

Cheers,

Edward



On 8 May 2014 02:44,  &lt;tlinnet@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Author: tlinnet
Date: Thu May  8 02:44:16 2014
New Revision: 23074

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=23074&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=23074&amp;view=rev</a>
Log:
Fix for script for the visualising the spin dynamics point which generated 
the data.

This is to the script, which can visualize the synthetic CPMG data.

sr #3154: (<a  rel="nofollow" href="https://gna.org/support/?3154">https://gna.org/support/?3154</a>) Implementation of Baldwin (2014) 
B14 model - 2-site exact solution model for all time scales.

This follows the tutorial for adding relaxation dispersion models at:
<a  rel="nofollow" href="http://wiki.nmr-relax.com/Tutorial_for_adding_relaxation_dispersion_models_to_relax#Debugging">http://wiki.nmr-relax.com/Tutorial_for_adding_relaxation_dispersion_models_to_relax#Debugging</a>

Modified:
    trunk/test_suite/system_tests/scripts/relax_disp/cpmg_synthetic.py

Modified: trunk/test_suite/system_tests/scripts/relax_disp/cpmg_synthetic.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/test_suite/system_tests/scripts/relax_disp/cpmg_synthetic.py?rev=23074&amp;r1=23073&amp;r2=23074&amp;view=diff">http://svn.gna.org/viewcvs/relax/trunk/test_suite/system_tests/scripts/relax_disp/cpmg_synthetic.py?rev=23074&amp;r1=23073&amp;r2=23074&amp;view=diff</a>
==============================================================================
--- trunk/test_suite/system_tests/scripts/relax_disp/cpmg_synthetic.py  
(original)
+++ trunk/test_suite/system_tests/scripts/relax_disp/cpmg_synthetic.py  Thu 
May  8 02:44:16 2014
@@ -1,3 +1,23 @@
+###############################################################################
+#                                                                          
   #
+# Copyright (C) 2013-2014 Troels E. Linnet                                 
   #
+#                                                                          
   #
+# This file is part of the program relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>).       
   #
+#                                                                          
   #
+# This program is free software: you can redistribute it and/or modify     
   #
+# it under the terms of the GNU General Public License as published by     
   #
+# the Free Software Foundation, either version 3 of the License, or        
   #
+# (at your option) any later version.                                      
   #
+#                                                                          
   #
+# This program is distributed in the hope that it will be useful,          
   #
+# but WITHOUT ANY WARRANTY; without even the implied warranty of           
   #
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the            
   #
+# GNU General Public License for more details.                             
   #
+#                                                                          
   #
+# You should have received a copy of the GNU General Public License        
   #
+# along with this program.  If not, see &lt;<a  rel="nofollow" href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>&gt;.    
   #
+#                                                                          
   #
+###############################################################################
 # Script for calculating synthetics CPMG data.

 # Python module imports.
@@ -147,7 +167,7 @@
     ds.opendx = True

 if not hasattr(ds, 'dx_inc'):
-    ds.dx_inc = 70
+    ds.dx_inc = 50

 # The set r2eff err.
 if not hasattr(ds, 'r2eff_err'):
@@ -311,20 +331,34 @@
 if ds.opendx:
     # First switch pipe, since dx.map will go through parameters and end 
up a &quot;bad&quot; place. :-)
     pipe_name_MODEL_MAP = &quot;%s_%s_map&quot;%(pipe_name, model_analyse)
-    pipe.copy(pipe_from=pipe_name_r2eff, pipe_to=pipe_name_MODEL_MAP, 
bundle_to = pipe_bundle)
+    pipe.copy(pipe_from=pipe_name, pipe_to=pipe_name_MODEL_MAP, bundle_to 
= pipe_bundle)
     pipe.switch(pipe_name=pipe_name_MODEL_MAP)

+    # Copy R2eff, but not the original parameters
+    value.copy(pipe_from=pipe_name_r2eff, pipe_to=pipe_name_MODEL_MAP, 
param='r2eff')
+
+    # Then select model.
+    relax_disp.select_model(model=model_analyse)
+
+    # Define dx parameters
     dx_params = ['dw', 'pA', 'kex']
-    for cur_spin, mol_name, resi, resn, spin_id in 
spin_loop(full_info=True, return_id=True, skip_desel=True):
-        cur_spin_id = spin_id
+    for res_name, res_num, spin_name, params in cur_spins:
+        cur_spin_id = &quot;:%i@%s&quot;%(res_num, spin_name)
+        cur_spin = return_spin(cur_spin_id)
         dx_point = []
+
+        # Now get the parameters.
         for dx_param in dx_params:
-            set_val = getattr(cur_spin, dx_param)
-            dx_point.append( set_val )
-
+            set_value = float(params[dx_param ])
+            dx_point.append(set_value)
+
+        print(&quot;Params for dx map is&quot;)
+        print(dx_params)
+        print(&quot;Point param for dx map is&quot;)
+        print(dx_point)
         file_name_map = &quot;map%s&quot; % (cur_spin_id .replace('#', 
'_').replace(':', '_').replace('@', '_'))
         file_name_point = &quot;point%s&quot; % (cur_spin_id .replace('#', 
'_').replace(':', '_').replace('@', '_'))
-        dx.map(params=dx_params, map_type='Iso3D', spin_id=&quot;:1@N&quot;, 
inc=ds.dx_inc, lower=None, upper=None, axis_incs=5, 
file_prefix=file_name_map, dir=ds.resdir, point=dx_point, 
point_file=file_name_point, remap=None)
+        dx.map(params=dx_params, map_type='Iso3D', spin_id=cur_spin_id, 
inc=ds.dx_inc, lower=None, upper=None, axis_incs=5, 
file_prefix=file_name_map, dir=ds.resdir, point=dx_point, 
point_file=file_name_point, remap=None)
         #vp_exec:  A flag specifying whether to execute the visual program 
automatically at start-up.
         #dx.execute(file_prefix=file_name, dir=ds.resdir, dx_exe='dx', 
vp_exec=True)



_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-commits mailing list
relax-commits@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-commits">https://mail.gna.org/listinfo/relax-commits</a>
</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu May 08 11:00:11 2014</div>  
</body>
</html>
