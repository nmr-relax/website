<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: Redesign of the relax data model: 2. A new run concept -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneq.qnhiretarNtznvy.pbz> -->
<!--X-Date: Tue, 16 Jan 2007 15:54:33 +0100 -->
<!--X-Message-Id: 7f080ed10701160653k48038558ve891cfa7e9061eef@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: f001463a0701071314i61276e67hde685fe3afb8fe42@mail.gmail.com -->
<!--X-Reference: 7f080ed10701142244ne7d107bl84582ce604d1888e@mail.gmail.com -->
<!--X-Reference: 1168873580.7569.449.camel@mrspell -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Redesign of the relax data model: 2. A new run concept -- January 16, 2007 - 15:54</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Redesign of the relax data model: 2. A new run concept</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00037" class="tabs">Index by Date</a> | <a href="threads.html#00037" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00036.html">Date Prev</a>] [<a href="msg00038.html">Date Next</a>] [<a href="msg00035.html">Thread Prev</a>] [<a href="msg00038.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Chris MacRaild&quot; &lt;c.a.macraild@xxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Wed, 17 Jan 2007 01:53:42 +1100</li>
<li class="menuitem">
<em>Cc</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00037.html">7f080ed10701160653k48038558ve891cfa7e9061eef@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;<a href="msg00013.html">f001463a0701071314i61276e67hde685fe3afb8fe42@mail.gmail.com</a>&gt;	&lt;<a href="msg00029.html">7f080ed10701142244ne7d107bl84582ce604d1888e@mail.gmail.com</a>&gt;	&lt;<a href="msg00035.html">1168873580.7569.449.camel@mrspell</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on January 16, 2007 - 15:54:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<tt>On 1/16/07, Chris MacRaild &lt;c.a.macraild@xxxxxxxxxxx&gt; wrote:
</tt><blockquote class="blockquote"><pre style="margin: 0em;">On Mon, 2007-01-15 at 17:44 +1100, Edward d'Auvergne wrote:</pre><br>
<pre style="margin: 0em;">[snip]</pre><br>
<pre style="margin: 0em;">&gt; &gt; Some asides
&gt; &gt;
&gt; &gt; A.  I believe the runs that are passed around in relax are strings
&gt; &gt; which are then used to lookup data in a map. Why not just have
&gt; &gt; (runs/pipes) as objects... Then for example the call
&gt; &gt;
&gt; &gt; self.relax.data[self.relax.run]
&gt; &gt;
&gt; &gt; above becomes
&gt; &gt;
&gt; &gt; self.relax.run.data a much more object orientated and encapsulated
&gt; structure
&gt;
&gt; You still need a list (array) or dictionary (hash) type structure to
&gt; store multiple run objects.  'self.relax.data' would be a dictionary
&gt; type object with key-value pairs, the key being the run name and the
&gt; value being a standard class instance object containing all the data
&gt; associated with the run as objects.  The dictionary would be more
&gt; logical than an array in this case.
&gt;</pre><br>
<pre style="margin: 0em;">The issue here is whether the user and/or developer should be dealing
with a run name (a string) or the run object itself. Currently the user
creates a new run with:</pre><br>
<pre style="margin: 0em;">run.create(run_name, run_type)</pre><br>
<pre style="margin: 0em;">and then uses the string, run_name, to address the object. In this
idiom, a dictionary of runs is clearly an appropriate structure.</pre><br>
<pre style="margin: 0em;">Alternatively, we could have the user create a run with:</pre><br>
<pre style="margin: 0em;">my_run = run.create(run_type)</pre><br>
<pre style="margin: 0em;">Then the user has the run as an object, which they can make current or
pass to relax commands as required. In this idiom, a dictionary of runs
is an unnecessary abstraction.
</pre></blockquote><pre style="margin: 0em;"><br>You have mentioned the run object idea before, although I can't find
your post on the subject.</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">Currently, the relax interface is entirely script orientated, not object
orientated, so the alternative above is a fairly fundamental change in
interface design.</pre><br>
<pre style="margin: 0em;">I don't favour an object orientated user interface, because oo tends to
be fairly intimdating to non-programmers. On the other hand, the relax
code-base could benefit from being more object orientated. So I propose
the following arrangement:
</pre></blockquote><pre style="margin: 0em;"><br>I have thought of your idea quite a bit, but am of the same opinion as
that stated in your above paragraph.  The idea of having the run
objects as things that the user has at their fingertips to manipulate,
pass to functions, etc is quite powerful.  However it does add
significant complexity to the prompt/script UI.  I can clearly see the
idea embedded in a GUI design though whereby the data pipe (previously
called a run) is represented as a physical object (either in 2D or 3D)
which can be manipulated and the user functions applied to.</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">all runs are stored in a dictionary, keyed by run name, but only the
run-selection machinery should access this dictionary. The current run
should be the object self.relax.data.run (or something simiar), and all
relax functions should operate on that object.
</pre></blockquote><pre style="margin: 0em;"><br>I agree, however I would extend this using the global variable ideas
Gary proposed (<a  href="https://mail.gna.org/public/relax-devel/2007-01/msg00013.html">https://mail.gna.org/public/relax-devel/2007-01/msg00013.html</a>,
Message-id: &lt;f001463a0701071314i61276e67hde685fe3afb8fe42@xxxxxxxxxxxxxx&gt;).
So instead of using 'self.relax.data.run' the data container of the
current run, which is located in the dictionary type object
'self.relax.data[]', could be aliased as say 'data_pipe' or
'current_pipe' and placed into '__builtin__'.  Then any part of relax
can access the data of the current data pipe by referring directly to
'current_pipe'.  Maybe a better variable name would be 'cdp' (current
data pipe)?  Or maybe simply 'data'?</pre><br>
<pre style="margin: 0em;">In addition, I don't believe the name 'run' encapsulates the concept
at all.  This name is a relic which is not at all related to its
current use (<a  href="https://mail.gna.org/public/relax-devel/2006-10/msg00056.html">https://mail.gna.org/public/relax-devel/2006-10/msg00056.html</a>,
Message-id: &lt;1160555137.9523.70.camel@xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&gt;).
The current use of the name 'run' encapsulates the segregation of the
data.  This is why I prefer the words 'data pipe' or 'pipe' over
'run'.</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">Thus we would have user functions:</pre><br>
<pre style="margin: 0em;">run.create(run_name, run_type):
    self.relax._runs[run_name] = new_run(run_type)
</pre></blockquote><pre style="margin: 0em;"><br>The 'new_run' would be an empty data container (a class instance) and
the data pipe type would be a simple string variable inside this
container.  Hence:</pre><br>
<pre style="margin: 0em;">pipe.create(pipe_name, pipe_type):
   self.relax.data[pipe_name] = PipeContainer(pipe_type)</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">run.make_current(run_name):
    self.relax.data.run = self.relax._runs[run_name]
</pre></blockquote><pre style="margin: 0em;"><br>I see the word 'switch' is a little more direct than 'make_current',
although there may be even better alternatives.  What do you think
Chris?</pre><br>
<pre style="margin: 0em;">pipe.switch(pipe_name):
   __builtin__.current_pipe = self.relax.data[pipe_name]</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">run.current():
    return self.relax.data.run.name
</pre></blockquote><pre style="margin: 0em;"><br>pipe.current():
   return current_pipe.name</pre><br>
<pre style="margin: 0em;">Having the name stored in the dictionary as a key and in the data pipe
container as the 'name' variable is a little redundant.  Maybe the
current pipe name should be stored as say 'self.relax.current_pipe'?</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">run.run_names():
    return self.relax._runs.keys()
</pre></blockquote><pre style="margin: 0em;"><br>pipe.display():
   print &quot;%20s%20s&quot; % ('Data pipe name', 'Data pipe type')
   for key in self.relax.data:
       print &quot;%20s%20s&quot; % (key, self.relax.data[key].pipe_type)</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">run.delete(run_name):
    if run.current() == run_name:
        self.relax.data.run = None
    del self.relax._runs[run_name]
</pre></blockquote><pre style="margin: 0em;"><br>pipe.delete(pipe_name):
   if self.relax.current_pipe == pipe_name:
       __builtin__.data = None
   del self.relax.data[pipe_name]</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">run.delete_all():
    self.relax.data.run = None
    self.relax._runs = {}
</pre></blockquote><pre style="margin: 0em;"><br>pipe.delete_all():
   __builtin__.current_pipe = None
   self.relax.data = PipeDictionary()</pre><br>
<pre style="margin: 0em;">The point of 'PipeDictionary()' rather than {} is because many of the
objects in 'self.relax.data' are special.  They have their
'__repr__()' methods modified so that when you type the object name at
the prompt, you get a formatted printout rather than something like:</pre><br>
<pre style="margin: 0em;">&lt;__main__.Data instance at 0xb764732c&gt;</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">This way the abstraction of the dictionary of runs is cleanly hidden
from the developer who chooses to work with objects, but the scripting
style of the user interface is maintained.
</pre></blockquote><pre style="margin: 0em;"><br>Don't forget that the dictionary type 'self.relax.data' is an object,
as are the values corresponding to its keys - the data pipe
containers.  In Python, essentially everything is an object.</pre><br>
<pre style="margin: 0em;">Edward</pre><br>
<br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00038" href="msg00038.html">Re: Redesign of the relax data model: 2. A new run concept</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00013" href="msg00013.html">re: Redesign of the relax data model: 2. A new run concept</a></strong>
<ul><li><em>From:</em> gary thompson</li></ul></li>
<li><strong><a name="00029" href="msg00029.html">Re: Redesign of the relax data model: 2. A new run concept</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00035" href="msg00035.html">Re: Redesign of the relax data model: 2. A new run concept</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Tue Jan 16 17:20:22 2007</div>  
</body>
</html>
