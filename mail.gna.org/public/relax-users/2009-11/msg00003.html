<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: MF_Multimodel -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Sat, 28 Nov 2009 21:33:44 +0100 -->
<!--X-Message-Id: 7f080ed10911281233h20ee4432u4ac723561c251418@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20091005161313.f3715bbf@mail.ccrc.uga.edu -->
<!--X-Reference: 7f080ed10910060031l7b095e79q9d804bdebbe23204@mail.gmail.com -->
<!--X-Reference: 12A9D1A2CF9D4536985EA794893504B7@Mercurio -->
<!--X-Reference: D4A2FB2CF9A04EF28BC6DB4A3EC37A47@Mercurio -->
<!--X-Reference: 4ADF56D6.6080306@ulaval.ca -->
<!--X-Reference: E45CDDF4A4E54B34A36BFBA62E6BFF20@Mercurio -->
<!--X-Reference: 7f080ed10910270301r6ca3c685t4a968772140996dd@mail.gmail.com -->
<!--X-Reference: 15191092434C4019967C0DB927625E5F@Mercurio -->
<!--X-Reference: 7f080ed10910280550n63c235cdxe170a471843de554@mail.gmail.com -->
<!--X-Reference: AF0E494FAE984C0BB8D4C8CE521D621D@Mercurio -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: MF_Multimodel -- November 28, 2009 - 21:33</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: MF_Multimodel</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00003" class="tabs">Index by Date</a> | <a href="threads.html#00003" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00002.html">Date Prev</a>] [<a href="msg00004.html">Date Next</a>] [<a href="msg00002.html">Thread Prev</a>] [<a href="msg00004.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Tiago Pais &lt;tpais@xxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Sat, 28 Nov 2009 21:33:35 +0100</li>
<li class="menuitem">
<em>Cc</em>: relax-users@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00003.html">7f080ed10911281233h20ee4432u4ac723561c251418@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;20091005161313.f3715bbf@xxxxxxxxxxxxxxxxx&gt;	&lt;7f080ed10910060031l7b095e79q9d804bdebbe23204@xxxxxxxxxxxxxx&gt;	&lt;12A9D1A2CF9D4536985EA794893504B7@Mercurio&gt;	&lt;D4A2FB2CF9A04EF28BC6DB4A3EC37A47@Mercurio&gt;	&lt;4ADF56D6.6080306@xxxxxxxxx&gt;	&lt;E45CDDF4A4E54B34A36BFBA62E6BFF20@Mercurio&gt;	&lt;7f080ed10910270301r6ca3c685t4a968772140996dd@xxxxxxxxxxxxxx&gt;	&lt;15191092434C4019967C0DB927625E5F@Mercurio&gt;	&lt;7f080ed10910280550n63c235cdxe170a471843de554@xxxxxxxxxxxxxx&gt;	&lt;<a href="msg00002.html">AF0E494FAE984C0BB8D4C8CE521D621D@Mercurio</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on November 28, 2009 - 21:33:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">2009/11/28 Tiago Pais &lt;tpais@xxxxxxxxxxx&gt;:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Well, I am getting a bit frustrated with all this.
</pre></blockquote><pre style="margin: 0em;">

Hi,

I'm sorry to hear this.  I'll try to help you below.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">I am trying to run the mf_multimodel script just to make the model selection
and the determination of S2 values.
I want the diffusion tensor parameters to be fixed since I have calculated
them before using another program - I am using a rhombic model and 15N
relaxation data at one field only. My idea is to compare the results
obtained with Relax and this other program that I have used before
(Tensor2).
</pre></blockquote><pre style="margin: 0em;">

First note that both I and in Art Palmer's works, we recommend
multiple iterations of optimising the model-free models, model
selection, and then optimising the diffusion tensor.  The reason is
because the initial estimate is usually not exactly what is happening
in the NMR tube.  This is quite important.  Another problem is that
there are so many different ways of specifying the tensor, and most
programs that can calculate a tensor don't give you enough information
for fully defining the thing.  E.g.  Blackledge's Tensor program and
Art Palmer's Modelfree program use different definitions for the
spherical angles for the spheroids and Euler angles for the ellipsoids
(good luck finding these).  Therefore with the iterative procedure,
you can watch the tensor rotate to the correct position.  Unless you
know the Euler angle convention, exactly how the geometric parameters
are defined (Da, Dr, R, etc.), what the spherical angle convention is
(i.e. on which axis is the azimuthal angle zero), if the polar angle
is defined between -pi/2 -&gt; pi/2 or 0 -&gt; pi, etc., you cannot take a
tensor from one program and use it in another.  This approach will
fail.

The mf_multimodel.py script is only a short, old script used to build
something more complex with iterative optimisation.  It should be
combined with model-free model selection (like in modsel.py), and then
diffusion tensor optimisation.  Finally this should be repeated until
the diffusion tensor stops moving.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">

Problems:
1s- Program does not recognize atoms HZ and HH in the pdb. Found out that
probably should be using HT when looking at the internal.py - Solved
</pre></blockquote><pre style="margin: 0em;">

Here you have the choice of 2 PDB readers - the one that comes with
Scientific python and a very basic internal one I wrote myself (as
Scientific python is horrible for small organic molecules).  If the
internal one doesn't work, Scientific might.  PDB readers are complex
beasts though, as the PDB format is highly abused.

I've now added 'HZ' and 'HH' to the internal reader
(<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/1.3/generic_fns/structure/internal.py?rev=10010&amp;view=log">http://svn.gna.org/viewcvs/relax/1.3/generic_fns/structure/internal.py?rev=10010&amp;view=log</a>),
but this is only used to determine that they are protons.  These lists
are far from complete.  Note that the element symbol should be in the
PDB file at positions 77-78 of the line.  If not, then the PDB reader
has to start guessing what the element is - therein lies the problem!

Note that you can specify what the isotope is using the value.set()
user function.  The exact element is, from memory, only used when
calculating the centre of mass, so I don't think this is very
important for what you are calculating.  It really depends what you
are doing here.  HH appears only to be the hydroxyl proton in Tyr and
the terminal NH2 protons in Arg.  HZ is attached to CZ in Phe, the
terminal NH3 protons in Lys, and protons attached to carbons in Trp.
Are you measuring NH2 and NH3 relaxation?  If so, which theories would
you like to use to interpret the data?


</pre><blockquote class="blockquote"><pre style="margin: 0em;">2nd-Program has some issue with the CONECT lines of the pdb file. Although I
have checked in internal.py file that the format is the one described there
-Ended up removing all lines with CONECT in the pdb (I know it is bad but I
was just trying to put the thing running)
</pre></blockquote><pre style="margin: 0em;">

The Scientific python reader, like Molmol, thinks that you don't know
what you are talking about when you supply it with a molecule with
CONECT records, that you must be wrong, and then tries to go and
invent its own atomic connections!!!  The internal reader accepts
these CONECT records perfectly.  An easy test is to read in the PDB
file with CONECT records with the internal reader and then write it
out again.  They should be preserved.  If not, this is a bug which can
be reported at <a  rel="nofollow" href="https://gna.org/bugs/?func=additem&amp;group=relax">https://gna.org/bugs/?func=additem&amp;group=relax</a> which I
can then repair.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">3rd- mf_multimodel complains about seting the &quot;fixed&quot; parameter of the
tensor settings to &quot;True&quot; so I changed it to False to let the tensor to be
optimized - the script now runs until the end
</pre></blockquote><pre style="margin: 0em;">

Can you make a bug report for this?  This should be allowed - and if
not it is a bug.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">4th- The result files are empty, that is, they don't have any information
other than the one I have provided for the tensor (although I can't see the
Euler angle values). The S2 fields are all showing &quot;none&quot;.
</pre></blockquote><pre style="margin: 0em;">

This could be related to point 3 above.  Did you see any optimisation
when running the script?  Were there any RelaxWarning messages anyway
through the analysis?  My guess is that you will have a warning
because something was not exactly right with the script.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">Any idea what the problem is? Is there another way to visualize the XML
result files other than the almost raw tree format? This is not at all
practical, global visualization is impossible and I cant import the results
to an excel file. I have tried Michaels' script, final_data_extraction, but
got stuck with an error about &quot;spin_id&quot;.
</pre></blockquote><pre style="margin: 0em;">

There are a series of *.display() user functions that can be used to
see individual values.  E.g. value.display() and
diffusion_tensor.display().  The XML version is for data storage, and
not designed for being a compact representation of the data.  It is
human readable though, just not the most efficient way to see the data
using human eyes.  You can also use value.write() if you would like
the individual data dumped into a file.  More powerful methods exist
if you know a bit of scripting - using the relax supplied spin_loop()
construct but this is not necessary (if you are interested, have a
look at the latex_mf_table.py script for inspiration).


</pre><blockquote class="blockquote"><pre style="margin: 0em;">Sorry for the long text, but I am really close to solve some analysis issues
and I am getting stuck with this little annoying things!
If anyone could help I would be most greatfull.
</pre></blockquote><pre style="margin: 0em;">

I hope my answers have helped a little.  Please don't hesitate to ask
if anything was unclear or if other issues arise.

Cheers,

Edward


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00004" href="msg00004.html">Re: MF_Multimodel</a></strong>
<ul><li><em>From:</em> tpais</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00002" href="msg00002.html">MF_Multimodel</a></strong>
<ul><li><em>From:</em> Tiago Pais</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Sun Nov 29 20:40:48 2009</div>  
</body>
</html>
