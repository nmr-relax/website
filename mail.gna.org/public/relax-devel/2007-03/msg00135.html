<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: how to parallelise model_free minimise -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneq.qnhiretarNtznvy.pbz> -->
<!--X-Date: Tue, 27 Mar 2007 17:01:53 +0200 -->
<!--X-Message-Id: 7f080ed10703270801r3b875da4i6940031727653b10@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 7f080ed10703191030h79036e06w56912aa1d9130f48@mail.gmail.com -->
<!--X-Reference: 45FFEC5C.7060205@bmb.leeds.ac.uk -->
<!--X-Reference: 7f080ed10703200727l5fad8e72if4cf9aff74bc21@mail.gmail.com -->
<!--X-Reference: 45FFF714.7070903@bmb.leeds.ac.uk -->
<!--X-Reference: 7f080ed10703200813x323ec212l471796641855a7ff@mail.gmail.com -->
<!--X-Reference: 4603EA08.60801@bmb.leeds.ac.uk -->
<!--X-Reference: 7f080ed10703252217x7db43e6bxfe7324ad0379c778@mail.gmail.com -->
<!--X-Reference: 4607F0AB.6000807@bmb.leeds.ac.uk -->
<!--X-Reference: 7f080ed10703261026l4d783b65o1e34f01315a95024@mail.gmail.com -->
<!--X-Reference: f001463a0703270020w381abf44t28eff5cd19b466a4@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: how to parallelise model_free minimise -- March 27, 2007 - 17:01</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: how to parallelise model_free minimise</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00135" class="tabs">Index by Date</a> | <a href="threads.html#00135" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00134.html">Date Prev</a>] [<a href="msg00136.html">Date Next</a>] [<a href="msg00132.html">Thread Prev</a>] [<a href="msg00140.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;gary thompson&quot; &lt;garyt@xxxxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Wed, 28 Mar 2007 01:01:09 +1000</li>
<li class="menuitem">
<em>Cc</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Dkim-signature</em>: a=rsa-sha1; c=relaxed/relaxed; d=gmail.com; s=beta;	h=domainkey-signature:received:received:message-id:date:from:to:subject:cc:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;	b=sV3dDjW5uYpasE8sLQVZtYyn2wip+b22mh8iNNMpu64OzlPZxFfEW/AtJ5/LY6tzgocrGTrCdtdOT+3K0gtczpbDMUpyzyQwPI/4tNOSJ40a3gg7mgVH2b6DF3attXoiqBr2YFB5WTjYQ6uyM9r2JI5Fpp94wsfdLrqAX5ms3gY=</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00135.html">7f080ed10703270801r3b875da4i6940031727653b10@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;<a href="msg00092.html">7f080ed10703191030h79036e06w56912aa1d9130f48@mail.gmail.com</a>&gt;	&lt;<a href="msg00107.html">45FFEC5C.7060205@bmb.leeds.ac.uk</a>&gt;	&lt;<a href="msg00110.html">7f080ed10703200727l5fad8e72if4cf9aff74bc21@mail.gmail.com</a>&gt;	&lt;<a href="msg00112.html">45FFF714.7070903@bmb.leeds.ac.uk</a>&gt;	&lt;<a href="msg00114.html">7f080ed10703200813x323ec212l471796641855a7ff@mail.gmail.com</a>&gt;	&lt;<a href="msg00124.html">4603EA08.60801@bmb.leeds.ac.uk</a>&gt;	&lt;<a href="msg00126.html">7f080ed10703252217x7db43e6bxfe7324ad0379c778@mail.gmail.com</a>&gt;	&lt;<a href="msg00128.html">4607F0AB.6000807@bmb.leeds.ac.uk</a>&gt;	&lt;<a href="msg00130.html">7f080ed10703261026l4d783b65o1e34f01315a95024@mail.gmail.com</a>&gt;	&lt;<a href="msg00132.html">f001463a0703270020w381abf44t28eff5cd19b466a4@mail.gmail.com</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on March 27, 2007 - 17:01:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<tt>On 3/27/07, gary thompson &lt;garyt@xxxxxxxxxxxxxxx&gt; wrote:
</tt><blockquote class="blockquote"><pre style="margin: 0em;">On 3/26/07, Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt; wrote:
&gt; &gt; &gt;&gt; i.e for six residues and 3 nodes
&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt; node 1 calculates
&gt; &gt; &gt;&gt; res 1 [m1 m2 m3...]
&gt; &gt; &gt;&gt; res 2 [[m1 m2 m3..]
&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt; node 2 calculates
&gt; &gt; &gt;&gt; res 3 [m1 m2 m3...]
&gt; &gt; &gt;&gt; res 4 [[m1 m2 m3..]
&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt; node 3 calculates
&gt; &gt; &gt;&gt; res 5 [m1 m2 m3...]
&gt; &gt; &gt;&gt; res 6 [[m1 m2 m3..]
&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt; this obviously places some limitations of the design of the
&gt; &gt; &gt;&gt; minimisation function as it might needs to have a set and tear down
&gt; &gt; &gt;&gt; region that cope with this batched data....
&gt; &gt; &gt;
&gt; &gt; &gt; The minimise() main loop is the finest grain parallelisation you can
&gt; &gt; &gt; get without writing a specific parallelised optimisation algorithm.
&gt; &gt; &gt;
&gt; &gt;
&gt; &gt; actually what i was aiming for was as coarse grained and well load
&gt; &gt; balanced a set of calculations as possible (i.e. minimum of
&gt; &gt; communication overhead (i.e. bigger chunks of data with similar
&gt; &gt; computations times going over the wire))
&gt;
&gt; The coarse grained target of the looping over data pipes, which the
&gt; user must specifically ask for, will limit the number of active nodes
&gt; to the number of data pipes, which could be a specific list of
&gt; model-free models (assuming this is the only target).  The next level
&gt; is the main loop over the minimisation instances.  Finally, the finest
&gt; grain is from the parallelised grid search of grid searches (as
&gt; discussed in the thread starting at
&gt; <a  href="/mail.gna.org/public/relax-devel/2007-03/msg00088.html">https://mail.gna.org/public/relax-devel/2007-03/msg00088.html</a>,
&gt; Message-id: &lt;45FEAC46.8020307@xxxxxxxxxxxxxxx&gt;).  Can you see anything
&gt; else which could be targeted for parallelisation?
&gt;
no see above if you combine the calculations from the various models
with those by spin etc you get the largest number of calculations that
need/can to be carried out together...
</pre></blockquote><pre style="margin: 0em;"><br>The model-free minimisations for the different model-free models need
not be carried out together.  There is no efficiency gain there.  I
don't have any numbers because this was a long time ago, but I have
tested this approach out before.  Otherwise I would have designed the
relax UI to fit this approach.</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">&gt; &gt; just as another comment (or two)
&gt; &gt;
&gt; &gt; 1. why does do we send no arguments to the fucntions e.g.
&gt; &gt; -#-num_frq [2]
&gt; &gt; -#-frq [[750800000.0, 599.71900000000005]]
&gt;
&gt; Sorry, again I don't understand the question.  I'll try to answer it
&gt; anyway.  The num_frq value is used to deconvolute the 'remap_table',
&gt; 'frq', 'ri_labels', and 'relax_data'.  This can vary for different
&gt; spin systems.  The frequencies are essential for the calculation of
&gt; the spectral density values (and hence the chi-squared value).
&gt;</pre><br>
<pre style="margin: 0em;"><br>what is the difference between
num_frq
and the number of numbers in
frq [[750800000.0, 599.71900000000005]]
</pre></blockquote><pre style="margin: 0em;"><br>Nothing, it's historical baggage (with the added computational benefit
of not executing the len() builtin function during calculations).</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">&gt; &gt; 2. how does the data return from minimisation work (specifically why is
&gt; &gt; param_vector  a  instance vaiable of  Model_free
&gt; &gt; e.g. we have
&gt; &gt;
&gt; &gt; self.param_vector, self.func, iter, fc, gc, hc, self.warning = results
&gt; &gt;
&gt; &gt; ....
&gt; &gt;
&gt; &gt; # Disassemble the parameter vector.
&gt; &gt; self.disassemble_param_vector(index=index, sim_index=sim_index)
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; inside a tight loop. So even though self.param_vector is an instance
&gt; &gt; variable it doesn't contain state for a Model_free object it just keeps
&gt; &gt; being overwritten by the latest contents of the result
&gt; &gt;
&gt; &gt; so why not
&gt; &gt;
&gt; &gt; param_vector, self.func, iter, fc, gc, hc, self.warning = results
&gt; &gt;
&gt; &gt; ....
&gt; &gt;
&gt; &gt; # Disassemble the parameter vector.
&gt; &gt; self.disassemble_param_vector(param_vector, index=index,
&gt; &gt; sim_index=sim_index)
&gt;
&gt; Yes, this is probably how this should be done.  Grep for
&gt; 'self.param_vector' in 'specific_fns/model_free.py' to see why there
&gt; has been an inertia for me to make this change.  If necessary for the
&gt; MPI code, please try to minimise the number of changes to this setup
&gt; as possible.</pre><br>
<pre style="margin: 0em;">I will</pre><br>
<pre style="margin: 0em;">Sorry about the legacy code, but because of the nature
&gt; of the multi_processor branch you may need to work with it.</pre><br>
<pre style="margin: 0em;">of course, I have made my bed and (be it nails or feathers)  am having
a good go at lying in it!</pre><br>
<pre style="margin: 0em;">Hopefully
&gt; I'll have all these legacy issues completely removed in the 1.3 line
&gt; once the data model redesign is complete.  That being said, if you
&gt; need to, please feel free to make the above changes.
&gt;</pre><br>
<pre style="margin: 0em;">I don't need to change this ;-) it was more a question trying to
understand the way things are, ask the obvious question, and check
that I am not missing something deep...
</pre></blockquote><pre style="margin: 0em;"><br>I was planning on fixing all this up anyway.  I like clean, readable,
and simple code bases to allow anyone to dive straight into it.</pre><br>
<pre style="margin: 0em;">Regards,</pre><br>
<pre style="margin: 0em;">Edward</pre><br>
<br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00140" href="msg00140.html">Re: how to parallelise model_free minimise</a></strong>
<ul><li><em>From:</em> Gary S. Thompson</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00092" href="msg00092.html">relax and Grid computing.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00107" href="msg00107.html">Re: relax, MPI, and Grid computing.</a></strong>
<ul><li><em>From:</em> Gary S. Thompson</li></ul></li>
<li><strong><a name="00110" href="msg00110.html">Re: relax, MPI, and Grid computing.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00112" href="msg00112.html">Re: relax, MPI, and Grid computing.</a></strong>
<ul><li><em>From:</em> Gary S. Thompson</li></ul></li>
<li><strong><a name="00114" href="msg00114.html">Re: relax, MPI, and Grid computing.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00124" href="msg00124.html">how to parallelise model_free minimise</a></strong>
<ul><li><em>From:</em> Gary S. Thompson</li></ul></li>
<li><strong><a name="00126" href="msg00126.html">Re: how to parallelise model_free minimise</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00128" href="msg00128.html">Re: how to parallelise model_free minimise</a></strong>
<ul><li><em>From:</em> Gary S. Thompson</li></ul></li>
<li><strong><a name="00130" href="msg00130.html">Re: how to parallelise model_free minimise</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00132" href="msg00132.html">Re: how to parallelise model_free minimise</a></strong>
<ul><li><em>From:</em> gary thompson</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Tue Mar 27 18:23:13 2007</div>  
</body>
</html>
