<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: [bug #21599] allow import of nmr data from ccpn projects	(optionally also export) -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Mon, 10 Feb 2014 09:59:37 +0100 -->
<!--X-Message-Id: CAED9pY8_DsH7Am16X2681eYLWRXJ6YkEsXL62i5XobQaS1e6hw@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20140205&#45;102057.sv21202.18703@gna.org -->
<!--X-Reference: CAED9pY_N+jEcsRexwgpEuFTnK1fbijEEZcvjGkSsuL2M4PntZQ@mail.gmail.com -->
<!--X-Reference: 5BA4009B&#45;9BA2&#45;497F&#45;B94D&#45;72CF09DC0EBC@cam.ac.uk -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [bug #21599] allow import of nmr data from ccpn projects	(optionally also export) -- February 10, 2014 - 09:59</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: [bug #21599] allow import of nmr data from ccpn projects	(optionally also export)</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00031" class="tabs">Index by Date</a> | <a href="threads.html#00031" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00030.html">Date Prev</a>] [<a href="msg00032.html">Date Next</a>] [<a href="msg00022.html">Thread Prev</a>] [<a href="msg00021.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Wayne Boucher &lt;wb104@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Mon, 10 Feb 2014 09:59:06 +0100</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113;	h=mime-version:sender:in-reply-to:references:date:message-id:subject	:from:to:cc:content-type:content-transfer-encoding;	bh=AsG5xY5xRkIR24LaBiaDtAHzs59gQVt+IvMz98f0As0=;	b=eh7UibnXRfc9PECelMXE/5hinU6I37s+Mi3AoKcnp4X4RHoZkzboERNymUiYz0d8EF	5uQW/iFhlmW/vKM20x28GSoBcmoul5QJ5/e1R+XcadEykLQZvSNiMdmWuvC0+BkWH4kU	7WcvvPlw2dydNRk1YVCe+9UmHdGmulmuIXO2gxheCAZlKpXfUXMKE1KBWxQv1ynme9+c	nHpEPBEFHUN4N8TqUXdHikJ9tiRs75xci/wvA9ZIIrsCOMDWSrlK3Ew5Sid7y+/3MxXc	h4QoAU19QSp1pJPceMMmVmmSDcIuPLaO5qpTgtVZDqB8uIpu/s12Mj0ZfJBS7FmM6YqG	W3Og==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00031.html">CAED9pY8_DsH7Am16X2681eYLWRXJ6YkEsXL62i5XobQaS1e6hw@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;20140205-102057.sv21202.18703@xxxxxxx&gt;	&lt;CAED9pY_N+jEcsRexwgpEuFTnK1fbijEEZcvjGkSsuL2M4PntZQ@xxxxxxxxxxxxxx&gt;	&lt;5BA4009B-9BA2-497F-B94D-72CF09DC0EBC@xxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on February 10, 2014 - 09:59:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi Wayne,

Welcome to the relax mailing lists!  It would be great if you could
look into this.  You are most welcome to develop the code needed.
There is detailed information in the relax development chapter of the
manual explaining the steps required, the coding conventions, etc -
see <a  rel="nofollow" href="http://www.nmr-relax.com/manual/relax_development.html">http://www.nmr-relax.com/manual/relax_development.html</a> or
<a  rel="nofollow" href="http://download.gna.org/relax/manual/relax.pdf">http://download.gna.org/relax/manual/relax.pdf</a> (the PDF is of higher
quality).  I'll answer your points below:


</pre><blockquote class="blockquote"><pre style="margin: 0em;">Justin will have a suitable project.
</pre></blockquote><pre style="margin: 0em;">

This would be useful, as the first step to implementing anything in
relax is to create a 'system test'.  This would involve having a
hugely truncated data set sitting in the relax test_suite/shared_data/
directories.  One or more tests would be added to
test_suite/system_tests/ which would execute all of the desired relax
user functions and then check that the data has been correctly loaded.
 Finally the code is written to implement the CCPN data reading.  Once
the tests pass, then the implementation is complete.  All of this
would happen in a dedicated relax development branch.

The tests, when written well, also ensure that the feature will be
fully functional and bug free forever - or as long as the software
relax exists.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">I can help on the software side (although I'll need some input from Rasmus 
as well).
</pre></blockquote><pre style="margin: 0em;">

This would be great!  I have talked to Rasmus about the data model,
but this was in the context of replacing the relax data store with the
CCPN data model.  However this data model was deemed insufficient for
all the diverse needs of relax and it would restrain the relax
developers too much.  Also ripping out the heart of a large and
complex program and replacing it with something completely different
is probably not feasible.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">I assume that Relax doesn't want to ship CCPN code so likely there would 
need to be an environment variable to indicate where the CCPN code exists, 
if it exists.
</pre></blockquote><pre style="margin: 0em;">

There is probably no need to support the entirety of the CCPN data
model.  This also depends if the target would be the CCPN data model
itself or the output files from CCPN analysis.  For example support
for reading peak lists from CCPN analysis was planned to be
implemented, see the files in
test_suite/shared_data/peak_lists/ccpn_analysis/ and
<a  rel="nofollow" href="https://gna.org/bugs/?17341">https://gna.org/bugs/?17341</a> (however this did not happen).

Note that small parts of the CCPN code could be shipped with relax to
support fragments of the data model.  The code could go into the
extern/ relax package, and include the text of
<a  rel="nofollow" href="https://www.gnu.org/licenses/lgpl-2.1.html">https://www.gnu.org/licenses/lgpl-2.1.html</a> in the COPYING file.  It is
ok to distribute LGPL v2.1+ libraries with relax (which itself is GPL
v3+).  The extern.sobol package is itself LGPL licenced.


</pre><blockquote class="blockquote"><pre style="margin: 0em;"> We use an environment variable CCPNMR_TOP_DIR to indicate where the 
top-level CCPN directory is, but we don't set it globally (e.g. in .cshrc 
or .bashrc) but instead it is set in a script that you run when you want to 
run the program.  But that doesn't mean it couldn't be set globally by 
someone who wants to use Relax + CCPN.  The relevant directory to add to 
the PYTHONPATH is then CCPNMR_TOP_DIR + '/ccpnmrX.Y/python', where X.Y = 
major.minor release.  Possibly we should just assume that that directory 
has been added to the PYTHONPATH so the imports then work, and if the 
imports don't work then there is no CCPN code (!).
</pre></blockquote><pre style="margin: 0em;">

In relax, no environmental variables are used at the moment.
Environmental variables tend to cause Mac OS X and MS Windows users to
freak out.  The best way to do this, and the way it is currently done,
would be for the user to point to the CCPNMR_TOP_DIR when calling the
user function.  The path would either be hardcoded in the user's
scripts, or they manually select it from the GUI.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">Loading CCPN projects is one line of code so I can help with that.  The one 
issue that arises is how to pick out the data the user wants to use in 
Relax, and any other parameters that need setting.  Rasmus is working on a 
similar issue for programs like Cyana, so I will ask him about his thoughts.
</pre></blockquote><pre style="margin: 0em;">

</pre><blockquote class="blockquote"><pre style="margin: 0em;">From the perspective of relax, there would definitely need to be more
</pre></blockquote><pre style="margin: 0em;">than one line of code.  And this again depends on if the CCPN data
model is read or the output files from CCPN analysis.  The targets for
relax would be the following user functions:

spectrum.read_spins - for reading out the spin information consisting
of the molecule name, the residue name and number, and the spin name
and number (each of these would be optional).  See
<a  rel="nofollow" href="http://www.nmr-relax.com/manual/spectrum_read_spins.html">http://www.nmr-relax.com/manual/spectrum_read_spins.html</a>.
spectrum.read_intensities - for reading out the peak intensity
information (either heights or volumes, as specified by the user
function).  See
<a  rel="nofollow" href="http://www.nmr-relax.com/manual/spectrum_read_intensities.html">http://www.nmr-relax.com/manual/spectrum_read_intensities.html</a>.
chemical_shift.read - for reading out the CS data.  See
<a  rel="nofollow" href="http://www.nmr-relax.com/manual/chemical_shift_read.html">http://www.nmr-relax.com/manual/chemical_shift_read.html</a>.

Other information could be read into relax by creating new user
functions in the future.  From the perspective of adding code to CCPN
to output something that relax can read, this might be problematic -
unless that output is a simple *.list peak list which would be read by
the above 3 user functions.  For example in the future the internal
format of the chemical shift information is likely to change as the
anisotropic and rhomic components of the chemical shift tensor are
important for RNA/DNA, polysaccharides and small molecules.  What do
you think?  Would the CCPN analysis peak list or the raw data model
itself be the best target?

Cheers,

Edward


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00016" href="msg00016.html">[bug #21599] allow import of nmr data from ccpn projects (optionally	also export)</a></strong>
<ul><li><em>From:</em> Justin</li></ul></li>
<li><strong><a name="00019" href="msg00019.html">Re: [bug #21599] allow import of nmr data from ccpn projects	(optionally also export)</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00022" href="msg00022.html">Re: [bug #21599] allow import of nmr data from ccpn projects	(optionally also export)</a></strong>
<ul><li><em>From:</em> Wayne Boucher</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Mon Feb 10 10:20:24 2014</div>  
</body>
</html>
