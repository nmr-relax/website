<!-- MHonArc v2.6.16 -->
<!--X-Subject: r12587 &#45; in /1.3: ./ generic_fns/pdc.py	specific_fns/model_free/bmrb.py -->
<!--X-From-R13: rqjneqNaze&#45;erynk.pbz -->
<!--X-Date: Sat, 19 Feb 2011 15:18:05 +0100 -->
<!--X-Message-Id: E1PqndN&#45;0004js&#45;Pk@subversion.gna.org -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>r12587 - in /1.3: ./ generic_fns/pdc.py	specific_fns/model_free/bmrb.py -- February 19, 2011 - 15:18</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />r12587 - in /1.3: ./ generic_fns/pdc.py	specific_fns/model_free/bmrb.py</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00108" class="tabs">Index by Date</a> | <a href="threads.html#00108" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00107.html">Date Prev</a>] [<a href="msg00109.html">Date Next</a>] [<a href="msg00107.html">Thread Prev</a>] [<a href="msg00109.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: relax-commits@xxxxxxx</li>
<li class="menuitem">
<em>Date</em>: Sat, 19 Feb 2011 14:18:05 -0000</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00108.html">E1PqndN-0004js-Pk@subversion.gna.org</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>edward</strong> on February 19, 2011 - 15:18:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Author: bugman
Date: Sat Feb 19 15:18:05 2011
New Revision: 12587

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=12587&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=12587&amp;view=rev</a>
Log:
Merged revisions 12532-12534,12576 via svnmerge from 
svn+ssh://bugman@xxxxxxxxxxx/svn/relax/branches/bmrb

........
  r12532 | bugman | 2011-02-17 10:21:43 +0100 (Thu, 17 Feb 2011) | 3 lines
  
  Fix for the _bmrb_model_map() method - the bad models must come first in 
the list!
........
  r12533 | bugman | 2011-02-17 10:23:31 +0100 (Thu, 17 Feb 2011) | 3 lines
  
  The error tags from the Order_parameters saveframe are only used if they 
exist.
........
  r12534 | bugman | 2011-02-17 10:41:36 +0100 (Thu, 17 Feb 2011) | 5 lines
  
  The Modelfree software problem of calling ts te is now handled correctly.
  
  The te parameter is now converted to ts, and the te parameter and error in 
relax are set to None.
........
  r12576 | bugman | 2011-02-18 18:29:53 +0100 (Fri, 18 Feb 2011) | 3 lines
  
  Fix for the PDC system tests - the generic_fns.relax_data.pack_data() args 
are different in the branch.
........

Modified:
    1.3/   (props changed)
    1.3/generic_fns/pdc.py
    1.3/specific_fns/model_free/bmrb.py

Propchange: 1.3/
------------------------------------------------------------------------------
--- svnmerge-integrated (original)
+++ svnmerge-integrated Sat Feb 19 15:18:05 2011
@@ -1,1 +1,1 @@
-/branches/bmrb:1-7041,7043-7046,8153-8388,8392-8573,8834-8975,9274-9705,9708-9792,9795-11264,11633-11660,11691-12530
+/branches/bmrb:1-7041,7043-7046,8153-8388,8392-8573,8834-8975,9274-9705,9708-9792,9795-11264,11633-11660,11691-12530,12532-12576

Modified: 1.3/generic_fns/pdc.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/1.3/generic_fns/pdc.py?rev=12587&amp;r1=12586&amp;r2=12587&amp;view=diff">http://svn.gna.org/viewcvs/relax/1.3/generic_fns/pdc.py?rev=12587&amp;r1=12586&amp;r2=12587&amp;view=diff</a>
==============================================================================
--- 1.3/generic_fns/pdc.py (original)
+++ 1.3/generic_fns/pdc.py Sat Feb 19 15:18:05 2011
@@ -177,4 +177,4 @@
             pass
 
     # Pack the data.
-    pack_data(ri_label, frq_label, frq, values, errors, ids=res_nums)
+    pack_data(ri_label, frq_label, frq, values, errors, spin_ids=res_nums)

Modified: 1.3/specific_fns/model_free/bmrb.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/1.3/specific_fns/model_free/bmrb.py?rev=12587&amp;r1=12586&amp;r2=12587&amp;view=diff">http://svn.gna.org/viewcvs/relax/1.3/specific_fns/model_free/bmrb.py?rev=12587&amp;r1=12586&amp;r2=12587&amp;view=diff</a>
==============================================================================
--- 1.3/specific_fns/model_free/bmrb.py (original)
+++ 1.3/specific_fns/model_free/bmrb.py Sat Feb 19 15:18:05 2011
@@ -62,8 +62,8 @@
                'm2':  'S2, te',
                'm3':  'S2, Rex',
                'm4':  'S2, te, Rex',
+               'm5':  'S2, te, S2f',    # This non-standard naming 
(incorrect) must go before the correct m5.
                'm5':  'S2f, S2, ts',
-               'm5':  'S2, te, S2f',
                'm6':  'S2f, tf, S2, ts',
                'm7':  'S2f, S2, ts, Rex',
                'm8':  'S2f, tf, S2, ts, Rex',
@@ -195,30 +195,41 @@
                 # Loop over and set the model-free parameters.
                 for j in range(len(mf_params)):
                     # No parameter.
-                    if not mf_bmrb_key[j] in keys or data[mf_bmrb_key[j]] == 
None:
+                    if not mf_bmrb_key[j] in keys:
                         continue
 
-                    # The value.
-                    value = data[mf_bmrb_key[j]][i]
-
-                    # The parameter.
-                    param = mf_params[j]
-
-                    # Change the parameter name of te to ts.
-                    if param == 'te':
-                        if (data['s2s'] and data['s2s'][i] != None) or 
(data['s2f'] and data['s2f'][i] != None):
-                            param = 'ts'
-
-                    # Parameter scaling.
-                    if value != None:
-                        if param == 'te':
-                            value = value * te_scale
-                        elif param == 'tf':
-                            value = value * tf_scale
-                        elif param == 'ts':
-                            value = value * ts_scale
-                        elif param == 'rex':
-                            value = value * rex_scale
+                    # The parameter and its value.
+                    if data[mf_bmrb_key[j]] != None:
+                        # The value.
+                        value = data[mf_bmrb_key[j]][i]
+
+                        # The parameter.
+                        param = mf_params[j]
+
+                        # A te value which should be ts!
+                        if param == 'te' and not hasattr(spin, 'te'):
+                            if (data['s2s'] and data['s2s'][i] != None) or 
(data['s2f'] and data['s2f'][i] != None):
+                                # Change the parameter name of te to ts.
+                                param = 'ts'
+
+                                # Set the te and te_err values to None.
+                                spin.te = None
+                                spin.te_err = None
+
+                        # Parameter scaling.
+                        if value != None:
+                            if param == 'te':
+                                value = value * te_scale
+                            elif param == 'tf':
+                                value = value * tf_scale
+                            elif param == 'ts':
+                                value = value * ts_scale
+                            elif param == 'rex':
+                                value = value * rex_scale
+
+                    # No parameter value.
+                    else:
+                        value = None
 
                     # Set the parameter.
                     setattr(spin, param, value)
@@ -226,7 +237,7 @@
                     # The error.
                     mf_bmrb_key_err = mf_bmrb_key[j] + '_err'
                     error = None
-                    if data[mf_bmrb_key_err] != None:
+                    if mf_bmrb_key_err in keys and data[mf_bmrb_key_err] != 
None:
                         error = data[mf_bmrb_key_err][i]
 
                     # Error scaling.



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Sat Feb 19 15:40:01 2011</div>  
</body>
</html>
