<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: [bug #14176] FAIL: Constrained Newton opt, GMW Hessian mod, More 	and Thuente line search {S2=0.970, te=2048, Rex=0.149} -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Mon, 24 Aug 2009 18:17:55 +0200 -->
<!--X-Message-Id: 7f080ed10908240916gb3c86fbt3ea8988f8e7e9db3@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20090822&#45;233515.sv13259.92652@gna.org -->
<!--X-Reference: 20090822&#45;234516.sv13259.66807@gna.org -->
<!--X-Reference: 20090822&#45;234741.sv13259.46501@gna.org -->
<!--X-Reference: 20090822&#45;235418.sv13259.80753@gna.org -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [bug #14176] FAIL: Constrained Newton opt, GMW Hessian mod, More 	and Thuente line search {S2=0.970, te=2048, Rex=0.149} -- August 24, 2009 - 18:17</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: [bug #14176] FAIL: Constrained Newton opt, GMW Hessian mod, More 	and Thuente line search {S2=0.970, te=2048, Rex=0.149}</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00018" class="tabs">Index by Date</a> | <a href="threads.html#00018" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00017.html">Date Prev</a>] [<a href="msg00019.html">Date Next</a>] [<a href="msg00015.html">Thread Prev</a>] [<a href="msg00028.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Jack Howarth &lt;NO-REPLY.INVALID-ADDRESS@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Mon, 24 Aug 2009 18:16:40 +0200</li>
<li class="menuitem">
<em>Cc</em>: Jack Howarth &lt;jhowarth@xxxxxxxxxxxx&gt;, relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00018.html">7f080ed10908240916gb3c86fbt3ea8988f8e7e9db3@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;20090822-233515.sv13259.92652@xxxxxxx&gt;	&lt;20090822-234516.sv13259.66807@xxxxxxx&gt;	&lt;20090822-234741.sv13259.46501@xxxxxxx&gt;	&lt;20090822-235418.sv13259.80753@xxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on August 24, 2009 - 18:17:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi,

I'll add all the relevant fixes to relax soon, but first I have a few
other things to repair.  I've updated the entire codebase to be more
compatible with Python 2.6 and eventually 3.0, so now most of the unit
tests fail.  I'll fix these issues first, then get to recording these
optimisation differences within the test suite.  Thanks for the
reports, these will make it very easy for me to fix these system tests
on Mac OS X.

Cheers,

Edward


2009/8/23 Jack Howarth &lt;NO-REPLY.INVALID-ADDRESS@xxxxxxx&gt;:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">

Follow-up Comment #3, bug #14176 (project relax):

Test does actually fail on i386 Darwin9 as well as x86_64 Darwin9...

FAIL: Constrained Newton opt, GMW Hessian mod, More and Thuente line search
{S2=0.970, te=2048, Rex=0.149}
----------------------------------------------------------------------

relax&gt; pipe.create(pipe_name='mf', pipe_type='mf')

relax&gt; sequence.read(file='noe.500.out',
dir='/sw/lib/relax-py26/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, sep=None)
Opening the file
'/sw/lib/relax-py26/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/noe.500.out'
for reading.
Mol_name   Res_num    Res_name   Spin_num   Spin_name
None       1          GLY        None       None
None       2          ALA        None       None

relax&gt; relax_data.read(ri_label='R1', frq_label='600', frq=600000000.0,
file='r1.600.out',
dir='/sw/lib/relax-py26/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py26/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/r1.600.out'
for reading.

relax&gt; relax_data.read(ri_label='R2', frq_label='600', frq=600000000.0,
file='r2.600.out',
dir='/sw/lib/relax-py26/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py26/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/r2.600.out'
for reading.

relax&gt; relax_data.read(ri_label='NOE', frq_label='600', frq=600000000.0,
file='noe.600.out',
dir='/sw/lib/relax-py26/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py26/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/noe.600.out'
for reading.

relax&gt; relax_data.read(ri_label='R1', frq_label='500', frq=500000000.0,
file='r1.500.out',
dir='/sw/lib/relax-py26/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py26/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/r1.500.out'
for reading.

relax&gt; relax_data.read(ri_label='R2', frq_label='500', frq=500000000.0,
file='r2.500.out',
dir='/sw/lib/relax-py26/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py26/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/r2.500.out'
for reading.

relax&gt; relax_data.read(ri_label='NOE', frq_label='500', frq=500000000.0,
file='noe.500.out',
dir='/sw/lib/relax-py26/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py26/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/noe.500.out'
for reading.

relax&gt; diffusion_tensor.init(params=1e-08, time_scale=1.0, d_scale=1.0,
angle_units='deg', param_types=0, spheroid_type=None, fixed=True)

relax&gt; value.set(val=1.0200000000000001e-10, param='bond_length',
spin_id=None)

relax&gt; value.set(val=-0.00015999999999999999, param='csa', spin_id=None)

relax&gt; value.set(val='15N', param='heteronucleus', spin_id=None)

relax&gt; value.set(val='1H', param='proton', spin_id=None)

relax&gt; model_free.select_model(model='m4', spin_id=None)

relax&gt; value.set(val=[1.0, 0.0, 0.0], param=['S2', 'te', 'Rex'],
spin_id=None)

relax&gt; minimise(*args=('newton', 'gmw', 'mt'), func_tol=1e-25,
max_iterations=10000000, constraints=True, scaling=True, verbosity=1)
Only the model-free parameters for single spins will be used.


Fitting to spin ':2&amp;:ALA'
~~~~~~~~~~~~~~~~~~~~~~~~~


Method of Multipliers
~~~~~~~~~~~~~~~~~~~~~

k: 0       xk: array([ 1.,  0.,  0.])
 fk: 3.9844117908982288
Entering sub-algorithm.

       Newton minimisation
       ~~~~~~~~~~~~~~~~~~~
       Line search:  More and Thuente line search.
       Hessian modification:  The Gill, Murray, and Wright modified Cholesky
algorithm.

       k: 0       xk: array([ 1.,  0.,  0.])
   fk: 3.9844117908982288

       Parameter values: array([  0.90905499,  74.36909171,   1.22310096])
       Function value:   -1447.7789206948949
       Iterations:       4
       Function calls:   9
       Gradient calls:   9
       Hessian calls:    4
       Warning:          None


k: 1       xk: array([  0.90905499,  74.36909171,   1.22310096])
 fk: 48.121433050621448
Entering sub-algorithm.

       Newton minimisation
       ~~~~~~~~~~~~~~~~~~~
       Line search:  More and Thuente line search.
       Hessian modification:  The Gill, Murray, and Wright modified Cholesky
algorithm.

       k: 0       xk: array([  0.90905499,  74.36909171,   1.22310096])
   fk: 46.071609923379611

       Parameter values: array([  9.69999996e-01,   2.04799919e+03,
1.49000073e-01])
       Function value:   -2.0498231272415968
       Iterations:       15
       Function calls:   73
       Gradient calls:   73
       Hessian calls:    15
       Warning:          None


k: 2       xk: array([  9.69999996e-01,   2.04799919e+03,   1.49000073e-01])
 fk: 2.3886847781949838e-13
Entering sub-algorithm.

       Newton minimisation
       ~~~~~~~~~~~~~~~~~~~
       Line search:  More and Thuente line search.
       Hessian modification:  The Gill, Murray, and Wright modified Cholesky
algorithm.

       k: 0       xk: array([  9.69999996e-01,   2.04799919e+03,   
1.49000073e-01])
   fk: 2.3886847781949838e-13

       Parameter values: array([  9.70000000e-01,   2.04800000e+03,
1.49000000e-01])
       Function value:   5.9901622412100428e-25
       Iterations:       1
       Function calls:   3
       Gradient calls:   3
       Hessian calls:    1
       Warning:          None


k: 3       xk: array([  9.70000000e-01,   2.04800000e+03,   1.49000000e-01])
 fk: 5.9901622412100428e-25
Entering sub-algorithm.

       Newton minimisation
       ~~~~~~~~~~~~~~~~~~~
       Line search:  More and Thuente line search.
       Hessian modification:  The Gill, Murray, and Wright modified Cholesky
algorithm.

       k: 0       xk: array([  9.70000000e-01,   2.04800000e+03,   
1.49000000e-01])
   fk: 5.9901622412100428e-25

       Parameter values: array([  9.70000000e-01,   2.04800000e+03,
1.49000000e-01])
       Function value:   1.3932251944754991e-27
       Iterations:       1
       Function calls:   3
       Gradient calls:   3
       Hessian calls:    1
       Warning:          None


k: 4       xk: array([  9.70000000e-01,   2.04800000e+03,   1.49000000e-01])
 fk: 1.3932251944754991e-27
Entering sub-algorithm.

       Newton minimisation
       ~~~~~~~~~~~~~~~~~~~
       Line search:  More and Thuente line search.
       Hessian modification:  The Gill, Murray, and Wright modified Cholesky
algorithm.

       k: 0       xk: array([  9.70000000e-01,   2.04800000e+03,   
1.49000000e-01])
   fk: 1.3932251944754991e-27

       Parameter values: array([  9.70000000e-01,   2.04800000e+03,
1.49000000e-01])
       Function value:   8.3312601381368332e-28
       Iterations:       1
       Function calls:   3
       Gradient calls:   3
       Hessian calls:    1
       Warning:          None


Parameter values: array([  9.70000000e-01,   2.04800000e+03,
1.49000000e-01])
Function value:   8.3312601381368332e-28
Iterations:       22
Function calls:   91
Gradient calls:   91
Hessian calls:    22
Warning:          None


relax&gt; monte_carlo.setup(number=3)

relax&gt; monte_carlo.create_data(method='back_calc')

relax&gt; monte_carlo.initial_values()

relax&gt; minimise(*args=('newton',), func_tol=1e-25, max_iterations=10000000,
constraints=True, scaling=True, verbosity=1)
Simulation 1
Simulation 2
Simulation 3

relax&gt; monte_carlo.error_analysis(prune=0.0)
Traceback (most recent call last):
 File &quot;/sw/lib/relax-py26/test_suite/system_tests/model_free.py&quot;, line 610,
in test_opt_constr_newton_gmw_mt_S2_0_970_te_2048_Rex_0_149
   self.value_test(spin, select, s2, te, rex, chi2, iter, f_count, g_count,
h_count, warning)
 File &quot;/sw/lib/relax-py26/test_suite/system_tests/model_free.py&quot;, line 1110,
in value_test
   self.assertEqual(spin.f_count, f_count, msg=mesg)
AssertionError: Optimisation failure.

System: Darwin
Release: 9.8.0
Version: Darwin Kernel Version 9.8.0: Wed Jul 15 16:55:01 PDT 2009;
root:xnu-1228.15.4~1/RELEASE_I386
Win32 version:
Distribution:
Architecture: 32bit
Machine: i386
Processor: i386
Python version: 2.6.2
numpy version: 1.3.0


s2:       0.9699999999999994
te:       2048.0000000000446
rex:      0.14900000000001609
chi2:     8.3312601381368332e-28
iter:     22
f_count:  91
g_count:  91
h_count:  22
warning:  None



   _______________________________________________________

Reply to this item at:

 &lt;<a  rel="nofollow" href="http://gna.org/bugs/?14176">http://gna.org/bugs/?14176</a>&gt;

_______________________________________________
 Message sent via/by Gna!
 <a  rel="nofollow" href="http://gna.org/">http://gna.org/</a>


_______________________________________________
relax (<a  rel="nofollow" href="http://nmr-relax.com">http://nmr-relax.com</a>)

This is the relax-devel mailing list
relax-devel@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="/mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a>

</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00009" href="msg00009.html">[bug #14176] FAIL: Constrained Newton opt, GMW Hessian mod,	More and Thuente line search {S2=0.970, te=2048, Rex=0.149}</a></strong>
<ul><li><em>From:</em> Jack Howarth</li></ul></li>
<li><strong><a name="00010" href="msg00010.html">[bug #14176] FAIL: Constrained Newton opt, GMW Hessian mod,	More and Thuente line search {S2=0.970, te=2048, Rex=0.149}</a></strong>
<ul><li><em>From:</em> Jack Howarth</li></ul></li>
<li><strong><a name="00011" href="msg00011.html">[bug #14176] FAIL: Constrained Newton opt, GMW Hessian mod,	More and Thuente line search {S2=0.970, te=2048, Rex=0.149}</a></strong>
<ul><li><em>From:</em> Jack Howarth</li></ul></li>
<li><strong><a name="00015" href="msg00015.html">[bug #14176] FAIL: Constrained Newton opt, GMW Hessian mod,	More and Thuente line search {S2=0.970, te=2048, Rex=0.149}</a></strong>
<ul><li><em>From:</em> Jack Howarth</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Wed Sep 02 21:27:21 2009</div>  
</body>
</html>
