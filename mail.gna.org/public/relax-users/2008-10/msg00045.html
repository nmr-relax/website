<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: Curve fitting -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneq.qnhiretarNtznvy.pbz> -->
<!--X-Date: Thu, 16 Oct 2008 11:07:04 +0200 -->
<!--X-Message-Id: 7f080ed10810160207m722eea76q49a2eb9e012fc875@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 48F6BF00.2060705@ulaval.ca -->
<!--X-Reference: 3b3f50350810152202k5111822ahc95ecfe4f6b25198@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Curve fitting -- October 16, 2008 - 11:07</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Curve fitting</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00045" class="tabs">Index by Date</a> | <a href="threads.html#00045" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00044.html">Date Prev</a>] [<a href="msg00046.html">Date Next</a>] [<a href="msg00042.html">Thread Prev</a>] [<a href="msg00051.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Chris MacRaild&quot; &lt;macraild@xxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Thu, 16 Oct 2008 11:07:00 +0200</li>
<li class="menuitem">
<em>Cc</em>: Stephane Gagne &lt;smg@xxxxxxxxxxxxxx&gt;, relax-users@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00045.html">7f080ed10810160207m722eea76q49a2eb9e012fc875@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;48F6BF00.2060705@xxxxxxxxx&gt;	&lt;3b3f50350810152202k5111822ahc95ecfe4f6b25198@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on October 16, 2008 - 11:07:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">On Thu, Oct 16, 2008 at 7:02 AM, Chris MacRaild &lt;macraild@xxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">On Thu, Oct 16, 2008 at 3:11 PM, Sébastien Morin
&lt;sebastien.morin.1@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

I have a general question about curve fitting within relax.

Let's say I proceed to curve fitting for some relaxation rates
(exponential decay) and that I have a duplicate delay for error estimation.

========
delays

0.01
0.01
0.02
0.04
...
========

Will the mean value (for delay 0.01) be used for curve fitting and rate
extraction ?
Or will both values at delay 0.01 be used during curve fitting, hence
giving more weight on delay 0.01 ?

In other words, will the fit only use both values at delay 0.01 for
error estimation or also for rate extraction, giving more weight for
this duplicate point ?

How is this handled in relax ?

Instinctively, I would guess that the man value must be used for
fitting, as we don't want the points that are not in duplicate to count
less in the fitting procedure... Am I right ?

</pre></blockquote><pre style="margin: 0em;">

I would argue not. If we have gone to the trouble of measuring
something twice (or, equivalently, measuring it with greater
precision) then we should weight it more strongly to reflect that.

So we should include both duplicate points in our fit, or we should
just use the mean value, but weight it to reflect the greater
certainty we have in its value.

As I type this I realise this is likely the source of the sqrt(2)
factor Tyler and Edward have been debating on a parallel thread - the
uncertainty in height of any one peak is equal to the RMS noise, but
the std error of the mean of duplicates is less by a factor of
sqrt(2).
</pre></blockquote><pre style="margin: 0em;">

At the moment, relax simply uses the mean value in the fit.  Despite
the higher quality of the duplicated data, all points are given the
same weight.  This is only because of the low data quantity.  As for
dividing the sd of differences between duplicate spectra by sqrt(2),
this is not done in relax anymore.  Because some people have collected
triplicate spectra, although rare, relax calculates the error from
replicated spectra differently.  I'm prepared to be told that this
technique is incorrect though.  The procedure relax uses is to apply
the formula:

sd^2 = sum({Ii - Iav}^2) / (n - 1),

where n is the number of spectra, Ii is the intensity in spectrum i,
Iav is the average intensity, sd is the standard deviation, and sd^2
is the variance.  This is for a single spin.  The sample number is so
low that this value is completely meaningless.  Therefore the variance
is averaged across all spins (well due to a current bug the standard
deviation is averaged instead).  Then another averaging takes place if
not all spectra are duplicated.  The variances across all duplicated
spectra are averaged to give a single error value for all spins across
all spectra (again the sd averaging bug affects this).  The reason for
using this approach is that you are not limited to duplicate spectra.
It also means that the factor of sqrt(2) is not applicable.  If only
single spectra are collected, then relax's current behaviour of not
using sqrt(2) seems reasonable.

Regards,

Edward


P.S.  The idea for the 1.3 line is to create a new class of user
functions, 'spectrum.read_intensities()', 'spectrum.set_rmsd()',
'spectrum.error_analysis()', etc. to make all of this independent of
the analysis type.  See
<a  rel="nofollow" href="https://mail.gna.org/public/relax-devel/2008-10/msg00029.html">https://mail.gna.org/public/relax-devel/2008-10/msg00029.html</a> for
details.


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00051" href="msg00051.html">Re: Curve fitting</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00041" href="msg00041.html">Curve fitting</a></strong>
<ul><li><em>From:</em> Sébastien Morin</li></ul></li>
<li><strong><a name="00042" href="msg00042.html">Re: Curve fitting</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Fri Oct 17 02:00:27 2008</div>  
</body>
</html>
