<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>generic_fns.pcs</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
  <!--Google analytics JS-->
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30096326-1']);
    _gaq.push(['_setDomainName', 'nmr-relax.com']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://www.nmr-relax.com">relax</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="generic_fns-module.html">Package&nbsp;generic_fns</a> ::
        Module&nbsp;pcs
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="generic_fns.pcs-pysrc.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<h1 class="epydoc">Source Code for <a href="generic_fns.pcs-module.html">Module generic_fns.pcs</a></h1>
<pre class="py-src">
<a name="L1"></a><tt class="py-lineno">  1</tt>  <tt class="py-line"><tt class="py-comment">###############################################################################</tt> </tt>
<a name="L2"></a><tt class="py-lineno">  2</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L3"></a><tt class="py-lineno">  3</tt>  <tt class="py-line"><tt class="py-comment"># Copyright (C) 2003-2013 Edward d'Auvergne                                   #</tt> </tt>
<a name="L4"></a><tt class="py-lineno">  4</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L5"></a><tt class="py-lineno">  5</tt>  <tt class="py-line"><tt class="py-comment"># This file is part of the program relax (http://www.nmr-relax.com).          #</tt> </tt>
<a name="L6"></a><tt class="py-lineno">  6</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L7"></a><tt class="py-lineno">  7</tt>  <tt class="py-line"><tt class="py-comment"># This program is free software: you can redistribute it and/or modify        #</tt> </tt>
<a name="L8"></a><tt class="py-lineno">  8</tt>  <tt class="py-line"><tt class="py-comment"># it under the terms of the GNU General Public License as published by        #</tt> </tt>
<a name="L9"></a><tt class="py-lineno">  9</tt>  <tt class="py-line"><tt class="py-comment"># the Free Software Foundation, either version 3 of the License, or           #</tt> </tt>
<a name="L10"></a><tt class="py-lineno"> 10</tt>  <tt class="py-line"><tt class="py-comment"># (at your option) any later version.                                         #</tt> </tt>
<a name="L11"></a><tt class="py-lineno"> 11</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L12"></a><tt class="py-lineno"> 12</tt>  <tt class="py-line"><tt class="py-comment"># This program is distributed in the hope that it will be useful,             #</tt> </tt>
<a name="L13"></a><tt class="py-lineno"> 13</tt>  <tt class="py-line"><tt class="py-comment"># but WITHOUT ANY WARRANTY; without even the implied warranty of              #</tt> </tt>
<a name="L14"></a><tt class="py-lineno"> 14</tt>  <tt class="py-line"><tt class="py-comment"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the               #</tt> </tt>
<a name="L15"></a><tt class="py-lineno"> 15</tt>  <tt class="py-line"><tt class="py-comment"># GNU General Public License for more details.                                #</tt> </tt>
<a name="L16"></a><tt class="py-lineno"> 16</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L17"></a><tt class="py-lineno"> 17</tt>  <tt class="py-line"><tt class="py-comment"># You should have received a copy of the GNU General Public License           #</tt> </tt>
<a name="L18"></a><tt class="py-lineno"> 18</tt>  <tt class="py-line"><tt class="py-comment"># along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.       #</tt> </tt>
<a name="L19"></a><tt class="py-lineno"> 19</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L20"></a><tt class="py-lineno"> 20</tt>  <tt class="py-line"><tt class="py-comment">###############################################################################</tt> </tt>
<a name="L21"></a><tt class="py-lineno"> 21</tt>  <tt class="py-line"> </tt>
<a name="L22"></a><tt class="py-lineno"> 22</tt>  <tt class="py-line"><tt class="py-comment"># Module docstring.</tt> </tt>
<a name="L23"></a><tt class="py-lineno"> 23</tt>  <tt class="py-line"><tt class="py-docstring">"""Module for the manipulation of pseudo-contact shift data."""</tt> </tt>
<a name="L24"></a><tt class="py-lineno"> 24</tt>  <tt class="py-line"> </tt>
<a name="L25"></a><tt class="py-lineno"> 25</tt>  <tt class="py-line"><tt class="py-comment"># Python module imports.</tt> </tt>
<a name="L26"></a><tt class="py-lineno"> 26</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-0" class="py-name" targets="Function generic_fns.align_tensor.copy()=generic_fns.align_tensor-module.html#copy,Function generic_fns.diffusion_tensor.copy()=generic_fns.diffusion_tensor-module.html#copy,Function generic_fns.interatomic.copy()=generic_fns.interatomic-module.html#copy,Function generic_fns.pcs.copy()=generic_fns.pcs-module.html#copy,Function generic_fns.pipes.copy()=generic_fns.pipes-module.html#copy,Function generic_fns.rdc.copy()=generic_fns.rdc-module.html#copy,Function generic_fns.relax_data.copy()=generic_fns.relax_data-module.html#copy,Function generic_fns.sequence.copy()=generic_fns.sequence-module.html#copy,Function generic_fns.value.copy()=generic_fns.value-module.html#copy"><a title="generic_fns.align_tensor.copy
generic_fns.diffusion_tensor.copy
generic_fns.interatomic.copy
generic_fns.pcs.copy
generic_fns.pipes.copy
generic_fns.rdc.copy
generic_fns.relax_data.copy
generic_fns.sequence.copy
generic_fns.value.copy" class="py-name" href="#" onclick="return doclink('link-0', 'copy', 'link-0');">copy</a></tt> <tt class="py-keyword">import</tt> <tt class="py-name">deepcopy</tt> </tt>
<a name="L27"></a><tt class="py-lineno"> 27</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">math</tt> <tt class="py-keyword">import</tt> <tt class="py-name">pi</tt><tt class="py-op">,</tt> <tt class="py-name">sqrt</tt> </tt>
<a name="L28"></a><tt class="py-lineno"> 28</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">numpy</tt> <tt class="py-keyword">import</tt> <tt class="py-name">array</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">,</tt> <tt class="py-name">ones</tt><tt class="py-op">,</tt> <tt class="py-name">std</tt><tt class="py-op">,</tt> <tt class="py-name">zeros</tt> </tt>
<a name="L29"></a><tt class="py-lineno"> 29</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">numpy</tt><tt class="py-op">.</tt><tt class="py-name">linalg</tt> <tt class="py-keyword">import</tt> <tt class="py-name">norm</tt> </tt>
<a name="L30"></a><tt class="py-lineno"> 30</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">random</tt> <tt class="py-keyword">import</tt> <tt class="py-name">gauss</tt> </tt>
<a name="L31"></a><tt class="py-lineno"> 31</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">sys</tt> </tt>
<a name="L32"></a><tt class="py-lineno"> 32</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">warnings</tt> <tt class="py-keyword">import</tt> <tt class="py-name">warn</tt> </tt>
<a name="L33"></a><tt class="py-lineno"> 33</tt>  <tt class="py-line"> </tt>
<a name="L34"></a><tt class="py-lineno"> 34</tt>  <tt class="py-line"><tt class="py-comment"># relax module imports.</tt> </tt>
<a name="L35"></a><tt class="py-lineno"> 35</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-1" class="py-name" targets="Package generic_fns=generic_fns-module.html"><a title="generic_fns" class="py-name" href="#" onclick="return doclink('link-1', 'generic_fns', 'link-1');">generic_fns</a></tt> <tt class="py-keyword">import</tt> <tt id="link-2" class="py-name" targets="Module generic_fns.grace=generic_fns.grace-module.html,Module test_suite.system_tests.grace=test_suite.system_tests.grace-module.html,Module user_functions.grace=user_functions.grace-module.html"><a title="generic_fns.grace
test_suite.system_tests.grace
user_functions.grace" class="py-name" href="#" onclick="return doclink('link-2', 'grace', 'link-2');">grace</a></tt><tt class="py-op">,</tt> <tt id="link-3" class="py-name" targets="Module generic_fns.pipes=generic_fns.pipes-module.html,Module test_suite.gui_tests.pipes=test_suite.gui_tests.pipes-module.html,Module test_suite.system_tests.pipes=test_suite.system_tests.pipes-module.html"><a title="generic_fns.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-3', 'pipes', 'link-3');">pipes</a></tt> </tt>
<a name="L36"></a><tt class="py-lineno"> 36</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-4" class="py-name"><a title="generic_fns" class="py-name" href="#" onclick="return doclink('link-4', 'generic_fns', 'link-1');">generic_fns</a></tt><tt class="py-op">.</tt><tt id="link-5" class="py-name" targets="Module data.align_tensor=data.align_tensor-module.html,Module generic_fns.align_tensor=generic_fns.align_tensor-module.html,Module test_suite.system_tests.align_tensor=test_suite.system_tests.align_tensor-module.html,Module user_functions.align_tensor=user_functions.align_tensor-module.html"><a title="data.align_tensor
generic_fns.align_tensor
test_suite.system_tests.align_tensor
user_functions.align_tensor" class="py-name" href="#" onclick="return doclink('link-5', 'align_tensor', 'link-5');">align_tensor</a></tt> <tt class="py-keyword">import</tt> <tt id="link-6" class="py-name" targets="Function generic_fns.align_tensor.get_tensor_index()=generic_fns.align_tensor-module.html#get_tensor_index"><a title="generic_fns.align_tensor.get_tensor_index" class="py-name" href="#" onclick="return doclink('link-6', 'get_tensor_index', 'link-6');">get_tensor_index</a></tt> </tt>
<a name="L37"></a><tt class="py-lineno"> 37</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-7" class="py-name"><a title="generic_fns" class="py-name" href="#" onclick="return doclink('link-7', 'generic_fns', 'link-1');">generic_fns</a></tt><tt class="py-op">.</tt><tt id="link-8" class="py-name" targets="Module data.mol_res_spin=data.mol_res_spin-module.html,Module generic_fns.mol_res_spin=generic_fns.mol_res_spin-module.html,Module test_suite.system_tests.mol_res_spin=test_suite.system_tests.mol_res_spin-module.html"><a title="data.mol_res_spin
generic_fns.mol_res_spin
test_suite.system_tests.mol_res_spin" class="py-name" href="#" onclick="return doclink('link-8', 'mol_res_spin', 'link-8');">mol_res_spin</a></tt> <tt class="py-keyword">import</tt> <tt id="link-9" class="py-name" targets="Function generic_fns.mol_res_spin.exists_mol_res_spin_data()=generic_fns.mol_res_spin-module.html#exists_mol_res_spin_data"><a title="generic_fns.mol_res_spin.exists_mol_res_spin_data" class="py-name" href="#" onclick="return doclink('link-9', 'exists_mol_res_spin_data', 'link-9');">exists_mol_res_spin_data</a></tt><tt class="py-op">,</tt> <tt id="link-10" class="py-name" targets="Function generic_fns.mol_res_spin.generate_spin_id_unique()=generic_fns.mol_res_spin-module.html#generate_spin_id_unique"><a title="generic_fns.mol_res_spin.generate_spin_id_unique" class="py-name" href="#" onclick="return doclink('link-10', 'generate_spin_id_unique', 'link-10');">generate_spin_id_unique</a></tt><tt class="py-op">,</tt> <tt id="link-11" class="py-name" targets="Function generic_fns.mol_res_spin.return_spin()=generic_fns.mol_res_spin-module.html#return_spin"><a title="generic_fns.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-11', 'return_spin', 'link-11');">return_spin</a></tt><tt class="py-op">,</tt> <tt id="link-12" class="py-name" targets="Function generic_fns.mol_res_spin.spin_index_loop()=generic_fns.mol_res_spin-module.html#spin_index_loop"><a title="generic_fns.mol_res_spin.spin_index_loop" class="py-name" href="#" onclick="return doclink('link-12', 'spin_index_loop', 'link-12');">spin_index_loop</a></tt><tt class="py-op">,</tt> <tt id="link-13" class="py-name" targets="Function generic_fns.mol_res_spin.spin_loop()=generic_fns.mol_res_spin-module.html#spin_loop"><a title="generic_fns.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-13', 'spin_loop', 'link-13');">spin_loop</a></tt> </tt>
<a name="L38"></a><tt class="py-lineno"> 38</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-14" class="py-name" targets="Package maths_fns=maths_fns-module.html"><a title="maths_fns" class="py-name" href="#" onclick="return doclink('link-14', 'maths_fns', 'link-14');">maths_fns</a></tt><tt class="py-op">.</tt><tt id="link-15" class="py-name" targets="Module generic_fns.pcs=generic_fns.pcs-module.html,Module maths_fns.pcs=maths_fns.pcs-module.html,Module test_suite.system_tests.pcs=test_suite.system_tests.pcs-module.html,Module user_functions.pcs=user_functions.pcs-module.html"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-15', 'pcs', 'link-15');">pcs</a></tt> <tt class="py-keyword">import</tt> <tt id="link-16" class="py-name" targets="Function maths_fns.pcs.ave_pcs_tensor()=maths_fns.pcs-module.html#ave_pcs_tensor"><a title="maths_fns.pcs.ave_pcs_tensor" class="py-name" href="#" onclick="return doclink('link-16', 'ave_pcs_tensor', 'link-16');">ave_pcs_tensor</a></tt><tt class="py-op">,</tt> <tt id="link-17" class="py-name" targets="Function maths_fns.pcs.pcs_tensor()=maths_fns.pcs-module.html#pcs_tensor"><a title="maths_fns.pcs.pcs_tensor" class="py-name" href="#" onclick="return doclink('link-17', 'pcs_tensor', 'link-17');">pcs_tensor</a></tt> </tt>
<a name="L39"></a><tt class="py-lineno"> 39</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-18" class="py-name"><a title="maths_fns" class="py-name" href="#" onclick="return doclink('link-18', 'maths_fns', 'link-14');">maths_fns</a></tt><tt class="py-op">.</tt><tt id="link-19" class="py-name" targets="Function generic_fns.structure.main.vectors()=generic_fns.structure.main-module.html#vectors,Module maths_fns.vectors=maths_fns.vectors-module.html"><a title="generic_fns.structure.main.vectors
maths_fns.vectors" class="py-name" href="#" onclick="return doclink('link-19', 'vectors', 'link-19');">vectors</a></tt> <tt class="py-keyword">import</tt> <tt id="link-20" class="py-name" targets="Function maths_fns.vectors.random_unit_vector()=maths_fns.vectors-module.html#random_unit_vector"><a title="maths_fns.vectors.random_unit_vector" class="py-name" href="#" onclick="return doclink('link-20', 'random_unit_vector', 'link-20');">random_unit_vector</a></tt> </tt>
<a name="L40"></a><tt class="py-lineno"> 40</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-21" class="py-name" targets="Module physical_constants=physical_constants-module.html"><a title="physical_constants" class="py-name" href="#" onclick="return doclink('link-21', 'physical_constants', 'link-21');">physical_constants</a></tt> <tt class="py-keyword">import</tt> <tt id="link-22" class="py-name" targets="Variable physical_constants.g1H=physical_constants-module.html#g1H"><a title="physical_constants.g1H" class="py-name" href="#" onclick="return doclink('link-22', 'g1H', 'link-22');">g1H</a></tt><tt class="py-op">,</tt> <tt id="link-23" class="py-name" targets="Function physical_constants.pcs_constant()=physical_constants-module.html#pcs_constant"><a title="physical_constants.pcs_constant" class="py-name" href="#" onclick="return doclink('link-23', 'pcs_constant', 'link-23');">pcs_constant</a></tt> </tt>
<a name="L41"></a><tt class="py-lineno"> 41</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-24" class="py-name" targets="Module relax_errors=relax_errors-module.html"><a title="relax_errors" class="py-name" href="#" onclick="return doclink('link-24', 'relax_errors', 'link-24');">relax_errors</a></tt> <tt class="py-keyword">import</tt> <tt id="link-25" class="py-name" targets="Class relax_errors.RelaxError=relax_errors.RelaxError-class.html"><a title="relax_errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-25', 'RelaxError', 'link-25');">RelaxError</a></tt><tt class="py-op">,</tt> <tt id="link-26" class="py-name" targets="Class relax_errors.RelaxAlignError=relax_errors.RelaxAlignError-class.html"><a title="relax_errors.RelaxAlignError" class="py-name" href="#" onclick="return doclink('link-26', 'RelaxAlignError', 'link-26');">RelaxAlignError</a></tt><tt class="py-op">,</tt> <tt id="link-27" class="py-name" targets="Class relax_errors.RelaxNoAlignError=relax_errors.RelaxNoAlignError-class.html"><a title="relax_errors.RelaxNoAlignError" class="py-name" href="#" onclick="return doclink('link-27', 'RelaxNoAlignError', 'link-27');">RelaxNoAlignError</a></tt><tt class="py-op">,</tt> <tt id="link-28" class="py-name" targets="Class relax_errors.RelaxNoPdbError=relax_errors.RelaxNoPdbError-class.html"><a title="relax_errors.RelaxNoPdbError" class="py-name" href="#" onclick="return doclink('link-28', 'RelaxNoPdbError', 'link-28');">RelaxNoPdbError</a></tt><tt class="py-op">,</tt> <tt id="link-29" class="py-name" targets="Class relax_errors.RelaxNoPCSError=relax_errors.RelaxNoPCSError-class.html"><a title="relax_errors.RelaxNoPCSError" class="py-name" href="#" onclick="return doclink('link-29', 'RelaxNoPCSError', 'link-29');">RelaxNoPCSError</a></tt><tt class="py-op">,</tt> <tt id="link-30" class="py-name" targets="Class relax_errors.RelaxNoSequenceError=relax_errors.RelaxNoSequenceError-class.html"><a title="relax_errors.RelaxNoSequenceError" class="py-name" href="#" onclick="return doclink('link-30', 'RelaxNoSequenceError', 'link-30');">RelaxNoSequenceError</a></tt><tt class="py-op">,</tt> <tt id="link-31" class="py-name" targets="Class relax_errors.RelaxPCSError=relax_errors.RelaxPCSError-class.html"><a title="relax_errors.RelaxPCSError" class="py-name" href="#" onclick="return doclink('link-31', 'RelaxPCSError', 'link-31');">RelaxPCSError</a></tt> </tt>
<a name="L42"></a><tt class="py-lineno"> 42</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-32" class="py-name" targets="Module relax_io=relax_io-module.html"><a title="relax_io" class="py-name" href="#" onclick="return doclink('link-32', 'relax_io', 'link-32');">relax_io</a></tt> <tt class="py-keyword">import</tt> <tt id="link-33" class="py-name" targets="Function relax_io.open_write_file()=relax_io-module.html#open_write_file"><a title="relax_io.open_write_file" class="py-name" href="#" onclick="return doclink('link-33', 'open_write_file', 'link-33');">open_write_file</a></tt><tt class="py-op">,</tt> <tt id="link-34" class="py-name" targets="Function relax_io.read_spin_data()=relax_io-module.html#read_spin_data"><a title="relax_io.read_spin_data" class="py-name" href="#" onclick="return doclink('link-34', 'read_spin_data', 'link-34');">read_spin_data</a></tt><tt class="py-op">,</tt> <tt id="link-35" class="py-name" targets="Function relax_io.write_spin_data()=relax_io-module.html#write_spin_data"><a title="relax_io.write_spin_data" class="py-name" href="#" onclick="return doclink('link-35', 'write_spin_data', 'link-35');">write_spin_data</a></tt> </tt>
<a name="L43"></a><tt class="py-lineno"> 43</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-36" class="py-name" targets="Module relax_warnings=relax_warnings-module.html"><a title="relax_warnings" class="py-name" href="#" onclick="return doclink('link-36', 'relax_warnings', 'link-36');">relax_warnings</a></tt> <tt class="py-keyword">import</tt> <tt id="link-37" class="py-name" targets="Class relax_warnings.RelaxWarning=relax_warnings.RelaxWarning-class.html"><a title="relax_warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-37', 'RelaxWarning', 'link-37');">RelaxWarning</a></tt><tt class="py-op">,</tt> <tt id="link-38" class="py-name" targets="Class relax_warnings.RelaxNoSpinWarning=relax_warnings.RelaxNoSpinWarning-class.html"><a title="relax_warnings.RelaxNoSpinWarning" class="py-name" href="#" onclick="return doclink('link-38', 'RelaxNoSpinWarning', 'link-38');">RelaxNoSpinWarning</a></tt> </tt>
<a name="L44"></a><tt class="py-lineno"> 44</tt>  <tt class="py-line"> </tt>
<a name="L45"></a><tt class="py-lineno"> 45</tt>  <tt class="py-line"> </tt>
<a name="back_calc"></a><div id="back_calc-def"><a name="L46"></a><tt class="py-lineno"> 46</tt> <a class="py-toggle" href="#" id="back_calc-toggle" onclick="return toggle('back_calc');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.pcs-module.html#back_calc">back_calc</a><tt class="py-op">(</tt><tt class="py-param">align_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="back_calc-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="back_calc-expanded"><a name="L47"></a><tt class="py-lineno"> 47</tt>  <tt class="py-line">    <tt class="py-docstring">"""Back calculate the PCS from the alignment tensor.</tt> </tt>
<a name="L48"></a><tt class="py-lineno"> 48</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L49"></a><tt class="py-lineno"> 49</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword align_id:      The alignment tensor ID string.</tt> </tt>
<a name="L50"></a><tt class="py-lineno"> 50</tt>  <tt class="py-line"><tt class="py-docstring">    @type align_id:         str</tt> </tt>
<a name="L51"></a><tt class="py-lineno"> 51</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L52"></a><tt class="py-lineno"> 52</tt>  <tt class="py-line"> </tt>
<a name="L53"></a><tt class="py-lineno"> 53</tt>  <tt class="py-line">    <tt class="py-comment"># Check the pipe setup.</tt> </tt>
<a name="L54"></a><tt class="py-lineno"> 54</tt>  <tt class="py-line">    <tt id="link-39" class="py-name" targets="Function generic_fns.pcs.check_pipe_setup()=generic_fns.pcs-module.html#check_pipe_setup,Function generic_fns.rdc.check_pipe_setup()=generic_fns.rdc-module.html#check_pipe_setup"><a title="generic_fns.pcs.check_pipe_setup
generic_fns.rdc.check_pipe_setup" class="py-name" href="#" onclick="return doclink('link-39', 'check_pipe_setup', 'link-39');">check_pipe_setup</a></tt><tt class="py-op">(</tt><tt class="py-name">pcs_id</tt><tt class="py-op">=</tt><tt class="py-name">align_id</tt><tt class="py-op">,</tt> <tt id="link-40" class="py-name" targets="Module generic_fns.sequence=generic_fns.sequence-module.html,Module gui.input_elements.sequence=gui.input_elements.sequence-module.html,Module test_suite.system_tests.sequence=test_suite.system_tests.sequence-module.html,Module user_functions.sequence=user_functions.sequence-module.html"><a title="generic_fns.sequence
gui.input_elements.sequence
test_suite.system_tests.sequence
user_functions.sequence" class="py-name" href="#" onclick="return doclink('link-40', 'sequence', 'link-40');">sequence</a></tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">N</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">tensors</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt id="link-41" class="py-name" targets="Module maths_fns.paramag_centre=maths_fns.paramag_centre-module.html"><a title="maths_fns.paramag_centre" class="py-name" href="#" onclick="return doclink('link-41', 'paramag_centre', 'link-41');">paramag_centre</a></tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L55"></a><tt class="py-lineno"> 55</tt>  <tt class="py-line"> </tt>
<a name="L56"></a><tt class="py-lineno"> 56</tt>  <tt class="py-line">    <tt class="py-comment"># Convert the align IDs to an array, or take all IDs.</tt> </tt>
<a name="L57"></a><tt class="py-lineno"> 57</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">align_id</tt><tt class="py-op">:</tt> </tt>
<a name="L58"></a><tt class="py-lineno"> 58</tt>  <tt class="py-line">        <tt class="py-name">align_ids</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt> </tt>
<a name="L59"></a><tt class="py-lineno"> 59</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L60"></a><tt class="py-lineno"> 60</tt>  <tt class="py-line">        <tt class="py-name">align_ids</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt> </tt>
<a name="L61"></a><tt class="py-lineno"> 61</tt>  <tt class="py-line"> </tt>
<a name="L62"></a><tt class="py-lineno"> 62</tt>  <tt class="py-line">    <tt class="py-comment"># Add the ID to the PCS IDs, if needed.</tt> </tt>
<a name="L63"></a><tt class="py-lineno"> 63</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt class="py-name">align_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L64"></a><tt class="py-lineno"> 64</tt>  <tt class="py-line">        <tt class="py-comment"># Init.</tt> </tt>
<a name="L65"></a><tt class="py-lineno"> 65</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_ids'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L66"></a><tt class="py-lineno"> 66</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pcs_ids</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L67"></a><tt class="py-lineno"> 67</tt>  <tt class="py-line"> </tt>
<a name="L68"></a><tt class="py-lineno"> 68</tt>  <tt class="py-line">        <tt class="py-comment"># Add the ID.</tt> </tt>
<a name="L69"></a><tt class="py-lineno"> 69</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pcs_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L70"></a><tt class="py-lineno"> 70</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pcs_ids</tt><tt class="py-op">.</tt><tt id="link-42" class="py-name" targets="Method data.align_tensor.AlignTensorSimList.append()=data.align_tensor.AlignTensorSimList-class.html#append,Method data.diff_tensor.DiffTensorSimList.append()=data.diff_tensor.DiffTensorSimList-class.html#append"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-42', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">align_id</tt><tt class="py-op">)</tt> </tt>
<a name="L71"></a><tt class="py-lineno"> 71</tt>  <tt class="py-line"> </tt>
<a name="L72"></a><tt class="py-lineno"> 72</tt>  <tt class="py-line">    <tt class="py-comment"># The weights.</tt> </tt>
<a name="L73"></a><tt class="py-lineno"> 73</tt>  <tt class="py-line">    <tt id="link-43" class="py-name" targets="Module maths_fns.weights=maths_fns.weights-module.html"><a title="maths_fns.weights" class="py-name" href="#" onclick="return doclink('link-43', 'weights', 'link-43');">weights</a></tt> <tt class="py-op">=</tt> <tt class="py-name">ones</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">N</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> <tt class="py-op">/</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">N</tt> </tt>
<a name="L74"></a><tt class="py-lineno"> 74</tt>  <tt class="py-line"> </tt>
<a name="L75"></a><tt class="py-lineno"> 75</tt>  <tt class="py-line">    <tt class="py-comment"># Unit vector data structure init.</tt> </tt>
<a name="L76"></a><tt class="py-lineno"> 76</tt>  <tt class="py-line">    <tt class="py-name">unit_vect</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">N</tt><tt class="py-op">,</tt> <tt class="py-number">3</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L77"></a><tt class="py-lineno"> 77</tt>  <tt class="py-line"> </tt>
<a name="L78"></a><tt class="py-lineno"> 78</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over the spins.</tt> </tt>
<a name="L79"></a><tt class="py-lineno"> 79</tt>  <tt class="py-line">    <tt class="py-name">count</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L80"></a><tt class="py-lineno"> 80</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-44" class="py-name" targets="Module test_suite.unit_tests._generic_fns.spin=test_suite.unit_tests._generic_fns.spin-module.html,Module user_functions.spin=user_functions.spin-module.html"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-44', 'spin', 'link-44');">spin</a></tt> <tt class="py-keyword">in</tt> <tt id="link-45" class="py-name"><a title="generic_fns.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-45', 'spin_loop', 'link-13');">spin_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L81"></a><tt class="py-lineno"> 81</tt>  <tt class="py-line">        <tt class="py-comment"># Skip spins with no position.</tt> </tt>
<a name="L82"></a><tt class="py-lineno"> 82</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-46" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-46', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pos'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L83"></a><tt class="py-lineno"> 83</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L84"></a><tt class="py-lineno"> 84</tt>  <tt class="py-line"> </tt>
<a name="L85"></a><tt class="py-lineno"> 85</tt>  <tt class="py-line">        <tt class="py-comment"># Atom positions.</tt> </tt>
<a name="L86"></a><tt class="py-lineno"> 86</tt>  <tt class="py-line">        <tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt id="link-47" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-47', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pos</tt> </tt>
<a name="L87"></a><tt class="py-lineno"> 87</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-48" class="py-name" targets="Function generic_fns.relax_data.type()=generic_fns.relax_data-module.html#type,Variable info.Bieri11.type=info.Bieri11-class.html#type,Variable info.Clore90.type=info.Clore90-class.html#type,Variable info.Delaglio95.type=info.Delaglio95-class.html#type,Variable info.GoddardKneller.type=info.GoddardKneller-class.html#type,Variable info.LipariSzabo82a.type=info.LipariSzabo82a-class.html#type,Variable info.LipariSzabo82b.type=info.LipariSzabo82b-class.html#type,Variable info.Ref.type=info.Ref-class.html#type,Variable info.dAuvergne06.type=info.dAuvergne06-class.html#type,Variable info.dAuvergneGooley03.type=info.dAuvergneGooley03-class.html#type,Variable info.dAuvergneGooley06.type=info.dAuvergneGooley06-class.html#type,Variable info.dAuvergneGooley07.type=info.dAuvergneGooley07-class.html#type,Variable info.dAuvergneGooley08a.type=info.dAuvergneGooley08a-class.html#type,Variable info.dAuvergneGooley08b.type=info.dAuvergneGooley08b-class.html#type"><a title="generic_fns.relax_data.type
info.Bieri11.type
info.Clore90.type
info.Delaglio95.type
info.GoddardKneller.type
info.LipariSzabo82a.type
info.LipariSzabo82b.type
info.Ref.type
info.dAuvergne06.type
info.dAuvergneGooley03.type
info.dAuvergneGooley06.type
info.dAuvergneGooley07.type
info.dAuvergneGooley08a.type
info.dAuvergneGooley08b.type" class="py-name" href="#" onclick="return doclink('link-48', 'type', 'link-48');">type</a></tt><tt class="py-op">(</tt><tt class="py-name">pos</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt id="link-49" class="py-name" targets="Module float=float-module.html"><a title="float" class="py-name" href="#" onclick="return doclink('link-49', 'float', 'link-49');">float</a></tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L88"></a><tt class="py-lineno"> 88</tt>  <tt class="py-line">            <tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-name">pos</tt><tt class="py-op">]</tt> <tt class="py-op">*</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">N</tt> </tt>
<a name="L89"></a><tt class="py-lineno"> 89</tt>  <tt class="py-line"> </tt>
<a name="L90"></a><tt class="py-lineno"> 90</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the alignments.</tt> </tt>
<a name="L91"></a><tt class="py-lineno"> 91</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-50" class="py-name" targets="Variable generic_fns.structure.api_base.Base_struct_API.id=generic_fns.structure.api_base.Base_struct_API-class.html#id,Variable generic_fns.structure.internal.Internal.id=generic_fns.structure.internal.Internal-class.html#id,Variable generic_fns.structure.scientific.Scientific_data.id=generic_fns.structure.scientific.Scientific_data-class.html#id"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-50', 'id', 'link-50');">id</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">align_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L92"></a><tt class="py-lineno"> 92</tt>  <tt class="py-line">            <tt class="py-comment"># Vectors.</tt> </tt>
<a name="L93"></a><tt class="py-lineno"> 93</tt>  <tt class="py-line">            <tt class="py-name">vect</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">N</tt><tt class="py-op">,</tt> <tt class="py-number">3</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L94"></a><tt class="py-lineno"> 94</tt>  <tt class="py-line">            <tt class="py-name">r</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">N</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L95"></a><tt class="py-lineno"> 95</tt>  <tt class="py-line">            <tt class="py-name">dj</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">N</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L96"></a><tt class="py-lineno"> 96</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">c</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">N</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L97"></a><tt class="py-lineno"> 97</tt>  <tt class="py-line">                <tt class="py-comment"># The vector.</tt> </tt>
<a name="L98"></a><tt class="py-lineno"> 98</tt>  <tt class="py-line">                <tt class="py-name">vect</tt><tt class="py-op">[</tt><tt class="py-name">c</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">pos</tt><tt class="py-op">[</tt><tt class="py-name">c</tt><tt class="py-op">]</tt> <tt class="py-op">-</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramagnetic_centre</tt> </tt>
<a name="L99"></a><tt class="py-lineno"> 99</tt>  <tt class="py-line"> </tt>
<a name="L100"></a><tt class="py-lineno">100</tt>  <tt class="py-line">                <tt class="py-comment"># The length.</tt> </tt>
<a name="L101"></a><tt class="py-lineno">101</tt>  <tt class="py-line">                <tt class="py-name">r</tt><tt class="py-op">[</tt><tt class="py-name">c</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">norm</tt><tt class="py-op">(</tt><tt class="py-name">vect</tt><tt class="py-op">[</tt><tt class="py-name">c</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L102"></a><tt class="py-lineno">102</tt>  <tt class="py-line"> </tt>
<a name="L103"></a><tt class="py-lineno">103</tt>  <tt class="py-line">                <tt class="py-comment"># Normalise (only if the vector has length).</tt> </tt>
<a name="L104"></a><tt class="py-lineno">104</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">r</tt><tt class="py-op">[</tt><tt class="py-name">c</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L105"></a><tt class="py-lineno">105</tt>  <tt class="py-line">                    <tt class="py-name">vect</tt><tt class="py-op">[</tt><tt class="py-name">c</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">vect</tt><tt class="py-op">[</tt><tt class="py-name">c</tt><tt class="py-op">]</tt> <tt class="py-op">/</tt> <tt class="py-name">r</tt><tt class="py-op">[</tt><tt class="py-name">c</tt><tt class="py-op">]</tt> </tt>
<a name="L106"></a><tt class="py-lineno">106</tt>  <tt class="py-line"> </tt>
<a name="L107"></a><tt class="py-lineno">107</tt>  <tt class="py-line">                <tt class="py-comment"># Calculate the PCS constant.</tt> </tt>
<a name="L108"></a><tt class="py-lineno">108</tt>  <tt class="py-line">                <tt class="py-name">dj</tt><tt class="py-op">[</tt><tt class="py-name">c</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-51" class="py-name"><a title="physical_constants.pcs_constant" class="py-name" href="#" onclick="return doclink('link-51', 'pcs_constant', 'link-23');">pcs_constant</a></tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-52" class="py-name" targets="Module generic_fns.temperature=generic_fns.temperature-module.html,Module user_functions.temperature=user_functions.temperature-module.html"><a title="generic_fns.temperature
user_functions.temperature" class="py-name" href="#" onclick="return doclink('link-52', 'temperature', 'link-52');">temperature</a></tt><tt class="py-op">[</tt><tt id="link-53" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-53', 'id', 'link-50');">id</a></tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-54" class="py-name" targets="Module generic_fns.frq=generic_fns.frq-module.html,Function generic_fns.relax_data.frq()=generic_fns.relax_data-module.html#frq,Module user_functions.frq=user_functions.frq-module.html"><a title="generic_fns.frq
generic_fns.relax_data.frq
user_functions.frq" class="py-name" href="#" onclick="return doclink('link-54', 'frq', 'link-54');">frq</a></tt><tt class="py-op">[</tt><tt id="link-55" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-55', 'id', 'link-50');">id</a></tt><tt class="py-op">]</tt> <tt class="py-op">*</tt> <tt class="py-number">2.0</tt> <tt class="py-op">*</tt> <tt class="py-name">pi</tt> <tt class="py-op">/</tt> <tt id="link-56" class="py-name"><a title="physical_constants.g1H" class="py-name" href="#" onclick="return doclink('link-56', 'g1H', 'link-22');">g1H</a></tt><tt class="py-op">,</tt> <tt class="py-name">r</tt><tt class="py-op">[</tt><tt class="py-name">c</tt><tt class="py-op">]</tt><tt class="py-op">/</tt><tt class="py-number">1e10</tt><tt class="py-op">)</tt> </tt>
<a name="L109"></a><tt class="py-lineno">109</tt>  <tt class="py-line"> </tt>
<a name="L110"></a><tt class="py-lineno">110</tt>  <tt class="py-line">            <tt class="py-comment"># Initialise if necessary.</tt> </tt>
<a name="L111"></a><tt class="py-lineno">111</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-57" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-57', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_bc'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L112"></a><tt class="py-lineno">112</tt>  <tt class="py-line">                <tt id="link-58" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-58', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_bc</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L113"></a><tt class="py-lineno">113</tt>  <tt class="py-line"> </tt>
<a name="L114"></a><tt class="py-lineno">114</tt>  <tt class="py-line">            <tt class="py-comment"># Calculate the PCSs (in ppm).</tt> </tt>
<a name="L115"></a><tt class="py-lineno">115</tt>  <tt class="py-line">            <tt id="link-59" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-59', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_bc</tt><tt class="py-op">[</tt><tt id="link-60" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-60', 'id', 'link-50');">id</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-61" class="py-name"><a title="maths_fns.pcs.ave_pcs_tensor" class="py-name" href="#" onclick="return doclink('link-61', 'ave_pcs_tensor', 'link-16');">ave_pcs_tensor</a></tt><tt class="py-op">(</tt><tt class="py-name">dj</tt><tt class="py-op">,</tt> <tt class="py-name">vect</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">N</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">[</tt><tt id="link-62" class="py-name"><a title="generic_fns.align_tensor.get_tensor_index" class="py-name" href="#" onclick="return doclink('link-62', 'get_tensor_index', 'link-6');">get_tensor_index</a></tt><tt class="py-op">(</tt><tt id="link-63" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-63', 'id', 'link-50');">id</a></tt><tt class="py-op">)</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">A</tt><tt class="py-op">,</tt> <tt id="link-64" class="py-name"><a title="maths_fns.weights" class="py-name" href="#" onclick="return doclink('link-64', 'weights', 'link-43');">weights</a></tt><tt class="py-op">=</tt><tt id="link-65" class="py-name"><a title="maths_fns.weights" class="py-name" href="#" onclick="return doclink('link-65', 'weights', 'link-43');">weights</a></tt><tt class="py-op">)</tt> <tt class="py-op">*</tt> <tt class="py-number">1e6</tt> </tt>
<a name="L116"></a><tt class="py-lineno">116</tt>  <tt class="py-line"> </tt>
<a name="L117"></a><tt class="py-lineno">117</tt>  <tt class="py-line">        <tt class="py-comment"># Increment the counter.</tt> </tt>
<a name="L118"></a><tt class="py-lineno">118</tt>  <tt class="py-line">        <tt class="py-name">count</tt> <tt class="py-op">+=</tt> <tt class="py-number">1</tt> </tt>
<a name="L119"></a><tt class="py-lineno">119</tt>  <tt class="py-line"> </tt>
<a name="L120"></a><tt class="py-lineno">120</tt>  <tt class="py-line">    <tt class="py-comment"># No PCSs calculated.</tt> </tt>
<a name="L121"></a><tt class="py-lineno">121</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">count</tt><tt class="py-op">:</tt> </tt>
<a name="L122"></a><tt class="py-lineno">122</tt>  <tt class="py-line">        <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-66" class="py-name"><a title="relax_warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-66', 'RelaxWarning', 'link-37');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"No PCSs have been back calculated, probably due to missing spin position information."</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
</div><a name="L123"></a><tt class="py-lineno">123</tt>  <tt class="py-line"> </tt>
<a name="L124"></a><tt class="py-lineno">124</tt>  <tt class="py-line"> </tt>
<a name="centre"></a><div id="centre-def"><a name="L125"></a><tt class="py-lineno">125</tt> <a class="py-toggle" href="#" id="centre-toggle" onclick="return toggle('centre');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.pcs-module.html#centre">centre</a><tt class="py-op">(</tt><tt class="py-param">pos</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">pipe</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">verbosity</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-param">ave_pos</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">,</tt> <tt class="py-param">force</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="centre-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="centre-expanded"><a name="L126"></a><tt class="py-lineno">126</tt>  <tt class="py-line">    <tt class="py-docstring">"""Specify the atom in the loaded structure corresponding to the paramagnetic centre.</tt> </tt>
<a name="L127"></a><tt class="py-lineno">127</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L128"></a><tt class="py-lineno">128</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pos:       The atomic position.  If set, the atom_id string will be ignored.</tt> </tt>
<a name="L129"></a><tt class="py-lineno">129</tt>  <tt class="py-line"><tt class="py-docstring">    @type pos:          list of float</tt> </tt>
<a name="L130"></a><tt class="py-lineno">130</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_id:   The atom identification string.</tt> </tt>
<a name="L131"></a><tt class="py-lineno">131</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_id:      str</tt> </tt>
<a name="L132"></a><tt class="py-lineno">132</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pipe:      An alternative data pipe to extract the paramagnetic centre from.</tt> </tt>
<a name="L133"></a><tt class="py-lineno">133</tt>  <tt class="py-line"><tt class="py-docstring">    @type pipe:         None or str</tt> </tt>
<a name="L134"></a><tt class="py-lineno">134</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword verbosity: The amount of information to print out.  The bigger the number, the more information.</tt> </tt>
<a name="L135"></a><tt class="py-lineno">135</tt>  <tt class="py-line"><tt class="py-docstring">    @type verbosity:    int</tt> </tt>
<a name="L136"></a><tt class="py-lineno">136</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword ave_pos:   A flag which if True causes the atomic positions from multiple models to be averaged.</tt> </tt>
<a name="L137"></a><tt class="py-lineno">137</tt>  <tt class="py-line"><tt class="py-docstring">    @type ave_pos:      bool</tt> </tt>
<a name="L138"></a><tt class="py-lineno">138</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword force:     A flag which if True will cause the current PCS centre to be overwritten.</tt> </tt>
<a name="L139"></a><tt class="py-lineno">139</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L140"></a><tt class="py-lineno">140</tt>  <tt class="py-line"> </tt>
<a name="L141"></a><tt class="py-lineno">141</tt>  <tt class="py-line">    <tt class="py-comment"># The data pipe.</tt> </tt>
<a name="L142"></a><tt class="py-lineno">142</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-67" class="py-name" targets="Module user_functions.pipe=user_functions.pipe-module.html"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-67', 'pipe', 'link-67');">pipe</a></tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L143"></a><tt class="py-lineno">143</tt>  <tt class="py-line">        <tt id="link-68" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-68', 'pipe', 'link-67');">pipe</a></tt> <tt class="py-op">=</tt> <tt id="link-69" class="py-name"><a title="generic_fns.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-69', 'pipes', 'link-3');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-70" class="py-name" targets="Function generic_fns.pipes.cdp_name()=generic_fns.pipes-module.html#cdp_name"><a title="generic_fns.pipes.cdp_name" class="py-name" href="#" onclick="return doclink('link-70', 'cdp_name', 'link-70');">cdp_name</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L144"></a><tt class="py-lineno">144</tt>  <tt class="py-line"> </tt>
<a name="L145"></a><tt class="py-lineno">145</tt>  <tt class="py-line">    <tt class="py-comment"># Check the pipe setup.</tt> </tt>
<a name="L146"></a><tt class="py-lineno">146</tt>  <tt class="py-line">    <tt id="link-71" class="py-name"><a title="generic_fns.pcs.check_pipe_setup
generic_fns.rdc.check_pipe_setup" class="py-name" href="#" onclick="return doclink('link-71', 'check_pipe_setup', 'link-39');">check_pipe_setup</a></tt><tt class="py-op">(</tt><tt id="link-72" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-72', 'pipe', 'link-67');">pipe</a></tt><tt class="py-op">=</tt><tt id="link-73" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-73', 'pipe', 'link-67');">pipe</a></tt><tt class="py-op">)</tt> </tt>
<a name="L147"></a><tt class="py-lineno">147</tt>  <tt class="py-line"> </tt>
<a name="L148"></a><tt class="py-lineno">148</tt>  <tt class="py-line">    <tt class="py-comment"># Get the data pipes.</tt> </tt>
<a name="L149"></a><tt class="py-lineno">149</tt>  <tt class="py-line">    <tt class="py-name">source_dp</tt> <tt class="py-op">=</tt> <tt id="link-74" class="py-name"><a title="generic_fns.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-74', 'pipes', 'link-3');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-75" class="py-name" targets="Function generic_fns.pipes.get_pipe()=generic_fns.pipes-module.html#get_pipe"><a title="generic_fns.pipes.get_pipe" class="py-name" href="#" onclick="return doclink('link-75', 'get_pipe', 'link-75');">get_pipe</a></tt><tt class="py-op">(</tt><tt id="link-76" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-76', 'pipe', 'link-67');">pipe</a></tt><tt class="py-op">)</tt> </tt>
<a name="L150"></a><tt class="py-lineno">150</tt>  <tt class="py-line"> </tt>
<a name="L151"></a><tt class="py-lineno">151</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the structure has been loaded.</tt> </tt>
<a name="L152"></a><tt class="py-lineno">152</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">source_dp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L153"></a><tt class="py-lineno">153</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-77" class="py-name"><a title="relax_errors.RelaxNoPdbError" class="py-name" href="#" onclick="return doclink('link-77', 'RelaxNoPdbError', 'link-28');">RelaxNoPdbError</a></tt> </tt>
<a name="L154"></a><tt class="py-lineno">154</tt>  <tt class="py-line"> </tt>
<a name="L155"></a><tt class="py-lineno">155</tt>  <tt class="py-line">    <tt class="py-comment"># Test the centre has already been set.</tt> </tt>
<a name="L156"></a><tt class="py-lineno">156</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">force</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'paramagnetic_centre'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L157"></a><tt class="py-lineno">157</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-78" class="py-name"><a title="relax_errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-78', 'RelaxError', 'link-25');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The paramagnetic centre has already been set to the coordinates "</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramagnetic_centre</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">"."</tt><tt class="py-op">)</tt> </tt>
<a name="L158"></a><tt class="py-lineno">158</tt>  <tt class="py-line"> </tt>
<a name="L159"></a><tt class="py-lineno">159</tt>  <tt class="py-line">    <tt class="py-comment"># Position is supplied.</tt> </tt>
<a name="L160"></a><tt class="py-lineno">160</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">pos</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L161"></a><tt class="py-lineno">161</tt>  <tt class="py-line">        <tt id="link-79" class="py-name" targets="Function generic_fns.paramag.centre()=generic_fns.paramag-module.html#centre,Function generic_fns.pcs.centre()=generic_fns.pcs-module.html#centre,Method info.Info_box.centre()=info.Info_box-class.html#centre"><a title="generic_fns.paramag.centre
generic_fns.pcs.centre
info.Info_box.centre" class="py-name" href="#" onclick="return doclink('link-79', 'centre', 'link-79');">centre</a></tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">pos</tt><tt class="py-op">)</tt> </tt>
<a name="L162"></a><tt class="py-lineno">162</tt>  <tt class="py-line">        <tt class="py-name">num_pos</tt> <tt class="py-op">=</tt> <tt class="py-number">1</tt> </tt>
<a name="L163"></a><tt class="py-lineno">163</tt>  <tt class="py-line">        <tt class="py-name">full_pos_list</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L164"></a><tt class="py-lineno">164</tt>  <tt class="py-line"> </tt>
<a name="L165"></a><tt class="py-lineno">165</tt>  <tt class="py-line">    <tt class="py-comment"># Position from a loaded structure.</tt> </tt>
<a name="L166"></a><tt class="py-lineno">166</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L167"></a><tt class="py-lineno">167</tt>  <tt class="py-line">        <tt class="py-comment"># Get the positions.</tt> </tt>
<a name="L168"></a><tt class="py-lineno">168</tt>  <tt class="py-line">        <tt id="link-80" class="py-name"><a title="generic_fns.paramag.centre
generic_fns.pcs.centre
info.Info_box.centre" class="py-name" href="#" onclick="return doclink('link-80', 'centre', 'link-79');">centre</a></tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-number">3</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L169"></a><tt class="py-lineno">169</tt>  <tt class="py-line">        <tt class="py-name">full_pos_list</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L170"></a><tt class="py-lineno">170</tt>  <tt class="py-line">        <tt class="py-name">num_pos</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L171"></a><tt class="py-lineno">171</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-81" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-81', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt id="link-82" class="py-name" targets="Module gui.input_elements.spin_id=gui.input_elements.spin_id-module.html"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-82', 'spin_id', 'link-82');">spin_id</a></tt> <tt class="py-keyword">in</tt> <tt id="link-83" class="py-name"><a title="generic_fns.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-83', 'spin_loop', 'link-13');">spin_loop</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_id</tt><tt class="py-op">,</tt> <tt id="link-84" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-84', 'pipe', 'link-67');">pipe</a></tt><tt class="py-op">=</tt><tt id="link-85" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-85', 'pipe', 'link-67');">pipe</a></tt><tt class="py-op">,</tt> <tt class="py-name">return_id</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L172"></a><tt class="py-lineno">172</tt>  <tt class="py-line">            <tt class="py-comment"># No atomic positions.</tt> </tt>
<a name="L173"></a><tt class="py-lineno">173</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-86" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-86', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pos'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L174"></a><tt class="py-lineno">174</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L175"></a><tt class="py-lineno">175</tt>  <tt class="py-line">     </tt>
<a name="L176"></a><tt class="py-lineno">176</tt>  <tt class="py-line">            <tt class="py-comment"># Spin position list.</tt> </tt>
<a name="L177"></a><tt class="py-lineno">177</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">isinstance</tt><tt class="py-op">(</tt><tt id="link-87" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-87', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pos</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt id="link-88" class="py-name"><a title="float" class="py-name" href="#" onclick="return doclink('link-88', 'float', 'link-49');">float</a></tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-name">isinstance</tt><tt class="py-op">(</tt><tt id="link-89" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-89', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pos</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L178"></a><tt class="py-lineno">178</tt>  <tt class="py-line">                <tt class="py-name">pos_list</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt id="link-90" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-90', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pos</tt><tt class="py-op">]</tt> </tt>
<a name="L179"></a><tt class="py-lineno">179</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L180"></a><tt class="py-lineno">180</tt>  <tt class="py-line">                <tt class="py-name">pos_list</tt> <tt class="py-op">=</tt> <tt id="link-91" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-91', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pos</tt> </tt>
<a name="L181"></a><tt class="py-lineno">181</tt>  <tt class="py-line">     </tt>
<a name="L182"></a><tt class="py-lineno">182</tt>  <tt class="py-line">            <tt class="py-comment"># Loop over the model positions.</tt> </tt>
<a name="L183"></a><tt class="py-lineno">183</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">pos</tt> <tt class="py-keyword">in</tt> <tt class="py-name">pos_list</tt><tt class="py-op">:</tt> </tt>
<a name="L184"></a><tt class="py-lineno">184</tt>  <tt class="py-line">                <tt class="py-name">full_pos_list</tt><tt class="py-op">.</tt><tt id="link-92" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-92', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">pos</tt><tt class="py-op">)</tt> </tt>
<a name="L185"></a><tt class="py-lineno">185</tt>  <tt class="py-line">                <tt id="link-93" class="py-name"><a title="generic_fns.paramag.centre
generic_fns.pcs.centre
info.Info_box.centre" class="py-name" href="#" onclick="return doclink('link-93', 'centre', 'link-79');">centre</a></tt> <tt class="py-op">=</tt> <tt id="link-94" class="py-name"><a title="generic_fns.paramag.centre
generic_fns.pcs.centre
info.Info_box.centre" class="py-name" href="#" onclick="return doclink('link-94', 'centre', 'link-79');">centre</a></tt> <tt class="py-op">+</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">pos</tt><tt class="py-op">)</tt> </tt>
<a name="L186"></a><tt class="py-lineno">186</tt>  <tt class="py-line">                <tt class="py-name">num_pos</tt> <tt class="py-op">=</tt> <tt class="py-name">num_pos</tt> <tt class="py-op">+</tt> <tt class="py-number">1</tt> </tt>
<a name="L187"></a><tt class="py-lineno">187</tt>  <tt class="py-line">     </tt>
<a name="L188"></a><tt class="py-lineno">188</tt>  <tt class="py-line">        <tt class="py-comment"># No positional information!</tt> </tt>
<a name="L189"></a><tt class="py-lineno">189</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">num_pos</tt><tt class="py-op">:</tt> </tt>
<a name="L190"></a><tt class="py-lineno">190</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-95" class="py-name"><a title="relax_errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-95', 'RelaxError', 'link-25');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"No positional information could be found for the spin '%s'."</tt> <tt class="py-op">%</tt> <tt class="py-name">atom_id</tt><tt class="py-op">)</tt> </tt>
<a name="L191"></a><tt class="py-lineno">191</tt>  <tt class="py-line"> </tt>
<a name="L192"></a><tt class="py-lineno">192</tt>  <tt class="py-line">    <tt class="py-comment"># Averaging.</tt> </tt>
<a name="L193"></a><tt class="py-lineno">193</tt>  <tt class="py-line">    <tt id="link-96" class="py-name"><a title="generic_fns.paramag.centre
generic_fns.pcs.centre
info.Info_box.centre" class="py-name" href="#" onclick="return doclink('link-96', 'centre', 'link-79');">centre</a></tt> <tt class="py-op">=</tt> <tt id="link-97" class="py-name"><a title="generic_fns.paramag.centre
generic_fns.pcs.centre
info.Info_box.centre" class="py-name" href="#" onclick="return doclink('link-97', 'centre', 'link-79');">centre</a></tt> <tt class="py-op">/</tt> <tt id="link-98" class="py-name"><a title="float" class="py-name" href="#" onclick="return doclink('link-98', 'float', 'link-49');">float</a></tt><tt class="py-op">(</tt><tt class="py-name">num_pos</tt><tt class="py-op">)</tt> </tt>
<a name="L194"></a><tt class="py-lineno">194</tt>  <tt class="py-line"> </tt>
<a name="L195"></a><tt class="py-lineno">195</tt>  <tt class="py-line">    <tt class="py-comment"># Print out.</tt> </tt>
<a name="L196"></a><tt class="py-lineno">196</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-99" class="py-name" targets="Variable bmrblib.pystarlib.Text.verbosity=bmrblib.pystarlib.Text-module.html#verbosity,Variable bmrblib.pystarlib.verbosity=bmrblib.pystarlib-module.html#verbosity,Variable multi.multi_processor_base.verbosity=multi.multi_processor_base-module.html#verbosity,Variable multi.processor.verbosity=multi.processor-module.html#verbosity"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-99', 'verbosity', 'link-99');">verbosity</a></tt><tt class="py-op">:</tt> </tt>
<a name="L197"></a><tt class="py-lineno">197</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Paramagnetic centres located at:"</tt><tt class="py-op">)</tt> </tt>
<a name="L198"></a><tt class="py-lineno">198</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">pos</tt> <tt class="py-keyword">in</tt> <tt class="py-name">full_pos_list</tt><tt class="py-op">:</tt> </tt>
<a name="L199"></a><tt class="py-lineno">199</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"    [%8.3f, %8.3f, %8.3f]"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-name">pos</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L200"></a><tt class="py-lineno">200</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\nAverage paramagnetic centre located at:"</tt><tt class="py-op">)</tt> </tt>
<a name="L201"></a><tt class="py-lineno">201</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"    [%8.3f, %8.3f, %8.3f]"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt id="link-100" class="py-name"><a title="generic_fns.paramag.centre
generic_fns.pcs.centre
info.Info_box.centre" class="py-name" href="#" onclick="return doclink('link-100', 'centre', 'link-79');">centre</a></tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt id="link-101" class="py-name"><a title="generic_fns.paramag.centre
generic_fns.pcs.centre
info.Info_box.centre" class="py-name" href="#" onclick="return doclink('link-101', 'centre', 'link-79');">centre</a></tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt id="link-102" class="py-name"><a title="generic_fns.paramag.centre
generic_fns.pcs.centre
info.Info_box.centre" class="py-name" href="#" onclick="return doclink('link-102', 'centre', 'link-79');">centre</a></tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L202"></a><tt class="py-lineno">202</tt>  <tt class="py-line"> </tt>
<a name="L203"></a><tt class="py-lineno">203</tt>  <tt class="py-line">    <tt class="py-comment"># Set the centre (place it into the current data pipe).</tt> </tt>
<a name="L204"></a><tt class="py-lineno">204</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">ave_pos</tt><tt class="py-op">:</tt> </tt>
<a name="L205"></a><tt class="py-lineno">205</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-103" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-103', 'verbosity', 'link-99');">verbosity</a></tt><tt class="py-op">:</tt> </tt>
<a name="L206"></a><tt class="py-lineno">206</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\nUsing the average paramagnetic position."</tt><tt class="py-op">)</tt> </tt>
<a name="L207"></a><tt class="py-lineno">207</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramagnetic_centre</tt> <tt class="py-op">=</tt> <tt id="link-104" class="py-name"><a title="generic_fns.paramag.centre
generic_fns.pcs.centre
info.Info_box.centre" class="py-name" href="#" onclick="return doclink('link-104', 'centre', 'link-79');">centre</a></tt> </tt>
<a name="L208"></a><tt class="py-lineno">208</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L209"></a><tt class="py-lineno">209</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-105" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-105', 'verbosity', 'link-99');">verbosity</a></tt><tt class="py-op">:</tt> </tt>
<a name="L210"></a><tt class="py-lineno">210</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\nUsing all paramagnetic positions."</tt><tt class="py-op">)</tt> </tt>
<a name="L211"></a><tt class="py-lineno">211</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramagnetic_centre</tt> <tt class="py-op">=</tt> <tt class="py-name">full_pos_list</tt> </tt>
</div><a name="L212"></a><tt class="py-lineno">212</tt>  <tt class="py-line"> </tt>
<a name="L213"></a><tt class="py-lineno">213</tt>  <tt class="py-line"> </tt>
<a name="check_pipe_setup"></a><div id="check_pipe_setup-def"><a name="L214"></a><tt class="py-lineno">214</tt> <a class="py-toggle" href="#" id="check_pipe_setup-toggle" onclick="return toggle('check_pipe_setup');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.pcs-module.html#check_pipe_setup">check_pipe_setup</a><tt class="py-op">(</tt><tt class="py-param">pipe</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">pcs_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">sequence</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">,</tt> <tt class="py-param">N</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">,</tt> <tt class="py-param">tensors</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">,</tt> <tt class="py-param">pcs</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">,</tt> <tt class="py-param">paramag_centre</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="check_pipe_setup-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="check_pipe_setup-expanded"><a name="L215"></a><tt class="py-lineno">215</tt>  <tt class="py-line">    <tt class="py-docstring">"""Check that the current data pipe has been setup sufficiently.</tt> </tt>
<a name="L216"></a><tt class="py-lineno">216</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L217"></a><tt class="py-lineno">217</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pipe:              The data pipe to check, defaulting to the current pipe.</tt> </tt>
<a name="L218"></a><tt class="py-lineno">218</tt>  <tt class="py-line"><tt class="py-docstring">    @type pipe:                 None or str</tt> </tt>
<a name="L219"></a><tt class="py-lineno">219</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pcs_id:            The PCS ID string to check for in cdp.pcs_ids.</tt> </tt>
<a name="L220"></a><tt class="py-lineno">220</tt>  <tt class="py-line"><tt class="py-docstring">    @type pcs_id:               None or str</tt> </tt>
<a name="L221"></a><tt class="py-lineno">221</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword sequence:          A flag which when True will invoke the sequence data check.</tt> </tt>
<a name="L222"></a><tt class="py-lineno">222</tt>  <tt class="py-line"><tt class="py-docstring">    @type sequence:             bool</tt> </tt>
<a name="L223"></a><tt class="py-lineno">223</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword N:                 A flag which if True will check that cdp.N is set.</tt> </tt>
<a name="L224"></a><tt class="py-lineno">224</tt>  <tt class="py-line"><tt class="py-docstring">    @type N:                    bool</tt> </tt>
<a name="L225"></a><tt class="py-lineno">225</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword tensors:           A flag which if True will check that alignment tensors exist.</tt> </tt>
<a name="L226"></a><tt class="py-lineno">226</tt>  <tt class="py-line"><tt class="py-docstring">    @type tensors:              bool</tt> </tt>
<a name="L227"></a><tt class="py-lineno">227</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pcs:               A flag which if True will check that PCSs exist.</tt> </tt>
<a name="L228"></a><tt class="py-lineno">228</tt>  <tt class="py-line"><tt class="py-docstring">    @type pcs:                  bool</tt> </tt>
<a name="L229"></a><tt class="py-lineno">229</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword paramag_centre:    A flag which if True will check that the paramagnetic centre has been set.</tt> </tt>
<a name="L230"></a><tt class="py-lineno">230</tt>  <tt class="py-line"><tt class="py-docstring">    @type paramag_centre:       bool</tt> </tt>
<a name="L231"></a><tt class="py-lineno">231</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L232"></a><tt class="py-lineno">232</tt>  <tt class="py-line"> </tt>
<a name="L233"></a><tt class="py-lineno">233</tt>  <tt class="py-line">    <tt class="py-comment"># The data pipe.</tt> </tt>
<a name="L234"></a><tt class="py-lineno">234</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-106" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-106', 'pipe', 'link-67');">pipe</a></tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L235"></a><tt class="py-lineno">235</tt>  <tt class="py-line">        <tt id="link-107" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-107', 'pipe', 'link-67');">pipe</a></tt> <tt class="py-op">=</tt> <tt id="link-108" class="py-name"><a title="generic_fns.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-108', 'pipes', 'link-3');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-109" class="py-name"><a title="generic_fns.pipes.cdp_name" class="py-name" href="#" onclick="return doclink('link-109', 'cdp_name', 'link-70');">cdp_name</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L236"></a><tt class="py-lineno">236</tt>  <tt class="py-line"> </tt>
<a name="L237"></a><tt class="py-lineno">237</tt>  <tt class="py-line">    <tt class="py-comment"># Get the data pipe.</tt> </tt>
<a name="L238"></a><tt class="py-lineno">238</tt>  <tt class="py-line">    <tt class="py-name">dp</tt> <tt class="py-op">=</tt> <tt id="link-110" class="py-name"><a title="generic_fns.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-110', 'pipes', 'link-3');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-111" class="py-name"><a title="generic_fns.pipes.get_pipe" class="py-name" href="#" onclick="return doclink('link-111', 'get_pipe', 'link-75');">get_pipe</a></tt><tt class="py-op">(</tt><tt id="link-112" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-112', 'pipe', 'link-67');">pipe</a></tt><tt class="py-op">)</tt> </tt>
<a name="L239"></a><tt class="py-lineno">239</tt>  <tt class="py-line"> </tt>
<a name="L240"></a><tt class="py-lineno">240</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L241"></a><tt class="py-lineno">241</tt>  <tt class="py-line">    <tt id="link-113" class="py-name"><a title="generic_fns.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-113', 'pipes', 'link-3');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-114" class="py-name" targets="Method bmrblib.pystarlib.TextTest.AllChecks.test()=bmrblib.pystarlib.TextTest.AllChecks-class.html#test,Method bmrblib.pystarlib.UtilsTest.AllChecks.test()=bmrblib.pystarlib.UtilsTest.AllChecks-class.html#test,Function generic_fns.pipes.test()=generic_fns.pipes-module.html#test"><a title="bmrblib.pystarlib.TextTest.AllChecks.test
bmrblib.pystarlib.UtilsTest.AllChecks.test
generic_fns.pipes.test" class="py-name" href="#" onclick="return doclink('link-114', 'test', 'link-114');">test</a></tt><tt class="py-op">(</tt><tt id="link-115" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-115', 'pipe', 'link-67');">pipe</a></tt><tt class="py-op">)</tt> </tt>
<a name="L242"></a><tt class="py-lineno">242</tt>  <tt class="py-line"> </tt>
<a name="L243"></a><tt class="py-lineno">243</tt>  <tt class="py-line">    <tt class="py-comment"># Test if sequence data exists.</tt> </tt>
<a name="L244"></a><tt class="py-lineno">244</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-116" class="py-name"><a title="generic_fns.sequence
gui.input_elements.sequence
test_suite.system_tests.sequence
user_functions.sequence" class="py-name" href="#" onclick="return doclink('link-116', 'sequence', 'link-40');">sequence</a></tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt id="link-117" class="py-name"><a title="generic_fns.mol_res_spin.exists_mol_res_spin_data" class="py-name" href="#" onclick="return doclink('link-117', 'exists_mol_res_spin_data', 'link-9');">exists_mol_res_spin_data</a></tt><tt class="py-op">(</tt><tt id="link-118" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-118', 'pipe', 'link-67');">pipe</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L245"></a><tt class="py-lineno">245</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-119" class="py-name"><a title="relax_errors.RelaxNoSequenceError" class="py-name" href="#" onclick="return doclink('link-119', 'RelaxNoSequenceError', 'link-30');">RelaxNoSequenceError</a></tt><tt class="py-op">(</tt><tt id="link-120" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-120', 'pipe', 'link-67');">pipe</a></tt><tt class="py-op">)</tt> </tt>
<a name="L246"></a><tt class="py-lineno">246</tt>  <tt class="py-line"> </tt>
<a name="L247"></a><tt class="py-lineno">247</tt>  <tt class="py-line">    <tt class="py-comment"># Check for dp.N.</tt> </tt>
<a name="L248"></a><tt class="py-lineno">248</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">N</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">dp</tt><tt class="py-op">,</tt> <tt class="py-string">'N'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L249"></a><tt class="py-lineno">249</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-121" class="py-name"><a title="relax_errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-121', 'RelaxError', 'link-25');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The number of states N has not been set."</tt><tt class="py-op">)</tt> </tt>
<a name="L250"></a><tt class="py-lineno">250</tt>  <tt class="py-line"> </tt>
<a name="L251"></a><tt class="py-lineno">251</tt>  <tt class="py-line">    <tt class="py-comment"># Check that alignment tensors are present.</tt> </tt>
<a name="L252"></a><tt class="py-lineno">252</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">tensors</tt> <tt class="py-keyword">and</tt> <tt class="py-op">(</tt><tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">dp</tt><tt class="py-op">,</tt> <tt class="py-string">'align_tensors'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">dp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">)</tt> <tt class="py-op">==</tt> <tt class="py-number">0</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L253"></a><tt class="py-lineno">253</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-122" class="py-name" targets="Class relax_errors.RelaxNoTensorError=relax_errors.RelaxNoTensorError-class.html"><a title="relax_errors.RelaxNoTensorError" class="py-name" href="#" onclick="return doclink('link-122', 'RelaxNoTensorError', 'link-122');">RelaxNoTensorError</a></tt><tt class="py-op">(</tt><tt class="py-string">'alignment'</tt><tt class="py-op">)</tt> </tt>
<a name="L254"></a><tt class="py-lineno">254</tt>  <tt class="py-line"> </tt>
<a name="L255"></a><tt class="py-lineno">255</tt>  <tt class="py-line">    <tt class="py-comment"># Test for the alignment ID.</tt> </tt>
<a name="L256"></a><tt class="py-lineno">256</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">pcs_id</tt> <tt class="py-keyword">and</tt> <tt class="py-op">(</tt><tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">dp</tt><tt class="py-op">,</tt> <tt class="py-string">'align_ids'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-name">pcs_id</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt class="py-name">dp</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L257"></a><tt class="py-lineno">257</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-123" class="py-name"><a title="relax_errors.RelaxNoAlignError" class="py-name" href="#" onclick="return doclink('link-123', 'RelaxNoAlignError', 'link-27');">RelaxNoAlignError</a></tt><tt class="py-op">(</tt><tt class="py-name">pcs_id</tt><tt class="py-op">,</tt> <tt id="link-124" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-124', 'pipe', 'link-67');">pipe</a></tt><tt class="py-op">)</tt> </tt>
<a name="L258"></a><tt class="py-lineno">258</tt>  <tt class="py-line"> </tt>
<a name="L259"></a><tt class="py-lineno">259</tt>  <tt class="py-line">    <tt class="py-comment"># Test if PCS data exists.</tt> </tt>
<a name="L260"></a><tt class="py-lineno">260</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-125" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-125', 'pcs', 'link-15');">pcs</a></tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">dp</tt><tt class="py-op">,</tt> <tt class="py-string">'align_ids'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L261"></a><tt class="py-lineno">261</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-126" class="py-name"><a title="relax_errors.RelaxNoAlignError" class="py-name" href="#" onclick="return doclink('link-126', 'RelaxNoAlignError', 'link-27');">RelaxNoAlignError</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L262"></a><tt class="py-lineno">262</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-127" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-127', 'pcs', 'link-15');">pcs</a></tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">dp</tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_ids'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L263"></a><tt class="py-lineno">263</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-128" class="py-name"><a title="relax_errors.RelaxNoPCSError" class="py-name" href="#" onclick="return doclink('link-128', 'RelaxNoPCSError', 'link-29');">RelaxNoPCSError</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L264"></a><tt class="py-lineno">264</tt>  <tt class="py-line">    <tt class="py-keyword">elif</tt> <tt id="link-129" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-129', 'pcs', 'link-15');">pcs</a></tt> <tt class="py-keyword">and</tt> <tt class="py-name">pcs_id</tt> <tt class="py-keyword">and</tt> <tt class="py-name">pcs_id</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt class="py-name">dp</tt><tt class="py-op">.</tt><tt class="py-name">pcs_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L265"></a><tt class="py-lineno">265</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-130" class="py-name"><a title="relax_errors.RelaxNoPCSError" class="py-name" href="#" onclick="return doclink('link-130', 'RelaxNoPCSError', 'link-29');">RelaxNoPCSError</a></tt><tt class="py-op">(</tt><tt class="py-name">pcs_id</tt><tt class="py-op">)</tt> </tt>
<a name="L266"></a><tt class="py-lineno">266</tt>  <tt class="py-line"> </tt>
<a name="L267"></a><tt class="py-lineno">267</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the paramagnetic centre is set.</tt> </tt>
<a name="L268"></a><tt class="py-lineno">268</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-131" class="py-name"><a title="maths_fns.paramag_centre" class="py-name" href="#" onclick="return doclink('link-131', 'paramag_centre', 'link-41');">paramag_centre</a></tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'paramagnetic_centre'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L269"></a><tt class="py-lineno">269</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-132" class="py-name"><a title="relax_errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-132', 'RelaxError', 'link-25');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The paramagnetic centre has not been defined."</tt><tt class="py-op">)</tt> </tt>
</div><a name="L270"></a><tt class="py-lineno">270</tt>  <tt class="py-line"> </tt>
<a name="L271"></a><tt class="py-lineno">271</tt>  <tt class="py-line"> </tt>
<a name="copy"></a><div id="copy-def"><a name="L272"></a><tt class="py-lineno">272</tt> <a class="py-toggle" href="#" id="copy-toggle" onclick="return toggle('copy');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.pcs-module.html#copy">copy</a><tt class="py-op">(</tt><tt class="py-param">pipe_from</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">pipe_to</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">align_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="copy-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="copy-expanded"><a name="L273"></a><tt class="py-lineno">273</tt>  <tt class="py-line">    <tt class="py-docstring">"""Copy the PCS data from one data pipe to another.</tt> </tt>
<a name="L274"></a><tt class="py-lineno">274</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L275"></a><tt class="py-lineno">275</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pipe_from: The data pipe to copy the PCS data from.  This defaults to the current data pipe.</tt> </tt>
<a name="L276"></a><tt class="py-lineno">276</tt>  <tt class="py-line"><tt class="py-docstring">    @type pipe_from:    str</tt> </tt>
<a name="L277"></a><tt class="py-lineno">277</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pipe_to:   The data pipe to copy the PCS data to.  This defaults to the current data pipe.</tt> </tt>
<a name="L278"></a><tt class="py-lineno">278</tt>  <tt class="py-line"><tt class="py-docstring">    @type pipe_to:      str</tt> </tt>
<a name="L279"></a><tt class="py-lineno">279</tt>  <tt class="py-line"><tt class="py-docstring">    @param align_id:    The alignment ID string.</tt> </tt>
<a name="L280"></a><tt class="py-lineno">280</tt>  <tt class="py-line"><tt class="py-docstring">    @type align_id:     str</tt> </tt>
<a name="L281"></a><tt class="py-lineno">281</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L282"></a><tt class="py-lineno">282</tt>  <tt class="py-line"> </tt>
<a name="L283"></a><tt class="py-lineno">283</tt>  <tt class="py-line">    <tt class="py-comment"># Defaults.</tt> </tt>
<a name="L284"></a><tt class="py-lineno">284</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">pipe_from</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt> <tt class="py-keyword">and</tt> <tt class="py-name">pipe_to</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L285"></a><tt class="py-lineno">285</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-133" class="py-name"><a title="relax_errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-133', 'RelaxError', 'link-25');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The pipe_from and pipe_to arguments cannot both be set to None."</tt><tt class="py-op">)</tt> </tt>
<a name="L286"></a><tt class="py-lineno">286</tt>  <tt class="py-line">    <tt class="py-keyword">elif</tt> <tt class="py-name">pipe_from</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L287"></a><tt class="py-lineno">287</tt>  <tt class="py-line">        <tt class="py-name">pipe_from</tt> <tt class="py-op">=</tt> <tt id="link-134" class="py-name"><a title="generic_fns.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-134', 'pipes', 'link-3');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-135" class="py-name"><a title="generic_fns.pipes.cdp_name" class="py-name" href="#" onclick="return doclink('link-135', 'cdp_name', 'link-70');">cdp_name</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L288"></a><tt class="py-lineno">288</tt>  <tt class="py-line">    <tt class="py-keyword">elif</tt> <tt class="py-name">pipe_to</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L289"></a><tt class="py-lineno">289</tt>  <tt class="py-line">        <tt class="py-name">pipe_to</tt> <tt class="py-op">=</tt> <tt id="link-136" class="py-name"><a title="generic_fns.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-136', 'pipes', 'link-3');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-137" class="py-name"><a title="generic_fns.pipes.cdp_name" class="py-name" href="#" onclick="return doclink('link-137', 'cdp_name', 'link-70');">cdp_name</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L290"></a><tt class="py-lineno">290</tt>  <tt class="py-line"> </tt>
<a name="L291"></a><tt class="py-lineno">291</tt>  <tt class="py-line">    <tt class="py-comment"># Check the pipe setup.</tt> </tt>
<a name="L292"></a><tt class="py-lineno">292</tt>  <tt class="py-line">    <tt id="link-138" class="py-name"><a title="generic_fns.pcs.check_pipe_setup
generic_fns.rdc.check_pipe_setup" class="py-name" href="#" onclick="return doclink('link-138', 'check_pipe_setup', 'link-39');">check_pipe_setup</a></tt><tt class="py-op">(</tt><tt id="link-139" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-139', 'pipe', 'link-67');">pipe</a></tt><tt class="py-op">=</tt><tt class="py-name">pipe_from</tt><tt class="py-op">,</tt> <tt class="py-name">pcs_id</tt><tt class="py-op">=</tt><tt class="py-name">align_id</tt><tt class="py-op">,</tt> <tt id="link-140" class="py-name"><a title="generic_fns.sequence
gui.input_elements.sequence
test_suite.system_tests.sequence
user_functions.sequence" class="py-name" href="#" onclick="return doclink('link-140', 'sequence', 'link-40');">sequence</a></tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt id="link-141" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-141', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L293"></a><tt class="py-lineno">293</tt>  <tt class="py-line">    <tt id="link-142" class="py-name"><a title="generic_fns.pcs.check_pipe_setup
generic_fns.rdc.check_pipe_setup" class="py-name" href="#" onclick="return doclink('link-142', 'check_pipe_setup', 'link-39');">check_pipe_setup</a></tt><tt class="py-op">(</tt><tt id="link-143" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-143', 'pipe', 'link-67');">pipe</a></tt><tt class="py-op">=</tt><tt class="py-name">pipe_to</tt><tt class="py-op">,</tt> <tt id="link-144" class="py-name"><a title="generic_fns.sequence
gui.input_elements.sequence
test_suite.system_tests.sequence
user_functions.sequence" class="py-name" href="#" onclick="return doclink('link-144', 'sequence', 'link-40');">sequence</a></tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L294"></a><tt class="py-lineno">294</tt>  <tt class="py-line"> </tt>
<a name="L295"></a><tt class="py-lineno">295</tt>  <tt class="py-line">    <tt class="py-comment"># Get the data pipes.</tt> </tt>
<a name="L296"></a><tt class="py-lineno">296</tt>  <tt class="py-line">    <tt class="py-name">dp_from</tt> <tt class="py-op">=</tt> <tt id="link-145" class="py-name"><a title="generic_fns.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-145', 'pipes', 'link-3');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-146" class="py-name"><a title="generic_fns.pipes.get_pipe" class="py-name" href="#" onclick="return doclink('link-146', 'get_pipe', 'link-75');">get_pipe</a></tt><tt class="py-op">(</tt><tt class="py-name">pipe_from</tt><tt class="py-op">)</tt> </tt>
<a name="L297"></a><tt class="py-lineno">297</tt>  <tt class="py-line">    <tt class="py-name">dp_to</tt> <tt class="py-op">=</tt> <tt id="link-147" class="py-name"><a title="generic_fns.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-147', 'pipes', 'link-3');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-148" class="py-name"><a title="generic_fns.pipes.get_pipe" class="py-name" href="#" onclick="return doclink('link-148', 'get_pipe', 'link-75');">get_pipe</a></tt><tt class="py-op">(</tt><tt class="py-name">pipe_to</tt><tt class="py-op">)</tt> </tt>
<a name="L298"></a><tt class="py-lineno">298</tt>  <tt class="py-line"> </tt>
<a name="L299"></a><tt class="py-lineno">299</tt>  <tt class="py-line">    <tt class="py-comment"># The IDs.</tt> </tt>
<a name="L300"></a><tt class="py-lineno">300</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">align_id</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L301"></a><tt class="py-lineno">301</tt>  <tt class="py-line">        <tt class="py-name">align_ids</tt> <tt class="py-op">=</tt> <tt class="py-name">dp_from</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt> </tt>
<a name="L302"></a><tt class="py-lineno">302</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L303"></a><tt class="py-lineno">303</tt>  <tt class="py-line">        <tt class="py-name">align_ids</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt> </tt>
<a name="L304"></a><tt class="py-lineno">304</tt>  <tt class="py-line"> </tt>
<a name="L305"></a><tt class="py-lineno">305</tt>  <tt class="py-line">    <tt class="py-comment"># Init target pipe global structures.</tt> </tt>
<a name="L306"></a><tt class="py-lineno">306</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">dp_to</tt><tt class="py-op">,</tt> <tt class="py-string">'align_ids'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L307"></a><tt class="py-lineno">307</tt>  <tt class="py-line">        <tt class="py-name">dp_to</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L308"></a><tt class="py-lineno">308</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">dp_to</tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_ids'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L309"></a><tt class="py-lineno">309</tt>  <tt class="py-line">        <tt class="py-name">dp_to</tt><tt class="py-op">.</tt><tt class="py-name">pcs_ids</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L310"></a><tt class="py-lineno">310</tt>  <tt class="py-line"> </tt>
<a name="L311"></a><tt class="py-lineno">311</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over the align IDs.</tt> </tt>
<a name="L312"></a><tt class="py-lineno">312</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt class="py-name">align_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L313"></a><tt class="py-lineno">313</tt>  <tt class="py-line">        <tt class="py-comment"># Copy the global data.</tt> </tt>
<a name="L314"></a><tt class="py-lineno">314</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt class="py-name">dp_to</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt> <tt class="py-keyword">and</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt class="py-name">dp_to</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L315"></a><tt class="py-lineno">315</tt>  <tt class="py-line">            <tt class="py-name">dp_to</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt><tt class="py-op">.</tt><tt id="link-149" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-149', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">align_id</tt><tt class="py-op">)</tt> </tt>
<a name="L316"></a><tt class="py-lineno">316</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt class="py-name">dp_from</tt><tt class="py-op">.</tt><tt class="py-name">pcs_ids</tt> <tt class="py-keyword">and</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt class="py-name">dp_to</tt><tt class="py-op">.</tt><tt class="py-name">pcs_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L317"></a><tt class="py-lineno">317</tt>  <tt class="py-line">            <tt class="py-name">dp_to</tt><tt class="py-op">.</tt><tt class="py-name">pcs_ids</tt><tt class="py-op">.</tt><tt id="link-150" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-150', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">align_id</tt><tt class="py-op">)</tt> </tt>
<a name="L318"></a><tt class="py-lineno">318</tt>  <tt class="py-line"> </tt>
<a name="L319"></a><tt class="py-lineno">319</tt>  <tt class="py-line">        <tt class="py-comment"># Spin loop.</tt> </tt>
<a name="L320"></a><tt class="py-lineno">320</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">mol_index</tt><tt class="py-op">,</tt> <tt class="py-name">res_index</tt><tt class="py-op">,</tt> <tt class="py-name">spin_index</tt> <tt class="py-keyword">in</tt> <tt id="link-151" class="py-name"><a title="generic_fns.mol_res_spin.spin_index_loop" class="py-name" href="#" onclick="return doclink('link-151', 'spin_index_loop', 'link-12');">spin_index_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L321"></a><tt class="py-lineno">321</tt>  <tt class="py-line">            <tt class="py-comment"># Alias the spin containers.</tt> </tt>
<a name="L322"></a><tt class="py-lineno">322</tt>  <tt class="py-line">            <tt class="py-name">spin_from</tt> <tt class="py-op">=</tt> <tt class="py-name">dp_from</tt><tt class="py-op">.</tt><tt class="py-name">mol</tt><tt class="py-op">[</tt><tt class="py-name">mol_index</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">res</tt><tt class="py-op">[</tt><tt class="py-name">res_index</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-152" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-152', 'spin', 'link-44');">spin</a></tt><tt class="py-op">[</tt><tt class="py-name">spin_index</tt><tt class="py-op">]</tt> </tt>
<a name="L323"></a><tt class="py-lineno">323</tt>  <tt class="py-line">            <tt class="py-name">spin_to</tt> <tt class="py-op">=</tt> <tt class="py-name">dp_to</tt><tt class="py-op">.</tt><tt class="py-name">mol</tt><tt class="py-op">[</tt><tt class="py-name">mol_index</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">res</tt><tt class="py-op">[</tt><tt class="py-name">res_index</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-153" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-153', 'spin', 'link-44');">spin</a></tt><tt class="py-op">[</tt><tt class="py-name">spin_index</tt><tt class="py-op">]</tt> </tt>
<a name="L324"></a><tt class="py-lineno">324</tt>  <tt class="py-line"> </tt>
<a name="L325"></a><tt class="py-lineno">325</tt>  <tt class="py-line">            <tt class="py-comment"># No data or errors.</tt> </tt>
<a name="L326"></a><tt class="py-lineno">326</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-op">(</tt><tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">spin_from</tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt class="py-name">spin_from</tt><tt class="py-op">.</tt><tt id="link-154" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-154', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-op">(</tt><tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">spin_from</tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_err'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt class="py-name">spin_from</tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L327"></a><tt class="py-lineno">327</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L328"></a><tt class="py-lineno">328</tt>  <tt class="py-line"> </tt>
<a name="L329"></a><tt class="py-lineno">329</tt>  <tt class="py-line">            <tt class="py-comment"># Initialise the spin data if necessary.</tt> </tt>
<a name="L330"></a><tt class="py-lineno">330</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">spin_from</tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">spin_to</tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L331"></a><tt class="py-lineno">331</tt>  <tt class="py-line">                <tt class="py-name">spin_to</tt><tt class="py-op">.</tt><tt id="link-155" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-155', 'pcs', 'link-15');">pcs</a></tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L332"></a><tt class="py-lineno">332</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">spin_from</tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_err'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">spin_to</tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_err'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L333"></a><tt class="py-lineno">333</tt>  <tt class="py-line">                <tt class="py-name">spin_to</tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L334"></a><tt class="py-lineno">334</tt>  <tt class="py-line"> </tt>
<a name="L335"></a><tt class="py-lineno">335</tt>  <tt class="py-line">            <tt class="py-comment"># Copy the value and error from pipe_from.</tt> </tt>
<a name="L336"></a><tt class="py-lineno">336</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">spin_from</tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L337"></a><tt class="py-lineno">337</tt>  <tt class="py-line">                <tt class="py-name">spin_to</tt><tt class="py-op">.</tt><tt id="link-156" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-156', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">spin_from</tt><tt class="py-op">.</tt><tt id="link-157" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-157', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt> </tt>
<a name="L338"></a><tt class="py-lineno">338</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">spin_from</tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_err'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L339"></a><tt class="py-lineno">339</tt>  <tt class="py-line">                <tt class="py-name">spin_to</tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">spin_from</tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt> </tt>
</div><a name="L340"></a><tt class="py-lineno">340</tt>  <tt class="py-line"> </tt>
<a name="L341"></a><tt class="py-lineno">341</tt>  <tt class="py-line"> </tt>
<a name="corr_plot"></a><div id="corr_plot-def"><a name="L342"></a><tt class="py-lineno">342</tt> <a class="py-toggle" href="#" id="corr_plot-toggle" onclick="return toggle('corr_plot');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.pcs-module.html#corr_plot">corr_plot</a><tt class="py-op">(</tt><tt class="py-param">format</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">file</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">dir</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">force</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="corr_plot-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="corr_plot-expanded"><a name="L343"></a><tt class="py-lineno">343</tt>  <tt class="py-line">    <tt class="py-docstring">"""Generate a correlation plot of the measured vs. back-calculated PCSs.</tt> </tt>
<a name="L344"></a><tt class="py-lineno">344</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L345"></a><tt class="py-lineno">345</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword format:    The format for the plot file.  The following values are accepted: 'grace', a Grace plot; None, a plain text file.</tt> </tt>
<a name="L346"></a><tt class="py-lineno">346</tt>  <tt class="py-line"><tt class="py-docstring">    @type format:       str or None</tt> </tt>
<a name="L347"></a><tt class="py-lineno">347</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword file:      The file name or object to write to.</tt> </tt>
<a name="L348"></a><tt class="py-lineno">348</tt>  <tt class="py-line"><tt class="py-docstring">    @type file:         str or file object</tt> </tt>
<a name="L349"></a><tt class="py-lineno">349</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword dir:       The name of the directory to place the file into (defaults to the current directory).</tt> </tt>
<a name="L350"></a><tt class="py-lineno">350</tt>  <tt class="py-line"><tt class="py-docstring">    @type dir:          str</tt> </tt>
<a name="L351"></a><tt class="py-lineno">351</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword force:     A flag which if True will cause any pre-existing file to be overwritten.</tt> </tt>
<a name="L352"></a><tt class="py-lineno">352</tt>  <tt class="py-line"><tt class="py-docstring">    @type force:        bool</tt> </tt>
<a name="L353"></a><tt class="py-lineno">353</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L354"></a><tt class="py-lineno">354</tt>  <tt class="py-line"> </tt>
<a name="L355"></a><tt class="py-lineno">355</tt>  <tt class="py-line">    <tt class="py-comment"># Check the pipe setup.</tt> </tt>
<a name="L356"></a><tt class="py-lineno">356</tt>  <tt class="py-line">    <tt id="link-158" class="py-name"><a title="generic_fns.pcs.check_pipe_setup
generic_fns.rdc.check_pipe_setup" class="py-name" href="#" onclick="return doclink('link-158', 'check_pipe_setup', 'link-39');">check_pipe_setup</a></tt><tt class="py-op">(</tt><tt id="link-159" class="py-name"><a title="generic_fns.sequence
gui.input_elements.sequence
test_suite.system_tests.sequence
user_functions.sequence" class="py-name" href="#" onclick="return doclink('link-159', 'sequence', 'link-40');">sequence</a></tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L357"></a><tt class="py-lineno">357</tt>  <tt class="py-line"> </tt>
<a name="L358"></a><tt class="py-lineno">358</tt>  <tt class="py-line">    <tt class="py-comment"># Does PCS data exist?</tt> </tt>
<a name="L359"></a><tt class="py-lineno">359</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_ids'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pcs_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L360"></a><tt class="py-lineno">360</tt>  <tt class="py-line">        <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-160" class="py-name"><a title="relax_warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-160', 'RelaxWarning', 'link-37');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"No PCS data exists, skipping file creation."</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L361"></a><tt class="py-lineno">361</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> </tt>
<a name="L362"></a><tt class="py-lineno">362</tt>  <tt class="py-line"> </tt>
<a name="L363"></a><tt class="py-lineno">363</tt>  <tt class="py-line">    <tt class="py-comment"># Open the file for writing.</tt> </tt>
<a name="L364"></a><tt class="py-lineno">364</tt>  <tt class="py-line">    <tt id="link-161" class="py-name" targets="Variable check_types.file=check_types-module.html#file,Variable dep_check.file=dep_check-module.html#file,Module gui.input_elements.file=gui.input_elements.file-module.html"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-161', 'file', 'link-161');">file</a></tt> <tt class="py-op">=</tt> <tt id="link-162" class="py-name"><a title="relax_io.open_write_file" class="py-name" href="#" onclick="return doclink('link-162', 'open_write_file', 'link-33');">open_write_file</a></tt><tt class="py-op">(</tt><tt id="link-163" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-163', 'file', 'link-161');">file</a></tt><tt class="py-op">,</tt> <tt id="link-164" class="py-name" targets="Module gui.input_elements.dir=gui.input_elements.dir-module.html"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-164', 'dir', 'link-164');">dir</a></tt><tt class="py-op">,</tt> <tt class="py-name">force</tt><tt class="py-op">)</tt> </tt>
<a name="L365"></a><tt class="py-lineno">365</tt>  <tt class="py-line"> </tt>
<a name="L366"></a><tt class="py-lineno">366</tt>  <tt class="py-line">    <tt class="py-comment"># Init.</tt> </tt>
<a name="L367"></a><tt class="py-lineno">367</tt>  <tt class="py-line">    <tt id="link-165" class="py-name" targets="Package data=data-module.html,Module user_functions.data=user_functions.data-module.html"><a title="data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-165', 'data', 'link-165');">data</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L368"></a><tt class="py-lineno">368</tt>  <tt class="py-line"> </tt>
<a name="L369"></a><tt class="py-lineno">369</tt>  <tt class="py-line">    <tt class="py-comment"># The diagonal.</tt> </tt>
<a name="L370"></a><tt class="py-lineno">370</tt>  <tt class="py-line">    <tt id="link-166" class="py-name"><a title="data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-166', 'data', 'link-165');">data</a></tt><tt class="py-op">.</tt><tt id="link-167" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-167', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">100</tt><tt class="py-op">,</tt> <tt class="py-op">-</tt><tt class="py-number">100</tt><tt class="py-op">,</tt> <tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-op">[</tt><tt class="py-number">100</tt><tt class="py-op">,</tt> <tt class="py-number">100</tt><tt class="py-op">,</tt> <tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L371"></a><tt class="py-lineno">371</tt>  <tt class="py-line"> </tt>
<a name="L372"></a><tt class="py-lineno">372</tt>  <tt class="py-line">    <tt class="py-comment"># The spin types.</tt> </tt>
<a name="L373"></a><tt class="py-lineno">373</tt>  <tt class="py-line">    <tt class="py-name">types</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L374"></a><tt class="py-lineno">374</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-168" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-168', 'spin', 'link-44');">spin</a></tt> <tt class="py-keyword">in</tt> <tt id="link-169" class="py-name"><a title="generic_fns.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-169', 'spin_loop', 'link-13');">spin_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L375"></a><tt class="py-lineno">375</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-170" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-170', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">element</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt class="py-name">types</tt><tt class="py-op">:</tt> </tt>
<a name="L376"></a><tt class="py-lineno">376</tt>  <tt class="py-line">            <tt class="py-name">types</tt><tt class="py-op">.</tt><tt id="link-171" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-171', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt id="link-172" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-172', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">element</tt><tt class="py-op">)</tt> </tt>
<a name="L377"></a><tt class="py-lineno">377</tt>  <tt class="py-line"> </tt>
<a name="L378"></a><tt class="py-lineno">378</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over the PCS data.</tt> </tt>
<a name="L379"></a><tt class="py-lineno">379</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pcs_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L380"></a><tt class="py-lineno">380</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the spin types.</tt> </tt>
<a name="L381"></a><tt class="py-lineno">381</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-173" class="py-name" targets="Variable user_functions.molecule.i=user_functions.molecule-module.html#i"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-173', 'i', 'link-173');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">types</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L382"></a><tt class="py-lineno">382</tt>  <tt class="py-line">            <tt class="py-comment"># Append a new list for this alignment.</tt> </tt>
<a name="L383"></a><tt class="py-lineno">383</tt>  <tt class="py-line">            <tt id="link-174" class="py-name"><a title="data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-174', 'data', 'link-165');">data</a></tt><tt class="py-op">.</tt><tt id="link-175" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-175', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L384"></a><tt class="py-lineno">384</tt>  <tt class="py-line"> </tt>
<a name="L385"></a><tt class="py-lineno">385</tt>  <tt class="py-line">            <tt class="py-comment"># Errors present?</tt> </tt>
<a name="L386"></a><tt class="py-lineno">386</tt>  <tt class="py-line">            <tt class="py-name">err_flag</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L387"></a><tt class="py-lineno">387</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-176" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-176', 'spin', 'link-44');">spin</a></tt> <tt class="py-keyword">in</tt> <tt id="link-177" class="py-name"><a title="generic_fns.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-177', 'spin_loop', 'link-13');">spin_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L388"></a><tt class="py-lineno">388</tt>  <tt class="py-line">                <tt class="py-comment"># Skip deselected spins.</tt> </tt>
<a name="L389"></a><tt class="py-lineno">389</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-178" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-178', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt id="link-179" class="py-name" targets="Function generic_fns.model_selection.select()=generic_fns.model_selection-module.html#select,Module user_functions.select=user_functions.select-module.html"><a title="generic_fns.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-179', 'select', 'link-179');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L390"></a><tt class="py-lineno">390</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L391"></a><tt class="py-lineno">391</tt>  <tt class="py-line"> </tt>
<a name="L392"></a><tt class="py-lineno">392</tt>  <tt class="py-line">                <tt class="py-comment"># Error present.</tt> </tt>
<a name="L393"></a><tt class="py-lineno">393</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-180" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-180', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_err'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt id="link-181" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-181', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt><tt class="py-op">.</tt><tt class="py-name">keys</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L394"></a><tt class="py-lineno">394</tt>  <tt class="py-line">                    <tt class="py-name">err_flag</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L395"></a><tt class="py-lineno">395</tt>  <tt class="py-line">                    <tt class="py-keyword">break</tt> </tt>
<a name="L396"></a><tt class="py-lineno">396</tt>  <tt class="py-line"> </tt>
<a name="L397"></a><tt class="py-lineno">397</tt>  <tt class="py-line">            <tt class="py-comment"># Loop over the spins.</tt> </tt>
<a name="L398"></a><tt class="py-lineno">398</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-182" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-182', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt id="link-183" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-183', 'spin_id', 'link-82');">spin_id</a></tt> <tt class="py-keyword">in</tt> <tt id="link-184" class="py-name"><a title="generic_fns.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-184', 'spin_loop', 'link-13');">spin_loop</a></tt><tt class="py-op">(</tt><tt class="py-name">return_id</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L399"></a><tt class="py-lineno">399</tt>  <tt class="py-line">                <tt class="py-comment"># Skip deselected spins.</tt> </tt>
<a name="L400"></a><tt class="py-lineno">400</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-185" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-185', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt id="link-186" class="py-name"><a title="generic_fns.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-186', 'select', 'link-179');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L401"></a><tt class="py-lineno">401</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L402"></a><tt class="py-lineno">402</tt>  <tt class="py-line"> </tt>
<a name="L403"></a><tt class="py-lineno">403</tt>  <tt class="py-line">                <tt class="py-comment"># Incorrect spin type.</tt> </tt>
<a name="L404"></a><tt class="py-lineno">404</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt id="link-187" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-187', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">element</tt> <tt class="py-op">!=</tt> <tt class="py-name">types</tt><tt class="py-op">[</tt><tt id="link-188" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-188', 'i', 'link-173');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L405"></a><tt class="py-lineno">405</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L406"></a><tt class="py-lineno">406</tt>  <tt class="py-line"> </tt>
<a name="L407"></a><tt class="py-lineno">407</tt>  <tt class="py-line">                <tt class="py-comment"># Skip if data is missing.</tt> </tt>
<a name="L408"></a><tt class="py-lineno">408</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-189" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-189', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-190" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-190', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_bc'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt id="link-191" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-191', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt id="link-192" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-192', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">.</tt><tt class="py-name">keys</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt id="link-193" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-193', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_bc</tt><tt class="py-op">.</tt><tt class="py-name">keys</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L409"></a><tt class="py-lineno">409</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L410"></a><tt class="py-lineno">410</tt>  <tt class="py-line"> </tt>
<a name="L411"></a><tt class="py-lineno">411</tt>  <tt class="py-line">                <tt class="py-comment"># Append the data.</tt> </tt>
<a name="L412"></a><tt class="py-lineno">412</tt>  <tt class="py-line">                <tt id="link-194" class="py-name"><a title="data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-194', 'data', 'link-165');">data</a></tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-195" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-195', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt id="link-196" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-196', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_bc</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt id="link-197" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-197', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt id="link-198" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-198', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L413"></a><tt class="py-lineno">413</tt>  <tt class="py-line"> </tt>
<a name="L414"></a><tt class="py-lineno">414</tt>  <tt class="py-line">                <tt class="py-comment"># Errors.</tt> </tt>
<a name="L415"></a><tt class="py-lineno">415</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">err_flag</tt><tt class="py-op">:</tt> </tt>
<a name="L416"></a><tt class="py-lineno">416</tt>  <tt class="py-line">                    <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-199" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-199', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_err'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt id="link-200" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-200', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt><tt class="py-op">.</tt><tt class="py-name">keys</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L417"></a><tt class="py-lineno">417</tt>  <tt class="py-line">                        <tt id="link-201" class="py-name"><a title="data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-201', 'data', 'link-165');">data</a></tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-202" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-202', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt id="link-203" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-203', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L418"></a><tt class="py-lineno">418</tt>  <tt class="py-line">                    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L419"></a><tt class="py-lineno">419</tt>  <tt class="py-line">                        <tt id="link-204" class="py-name"><a title="data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-204', 'data', 'link-165');">data</a></tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-205" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-205', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">None</tt><tt class="py-op">)</tt> </tt>
<a name="L420"></a><tt class="py-lineno">420</tt>  <tt class="py-line"> </tt>
<a name="L421"></a><tt class="py-lineno">421</tt>  <tt class="py-line">                <tt class="py-comment"># Label.</tt> </tt>
<a name="L422"></a><tt class="py-lineno">422</tt>  <tt class="py-line">                <tt id="link-206" class="py-name"><a title="data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-206', 'data', 'link-165');">data</a></tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-207" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-207', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt id="link-208" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-208', 'spin_id', 'link-82');">spin_id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L423"></a><tt class="py-lineno">423</tt>  <tt class="py-line"> </tt>
<a name="L424"></a><tt class="py-lineno">424</tt>  <tt class="py-line">    <tt class="py-comment"># The data size.</tt> </tt>
<a name="L425"></a><tt class="py-lineno">425</tt>  <tt class="py-line">    <tt id="link-209" class="py-name" targets="Variable gui.results_viewer.Results_viewer.size=gui.results_viewer.Results_viewer-class.html#size"><a title="gui.results_viewer.Results_viewer.size" class="py-name" href="#" onclick="return doclink('link-209', 'size', 'link-209');">size</a></tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-210" class="py-name"><a title="data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-210', 'data', 'link-165');">data</a></tt><tt class="py-op">)</tt> </tt>
<a name="L426"></a><tt class="py-lineno">426</tt>  <tt class="py-line"> </tt>
<a name="L427"></a><tt class="py-lineno">427</tt>  <tt class="py-line">    <tt class="py-comment"># Only one data set.</tt> </tt>
<a name="L428"></a><tt class="py-lineno">428</tt>  <tt class="py-line">    <tt id="link-211" class="py-name"><a title="data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-211', 'data', 'link-165');">data</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt id="link-212" class="py-name"><a title="data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-212', 'data', 'link-165');">data</a></tt><tt class="py-op">]</tt> </tt>
<a name="L429"></a><tt class="py-lineno">429</tt>  <tt class="py-line"> </tt>
<a name="L430"></a><tt class="py-lineno">430</tt>  <tt class="py-line">    <tt class="py-comment"># Graph type.</tt> </tt>
<a name="L431"></a><tt class="py-lineno">431</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">err_flag</tt><tt class="py-op">:</tt> </tt>
<a name="L432"></a><tt class="py-lineno">432</tt>  <tt class="py-line">        <tt class="py-name">graph_type</tt> <tt class="py-op">=</tt> <tt class="py-string">'xydy'</tt> </tt>
<a name="L433"></a><tt class="py-lineno">433</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L434"></a><tt class="py-lineno">434</tt>  <tt class="py-line">        <tt class="py-name">graph_type</tt> <tt class="py-op">=</tt> <tt class="py-string">'xy'</tt> </tt>
<a name="L435"></a><tt class="py-lineno">435</tt>  <tt class="py-line"> </tt>
<a name="L436"></a><tt class="py-lineno">436</tt>  <tt class="py-line">    <tt class="py-comment"># Grace file.</tt> </tt>
<a name="L437"></a><tt class="py-lineno">437</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-213" class="py-name" targets="Function relax_warnings.format()=relax_warnings-module.html#format"><a title="relax_warnings.format" class="py-name" href="#" onclick="return doclink('link-213', 'format', 'link-213');">format</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'grace'</tt><tt class="py-op">:</tt> </tt>
<a name="L438"></a><tt class="py-lineno">438</tt>  <tt class="py-line">        <tt class="py-comment"># The set names.</tt> </tt>
<a name="L439"></a><tt class="py-lineno">439</tt>  <tt class="py-line">        <tt class="py-name">set_names</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-name">None</tt><tt class="py-op">]</tt> </tt>
<a name="L440"></a><tt class="py-lineno">440</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-214" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-214', 'i', 'link-173');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pcs_ids</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L441"></a><tt class="py-lineno">441</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">j</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">types</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L442"></a><tt class="py-lineno">442</tt>  <tt class="py-line">                <tt class="py-name">set_names</tt><tt class="py-op">.</tt><tt id="link-215" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-215', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-string">"%s (%s)"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pcs_ids</tt><tt class="py-op">[</tt><tt id="link-216" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-216', 'i', 'link-173');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">types</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L443"></a><tt class="py-lineno">443</tt>  <tt class="py-line"> </tt>
<a name="L444"></a><tt class="py-lineno">444</tt>  <tt class="py-line">        <tt class="py-comment"># The header.</tt> </tt>
<a name="L445"></a><tt class="py-lineno">445</tt>  <tt class="py-line">        <tt id="link-217" class="py-name"><a title="generic_fns.grace
test_suite.system_tests.grace
user_functions.grace" class="py-name" href="#" onclick="return doclink('link-217', 'grace', 'link-2');">grace</a></tt><tt class="py-op">.</tt><tt id="link-218" class="py-name" targets="Function generic_fns.grace.write_xy_header()=generic_fns.grace-module.html#write_xy_header"><a title="generic_fns.grace.write_xy_header" class="py-name" href="#" onclick="return doclink('link-218', 'write_xy_header', 'link-218');">write_xy_header</a></tt><tt class="py-op">(</tt><tt id="link-219" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-219', 'file', 'link-161');">file</a></tt><tt class="py-op">=</tt><tt id="link-220" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-220', 'file', 'link-161');">file</a></tt><tt class="py-op">,</tt> <tt id="link-221" class="py-name" targets="Variable gui.analyses.base.Spectral_error_type_page.title=gui.analyses.base.Spectral_error_type_page-class.html#title,Variable gui.analyses.wizard.Data_pipe_page.title=gui.analyses.wizard.Data_pipe_page-class.html#title,Variable gui.analyses.wizard.New_analysis_page.title=gui.analyses.wizard.New_analysis_page-class.html#title,Variable gui.spin_viewer.frame.Finish_page.title=gui.spin_viewer.frame.Finish_page-class.html#title,Variable gui.spin_viewer.frame.Load_method_page.title=gui.spin_viewer.frame.Load_method_page-class.html#title,Variable gui.wizard.Wiz_page.title=gui.wizard.Wiz_page-class.html#title,Variable info.Bieri11.title=info.Bieri11-class.html#title,Variable info.Clore90.title=info.Clore90-class.html#title,Variable info.Delaglio95.title=info.Delaglio95-class.html#title,Variable info.GoddardKneller.title=info.GoddardKneller-class.html#title,Variable info.LipariSzabo82a.title=info.LipariSzabo82a-class.html#title,Variable info.LipariSzabo82b.title=info.LipariSzabo82b-class.html#title,Variable info.Ref.title=info.Ref-class.html#title,Variable info.dAuvergne06.title=info.dAuvergne06-class.html#title,Variable info.dAuvergneGooley03.title=info.dAuvergneGooley03-class.html#title,Variable info.dAuvergneGooley06.title=info.dAuvergneGooley06-class.html#title,Variable info.dAuvergneGooley07.title=info.dAuvergneGooley07-class.html#title,Variable info.dAuvergneGooley08a.title=info.dAuvergneGooley08a-class.html#title,Variable info.dAuvergneGooley08b.title=info.dAuvergneGooley08b-class.html#title,Function lib.text.sectioning.title()=lib.text.sectioning-module.html#title,Function test_suite.formatting.title()=test_suite.formatting-module.html#title"><a title="gui.analyses.base.Spectral_error_type_page.title
gui.analyses.wizard.Data_pipe_page.title
gui.analyses.wizard.New_analysis_page.title
gui.spin_viewer.frame.Finish_page.title
gui.spin_viewer.frame.Load_method_page.title
gui.wizard.Wiz_page.title
info.Bieri11.title
info.Clore90.title
info.Delaglio95.title
info.GoddardKneller.title
info.LipariSzabo82a.title
info.LipariSzabo82b.title
info.Ref.title
info.dAuvergne06.title
info.dAuvergneGooley03.title
info.dAuvergneGooley06.title
info.dAuvergneGooley07.title
info.dAuvergneGooley08a.title
info.dAuvergneGooley08b.title
lib.text.sectioning.title
test_suite.formatting.title" class="py-name" href="#" onclick="return doclink('link-221', 'title', 'link-221');">title</a></tt><tt class="py-op">=</tt><tt class="py-string">"PCS correlation plot"</tt><tt class="py-op">,</tt> <tt class="py-name">sets</tt><tt class="py-op">=</tt><tt id="link-222" class="py-name"><a title="gui.results_viewer.Results_viewer.size" class="py-name" href="#" onclick="return doclink('link-222', 'size', 'link-209');">size</a></tt><tt class="py-op">,</tt> <tt class="py-name">set_names</tt><tt class="py-op">=</tt><tt class="py-name">set_names</tt><tt class="py-op">,</tt> <tt class="py-name">linestyle</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">+</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">*</tt><tt id="link-223" class="py-name"><a title="gui.results_viewer.Results_viewer.size" class="py-name" href="#" onclick="return doclink('link-223', 'size', 'link-209');">size</a></tt><tt class="py-op">,</tt> <tt id="link-224" class="py-name" targets="Method specific_fns.api_base.API_base.data_type()=specific_fns.api_base.API_base-class.html#data_type,Method specific_fns.model_free.main.Model_free_main.data_type()=specific_fns.model_free.main.Model_free_main-class.html#data_type"><a title="specific_fns.api_base.API_base.data_type
specific_fns.model_free.main.Model_free_main.data_type" class="py-name" href="#" onclick="return doclink('link-224', 'data_type', 'link-224');">data_type</a></tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt class="py-string">'pcs_bc'</tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">axis_min</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">0.5</tt><tt class="py-op">,</tt> <tt class="py-op">-</tt><tt class="py-number">0.5</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">axis_max</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt class="py-number">0.5</tt><tt class="py-op">,</tt> <tt class="py-number">0.5</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">legend_pos</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-number">0.5</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L446"></a><tt class="py-lineno">446</tt>  <tt class="py-line"> </tt>
<a name="L447"></a><tt class="py-lineno">447</tt>  <tt class="py-line">        <tt class="py-comment"># The main data.</tt> </tt>
<a name="L448"></a><tt class="py-lineno">448</tt>  <tt class="py-line">        <tt id="link-225" class="py-name"><a title="generic_fns.grace
test_suite.system_tests.grace
user_functions.grace" class="py-name" href="#" onclick="return doclink('link-225', 'grace', 'link-2');">grace</a></tt><tt class="py-op">.</tt><tt id="link-226" class="py-name" targets="Function generic_fns.grace.write_xy_data()=generic_fns.grace-module.html#write_xy_data"><a title="generic_fns.grace.write_xy_data" class="py-name" href="#" onclick="return doclink('link-226', 'write_xy_data', 'link-226');">write_xy_data</a></tt><tt class="py-op">(</tt><tt id="link-227" class="py-name"><a title="data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-227', 'data', 'link-165');">data</a></tt><tt class="py-op">=</tt><tt id="link-228" class="py-name"><a title="data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-228', 'data', 'link-165');">data</a></tt><tt class="py-op">,</tt> <tt id="link-229" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-229', 'file', 'link-161');">file</a></tt><tt class="py-op">=</tt><tt id="link-230" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-230', 'file', 'link-161');">file</a></tt><tt class="py-op">,</tt> <tt class="py-name">graph_type</tt><tt class="py-op">=</tt><tt class="py-name">graph_type</tt><tt class="py-op">)</tt> </tt>
</div><a name="L449"></a><tt class="py-lineno">449</tt>  <tt class="py-line"> </tt>
<a name="L450"></a><tt class="py-lineno">450</tt>  <tt class="py-line"> </tt>
<a name="delete"></a><div id="delete-def"><a name="L451"></a><tt class="py-lineno">451</tt> <a class="py-toggle" href="#" id="delete-toggle" onclick="return toggle('delete');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.pcs-module.html#delete">delete</a><tt class="py-op">(</tt><tt class="py-param">align_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="delete-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="delete-expanded"><a name="L452"></a><tt class="py-lineno">452</tt>  <tt class="py-line">    <tt class="py-docstring">"""Delete the PCS data corresponding to the alignment ID.</tt> </tt>
<a name="L453"></a><tt class="py-lineno">453</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L454"></a><tt class="py-lineno">454</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword align_id:  The alignment tensor ID string.  If not specified, all data will be deleted.</tt> </tt>
<a name="L455"></a><tt class="py-lineno">455</tt>  <tt class="py-line"><tt class="py-docstring">    @type align_id:     str or None</tt> </tt>
<a name="L456"></a><tt class="py-lineno">456</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L457"></a><tt class="py-lineno">457</tt>  <tt class="py-line"> </tt>
<a name="L458"></a><tt class="py-lineno">458</tt>  <tt class="py-line">    <tt class="py-comment"># Check the pipe setup.</tt> </tt>
<a name="L459"></a><tt class="py-lineno">459</tt>  <tt class="py-line">    <tt id="link-231" class="py-name"><a title="generic_fns.pcs.check_pipe_setup
generic_fns.rdc.check_pipe_setup" class="py-name" href="#" onclick="return doclink('link-231', 'check_pipe_setup', 'link-39');">check_pipe_setup</a></tt><tt class="py-op">(</tt><tt id="link-232" class="py-name"><a title="generic_fns.sequence
gui.input_elements.sequence
test_suite.system_tests.sequence
user_functions.sequence" class="py-name" href="#" onclick="return doclink('link-232', 'sequence', 'link-40');">sequence</a></tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">pcs_id</tt><tt class="py-op">=</tt><tt class="py-name">align_id</tt><tt class="py-op">,</tt> <tt id="link-233" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-233', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L460"></a><tt class="py-lineno">460</tt>  <tt class="py-line"> </tt>
<a name="L461"></a><tt class="py-lineno">461</tt>  <tt class="py-line">    <tt class="py-comment"># The IDs.</tt> </tt>
<a name="L462"></a><tt class="py-lineno">462</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">align_id</tt><tt class="py-op">:</tt> </tt>
<a name="L463"></a><tt class="py-lineno">463</tt>  <tt class="py-line">        <tt class="py-name">ids</tt> <tt class="py-op">=</tt> <tt class="py-name">deepcopy</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pcs_ids</tt><tt class="py-op">)</tt> </tt>
<a name="L464"></a><tt class="py-lineno">464</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L465"></a><tt class="py-lineno">465</tt>  <tt class="py-line">        <tt class="py-name">ids</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt> </tt>
<a name="L466"></a><tt class="py-lineno">466</tt>  <tt class="py-line"> </tt>
<a name="L467"></a><tt class="py-lineno">467</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over the alignments, removing all the corresponding data.</tt> </tt>
<a name="L468"></a><tt class="py-lineno">468</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-234" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-234', 'id', 'link-50');">id</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">ids</tt><tt class="py-op">:</tt> </tt>
<a name="L469"></a><tt class="py-lineno">469</tt>  <tt class="py-line">        <tt class="py-comment"># The PCS ID.</tt> </tt>
<a name="L470"></a><tt class="py-lineno">470</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pcs_ids</tt><tt class="py-op">.</tt><tt class="py-name">pop</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pcs_ids</tt><tt class="py-op">.</tt><tt class="py-name">index</tt><tt class="py-op">(</tt><tt id="link-235" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-235', 'id', 'link-50');">id</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L471"></a><tt class="py-lineno">471</tt>  <tt class="py-line"> </tt>
<a name="L472"></a><tt class="py-lineno">472</tt>  <tt class="py-line">        <tt class="py-comment"># The data type.</tt> </tt>
<a name="L473"></a><tt class="py-lineno">473</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_data_types'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt id="link-236" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-236', 'id', 'link-50');">id</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pcs_data_types</tt><tt class="py-op">:</tt> </tt>
<a name="L474"></a><tt class="py-lineno">474</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pcs_data_types</tt><tt class="py-op">.</tt><tt class="py-name">pop</tt><tt class="py-op">(</tt><tt id="link-237" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-237', 'id', 'link-50');">id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L475"></a><tt class="py-lineno">475</tt>  <tt class="py-line"> </tt>
<a name="L476"></a><tt class="py-lineno">476</tt>  <tt class="py-line">        <tt class="py-comment"># The spin data.</tt> </tt>
<a name="L477"></a><tt class="py-lineno">477</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-238" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-238', 'spin', 'link-44');">spin</a></tt> <tt class="py-keyword">in</tt> <tt id="link-239" class="py-name"><a title="generic_fns.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-239', 'spin_loop', 'link-13');">spin_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L478"></a><tt class="py-lineno">478</tt>  <tt class="py-line">            <tt class="py-comment"># The data.</tt> </tt>
<a name="L479"></a><tt class="py-lineno">479</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-240" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-240', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt id="link-241" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-241', 'id', 'link-50');">id</a></tt> <tt class="py-keyword">in</tt> <tt id="link-242" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-242', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt id="link-243" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-243', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">:</tt> </tt>
<a name="L480"></a><tt class="py-lineno">480</tt>  <tt class="py-line">                <tt id="link-244" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-244', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt id="link-245" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-245', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">.</tt><tt class="py-name">pop</tt><tt class="py-op">(</tt><tt id="link-246" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-246', 'id', 'link-50');">id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L481"></a><tt class="py-lineno">481</tt>  <tt class="py-line"> </tt>
<a name="L482"></a><tt class="py-lineno">482</tt>  <tt class="py-line">            <tt class="py-comment"># The error.</tt> </tt>
<a name="L483"></a><tt class="py-lineno">483</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-247" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-247', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_err'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt id="link-248" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-248', 'id', 'link-50');">id</a></tt> <tt class="py-keyword">in</tt> <tt id="link-249" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-249', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt><tt class="py-op">:</tt> </tt>
<a name="L484"></a><tt class="py-lineno">484</tt>  <tt class="py-line">                <tt id="link-250" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-250', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt><tt class="py-op">.</tt><tt class="py-name">pop</tt><tt class="py-op">(</tt><tt id="link-251" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-251', 'id', 'link-50');">id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L485"></a><tt class="py-lineno">485</tt>  <tt class="py-line"> </tt>
<a name="L486"></a><tt class="py-lineno">486</tt>  <tt class="py-line">        <tt class="py-comment"># Clean the global data.</tt> </tt>
<a name="L487"></a><tt class="py-lineno">487</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'rdc_ids'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt id="link-252" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-252', 'id', 'link-50');">id</a></tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">rdc_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L488"></a><tt class="py-lineno">488</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt><tt class="py-op">.</tt><tt class="py-name">pop</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt><tt class="py-op">.</tt><tt class="py-name">index</tt><tt class="py-op">(</tt><tt id="link-253" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-253', 'id', 'link-50');">id</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
</div><a name="L489"></a><tt class="py-lineno">489</tt>  <tt class="py-line"> </tt>
<a name="L490"></a><tt class="py-lineno">490</tt>  <tt class="py-line"> </tt>
<a name="display"></a><div id="display-def"><a name="L491"></a><tt class="py-lineno">491</tt> <a class="py-toggle" href="#" id="display-toggle" onclick="return toggle('display');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.pcs-module.html#display">display</a><tt class="py-op">(</tt><tt class="py-param">align_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">bc</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="display-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="display-expanded"><a name="L492"></a><tt class="py-lineno">492</tt>  <tt class="py-line">    <tt class="py-docstring">"""Display the PCS data corresponding to the alignment ID.</tt> </tt>
<a name="L493"></a><tt class="py-lineno">493</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L494"></a><tt class="py-lineno">494</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword align_id:  The alignment tensor ID string.</tt> </tt>
<a name="L495"></a><tt class="py-lineno">495</tt>  <tt class="py-line"><tt class="py-docstring">    @type align_id:     str</tt> </tt>
<a name="L496"></a><tt class="py-lineno">496</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword bc:        The back-calculation flag which if True will cause the back-calculated rather than measured data to be displayed.</tt> </tt>
<a name="L497"></a><tt class="py-lineno">497</tt>  <tt class="py-line"><tt class="py-docstring">    @type bc:           bool</tt> </tt>
<a name="L498"></a><tt class="py-lineno">498</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L499"></a><tt class="py-lineno">499</tt>  <tt class="py-line"> </tt>
<a name="L500"></a><tt class="py-lineno">500</tt>  <tt class="py-line">    <tt class="py-comment"># Check the pipe setup.</tt> </tt>
<a name="L501"></a><tt class="py-lineno">501</tt>  <tt class="py-line">    <tt id="link-254" class="py-name"><a title="generic_fns.pcs.check_pipe_setup
generic_fns.rdc.check_pipe_setup" class="py-name" href="#" onclick="return doclink('link-254', 'check_pipe_setup', 'link-39');">check_pipe_setup</a></tt><tt class="py-op">(</tt><tt id="link-255" class="py-name"><a title="generic_fns.sequence
gui.input_elements.sequence
test_suite.system_tests.sequence
user_functions.sequence" class="py-name" href="#" onclick="return doclink('link-255', 'sequence', 'link-40');">sequence</a></tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">pcs_id</tt><tt class="py-op">=</tt><tt class="py-name">align_id</tt><tt class="py-op">,</tt> <tt id="link-256" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-256', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L502"></a><tt class="py-lineno">502</tt>  <tt class="py-line"> </tt>
<a name="L503"></a><tt class="py-lineno">503</tt>  <tt class="py-line">    <tt class="py-comment"># Call the write method with sys.stdout as the file.</tt> </tt>
<a name="L504"></a><tt class="py-lineno">504</tt>  <tt class="py-line">    <tt id="link-257" class="py-name" targets="Method bmrblib.nmr_star_dict.NMR_STAR.write()=bmrblib.nmr_star_dict.NMR_STAR-class.html#write,Method bmrblib.pystarlib.File.File.write()=bmrblib.pystarlib.File.File-class.html#write,Function generic_fns.bmrb.write()=generic_fns.bmrb-module.html#write,Function generic_fns.grace.write()=generic_fns.grace-module.html#write,Function generic_fns.pcs.write()=generic_fns.pcs-module.html#write,Function generic_fns.rdc.write()=generic_fns.rdc-module.html#write,Function generic_fns.relax_data.write()=generic_fns.relax_data-module.html#write,Function generic_fns.results.write()=generic_fns.results-module.html#write,Function generic_fns.sequence.write()=generic_fns.sequence-module.html#write,Function generic_fns.value.write()=generic_fns.value-module.html#write,Method gui.controller.LogCtrl.write()=gui.controller.LogCtrl-class.html#write,Method gui.controller.Redirect_text.write()=gui.controller.Redirect_text-class.html#write,Method multi.processor_io.Redirect_text.write()=multi.processor_io.Redirect_text-class.html#write,Method relax_io.DummyFileObject.write()=relax_io.DummyFileObject-class.html#write,Method relax_io.SplitIO.write()=relax_io.SplitIO-class.html#write"><a title="bmrblib.nmr_star_dict.NMR_STAR.write
bmrblib.pystarlib.File.File.write
generic_fns.bmrb.write
generic_fns.grace.write
generic_fns.pcs.write
generic_fns.rdc.write
generic_fns.relax_data.write
generic_fns.results.write
generic_fns.sequence.write
generic_fns.value.write
gui.controller.LogCtrl.write
gui.controller.Redirect_text.write
multi.processor_io.Redirect_text.write
relax_io.DummyFileObject.write
relax_io.SplitIO.write" class="py-name" href="#" onclick="return doclink('link-257', 'write', 'link-257');">write</a></tt><tt class="py-op">(</tt><tt class="py-name">align_id</tt><tt class="py-op">=</tt><tt class="py-name">align_id</tt><tt class="py-op">,</tt> <tt id="link-258" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-258', 'file', 'link-161');">file</a></tt><tt class="py-op">=</tt><tt class="py-name">sys</tt><tt class="py-op">.</tt><tt class="py-name">stdout</tt><tt class="py-op">,</tt> <tt class="py-name">bc</tt><tt class="py-op">=</tt><tt class="py-name">bc</tt><tt class="py-op">)</tt> </tt>
</div><a name="L505"></a><tt class="py-lineno">505</tt>  <tt class="py-line"> </tt>
<a name="L506"></a><tt class="py-lineno">506</tt>  <tt class="py-line"> </tt>
<a name="q_factors"></a><div id="q_factors-def"><a name="L507"></a><tt class="py-lineno">507</tt> <a class="py-toggle" href="#" id="q_factors-toggle" onclick="return toggle('q_factors');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.pcs-module.html#q_factors">q_factors</a><tt class="py-op">(</tt><tt class="py-param">spin_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="q_factors-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="q_factors-expanded"><a name="L508"></a><tt class="py-lineno">508</tt>  <tt class="py-line">    <tt class="py-docstring">"""Calculate the Q-factors for the PCS data.</tt> </tt>
<a name="L509"></a><tt class="py-lineno">509</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L510"></a><tt class="py-lineno">510</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword spin_id:   The spin ID string used to restrict the Q-factor calculation to a subset of all spins.</tt> </tt>
<a name="L511"></a><tt class="py-lineno">511</tt>  <tt class="py-line"><tt class="py-docstring">    @type spin_id:      None or str</tt> </tt>
<a name="L512"></a><tt class="py-lineno">512</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L513"></a><tt class="py-lineno">513</tt>  <tt class="py-line"> </tt>
<a name="L514"></a><tt class="py-lineno">514</tt>  <tt class="py-line">    <tt class="py-comment"># Check the pipe setup.</tt> </tt>
<a name="L515"></a><tt class="py-lineno">515</tt>  <tt class="py-line">    <tt id="link-259" class="py-name"><a title="generic_fns.pcs.check_pipe_setup
generic_fns.rdc.check_pipe_setup" class="py-name" href="#" onclick="return doclink('link-259', 'check_pipe_setup', 'link-39');">check_pipe_setup</a></tt><tt class="py-op">(</tt><tt id="link-260" class="py-name"><a title="generic_fns.sequence
gui.input_elements.sequence
test_suite.system_tests.sequence
user_functions.sequence" class="py-name" href="#" onclick="return doclink('link-260', 'sequence', 'link-40');">sequence</a></tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L516"></a><tt class="py-lineno">516</tt>  <tt class="py-line"> </tt>
<a name="L517"></a><tt class="py-lineno">517</tt>  <tt class="py-line">    <tt class="py-comment"># No PCSs, so no Q factors can be calculated.</tt> </tt>
<a name="L518"></a><tt class="py-lineno">518</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_ids'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pcs_ids</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L519"></a><tt class="py-lineno">519</tt>  <tt class="py-line">        <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-261" class="py-name"><a title="relax_warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-261', 'RelaxWarning', 'link-37');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"No PCS data exists, Q factors cannot be calculated."</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L520"></a><tt class="py-lineno">520</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> </tt>
<a name="L521"></a><tt class="py-lineno">521</tt>  <tt class="py-line"> </tt>
<a name="L522"></a><tt class="py-lineno">522</tt>  <tt class="py-line">    <tt class="py-comment"># Q-factor dictionary.</tt> </tt>
<a name="L523"></a><tt class="py-lineno">523</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">q_factors_pcs</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L524"></a><tt class="py-lineno">524</tt>  <tt class="py-line"> </tt>
<a name="L525"></a><tt class="py-lineno">525</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over the alignments.</tt> </tt>
<a name="L526"></a><tt class="py-lineno">526</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pcs_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L527"></a><tt class="py-lineno">527</tt>  <tt class="py-line">        <tt class="py-comment"># Init.</tt> </tt>
<a name="L528"></a><tt class="py-lineno">528</tt>  <tt class="py-line">        <tt class="py-name">pcs2_sum</tt> <tt class="py-op">=</tt> <tt class="py-number">0.0</tt> </tt>
<a name="L529"></a><tt class="py-lineno">529</tt>  <tt class="py-line">        <tt class="py-name">sse</tt> <tt class="py-op">=</tt> <tt class="py-number">0.0</tt> </tt>
<a name="L530"></a><tt class="py-lineno">530</tt>  <tt class="py-line"> </tt>
<a name="L531"></a><tt class="py-lineno">531</tt>  <tt class="py-line">        <tt class="py-comment"># Spin loop.</tt> </tt>
<a name="L532"></a><tt class="py-lineno">532</tt>  <tt class="py-line">        <tt id="link-262" class="py-name" targets="Method gui.analyses.base.Base_analysis.spin_count()=gui.analyses.base.Base_analysis-class.html#spin_count"><a title="gui.analyses.base.Base_analysis.spin_count" class="py-name" href="#" onclick="return doclink('link-262', 'spin_count', 'link-262');">spin_count</a></tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L533"></a><tt class="py-lineno">533</tt>  <tt class="py-line">        <tt class="py-name">pcs_data</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L534"></a><tt class="py-lineno">534</tt>  <tt class="py-line">        <tt class="py-name">pcs_bc_data</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L535"></a><tt class="py-lineno">535</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-263" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-263', 'spin', 'link-44');">spin</a></tt> <tt class="py-keyword">in</tt> <tt id="link-264" class="py-name"><a title="generic_fns.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-264', 'spin_loop', 'link-13');">spin_loop</a></tt><tt class="py-op">(</tt><tt id="link-265" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-265', 'spin_id', 'link-82');">spin_id</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L536"></a><tt class="py-lineno">536</tt>  <tt class="py-line">            <tt class="py-comment"># Skip deselected spins.</tt> </tt>
<a name="L537"></a><tt class="py-lineno">537</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-266" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-266', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt id="link-267" class="py-name"><a title="generic_fns.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-267', 'select', 'link-179');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L538"></a><tt class="py-lineno">538</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L539"></a><tt class="py-lineno">539</tt>  <tt class="py-line"> </tt>
<a name="L540"></a><tt class="py-lineno">540</tt>  <tt class="py-line">            <tt class="py-comment"># Increment the spin counter.</tt> </tt>
<a name="L541"></a><tt class="py-lineno">541</tt>  <tt class="py-line">            <tt id="link-268" class="py-name"><a title="gui.analyses.base.Base_analysis.spin_count" class="py-name" href="#" onclick="return doclink('link-268', 'spin_count', 'link-262');">spin_count</a></tt> <tt class="py-op">+=</tt> <tt class="py-number">1</tt> </tt>
<a name="L542"></a><tt class="py-lineno">542</tt>  <tt class="py-line"> </tt>
<a name="L543"></a><tt class="py-lineno">543</tt>  <tt class="py-line">            <tt class="py-comment"># Data checks.</tt> </tt>
<a name="L544"></a><tt class="py-lineno">544</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-269" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-269', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt id="link-270" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-270', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt id="link-271" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-271', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">:</tt> </tt>
<a name="L545"></a><tt class="py-lineno">545</tt>  <tt class="py-line">                <tt class="py-name">pcs_data</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L546"></a><tt class="py-lineno">546</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-272" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-272', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_bc'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt id="link-273" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-273', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_bc</tt><tt class="py-op">:</tt> </tt>
<a name="L547"></a><tt class="py-lineno">547</tt>  <tt class="py-line">                <tt class="py-name">pcs_bc_data</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L548"></a><tt class="py-lineno">548</tt>  <tt class="py-line"> </tt>
<a name="L549"></a><tt class="py-lineno">549</tt>  <tt class="py-line">            <tt class="py-comment"># Skip spins without PCS data.</tt> </tt>
<a name="L550"></a><tt class="py-lineno">550</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-274" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-274', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-275" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-275', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_bc'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt id="link-276" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-276', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt id="link-277" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-277', 'pcs', 'link-15');">pcs</a></tt> <tt class="py-keyword">or</tt> <tt id="link-278" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-278', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt id="link-279" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-279', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt id="link-280" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-280', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_bc</tt> <tt class="py-keyword">or</tt> <tt id="link-281" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-281', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_bc</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L551"></a><tt class="py-lineno">551</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L552"></a><tt class="py-lineno">552</tt>  <tt class="py-line"> </tt>
<a name="L553"></a><tt class="py-lineno">553</tt>  <tt class="py-line">            <tt class="py-comment"># Sum of squares.</tt> </tt>
<a name="L554"></a><tt class="py-lineno">554</tt>  <tt class="py-line">            <tt class="py-name">sse</tt> <tt class="py-op">=</tt> <tt class="py-name">sse</tt> <tt class="py-op">+</tt> <tt class="py-op">(</tt><tt id="link-282" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-282', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt id="link-283" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-283', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt> <tt class="py-op">-</tt> <tt id="link-284" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-284', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_bc</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">**</tt><tt class="py-number">2</tt> </tt>
<a name="L555"></a><tt class="py-lineno">555</tt>  <tt class="py-line"> </tt>
<a name="L556"></a><tt class="py-lineno">556</tt>  <tt class="py-line">            <tt class="py-comment"># Sum the PCSs squared (for normalisation).</tt> </tt>
<a name="L557"></a><tt class="py-lineno">557</tt>  <tt class="py-line">            <tt class="py-name">pcs2_sum</tt> <tt class="py-op">=</tt> <tt class="py-name">pcs2_sum</tt> <tt class="py-op">+</tt> <tt id="link-285" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-285', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt id="link-286" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-286', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt><tt class="py-op">**</tt><tt class="py-number">2</tt> </tt>
<a name="L558"></a><tt class="py-lineno">558</tt>  <tt class="py-line"> </tt>
<a name="L559"></a><tt class="py-lineno">559</tt>  <tt class="py-line">        <tt class="py-comment"># The Q-factor for the alignment.</tt> </tt>
<a name="L560"></a><tt class="py-lineno">560</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">pcs2_sum</tt><tt class="py-op">:</tt> </tt>
<a name="L561"></a><tt class="py-lineno">561</tt>  <tt class="py-line">            <tt class="py-name">Q</tt> <tt class="py-op">=</tt> <tt class="py-name">sqrt</tt><tt class="py-op">(</tt><tt class="py-name">sse</tt> <tt class="py-op">/</tt> <tt class="py-name">pcs2_sum</tt><tt class="py-op">)</tt> </tt>
<a name="L562"></a><tt class="py-lineno">562</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">q_factors_pcs</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">Q</tt> </tt>
<a name="L563"></a><tt class="py-lineno">563</tt>  <tt class="py-line"> </tt>
<a name="L564"></a><tt class="py-lineno">564</tt>  <tt class="py-line">        <tt class="py-comment"># Warnings (and then exit).</tt> </tt>
<a name="L565"></a><tt class="py-lineno">565</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-287" class="py-name"><a title="gui.analyses.base.Base_analysis.spin_count" class="py-name" href="#" onclick="return doclink('link-287', 'spin_count', 'link-262');">spin_count</a></tt><tt class="py-op">:</tt> </tt>
<a name="L566"></a><tt class="py-lineno">566</tt>  <tt class="py-line">            <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-288" class="py-name"><a title="relax_warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-288', 'RelaxWarning', 'link-37');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"No spins have been used in the calculation, skipping the PCS Q factor calculation."</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L567"></a><tt class="py-lineno">567</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
<a name="L568"></a><tt class="py-lineno">568</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">pcs_data</tt><tt class="py-op">:</tt> </tt>
<a name="L569"></a><tt class="py-lineno">569</tt>  <tt class="py-line">            <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-289" class="py-name"><a title="relax_warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-289', 'RelaxWarning', 'link-37');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"No PCS data can be found for the alignment ID '%s', skipping the PCS Q factor calculation for this alignment."</tt> <tt class="py-op">%</tt> <tt class="py-name">align_id</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L570"></a><tt class="py-lineno">570</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L571"></a><tt class="py-lineno">571</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">pcs_bc_data</tt><tt class="py-op">:</tt> </tt>
<a name="L572"></a><tt class="py-lineno">572</tt>  <tt class="py-line">            <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-290" class="py-name"><a title="relax_warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-290', 'RelaxWarning', 'link-37');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"No back-calculated PCS data can be found for the alignment ID '%s', skipping the PCS Q factor calculation for this alignment."</tt> <tt class="py-op">%</tt> <tt class="py-name">align_id</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L573"></a><tt class="py-lineno">573</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L574"></a><tt class="py-lineno">574</tt>  <tt class="py-line"> </tt>
<a name="L575"></a><tt class="py-lineno">575</tt>  <tt class="py-line">    <tt class="py-comment"># The total Q-factor.</tt> </tt>
<a name="L576"></a><tt class="py-lineno">576</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">q_pcs</tt> <tt class="py-op">=</tt> <tt class="py-number">0.0</tt> </tt>
<a name="L577"></a><tt class="py-lineno">577</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-291" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-291', 'id', 'link-50');">id</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">q_factors_pcs</tt><tt class="py-op">:</tt> </tt>
<a name="L578"></a><tt class="py-lineno">578</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">q_pcs</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">q_pcs</tt> <tt class="py-op">+</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">q_factors_pcs</tt><tt class="py-op">[</tt><tt id="link-292" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-292', 'id', 'link-50');">id</a></tt><tt class="py-op">]</tt><tt class="py-op">**</tt><tt class="py-number">2</tt> </tt>
<a name="L579"></a><tt class="py-lineno">579</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">q_pcs</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">q_pcs</tt> <tt class="py-op">/</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">q_factors_pcs</tt><tt class="py-op">)</tt> </tt>
<a name="L580"></a><tt class="py-lineno">580</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">q_pcs</tt> <tt class="py-op">=</tt> <tt class="py-name">sqrt</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">q_pcs</tt><tt class="py-op">)</tt> </tt>
</div><a name="L581"></a><tt class="py-lineno">581</tt>  <tt class="py-line"> </tt>
<a name="L582"></a><tt class="py-lineno">582</tt>  <tt class="py-line"> </tt>
<a name="read"></a><div id="read-def"><a name="L583"></a><tt class="py-lineno">583</tt> <a class="py-toggle" href="#" id="read-toggle" onclick="return toggle('read');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.pcs-module.html#read">read</a><tt class="py-op">(</tt><tt class="py-param">align_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">file</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">dir</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">file_data</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">spin_id_col</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">mol_name_col</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">res_num_col</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">res_name_col</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">spin_num_col</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">spin_name_col</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">data_col</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">error_col</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">sep</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">spin_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="read-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="read-expanded"><a name="L584"></a><tt class="py-lineno">584</tt>  <tt class="py-line">    <tt class="py-docstring">"""Read the PCS data from file.</tt> </tt>
<a name="L585"></a><tt class="py-lineno">585</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L586"></a><tt class="py-lineno">586</tt>  <tt class="py-line"><tt class="py-docstring">    @param align_id:        The alignment tensor ID string.</tt> </tt>
<a name="L587"></a><tt class="py-lineno">587</tt>  <tt class="py-line"><tt class="py-docstring">    @type align_id:         str</tt> </tt>
<a name="L588"></a><tt class="py-lineno">588</tt>  <tt class="py-line"><tt class="py-docstring">    @param file:            The name of the file to open.</tt> </tt>
<a name="L589"></a><tt class="py-lineno">589</tt>  <tt class="py-line"><tt class="py-docstring">    @type file:             str</tt> </tt>
<a name="L590"></a><tt class="py-lineno">590</tt>  <tt class="py-line"><tt class="py-docstring">    @param dir:             The directory containing the file (defaults to the current directory if None).</tt> </tt>
<a name="L591"></a><tt class="py-lineno">591</tt>  <tt class="py-line"><tt class="py-docstring">    @type dir:              str or None</tt> </tt>
<a name="L592"></a><tt class="py-lineno">592</tt>  <tt class="py-line"><tt class="py-docstring">    @param file_data:       An alternative opening a file, if the data already exists in the correct format.  The format is a list of lists where the first index corresponds to the row and the second the column.</tt> </tt>
<a name="L593"></a><tt class="py-lineno">593</tt>  <tt class="py-line"><tt class="py-docstring">    @type file_data:        list of lists</tt> </tt>
<a name="L594"></a><tt class="py-lineno">594</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword spin_id_col:   The column containing the spin ID strings.  If supplied, the mol_name_col, res_name_col, res_num_col, spin_name_col, and spin_num_col arguments must be none.</tt> </tt>
<a name="L595"></a><tt class="py-lineno">595</tt>  <tt class="py-line"><tt class="py-docstring">    @type spin_id_col:      int or None</tt> </tt>
<a name="L596"></a><tt class="py-lineno">596</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword mol_name_col:  The column containing the molecule name information.  If supplied, spin_id_col must be None.</tt> </tt>
<a name="L597"></a><tt class="py-lineno">597</tt>  <tt class="py-line"><tt class="py-docstring">    @type mol_name_col:     int or None</tt> </tt>
<a name="L598"></a><tt class="py-lineno">598</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword res_name_col:  The column containing the residue name information.  If supplied, spin_id_col must be None.</tt> </tt>
<a name="L599"></a><tt class="py-lineno">599</tt>  <tt class="py-line"><tt class="py-docstring">    @type res_name_col:     int or None</tt> </tt>
<a name="L600"></a><tt class="py-lineno">600</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword res_num_col:   The column containing the residue number information.  If supplied, spin_id_col must be None.</tt> </tt>
<a name="L601"></a><tt class="py-lineno">601</tt>  <tt class="py-line"><tt class="py-docstring">    @type res_num_col:      int or None</tt> </tt>
<a name="L602"></a><tt class="py-lineno">602</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword spin_name_col: The column containing the spin name information.  If supplied, spin_id_col must be None.</tt> </tt>
<a name="L603"></a><tt class="py-lineno">603</tt>  <tt class="py-line"><tt class="py-docstring">    @type spin_name_col:    int or None</tt> </tt>
<a name="L604"></a><tt class="py-lineno">604</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword spin_num_col:  The column containing the spin number information.  If supplied, spin_id_col must be None.</tt> </tt>
<a name="L605"></a><tt class="py-lineno">605</tt>  <tt class="py-line"><tt class="py-docstring">    @type spin_num_col:     int or None</tt> </tt>
<a name="L606"></a><tt class="py-lineno">606</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword data_col:      The column containing the PCS data in Hz.</tt> </tt>
<a name="L607"></a><tt class="py-lineno">607</tt>  <tt class="py-line"><tt class="py-docstring">    @type data_col:         int or None</tt> </tt>
<a name="L608"></a><tt class="py-lineno">608</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword error_col:     The column containing the PCS errors.</tt> </tt>
<a name="L609"></a><tt class="py-lineno">609</tt>  <tt class="py-line"><tt class="py-docstring">    @type error_col:        int or None</tt> </tt>
<a name="L610"></a><tt class="py-lineno">610</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword sep:           The column separator which, if None, defaults to whitespace.</tt> </tt>
<a name="L611"></a><tt class="py-lineno">611</tt>  <tt class="py-line"><tt class="py-docstring">    @type sep:              str or None</tt> </tt>
<a name="L612"></a><tt class="py-lineno">612</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword spin_id:       The spin ID string used to restrict data loading to a subset of all spins.</tt> </tt>
<a name="L613"></a><tt class="py-lineno">613</tt>  <tt class="py-line"><tt class="py-docstring">    @type spin_id:          None or str</tt> </tt>
<a name="L614"></a><tt class="py-lineno">614</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L615"></a><tt class="py-lineno">615</tt>  <tt class="py-line"> </tt>
<a name="L616"></a><tt class="py-lineno">616</tt>  <tt class="py-line">    <tt class="py-comment"># Check the pipe setup.</tt> </tt>
<a name="L617"></a><tt class="py-lineno">617</tt>  <tt class="py-line">    <tt id="link-293" class="py-name"><a title="generic_fns.pcs.check_pipe_setup
generic_fns.rdc.check_pipe_setup" class="py-name" href="#" onclick="return doclink('link-293', 'check_pipe_setup', 'link-39');">check_pipe_setup</a></tt><tt class="py-op">(</tt><tt id="link-294" class="py-name"><a title="generic_fns.sequence
gui.input_elements.sequence
test_suite.system_tests.sequence
user_functions.sequence" class="py-name" href="#" onclick="return doclink('link-294', 'sequence', 'link-40');">sequence</a></tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L618"></a><tt class="py-lineno">618</tt>  <tt class="py-line"> </tt>
<a name="L619"></a><tt class="py-lineno">619</tt>  <tt class="py-line">    <tt class="py-comment"># Test if sequence data exists.</tt> </tt>
<a name="L620"></a><tt class="py-lineno">620</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-295" class="py-name"><a title="generic_fns.mol_res_spin.exists_mol_res_spin_data" class="py-name" href="#" onclick="return doclink('link-295', 'exists_mol_res_spin_data', 'link-9');">exists_mol_res_spin_data</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L621"></a><tt class="py-lineno">621</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-296" class="py-name"><a title="relax_errors.RelaxNoSequenceError" class="py-name" href="#" onclick="return doclink('link-296', 'RelaxNoSequenceError', 'link-30');">RelaxNoSequenceError</a></tt> </tt>
<a name="L622"></a><tt class="py-lineno">622</tt>  <tt class="py-line"> </tt>
<a name="L623"></a><tt class="py-lineno">623</tt>  <tt class="py-line">    <tt class="py-comment"># Either the data or error column must be supplied.</tt> </tt>
<a name="L624"></a><tt class="py-lineno">624</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">data_col</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt> <tt class="py-keyword">and</tt> <tt class="py-name">error_col</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L625"></a><tt class="py-lineno">625</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-297" class="py-name"><a title="relax_errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-297', 'RelaxError', 'link-25');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"One of either the data or error column must be supplied."</tt><tt class="py-op">)</tt> </tt>
<a name="L626"></a><tt class="py-lineno">626</tt>  <tt class="py-line"> </tt>
<a name="L627"></a><tt class="py-lineno">627</tt>  <tt class="py-line"> </tt>
<a name="L628"></a><tt class="py-lineno">628</tt>  <tt class="py-line">    <tt class="py-comment"># Spin specific data.</tt> </tt>
<a name="L629"></a><tt class="py-lineno">629</tt>  <tt class="py-line">    <tt class="py-comment">#####################</tt> </tt>
<a name="L630"></a><tt class="py-lineno">630</tt>  <tt class="py-line"> </tt>
<a name="L631"></a><tt class="py-lineno">631</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over the PCS data.</tt> </tt>
<a name="L632"></a><tt class="py-lineno">632</tt>  <tt class="py-line">    <tt class="py-name">mol_names</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L633"></a><tt class="py-lineno">633</tt>  <tt class="py-line">    <tt class="py-name">res_nums</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L634"></a><tt class="py-lineno">634</tt>  <tt class="py-line">    <tt class="py-name">res_names</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L635"></a><tt class="py-lineno">635</tt>  <tt class="py-line">    <tt class="py-name">spin_nums</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L636"></a><tt class="py-lineno">636</tt>  <tt class="py-line">    <tt class="py-name">spin_names</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L637"></a><tt class="py-lineno">637</tt>  <tt class="py-line">    <tt class="py-name">values</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L638"></a><tt class="py-lineno">638</tt>  <tt class="py-line">    <tt id="link-298" class="py-name" targets="Module gui.errors=gui.errors-module.html,Module minfx.errors=minfx.errors-module.html"><a title="gui.errors
minfx.errors" class="py-name" href="#" onclick="return doclink('link-298', 'errors', 'link-298');">errors</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L639"></a><tt class="py-lineno">639</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-299" class="py-name"><a title="data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-299', 'data', 'link-165');">data</a></tt> <tt class="py-keyword">in</tt> <tt id="link-300" class="py-name"><a title="relax_io.read_spin_data" class="py-name" href="#" onclick="return doclink('link-300', 'read_spin_data', 'link-34');">read_spin_data</a></tt><tt class="py-op">(</tt><tt id="link-301" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-301', 'file', 'link-161');">file</a></tt><tt class="py-op">=</tt><tt id="link-302" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-302', 'file', 'link-161');">file</a></tt><tt class="py-op">,</tt> <tt id="link-303" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-303', 'dir', 'link-164');">dir</a></tt><tt class="py-op">=</tt><tt id="link-304" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-304', 'dir', 'link-164');">dir</a></tt><tt class="py-op">,</tt> <tt class="py-name">file_data</tt><tt class="py-op">=</tt><tt class="py-name">file_data</tt><tt class="py-op">,</tt> <tt class="py-name">spin_id_col</tt><tt class="py-op">=</tt><tt class="py-name">spin_id_col</tt><tt class="py-op">,</tt> <tt class="py-name">mol_name_col</tt><tt class="py-op">=</tt><tt class="py-name">mol_name_col</tt><tt class="py-op">,</tt> <tt class="py-name">res_num_col</tt><tt class="py-op">=</tt><tt class="py-name">res_num_col</tt><tt class="py-op">,</tt> <tt class="py-name">res_name_col</tt><tt class="py-op">=</tt><tt class="py-name">res_name_col</tt><tt class="py-op">,</tt> <tt class="py-name">spin_num_col</tt><tt class="py-op">=</tt><tt class="py-name">spin_num_col</tt><tt class="py-op">,</tt> <tt class="py-name">spin_name_col</tt><tt class="py-op">=</tt><tt class="py-name">spin_name_col</tt><tt class="py-op">,</tt> <tt class="py-name">data_col</tt><tt class="py-op">=</tt><tt class="py-name">data_col</tt><tt class="py-op">,</tt> <tt class="py-name">error_col</tt><tt class="py-op">=</tt><tt class="py-name">error_col</tt><tt class="py-op">,</tt> <tt class="py-name">sep</tt><tt class="py-op">=</tt><tt class="py-name">sep</tt><tt class="py-op">,</tt> <tt id="link-305" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-305', 'spin_id', 'link-82');">spin_id</a></tt><tt class="py-op">=</tt><tt id="link-306" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-306', 'spin_id', 'link-82');">spin_id</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L640"></a><tt class="py-lineno">640</tt>  <tt class="py-line">        <tt class="py-comment"># Unpack.</tt> </tt>
<a name="L641"></a><tt class="py-lineno">641</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">data_col</tt> <tt class="py-keyword">and</tt> <tt class="py-name">error_col</tt><tt class="py-op">:</tt> </tt>
<a name="L642"></a><tt class="py-lineno">642</tt>  <tt class="py-line">            <tt class="py-name">mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">,</tt> <tt class="py-name">spin_num</tt><tt class="py-op">,</tt> <tt class="py-name">spin_name</tt><tt class="py-op">,</tt> <tt id="link-307" class="py-name" targets="Module generic_fns.value=generic_fns.value-module.html,Module gui.input_elements.value=gui.input_elements.value-module.html,Module user_functions.value=user_functions.value-module.html"><a title="generic_fns.value
gui.input_elements.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-307', 'value', 'link-307');">value</a></tt><tt class="py-op">,</tt> <tt id="link-308" class="py-name" targets="Method relax.RelaxParser.error()=relax.RelaxParser-class.html#error"><a title="relax.RelaxParser.error" class="py-name" href="#" onclick="return doclink('link-308', 'error', 'link-308');">error</a></tt> <tt class="py-op">=</tt> <tt id="link-309" class="py-name"><a title="data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-309', 'data', 'link-165');">data</a></tt> </tt>
<a name="L643"></a><tt class="py-lineno">643</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">data_col</tt><tt class="py-op">:</tt> </tt>
<a name="L644"></a><tt class="py-lineno">644</tt>  <tt class="py-line">            <tt class="py-name">mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">,</tt> <tt class="py-name">spin_num</tt><tt class="py-op">,</tt> <tt class="py-name">spin_name</tt><tt class="py-op">,</tt> <tt id="link-310" class="py-name"><a title="generic_fns.value
gui.input_elements.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-310', 'value', 'link-307');">value</a></tt> <tt class="py-op">=</tt> <tt id="link-311" class="py-name"><a title="data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-311', 'data', 'link-165');">data</a></tt> </tt>
<a name="L645"></a><tt class="py-lineno">645</tt>  <tt class="py-line">            <tt id="link-312" class="py-name"><a title="relax.RelaxParser.error" class="py-name" href="#" onclick="return doclink('link-312', 'error', 'link-308');">error</a></tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L646"></a><tt class="py-lineno">646</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L647"></a><tt class="py-lineno">647</tt>  <tt class="py-line">            <tt class="py-name">mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">,</tt> <tt class="py-name">spin_num</tt><tt class="py-op">,</tt> <tt class="py-name">spin_name</tt><tt class="py-op">,</tt> <tt id="link-313" class="py-name"><a title="relax.RelaxParser.error" class="py-name" href="#" onclick="return doclink('link-313', 'error', 'link-308');">error</a></tt> <tt class="py-op">=</tt> <tt id="link-314" class="py-name"><a title="data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-314', 'data', 'link-165');">data</a></tt> </tt>
<a name="L648"></a><tt class="py-lineno">648</tt>  <tt class="py-line">            <tt id="link-315" class="py-name"><a title="generic_fns.value
gui.input_elements.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-315', 'value', 'link-307');">value</a></tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L649"></a><tt class="py-lineno">649</tt>  <tt class="py-line"> </tt>
<a name="L650"></a><tt class="py-lineno">650</tt>  <tt class="py-line">        <tt class="py-comment"># Test the error value (cannot be 0.0).</tt> </tt>
<a name="L651"></a><tt class="py-lineno">651</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-316" class="py-name"><a title="relax.RelaxParser.error" class="py-name" href="#" onclick="return doclink('link-316', 'error', 'link-308');">error</a></tt> <tt class="py-op">==</tt> <tt class="py-number">0.0</tt><tt class="py-op">:</tt> </tt>
<a name="L652"></a><tt class="py-lineno">652</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-317" class="py-name"><a title="relax_errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-317', 'RelaxError', 'link-25');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"An invalid error value of zero has been encountered."</tt><tt class="py-op">)</tt> </tt>
<a name="L653"></a><tt class="py-lineno">653</tt>  <tt class="py-line"> </tt>
<a name="L654"></a><tt class="py-lineno">654</tt>  <tt class="py-line">        <tt class="py-comment"># Get the corresponding spin container.</tt> </tt>
<a name="L655"></a><tt class="py-lineno">655</tt>  <tt class="py-line">        <tt id="link-318" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-318', 'id', 'link-50');">id</a></tt> <tt class="py-op">=</tt> <tt id="link-319" class="py-name"><a title="generic_fns.mol_res_spin.generate_spin_id_unique" class="py-name" href="#" onclick="return doclink('link-319', 'generate_spin_id_unique', 'link-10');">generate_spin_id_unique</a></tt><tt class="py-op">(</tt><tt class="py-name">mol_name</tt><tt class="py-op">=</tt><tt class="py-name">mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">res_name</tt><tt class="py-op">,</tt> <tt class="py-name">spin_num</tt><tt class="py-op">=</tt><tt class="py-name">spin_num</tt><tt class="py-op">,</tt> <tt class="py-name">spin_name</tt><tt class="py-op">=</tt><tt class="py-name">spin_name</tt><tt class="py-op">)</tt> </tt>
<a name="L656"></a><tt class="py-lineno">656</tt>  <tt class="py-line">        <tt id="link-320" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-320', 'spin', 'link-44');">spin</a></tt> <tt class="py-op">=</tt> <tt id="link-321" class="py-name"><a title="generic_fns.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-321', 'return_spin', 'link-11');">return_spin</a></tt><tt class="py-op">(</tt><tt id="link-322" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-322', 'id', 'link-50');">id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L657"></a><tt class="py-lineno">657</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-323" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-323', 'spin', 'link-44');">spin</a></tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt> <tt class="py-keyword">and</tt> <tt id="link-324" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-324', 'spin_id', 'link-82');">spin_id</a></tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'@'</tt><tt class="py-op">:</tt>    <tt class="py-comment"># Allow spin IDs of atom names to be used to specify multi column data.</tt> </tt>
<a name="L658"></a><tt class="py-lineno">658</tt>  <tt class="py-line">            <tt id="link-325" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-325', 'spin', 'link-44');">spin</a></tt> <tt class="py-op">=</tt> <tt id="link-326" class="py-name"><a title="generic_fns.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-326', 'return_spin', 'link-11');">return_spin</a></tt><tt class="py-op">(</tt><tt id="link-327" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-327', 'id', 'link-50');">id</a></tt><tt class="py-op">+</tt><tt id="link-328" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-328', 'spin_id', 'link-82');">spin_id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L659"></a><tt class="py-lineno">659</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-329" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-329', 'spin', 'link-44');">spin</a></tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L660"></a><tt class="py-lineno">660</tt>  <tt class="py-line">            <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-330" class="py-name"><a title="relax_warnings.RelaxNoSpinWarning" class="py-name" href="#" onclick="return doclink('link-330', 'RelaxNoSpinWarning', 'link-38');">RelaxNoSpinWarning</a></tt><tt class="py-op">(</tt><tt id="link-331" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-331', 'id', 'link-50');">id</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L661"></a><tt class="py-lineno">661</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L662"></a><tt class="py-lineno">662</tt>  <tt class="py-line"> </tt>
<a name="L663"></a><tt class="py-lineno">663</tt>  <tt class="py-line">        <tt class="py-comment"># Add the data.</tt> </tt>
<a name="L664"></a><tt class="py-lineno">664</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">data_col</tt><tt class="py-op">:</tt> </tt>
<a name="L665"></a><tt class="py-lineno">665</tt>  <tt class="py-line">            <tt class="py-comment"># Initialise.</tt> </tt>
<a name="L666"></a><tt class="py-lineno">666</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-332" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-332', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L667"></a><tt class="py-lineno">667</tt>  <tt class="py-line">                <tt id="link-333" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-333', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt id="link-334" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-334', 'pcs', 'link-15');">pcs</a></tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L668"></a><tt class="py-lineno">668</tt>  <tt class="py-line"> </tt>
<a name="L669"></a><tt class="py-lineno">669</tt>  <tt class="py-line">            <tt class="py-comment"># Append the value.</tt> </tt>
<a name="L670"></a><tt class="py-lineno">670</tt>  <tt class="py-line">            <tt id="link-335" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-335', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt id="link-336" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-336', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-337" class="py-name"><a title="generic_fns.value
gui.input_elements.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-337', 'value', 'link-307');">value</a></tt> </tt>
<a name="L671"></a><tt class="py-lineno">671</tt>  <tt class="py-line"> </tt>
<a name="L672"></a><tt class="py-lineno">672</tt>  <tt class="py-line">        <tt class="py-comment"># Add the error.</tt> </tt>
<a name="L673"></a><tt class="py-lineno">673</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">error_col</tt><tt class="py-op">:</tt> </tt>
<a name="L674"></a><tt class="py-lineno">674</tt>  <tt class="py-line">            <tt class="py-comment"># Initialise.</tt> </tt>
<a name="L675"></a><tt class="py-lineno">675</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-338" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-338', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_err'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L676"></a><tt class="py-lineno">676</tt>  <tt class="py-line">                <tt id="link-339" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-339', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L677"></a><tt class="py-lineno">677</tt>  <tt class="py-line"> </tt>
<a name="L678"></a><tt class="py-lineno">678</tt>  <tt class="py-line">            <tt class="py-comment"># Append the error.</tt> </tt>
<a name="L679"></a><tt class="py-lineno">679</tt>  <tt class="py-line">            <tt id="link-340" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-340', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-341" class="py-name"><a title="relax.RelaxParser.error" class="py-name" href="#" onclick="return doclink('link-341', 'error', 'link-308');">error</a></tt> </tt>
<a name="L680"></a><tt class="py-lineno">680</tt>  <tt class="py-line"> </tt>
<a name="L681"></a><tt class="py-lineno">681</tt>  <tt class="py-line">        <tt class="py-comment"># Append the data for printout.</tt> </tt>
<a name="L682"></a><tt class="py-lineno">682</tt>  <tt class="py-line">        <tt class="py-name">mol_names</tt><tt class="py-op">.</tt><tt id="link-342" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-342', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">mol_name</tt><tt class="py-op">)</tt> </tt>
<a name="L683"></a><tt class="py-lineno">683</tt>  <tt class="py-line">        <tt class="py-name">res_nums</tt><tt class="py-op">.</tt><tt id="link-343" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-343', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">res_num</tt><tt class="py-op">)</tt> </tt>
<a name="L684"></a><tt class="py-lineno">684</tt>  <tt class="py-line">        <tt class="py-name">res_names</tt><tt class="py-op">.</tt><tt id="link-344" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-344', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">res_name</tt><tt class="py-op">)</tt> </tt>
<a name="L685"></a><tt class="py-lineno">685</tt>  <tt class="py-line">        <tt class="py-name">spin_nums</tt><tt class="py-op">.</tt><tt id="link-345" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-345', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">spin_num</tt><tt class="py-op">)</tt> </tt>
<a name="L686"></a><tt class="py-lineno">686</tt>  <tt class="py-line">        <tt class="py-name">spin_names</tt><tt class="py-op">.</tt><tt id="link-346" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-346', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">spin_name</tt><tt class="py-op">)</tt> </tt>
<a name="L687"></a><tt class="py-lineno">687</tt>  <tt class="py-line">        <tt class="py-name">values</tt><tt class="py-op">.</tt><tt id="link-347" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-347', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt id="link-348" class="py-name"><a title="generic_fns.value
gui.input_elements.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-348', 'value', 'link-307');">value</a></tt><tt class="py-op">)</tt> </tt>
<a name="L688"></a><tt class="py-lineno">688</tt>  <tt class="py-line">        <tt id="link-349" class="py-name"><a title="gui.errors
minfx.errors" class="py-name" href="#" onclick="return doclink('link-349', 'errors', 'link-298');">errors</a></tt><tt class="py-op">.</tt><tt id="link-350" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-350', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt id="link-351" class="py-name"><a title="relax.RelaxParser.error" class="py-name" href="#" onclick="return doclink('link-351', 'error', 'link-308');">error</a></tt><tt class="py-op">)</tt> </tt>
<a name="L689"></a><tt class="py-lineno">689</tt>  <tt class="py-line"> </tt>
<a name="L690"></a><tt class="py-lineno">690</tt>  <tt class="py-line">    <tt class="py-comment"># Print out.</tt> </tt>
<a name="L691"></a><tt class="py-lineno">691</tt>  <tt class="py-line">    <tt id="link-352" class="py-name"><a title="relax_io.write_spin_data" class="py-name" href="#" onclick="return doclink('link-352', 'write_spin_data', 'link-35');">write_spin_data</a></tt><tt class="py-op">(</tt><tt id="link-353" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-353', 'file', 'link-161');">file</a></tt><tt class="py-op">=</tt><tt class="py-name">sys</tt><tt class="py-op">.</tt><tt class="py-name">stdout</tt><tt class="py-op">,</tt> <tt class="py-name">mol_names</tt><tt class="py-op">=</tt><tt class="py-name">mol_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_nums</tt><tt class="py-op">=</tt><tt class="py-name">res_nums</tt><tt class="py-op">,</tt> <tt class="py-name">res_names</tt><tt class="py-op">=</tt><tt class="py-name">res_names</tt><tt class="py-op">,</tt> <tt class="py-name">spin_nums</tt><tt class="py-op">=</tt><tt class="py-name">spin_nums</tt><tt class="py-op">,</tt> <tt class="py-name">spin_names</tt><tt class="py-op">=</tt><tt class="py-name">spin_names</tt><tt class="py-op">,</tt> <tt id="link-354" class="py-name"><a title="data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-354', 'data', 'link-165');">data</a></tt><tt class="py-op">=</tt><tt class="py-name">values</tt><tt class="py-op">,</tt> <tt class="py-name">data_name</tt><tt class="py-op">=</tt><tt class="py-string">'PCSs'</tt><tt class="py-op">,</tt> <tt id="link-355" class="py-name"><a title="relax.RelaxParser.error" class="py-name" href="#" onclick="return doclink('link-355', 'error', 'link-308');">error</a></tt><tt class="py-op">=</tt><tt id="link-356" class="py-name"><a title="gui.errors
minfx.errors" class="py-name" href="#" onclick="return doclink('link-356', 'errors', 'link-298');">errors</a></tt><tt class="py-op">,</tt> <tt class="py-name">error_name</tt><tt class="py-op">=</tt><tt class="py-string">'PCS_error'</tt><tt class="py-op">)</tt> </tt>
<a name="L692"></a><tt class="py-lineno">692</tt>  <tt class="py-line"> </tt>
<a name="L693"></a><tt class="py-lineno">693</tt>  <tt class="py-line"> </tt>
<a name="L694"></a><tt class="py-lineno">694</tt>  <tt class="py-line">    <tt class="py-comment"># Global (non-spin specific) data.</tt> </tt>
<a name="L695"></a><tt class="py-lineno">695</tt>  <tt class="py-line">    <tt class="py-comment">##################################</tt> </tt>
<a name="L696"></a><tt class="py-lineno">696</tt>  <tt class="py-line"> </tt>
<a name="L697"></a><tt class="py-lineno">697</tt>  <tt class="py-line">    <tt class="py-comment"># No data, so return.</tt> </tt>
<a name="L698"></a><tt class="py-lineno">698</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">values</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L699"></a><tt class="py-lineno">699</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> </tt>
<a name="L700"></a><tt class="py-lineno">700</tt>  <tt class="py-line"> </tt>
<a name="L701"></a><tt class="py-lineno">701</tt>  <tt class="py-line">    <tt class="py-comment"># Initialise.</tt> </tt>
<a name="L702"></a><tt class="py-lineno">702</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'align_ids'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L703"></a><tt class="py-lineno">703</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L704"></a><tt class="py-lineno">704</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_ids'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L705"></a><tt class="py-lineno">705</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pcs_ids</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L706"></a><tt class="py-lineno">706</tt>  <tt class="py-line"> </tt>
<a name="L707"></a><tt class="py-lineno">707</tt>  <tt class="py-line">    <tt class="py-comment"># Add the PCS id string.</tt> </tt>
<a name="L708"></a><tt class="py-lineno">708</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L709"></a><tt class="py-lineno">709</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt><tt class="py-op">.</tt><tt id="link-357" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-357', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">align_id</tt><tt class="py-op">)</tt> </tt>
<a name="L710"></a><tt class="py-lineno">710</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pcs_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L711"></a><tt class="py-lineno">711</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pcs_ids</tt><tt class="py-op">.</tt><tt id="link-358" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-358', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">align_id</tt><tt class="py-op">)</tt> </tt>
</div><a name="L712"></a><tt class="py-lineno">712</tt>  <tt class="py-line"> </tt>
<a name="L713"></a><tt class="py-lineno">713</tt>  <tt class="py-line"> </tt>
<a name="set_errors"></a><div id="set_errors-def"><a name="L714"></a><tt class="py-lineno">714</tt> <a class="py-toggle" href="#" id="set_errors-toggle" onclick="return toggle('set_errors');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.pcs-module.html#set_errors">set_errors</a><tt class="py-op">(</tt><tt class="py-param">align_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">spin_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">sd</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="set_errors-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="set_errors-expanded"><a name="L715"></a><tt class="py-lineno">715</tt>  <tt class="py-line">    <tt class="py-docstring">"""Set the PCS errors if not already present.</tt> </tt>
<a name="L716"></a><tt class="py-lineno">716</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L717"></a><tt class="py-lineno">717</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword align_id:  The optional alignment tensor ID string.</tt> </tt>
<a name="L718"></a><tt class="py-lineno">718</tt>  <tt class="py-line"><tt class="py-docstring">    @type align_id:     str</tt> </tt>
<a name="L719"></a><tt class="py-lineno">719</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword spin_id:   The optional spin ID string.</tt> </tt>
<a name="L720"></a><tt class="py-lineno">720</tt>  <tt class="py-line"><tt class="py-docstring">    @type spin_id:      None or str</tt> </tt>
<a name="L721"></a><tt class="py-lineno">721</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword sd:        The PCS standard deviation in ppm.</tt> </tt>
<a name="L722"></a><tt class="py-lineno">722</tt>  <tt class="py-line"><tt class="py-docstring">    @type sd:           float or int.</tt> </tt>
<a name="L723"></a><tt class="py-lineno">723</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L724"></a><tt class="py-lineno">724</tt>  <tt class="py-line"> </tt>
<a name="L725"></a><tt class="py-lineno">725</tt>  <tt class="py-line">    <tt class="py-comment"># Check the pipe setup.</tt> </tt>
<a name="L726"></a><tt class="py-lineno">726</tt>  <tt class="py-line">    <tt id="link-359" class="py-name"><a title="generic_fns.pcs.check_pipe_setup
generic_fns.rdc.check_pipe_setup" class="py-name" href="#" onclick="return doclink('link-359', 'check_pipe_setup', 'link-39');">check_pipe_setup</a></tt><tt class="py-op">(</tt><tt id="link-360" class="py-name"><a title="generic_fns.sequence
gui.input_elements.sequence
test_suite.system_tests.sequence
user_functions.sequence" class="py-name" href="#" onclick="return doclink('link-360', 'sequence', 'link-40');">sequence</a></tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">pcs_id</tt><tt class="py-op">=</tt><tt class="py-name">align_id</tt><tt class="py-op">,</tt> <tt id="link-361" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-361', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L727"></a><tt class="py-lineno">727</tt>  <tt class="py-line"> </tt>
<a name="L728"></a><tt class="py-lineno">728</tt>  <tt class="py-line">    <tt class="py-comment"># Convert the align IDs to an array, or take all IDs.</tt> </tt>
<a name="L729"></a><tt class="py-lineno">729</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">align_id</tt><tt class="py-op">:</tt> </tt>
<a name="L730"></a><tt class="py-lineno">730</tt>  <tt class="py-line">        <tt class="py-name">align_ids</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt> </tt>
<a name="L731"></a><tt class="py-lineno">731</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L732"></a><tt class="py-lineno">732</tt>  <tt class="py-line">        <tt class="py-name">align_ids</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pcs_ids</tt> </tt>
<a name="L733"></a><tt class="py-lineno">733</tt>  <tt class="py-line"> </tt>
<a name="L734"></a><tt class="py-lineno">734</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over the spins.</tt> </tt>
<a name="L735"></a><tt class="py-lineno">735</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-362" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-362', 'spin', 'link-44');">spin</a></tt> <tt class="py-keyword">in</tt> <tt id="link-363" class="py-name"><a title="generic_fns.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-363', 'spin_loop', 'link-13');">spin_loop</a></tt><tt class="py-op">(</tt><tt id="link-364" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-364', 'spin_id', 'link-82');">spin_id</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L736"></a><tt class="py-lineno">736</tt>  <tt class="py-line">        <tt class="py-comment"># Skip deselected spins.</tt> </tt>
<a name="L737"></a><tt class="py-lineno">737</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-365" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-365', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt id="link-366" class="py-name"><a title="generic_fns.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-366', 'select', 'link-179');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L738"></a><tt class="py-lineno">738</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L739"></a><tt class="py-lineno">739</tt>  <tt class="py-line"> </tt>
<a name="L740"></a><tt class="py-lineno">740</tt>  <tt class="py-line">        <tt class="py-comment"># Skip spins with no PCSs.</tt> </tt>
<a name="L741"></a><tt class="py-lineno">741</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-367" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-367', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-op">(</tt><tt class="py-name">align_id</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt id="link-368" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-368', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt id="link-369" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-369', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L742"></a><tt class="py-lineno">742</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L743"></a><tt class="py-lineno">743</tt>  <tt class="py-line"> </tt>
<a name="L744"></a><tt class="py-lineno">744</tt>  <tt class="py-line">        <tt class="py-comment"># No data structure.</tt> </tt>
<a name="L745"></a><tt class="py-lineno">745</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-370" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-370', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_err'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L746"></a><tt class="py-lineno">746</tt>  <tt class="py-line">            <tt id="link-371" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-371', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L747"></a><tt class="py-lineno">747</tt>  <tt class="py-line"> </tt>
<a name="L748"></a><tt class="py-lineno">748</tt>  <tt class="py-line">        <tt class="py-comment"># Set the error.</tt> </tt>
<a name="L749"></a><tt class="py-lineno">749</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-372" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-372', 'id', 'link-50');">id</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">align_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L750"></a><tt class="py-lineno">750</tt>  <tt class="py-line">            <tt id="link-373" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-373', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt><tt class="py-op">[</tt><tt id="link-374" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-374', 'id', 'link-50');">id</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">sd</tt> </tt>
</div><a name="L751"></a><tt class="py-lineno">751</tt>  <tt class="py-line"> </tt>
<a name="L752"></a><tt class="py-lineno">752</tt>  <tt class="py-line"> </tt>
<a name="structural_noise"></a><div id="structural_noise-def"><a name="L753"></a><tt class="py-lineno">753</tt> <a class="py-toggle" href="#" id="structural_noise-toggle" onclick="return toggle('structural_noise');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.pcs-module.html#structural_noise">structural_noise</a><tt class="py-op">(</tt><tt class="py-param">align_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">rmsd</tt><tt class="py-op">=</tt><tt class="py-number">0.2</tt><tt class="py-op">,</tt> <tt class="py-param">sim_num</tt><tt class="py-op">=</tt><tt class="py-number">1000</tt><tt class="py-op">,</tt> <tt class="py-param">file</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">dir</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">force</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="structural_noise-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="structural_noise-expanded"><a name="L754"></a><tt class="py-lineno">754</tt>  <tt class="py-line">    <tt class="py-docstring">"""Determine the PCS error due to structural noise via simulation.</tt> </tt>
<a name="L755"></a><tt class="py-lineno">755</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L756"></a><tt class="py-lineno">756</tt>  <tt class="py-line"><tt class="py-docstring">    For the simulation the following must already be set up in the current data pipe:</tt> </tt>
<a name="L757"></a><tt class="py-lineno">757</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L758"></a><tt class="py-lineno">758</tt>  <tt class="py-line"><tt class="py-docstring">        - The position of the paramagnetic centre.</tt> </tt>
<a name="L759"></a><tt class="py-lineno">759</tt>  <tt class="py-line"><tt class="py-docstring">        - The alignment and magnetic susceptibility tensor.</tt> </tt>
<a name="L760"></a><tt class="py-lineno">760</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L761"></a><tt class="py-lineno">761</tt>  <tt class="py-line"><tt class="py-docstring">    The protocol for the simulation is as follows:</tt> </tt>
<a name="L762"></a><tt class="py-lineno">762</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L763"></a><tt class="py-lineno">763</tt>  <tt class="py-line"><tt class="py-docstring">        - The lanthanide or paramagnetic centre position will be fixed.  Its motion is assumed to be on the femto- to pico- and nanosecond timescales.  Hence the motion is averaged over the evolution of the PCS and can be ignored.</tt> </tt>
<a name="L764"></a><tt class="py-lineno">764</tt>  <tt class="py-line"><tt class="py-docstring">        - The positions of the nuclear spins will be randomised N times.  For each simulation a random unit vector will be generated.  Then a random distance along the unit vector will be generated by sampling from a Gaussian distribution centered at zero, the original spin position, with a standard deviation set to the given RMSD.  Both positive and negative displacements will be used.</tt> </tt>
<a name="L765"></a><tt class="py-lineno">765</tt>  <tt class="py-line"><tt class="py-docstring">        - The PCS for the randomised position will be back calculated.</tt> </tt>
<a name="L766"></a><tt class="py-lineno">766</tt>  <tt class="py-line"><tt class="py-docstring">        - The PCS standard deviation will be calculated from the N randomised PCS values.</tt> </tt>
<a name="L767"></a><tt class="py-lineno">767</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L768"></a><tt class="py-lineno">768</tt>  <tt class="py-line"><tt class="py-docstring">    The standard deviation will both be stored in the spin container data structure in the relax data store as well as being added to the already present PCS error (using variance addition).  This will then be used in any optimisations involving the PCS.</tt> </tt>
<a name="L769"></a><tt class="py-lineno">769</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L770"></a><tt class="py-lineno">770</tt>  <tt class="py-line"><tt class="py-docstring">    If the alignment ID string is not supplied, the procedure will be applied to the PCS data from all alignments.</tt> </tt>
<a name="L771"></a><tt class="py-lineno">771</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L772"></a><tt class="py-lineno">772</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L773"></a><tt class="py-lineno">773</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword align_id:  The alignment tensor ID string.</tt> </tt>
<a name="L774"></a><tt class="py-lineno">774</tt>  <tt class="py-line"><tt class="py-docstring">    @type align_id:     str</tt> </tt>
<a name="L775"></a><tt class="py-lineno">775</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword rmsd:      The atomic position RMSD, in Angstrom, to randomise the spin positions with for the simulations.</tt> </tt>
<a name="L776"></a><tt class="py-lineno">776</tt>  <tt class="py-line"><tt class="py-docstring">    @type rmsd:         float</tt> </tt>
<a name="L777"></a><tt class="py-lineno">777</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword sim_num:   The number of simulations, N, to perform to determine the structural noise component of the PCS errors.</tt> </tt>
<a name="L778"></a><tt class="py-lineno">778</tt>  <tt class="py-line"><tt class="py-docstring">    @type sim_num:      int</tt> </tt>
<a name="L779"></a><tt class="py-lineno">779</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword file:      The optional name of the Grace file to plot the structural errors verses the paramagnetic centre to spin distances.</tt> </tt>
<a name="L780"></a><tt class="py-lineno">780</tt>  <tt class="py-line"><tt class="py-docstring">    @type file:         None or str</tt> </tt>
<a name="L781"></a><tt class="py-lineno">781</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword dir:       The directory name to place the Grace file into.</tt> </tt>
<a name="L782"></a><tt class="py-lineno">782</tt>  <tt class="py-line"><tt class="py-docstring">    @type dir:          None or str</tt> </tt>
<a name="L783"></a><tt class="py-lineno">783</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword force:     A flag which if True will cause any pre-existing file to be overwritten.</tt> </tt>
<a name="L784"></a><tt class="py-lineno">784</tt>  <tt class="py-line"><tt class="py-docstring">    @type force:        bool</tt> </tt>
<a name="L785"></a><tt class="py-lineno">785</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L786"></a><tt class="py-lineno">786</tt>  <tt class="py-line"> </tt>
<a name="L787"></a><tt class="py-lineno">787</tt>  <tt class="py-line">    <tt class="py-comment"># Check the pipe setup.</tt> </tt>
<a name="L788"></a><tt class="py-lineno">788</tt>  <tt class="py-line">    <tt id="link-375" class="py-name"><a title="generic_fns.pcs.check_pipe_setup
generic_fns.rdc.check_pipe_setup" class="py-name" href="#" onclick="return doclink('link-375', 'check_pipe_setup', 'link-39');">check_pipe_setup</a></tt><tt class="py-op">(</tt><tt id="link-376" class="py-name"><a title="generic_fns.sequence
gui.input_elements.sequence
test_suite.system_tests.sequence
user_functions.sequence" class="py-name" href="#" onclick="return doclink('link-376', 'sequence', 'link-40');">sequence</a></tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">pcs_id</tt><tt class="py-op">=</tt><tt class="py-name">align_id</tt><tt class="py-op">,</tt> <tt id="link-377" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-377', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt id="link-378" class="py-name"><a title="maths_fns.paramag_centre" class="py-name" href="#" onclick="return doclink('link-378', 'paramag_centre', 'link-41');">paramag_centre</a></tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L789"></a><tt class="py-lineno">789</tt>  <tt class="py-line"> </tt>
<a name="L790"></a><tt class="py-lineno">790</tt>  <tt class="py-line">    <tt class="py-comment"># Convert the align IDs to an array, or take all IDs.</tt> </tt>
<a name="L791"></a><tt class="py-lineno">791</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">align_id</tt><tt class="py-op">:</tt> </tt>
<a name="L792"></a><tt class="py-lineno">792</tt>  <tt class="py-line">        <tt class="py-name">align_ids</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt> </tt>
<a name="L793"></a><tt class="py-lineno">793</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L794"></a><tt class="py-lineno">794</tt>  <tt class="py-line">        <tt class="py-name">align_ids</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt> </tt>
<a name="L795"></a><tt class="py-lineno">795</tt>  <tt class="py-line"> </tt>
<a name="L796"></a><tt class="py-lineno">796</tt>  <tt class="py-line">    <tt class="py-comment"># Initialise some numpy data structures for use in the simulations.</tt> </tt>
<a name="L797"></a><tt class="py-lineno">797</tt>  <tt class="py-line">    <tt class="py-name">grace_data</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L798"></a><tt class="py-lineno">798</tt>  <tt class="py-line">    <tt class="py-name">unit_vect</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-number">3</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L799"></a><tt class="py-lineno">799</tt>  <tt class="py-line">    <tt id="link-379" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-379', 'pcs', 'link-15');">pcs</a></tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L800"></a><tt class="py-lineno">800</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-380" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-380', 'id', 'link-50');">id</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">align_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L801"></a><tt class="py-lineno">801</tt>  <tt class="py-line">        <tt class="py-name">grace_data</tt><tt class="py-op">.</tt><tt id="link-381" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-381', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L802"></a><tt class="py-lineno">802</tt>  <tt class="py-line">        <tt id="link-382" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-382', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">[</tt><tt id="link-383" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-383', 'id', 'link-50');">id</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">sim_num</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L803"></a><tt class="py-lineno">803</tt>  <tt class="py-line"> </tt>
<a name="L804"></a><tt class="py-lineno">804</tt>  <tt class="py-line">    <tt class="py-comment"># Print out.</tt> </tt>
<a name="L805"></a><tt class="py-lineno">805</tt>  <tt class="py-line">    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Executing %i simulations for each spin system."</tt> <tt class="py-op">%</tt> <tt class="py-name">sim_num</tt><tt class="py-op">)</tt> </tt>
<a name="L806"></a><tt class="py-lineno">806</tt>  <tt class="py-line"> </tt>
<a name="L807"></a><tt class="py-lineno">807</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over the spins.</tt> </tt>
<a name="L808"></a><tt class="py-lineno">808</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-384" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-384', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt id="link-385" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-385', 'spin_id', 'link-82');">spin_id</a></tt> <tt class="py-keyword">in</tt> <tt id="link-386" class="py-name"><a title="generic_fns.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-386', 'spin_loop', 'link-13');">spin_loop</a></tt><tt class="py-op">(</tt><tt class="py-name">return_id</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L809"></a><tt class="py-lineno">809</tt>  <tt class="py-line">        <tt class="py-comment"># Deselected spins.</tt> </tt>
<a name="L810"></a><tt class="py-lineno">810</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-387" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-387', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt id="link-388" class="py-name"><a title="generic_fns.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-388', 'select', 'link-179');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L811"></a><tt class="py-lineno">811</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L812"></a><tt class="py-lineno">812</tt>  <tt class="py-line"> </tt>
<a name="L813"></a><tt class="py-lineno">813</tt>  <tt class="py-line">        <tt class="py-comment"># Skip spins with no PCS or position.</tt> </tt>
<a name="L814"></a><tt class="py-lineno">814</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-389" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-389', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L815"></a><tt class="py-lineno">815</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L816"></a><tt class="py-lineno">816</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-390" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-390', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pos'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L817"></a><tt class="py-lineno">817</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L818"></a><tt class="py-lineno">818</tt>  <tt class="py-line"> </tt>
<a name="L819"></a><tt class="py-lineno">819</tt>  <tt class="py-line">        <tt class="py-comment"># Print out.</tt> </tt>
<a name="L820"></a><tt class="py-lineno">820</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt id="link-391" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-391', 'spin_id', 'link-82');">spin_id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L821"></a><tt class="py-lineno">821</tt>  <tt class="py-line"> </tt>
<a name="L822"></a><tt class="py-lineno">822</tt>  <tt class="py-line">        <tt class="py-comment"># Average the atom position.</tt> </tt>
<a name="L823"></a><tt class="py-lineno">823</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-392" class="py-name"><a title="generic_fns.relax_data.type
info.Bieri11.type
info.Clore90.type
info.Delaglio95.type
info.GoddardKneller.type
info.LipariSzabo82a.type
info.LipariSzabo82b.type
info.Ref.type
info.dAuvergne06.type
info.dAuvergneGooley03.type
info.dAuvergneGooley06.type
info.dAuvergneGooley07.type
info.dAuvergneGooley08a.type
info.dAuvergneGooley08b.type" class="py-name" href="#" onclick="return doclink('link-392', 'type', 'link-48');">type</a></tt><tt class="py-op">(</tt><tt id="link-393" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-393', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pos</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt id="link-394" class="py-name"><a title="float" class="py-name" href="#" onclick="return doclink('link-394', 'float', 'link-49');">float</a></tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L824"></a><tt class="py-lineno">824</tt>  <tt class="py-line">            <tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt id="link-395" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-395', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pos</tt> </tt>
<a name="L825"></a><tt class="py-lineno">825</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L826"></a><tt class="py-lineno">826</tt>  <tt class="py-line">            <tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-number">3</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L827"></a><tt class="py-lineno">827</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-396" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-396', 'i', 'link-173');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-397" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-397', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pos</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L828"></a><tt class="py-lineno">828</tt>  <tt class="py-line">                <tt class="py-name">pos</tt> <tt class="py-op">+=</tt> <tt id="link-398" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-398', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pos</tt><tt class="py-op">[</tt><tt id="link-399" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-399', 'i', 'link-173');">i</a></tt><tt class="py-op">]</tt> </tt>
<a name="L829"></a><tt class="py-lineno">829</tt>  <tt class="py-line">            <tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt class="py-name">pos</tt> <tt class="py-op">/</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-400" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-400', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pos</tt><tt class="py-op">)</tt> </tt>
<a name="L830"></a><tt class="py-lineno">830</tt>  <tt class="py-line"> </tt>
<a name="L831"></a><tt class="py-lineno">831</tt>  <tt class="py-line">        <tt class="py-comment"># The original vector length (for the Grace plot).</tt> </tt>
<a name="L832"></a><tt class="py-lineno">832</tt>  <tt class="py-line">        <tt class="py-name">orig_vect</tt> <tt class="py-op">=</tt> <tt class="py-name">pos</tt> <tt class="py-op">-</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramagnetic_centre</tt> </tt>
<a name="L833"></a><tt class="py-lineno">833</tt>  <tt class="py-line">        <tt class="py-name">orig_r</tt> <tt class="py-op">=</tt> <tt class="py-name">norm</tt><tt class="py-op">(</tt><tt class="py-name">orig_vect</tt><tt class="py-op">)</tt> </tt>
<a name="L834"></a><tt class="py-lineno">834</tt>  <tt class="py-line"> </tt>
<a name="L835"></a><tt class="py-lineno">835</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the N randomisations.</tt> </tt>
<a name="L836"></a><tt class="py-lineno">836</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-401" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-401', 'i', 'link-173');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">sim_num</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L837"></a><tt class="py-lineno">837</tt>  <tt class="py-line">            <tt class="py-comment"># The random unit vector.</tt> </tt>
<a name="L838"></a><tt class="py-lineno">838</tt>  <tt class="py-line">            <tt id="link-402" class="py-name"><a title="maths_fns.vectors.random_unit_vector" class="py-name" href="#" onclick="return doclink('link-402', 'random_unit_vector', 'link-20');">random_unit_vector</a></tt><tt class="py-op">(</tt><tt class="py-name">unit_vect</tt><tt class="py-op">)</tt> </tt>
<a name="L839"></a><tt class="py-lineno">839</tt>  <tt class="py-line"> </tt>
<a name="L840"></a><tt class="py-lineno">840</tt>  <tt class="py-line">            <tt class="py-comment"># The random displacement (in Angstrom).</tt> </tt>
<a name="L841"></a><tt class="py-lineno">841</tt>  <tt class="py-line">            <tt class="py-name">disp</tt> <tt class="py-op">=</tt> <tt class="py-name">gauss</tt><tt class="py-op">(</tt><tt class="py-number">0</tt><tt class="py-op">,</tt> <tt id="link-403" class="py-name" targets="Function generic_fns.structure.main.rmsd()=generic_fns.structure.main-module.html#rmsd"><a title="generic_fns.structure.main.rmsd" class="py-name" href="#" onclick="return doclink('link-403', 'rmsd', 'link-403');">rmsd</a></tt><tt class="py-op">)</tt> </tt>
<a name="L842"></a><tt class="py-lineno">842</tt>  <tt class="py-line"> </tt>
<a name="L843"></a><tt class="py-lineno">843</tt>  <tt class="py-line">            <tt class="py-comment"># Move the atom.</tt> </tt>
<a name="L844"></a><tt class="py-lineno">844</tt>  <tt class="py-line">            <tt class="py-name">new_pos</tt> <tt class="py-op">=</tt> <tt class="py-name">pos</tt> <tt class="py-op">+</tt> <tt class="py-name">disp</tt><tt class="py-op">*</tt><tt class="py-name">unit_vect</tt> </tt>
<a name="L845"></a><tt class="py-lineno">845</tt>  <tt class="py-line"> </tt>
<a name="L846"></a><tt class="py-lineno">846</tt>  <tt class="py-line">            <tt class="py-comment"># The vector and length.</tt> </tt>
<a name="L847"></a><tt class="py-lineno">847</tt>  <tt class="py-line">            <tt class="py-name">vect</tt> <tt class="py-op">=</tt> <tt class="py-name">new_pos</tt> <tt class="py-op">-</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramagnetic_centre</tt> </tt>
<a name="L848"></a><tt class="py-lineno">848</tt>  <tt class="py-line">            <tt class="py-name">r</tt> <tt class="py-op">=</tt> <tt class="py-name">norm</tt><tt class="py-op">(</tt><tt class="py-name">vect</tt><tt class="py-op">)</tt> </tt>
<a name="L849"></a><tt class="py-lineno">849</tt>  <tt class="py-line">            <tt class="py-name">vect</tt> <tt class="py-op">=</tt> <tt class="py-name">vect</tt> <tt class="py-op">/</tt> <tt class="py-name">r</tt> </tt>
<a name="L850"></a><tt class="py-lineno">850</tt>  <tt class="py-line"> </tt>
<a name="L851"></a><tt class="py-lineno">851</tt>  <tt class="py-line">            <tt class="py-comment"># Loop over the alignments.</tt> </tt>
<a name="L852"></a><tt class="py-lineno">852</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-404" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-404', 'id', 'link-50');">id</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">align_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L853"></a><tt class="py-lineno">853</tt>  <tt class="py-line">                <tt class="py-comment"># No PCS value, so skip.</tt> </tt>
<a name="L854"></a><tt class="py-lineno">854</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt id="link-405" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-405', 'id', 'link-50');">id</a></tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt id="link-406" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-406', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt id="link-407" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-407', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">:</tt> </tt>
<a name="L855"></a><tt class="py-lineno">855</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L856"></a><tt class="py-lineno">856</tt>  <tt class="py-line"> </tt>
<a name="L857"></a><tt class="py-lineno">857</tt>  <tt class="py-line">                <tt class="py-comment"># Calculate the PCS constant.</tt> </tt>
<a name="L858"></a><tt class="py-lineno">858</tt>  <tt class="py-line">                <tt class="py-name">dj</tt> <tt class="py-op">=</tt> <tt id="link-408" class="py-name"><a title="physical_constants.pcs_constant" class="py-name" href="#" onclick="return doclink('link-408', 'pcs_constant', 'link-23');">pcs_constant</a></tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-409" class="py-name"><a title="generic_fns.temperature
user_functions.temperature" class="py-name" href="#" onclick="return doclink('link-409', 'temperature', 'link-52');">temperature</a></tt><tt class="py-op">[</tt><tt id="link-410" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-410', 'id', 'link-50');">id</a></tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-411" class="py-name"><a title="generic_fns.frq
generic_fns.relax_data.frq
user_functions.frq" class="py-name" href="#" onclick="return doclink('link-411', 'frq', 'link-54');">frq</a></tt><tt class="py-op">[</tt><tt id="link-412" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-412', 'id', 'link-50');">id</a></tt><tt class="py-op">]</tt> <tt class="py-op">*</tt> <tt class="py-number">2.0</tt> <tt class="py-op">*</tt> <tt class="py-name">pi</tt> <tt class="py-op">/</tt> <tt id="link-413" class="py-name"><a title="physical_constants.g1H" class="py-name" href="#" onclick="return doclink('link-413', 'g1H', 'link-22');">g1H</a></tt><tt class="py-op">,</tt> <tt class="py-name">r</tt><tt class="py-op">/</tt><tt class="py-number">1e10</tt><tt class="py-op">)</tt> </tt>
<a name="L859"></a><tt class="py-lineno">859</tt>  <tt class="py-line"> </tt>
<a name="L860"></a><tt class="py-lineno">860</tt>  <tt class="py-line">                <tt class="py-comment"># Calculate the PCS value (in ppm).</tt> </tt>
<a name="L861"></a><tt class="py-lineno">861</tt>  <tt class="py-line">                <tt id="link-414" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-414', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">[</tt><tt id="link-415" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-415', 'id', 'link-50');">id</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt id="link-416" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-416', 'i', 'link-173');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-417" class="py-name"><a title="maths_fns.pcs.pcs_tensor" class="py-name" href="#" onclick="return doclink('link-417', 'pcs_tensor', 'link-17');">pcs_tensor</a></tt><tt class="py-op">(</tt><tt class="py-name">dj</tt><tt class="py-op">,</tt> <tt class="py-name">vect</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">[</tt><tt id="link-418" class="py-name"><a title="generic_fns.align_tensor.get_tensor_index" class="py-name" href="#" onclick="return doclink('link-418', 'get_tensor_index', 'link-6');">get_tensor_index</a></tt><tt class="py-op">(</tt><tt id="link-419" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-419', 'id', 'link-50');">id</a></tt><tt class="py-op">)</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">A</tt><tt class="py-op">)</tt> <tt class="py-op">*</tt> <tt class="py-number">1e6</tt> </tt>
<a name="L862"></a><tt class="py-lineno">862</tt>  <tt class="py-line"> </tt>
<a name="L863"></a><tt class="py-lineno">863</tt>  <tt class="py-line">        <tt class="py-comment"># Initialise if necessary.</tt> </tt>
<a name="L864"></a><tt class="py-lineno">864</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-420" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-420', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_struct_err'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L865"></a><tt class="py-lineno">865</tt>  <tt class="py-line">            <tt id="link-421" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-421', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_struct_err</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L866"></a><tt class="py-lineno">866</tt>  <tt class="py-line"> </tt>
<a name="L867"></a><tt class="py-lineno">867</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the alignments.</tt> </tt>
<a name="L868"></a><tt class="py-lineno">868</tt>  <tt class="py-line">        <tt class="py-name">align_index</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L869"></a><tt class="py-lineno">869</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-422" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-422', 'id', 'link-50');">id</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">align_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L870"></a><tt class="py-lineno">870</tt>  <tt class="py-line">            <tt class="py-comment"># No PCS value, so skip.</tt> </tt>
<a name="L871"></a><tt class="py-lineno">871</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-423" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-423', 'id', 'link-50');">id</a></tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt id="link-424" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-424', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt id="link-425" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-425', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">:</tt> </tt>
<a name="L872"></a><tt class="py-lineno">872</tt>  <tt class="py-line">                <tt class="py-name">align_index</tt> <tt class="py-op">+=</tt> <tt class="py-number">1</tt> </tt>
<a name="L873"></a><tt class="py-lineno">873</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L874"></a><tt class="py-lineno">874</tt>  <tt class="py-line"> </tt>
<a name="L875"></a><tt class="py-lineno">875</tt>  <tt class="py-line">            <tt class="py-comment"># The PCS standard deviation.</tt> </tt>
<a name="L876"></a><tt class="py-lineno">876</tt>  <tt class="py-line">            <tt class="py-name">sd</tt> <tt class="py-op">=</tt> <tt class="py-name">std</tt><tt class="py-op">(</tt><tt id="link-426" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-426', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">[</tt><tt id="link-427" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-427', 'id', 'link-50');">id</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L877"></a><tt class="py-lineno">877</tt>  <tt class="py-line"> </tt>
<a name="L878"></a><tt class="py-lineno">878</tt>  <tt class="py-line">            <tt class="py-comment"># Remove the previous error.</tt> </tt>
<a name="L879"></a><tt class="py-lineno">879</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-428" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-428', 'id', 'link-50');">id</a></tt> <tt class="py-keyword">in</tt> <tt id="link-429" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-429', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_struct_err</tt><tt class="py-op">:</tt> </tt>
<a name="L880"></a><tt class="py-lineno">880</tt>  <tt class="py-line">                <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-430" class="py-name"><a title="relax_warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-430', 'RelaxWarning', 'link-37');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"Removing the previous structural error value from the PCS error of the spin '%s' for the alignment ID '%s'."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt id="link-431" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-431', 'spin_id', 'link-82');">spin_id</a></tt><tt class="py-op">,</tt> <tt id="link-432" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-432', 'id', 'link-50');">id</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L881"></a><tt class="py-lineno">881</tt>  <tt class="py-line">                <tt id="link-433" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-433', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt><tt class="py-op">[</tt><tt id="link-434" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-434', 'id', 'link-50');">id</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">sqrt</tt><tt class="py-op">(</tt><tt id="link-435" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-435', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt><tt class="py-op">[</tt><tt id="link-436" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-436', 'id', 'link-50');">id</a></tt><tt class="py-op">]</tt><tt class="py-op">**</tt><tt class="py-number">2</tt> <tt class="py-op">-</tt> <tt id="link-437" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-437', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_struct_err</tt><tt class="py-op">[</tt><tt id="link-438" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-438', 'id', 'link-50');">id</a></tt><tt class="py-op">]</tt><tt class="py-op">**</tt><tt class="py-number">2</tt><tt class="py-op">)</tt> </tt>
<a name="L882"></a><tt class="py-lineno">882</tt>  <tt class="py-line"> </tt>
<a name="L883"></a><tt class="py-lineno">883</tt>  <tt class="py-line">            <tt class="py-comment"># Store the structural error.</tt> </tt>
<a name="L884"></a><tt class="py-lineno">884</tt>  <tt class="py-line">            <tt id="link-439" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-439', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_struct_err</tt><tt class="py-op">[</tt><tt id="link-440" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-440', 'id', 'link-50');">id</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">sd</tt> </tt>
<a name="L885"></a><tt class="py-lineno">885</tt>  <tt class="py-line"> </tt>
<a name="L886"></a><tt class="py-lineno">886</tt>  <tt class="py-line">            <tt class="py-comment"># Add it to the PCS error (with variance addition).</tt> </tt>
<a name="L887"></a><tt class="py-lineno">887</tt>  <tt class="py-line">            <tt id="link-441" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-441', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt><tt class="py-op">[</tt><tt id="link-442" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-442', 'id', 'link-50');">id</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">sqrt</tt><tt class="py-op">(</tt><tt id="link-443" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-443', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt><tt class="py-op">[</tt><tt id="link-444" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-444', 'id', 'link-50');">id</a></tt><tt class="py-op">]</tt><tt class="py-op">**</tt><tt class="py-number">2</tt> <tt class="py-op">+</tt> <tt class="py-name">sd</tt><tt class="py-op">**</tt><tt class="py-number">2</tt><tt class="py-op">)</tt> </tt>
<a name="L888"></a><tt class="py-lineno">888</tt>  <tt class="py-line"> </tt>
<a name="L889"></a><tt class="py-lineno">889</tt>  <tt class="py-line">            <tt class="py-comment"># Store the data for the Grace plot.</tt> </tt>
<a name="L890"></a><tt class="py-lineno">890</tt>  <tt class="py-line">            <tt class="py-name">grace_data</tt><tt class="py-op">[</tt><tt class="py-name">align_index</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-445" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-445', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-name">orig_r</tt><tt class="py-op">,</tt> <tt class="py-name">sd</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L891"></a><tt class="py-lineno">891</tt>  <tt class="py-line"> </tt>
<a name="L892"></a><tt class="py-lineno">892</tt>  <tt class="py-line">            <tt class="py-comment"># Increment the alignment index.</tt> </tt>
<a name="L893"></a><tt class="py-lineno">893</tt>  <tt class="py-line">            <tt class="py-name">align_index</tt> <tt class="py-op">+=</tt> <tt class="py-number">1</tt> </tt>
<a name="L894"></a><tt class="py-lineno">894</tt>  <tt class="py-line"> </tt>
<a name="L895"></a><tt class="py-lineno">895</tt>  <tt class="py-line">    <tt class="py-comment"># The Grace output.</tt> </tt>
<a name="L896"></a><tt class="py-lineno">896</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-446" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-446', 'file', 'link-161');">file</a></tt><tt class="py-op">:</tt> </tt>
<a name="L897"></a><tt class="py-lineno">897</tt>  <tt class="py-line">        <tt class="py-comment"># Open the Grace file for writing.</tt> </tt>
<a name="L898"></a><tt class="py-lineno">898</tt>  <tt class="py-line">        <tt id="link-447" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-447', 'file', 'link-161');">file</a></tt> <tt class="py-op">=</tt> <tt id="link-448" class="py-name"><a title="relax_io.open_write_file" class="py-name" href="#" onclick="return doclink('link-448', 'open_write_file', 'link-33');">open_write_file</a></tt><tt class="py-op">(</tt><tt id="link-449" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-449', 'file', 'link-161');">file</a></tt><tt class="py-op">,</tt> <tt id="link-450" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-450', 'dir', 'link-164');">dir</a></tt><tt class="py-op">,</tt> <tt class="py-name">force</tt><tt class="py-op">)</tt> </tt>
<a name="L899"></a><tt class="py-lineno">899</tt>  <tt class="py-line"> </tt>
<a name="L900"></a><tt class="py-lineno">900</tt>  <tt class="py-line">        <tt class="py-comment"># The header.</tt> </tt>
<a name="L901"></a><tt class="py-lineno">901</tt>  <tt class="py-line">        <tt id="link-451" class="py-name"><a title="generic_fns.grace
test_suite.system_tests.grace
user_functions.grace" class="py-name" href="#" onclick="return doclink('link-451', 'grace', 'link-2');">grace</a></tt><tt class="py-op">.</tt><tt id="link-452" class="py-name"><a title="generic_fns.grace.write_xy_header" class="py-name" href="#" onclick="return doclink('link-452', 'write_xy_header', 'link-218');">write_xy_header</a></tt><tt class="py-op">(</tt><tt id="link-453" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-453', 'file', 'link-161');">file</a></tt><tt class="py-op">=</tt><tt id="link-454" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-454', 'file', 'link-161');">file</a></tt><tt class="py-op">,</tt> <tt id="link-455" class="py-name"><a title="gui.analyses.base.Spectral_error_type_page.title
gui.analyses.wizard.Data_pipe_page.title
gui.analyses.wizard.New_analysis_page.title
gui.spin_viewer.frame.Finish_page.title
gui.spin_viewer.frame.Load_method_page.title
gui.wizard.Wiz_page.title
info.Bieri11.title
info.Clore90.title
info.Delaglio95.title
info.GoddardKneller.title
info.LipariSzabo82a.title
info.LipariSzabo82b.title
info.Ref.title
info.dAuvergne06.title
info.dAuvergneGooley03.title
info.dAuvergneGooley06.title
info.dAuvergneGooley07.title
info.dAuvergneGooley08a.title
info.dAuvergneGooley08b.title
lib.text.sectioning.title
test_suite.formatting.title" class="py-name" href="#" onclick="return doclink('link-455', 'title', 'link-221');">title</a></tt><tt class="py-op">=</tt><tt class="py-string">"PCS structural noise"</tt><tt class="py-op">,</tt> <tt id="link-456" class="py-name" targets="Function lib.text.sectioning.subtitle()=lib.text.sectioning-module.html#subtitle,Function test_suite.formatting.subtitle()=test_suite.formatting-module.html#subtitle"><a title="lib.text.sectioning.subtitle
test_suite.formatting.subtitle" class="py-name" href="#" onclick="return doclink('link-456', 'subtitle', 'link-456');">subtitle</a></tt><tt class="py-op">=</tt><tt class="py-string">"%s Angstrom structural noise"</tt><tt class="py-op">%</tt><tt id="link-457" class="py-name"><a title="generic_fns.structure.main.rmsd" class="py-name" href="#" onclick="return doclink('link-457', 'rmsd', 'link-403');">rmsd</a></tt><tt class="py-op">,</tt> <tt class="py-name">sets</tt><tt class="py-op">=</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">align_ids</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">set_names</tt><tt class="py-op">=</tt><tt class="py-name">align_ids</tt><tt class="py-op">,</tt> <tt class="py-name">symbol_sizes</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt class="py-number">0.5</tt><tt class="py-op">]</tt><tt class="py-op">*</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">align_ids</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">linetype</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">*</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">align_ids</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt id="link-458" class="py-name"><a title="specific_fns.api_base.API_base.data_type
specific_fns.model_free.main.Model_free_main.data_type" class="py-name" href="#" onclick="return doclink('link-458', 'data_type', 'link-224');">data_type</a></tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt class="py-string">'pcs_bc'</tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">axis_labels</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt class="py-string">"Ln\\S3+\\N to spin distance (Angstrom)"</tt><tt class="py-op">,</tt> <tt class="py-string">"PCS standard deviation (ppm)"</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L902"></a><tt class="py-lineno">902</tt>  <tt class="py-line"> </tt>
<a name="L903"></a><tt class="py-lineno">903</tt>  <tt class="py-line">        <tt class="py-comment"># The main data.</tt> </tt>
<a name="L904"></a><tt class="py-lineno">904</tt>  <tt class="py-line">        <tt id="link-459" class="py-name"><a title="generic_fns.grace
test_suite.system_tests.grace
user_functions.grace" class="py-name" href="#" onclick="return doclink('link-459', 'grace', 'link-2');">grace</a></tt><tt class="py-op">.</tt><tt id="link-460" class="py-name"><a title="generic_fns.grace.write_xy_data" class="py-name" href="#" onclick="return doclink('link-460', 'write_xy_data', 'link-226');">write_xy_data</a></tt><tt class="py-op">(</tt><tt id="link-461" class="py-name"><a title="data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-461', 'data', 'link-165');">data</a></tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt class="py-name">grace_data</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt id="link-462" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-462', 'file', 'link-161');">file</a></tt><tt class="py-op">=</tt><tt id="link-463" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-463', 'file', 'link-161');">file</a></tt><tt class="py-op">,</tt> <tt class="py-name">graph_type</tt><tt class="py-op">=</tt><tt class="py-string">'xy'</tt><tt class="py-op">)</tt> </tt>
</div><a name="L905"></a><tt class="py-lineno">905</tt>  <tt class="py-line"> </tt>
<a name="L906"></a><tt class="py-lineno">906</tt>  <tt class="py-line"> </tt>
<a name="weight"></a><div id="weight-def"><a name="L907"></a><tt class="py-lineno">907</tt> <a class="py-toggle" href="#" id="weight-toggle" onclick="return toggle('weight');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.pcs-module.html#weight">weight</a><tt class="py-op">(</tt><tt class="py-param">align_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">spin_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">weight</tt><tt class="py-op">=</tt><tt class="py-number">1.0</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="weight-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="weight-expanded"><a name="L908"></a><tt class="py-lineno">908</tt>  <tt class="py-line">    <tt class="py-docstring">"""Set optimisation weights on the PCS data.</tt> </tt>
<a name="L909"></a><tt class="py-lineno">909</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L910"></a><tt class="py-lineno">910</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword align_id:  The alignment tensor ID string.</tt> </tt>
<a name="L911"></a><tt class="py-lineno">911</tt>  <tt class="py-line"><tt class="py-docstring">    @type align_id:     str</tt> </tt>
<a name="L912"></a><tt class="py-lineno">912</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword spin_id:   The spin ID string.</tt> </tt>
<a name="L913"></a><tt class="py-lineno">913</tt>  <tt class="py-line"><tt class="py-docstring">    @type spin_id:      None or str</tt> </tt>
<a name="L914"></a><tt class="py-lineno">914</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword weight:    The optimisation weight.  The higher the value, the more importance the PCS will have.</tt> </tt>
<a name="L915"></a><tt class="py-lineno">915</tt>  <tt class="py-line"><tt class="py-docstring">    @type weight:       float or int.</tt> </tt>
<a name="L916"></a><tt class="py-lineno">916</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L917"></a><tt class="py-lineno">917</tt>  <tt class="py-line"> </tt>
<a name="L918"></a><tt class="py-lineno">918</tt>  <tt class="py-line">    <tt class="py-comment"># Check the pipe setup.</tt> </tt>
<a name="L919"></a><tt class="py-lineno">919</tt>  <tt class="py-line">    <tt id="link-464" class="py-name"><a title="generic_fns.pcs.check_pipe_setup
generic_fns.rdc.check_pipe_setup" class="py-name" href="#" onclick="return doclink('link-464', 'check_pipe_setup', 'link-39');">check_pipe_setup</a></tt><tt class="py-op">(</tt><tt id="link-465" class="py-name"><a title="generic_fns.sequence
gui.input_elements.sequence
test_suite.system_tests.sequence
user_functions.sequence" class="py-name" href="#" onclick="return doclink('link-465', 'sequence', 'link-40');">sequence</a></tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">pcs_id</tt><tt class="py-op">=</tt><tt class="py-name">align_id</tt><tt class="py-op">,</tt> <tt id="link-466" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-466', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L920"></a><tt class="py-lineno">920</tt>  <tt class="py-line"> </tt>
<a name="L921"></a><tt class="py-lineno">921</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over the spins.</tt> </tt>
<a name="L922"></a><tt class="py-lineno">922</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-467" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-467', 'spin', 'link-44');">spin</a></tt> <tt class="py-keyword">in</tt> <tt id="link-468" class="py-name"><a title="generic_fns.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-468', 'spin_loop', 'link-13');">spin_loop</a></tt><tt class="py-op">(</tt><tt id="link-469" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-469', 'spin_id', 'link-82');">spin_id</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L923"></a><tt class="py-lineno">923</tt>  <tt class="py-line">        <tt class="py-comment"># No data structure.</tt> </tt>
<a name="L924"></a><tt class="py-lineno">924</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-470" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-470', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_weight'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L925"></a><tt class="py-lineno">925</tt>  <tt class="py-line">            <tt id="link-471" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-471', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_weight</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L926"></a><tt class="py-lineno">926</tt>  <tt class="py-line"> </tt>
<a name="L927"></a><tt class="py-lineno">927</tt>  <tt class="py-line">        <tt class="py-comment"># Set the weight.</tt> </tt>
<a name="L928"></a><tt class="py-lineno">928</tt>  <tt class="py-line">        <tt id="link-472" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-472', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_weight</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-473" class="py-name" targets="Function generic_fns.pcs.weight()=generic_fns.pcs-module.html#weight,Function generic_fns.rdc.weight()=generic_fns.rdc-module.html#weight"><a title="generic_fns.pcs.weight
generic_fns.rdc.weight" class="py-name" href="#" onclick="return doclink('link-473', 'weight', 'link-473');">weight</a></tt> </tt>
</div><a name="L929"></a><tt class="py-lineno">929</tt>  <tt class="py-line"> </tt>
<a name="L930"></a><tt class="py-lineno">930</tt>  <tt class="py-line"> </tt>
<a name="write"></a><div id="write-def"><a name="L931"></a><tt class="py-lineno">931</tt> <a class="py-toggle" href="#" id="write-toggle" onclick="return toggle('write');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.pcs-module.html#write">write</a><tt class="py-op">(</tt><tt class="py-param">align_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">file</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">dir</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">bc</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">,</tt> <tt class="py-param">force</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="write-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="write-expanded"><a name="L932"></a><tt class="py-lineno">932</tt>  <tt class="py-line">    <tt class="py-docstring">"""Display the PCS data corresponding to the alignment ID.</tt> </tt>
<a name="L933"></a><tt class="py-lineno">933</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L934"></a><tt class="py-lineno">934</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword align_id:  The alignment tensor ID string.</tt> </tt>
<a name="L935"></a><tt class="py-lineno">935</tt>  <tt class="py-line"><tt class="py-docstring">    @type align_id:     str</tt> </tt>
<a name="L936"></a><tt class="py-lineno">936</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword file:      The file name or object to write to.</tt> </tt>
<a name="L937"></a><tt class="py-lineno">937</tt>  <tt class="py-line"><tt class="py-docstring">    @type file:         str or file object</tt> </tt>
<a name="L938"></a><tt class="py-lineno">938</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword dir:       The name of the directory to place the file into (defaults to the current directory).</tt> </tt>
<a name="L939"></a><tt class="py-lineno">939</tt>  <tt class="py-line"><tt class="py-docstring">    @type dir:          str</tt> </tt>
<a name="L940"></a><tt class="py-lineno">940</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword bc:        The back-calculation flag which if True will cause the back-calculated rather than measured data to be written.</tt> </tt>
<a name="L941"></a><tt class="py-lineno">941</tt>  <tt class="py-line"><tt class="py-docstring">    @type bc:           bool</tt> </tt>
<a name="L942"></a><tt class="py-lineno">942</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword force:     A flag which if True will cause any pre-existing file to be overwritten.</tt> </tt>
<a name="L943"></a><tt class="py-lineno">943</tt>  <tt class="py-line"><tt class="py-docstring">    @type force:        bool</tt> </tt>
<a name="L944"></a><tt class="py-lineno">944</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L945"></a><tt class="py-lineno">945</tt>  <tt class="py-line"> </tt>
<a name="L946"></a><tt class="py-lineno">946</tt>  <tt class="py-line">    <tt class="py-comment"># Check the pipe setup.</tt> </tt>
<a name="L947"></a><tt class="py-lineno">947</tt>  <tt class="py-line">    <tt id="link-474" class="py-name"><a title="generic_fns.pcs.check_pipe_setup
generic_fns.rdc.check_pipe_setup" class="py-name" href="#" onclick="return doclink('link-474', 'check_pipe_setup', 'link-39');">check_pipe_setup</a></tt><tt class="py-op">(</tt><tt id="link-475" class="py-name"><a title="generic_fns.sequence
gui.input_elements.sequence
test_suite.system_tests.sequence
user_functions.sequence" class="py-name" href="#" onclick="return doclink('link-475', 'sequence', 'link-40');">sequence</a></tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">pcs_id</tt><tt class="py-op">=</tt><tt class="py-name">align_id</tt><tt class="py-op">,</tt> <tt id="link-476" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-476', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L948"></a><tt class="py-lineno">948</tt>  <tt class="py-line"> </tt>
<a name="L949"></a><tt class="py-lineno">949</tt>  <tt class="py-line">    <tt class="py-comment"># Open the file for writing.</tt> </tt>
<a name="L950"></a><tt class="py-lineno">950</tt>  <tt class="py-line">    <tt id="link-477" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-477', 'file', 'link-161');">file</a></tt> <tt class="py-op">=</tt> <tt id="link-478" class="py-name"><a title="relax_io.open_write_file" class="py-name" href="#" onclick="return doclink('link-478', 'open_write_file', 'link-33');">open_write_file</a></tt><tt class="py-op">(</tt><tt id="link-479" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-479', 'file', 'link-161');">file</a></tt><tt class="py-op">,</tt> <tt id="link-480" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-480', 'dir', 'link-164');">dir</a></tt><tt class="py-op">,</tt> <tt class="py-name">force</tt><tt class="py-op">)</tt> </tt>
<a name="L951"></a><tt class="py-lineno">951</tt>  <tt class="py-line"> </tt>
<a name="L952"></a><tt class="py-lineno">952</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over the spins and collect the data.</tt> </tt>
<a name="L953"></a><tt class="py-lineno">953</tt>  <tt class="py-line">    <tt class="py-name">mol_names</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L954"></a><tt class="py-lineno">954</tt>  <tt class="py-line">    <tt class="py-name">res_nums</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L955"></a><tt class="py-lineno">955</tt>  <tt class="py-line">    <tt class="py-name">res_names</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L956"></a><tt class="py-lineno">956</tt>  <tt class="py-line">    <tt class="py-name">spin_nums</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L957"></a><tt class="py-lineno">957</tt>  <tt class="py-line">    <tt class="py-name">spin_names</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L958"></a><tt class="py-lineno">958</tt>  <tt class="py-line">    <tt class="py-name">values</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L959"></a><tt class="py-lineno">959</tt>  <tt class="py-line">    <tt id="link-481" class="py-name"><a title="gui.errors
minfx.errors" class="py-name" href="#" onclick="return doclink('link-481', 'errors', 'link-298');">errors</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L960"></a><tt class="py-lineno">960</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-482" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-482', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt> <tt class="py-keyword">in</tt> <tt id="link-483" class="py-name"><a title="generic_fns.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-483', 'spin_loop', 'link-13');">spin_loop</a></tt><tt class="py-op">(</tt><tt class="py-name">full_info</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L961"></a><tt class="py-lineno">961</tt>  <tt class="py-line">        <tt class="py-comment"># Skip deselected spins.</tt> </tt>
<a name="L962"></a><tt class="py-lineno">962</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-484" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-484', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt id="link-485" class="py-name"><a title="generic_fns.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-485', 'select', 'link-179');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L963"></a><tt class="py-lineno">963</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L964"></a><tt class="py-lineno">964</tt>  <tt class="py-line"> </tt>
<a name="L965"></a><tt class="py-lineno">965</tt>  <tt class="py-line">        <tt class="py-comment"># Skip spins with no PCSs.</tt> </tt>
<a name="L966"></a><tt class="py-lineno">966</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">bc</tt> <tt class="py-keyword">and</tt> <tt class="py-op">(</tt><tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-486" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-486', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt id="link-487" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-487', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt id="link-488" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-488', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">.</tt><tt class="py-name">keys</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L967"></a><tt class="py-lineno">967</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L968"></a><tt class="py-lineno">968</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">bc</tt> <tt class="py-keyword">and</tt> <tt class="py-op">(</tt><tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-489" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-489', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_bc'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt id="link-490" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-490', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_bc</tt><tt class="py-op">.</tt><tt class="py-name">keys</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L969"></a><tt class="py-lineno">969</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L970"></a><tt class="py-lineno">970</tt>  <tt class="py-line"> </tt>
<a name="L971"></a><tt class="py-lineno">971</tt>  <tt class="py-line">        <tt class="py-comment"># Append the spin data.</tt> </tt>
<a name="L972"></a><tt class="py-lineno">972</tt>  <tt class="py-line">        <tt class="py-name">mol_names</tt><tt class="py-op">.</tt><tt id="link-491" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-491', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">mol_name</tt><tt class="py-op">)</tt> </tt>
<a name="L973"></a><tt class="py-lineno">973</tt>  <tt class="py-line">        <tt class="py-name">res_nums</tt><tt class="py-op">.</tt><tt id="link-492" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-492', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">res_num</tt><tt class="py-op">)</tt> </tt>
<a name="L974"></a><tt class="py-lineno">974</tt>  <tt class="py-line">        <tt class="py-name">res_names</tt><tt class="py-op">.</tt><tt id="link-493" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-493', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">res_name</tt><tt class="py-op">)</tt> </tt>
<a name="L975"></a><tt class="py-lineno">975</tt>  <tt class="py-line">        <tt class="py-name">spin_nums</tt><tt class="py-op">.</tt><tt id="link-494" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-494', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt id="link-495" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-495', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">num</tt><tt class="py-op">)</tt> </tt>
<a name="L976"></a><tt class="py-lineno">976</tt>  <tt class="py-line">        <tt class="py-name">spin_names</tt><tt class="py-op">.</tt><tt id="link-496" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-496', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt id="link-497" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-497', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt id="link-498" class="py-name" targets="Variable bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name=bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe-class.html#name,Variable bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name=bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1-class.html#name,Variable bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name=bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name=bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name=bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name=bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name=bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1-class.html#name,Variable generic_fns.pipes.name=generic_fns.pipes-module.html#name,Variable user_functions.pipe.name=user_functions.pipe-module.html#name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
generic_fns.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-498', 'name', 'link-498');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L977"></a><tt class="py-lineno">977</tt>  <tt class="py-line"> </tt>
<a name="L978"></a><tt class="py-lineno">978</tt>  <tt class="py-line">        <tt class="py-comment"># The value.</tt> </tt>
<a name="L979"></a><tt class="py-lineno">979</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">bc</tt><tt class="py-op">:</tt> </tt>
<a name="L980"></a><tt class="py-lineno">980</tt>  <tt class="py-line">            <tt class="py-name">values</tt><tt class="py-op">.</tt><tt id="link-499" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-499', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt id="link-500" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-500', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_bc</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L981"></a><tt class="py-lineno">981</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L982"></a><tt class="py-lineno">982</tt>  <tt class="py-line">            <tt class="py-name">values</tt><tt class="py-op">.</tt><tt id="link-501" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-501', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt id="link-502" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-502', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt id="link-503" class="py-name"><a title="generic_fns.pcs
maths_fns.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-503', 'pcs', 'link-15');">pcs</a></tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L983"></a><tt class="py-lineno">983</tt>  <tt class="py-line"> </tt>
<a name="L984"></a><tt class="py-lineno">984</tt>  <tt class="py-line">        <tt class="py-comment"># The error.</tt> </tt>
<a name="L985"></a><tt class="py-lineno">985</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-504" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-504', 'spin', 'link-44');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_err'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt id="link-505" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-505', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt><tt class="py-op">.</tt><tt class="py-name">keys</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L986"></a><tt class="py-lineno">986</tt>  <tt class="py-line">            <tt id="link-506" class="py-name"><a title="gui.errors
minfx.errors" class="py-name" href="#" onclick="return doclink('link-506', 'errors', 'link-298');">errors</a></tt><tt class="py-op">.</tt><tt id="link-507" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-507', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt id="link-508" class="py-name"><a title="test_suite.unit_tests._generic_fns.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-508', 'spin', 'link-44');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L987"></a><tt class="py-lineno">987</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L988"></a><tt class="py-lineno">988</tt>  <tt class="py-line">            <tt id="link-509" class="py-name"><a title="gui.errors
minfx.errors" class="py-name" href="#" onclick="return doclink('link-509', 'errors', 'link-298');">errors</a></tt><tt class="py-op">.</tt><tt id="link-510" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-510', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">None</tt><tt class="py-op">)</tt> </tt>
<a name="L989"></a><tt class="py-lineno">989</tt>  <tt class="py-line"> </tt>
<a name="L990"></a><tt class="py-lineno">990</tt>  <tt class="py-line">    <tt class="py-comment"># Write out.</tt> </tt>
<a name="L991"></a><tt class="py-lineno">991</tt>  <tt class="py-line">    <tt id="link-511" class="py-name"><a title="relax_io.write_spin_data" class="py-name" href="#" onclick="return doclink('link-511', 'write_spin_data', 'link-35');">write_spin_data</a></tt><tt class="py-op">(</tt><tt id="link-512" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-512', 'file', 'link-161');">file</a></tt><tt class="py-op">=</tt><tt id="link-513" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-513', 'file', 'link-161');">file</a></tt><tt class="py-op">,</tt> <tt class="py-name">mol_names</tt><tt class="py-op">=</tt><tt class="py-name">mol_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_nums</tt><tt class="py-op">=</tt><tt class="py-name">res_nums</tt><tt class="py-op">,</tt> <tt class="py-name">res_names</tt><tt class="py-op">=</tt><tt class="py-name">res_names</tt><tt class="py-op">,</tt> <tt class="py-name">spin_nums</tt><tt class="py-op">=</tt><tt class="py-name">spin_nums</tt><tt class="py-op">,</tt> <tt class="py-name">spin_names</tt><tt class="py-op">=</tt><tt class="py-name">spin_names</tt><tt class="py-op">,</tt> <tt id="link-514" class="py-name"><a title="data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-514', 'data', 'link-165');">data</a></tt><tt class="py-op">=</tt><tt class="py-name">values</tt><tt class="py-op">,</tt> <tt class="py-name">data_name</tt><tt class="py-op">=</tt><tt class="py-string">'PCSs'</tt><tt class="py-op">,</tt> <tt id="link-515" class="py-name"><a title="relax.RelaxParser.error" class="py-name" href="#" onclick="return doclink('link-515', 'error', 'link-308');">error</a></tt><tt class="py-op">=</tt><tt id="link-516" class="py-name"><a title="gui.errors
minfx.errors" class="py-name" href="#" onclick="return doclink('link-516', 'errors', 'link-298');">errors</a></tt><tt class="py-op">,</tt> <tt class="py-name">error_name</tt><tt class="py-op">=</tt><tt class="py-string">'PCS_error'</tt><tt class="py-op">)</tt> </tt>
</div><a name="L992"></a><tt class="py-lineno">992</tt>  <tt class="py-line"> </tt><script type="text/javascript">
<!--
expandto(location.href);
// -->
</script>
</pre>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://www.nmr-relax.com">relax</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Sun Mar 24 12:22:21 2013
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
