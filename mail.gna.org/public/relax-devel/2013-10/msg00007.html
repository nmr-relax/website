<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: Monte&#45;Carlo simulation for a clustering of 78 residues in a	dispersion analysis is extremely slow -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Tue, 08 Oct 2013 11:54:15 +0200 -->
<!--X-Message-Id: CAED9pY_oY3DA97oGhpaMr4SAuEp&#45;9pfgoZtmBuT&#45;5AGAGL9r+A@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: CA+CBx2P_y8fOm18w5gyG&#45;3kQmUL1rqqN5f7d+bL8KJzoaRXt2A@mail.gmail.com -->
<!--X-Reference: CAED9pY_XXWj29y+&#45;AahM+RUR2Anbc8HC84RshmheLFC2O9yFHA@mail.gmail.com -->
<!--X-Reference: CA+CBx2Ohs+yr80mRp9OcB_F7bsBjDHXMAP5687JEbV2XtSDQSQ@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Monte-Carlo simulation for a clustering of 78 residues in a	dispersion analysis is extremely slow -- October 08, 2013 - 11:54</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Monte-Carlo simulation for a clustering of 78 residues in a	dispersion analysis is extremely slow</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00007" class="tabs">Index by Date</a> | <a href="threads.html#00007" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00006.html">Date Prev</a>] [<a href="msg00008.html">Date Next</a>] [<a href="msg00006.html">Thread Prev</a>] [<a href="msg00002.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Tue, 8 Oct 2013 11:53:43 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113;	h=mime-version:sender:in-reply-to:references:date:message-id:subject	:from:to:cc:content-type:content-transfer-encoding;	bh=5mY+tUFseJc/rw4bqaUO4ZEX7HpQKV630jTR7VG0wyE=;	b=kiifu/FvIMvQJHZ2kNdG06J4IzfxP6ia1MplPuFQ7SsxrIZkymZz3jlL97k/lb86kK	mwciHY8VQ0IbqIMVRR7uPOPLN9ybl+2QAOJU3Hs6YXypPCz8DEIuvG1ZkTXrJzXOd91m	Hd+yic3HlrENMl3q4cPgKYrHx9teh94EfJVkxtXFahIU1P1oWz0chcaFnHNCTgxSj36v	QYu2wD8ByjNsM1R4EgicKkY1rAzy2KH0Y4h+PpDBcCKvJO9nqVXB5Xi+sFiE10xmTmN6	pKbbGOlELSv1S19YLNqm1U3AM2YTyXBvaPkevim11IiqyEWrLWHXnn+vM1yYBtWNOjzW	7pig==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00007.html">CAED9pY_oY3DA97oGhpaMr4SAuEp-9pfgoZtmBuT-5AGAGL9r+A@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;CA+CBx2P_y8fOm18w5gyG-3kQmUL1rqqN5f7d+bL8KJzoaRXt2A@xxxxxxxxxxxxxx&gt;	&lt;CAED9pY_XXWj29y+-AahM+RUR2Anbc8HC84RshmheLFC2O9yFHA@xxxxxxxxxxxxxx&gt;	&lt;CA+CBx2Ohs+yr80mRp9OcB_F7bsBjDHXMAP5687JEbV2XtSDQSQ@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on October 08, 2013 - 11:54:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi,

The clustering analysis can take quite a long time, especially with
Monte Carlo simulations.  If you cluster 78 spins with data at 2 field
strengths and use the CR72 model, the problem changes from 78 small 5D
problems (the dimensions are:  R02_field1 + R02_field2 + pA + dw +
kex) to one large 313D problem (the dimensions are:  78 * (R02_field1
+ R02_field2 + pA + dw) + kex).  For the field of numerical
optimisation, that is a huge difference.  Optimising a 313 dimensional
problem is difficult and long.  Then add Monte Carlo simulations on
top of that and 58 hours actually seems quite reasonable.

But now that the Monte Carlo simulations are parallelised, if you have
a cluster with 50 nodes the calculation with 50 Monte Carlo
simulations should drop from 58 hours to between 1 to 2 hours.  Give
it a go on your cluster and see how much things have speed up when
using OpenMPI!

Regards,

Edward




On 8 October 2013 11:39, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Edward.

Last time I did a clustering analysis for 78 spins, with no parallisation,
with 50 monte carlo simulations, it took 58 Hours.

I compare that to a run with no clustering, which took 8 Hours.

Is the clustering calculation so much more expensive?

Best
Troels



Troels Emtekær Linnet


2013/10/7 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;
</pre><blockquote class="blockquote"><pre style="margin: 0em;">

Hi Troels,

This is exactly as I would expect as the parallisation is currently at
the level of the spin cluster.  Therefore if you have only one
cluster, using MPI will not result in any speed ups.  This was
mentioned in the commit message:

<a  rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.scm/18737">http://thread.gmane.org/gmane.science.nmr.relax.scm/18737</a>

I am currently considering how to implement an additional
parallisiation at the Monte Carlo simulation level.  My idea is to
have the multi-processor box singleton used in the minimise user
function backend, specifically in the pipe_control.minimise.minimise()
function.  Instead of running processor.run_queue() at the end of the
minimise() method of the specific_analyses.relax_disp.api.Relax_disp
class, it is run at the end of the pipe_control.minimise.minimise()
function.  This might involve less that 10 lines of code changed to
fully implement Monte Carlo simulation parallisation.  But the problem
is that it needs testing to see how the non-parallised analyses handle
this.

Regards,

Edward

On 15 September 2013 19:14, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxx&gt;
wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Edward.

I try to perform some speed-analysis.
As mentioned here:

<a  rel="nofollow" href="http://wiki.nmr-relax.com/OpenMPI#Results">http://wiki.nmr-relax.com/OpenMPI#Results</a>

I am very happy to see, that the analysis time go down from 8 hours, to
2
hours, when you change to a computer with 24 CPU's.

Now I am trying to make a cluster analysis.
But making the monte-carlo analysis for a clustering of 78 residues,
takes
extremely long time.
This is for the test, where I only use 1 CPU.

After 1 Hour, it has not even passed simulation 1.
For the faster computer, is has passed simulation 3.
But the time for 50 MC simulation, now looks like to take extremely long
time.

Do you know, if this is expected?



Troels Emtekær Linnet

_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-devel mailing list
relax-devel@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a>

</pre></blockquote></blockquote><pre style="margin: 0em;">


</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00001" href="msg00001.html">Re: Monte-Carlo simulation for a clustering of 78 residues in a	dispersion analysis is extremely slow</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00006" href="msg00006.html">Re: Monte-Carlo simulation for a clustering of 78 residues in a	dispersion analysis is extremely slow</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Tue Oct 08 14:40:08 2013</div>  
</body>
</html>
