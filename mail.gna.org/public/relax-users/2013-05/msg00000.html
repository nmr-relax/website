<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: Is it possible to analyse CPMG experiments with relax? -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Thu, 02 May 2013 10:42:10 +0200 -->
<!--X-Message-Id: CAED9pY&#45;YTDqPdDJQAVgr1&#45;oW5Zut5jsxg&#45;ZtNF0DnXJciY&#45;5xA@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: CA+CBx2OZQqMPa+0+KDKnBPOsVSo405KqnR=1B1_3CspRhOaOSA@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Is it possible to analyse CPMG experiments with relax? -- May 02, 2013 - 10:42</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Is it possible to analyse CPMG experiments with relax?</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00000" class="tabs">Index by Date</a> | <a href="threads.html#00000" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[Date Prev] [<a href="msg00001.html">Date Next</a>] [Thread Prev] [<a href="msg00003.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxx&gt;, 	Sébastien Morin &lt;sebastianomorino@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Thu, 2 May 2013 10:41:39 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-users@xxxxxxx&quot; &lt;relax-users@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113;	h=mime-version:x-received:sender:in-reply-to:references:date	:x-google-sender-auth:message-id:subject:from:to:cc:content-type	:content-transfer-encoding;	bh=iPEXeChHhvtusR2JWeNtIe7PPItSB434K1q9UzwtYFc=;	b=Z3YsUE9Es2XvzDPYq3gVvrCoHxzo3IIS4Y4iyWfv+XChLlIQpTVP84MNjm3BXAPTDS	cfR3Vke8DQGZbodQ/S/wP5H2HWyfodwdnXzQTNpOfWQh5n3nNcf3bWmG9Yc2GdMDg+AE	Kl75rdBI47tGRt4UfzW3G+sk/oenHAo99KWRqG3cnuIwAZ3qRl+74inWUqJgHnA/jouE	i5WGVLpVbi06/+WyJWW6cNtFhTJvhvSGkd7HI928FPe766ekk+E95U6H+9DVmUrHmGpx	PiKqEamLt9JZKCe1IpWuOQVAq9KtaPRAS5DEJcxT9ivJ0SF4LzUQLneM+9QtiG9xUO0i	37dQ==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00000.html">CAED9pY-YTDqPdDJQAVgr1-oW5Zut5jsxg-ZtNF0DnXJciY-5xA@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;CA+CBx2OZQqMPa+0+KDKnBPOsVSo405KqnR=1B1_3CspRhOaOSA@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on May 02, 2013 - 10:42:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi Troels,

Welcome to the relax mailing lists.  For now the answer to your
question is, unfortunately, no - relax does not officially support
relaxation dispersion.  The analysis you are running is simple two
parameter exponential curve-fitting
(<a  rel="nofollow" href="http://www.nmr-relax.com/manual/Relaxation_curve_fitting.html">http://www.nmr-relax.com/manual/Relaxation_curve_fitting.html</a>).  This
can be used to find the R2eff or R1rho values if you have measured the
full exponential curves, but otherwise you cannot perform a dispersion
analysis with this.

This may not be of use for you at the moment, but note that relax has
unofficial and incomplete support for dispersion analyses (both
CPMG-type and R1rho-type data sets).  As relax is open source, there
are many NMR spectroscopists who have added code to relax (for example
see <a  rel="nofollow" href="http://gna.org/project/memberlist.php?group=relax">http://gna.org/project/memberlist.php?group=relax</a>).  An initial
implementation of the relaxation dispersion analysis was added to a
relax branch back in 2009 by Sebastian Morin
(<a  rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.devel/1728">http://thread.gmane.org/gmane.science.nmr.relax.devel/1728</a>).  But as
this was not completed at the time, it was never merged back into the
relax main line (the source code where official relax releases come
from).  I have recently restored the branch to a partially working
state and added a graphical interface for the analysis - mainly for my
own purposes (<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/">http://svn.gna.org/viewcvs/relax/branches/</a>).  So at some
point in the near future relax will be able to perform the analyses
you are interested in.

As relax is open source, if you are interested and adventurous enough
you are most welcome to help in the development.  Even if you do not
know how to code, there are many other things which can be done.  For
example calculating the partial derivatives of the analytic solutions
to obtain the gradients and Hessians so that with relax you can have
access to far more powerful optimisation algorithms than any of the
other dispersion software has access to.  Or to create test data
whereby the solution is know, or to collect the input and output test
data from published results.  If you have the subversion version
control software installed, you can obtain the code by typing either:

$ svn co svn://svn.gna.org/svn/relax/branches/relax-disp

or:

$ svn co <a  rel="nofollow" href="http://svn.gna.org/svn/relax/branches/relax-disp">http://svn.gna.org/svn/relax/branches/relax-disp</a>

If you are more interested in quickly performing the analysis, I would
point you to Dr. Flemming Hansen's CATIA program:

<a  rel="nofollow" href="http://www.biochem.ucl.ac.uk/hansen/catia/">http://www.biochem.ucl.ac.uk/hansen/catia/</a> (the old page is
<a  rel="nofollow" href="http://pound.med.utoronto.ca/~flemming/catia/">http://pound.med.utoronto.ca/~flemming/catia/</a>).

This performs numerically integration of the Bloch-McConnell
equations, so not the optimisation of the analytic solutions of
Meiboom, Richard-Carver, etc.  It is also only for CPMG-type data
rather than R1rho, whereas the relax branch will handle both.  I hope
this information helps.

Regards,

Edward




On 30 April 2013 18:40, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Dear relax users.

I am looking into different NMR programs to fit
relaxation data for CPMG relaxation dispersion experiments and T1rho.

Essentially, I am looking for programs for which can fit functions, which
for example nessy provide:
<a  rel="nofollow" href="http://home.gna.org/nessy/reference.html">http://home.gna.org/nessy/reference.html</a>
The Meiboom equation or Richard-Carver equation

Nessy is very buggy, and I am looking for a replacement.

I should be able to:
R2eff = -1.0/time_T2*log(Intensity/averageZero)

ncyc_arr=[28, 0, 4, 32, 60, 2, 10, 16, 8, 20, 50, 18, 40, 6, 12, 0, 24]
time_T2 = 0.06 second
nu = ncyc_arr[i]/time_T2

R2cpmg_slow:
tau_cpmg = 1.0/(4*nu)
R2eff = R2+ka*(1.0-sin(Domega*tau_cpmg)/(Domega*tau_cpmg))


I have followed the tutorial in the homepage manual:

Can relax analyse these kinds of experiments?
Should i provide the: relax_fit.relax_time(time to be equal tau_cpmg ?
I put in time_T2, even though its wrong. I just wanted to try the program.
:-)

----------------------------------------------------------------
&quot;&quot;&quot;Script for relaxation curve fitting.&quot;&quot;&quot;
# Create the 'rx' data pipe.
pipe.create('rx', 'relax_fit')
## Load the backbone amide 15N spins from a PDB file.
pdbfile=False
if pdbfile:
    structure.read_pdb(pdbfile)
    structure.load_spins(spin_id='@N')
else:
    molecule.create(mol_name='protein', mol_type='protein')
    residue.create(res_num=2, res_name='VAL')
    spin.create(res_num=2, spin_name='N')
    residue.create(res_num=3, res_name='PHE')
    spin.create(res_num=3, spin_name='N')
    residue.create(res_num=4, res_name='GLY')
    spin.create(res_num=4, spin_name='N')
    residue.create(res_num=5, res_name='ARG')
    spin.create(res_num=5, spin_name='N')
    residue.create(res_num=6, res_name='CYS')
    .... and so on

## Loop over the spectra intensities. Relaxation times should be in seconds.
readint=True
if readint:
    spectrum.read_intensities(dir='relax', file='proc_list.txt.0int',
spectrum_id='0_0.0', int_method='point sum', heteronuc='N', proton='HN',
int_col=3)
    relax_fit.relax_time(time=0.06, spectrum_id='0_0.0')
    spectrum.read_intensities(dir='relax', file='proc_list.txt.1int',
spectrum_id='1_133.33', int_method='point sum', heteronuc='N', proton='HN',
int_col=3)
    relax_fit.relax_time(time=0.06, spectrum_id='1_133.33')
    spectrum.read_intensities(dir='relax', file='proc_list.txt.2int',
spectrum_id='2_166.67', int_method='point sum', heteronuc='N', proton='HN',
int_col=3)
    relax_fit.relax_time(time=0.06, spectrum_id='2_166.67')
    spectrum.read_intensities(dir='relax', file='proc_list.txt.3int',
spectrum_id='3_333.33', int_method='point sum', heteronuc='N', proton='HN',
int_col=3)
    relax_fit.relax_time(time=0.06, spectrum_id='3_333.33')
    spectrum.read_intensities(dir='relax', file='proc_list.txt.4int',
spectrum_id='4_33.33', int_method='point sum', heteronuc='N', proton='HN',
int_col=3)
    relax_fit.relax_time(time=0.06, spectrum_id='4_33.33')
   ... and so on

# Specify the duplicated spectra.
spectrum.replicated(spectrum_ids=['0_0.0', '18_0.0'])
spectrum.error_analysis()

# Deselect unresolved spins.
#deselect.read(file='unresolved', mol_name_col=1, res_num_col=2,
res_name_col=3, spin_num_col=4, spin_name_col=5)

# Set the relaxation curve type.
relax_fit.select_model('exp')

# Grid search.
grid_search(inc=11)

# Minimise.
minimise('simplex', scaling=False, constraints=False)

## Monte Carlo simulations.
monte_carlo.setup(number=10)
monte_carlo.create_data()
monte_carlo.initial_values()
minimise('simplex', scaling=False, constraints=False)
monte_carlo.error_analysis()

## Save the relaxation rates.
value.write(param='rx', file='rx.out', force=True)

## Save the results.
results.write(file='results', force=True)

# Save the program state.
state.save('rx.save', force=True)

Best

Troels Emtekær Linnet
Ved kløvermarken 9, 1.th
2300 København S
Mobil: +45 60210234

_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-users mailing list
relax-users@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-users">https://mail.gna.org/listinfo/relax-users</a>

</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00003" href="msg00003.html">Re: Is it possible to analyse CPMG experiments with relax?</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu May 02 17:00:06 2013</div>  
</body>
</html>
