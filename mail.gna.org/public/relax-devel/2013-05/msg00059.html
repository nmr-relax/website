<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: Relaxation dispersion comparison: The LM63 model results from	relax, NESSY and CPMGFit. -->
<!--X-From-R13: Bnhy Epunaqn <cnhy.fpunaqnNvof.se> -->
<!--X-Date: Thu, 30 May 2013 17:47:38 +0200 -->
<!--X-Message-Id: 51A77488.9050002@ibs.fr -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: CAED9pY8arkGQV6jeQM0aXUiQ1ry=hJT1k76hZ20sZPZTC0PaRA@mail.gmail.com -->
<!--X-Reference: CA+CBx2MPEqZpaWUQksX&#45;VD0e5V&#45;NigG_eu+rWn_tHVcMMDm_QQ@mail.gmail.com -->
<!--X-Reference: CAED9pY_2u5gugaQzgPs7CFecpODN5m3RceVUg5n7+FJRMkHDGg@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Relaxation dispersion comparison: The LM63 model results from	relax, NESSY and CPMGFit. -- May 30, 2013 - 17:47</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Relaxation dispersion comparison: The LM63 model results from	relax, NESSY and CPMGFit.</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00059" class="tabs">Index by Date</a> | <a href="threads.html#00059" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00052.html">Date Prev</a>] [<a href="msg00053.html">Date Next</a>] [<a href="msg00052.html">Thread Prev</a>] [<a href="msg00053.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Thu, 30 May 2013 17:47:20 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00059.html">51A77488.9050002@ibs.fr</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;CAED9pY8arkGQV6jeQM0aXUiQ1ry=hJT1k76hZ20sZPZTC0PaRA@xxxxxxxxxxxxxx&gt;	&lt;CA+CBx2MPEqZpaWUQksX-VD0e5V-NigG_eu+rWn_tHVcMMDm_QQ@xxxxxxxxxxxxxx&gt;	&lt;CAED9pY_2u5gugaQzgPs7CFecpODN5m3RceVUg5n7+FJRMkHDGg@xxxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>User-agent</em>: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.8;	rv:17.0) Gecko/20130509 Thunderbird/17.0.6</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Paul Schanda</strong> on May 30, 2013 - 17:47:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Hi Edward,

</pre><tt>We have now the numerical Bloch-McConnell equation included in a python 
</tt><tt>script that does the fitting. It looks like a pretty robust thing, and 
</tt><tt>works rather well. Finally, we did our own little scripts, rather than 
</tt><tt>incorporating everything in relax. I felt that this would be more 
</tt><tt>straightforward for us, rather than understanding the structure of relax.
</tt><tt>But I guess if it's a python code, then it's really straightforward for 
</tt><tt>you to incorporate it...
</tt><pre style="margin: 0em;">

paul



On 30.05.13 17:34, Edward d'Auvergne wrote:
</pre><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">
You are very productive! and I am stunned to see the development
so fast. :-)
</pre></blockquote><pre style="margin: 0em;">
Well, I'm sorting out the code for myself specifically for my own
R1rho analyses.  I'm guessing you are interested in the CPMG side of
things.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">
I think you are hitting &quot;the nail&quot; with the current development of relax.
</pre></blockquote><pre style="margin: 0em;">
There's not much left to finish with the base infrastructure.  As for
adding new models, that's a different, but relatively easy story.  The
numerical integration of the Block-McConnell equations might take more
effort to add but, as all the infrastructure is in place, it shouldn't
be too hard.  Integrating with the other softwares (input file
creation, execution, and reading of results - for NESSY, CPMGFit,
ShereKhan, Catia, Chemex, etc.) will be a continual work in progress.
It will be advanced when someone needs it, this is currently myself to
fully automate the comparison between all the different dispersion
programs simply for sanity purposes.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">
At the moment the &quot;hardest/time consuming&quot; part for students in our lab, is
the analysis of the
results. We have a good workflow from recording and peak assignment.
But from there, it gets more tricky.
</pre></blockquote><pre style="margin: 0em;">
I know this problem well :)


</pre><blockquote class="blockquote"><pre style="margin: 0em;">
Most of our analysis part is based on &quot;home made&quot; scripts for Igor
Pro/Matlab.
</pre></blockquote><pre style="margin: 0em;">
Ah, the code for the dispersion models shouldn't be too difficult to
port into relax if you already have Matlab code in place!


</pre><blockquote class="blockquote"><pre style="margin: 0em;">
They come a long way for most of our analysis.
The problem is that for a &quot;beginner&quot; there can be a &quot;high energy barrier&quot; to
start
using these scripts. Not mentioning &quot;license problems&quot;, installation and
such.
And if you have to make some peak adjustments, then the whole analysis
should be performed again.
For a &quot;trained&quot; this takes some hours, but for un-trained, it can take a day
or two.
</pre></blockquote><pre style="margin: 0em;">
I understand this, and this is one useful advantage of a GUI.  I don't
know how you would avoid having to redo a full analysis if the input
data is changed though, except that maybe you could have a relax save
file for the GUI analysis and slightly tweak the data already within
relax, and the rerun the full analysis.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">
We have been looking for other software for CPMG.
At least to &quot;quickly&quot; try to match our scripts values.  (Here Nessy seemed
very interesting, but very buggy)
</pre></blockquote><pre style="margin: 0em;">
I am now the maintainer of NESSY so I can fix some of the trivial
bugs.  I have been doing this for a few annoying bugs, for example
see:

<a  rel="nofollow" href="/mail.gna.org/public/nessy-commits/2013-05/threads.html">https://mail.gna.org/public/nessy-commits/2013-05/threads.html</a>

However finding the big bugs and improving the optimisation will not
be possible for me at the moment.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">
But concerns about installation, development, and even a &quot;harder&quot; interface
than Igor Pro/Matlab, stopped us.
We(as in me) are at the moment matching some test results at the Sherekhan
server, after making
a input converter to Sherekhan. That seems to be very easy, and promising.
</pre></blockquote><pre style="margin: 0em;">
relax now has this as well in the relax_disp.sherekhan_input user
function.  You can access this from both the prompt/script mode and
the GUI.  I've noticed though that the ShereKhan numerical integration
of the Block-McConnell equations is currently problematic and the poor
little tiger just runs forever!


</pre><blockquote class="blockquote"><pre style="margin: 0em;">
I am very impressed with relax. Mostly because the GUI can take care of
novices, and there exist the possibility to
script it all up for extensive analysis.
It's free, and I was able to install it on Windows/Linux without to much
fuss.
</pre></blockquote><pre style="margin: 0em;">
Cheers!  That is exactly what the relax developers have tried to create:

- the GUI is really for those who don't have much interest in the
theory and just want quick, idiot-proof results from a blackbox (i.e.
perfect for undergrads),
- the prompt/script mode is for power users with interest in the NMR
theory and analysis,
- the prompt/script mode in combination with the relax library
functions is to be a replacement for Mathematica/Matlab for those who
want to live on the cutting edge.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">
If I want to try some of our data, is the GUI ready for trying?
</pre></blockquote><pre style="margin: 0em;">
There are a few minor bugs I have to sort out first.  For example with
the error analysis for peak heights.  It should be ready for the
'R2eff' and 'LM63' models soon though.  Still, right now you can do
everything except for clicking on the 'Execute analysis' button.  I
hope it won't take too long.

Regards,

Edward




</pre><blockquote class="blockquote"><pre style="margin: 0em;">
2013/5/29 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;
</pre><blockquote class="blockquote"><pre style="margin: 0em;">
Hi,

Troels, you might be interested in the following comparison.  The
reviving Sebastien Morin's relaxation dispersion branch in relax is
now complete.  The relax_disp branch can now correctly optimise one of
the dispersion models, that of Luz and Meiboom 1963 for 2-site fast
exchange for CPMG-type experiments.  This does not implement the
gradients or Hessians yet, and parameter constraints are still to be
added.  But nevertheless relax can find the correct parameter values.
This should be a good test of the dispersion code in relax as the
addition of other models - such as that for R1rho data, more
complicated models for CPMG-type data, and numerical integration of
the Bloch-McConnell equations - should be trivial after that
(requiring only 20-50 lines of new code, not counting comments and
docstrings).

Through relax user functions, I can now generate the input for CPMGFit
and NESSY.  These are the relax_disp.cpmgfit_input and
relax_disp.nessy_input user functions.  We can now also execute
CPMGFit within relax using relax_disp.cpmgfit_execute.  This can be
completed later, but the idea is to follow the concept of model-free
user functions:

dasha.create
dasha.execute
dasha.extract
palmer.create
palmer.execute
palmer.extract

These are for the Dasha and Modelfree4 programs respectively.
Implementing the 3 user functions for creating input files, executing
the program in-line, and extracting the results from the program's
output will allow relax to use external programs as optimisation
engines.  This is useful for comparing the results from different
programs and really eliminating all bugs from the dispersion field.

Back to the comparison, I have used Flemming Hansen's 500 and 800 MHz
CPMG data from:

Hansen, Vallurupalli &amp; Kay, 2008, JPhysChemB, 112: 5898-5904.

which he donated to Seb to be added to relax (located in
test_suite/shared_data/dispersion/Hansen/).  Looking at a single
randomly chosen residue (number 70), I see different results from the
3 programs:

Param       relax       NESSY       CPMGFit
R2 (500)        6.806       7.639       6.866
R2 (800)        6.679       7.387       6.866
phi         1.259e-13       0.259   1.226e-13
phi (500)   31464.605   26292.031   30644.496
phi (800)   80549.390   67307.598   78449.180
kex          4763.249    3906.180      4.683
tau         4.199e-05   5.120e-05       0.427
chi2          106.393     156.446     106.471

tau = 2/kex (I think that CPMGFit works with ms units).

Obviously NESSY is not doing so well (likely due to using the horribly
buggy scipy optimisation code) and relax and CPMGFit find the same
result for this model.  The slight difference between relax and
CPMGFit is that it looks like CPMGFit assumes the same R2 value for
all static fields - which I think would be a little strange,
especially if fast internal motions are also present for that spin
system.

Therefore I believe that this relax branch is in a state to accept
code for the other models.  The backends for the
relax_disp.cpmgfit_input and relax_disp.nessy_input could be also
modified to handle these new models to allow for rigorous comparisons
and debugging.  The dispersion infrastructure should no longer have
any large changes, so feel free to start playing.

Regards,

Edward
</pre></blockquote><pre style="margin: 0em;">


_______________________________________________
relax (<a  rel="nofollow" href="/">http://www.nmr-relax.com</a>)

This is the relax-devel mailing list
relax-devel@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="/mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a>

</pre></blockquote></blockquote><pre style="margin: 0em;">


--
Paul Schanda, Ph.D.
Biomolecular NMR group
Institut de Biologie Structurale Jean-Pierre Ebel (IBS)
41, rue Jules Horowitz
F-38027 Grenoble
France
+33 438 78 95 55
paul.schanda@xxxxxx
<a  rel="nofollow" href="http://www.ibs.fr/groups/biomolecular-nmr-spectroscopy?lang=en">http://www.ibs.fr/groups/biomolecular-nmr-spectroscopy?lang=en</a>



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00053" href="msg00053.html">Re: Relaxation dispersion comparison: The LM63 model results from	relax, NESSY and CPMGFit.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00049" href="msg00049.html">Relaxation dispersion comparison: The LM63 model results from relax, 	NESSY and CPMGFit.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00051" href="msg00051.html">Re: Relaxation dispersion comparison: The LM63 model results from	relax, NESSY and CPMGFit.</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00052" href="msg00052.html">Re: Relaxation dispersion comparison: The LM63 model results from	relax, NESSY and CPMGFit.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Fri May 31 09:40:09 2013</div>  
</body>
</html>
