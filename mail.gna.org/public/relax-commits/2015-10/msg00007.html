<!-- MHonArc v2.6.19+ -->
<!--X-Subject: r27917 &#45; in /trunk: ./ specific_analyses/frame_order/ test_suite/shared_data/frame_order/cam/ test_suite/shared_data/frame_o... -->
<!--X-From-R13: rqjneqNaze&#45;erynk.pbz -->
<!--X-Date: Thu, 01 Oct 2015 19:49:47 +0200 -->
<!--X-Message-Id: E1ZhhzH&#45;0007rm&#45;NK@subversion.gna.org -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>r27917 - in /trunk: ./ specific_analyses/frame_order/ test_suite/shared_data/frame_order/cam/ test_suite/shared_data/frame_o... -- October 01, 2015 - 19:49</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />r27917 - in /trunk: ./ specific_analyses/frame_order/ test_suite/shared_data/frame_order/cam/ test_suite/shared_data/frame_o...</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00007" class="tabs">Index by Date</a> | <a href="threads.html#00007" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00006.html">Date Prev</a>] [<a href="msg00008.html">Date Next</a>] [<a href="msg00006.html">Thread Prev</a>] [<a href="msg00008.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: relax-commits@xxxxxxx</li>
<li class="menuitem">
<em>Date</em>: Thu, 01 Oct 2015 17:49:47 -0000</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00007.html">E1ZhhzH-0007rm-NK@subversion.gna.org</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>edward</strong> on October 01, 2015 - 19:49:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Author: bugman
Date: Thu Oct  1 19:49:46 2015
New Revision: 27917

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=27917&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=27917&amp;view=rev</a>
Log:
Merged revisions 23208-23211 via svnmerge from 
svn+ssh://bugman@xxxxxxxxxxx/svn/relax/branches/frame_order_cleanup

........
  r23208 | bugman | 2014-05-16 16:36:45 +0200 (Fri, 16 May 2014) | 7 lines
  
  Updated the CaM frame order test model superimposition script.
  
  The structure.superimpose user function is now correctly called.  The 
output log file has been added
  to the repository as it contains the correct translation and Euler rotation 
information needed for
  the test models.
........
  r23209 | bugman | 2014-05-16 16:55:55 +0200 (Fri, 16 May 2014) | 6 lines
  
  Parameter update for the isotropic cone CaM frame order test model 
optimisation script.
  
  The Euler angles for the rotation about the motional pivot have been 
replaced by the translation
  vector and Euler angle CoM rotation parameters.
........
  r23210 | bugman | 2014-05-17 18:03:44 +0200 (Sat, 17 May 2014) | 1 line
  
  Removed an unused import and an extra blank line.
........
  r23211 | bugman | 2014-05-17 18:03:46 +0200 (Sat, 17 May 2014) | 5 lines
  
  Fix for a number of the frame order models which do not have parameter 
constraints.
  
  The linear_constraint() function was returning A, b = [], [] for these 
models, but these empty numpy
  arrays were causing the minfx library (<a  rel="nofollow" href="https://gna.org/projects/minfx/">https://gna.org/projects/minfx/</a>) to 
fail.  These values are
  now caught and the constraint algorithm turned off in the minimise() 
specific API method.
........

Added:
    trunk/test_suite/shared_data/frame_order/cam/superimpose.log
      - copied unchanged from r23211, 
branches/frame_order_cleanup/test_suite/shared_data/frame_order/cam/superimpose.log
Modified:
    trunk/   (props changed)
    trunk/specific_analyses/frame_order/api.py
    trunk/test_suite/shared_data/frame_order/cam/iso_cone/frame_order.py
    trunk/test_suite/shared_data/frame_order/cam/superimpose.py

Propchange: trunk/
------------------------------------------------------------------------------
--- svnmerge-integrated (original)
+++ svnmerge-integrated Thu Oct  1 19:49:46 2015
@@ -1 +1 @@
-/branches/frame_order_cleanup:1-23195,23197-23205
+/branches/frame_order_cleanup:1-23195,23197-23205,23208-23211

Modified: trunk/specific_analyses/frame_order/api.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/specific_analyses/frame_order/api.py?rev=27917&amp;r1=27916&amp;r2=27917&amp;view=diff">http://svn.gna.org/viewcvs/relax/trunk/specific_analyses/frame_order/api.py?rev=27917&amp;r1=27916&amp;r2=27917&amp;view=diff</a>
==============================================================================
--- trunk/specific_analyses/frame_order/api.py  (original)
+++ trunk/specific_analyses/frame_order/api.py  Thu Oct  1 19:49:46 2015
@@ -29,9 +29,11 @@
 from minfx.grid import grid_point_array
 from numpy import float64, zeros
 from re import search
+from warnings import warn
 
 # relax module imports.
 from lib.errors import RelaxError, RelaxNoModelError
+from lib.warnings import RelaxWarning
 from pipe_control import pipes
 from pipe_control.interatomic import interatomic_loop, return_interatom
 from pipe_control.mol_res_spin import return_spin, spin_loop
@@ -505,6 +507,16 @@
         if constraints:
             A, b = linear_constraints(scaling_matrix=scaling_matrix[0])
 
+        # No constraints.
+        if len(A) == 0:
+            warn(RelaxWarning(&quot;The '%s' model parameters are not 
constrained, turning the linear constraint algorithm off.&quot; % cdp.model))
+            constraints = False
+
+            # Pop out the log barrier algorithm.
+            if min_algor == 'Log barrier':
+                min_algor = min_options[0]
+                min_options = min_options[1:]
+
         # Grid search.
         if search('^[Gg]rid', min_algor):
             results = grid_point_array(func=model.func, args=(), 
points=min_options, verbosity=verbosity)

Modified: trunk/test_suite/shared_data/frame_order/cam/iso_cone/frame_order.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/test_suite/shared_data/frame_order/cam/iso_cone/frame_order.py?rev=27917&amp;r1=27916&amp;r2=27917&amp;view=diff">http://svn.gna.org/viewcvs/relax/trunk/test_suite/shared_data/frame_order/cam/iso_cone/frame_order.py?rev=27917&amp;r1=27916&amp;r2=27917&amp;view=diff</a>
==============================================================================
--- trunk/test_suite/shared_data/frame_order/cam/iso_cone/frame_order.py      
  (original)
+++ trunk/test_suite/shared_data/frame_order/cam/iso_cone/frame_order.py      
  Thu Oct  1 19:49:46 2015
@@ -3,12 +3,10 @@
 # Python module imports.
 from numpy import array
 
-# relax module imports.
-from lib.geometry.rotations import reverse_euler_zyz
-
 
 # The real parameter values.
-AVE_POS_ALPHA, AVE_POS_BETA, AVE_POS_GAMMA = 
reverse_euler_zyz(4.3434999280669997, 0.43544332764249905, 3.8013235235956007)
+AVE_POS_X, AVE_POS_Y, AVE_POS_Z = [ -21.269217407269576,   
-3.122610661328414,   -2.400652421655998]
+AVE_POS_ALPHA, AVE_POS_BETA, AVE_POS_GAMMA = [   5.623469076122531,    
0.435439405668396,    5.081265529106499]
 AXIS_THETA = 0.96007997859534299767
 AXIS_PHI = 4.03227550621962294031
 CONE_THETA = 0.6
@@ -85,6 +83,9 @@
 frame_order.quad_int(flag=False)
 
 # Check the minimum.
+value.set(param='ave_pos_x', val=AVE_POS_X)
+value.set(param='ave_pos_y', val=AVE_POS_Y)
+value.set(param='ave_pos_z', val=AVE_POS_Z)
 value.set(param='ave_pos_alpha', val=AVE_POS_ALPHA)
 value.set(param='ave_pos_beta', val=AVE_POS_BETA)
 value.set(param='ave_pos_gamma', val=AVE_POS_GAMMA)
@@ -108,7 +109,6 @@
 frame_order.pivot(pivot, fix=False)
 minimise('simplex', constraints=True)
 
-
 # Test Monte Carlo simulations.
 monte_carlo.setup(number=5)
 monte_carlo.create_data()

Modified: trunk/test_suite/shared_data/frame_order/cam/superimpose.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/test_suite/shared_data/frame_order/cam/superimpose.py?rev=27917&amp;r1=27916&amp;r2=27917&amp;view=diff">http://svn.gna.org/viewcvs/relax/trunk/test_suite/shared_data/frame_order/cam/superimpose.py?rev=27917&amp;r1=27916&amp;r2=27917&amp;view=diff</a>
==============================================================================
--- trunk/test_suite/shared_data/frame_order/cam/superimpose.py (original)
+++ trunk/test_suite/shared_data/frame_order/cam/superimpose.py Thu Oct  1 
19:49:46 2015
@@ -8,7 +8,7 @@
 structure.read_pdb('1J7P_1st_NH_rot.pdb', set_mol_name='C-dom', 
set_model_num=2)
 
 # Superimpose.
-structure.superimpose(method='fit to first', centre='CoM')
+structure.superimpose(method='fit to first', centre_type='CoM')
 
 # Save the result.
 structure.write_pdb('superimpose.pdb', force=True)



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu Oct 01 20:20:13 2015</div>  
</body>
</html>
