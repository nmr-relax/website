<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [sr #3154] Implementation of Baldwin (2014) B14 model &#45; 2&#45;site exact solution model for all time scales -->
<!--X-From-R13: Oaqerj Pnyqjva &#60;naqerj.onyqjvaNpurz.bk.np.hx> -->
<!--X-Date: Tue, 13 May 2014 20:27:27 +0200 -->
<!--X-Message-Id: 537263D6.4020300@chem.ox.ac.uk -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20140429&#45;222552.sv20529.12099@gna.org -->
<!--X-Reference: CA+CBx2N5ti2&#45;+cs4TPViYxqnEpjH3432hydxCicgOcdLb01cEw@mail.gmail.com -->
<!--X-Reference: CAED9pY9josZukT1kOeax=U02GsHL5FMpuaQ9JqTTT+Gx5Ah&#45;eQ@mail.gmail.com -->
<!--X-Reference: 5360CCC8.3050309@chem.ox.ac.uk -->
<!--X-Reference: CAED9pY8oW7J&#45;7YcBgSRpDPexRghuRNnK851VJ7E+GePdnS2m3Q@mail.gmail.com -->
<!--X-Reference: 536200D2.2010005@chem.ox.ac.uk -->
<!--X-Reference: CA+CBx2Nbfndqpv7Rq+X751z&#45;5fi41DmXo2sGFSar_qOWQPWEuA@mail.gmail.com -->
<!--X-Reference: 5366AA19.3000304@chem.ox.ac.uk -->
<!--X-Reference: CA+CBx2PXnmcr9DcCEO1K=Jr=ymMncFAJv8amxyBWwzRRv0w3kw@mail.gmail.com -->
<!--X-Reference: 53675322.2@chem.ox.ac.uk -->
<!--X-Reference: CA+CBx2NMXNk5hVD8_3UO=wToC+PR5vDanWj5RNDpZB5Q=PfGEQ@mail.gmail.com -->
<!--X-Reference: 53688E6E.9020708@chem.ox.ac.uk -->
<!--X-Reference: CAED9pY_zZvLdhs4FUXg2TAzTNJix=wR=Ac5wgnQpRQtBTg0B3Q@mail.gmail.com -->
<!--X-Reference: 53689B49.5010602@chem.ox.ac.uk -->
<!--X-Reference: CA+CBx2Ne3Qwz2rTMzPy4PA0PkAthd3e8_CFGPHqVO8BAYYDL6A@mail.gmail.com -->
<!--X-Reference: 5368B37E.106@chem.ox.ac.uk -->
<!--X-Reference: CA+CBx2P11Lh5AB27avQFc7&#45;qbnPMpZQiVAGg2vkUm5Ui+U7d7A@mail.gmail.com -->
<!--X-Reference: CA+CBx2Oz4ohii5GL7r1vphU2X2bwmKbrbwCqBw9_0ixpKbFK0A@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales -- May 13, 2014 - 20:27</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00327" class="tabs">Index by Date</a> | <a href="threads.html#00327" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00325.html">Date Prev</a>] [<a href="msg00333.html">Date Next</a>] [<a href="msg00191.html">Thread Prev</a>] [<a href="msg00367.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Tue, 13 May 2014 19:26:30 +0100</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00327.html">537263D6.4020300@chem.ox.ac.uk</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;20140429-222552.sv20529.12099@gna.org&gt; &lt;CA+CBx2N5ti2-+cs4TPViYxqnEpjH3432hydxCicgOcdLb01cEw@mail.gmail.com&gt; &lt;CAED9pY9josZukT1kOeax=U02GsHL5FMpuaQ9JqTTT+Gx5Ah-eQ@mail.gmail.com&gt; &lt;<a href="msg00000.html">5360CCC8.3050309@chem.ox.ac.uk</a>&gt; &lt;CAED9pY8oW7J-7YcBgSRpDPexRghuRNnK851VJ7E+GePdnS2m3Q@mail.gmail.com&gt; &lt;<a href="msg00010.html">536200D2.2010005@chem.ox.ac.uk</a>&gt; &lt;<a href="msg00063.html">CA+CBx2Nbfndqpv7Rq+X751z-5fi41DmXo2sGFSar_qOWQPWEuA@mail.gmail.com</a>&gt; &lt;<a href="msg00088.html">5366AA19.3000304@chem.ox.ac.uk</a>&gt; &lt;CA+CBx2PXnmcr9DcCEO1K=Jr=ymMncFAJv8amxyBWwzRRv0w3kw@mail.gmail.com&gt; &lt;<a href="msg00098.html">53675322.2@chem.ox.ac.uk</a>&gt; &lt;CA+CBx2NMXNk5hVD8_3UO=wToC+PR5vDanWj5RNDpZB5Q=PfGEQ@mail.gmail.com&gt; &lt;<a href="msg00139.html">53688E6E.9020708@chem.ox.ac.uk</a>&gt; &lt;CAED9pY_zZvLdhs4FUXg2TAzTNJix=wR=Ac5wgnQpRQtBTg0B3Q@mail.gmail.com&gt; &lt;<a href="msg00143.html">53689B49.5010602@chem.ox.ac.uk</a>&gt; &lt;<a href="msg00146.html">CA+CBx2Ne3Qwz2rTMzPy4PA0PkAthd3e8_CFGPHqVO8BAYYDL6A@mail.gmail.com</a>&gt; &lt;<a href="msg00151.html">5368B37E.106@chem.ox.ac.uk</a>&gt; &lt;<a href="msg00152.html">CA+CBx2P11Lh5AB27avQFc7-qbnPMpZQiVAGg2vkUm5Ui+U7d7A@mail.gmail.com</a>&gt; &lt;<a href="msg00191.html">CA+CBx2Oz4ohii5GL7r1vphU2X2bwmKbrbwCqBw9_0ixpKbFK0A@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>User-agent</em>: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:24.0) Gecko/20100101 Thunderbird/24.5.0</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Andrew Baldwin</strong> on May 13, 2014 - 20:27:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Hiya chaps,

</pre><tt>I just double checked your relax implementation (see attached). All 
</tt><tt>looks good!
</tt><pre style="margin: 0em;">

</pre><tt>You might find it interesting to look at the optA flag. Look at the 
</tt><tt>error value, and the relative speed of optA=y/n. The two definitions are 
</tt><tt>formally identical, so the only distinguishing features are speed and 
</tt><tt>precision.
</tt><pre style="margin: 0em;">

</pre><tt>Also, for preference, I would like it if you put a note in the preamble 
</tt><tt>to raise attention to the danger of errors of approximations, and for 
</tt><tt>optimal accuracy analysis should include: off resonance effects (cite eg:
</tt><pre style="margin: 0em;">

</pre><tt>Myint, W. &amp; Ishima, R. Chemical exchange effects during refocusing 
</tt><tt>pulses in constant-time CPMG relaxation dispersion experiments. J Biomol 
</tt><tt>Nmr 45, 207-216, (2009).
</tt><tt>Bain, A. D., Kumar Anand, C. &amp; Nie, Z. Exact solution of the CPMG pulse 
</tt><tt>sequence with phase variation down the echo train: application to R(2) 
</tt><tt>measurements. /J Magn Reson/ *209*, 183-194, (2011).
</tt><pre style="margin: 0em;">

And differential relaxation effects:

</pre><tt>Vallurupalli, P., Hansen, D. F., Stollar, E., Meirovitch, E. &amp; Kay, L. 
</tt><tt>E. Measurement of bond vector orientations in invisible excited states 
</tt><tt>of proteins. Proc Natl Acad Sci U S A 104, 18473-18477, (2007).
</tt><pre style="margin: 0em;">

</pre><tt>Vallurupalli, P., Hansen, D. F. &amp; Kay, L. E. Structures of invisible, 
</tt><tt>excited protein states by relaxation dispersion NMR spectroscopy. Proc 
</tt><tt>Natl Acad Sci U S A 105, 11766-11771, (2008).
</tt><pre style="margin: 0em;">


Best,

Andy.




On 07/05/2014 15:09, Troels Emtekær Linnet wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">
Dear Andrew.
</pre></blockquote><pre style="margin: 0em;">
&gt;
&gt; I am happy to announce, that B14 is now in relax.
&gt;
&gt; I have 1) Optimised B14 as much as possible, Edward keeping a close
&gt; eye to it! 2) Split it into two. A full with r2a!=r2b, and &quot;normal&quot;
&gt; with r2a=r2b. 3) Documented it: # The wiki
&gt; <a  rel="nofollow" href="http://wiki.nmr-relax.com/B14">http://wiki.nmr-relax.com/B14</a> <a  rel="nofollow" href="http://wiki.nmr-relax.com/B14_full">http://wiki.nmr-relax.com/B14_full</a> #
&gt; The library function
</pre><tt>&gt; 
</tt><tt><a  rel="nofollow" href="http://svn.gna.org/viewcvs/*checkout*/relax/trunk/lib/dispersion/b14.py?revision=HEAD">http://svn.gna.org/viewcvs/*checkout*/relax/trunk/lib/dispersion/b14.py?revision=HEAD</a>
</tt><pre style="margin: 0em;">
&gt;
&gt;
&gt;
</pre><tt># The version of the manual is here at (19 MB). Page 141, table p 144, 
</tt><tt>and 155.
</tt><blockquote class="blockquote"><pre style="margin: 0em;">
 <a  rel="nofollow" href="https://dl.dropboxusercontent.com/u/101911/relax_manual_with_baldwin14.pdf">https://dl.dropboxusercontent.com/u/101911/relax_manual_with_baldwin14.pdf</a>
</pre></blockquote><pre style="margin: 0em;">
&gt;
&gt;
&gt;
*Note*, that the manual now list recipe according to appendix 1, with
</pre><blockquote class="blockquote"><pre style="margin: 0em;">
sign conversion according to  the translation from -CR72 to CR72.
</pre></blockquote><pre style="margin: 0em;">
&gt;
&gt; If you have any corrections or comments, please don't hesitate to
&gt; write these.!
&gt;
&gt; You have also earlier expressed a wish to include some comments. We
&gt; can maybe implement some lines in the manual, as: &quot;Comments from the
&gt; Author&quot; ....
&gt;
&gt; That should help future NMR Spectroscopist, to make the right
&gt; decision for model.
&gt;
&gt; If you wish, you can now also consider to change this in your
&gt; manuscript. Appendix 1 – recipe for exact calculation of R2,eff &quot;An
&gt; implementation of the result written in python can be downloaded from
&gt; <a  rel="nofollow" href="http://baldwinlab.chem.ox.ac.uk/resources&quot">http://baldwinlab.chem.ox.ac.uk/resources&quot</a>; Just to remind you, that
&gt; the code is not there yet. If you wish, you can write that it has
&gt; been implemented in relax, to be released in version 3.2
&gt; <a  rel="nofollow" href="http://www.nmr-relax.com/download.html">http://www.nmr-relax.com/download.html</a>
&gt;
&gt; With a possible reference to:
&gt; <a  rel="nofollow" href="http://dx.doi.org/10.1093/bioinformatics/btu166">http://dx.doi.org/10.1093/bioinformatics/btu166</a>
&gt;
&gt; Best Troels
&gt;
&gt;
&gt; 2014-05-06 12:20 GMT+02:00 Troels Emtekær Linnet
&gt; &lt;tlinnet@xxxxxxxxxxxxx&gt;:
&gt;&gt; Hi Andrew.
&gt;&gt;
&gt;&gt; Order of my current work. 1) Optimise B14. 2) Split it into two. A
&gt;&gt; full with r2a!=r2b, and &quot;normal&quot; with r2a=r2b. 3) Get the function
&gt;&gt; code of nicolailong with r2a!=r2b into relax. 4) Modify script:
</pre><tt>&gt;&gt; 
</tt><tt><a  rel="nofollow" href="http://svn.gna.org/viewcvs/*checkout*/relax/trunk/test_suite/system_tests/scripts/relax_disp/cpmg_synthetic.py?revision=HEAD">http://svn.gna.org/viewcvs/*checkout*/relax/trunk/test_suite/system_tests/scripts/relax_disp/cpmg_synthetic.py?revision=HEAD</a>
</tt><pre style="margin: 0em;">
&gt;&gt;
&gt;&gt;
5) Make it generate data with nicolailong, fit with B14 full, CR72
</pre><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">
full, for sensible systems.  6) Make a hyperdim space with dx:
</pre></blockquote></blockquote><pre style="margin: 0em;">
&gt;&gt; <a  rel="nofollow" href="http://www.nmr-relax.com/api/3.1/pipe_control.opendx-module.html#map">http://www.nmr-relax.com/api/3.1/pipe_control.opendx-module.html#map</a>
&gt;&gt;
&gt;&gt;
&gt;&gt;
Then I will see what I think.
</pre><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">

</pre></blockquote></blockquote><pre style="margin: 0em;">
&gt;&gt; Meiboom derivation is not going to happen. ;-) I am not that strong
&gt;&gt; in derivations.
&gt;&gt;
&gt;&gt; Best Troels
&gt;&gt;
&gt;&gt; 2014-05-06 12:03 GMT+02:00 Andrew Baldwin
&gt;&gt; &lt;andrew.baldwin@xxxxxxxxxxxxx&gt;:
&gt;&gt;&gt; Hiya chaps,
&gt;&gt;&gt;
&gt;&gt;&gt; Thank you for you comments. I stand my initial statement though
&gt;&gt;&gt; that the field should not use equations. Did you guys get a
&gt;&gt;&gt; chance to look through the list of papers I pointed you towards?
&gt;&gt;&gt;
&gt;&gt;&gt; Edward, you note often that the additional physics haven't been
&gt;&gt;&gt; experimentally proven to make a difference here. I think the onus
&gt;&gt;&gt; is on you to read those papers, and those they cite and explain
&gt;&gt;&gt; to me why they're wrong, and it's a reasonable thing to neglect
&gt;&gt;&gt; these effects.
&gt;&gt;&gt;
&gt;&gt;&gt; You'll maybe get a 10% screw up if you use the CR equation,
&gt;&gt;&gt; another 10% if you miss off resonance effects (see Ishima paper),
&gt;&gt;&gt; maybe up to 3% if you miss spin flips (see Flemming's paper), and
&gt;&gt;&gt; a few more percent if you're not accounting for the indirect
&gt;&gt;&gt; acquisition time (see supp section 7 in the paper, and citation
&gt;&gt;&gt; to Flemming). Whether or not that's a problem depends on what
&gt;&gt;&gt; you're doing. A structure calculation I think is certainly
&gt;&gt;&gt; broken. Getting out something fancy like an RDC or residual CSA
&gt;&gt;&gt; is broken. But general trends are probably fine.
&gt;&gt;&gt;
&gt;&gt;&gt; People like to make the point that their kex is comparable to
&gt;&gt;&gt; biochemical data from X, and make conclusions therein. I've done
&gt;&gt;&gt; this myself in fact ( J. Mol. Biol. (2011) 413: 310-20). So how
&gt;&gt;&gt; accurate does kex need to be before you can do that? In general,
&gt;&gt;&gt; if the calculation errors are larger than your experimental
&gt;&gt;&gt; errors, you're probably not doing as well as you can do.
&gt;&gt;&gt;
&gt;&gt;&gt; Should people revisit old data? If the data is the lynchpin of a
&gt;&gt;&gt; big project, with conclusions and decisions being made from its
&gt;&gt;&gt; accuracy, then probably this is a prudent thing to do...
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; So, which of these combinations make the highest error?
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; My fig 1 shows exactly the problems are. It's not as simple as
&gt;&gt;&gt; 'this breaks in slow exchange'. One good thing about the errors
&gt;&gt;&gt; in CR is that the errors scale approximately with dispersion
&gt;&gt;&gt; size, so the percentage error is probably roughly constant. CR
&gt;&gt;&gt; breaks most when PE is high. Note also that 'most' of your
&gt;&gt;&gt; information is in the first few points of the dispersion curve,
&gt;&gt;&gt; so errors here disproportionately affect the results.
&gt;&gt;&gt;
&gt;&gt;&gt; I think (but am not 100% sure as I don't fully understand Carver
&gt;&gt;&gt; Richard's original derivation) that the PE error comes because
&gt;&gt;&gt; they consider only magnetisation that originated from the ground
&gt;&gt;&gt; state. Ie, if you start on the ground, hop to the excited and
&gt;&gt;&gt; come back you're considered. If you start on the ground, hop to
&gt;&gt;&gt; the excited, you're considered. If you start on the ground and
&gt;&gt;&gt; stay there, you're considered. But if you start on the excited
&gt;&gt;&gt; and jump onto the ground, you are not considered. This is very
&gt;&gt;&gt; roughly what the term PD helps account for in my derivation (and
&gt;&gt;&gt; it's similarly to PE is why I called it a 'P'). Setting PD to
&gt;&gt;&gt; zero takes my result back to Carver Richard's.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; But is this Figure the same after the change in CR72 equation
&gt;&gt;&gt;&gt; now?
&gt;&gt;&gt; Is it really 8-10 %? for kex = 1000. and pB 5% ?.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; As with all things, test it yourself and see what you think :)
&gt;&gt;&gt; Try it with your code if you think mine is in error.
&gt;&gt;&gt;
&gt;&gt;&gt; How's the Meiboom derivation coming?
&gt;&gt;&gt;
&gt;&gt;&gt; Best,
&gt;&gt;&gt;
&gt;&gt;&gt; Andy.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; On 06/05/2014 10:05, Troels Emtekær Linnet wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; Dear Andrew.
&gt;&gt;&gt;
&gt;&gt;&gt; There is no doubt, that I think that your code is an absolutely
&gt;&gt;&gt; high improvement within the field ! It is working flawless and
&gt;&gt;&gt; very speedy...
&gt;&gt;&gt;
&gt;&gt;&gt; I am hurrying it up to implement it nicely and speedy in relax,
&gt;&gt;&gt; so it can be a model to be selected in the GUI. This new release
&gt;&gt;&gt; is about to come out as version 3.2
&gt;&gt;&gt; (<a  rel="nofollow" href="http://www.nmr-relax.com/download.html">http://www.nmr-relax.com/download.html</a>).
&gt;&gt;&gt;
&gt;&gt;&gt; You new model will probably be the highlight of this release,
&gt;&gt;&gt; since new model implementation is what many people really is
&gt;&gt;&gt; interested in.
&gt;&gt;&gt;
&gt;&gt;&gt; ....
&gt;&gt;&gt;
&gt;&gt;&gt; I love that you make the derivation carefully, and that you take
&gt;&gt;&gt; the care to describe the physical meanings.
&gt;&gt;&gt;
&gt;&gt;&gt; This is really something I have missed as a student, as
&gt;&gt;&gt; mathematical spin operator derivations can kill me, when I can't
&gt;&gt;&gt; put meaning full words on them.
&gt;&gt;&gt;
&gt;&gt;&gt; You paper (when typo corrected), can be a very good reference
&gt;&gt;&gt; for concise derivation.
&gt;&gt;&gt;
&gt;&gt;&gt; Thank you for that !
&gt;&gt;&gt;
&gt;&gt;&gt; So, there is no stick! There is only pure interest. :-)
&gt;&gt;&gt;
&gt;&gt;&gt; If your comments about the &quot;very&quot; bad performance of CR72 is
&gt;&gt;&gt; true, I could be in trouble here.
&gt;&gt;&gt;
&gt;&gt;&gt; I could probably spent a year going through old dataset analysed
&gt;&gt;&gt; with CR72. And really re-think if some of the biological
&gt;&gt;&gt; conclusions is wrong. I can live with a &quot;little&quot; error, but not a
&gt;&gt;&gt; catastrophic error.
&gt;&gt;&gt;
&gt;&gt;&gt; ....
&gt;&gt;&gt;
&gt;&gt;&gt; I would now like to talk a little about the results we have been
&gt;&gt;&gt; reviewing. See <a  rel="nofollow" href="https://gna.org/support/?3154#comment70">https://gna.org/support/?3154#comment70</a>
&gt;&gt;&gt;
&gt;&gt;&gt; What we look at here, is the maximum difference in the 4D grid of
&gt;&gt;&gt; kex, dw, pb, dr.
&gt;&gt;&gt;
&gt;&gt;&gt; ########### kexMax=1.0     #in s-1 kexMin=5000.0
&gt;&gt;&gt;
&gt;&gt;&gt; dwMax=0.1    #in ppm dwMin=1000.0
&gt;&gt;&gt;
&gt;&gt;&gt; pbMax=0.001 pbMin=0.1
&gt;&gt;&gt;
&gt;&gt;&gt; dRMin=1. dRMax=1E4
&gt;&gt;&gt;
&gt;&gt;&gt; Grid=10
&gt;&gt;&gt;
&gt;&gt;&gt; For a 200 MHz. #########
&gt;&gt;&gt;
&gt;&gt;&gt; So, which of these combinations make the highest error?
&gt;&gt;&gt;
&gt;&gt;&gt; It is known, that CR72 is &quot;bad&quot; in slow exchange.
&gt;&gt;&gt;
&gt;&gt;&gt; Slow Dynamics in Folded and Unfolded States of an SH3 Domain
&gt;&gt;&gt; Tollinger, M, Skrynnikov, N R, Mulder, F a, Forman-Kay, J D, Kay,
&gt;&gt;&gt; L E dx.doi.org/10.1021/ja011300z
&gt;&gt;&gt;
&gt;&gt;&gt; See figure 5a.
&gt;&gt;&gt;
&gt;&gt;&gt; (In relax as model TSMFK01: <a  rel="nofollow" href="http://wiki.nmr-relax.com/TSMFK01">http://wiki.nmr-relax.com/TSMFK01</a> )
&gt;&gt;&gt;
&gt;&gt;&gt; This is what your Figure 1 in your paper also should show.
&gt;&gt;&gt;
&gt;&gt;&gt; But is this Figure the same after the change in CR72 equation
&gt;&gt;&gt; now? Is it really 8-10 %? for kex = 1000. and pB 5% ?.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Best Troels
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; 2014-05-06 10:20 GMT+02:00 Andrew Baldwin
&gt;&gt;&gt; &lt;andrew.baldwin@xxxxxxxxxxxxx&gt;:
&gt;&gt;&gt;
&gt;&gt;&gt; Okay. 2 pints. And a packet of crisps :)
&gt;&gt;&gt;
&gt;&gt;&gt; I spent an afternoon on it and couldn't knock it into shape. It's
&gt;&gt;&gt; not obvious to me what additional assumptions you need to make.
&gt;&gt;&gt; Actually this true of CR result also - I couldn't work out from
&gt;&gt;&gt; the paper exactly what it was that they assumed, so I set out to
&gt;&gt;&gt; re-derive it. With the Meiboom, popping in the fast exachange
&gt;&gt;&gt; limit is straightfoward. But then results then don't seem to boil
&gt;&gt;&gt; down as nicely as you'd expect.
&gt;&gt;&gt;
&gt;&gt;&gt; Best,
&gt;&gt;&gt;
&gt;&gt;&gt; Andy.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; On 06/05/2014 09:07, Edward d'Auvergne wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; Andy, you need to be a bit more fair here!  If Troels can come up
&gt;&gt;&gt; with a proof of the Carver and Richards 1972 equations reducing
&gt;&gt;&gt; to the Luz and Meiboom 1963 equations, I would expect at least a
&gt;&gt;&gt; few pints ;)
&gt;&gt;&gt;
&gt;&gt;&gt; Regards,
&gt;&gt;&gt;
&gt;&gt;&gt; Edward
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; On 6 May 2014 09:25, Andrew Baldwin
&gt;&gt;&gt; &lt;andrew.baldwin@xxxxxxxxxxxxx&gt; wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; Hiya Troels,
&gt;&gt;&gt;
&gt;&gt;&gt; Very commendable tenacity with the fluorescence result :) Good
&gt;&gt;&gt; stuff indeed!
&gt;&gt;&gt;
&gt;&gt;&gt; 1) Definition of alpha- :
&gt;&gt;&gt;
&gt;&gt;&gt; That's a fair point. I agree. Alpha- is later squared so either:
&gt;&gt;&gt;
&gt;&gt;&gt; zeta(B14) = 2.0*dw (Delta R2 + k_eg - k_ge) zeta(B14) = 2.0*dw
&gt;&gt;&gt; (-Delta R2 - k_eg + k_ge)
&gt;&gt;&gt;
&gt;&gt;&gt; Will work equally well. Which you use depends on how you choose
&gt;&gt;&gt; to parametrise the Eigenvalues. h1 can be plus or minus depending
&gt;&gt;&gt; on your mood. So my mood says keeping the positive deltaR2 makes
&gt;&gt;&gt; the equation prettier.
&gt;&gt;&gt;
&gt;&gt;&gt; 2) You might need to give a bit more thought to the numerical
&gt;&gt;&gt; implementation. Notice that I add the factor of R2g back in,
&gt;&gt;&gt; during the function Numdisp. Turns out you can factor anything
&gt;&gt;&gt; out from the diagonal as long as you put it back in at the end,
&gt;&gt;&gt; hence the form of the matrix in the code I sent.
&gt;&gt;&gt;
&gt;&gt;&gt; You can prove this by looking at the Eigenvalues, and how they
&gt;&gt;&gt; propagate when you take things like matrix exponentials. In the
&gt;&gt;&gt; same vein, notice that In the paper I subtract R2G from both f00
&gt;&gt;&gt; and f11. I add it back in again later in the constants out the
&gt;&gt;&gt; front. This is following from the lead of Nikolai in his
&gt;&gt;&gt; reconstructing invisible states paper. Implicitly looking at
&gt;&gt;&gt; deltaR2s shows clearly where differences in relaxation have
&gt;&gt;&gt; effects, so this brings out the physics.
&gt;&gt;&gt;
&gt;&gt;&gt; So look at the 'error' reported in the outputs. When you made the
&gt;&gt;&gt; Troels version of the numerical code, the error for the Baldwin
&gt;&gt;&gt; formula was 10s-1. This is actually the exact value you set R2G
&gt;&gt;&gt; to. So while you added in R2G in the evolution matrix (which is
&gt;&gt;&gt; not wrong to do), you didn't then remove it in numdisp, so your
&gt;&gt;&gt; solution is out by one unit of R2G.
&gt;&gt;&gt;
&gt;&gt;&gt; Looking at the outputs, the code I sent for CR had the carver
&gt;&gt;&gt; richard's formula set in the wrong 'minus' configuration, added
&gt;&gt;&gt; during testing while writing the previous email. This was
&gt;&gt;&gt; certainly my foobar. However, note that the maximum 'error'
&gt;&gt;&gt; reported by the code was 4989 s-1 when you ran the code for the
&gt;&gt;&gt; first time. In my previous email:
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; with the alpha- sign made consistent with the Carver Richard's
&gt;&gt;&gt; paper gives an error of 4989 s-1 in the same test
&gt;&gt;&gt;
&gt;&gt;&gt; That should have set off alarm bells for you. Setting either:
&gt;&gt;&gt;
&gt;&gt;&gt; zeta=2*dw*(deltaR2+keg-kge)                 #zeta=g1
&gt;&gt;&gt; zeta=2*dw*(-deltaR2-keg+kge)                 #zeta=g1
&gt;&gt;&gt;
&gt;&gt;&gt; In the CR function as you note (and as you do in relax) is good.
&gt;&gt;&gt; If you subtract the 'Baldwin error' from the 'CR error' you get
&gt;&gt;&gt; 8. 8 s-1 is the biggest error incurred using CR in this parameter
&gt;&gt;&gt; range (as I stated in the last email). So it's fair to call the
&gt;&gt;&gt; CR equation an approximation. Fig 1 speaketh the truth. Calculate
&gt;&gt;&gt; it yourself first using your code before wielding the accusing
&gt;&gt;&gt; stick!
&gt;&gt;&gt;
&gt;&gt;&gt; So I'm deducting one half pint from your score for not checking
&gt;&gt;&gt; the results from your modified numerical code more carefully.
&gt;&gt;&gt;
&gt;&gt;&gt; And now for beer counting: 1) Appendix 1 – recipe for exact
&gt;&gt;&gt; calculation of R2,eff is: h1 = 2.0*dw (R2B - R2A + k_BA - k_AB) =
&gt;&gt;&gt; - CR72  (But it have no influence, but please keep history!
&gt;&gt;&gt; Change it back to CR72. :-)) same for h2.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Pint for the typo in keg/kge. That's a genuine foobar in the manu
&gt;&gt;&gt; - the equations should match code i've written, and I know the
&gt;&gt;&gt; code is right because i've matched it to simulation. I'll keep my
&gt;&gt;&gt; Eigenvalue definitions though.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; 2) zeta typo in eq 70. z=zeta
&gt;&gt;&gt;
&gt;&gt;&gt; Agreed! +1.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; 3) Watch alpha_ in eq 70. Get Delta R straight
&gt;&gt;&gt;
&gt;&gt;&gt; See 1. No extra pint here.
&gt;&gt;&gt;
&gt;&gt;&gt; 4) Comments in CODE:
&gt;&gt;&gt;
</pre><tt>&gt;&gt;&gt; 
</tt><tt><a  rel="nofollow" href="http://svn.gna.org/viewcvs/*checkout*/relax/trunk/lib/dispersion/b14.py?revision=HEAD">http://svn.gna.org/viewcvs/*checkout*/relax/trunk/lib/dispersion/b14.py?revision=HEAD</a>
</tt><pre style="margin: 0em;">
&gt;&gt;&gt;
&gt;&gt;&gt;
g1=2*dw*(deltaR2+keg-kge)                   #same as carver richards zeta
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">
That is not true. That  is minus Zeta. But it does not matter,
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">
&gt;&gt;&gt; since order **2.
&gt;&gt;&gt;
&gt;&gt;&gt; See 1. No extra pint here either.
&gt;&gt;&gt;
&gt;&gt;&gt; 5) Did you actually implement ExchangeMat2x2  wrong?? If yes,
&gt;&gt;&gt; theeeeeen, no wonder figure 1 shows what it does. :-) What is up
&gt;&gt;&gt; for the deltaOmegas story???
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; -1/2 pint for an over-reached conclusion from your modified
&gt;&gt;&gt; code.
&gt;&gt;&gt;
&gt;&gt;&gt; So current score = 1.5
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Meiboom challenge: I'd be interested in a proof for how Carver
&gt;&gt;&gt; Richard's reduces to Meiboom. I'd pay a pint for that. To get you
&gt;&gt;&gt; started, note that in the fast exchange limit, E0 and E2 can be
&gt;&gt;&gt; simplified using the fast exchange limits in supp section 1.
&gt;&gt;&gt;
&gt;&gt;&gt; Best,
&gt;&gt;&gt;
&gt;&gt;&gt; Andy.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; On 05/05/2014 15:27, Troels Emtekær Linnet wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; Hi Andy.
&gt;&gt;&gt;
&gt;&gt;&gt; Heh, the funniest part with the fluorescence was to battle with
&gt;&gt;&gt; the moderators of wikipedia to change 9000 to 9 in R06.
&gt;&gt;&gt;
</pre><tt>&gt;&gt;&gt; 
</tt><tt><a  rel="nofollow" href="http://en.wikipedia.org/wiki/F%C3%B6rster_resonance_energy_transfer#Theoretical_basis">http://en.wikipedia.org/wiki/F%C3%B6rster_resonance_energy_transfer#Theoretical_basis</a>
</tt><pre style="margin: 0em;">
&gt;&gt;&gt;
&gt;&gt;&gt;
That was a brawl, to convince them that the bible was wrong. But
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">
referring to the old  dusty library book of Forster (Ref 14) made
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">
&gt;&gt;&gt; the deal.
&gt;&gt;&gt;
&gt;&gt;&gt; Back to the beer.
&gt;&gt;&gt;
&gt;&gt;&gt; You are swapping two things in your code, according to CR72.
&gt;&gt;&gt;
&gt;&gt;&gt; If I write up CR72: (Directly from cr72.py) ####### fact = r20a -
&gt;&gt;&gt; r20b - k_BA + k_AB zeta = 2.0*dw * fact
&gt;&gt;&gt;
&gt;&gt;&gt; So in total: %%%%% zeta(CR72) = 2.0*dw (R2A - R2B + k_AB - k_BA)
&gt;&gt;&gt; %%%%
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Then we take your code: ####### deltaR2=R2e-R2g
&gt;&gt;&gt; g1=2*dw*(deltaR2+keg-kge)                   #same as carver
&gt;&gt;&gt; richards zeta
&gt;&gt;&gt;
&gt;&gt;&gt; Change notation, to make it easier to see: %%%%% zeta(B14) =
&gt;&gt;&gt; 2.0*dw (R2B - R2A + k_BA - k_AB) %%%% But huh, is that not just:
&gt;&gt;&gt;
&gt;&gt;&gt; zeta(B14) = - zeta(CR72) = 2.0*dw ( - R2A + R2B - k_AB + k_BA) =
&gt;&gt;&gt; 2.0*dw ( R2B - R2A + k_BA - k_AB)
&gt;&gt;&gt;
&gt;&gt;&gt; Well, that is interesting. So your g1 is the negative of carver
&gt;&gt;&gt; richards zeta.
&gt;&gt;&gt;
&gt;&gt;&gt; Fortunately we are lucky, that zeta is to the power **2. So that
&gt;&gt;&gt; leaves it out.
&gt;&gt;&gt;
&gt;&gt;&gt; How about psi? It boils down to that fact(B14) = - fact(CR72)
&gt;&gt;&gt; &lt;=&gt; alpha_ (B14) = - alpha_ (CR72)
&gt;&gt;&gt;
&gt;&gt;&gt; But alpha_ is also to the power **2. Phew...
&gt;&gt;&gt;
&gt;&gt;&gt; So what is up. If we look at: (compareTroells.py)
&gt;&gt;&gt; <a  rel="nofollow" href="https://gna.org/support/download.php?file_id=20636">https://gna.org/support/download.php?file_id=20636</a>
&gt;&gt;&gt;
&gt;&gt;&gt; ############## def
&gt;&gt;&gt; CarverRichards(kex,pb,dw,ncyc,Trelax,R2g,R2e,outfile,verb='n'):
&gt;&gt;&gt; deltaR2=R2e-R2g keg=(1-pb)*kex kge=pb*kex
&gt;&gt;&gt;
&gt;&gt;&gt; zeta=2*dw*(-deltaR2+keg-kge)                 #zeta=g1
&gt;&gt;&gt; psi=(deltaR2+keg-kge)**2.0+4*keg*kge-dw**2  #psi=g2
&gt;&gt;&gt; #############
&gt;&gt;&gt;
&gt;&gt;&gt; Well here we have something ! zeta = 2.0 * dw ( R2A - R2B - k_AB
&gt;&gt;&gt; + k_BA )
&gt;&gt;&gt;
&gt;&gt;&gt; So this is not about how you make the difference of ( R2A - R2B
&gt;&gt;&gt; ) it is the swapping of + k_AB - k_BA &lt;&lt;  - k_AB + k_BA kex(1 -
&gt;&gt;&gt; 2pa) &lt;&lt; kex( -1 + 2pa )
&gt;&gt;&gt;
&gt;&gt;&gt; You have implemented CR72 wrong ?
&gt;&gt;&gt;
&gt;&gt;&gt; Hmmmm. What is up?
&gt;&gt;&gt;
&gt;&gt;&gt; You get a difference between CR72, and numerical. You cannot get
&gt;&gt;&gt; CR72 to work, unless you modify alpha_. You invert the signs of
&gt;&gt;&gt; forward / backward exchange rate.
&gt;&gt;&gt;
&gt;&gt;&gt; You say that numerical is true, so CR72 is wrong.
&gt;&gt;&gt;
&gt;&gt;&gt; Lets inspect numerical.
&gt;&gt;&gt;
&gt;&gt;&gt; If we look at: (compareTroells.py)
&gt;&gt;&gt; <a  rel="nofollow" href="https://gna.org/support/download.php?file_id=20636">https://gna.org/support/download.php?file_id=20636</a> Now we look up
&gt;&gt;&gt; the numerical solution. #####
&gt;&gt;&gt; NumDisp(kex,pb,dw,ncyc,Trelax,R2g,R2e,outfile,verb='n'):
&gt;&gt;&gt; array=CPMG2x2(dw,(R2e-R2g),kex,pb,Trelax,ncyc)
&gt;&gt;&gt; CPMG2x2(dOmega,DeltaR2,kex,pb,Trel,ncyc):
&gt;&gt;&gt; L=ExchangeMat2x2(dOmega,DeltaR2,kex,pb)
&gt;&gt;&gt; ExchangeMat2x2(dOmega,DeltaR2,kex,pb): L = mat(zeros((2,
&gt;&gt;&gt; 2),dtype=complex)) L[1,1] -= DeltaR2
&gt;&gt;&gt;
&gt;&gt;&gt; Hmmm. According to your paper at equation 3.
&gt;&gt;&gt;
&gt;&gt;&gt; R+ = [[ -kAB - R2A]  [kBA] ] [ kAB]      [ -kBA - R2B - i dw] ]
&gt;&gt;&gt;
&gt;&gt;&gt; But I see that it gets populated like R+ = [[ -kAB ] [kBA] ] [
&gt;&gt;&gt; kAB]      [ -kBA - R2B + R2A - i dw] ]
&gt;&gt;&gt;
&gt;&gt;&gt; Has this something to do with it:
&gt;&gt;&gt;
&gt;&gt;&gt; ????
&gt;&gt;&gt;
&gt;&gt;&gt; So I took the liberty to change your code, hoping the Theory is
&gt;&gt;&gt; right.
&gt;&gt;&gt;
&gt;&gt;&gt; ############# Normal Baldwin 1.183188 1.0 Numerical 58.556647
&gt;&gt;&gt; 49.4905687008 Meiboom 0.391873 0.331200958766 Carver 0.693676
&gt;&gt;&gt; 0.586277075156 compareTroells_w_Troels_mod.py:260:
&gt;&gt;&gt; RuntimeWarning: invalid value encountered in log
&gt;&gt;&gt; R2eff=(1/Tc)*numpy.log(intensity0/intensity); # we did
&gt;&gt;&gt; not factor out (Ka+Kb)/2 here Nikolai 3.434938 2.90312105938
&gt;&gt;&gt; NikolaiLong 585.485493 494.837247335
&gt;&gt;&gt;
&gt;&gt;&gt; Maximum error over grid (s-1): Meiboom: 93015865.9296
&gt;&gt;&gt; Baldwin:          1.49539403083e-09 CarverRichards:
&gt;&gt;&gt; 4989.8296812 Nikolai dougle (9): 204.761587913 Nikolai
&gt;&gt;&gt; long double (23):     2.0692254415912185547869e-7
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; ############ Modifying Meiboom to 4 NCYC Maximum error over grid
&gt;&gt;&gt; (s-1): Meiboom:          22664952.3388 Baldwin:
&gt;&gt;&gt; 1.49539403083e-09 CarverRichards:   4989.8296812
&gt;&gt;&gt;
&gt;&gt;&gt; ########### Modifying ExchangeMat2x2 to your paper version.
&gt;&gt;&gt; Meiboom:          22664942.3388 Baldwin: 10.0000000012
&gt;&gt;&gt; CarverRichards:   4979.8296812
&gt;&gt;&gt;
&gt;&gt;&gt; ########## Modify CR72 zeta=2*dw*(-deltaR2-keg+kge) Baldwin
&gt;&gt;&gt; 1.216869 1.0 Numerical 60.302727 49.555644034 Meiboom 0.397395
&gt;&gt;&gt; 0.326571718073 Carver 0.700189 0.575402118059
&gt;&gt;&gt; compareTroells_w_Troels_mod.py:261: RuntimeWarning: invalid
&gt;&gt;&gt; value encountered in log
&gt;&gt;&gt; R2eff=(1/Tc)*numpy.log(intensity0/intensity); # we did
&gt;&gt;&gt; not factor out (Ka+Kb)/2 here Nikolai 3.569577 2.93341107383
&gt;&gt;&gt; NikolaiLong 591.459824 486.050531323 Maximum error over grid
&gt;&gt;&gt; (s-1): Meiboom:          22664942.3388 Baldwin:
&gt;&gt;&gt; 10.0000000012 CarverRichards:   18.2238852463 Nikolai dougle (9):
&gt;&gt;&gt; 214.761587913 Nikolai long double (23):
&gt;&gt;&gt; 10.000000207062814176945
&gt;&gt;&gt;
&gt;&gt;&gt; WOOOOOWWWW
&gt;&gt;&gt;
&gt;&gt;&gt; The change I made was:
&gt;&gt;&gt;
&gt;&gt;&gt; ############################################## 37c37 &lt; def
&gt;&gt;&gt; ExchangeMat2x2(dOmega,DeltaR2,kex,pb): ---
&gt;&gt;&gt;
&gt;&gt;&gt; def ExchangeMat2x2(dOmega,R2e,R2g,kex,pb):
&gt;&gt;&gt;
&gt;&gt;&gt; 47c47 &lt;     L[1,1] -= DeltaR2 ---
&gt;&gt;&gt;
&gt;&gt;&gt; L[1,1] -= R2e
&gt;&gt;&gt;
&gt;&gt;&gt; 49a50
&gt;&gt;&gt;
&gt;&gt;&gt; L[0, 0] -= R2g
&gt;&gt;&gt;
&gt;&gt;&gt; 64,65c65,66 &lt; def CPMG2x2(dOmega,DeltaR2,kex,pb,Trel,ncyc): &lt;
&gt;&gt;&gt; L=ExchangeMat2x2(dOmega,DeltaR2,kex,pb) ---
&gt;&gt;&gt;
&gt;&gt;&gt; def CPMG2x2(dOmega,R2e,R2g,kex,pb,Trel,ncyc):
&gt;&gt;&gt; L=ExchangeMat2x2(dOmega,R2e,R2g,kex,pb)
&gt;&gt;&gt;
&gt;&gt;&gt; 86,87c87,88 &lt;     tcp=1/(2*nu_cpmg) &lt;
&gt;&gt;&gt;
</pre><tt>&gt;&gt;&gt; 
</tt><tt>R2eff=(1-pb)*R2g+pb*R2e+R2Fast*(1.-(2./(kex*tcp))*numpy.tanh(kex*tcp/2.0))
</tt><pre style="margin: 0em;">
&gt;&gt;&gt;
&gt;&gt;&gt;
---
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">

</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">
&gt;&gt;&gt; tcp=1/(4*nu_cpmg)
&gt;&gt;&gt;
&gt;&gt;&gt;
</pre><tt>&gt;&gt;&gt; 
</tt><tt>R2eff=(1-pb)*R2g+pb*R2e+R2Fast*(1.-(4./(kex*tcp))*numpy.tanh(kex*tcp/4.0))
</tt><pre style="margin: 0em;">
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
112c113
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">
&lt;zeta=2*dw*(-deltaR2+keg-kge)                 #zeta=g1 ---
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">
&gt;&gt;&gt;
&gt;&gt;&gt; zeta=2*dw*(-deltaR2-keg+kge)                 #zeta=g1
&gt;&gt;&gt;
&gt;&gt;&gt; 145c146 &lt; array=CPMG2x2(dw,(R2e-R2g),kex,pb,Trelax,ncyc) ---
&gt;&gt;&gt;
&gt;&gt;&gt; array=CPMG2x2(dw,R2e,R2g,kex,pb,Trelax,ncyc)
&gt;&gt;&gt;
&gt;&gt;&gt; 546c547 &lt;
&gt;&gt;&gt; #tom,jarr=TestDisp(ncyc,Trelax,R2g,'NikolaiLong',tim) ---
&gt;&gt;&gt;
&gt;&gt;&gt; tom,jarr=TestDisp(ncyc,Trelax,R2g,'NikolaiLong',tim)
&gt;&gt;&gt;
&gt;&gt;&gt; 560c561 &lt;     print 'Nikolai long double (18):
&gt;&gt;&gt; ',numpy.max(numpy.abs(narr[:,:,1]-larr[:,:,1])) ---
&gt;&gt;&gt;
&gt;&gt;&gt; #print 'Nikolai long double (18):
&gt;&gt;&gt; ',numpy.max(numpy.abs(narr[:,:,1]-larr[:,:,1]))
&gt;&gt;&gt;
&gt;&gt;&gt; [tlinnet@tomat ~/Downloads]$ diff compareTroells.py
&gt;&gt;&gt; compareTroells_w_Troels_mod.py 37c37 &lt; def
&gt;&gt;&gt; ExchangeMat2x2(dOmega,DeltaR2,kex,pb): ---
&gt;&gt;&gt;
&gt;&gt;&gt; def ExchangeMat2x2(dOmega,R2e,R2g,kex,pb):
&gt;&gt;&gt;
&gt;&gt;&gt; 47c47 &lt;     L[1,1] -= DeltaR2 ---
&gt;&gt;&gt;
&gt;&gt;&gt; L[1,1] -= R2e
&gt;&gt;&gt;
&gt;&gt;&gt; 49a50
&gt;&gt;&gt;
&gt;&gt;&gt; L[0, 0] -= R2g
&gt;&gt;&gt;
&gt;&gt;&gt; 64,65c65,66 &lt; def CPMG2x2(dOmega,DeltaR2,kex,pb,Trel,ncyc): &lt;
&gt;&gt;&gt; L=ExchangeMat2x2(dOmega,DeltaR2,kex,pb) ---
&gt;&gt;&gt;
&gt;&gt;&gt; def CPMG2x2(dOmega,R2e,R2g,kex,pb,Trel,ncyc):
&gt;&gt;&gt; L=ExchangeMat2x2(dOmega,R2e,R2g,kex,pb)
&gt;&gt;&gt;
&gt;&gt;&gt; 86,87c87,88 &lt;     tcp=1/(2*nu_cpmg) &lt;
&gt;&gt;&gt;
</pre><tt>&gt;&gt;&gt; 
</tt><tt>R2eff=(1-pb)*R2g+pb*R2e+R2Fast*(1.-(2./(kex*tcp))*numpy.tanh(kex*tcp/2.0))
</tt><pre style="margin: 0em;">
&gt;&gt;&gt;
&gt;&gt;&gt;
---
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">

</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">
&gt;&gt;&gt; tcp=1/(4*nu_cpmg)
&gt;&gt;&gt;
&gt;&gt;&gt;
</pre><tt>&gt;&gt;&gt; 
</tt><tt>R2eff=(1-pb)*R2g+pb*R2e+R2Fast*(1.-(4./(kex*tcp))*numpy.tanh(kex*tcp/4.0))
</tt><pre style="margin: 0em;">
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
112c113
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">
&lt;zeta=2*dw*(-deltaR2+keg-kge)                 #zeta=g1 ---
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">
&gt;&gt;&gt;
&gt;&gt;&gt; zeta=2*dw*(-deltaR2-keg+kge)                 #zeta=g1
&gt;&gt;&gt;
&gt;&gt;&gt; 145c146 &lt; array=CPMG2x2(dw,(R2e-R2g),kex,pb,Trelax,ncyc) ---
&gt;&gt;&gt;
&gt;&gt;&gt; array=CPMG2x2(dw,R2e,R2g,kex,pb,Trelax,ncyc)
&gt;&gt;&gt;
&gt;&gt;&gt; 546c547 &lt;
&gt;&gt;&gt; #tom,jarr=TestDisp(ncyc,Trelax,R2g,'NikolaiLong',tim) ---
&gt;&gt;&gt;
&gt;&gt;&gt; tom,jarr=TestDisp(ncyc,Trelax,R2g,'NikolaiLong',tim)
&gt;&gt;&gt;
&gt;&gt;&gt; 560c561 &lt;     print 'Nikolai long double (18):
&gt;&gt;&gt; ',numpy.max(numpy.abs(narr[:,:,1]-larr[:,:,1])) ---
&gt;&gt;&gt;
&gt;&gt;&gt; #print 'Nikolai long double (18):
&gt;&gt;&gt; ',numpy.max(numpy.abs(narr[:,:,1]-larr[:,:,1]))
&gt;&gt;&gt;
&gt;&gt;&gt; [tlinnet@tomat ~/Downloads]$ diff compareTroells.py
&gt;&gt;&gt; compareTroells_w_Troels_mod.py 37c37 &lt; def
&gt;&gt;&gt; ExchangeMat2x2(dOmega,DeltaR2,kex,pb): ---
&gt;&gt;&gt;
&gt;&gt;&gt; def ExchangeMat2x2(dOmega,R2e,R2g,kex,pb):
&gt;&gt;&gt;
&gt;&gt;&gt; 47c47 &lt;     L[1,1] -= DeltaR2 ---
&gt;&gt;&gt;
&gt;&gt;&gt; L[1,1] -= R2e
&gt;&gt;&gt;
&gt;&gt;&gt; 49a50
&gt;&gt;&gt;
&gt;&gt;&gt; L[0, 0] -= R2g
&gt;&gt;&gt;
&gt;&gt;&gt; 64,65c65,66 &lt; def CPMG2x2(dOmega,DeltaR2,kex,pb,Trel,ncyc): &lt;
&gt;&gt;&gt; L=ExchangeMat2x2(dOmega,DeltaR2,kex,pb) ---
&gt;&gt;&gt;
&gt;&gt;&gt; def CPMG2x2(dOmega,R2e,R2g,kex,pb,Trel,ncyc):
&gt;&gt;&gt; L=ExchangeMat2x2(dOmega,R2e,R2g,kex,pb)
&gt;&gt;&gt;
&gt;&gt;&gt; 86,87c87,88 &lt;     tcp=1/(2*nu_cpmg) &lt;
&gt;&gt;&gt;
</pre><tt>&gt;&gt;&gt; 
</tt><tt>R2eff=(1-pb)*R2g+pb*R2e+R2Fast*(1.-(2./(kex*tcp))*numpy.tanh(kex*tcp/2.0))
</tt><pre style="margin: 0em;">
&gt;&gt;&gt;
&gt;&gt;&gt;
---
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">

</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">
&gt;&gt;&gt; tcp=1/(4*nu_cpmg)
&gt;&gt;&gt;
&gt;&gt;&gt;
</pre><tt>&gt;&gt;&gt; 
</tt><tt>R2eff=(1-pb)*R2g+pb*R2e+R2Fast*(1.-(4./(kex*tcp))*numpy.tanh(kex*tcp/4.0))
</tt><pre style="margin: 0em;">
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
112c113
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">
&lt;zeta=2*dw*(-deltaR2+keg-kge)                 #zeta=g1 ---
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">
&gt;&gt;&gt;
&gt;&gt;&gt; zeta=2*dw*(-deltaR2-keg+kge)                 #zeta=g1
&gt;&gt;&gt;
&gt;&gt;&gt; 145c146 &lt; array=CPMG2x2(dw,(R2e-R2g),kex,pb,Trelax,ncyc) ---
&gt;&gt;&gt;
&gt;&gt;&gt; array=CPMG2x2(dw,R2e,R2g,kex,pb,Trelax,ncyc)
&gt;&gt;&gt;
&gt;&gt;&gt; 546c547 &lt;
&gt;&gt;&gt; #tom,jarr=TestDisp(ncyc,Trelax,R2g,'NikolaiLong',tim) ---
&gt;&gt;&gt;
&gt;&gt;&gt; tom,jarr=TestDisp(ncyc,Trelax,R2g,'NikolaiLong',tim)
&gt;&gt;&gt;
&gt;&gt;&gt; 560c561 &lt;     print 'Nikolai long double (18):
&gt;&gt;&gt; ',numpy.max(numpy.abs(narr[:,:,1]-larr[:,:,1])) ---
&gt;&gt;&gt;
&gt;&gt;&gt; #print 'Nikolai long double (18):
&gt;&gt;&gt; ',numpy.max(numpy.abs(narr[:,:,1]-larr[:,:,1]))
&gt;&gt;&gt;
&gt;&gt;&gt; ####################################
&gt;&gt;&gt;
&gt;&gt;&gt; File can be downloaded from:
&gt;&gt;&gt; <a  rel="nofollow" href="https://gna.org/support/download.php?file_id=20642">https://gna.org/support/download.php?file_id=20642</a>
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; What have we (maybe) learned?????
&gt;&gt;&gt;
&gt;&gt;&gt; 1) Baldwin has created a code, which is as good as the numerical
&gt;&gt;&gt; of Nicolai. Thanks !!! Wuhuuu ! 2) CR72 is still valid though.
&gt;&gt;&gt; Doing well.
&gt;&gt;&gt;
&gt;&gt;&gt; And now for beer counting: 1) Appendix 1 – recipe for exact
&gt;&gt;&gt; calculation of R2,eff is: h1 = 2.0*dw (R2B - R2A + k_BA - k_AB) =
&gt;&gt;&gt; - CR72  (But it have no influence, but please keep history!
&gt;&gt;&gt; Change it back to CR72. :-)) same for h2.
&gt;&gt;&gt;
&gt;&gt;&gt; 2) zeta typo in eq 70. z=zeta
&gt;&gt;&gt;
&gt;&gt;&gt; 3) Watch alpha_ in eq 70. Get Delta R straight
&gt;&gt;&gt;
&gt;&gt;&gt; 4) Comments in CODE:
&gt;&gt;&gt;
</pre><tt>&gt;&gt;&gt; 
</tt><tt><a  rel="nofollow" href="http://svn.gna.org/viewcvs/*checkout*/relax/trunk/lib/dispersion/b14.py?revision=HEAD">http://svn.gna.org/viewcvs/*checkout*/relax/trunk/lib/dispersion/b14.py?revision=HEAD</a>
</tt><pre style="margin: 0em;">
&gt;&gt;&gt;
&gt;&gt;&gt;
g1=2*dw*(deltaR2+keg-kge)                   #same as carver richards zeta
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">
That is not true. That  is minus Zeta. But it does not matter,
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">
&gt;&gt;&gt; since order **2.
&gt;&gt;&gt;
&gt;&gt;&gt; g2=(deltaR2+keg-kge)**2.0+4*keg*kge-dw**2   #same as carver
&gt;&gt;&gt; richards psi Not totally correct, but since deltaR2 is swapped,
&gt;&gt;&gt; it gets minus alpha, and goes to order 2.
&gt;&gt;&gt;
&gt;&gt;&gt; 5) Did you actually implement ExchangeMat2x2  wrong?? If yes,
&gt;&gt;&gt; theeeeeen, no wonder figure 1 shows what it does. :-) What is up
&gt;&gt;&gt; for the deltaOmegas story???
&gt;&gt;&gt;
&gt;&gt;&gt; This is my 2 cents. :-)
&gt;&gt;&gt;
&gt;&gt;&gt; Let me hear if my hours have been wasted.
&gt;&gt;&gt;
&gt;&gt;&gt; Best Troels
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; 2014-05-05 11:00 GMT+02:00 Andrew Baldwin
&gt;&gt;&gt; &lt;andrew.baldwin@xxxxxxxxxxxxx&gt;:
&gt;&gt;&gt;
&gt;&gt;&gt; I had to struggle long to find out the Forster distance
&gt;&gt;&gt; calculation in
&gt;&gt;&gt;
&gt;&gt;&gt; Lakowicz was wrong. The bible of fluorescence...
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Very good stuff :) Most would not take the time to check :) The
&gt;&gt;&gt; finest biophysics really does demand both first rate biology and
&gt;&gt;&gt; first rate physics.
&gt;&gt;&gt;
&gt;&gt;&gt; I don't think anyone has ever used the CR equation to analyse
&gt;&gt;&gt; data outside of the limit where R2A=R2B, so it's very unlikely
&gt;&gt;&gt; that this has error has had any real consequence. Note also that
&gt;&gt;&gt; in general, it's actually much easier to code up a numerical
&gt;&gt;&gt; solution - ie once you've typed up an evolution matrix, all you
&gt;&gt;&gt; have left to do is write some lines taking matrix exponentials.
&gt;&gt;&gt; Whereas with an equation, not only are you making implicit
&gt;&gt;&gt; approximations that aren't necessarily obvious, there are many,
&gt;&gt;&gt; many, more lines to type, thus increasing the probability of a
&gt;&gt;&gt; foobar. So numerical solutions for spin dynamics = no mistakes,
&gt;&gt;&gt; and also easy to code! This has been the approach in the Kay
&gt;&gt;&gt; group, arguably cultivated by Dimitri and Nikolai, and then
&gt;&gt;&gt; pushed hard more recently by Flemming, Pramodh and Guillaume.
&gt;&gt;&gt;
&gt;&gt;&gt; This paper was truly groundbreaking (in my view): Journal of
&gt;&gt;&gt; biomolecular NMR. 2000 18(1):49-63
&gt;&gt;&gt;
&gt;&gt;&gt; On this note, there are a few suggestions that Flemming and I are
&gt;&gt;&gt; putting together for another thread sensibly started by Edward a
&gt;&gt;&gt; few days ago for analysing R1rho and CPMG data. I think that with
&gt;&gt;&gt; just a few extra tweaks, the backend to your code can be as
&gt;&gt;&gt; powerful and as versatile as your front end, for millisecond data
&gt;&gt;&gt; analysis. I agree that it really is in the interests of the field
&gt;&gt;&gt; to have people able to perform the experiments and get
&gt;&gt;&gt; information out of their data as efficiently (and as rigorously)
&gt;&gt;&gt; as possible.
&gt;&gt;&gt;
&gt;&gt;&gt; This means more citations for those that made the experiments,
&gt;&gt;&gt; and the community can keep showing more examples where Xray
&gt;&gt;&gt; people have inadvertently missed functionally relevant conformers
&gt;&gt;&gt; :)
&gt;&gt;&gt;
&gt;&gt;&gt; Best,
&gt;&gt;&gt;
&gt;&gt;&gt; Andy.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; On 04/05/2014 23:09, Troels Emtekær Linnet wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; Well Andrew.
&gt;&gt;&gt;
&gt;&gt;&gt; Your paper popped out of the Mail alerts. :-)
&gt;&gt;&gt;
&gt;&gt;&gt; My supervisor Kaare Teilum guided my attention to it, and asked
&gt;&gt;&gt; me to go through it to check.
&gt;&gt;&gt;
&gt;&gt;&gt; I discussed it with a lab colleague, and we were thrived.
&gt;&gt;&gt;
&gt;&gt;&gt; The math derivations still kills me, but I thought that the
&gt;&gt;&gt; essential results was alarming. I mean, half of our lab do CPMG
&gt;&gt;&gt; or R1rho. Any changes to those equations gets our attention.
&gt;&gt;&gt;
&gt;&gt;&gt; The &quot;worst&quot; problem we have in our lab, is the ability to analyse
&gt;&gt;&gt; data. With relax, we now have a GUI, which make sure that at
&gt;&gt;&gt; least the Bachelor Students still survive.
&gt;&gt;&gt;
&gt;&gt;&gt; And what else can I then do than get dirty with your code, to
&gt;&gt;&gt; test if it is right?
&gt;&gt;&gt;
&gt;&gt;&gt; If you suspicion about the CR72 is correct, then I really really
&gt;&gt;&gt; wonder why not errata article is out there?
&gt;&gt;&gt;
&gt;&gt;&gt; This situation reminds me of my master thesis. I had to struggle
&gt;&gt;&gt; long to find out the Forster distance calculation in Lakowicz was
&gt;&gt;&gt; wrong. The bible of fluorescence...
&gt;&gt;&gt;
&gt;&gt;&gt; Jesus....
&gt;&gt;&gt;
&gt;&gt;&gt; but thanks for the beer!
&gt;&gt;&gt;
&gt;&gt;&gt; Best Your biggest fan. ;-)
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; 2014-05-04 22:59 GMT+02:00 Andrew Baldwin
&gt;&gt;&gt; &lt;andrew.baldwin@xxxxxxxxxxxxx&gt;:
&gt;&gt;&gt;
&gt;&gt;&gt; Dear Troels,
&gt;&gt;&gt;
&gt;&gt;&gt; The existence of typos is exceedingly probable! The editors have
&gt;&gt;&gt; added more errors in the transcrpition, so it'll be curious to
&gt;&gt;&gt; see how accurate the final draft will be. Your comments come just
&gt;&gt;&gt; in time for alterations.
&gt;&gt;&gt;
&gt;&gt;&gt; So I'll pay a pint of beer for every identified error. I didn't
&gt;&gt;&gt; use that particular supplementary section to directly calculate
&gt;&gt;&gt; anything, so this is the place in the manu where errors are most
&gt;&gt;&gt; likely to occur. I do note the irony that this is probably one of
&gt;&gt;&gt; few bits in the article that people are likely to read.
&gt;&gt;&gt;
&gt;&gt;&gt; 1) Yep - that's a typo. alpha- should definitely be KEG-KGE
&gt;&gt;&gt; (score 1 pint).
&gt;&gt;&gt;
&gt;&gt;&gt; 2) Yep! zs should be zetas (score 1 pint).
&gt;&gt;&gt;
&gt;&gt;&gt; 3) This one is more interesting. Carver and Richard's didn't
&gt;&gt;&gt; define a deltaR2. To my knowledge, I think Nikolai was the first
&gt;&gt;&gt; to do that in his 2002 paper on reconstructing invisible states.
&gt;&gt;&gt; So here, I think you'll find that my definition is the correct
&gt;&gt;&gt; one. There is a typo in the Carver Richard's equation. I've just
&gt;&gt;&gt; done a brief lit review, and as far as I can see, this mistake
&gt;&gt;&gt; has propagated into every transcription of the equation since. I
&gt;&gt;&gt; should note that in the manu in this section. Likely this has
&gt;&gt;&gt; gone un-noticed as differences in R2 are difficult to measure by
&gt;&gt;&gt; CPMG, instead R2A=R2B being assumed. Though thanks to Flemming,
&gt;&gt;&gt; it is now possible to break this assumption:
&gt;&gt;&gt;
&gt;&gt;&gt; J Am Chem Soc. 2009 Sep 9;131(35):12745-54. doi:
&gt;&gt;&gt; 10.1021/ja903897e.
&gt;&gt;&gt;
&gt;&gt;&gt; Also, in the Ishima and Torchia paper looking at the effects of
&gt;&gt;&gt; relaxation differences:
&gt;&gt;&gt;
&gt;&gt;&gt; Journal of biomolecular NMR. 2006 34(4):209-19
&gt;&gt;&gt;
&gt;&gt;&gt; I understand their derivations started from Nikolai's formula,
&gt;&gt;&gt; which is exact, so the error wouldn't come to light there either,
&gt;&gt;&gt; necessarily.
&gt;&gt;&gt;
&gt;&gt;&gt; To prove the point try this: numerically evaluate R2,effs over a
&gt;&gt;&gt; big grid of parameters, and compare say Nikolai's formula to your
&gt;&gt;&gt; implementation of Carver Richard's with a +deltaR2 and a -deltaR2
&gt;&gt;&gt; in the alpha- parameter. Which agrees better? You'll see that
&gt;&gt;&gt; dR2=R2E-R2G being positive wins.
&gt;&gt;&gt;
&gt;&gt;&gt; The attached should also help. It's some test code I used for the
&gt;&gt;&gt; paper that has been briefly sanitised. In it, the numerical
&gt;&gt;&gt; result, Carver Richards, Meiboom, Nikolai's and my formula are
&gt;&gt;&gt; directly compared for speed (roughly) and precision.
&gt;&gt;&gt;
&gt;&gt;&gt; The code added for Nikolai's formula at higher precision was
&gt;&gt;&gt; contributed by Nikolai after the two of us discussed some very
&gt;&gt;&gt; odd results that can come from his algorithm. Turns out
&gt;&gt;&gt; evaluating his algorithm at double precision (roughly 9 decimal
&gt;&gt;&gt; places, default in python and matlab) is insuffficient. About 23
&gt;&gt;&gt; decimal places is necessary for exactness. This is what is
&gt;&gt;&gt; discussed in the supplementary info in the recent paper. In
&gt;&gt;&gt; short, on my laptop:
&gt;&gt;&gt;
&gt;&gt;&gt; formula / relative speed / biggest single point error in s-1 over
&gt;&gt;&gt; grid Mine                                         1
&gt;&gt;&gt; 7.2E-10 Meiboom 0.3         9E7
&gt;&gt;&gt; Carver Richards                       0.53       8 Nikolai
&gt;&gt;&gt; (double precision 9dp)  3.1        204 Nikolai (long double 18dp)
&gt;&gt;&gt; 420       3E-2 Nikolai (23 dp)                         420
&gt;&gt;&gt; 2E-7 Numerical 118        0
&gt;&gt;&gt;
&gt;&gt;&gt; The error in Carver Richard's with the alpha- sign made
&gt;&gt;&gt; consistent with the Carver Richard's paper gives an error of 4989
&gt;&gt;&gt; s-1 in the same test. Ie, it's a bad idea.
&gt;&gt;&gt;
&gt;&gt;&gt; Note that the precise calculations in python at arbitrary
&gt;&gt;&gt; precision are slow not because of the algorithm, but because of
&gt;&gt;&gt; the mpmath module, which deals with C code via strings. Accurate
&gt;&gt;&gt; but slow. This code has a small amount of additional overhead
&gt;&gt;&gt; that shouldn't strictly be included in the time. I've no doubt
&gt;&gt;&gt; also that algorithms here could be sped up further by giving them
&gt;&gt;&gt; a bit of love. Those prefaces aside, I'm surprised that your
&gt;&gt;&gt; benchmarking last Friday showed Nikolai's to be so much slower
&gt;&gt;&gt; than mine? In my hands (attached) at double precision, Nikolai's
&gt;&gt;&gt; formula is only 3x slower than mine using numpy. Though this is
&gt;&gt;&gt; not adequate precision for mistake free calculations.
&gt;&gt;&gt;
&gt;&gt;&gt; Perhaps more physically compelling, to get my equation to reduce
&gt;&gt;&gt; to Carver Richard's, alpha- has to be defined as I show it. Note
&gt;&gt;&gt; that the origin of this parameter is its role in the Eigenvalue
&gt;&gt;&gt; of the 2x2 matrix. This is the one advantage of a derivation -
&gt;&gt;&gt; you can see where the parameters come from and get a feel for
&gt;&gt;&gt; what their meaning is.
&gt;&gt;&gt;
&gt;&gt;&gt; So this typo, and the fact that Carver and Richards inadvertently
&gt;&gt;&gt; change their definition of tau_cpmg half way through the paper,
&gt;&gt;&gt; are both errors in the original manuscript. Though given that
&gt;&gt;&gt; proof reading and type-setting in 1972 would have been very very
&gt;&gt;&gt; painful, that there are this few errors is still actually quite
&gt;&gt;&gt; remarkable. I notice in your CR72 code, you are currently using
&gt;&gt;&gt; the incorrect definition, so I would suggest you change that.
&gt;&gt;&gt;
&gt;&gt;&gt; So overall, I think you're still ahead, so I'm calling that 2
&gt;&gt;&gt; pints to Troels.
&gt;&gt;&gt;
&gt;&gt;&gt; I would actually be very grateful if you can bring up any other
&gt;&gt;&gt; inconsistencies in the paper! Also from an editorial perspective,
&gt;&gt;&gt; please feel free to note if there are parts of the paper that
&gt;&gt;&gt; were particularly unclear when reading. If you let me know,
&gt;&gt;&gt; there's still time to improve it. Thusfar, I think you are the
&gt;&gt;&gt; third person to read this paper (the other two being the
&gt;&gt;&gt; reviewers who were forced to read it), and you're precisely its
&gt;&gt;&gt; target demographic!
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Best,
&gt;&gt;&gt;
&gt;&gt;&gt; Andy.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; On 03/05/2014 13:54, Troels Emtekær Linnet wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; Dear Andrew Baldwin.
&gt;&gt;&gt;
&gt;&gt;&gt; I am in the process of implementing your code in relax.
&gt;&gt;&gt;
&gt;&gt;&gt; I am getting myself into a terrible mess by trying to compare
&gt;&gt;&gt; equations in papers, code and conversions.
&gt;&gt;&gt;
&gt;&gt;&gt; But I hope you maybe have a little time to clear something up?
&gt;&gt;&gt;
&gt;&gt;&gt; I am looking at the current version of your paper:
&gt;&gt;&gt; dx.doi.org/10.1016/j.jmr.2014.02.023 which still is still &quot;early
&gt;&gt;&gt; version of the manuscript. The manuscript will undergo
&gt;&gt;&gt; copyediting, typesetting, and review of the resulting proof
&gt;&gt;&gt; before it is published in its final form.&quot;
&gt;&gt;&gt;
&gt;&gt;&gt; 1) Equations are different ? In Appendix 1 – recipe for exact
&gt;&gt;&gt; calculation of R2,eff h1 = 2 dw (dR2 + kEG - kGE)
&gt;&gt;&gt;
&gt;&gt;&gt; But when I compare to:
&gt;&gt;&gt;
&gt;&gt;&gt; Supplementary Section 4. Relation to Carver Richards equation.
&gt;&gt;&gt; Equation 70. h1 = zeta = 2 dw alpha_ =  2 dw (dR2 + kGE - kEG)
&gt;&gt;&gt;
&gt;&gt;&gt; Is there a typo here? The GE and EG has been swapped.
&gt;&gt;&gt;
&gt;&gt;&gt; 2) Missing zeta in equation 70 There is missing \zeta instead of
&gt;&gt;&gt; z in equation 70, which is probably a typesetting error.
&gt;&gt;&gt;
&gt;&gt;&gt; 3) Definition of &quot; Delta R2&quot; is opposite convention? Near
&gt;&gt;&gt; equation 10, 11 you define: delta R2 = R2e - R2g if we let e=B
&gt;&gt;&gt; and g=A, then delta R2 = R2B - R2A
&gt;&gt;&gt;
&gt;&gt;&gt; And in equation 70: alpha_ =  delta R2 + kGE - kEG
&gt;&gt;&gt;
&gt;&gt;&gt; but i CR original work, A8, alpha_ =  R2A - R2B + kA - kB = -
&gt;&gt;&gt; delta R2 + kGE - kEG
&gt;&gt;&gt;
&gt;&gt;&gt; So, that doesn't match?
&gt;&gt;&gt;
&gt;&gt;&gt; Sorry if these questions are trivial.
&gt;&gt;&gt;
&gt;&gt;&gt; But I hope you can help clear them up for me. :-)
&gt;&gt;&gt;
&gt;&gt;&gt; Best Troels
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; 2014-05-01 10:07 GMT+02:00 Andrew Baldwin
&gt;&gt;&gt; &lt;andrew.baldwin@xxxxxxxxxxxxx&gt;:
&gt;&gt;&gt;
&gt;&gt;&gt; The Carver and Richards code in relax is fast enough, though
&gt;&gt;&gt; Troels might have an interest in squeezing out a little more
&gt;&gt;&gt; speed.  Though it would require different value checking to avoid
&gt;&gt;&gt; NaNs, divide by zeros, trig function overflows (which don't occur
&gt;&gt;&gt; for math.sqrt), etc. Any changes would have to be heavily
&gt;&gt;&gt; documented in the manual, wiki, etc.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; The prove that the two definitions are equivalent is relatively
&gt;&gt;&gt; straightforward. The trig-to-exp command in the brilliant (and
&gt;&gt;&gt; free) symbolic program sage might prove helpful in doing that.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; For the tau_c, tau_cp, tau_cpmg, etc. definitions, comparing the
&gt;&gt;&gt; relax code to your script will ensure that the correct definition
&gt;&gt;&gt; is used. That's how I've made sure that all other dispersion
&gt;&gt;&gt; models are correctly handled - simple comparison to other
&gt;&gt;&gt; software.  I'm only aware of two definitions though:
&gt;&gt;&gt;
&gt;&gt;&gt; tau_cpmg = 1 / (4 nu_cpmg) tau_cpmg = 1 / (2 nu_cpmg)
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; tau_cpmg = 1/(nu_cpmg).
&gt;&gt;&gt;
&gt;&gt;&gt; Carver and Richard's switch definitions half way through the
&gt;&gt;&gt; paper somewhere.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; What is the third?  Internally in relax, the 1 / (4 nu_cpmg)
&gt;&gt;&gt; definition is used.  But the user inputs nu_cpmg. This avoids
&gt;&gt;&gt; the user making this mistake as nu_cpmg only has one definition.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; I've seen people use nu_cpmg defined as the pulse frequency. It's
&gt;&gt;&gt; just an error that students make when things aren't clear. I've
&gt;&gt;&gt; often seen brave student from a lab that has never tried CPMG
&gt;&gt;&gt; before do this. Without someone to tell them that this is wrong,
&gt;&gt;&gt; it's not obvious to them that they've made a mistake. I agree
&gt;&gt;&gt; with you that this is solved with good documentation.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; You guys are free to use my code (I don't mind the gnu license)
&gt;&gt;&gt; or of course implement from scratch as needed.
&gt;&gt;&gt;
&gt;&gt;&gt; Cheers!  For a valid copyright licensing agreement, you'll need
&gt;&gt;&gt; text something along the lines of:
&gt;&gt;&gt;
&gt;&gt;&gt; &quot;I agree to licence my contributions to the code in the file
&gt;&gt;&gt; <a  rel="nofollow" href="http://gna.org/support/download.php?file_id=20615">http://gna.org/support/download.php?file_id=20615</a> attached to
&gt;&gt;&gt; <a  rel="nofollow" href="http://gna.org/support/?3154">http://gna.org/support/?3154</a> under the GNU General Public
&gt;&gt;&gt; Licence, version three or higher.&quot;
&gt;&gt;&gt;
&gt;&gt;&gt; Feel free to copy and paste.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; No problem:
&gt;&gt;&gt;
&gt;&gt;&gt; &quot;I agree to licence my contributions to the code in the file
&gt;&gt;&gt; <a  rel="nofollow" href="http://gna.org/support/download.php?file_id=20615">http://gna.org/support/download.php?file_id=20615</a> attached to
&gt;&gt;&gt; <a  rel="nofollow" href="http://gna.org/support/?3154">http://gna.org/support/?3154</a> under the GNU General Public
&gt;&gt;&gt; Licence, version three or higher.&quot;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; I'd like to note again though that anyone using this formula to
&gt;&gt;&gt; fit data, though exact in the case of 2site exchange/inphase
&gt;&gt;&gt; magnetisation, evaluated at double floating point precision
&gt;&gt;&gt; should not be doing so! Neglecting scalar coupling/off
&gt;&gt;&gt; resonance/spin flips/the details of the specific pulse sequence
&gt;&gt;&gt; used will lead to avoidable foobars. I do see value in this, as
&gt;&gt;&gt; described in the paper, as being a feeder for initial conditions
&gt;&gt;&gt; for a more fancy implemenation. But beyond that, 'tis a bad idea.
&gt;&gt;&gt; Ideally this should appear in big red letters in your (very
&gt;&gt;&gt; nice!) gui when used.
&gt;&gt;&gt;
&gt;&gt;&gt; In relax, we allow the user to do anything though, via the
&gt;&gt;&gt; auto-analysis (hence the GUI), we direct the user along the best
&gt;&gt;&gt; path. The default is to use the CR72 and 'NS CPMG 2-site
&gt;&gt;&gt; expanded' models (Carver &amp; Richards, and Martin Tollinger and
&gt;&gt;&gt; Nikolai Skrynnikov's Maple expansion numeric model). We use the
&gt;&gt;&gt; CR72 model result as the starting point for optimisation of the
&gt;&gt;&gt; numeric models, allowing a huge speed up in the analysis.  The
&gt;&gt;&gt; user can also choose to not use the CR72 model results for the
&gt;&gt;&gt; final model selection - for determining dispersion curve
&gt;&gt;&gt; significance.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Here's the supp from my CPMG formula paper (attached). Look at
&gt;&gt;&gt; the last figure. Maybe relevant. Nikolai's algorithm blows up
&gt;&gt;&gt; sometimes when you evaluate to double float point precision (as
&gt;&gt;&gt; you will when you have a version in python or matlab). The
&gt;&gt;&gt; advantage of Nicolai's formula, or mine is that they won't fail
&gt;&gt;&gt; when Pb starts to creep above a per cent or so.
&gt;&gt;&gt;
&gt;&gt;&gt; Using the simple formula as a seed for the more complex on is a
&gt;&gt;&gt; good idea. The most recent versions of CATIA have something
&gt;&gt;&gt; analogous.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; As for the scalar coupling and spin flips, I am unaware of any
&gt;&gt;&gt; dispersion software that handles this.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; CATIA. Also cpmg_fig I believe. In fact, I think we may have had
&gt;&gt;&gt; this discussion before?
&gt;&gt;&gt;
&gt;&gt;&gt; <a  rel="nofollow" href="https://plus.google.com/s/cpmg%20glove">https://plus.google.com/s/cpmg%20glove</a>
&gt;&gt;&gt;
&gt;&gt;&gt; If you consider experimental validation a reasonable
&gt;&gt;&gt; justification for inclusion of the effects then you might find
&gt;&gt;&gt; this interesting:
&gt;&gt;&gt;
&gt;&gt;&gt; Spin flips are also quite relevant to NH/N (and in fact any spin
&gt;&gt;&gt; system). The supplementary section of Flemming and Pramodh go
&gt;&gt;&gt; into it here for NH/N
&gt;&gt;&gt; <a  rel="nofollow" href="http://www.pnas.org/content/105/33/11766.full.pdf">http://www.pnas.org/content/105/33/11766.full.pdf</a>
&gt;&gt;&gt;
&gt;&gt;&gt; And this: JACS (2010) 132: 10992-5 Figure 2: r2 0.97, rmsd  8.0
&gt;&gt;&gt; ppb (no spin flips) r2 0.99, rmsd  5.7 ppb (spin flips).
&gt;&gt;&gt;
&gt;&gt;&gt; The improvements are larger than experimental uncertainties.
&gt;&gt;&gt;
&gt;&gt;&gt; When we design these experiments and test them, we need to think
&gt;&gt;&gt; about the details. This is in part because Lewis beats us if we
&gt;&gt;&gt; don't. You can imagine that it comes as a surprise then when we
&gt;&gt;&gt; see people neglecting this. In short, the parameters you extract
&gt;&gt;&gt; from fitting data will suffer if the details are not there. In
&gt;&gt;&gt; the case of spin flips, the bigger the protein, the bigger the
&gt;&gt;&gt; effect. In your code, you have the opportunity to do things
&gt;&gt;&gt; properly. This leaves the details behind the scenes, so the naive
&gt;&gt;&gt; user doesn't have to think about them.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; And only Flemming's CATIA handles the CPMG off-resonance effects.
&gt;&gt;&gt; This is all explained in the relax manual.  I have asked the
&gt;&gt;&gt; authors of most dispersion software about this too, just to be
&gt;&gt;&gt; sure.  I don't know how much of an effect these have though.  But
&gt;&gt;&gt; one day they may be implemented in relax as well, and then the
&gt;&gt;&gt; user can perform the comparison themselves and see if all these
&gt;&gt;&gt; claims hold.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Myint, W. &amp; Ishima, R. Chemical exchange effects during
&gt;&gt;&gt; refocusing pulses in constant-time CPMG relaxation dispersion
&gt;&gt;&gt; experiments. J Biomol Nmr 45, 207-216, (2009).
&gt;&gt;&gt;
&gt;&gt;&gt; also:
&gt;&gt;&gt;
&gt;&gt;&gt; Bain, A. D., Kumar Anand, C. &amp; Nie, Z. Exact solution of the CPMG
&gt;&gt;&gt; pulse sequence with phase variation down the echo train:
&gt;&gt;&gt; application to R(2) measurements. J Magn Reson 209, 183- 194,
&gt;&gt;&gt; (2011).
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Or just simulate the off-resonance effects yourself to see what
&gt;&gt;&gt; happens. For NH you see the effects clearly for glycines and side
&gt;&gt;&gt; chains, if the carrier is in the centre around 120ppm. The
&gt;&gt;&gt; problem generally gets worse the higher field you go though this
&gt;&gt;&gt; of course depends when you bought your probe. You seem to imply
&gt;&gt;&gt; that these effects are almost mythical. I assure you that they
&gt;&gt;&gt; come out happily from the Bloch equations.
&gt;&gt;&gt;
&gt;&gt;&gt; Out of curiosity, from a philosophical perspective, I wonder if
&gt;&gt;&gt; you'd agree with this statement:
&gt;&gt;&gt;
&gt;&gt;&gt; &quot;the expected deviations due to approximations in a model should
&gt;&gt;&gt; be lower than the experimental errors on each datapoint.&quot;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Anyway, the warnings about analytic versers numeric are described
&gt;&gt;&gt; in the manual.  But your new model which adds a new factor to the
&gt;&gt;&gt; CR72 model, just as Dimitry Korzhnev's cpmg_fit software does for
&gt;&gt;&gt; his multiple quantum extension of the equation (from his 2004 and
&gt;&gt;&gt; 2005 papers), sounds like it removes the major differences
&gt;&gt;&gt; between the analytic and numeric results anyway.  In any case, I
&gt;&gt;&gt; have never seen an analytic result which is more than 10%
&gt;&gt;&gt; different in parameter values (kex specifically) compared to the
&gt;&gt;&gt; numeric results.  I am constantly on the lookout for a real or
&gt;&gt;&gt; synthetic data set to add to relax to prove this wrong though.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; I think there's a misunderstanding in what I mean by numerical
&gt;&gt;&gt; modelling. For the 2x2 matrix (basis: I+, ground and excited)
&gt;&gt;&gt; from the Bloch McConnell equation, you can manipulate this to get
&gt;&gt;&gt; an exact solution. Nikolai's approach does this, though his
&gt;&gt;&gt; algorithm can trip up sometimes for relatively exotic parameters
&gt;&gt;&gt; when you use doubles (see attached). My formula also does this. I
&gt;&gt;&gt; agree with you entirely that in this instance, numerically
&gt;&gt;&gt; solving the equations via many matrix exponentials is irrelevant
&gt;&gt;&gt; as you'll get an identical result to using a formula.
&gt;&gt;&gt;
&gt;&gt;&gt; My central thesis here though is that to get an accurate picture
&gt;&gt;&gt; of the experiment you need more physics. This means a bigger
&gt;&gt;&gt; basis. To have off resonance effects, you need a minimum 6x6
&gt;&gt;&gt; (Ix,Iy,Iz, ground and excited). To include scalar coupling and
&gt;&gt;&gt; off resonance, you need a 12x12 (Ix,Iy,Iz,IxHz,IyHz,IzHz, ground
&gt;&gt;&gt; and excited). Including R1 means another element and so on. The
&gt;&gt;&gt; methyl group, for example, means you need 24.
&gt;&gt;&gt;
&gt;&gt;&gt; So when we use the term numerical treatment, we generally mean a
&gt;&gt;&gt; calculation in a larger basis, as is necessary to take into
&gt;&gt;&gt; account the appropriate spin physics. There aren't formulas to
&gt;&gt;&gt; deal with these situations. In the 6x6 case for example, you need
&gt;&gt;&gt; 6 Eigenvalues, which is going to make life very rough for someone
&gt;&gt;&gt; brave enough to attempt a close form solution. The Palmer and
&gt;&gt;&gt; Trott trick used in 2002 for R1rho is a smart way of ducking the
&gt;&gt;&gt; problem of having 6 Eigenvalues, but for CPMG unfortunately you
&gt;&gt;&gt; need several Eigenvalues, not just the smallest.
&gt;&gt;&gt;
&gt;&gt;&gt; The 2x2 matrix that Nikolai and Martin, Carver Richard's and I
&gt;&gt;&gt; analyse does not include scalar coupling, as magnetisation is
&gt;&gt;&gt; held in-phase (in addition to neglecting all the other stuff
&gt;&gt;&gt; detailed above). So it is a good representation for describing
&gt;&gt;&gt; the continuous wave in-phase experiments introduced here
&gt;&gt;&gt; (neglecting relaxation effects and off resonance):
&gt;&gt;&gt;
&gt;&gt;&gt; Vallurupalli, P.; Hansen, D. F.; Stollar, E. J.; Meirovitch, E.;
&gt;&gt;&gt; Kay, L. E. Proc. Natl. Acad. Sci. U.S.A. 2007, 104, 18473–18477.
&gt;&gt;&gt;
&gt;&gt;&gt; and here:
&gt;&gt;&gt;
&gt;&gt;&gt; Baldwin, A. J.; Hansen, D. F.; Vallurupalli, P.; Kay, L. E. J.
&gt;&gt;&gt; Am. Chem. Soc. 2009, 131, 11939–48.
&gt;&gt;&gt;
&gt;&gt;&gt; But I think are the only two where this formula is directly
&gt;&gt;&gt; applicable. Only if you have explicit decoupling during the CPMG
&gt;&gt;&gt; period do you satisfy this condition. So this is not the case for
&gt;&gt;&gt; all other experiments and certainly not true for those used most
&gt;&gt;&gt; commonly.
&gt;&gt;&gt;
&gt;&gt;&gt; Anyhow. Best of luck with the software. I would recommend that
&gt;&gt;&gt; you consider implementing these effects and have a look at some
&gt;&gt;&gt; of the references. The physics are fairly complex, but the
&gt;&gt;&gt; implementations are relatively straightforward and amount to
&gt;&gt;&gt; taking many matrix exponentials. If you do this, I think you'd
&gt;&gt;&gt; end up with a solution that really is world-leading.
&gt;&gt;&gt;
&gt;&gt;&gt; As it stands though, in your position, I would worry that on
&gt;&gt;&gt; occasion, users will end up getting slightly wrong parameters out
&gt;&gt;&gt; from your code by neglecting these effects. If a user trusts this
&gt;&gt;&gt; code then, in turn, they might lead themselves to dodgy
&gt;&gt;&gt; biological conclusions. For the time being, I'll stick to forcing
&gt;&gt;&gt; my students to code things up themselves.
&gt;&gt;&gt;
&gt;&gt;&gt; All best wishes,
&gt;&gt;&gt;
&gt;&gt;&gt; Andy.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00000" href="msg00000.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Andrew Baldwin</li></ul></li>
<li><strong><a name="00010" href="msg00010.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Andrew Baldwin</li></ul></li>
<li><strong><a name="00063" href="msg00063.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00088" href="msg00088.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Andrew Baldwin</li></ul></li>
<li><strong><a name="00089" href="msg00089.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00098" href="msg00098.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Andrew Baldwin</li></ul></li>
<li><strong><a name="00113" href="msg00113.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00139" href="msg00139.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Andrew Baldwin</li></ul></li>
<li><strong><a name="00142" href="msg00142.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00143" href="msg00143.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Andrew Baldwin</li></ul></li>
<li><strong><a name="00146" href="msg00146.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00151" href="msg00151.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Andrew Baldwin</li></ul></li>
<li><strong><a name="00152" href="msg00152.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00191" href="msg00191.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Mon May 19 14:00:15 2014</div>  
</body>
</html>
