<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: r26065 &#45; /trunk/auto_analyses/relax_disp_repeat_cpmg.py -->
<!--X-From-R13: Febryf Szgrxæe Zvaarg &#60;gyvaargNaze&#45;erynk.pbz> -->
<!--X-Date: Fri, 26 Sep 2014 17:47:03 +0200 -->
<!--X-Message-Id: CA+CBx2N7FDYxP2EH9RWshyu_L88HY0zzLWu1c+PzEE=VhCARuw@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: E1XXXSm&#45;0000hy&#45;Ti@subversion.gna.org -->
<!--X-Reference: CAED9pY82QPsyJ_Mf0wt_jBjMVvcrMXmhH=H+6TKvP6hLxzwwCA@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: r26065 - /trunk/auto_analyses/relax_disp_repeat_cpmg.py -- September 26, 2014 - 17:47</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: r26065 - /trunk/auto_analyses/relax_disp_repeat_cpmg.py</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00176" class="tabs">Index by Date</a> | <a href="threads.html#00176" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00175.html">Date Prev</a>] [<a href="msg00177.html">Date Next</a>] [<a href="msg00175.html">Thread Prev</a>] [Thread Next]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Edward d'Auvergne&quot; &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Fri, 26 Sep 2014 17:46:10 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113; h=mime-version:sender:in-reply-to:references:from:date:message-id :subject:to:cc:content-type; bh=aiaeq3eTmO7jYVccwJ7RT1sNggV1DqR00xqxzuHsSk8=; b=oFUJEjmPzOy1Ry7cnhcDYV7Bl8lIAuAUrlrO5mRSdiW1qqtr9M0amOzZM4o5/WoDB6 F2ym2Q68a3OhceMJDxjUjlVBQhmMiEJDAfVFuyF5CIOwT6mXuQecTxMxblId5/CaAdzW qNgz7qsU4W/tULrE2W2X1m0qfdwYGQC34t1nEoBC9iDvjnRJqoRbnrNgVkL1+Wfs30uR HtI3sq8tdYtuqYgcakcK6IbtqqnbHHWbDi3xsJTu0TZ2weh3U27KTy3aDTUNMSU1gm57 0aOHLmXB7PVztDR++gyLnX0tPsFOZnp+2zDm0Ky8BZMb9dgUJ8yN1TV9QZ1LG4z0z3lg r8aA==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;CA+CBx2N7FDYxP2EH9RWshyu_L88HY0zzLWu1c+PzEE=VhCARuw@mail.gmail.com&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;E1XXXSm-0000hy-Ti@subversion.gna.org&gt; &lt;CAED9pY82QPsyJ_Mf0wt_jBjMVvcrMXmhH=H+6TKvP6hLxzwwCA@mail.gmail.com&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Troels Emtekær Linnet</strong> on September 26, 2014 - 17:47:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi Edward.

As you may have noticed, 1/3 of the code is iterating over the same theme.

The best thing would be to device a custom iterator function.
Like pymol: <a  rel="nofollow" href="http://www.pymolwiki.org/index.php/Iterate">http://www.pymolwiki.org/index.php/Iterate</a>

Then a general write statistics &quot;to file&quot;, and a new grace plot function,
to plot from these files.

But I don't have time to look into this at the moment.


Best
Troels



2014-09-26 17:40 GMT+02:00 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:

</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Troels,

To help future users of your analysis, to better document it, and to
help future developers maintain it, you should try to include full
docstrings including epydoc documentation of all arguments for all the
methods of your auto-analysis.

Cheers,

Edward


On 26 September 2014 17:29,  &lt;tlinnet@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Author: tlinnet
Date: Fri Sep 26 17:29:39 2014
New Revision: 26065

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=26065&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=26065&amp;view=rev</a>
Log:
Implemented getting the statistics for parameters and comparing to init
</pre></blockquote><pre style="margin: 0em;">NI.
</pre><blockquote class="blockquote"><pre style="margin: 0em;">

Task #7826 (<a  rel="nofollow" href="https://web.archive.org/web/https://gna.org/task/index.php?7826">https://gna.org/task/index.php?7826</a>): Write an python class
</pre></blockquote><pre style="margin: 0em;">for the repeated analysis of dispersion data.
</pre><blockquote class="blockquote"><pre style="margin: 0em;">

Modified:
    trunk/auto_analyses/relax_disp_repeat_cpmg.py

Modified: trunk/auto_analyses/relax_disp_repeat_cpmg.py
URL:
</pre></blockquote><pre style="margin: 0em;"><a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/auto_analyses/relax_disp_repeat_cpmg.py?rev=26065&amp;r1=26064&amp;r2=26065&amp;view=diff">http://svn.gna.org/viewcvs/relax/trunk/auto_analyses/relax_disp_repeat_cpmg.py?rev=26065&amp;r1=26064&amp;r2=26065&amp;view=diff</a>
</pre><blockquote class="blockquote"><pre style="margin: 0em;">

</pre></blockquote><pre style="margin: 0em;">==============================================================================
</pre><blockquote class="blockquote"><pre style="margin: 0em;">--- trunk/auto_analyses/relax_disp_repeat_cpmg.py       (original)
+++ trunk/auto_analyses/relax_disp_repeat_cpmg.py       Fri Sep 26
</pre></blockquote><pre style="margin: 0em;">17:29:39 2014
</pre><blockquote class="blockquote"><pre style="margin: 0em;">@@ -1943,6 +1943,94 @@
             plt.show()


+    def get_min_stat_dic(self, list_r2eff_dics=None,
</pre></blockquote><pre style="margin: 0em;">list_glob_ini=None):
</pre><blockquote class="blockquote"><pre style="margin: 0em;">+
+        # Loop over the result dictionaries:
+        res_dic = {}
+        for i, min_dic in enumerate(list_r2eff_dics):
+            # Let the reference dic be initial dic
+            min_dic_ref = list_r2eff_dics[0]
+            method_ref = min_dic_ref['method']
+            res_dic['method_ref'] = method_ref
+            glob_ini_ref = list_glob_ini[0]
+            res_dic['glob_ini_ref'] = str(glob_ini_ref)
+            selection = min_dic_ref['selection']
+            res_dic['selection'] = selection
+            params_list =
</pre></blockquote><pre style="margin: 0em;">min_dic_ref[str(glob_ini_ref)]['params']['params_list']
</pre><blockquote class="blockquote"><pre style="margin: 0em;">+            res_dic['params_list'] = params_list
+
+            # Loop over params
+            for j, param in enumerate(params_list):
+                res_dic[param] = {}
+
+                # Let the reference param array be the initial glob.
+                param_arr_ref =
</pre></blockquote><pre style="margin: 0em;">min_dic_ref[str(glob_ini_ref)]['params'][param]
</pre><blockquote class="blockquote"><pre style="margin: 0em;">+                res_dic[param]['param_arr_ref'] = param_arr_ref
+
+                # Get the current method
+                method_cur = min_dic['method']
+
+                res_dic[param][method_cur] = {}
+                res_dic[param][method_cur]['method'] = method_cur
+                res_dic[param][method_cur]['sampling_sparseness'] = []
+                res_dic[param][method_cur]['glob_ini'] = []
+
+                # Other stats.
+                res_dic[param][method_cur]['r_xy'] = []
+                res_dic[param][method_cur]['a'] = []
+
+                # Now loop over glob_ini:
+                for glob_ini in list_glob_ini:
+                    # Get the array, if it exists.
+                    if str(glob_ini) not in min_dic:
+                        continue
+
+                    # Get the data.
+                    param_arr = min_dic[str(glob_ini)]['params'][param]
+
+                    # This require that all number of points are equal.
+                    # If they are not of same length, then dont even
</pre></blockquote><pre style="margin: 0em;">bother to continue.
</pre><blockquote class="blockquote"><pre style="margin: 0em;">+                    if len(param_arr) != len(param_arr_ref):
+                        continue
+
+                    # Store x
+                    sampling_sparseness = float(glob_ini) /
</pre></blockquote><pre style="margin: 0em;">float(glob_ini_ref) * 100.
</pre><blockquote class="blockquote"><pre style="margin: 0em;">+
</pre></blockquote><pre style="margin: 0em;">res_dic[param][method_cur]['sampling_sparseness'].append(sampling_sparseness)
</pre><blockquote class="blockquote"><pre style="margin: 0em;">+
</pre></blockquote><pre style="margin: 0em;">res_dic[param][method_cur]['glob_ini'].append(glob_ini)
</pre><blockquote class="blockquote"><pre style="margin: 0em;">+
+                    # Store to result dic.
+                    res_dic[param][method_cur][str(glob_ini)] = {}
+
</pre></blockquote><pre style="margin: 0em;">res_dic[param][method_cur][str(glob_ini)]['sampling_sparseness'] =
sampling_sparseness
</pre><blockquote class="blockquote"><pre style="margin: 0em;">+
</pre></blockquote><pre style="margin: 0em;">res_dic[param][method_cur][str(glob_ini)]['param_arr'] = param_arr
</pre><blockquote class="blockquote"><pre style="margin: 0em;">+
+                    # With intercept at axis.
+                    # Calculate sample correlation coefficient, measure
</pre></blockquote><pre style="margin: 0em;">of goodness-of-fit of linear regression
</pre><blockquote class="blockquote"><pre style="margin: 0em;">+                    x = param_arr_ref
+                    x_m = mean(x)
+                    y = param_arr
+                    y_m = mean(y)
+
+                    # Without intercept.
+                    a = sum(x*y) / sum(x**2)
+                    r_xy = sum(x*y) / sqrt(sum(x**2) * sum(y**2))
+
+                    print(param, method_ref, method_cur,
</pre></blockquote><pre style="margin: 0em;">sampling_sparseness, glob_ini, r_xy**2, a)
</pre><blockquote class="blockquote"><pre style="margin: 0em;">+
+                    # Store to result dic.
+                    res_dic[param][method_cur][str(glob_ini)]['r_xy'] =
</pre></blockquote><pre style="margin: 0em;">r_xy
</pre><blockquote class="blockquote"><pre style="margin: 0em;">+                    res_dic[param][method_cur]['r_xy'].append(r_xy)
+                    res_dic[param][method_cur][str(glob_ini)]['a'] = a
+                    res_dic[param][method_cur]['a'].append(a)
+
+                res_dic[param][method_cur]['sampling_sparseness'] =
</pre></blockquote><pre style="margin: 0em;">asarray(res_dic[param][method_cur]['sampling_sparseness'])
</pre><blockquote class="blockquote"><pre style="margin: 0em;">+                res_dic[param][method_cur]['glob_ini'] =
</pre></blockquote><pre style="margin: 0em;">asarray(res_dic[param][method_cur]['glob_ini'])
</pre><blockquote class="blockquote"><pre style="margin: 0em;">+
+                res_dic[param][method_cur]['r_xy'] =
</pre></blockquote><pre style="margin: 0em;">asarray(res_dic[param][method_cur]['r_xy'])
</pre><blockquote class="blockquote"><pre style="margin: 0em;">+                res_dic[param][method_cur]['a'] =
</pre></blockquote><pre style="margin: 0em;">asarray(res_dic[param][method_cur]['a'])
</pre><blockquote class="blockquote"><pre style="margin: 0em;">+
+        return res_dic
+
+
     def interpreter_start(self):
         # Load the interpreter.
         self.interpreter = Interpreter(show_script=False,
</pre></blockquote><pre style="margin: 0em;">raise_relax_error=True)
</pre><blockquote class="blockquote"><pre style="margin: 0em;">


_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-commits mailing list
relax-commits@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="http://www.nmr-relax.com/mail.gna.org/listinfo/relax-commits">https://mail.gna.org/listinfo/relax-commits</a>
</pre></blockquote><pre style="margin: 0em;">

_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-devel mailing list
relax-devel@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="http://www.nmr-relax.com/mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a>

</pre></blockquote><pre style="margin: 0em;">

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00175" href="msg00175.html">Re: r26065 - /trunk/auto_analyses/relax_disp_repeat_cpmg.py</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Fri Sep 26 19:00:19 2014</div>  
</body>
</html>
