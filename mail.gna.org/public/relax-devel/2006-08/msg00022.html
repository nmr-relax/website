<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [bug #6503] Uncaught nan in xh_vect -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneq.qnhiretarNtznvy.pbz> -->
<!--X-Date: Mon, 07 Aug 2006 11:41:09 +0200 -->
<!--X-Message-Id: 7f080ed10608070240j43e47b3cif1b60924755c4fa9@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20060802&#45;104941.sv4125.3051@gna.org -->
<!--X-Reference: 7f080ed10608020558o47fd0260s9579f663147ab84@mail.gmail.com -->
<!--X-Reference: 1154597081.28764.140.camel@fbsdpcu021 -->
<!--X-Reference: 7f080ed10608030650t7896164mbcfa499f1987270a@mail.gmail.com -->
<!--X-Reference: 1154620634.28764.190.camel@fbsdpcu021 -->
<!--X-Reference: 7f080ed10608040708k4738dd5cjb41e9056acd88902@mail.gmail.com -->
<!--X-Reference: 1154706350.28764.284.camel@fbsdpcu021 -->
<!--X-Reference: 44D37486.6060003@bmb.leeds.ac.uk -->
<!--X-Reference: 7f080ed10608040954n4971257diabac2c1b51f17790@mail.gmail.com -->
<!--X-Reference: 44D6F769.10204@bmb.leeds.ac.uk -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [bug #6503] Uncaught nan in xh_vect -- August 07, 2006 - 11:41</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: [bug #6503] Uncaught nan in xh_vect</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00022" class="tabs">Index by Date</a> | <a href="threads.html#00022" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00021.html">Date Prev</a>] [<a href="msg00023.html">Date Next</a>] [<a href="msg00020.html">Thread Prev</a>] [<a href="msg00023.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Gary S. Thompson&quot; &lt;garyt@xxxxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Mon, 7 Aug 2006 19:40:33 +1000</li>
<li class="menuitem">
<em>Cc</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00022.html">7f080ed10608070240j43e47b3cif1b60924755c4fa9@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;20060802-104941.sv4125.3051@gna.org&gt;	&lt;<a href="msg00000.html">7f080ed10608020558o47fd0260s9579f663147ab84@mail.gmail.com</a>&gt;	&lt;<a href="msg00001.html">1154597081.28764.140.camel@fbsdpcu021</a>&gt;	&lt;<a href="msg00002.html">7f080ed10608030650t7896164mbcfa499f1987270a@mail.gmail.com</a>&gt;	&lt;<a href="msg00003.html">1154620634.28764.190.camel@fbsdpcu021</a>&gt;	&lt;<a href="msg00007.html">7f080ed10608040708k4738dd5cjb41e9056acd88902@mail.gmail.com</a>&gt;	&lt;<a href="msg00009.html">1154706350.28764.284.camel@fbsdpcu021</a>&gt;	&lt;<a href="msg00013.html">44D37486.6060003@bmb.leeds.ac.uk</a>&gt;	&lt;<a href="msg00016.html">7f080ed10608040954n4971257diabac2c1b51f17790@mail.gmail.com</a>&gt;	&lt;<a href="msg00020.html">44D6F769.10204@bmb.leeds.ac.uk</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on August 07, 2006 - 11:41:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<tt>On 8/7/06, Gary S. Thompson &lt;garyt@xxxxxxxxxxxxxxx&gt; wrote:
</tt><blockquote class="blockquote"><pre style="margin: 0em;">Edward d'Auvergne wrote:</pre><br>
<pre style="margin: 0em;">&gt;&gt; It ought to be said that nan and inf etc have very clearly defined bit
&gt;&gt; patterns in memory that are defined by an ieee754 cf
&gt;&gt; <a  href="http://steve.hollasch.net/cgindex/coding/ieeefloat.html">http://steve.hollasch.net/cgindex/coding/ieeefloat.html</a> and
&gt;&gt; <a  href="http://www.psc.edu/general/software/packages/ieee/ieee.html">http://www.psc.edu/general/software/packages/ieee/ieee.html</a>. Thus its a
&gt;&gt; question of python/compilers not putting nan in the right place and not
&gt;&gt; using comaprisons etc properly when nans are are present. It should
&gt;&gt; always be possible to detect if a nan is present by the bit pattern in
&gt;&gt; memory (and this is the way fpconst.py does it). It is of course
&gt;&gt; possible to test if nans are supported correctly on a paricular
&gt;&gt; architecture and compiler by comparisons etc and if not warnings etc
&gt;&gt; could be raised or alternative code executed)
&gt;
&gt;
&gt;&gt; another thing to say is that though fpconst.py  is gpl incompatible due
&gt;&gt; to some arcana about /patent termination cases
&gt;&gt; (<a  href="http://en.wikipedia.org/wiki/Apache_License">http://en.wikipedia.org/wiki/Apache_License</a>)/ in the apache license,
&gt;&gt; due to they way it works should be relativley easy to cook up our own
&gt;&gt; version which would bullet proof and low maintenance in the same way as
&gt;&gt; fpconst.py is... and also quite legal
&gt;
&gt;
&gt; Could the fpconst.py file be legally included in a relax distribution?</pre><br>
<pre style="margin: 0em;">I am not a lawyer and the waters eem to be muddy...</pre><br>
<pre style="margin: 0em;"><br>      Is the Apache license compatible with the GPL (GNU Public License)?</pre><br>
<pre style="margin: 0em;">It is the unofficial position of The Apache Software Foundation that the
Apache license *is* compatible with the GPL. However, the Free Software
Foundation holds a different position, although we have not been able to
get them to give us categorical answers to our queries asking for
details on just what aspects they consider incompatible.
</pre></blockquote><pre style="margin: 0em;"><br>Did you contact the FSF about the issue?</pre><br>
<blockquote class="blockquote"><pre style="margin: 0em;">Whether to mix software covered under these two different licenses
*must* be a determination made by those attempting such a synthesis.
</pre></blockquote><pre style="margin: 0em;"><br>According to the FSF list of licences
(<a  href="http://www.gnu.org/philosophy/license-list.html">http://www.gnu.org/philosophy/license-list.html</a>), all of the Apache
licences are GPL incompatible.  For version 2 of the licence they say:</pre><br>
<pre style="margin: 0em;">This is a free software license but it is incompatible with the GPL.
The Apache Software License is incompatible with the GPL because it
has a specific requirement that is not in the GPL: it has certain
patent termination cases that the GPL does not require. (We don't
think those patent termination cases are inherently a bad idea, but
nonetheless they are incompatible with the GNU GPL.)</pre><br>
<pre style="margin: 0em;">After looking at the GPL FAQ and thinking about it for a while, I
don't believe the file can be put into the relax distribution.  From
the link <a  href="http://www.gnu.org/licenses/gpl-faq.html#MereAggregation">http://www.gnu.org/licenses/gpl-faq.html#MereAggregation</a> I
would classify the co-distribution of relax with fpconst.py as an
imported module to be a single program rather than an aggregation of
programs.  Because of the licence incompatibility, the link
<a  href="http://www.gnu.org/licenses/gpl-faq.html#GPLIncompatibleAlone">http://www.gnu.org/licenses/gpl-faq.html#GPLIncompatibleAlone</a> explains
how it is not legal to co-distribute.</pre><br>
<blockquote class="blockquote"><pre style="margin: 0em;">however I don''t see that ther is a problem if the file is in a separate
module... plenty of people install apache based software and gpl
software in their python machines. At worst all that would happen is
someone would complain and we would have to write out own...
( I reckon I could do the whole thing in a few hours at most including
some unit tests)
</pre></blockquote><pre style="margin: 0em;"><br>Because what I wrote above, it would probably have to be listed as a
dependency.  However I don't really like that idea as dependencies are
a pain.  Do you have the link to it's homepage?  All the links I've
tried that look like it would be its homepage (for example
<a  href="http://www.warnes.net/rwndown">http://www.warnes.net/rwndown</a>) are still down.  Having it in-built
into relax would be better.</pre><br>
<pre style="margin: 0em;">However I still question whether the floating point value of NaN
actually needs to be caught at all - it would be useful, but is
unnecessary.  It's a rare occurrence to begin with and I can easily
modify the optimisation component of relax to break the infinite
loops.  Therefore does anything else need to be done?  It will be
glaringly obvious in the final results file if NaNs get through the
analysis.  And if there is an issue in relax's handling of NaN then
that should be classified as a relax bug.</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">&gt; I can't reach it's homepage so I can't read the licence.  Do you
&gt; think it is cross platform or is it dependent upon the underlying C
&gt; libraries?</pre><br>
<pre style="margin: 0em;"><br>It is completley cross platform as far as I can see. If you ran it on a
non ieee platform you might get some weird edge cases but this would be
for somewhat bizarra architectures these days (do you want to run it on
a gray or a vax?)
</pre></blockquote><pre style="margin: 0em;"><br>Who knows what end users will run it on?  Someone may still be using a
vax ;)  Not very important though and can be handled once a problem
arises - assuming that catching the NaN is important.</pre><br>
<blockquote class="blockquote"><pre style="margin: 0em;">&gt; Importantly does the value of NaN actually need to be
&gt; caught?  Prevention could be used to eliminate most NaNs and the cure
&gt; could be to have iteration limits.
&gt;
&gt; The limit on the iterations for the backtracking line search will
&gt; probably not be too much of an issue.  The bigger issue is that the
&gt; convergence test:
&gt;    fk_new - fk &lt;= f_tol,
&gt; when fk_new and fk are both chi-squared values of NaN, never evaluates
&gt; true.  Then the number of iterations of the optimisation algorithm
&gt; will hence be the most expensive factor rather than the backtracking
&gt; subalgorithm.
&gt;
If this will get rid of it, then thats great can of worms canned (but
will it stay that way or will unexpected things crawl out of the
woodwork)?? Also don't we want nans to propgate sometimes so that peple
know there has bee a problem, rather than have a warning burried in
miles of output
</pre></blockquote><pre style="margin: 0em;"><br>It can't be removed - this is a test fundamental to all optimisation
algorithms I know of.  Its removal will result in infinite
optimisation loops.</pre><br>
<pre style="margin: 0em;">NaN should propagate - however I do see one point at which they will
disappear and that is during AIC model selection.  The AIC value will
be NaN (NaN + 2k = NaN) and any model with a non-NaN AIC value will be
selected.  Unless of course all model-free models for that residue are
affected.  Yet if they do propagate the results for that residue will
make no sense.  That should be an indication to the end user that
there is a problem and that they should look at the final results file
in detail - none of the logs or intermediate results files need to be
initially examined to identify that there is a problem.  If, however,
we can prevent users from encountering this problem as much as
possible, while making it possible to continue running if it does
occur, then NaNs shouldn't be a problem in relax.</pre><br>
<pre style="margin: 0em;">Edward</pre><br>
<br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00023" href="msg00023.html">Re: [bug #6503] Uncaught nan in xh_vect</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00000" href="msg00000.html">Re: [bug #6503] Uncaught nan in xh_vect</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00001" href="msg00001.html">Re: [bug #6503] Uncaught nan in xh_vect</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00002" href="msg00002.html">Re: [bug #6503] Uncaught nan in xh_vect</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00003" href="msg00003.html">Re: [bug #6503] Uncaught nan in xh_vect</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00007" href="msg00007.html">Re: [bug #6503] Uncaught nan in xh_vect</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00009" href="msg00009.html">Re: [bug #6503] Uncaught nan in xh_vect</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00013" href="msg00013.html">Re: [bug #6503] Uncaught nan in xh_vect</a></strong>
<ul><li><em>From:</em> Gary S. Thompson</li></ul></li>
<li><strong><a name="00016" href="msg00016.html">Re: [bug #6503] Uncaught nan in xh_vect</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00020" href="msg00020.html">Re: [bug #6503] Uncaught nan in xh_vect</a></strong>
<ul><li><em>From:</em> Gary S. Thompson</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Tue Aug 08 11:20:31 2006</div>  
</body>
</html>
