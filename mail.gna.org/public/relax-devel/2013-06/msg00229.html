<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: [sr #3043] Support for NMRPipe seriesTab format *.ser -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Wed, 26 Jun 2013 17:01:02 +0200 -->
<!--X-Message-Id: CAED9pY9PdQ6Su3=H+F00yjDha8Dy3fAs_eJc2R=K6GapQwJ1NA@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20130618&#45;111658.sv20529.92371@gna.org -->
<!--X-Reference: 20130621&#45;104836.sv20529.74597@gna.org -->
<!--X-Reference: 20130621&#45;110326.sv20529.53221@gna.org -->
<!--X-Reference: 20130621&#45;125601.sv20529.4232@gna.org -->
<!--X-Reference: 20130621&#45;133538.sv20529.35811@gna.org -->
<!--X-Reference: 20130621&#45;133624.sv20529.28609@gna.org -->
<!--X-Reference: 20130621&#45;134734.sv20529.63622@gna.org -->
<!--X-Reference: 20130621&#45;135732.sv20529.11927@gna.org -->
<!--X-Reference: 20130621&#45;143814.sv20529.47445@gna.org -->
<!--X-Reference: 20130621&#45;144033.sv2782.32592@gna.org -->
<!--X-Reference: 20130621&#45;144059.sv2782.9513@gna.org -->
<!--X-Reference: 20130621&#45;152621.sv20529.10944@gna.org -->
<!--X-Reference: 20130621&#45;152918.sv2782.33904@gna.org -->
<!--X-Reference: 20130621&#45;155028.sv20529.59982@gna.org -->
<!--X-Reference: 20130621&#45;155445.sv20529.38949@gna.org -->
<!--X-Reference: 20130621&#45;160244.sv20529.97199@gna.org -->
<!--X-Reference: 20130621&#45;161055.sv20529.98641@gna.org -->
<!--X-Reference: 20130621&#45;161450.sv20529.54611@gna.org -->
<!--X-Reference: 20130621&#45;173006.sv20529.34821@gna.org -->
<!--X-Reference: 20130621&#45;174335.sv20529.95831@gna.org -->
<!--X-Reference: 20130621&#45;174724.sv20529.63909@gna.org -->
<!--X-Reference: 20130621&#45;175836.sv20529.88391@gna.org -->
<!--X-Reference: 20130621&#45;180416.sv20529.2309@gna.org -->
<!--X-Reference: 20130624&#45;094924.sv20529.63314@gna.org -->
<!--X-Reference: 20130624&#45;104521.sv20529.19556@gna.org -->
<!--X-Reference: 20130624&#45;124624.sv20529.87885@gna.org -->
<!--X-Reference: 20130624&#45;142927.sv20529.87827@gna.org -->
<!--X-Reference: 20130625&#45;170643.sv20529.66724@gna.org -->
<!--X-Reference: CAED9pY_o=Wo3&#45;iGC5QX40qD3_WUw17Q6xQN=AkmYq6irvfCA0A@mail.gmail.com -->
<!--X-Reference: CA+CBx2NWFJoNLptjgsVs23O=KWgATC2LGsD4Pfvq=K6Hsfks2w@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [sr #3043] Support for NMRPipe seriesTab format *.ser -- June 26, 2013 - 17:01</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: [sr #3043] Support for NMRPipe seriesTab format *.ser</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00229" class="tabs">Index by Date</a> | <a href="threads.html#00229" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00228.html">Date Prev</a>] [<a href="msg00230.html">Date Next</a>] [<a href="msg00228.html">Thread Prev</a>] [<a href="msg00227.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Troels Emtek√¶r Linnet &lt;tlinnet@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Wed, 26 Jun 2013 17:00:20 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113;	h=mime-version:sender:in-reply-to:references:date	:x-google-sender-auth:message-id:subject:from:to:cc:content-type	:content-transfer-encoding;	bh=qu9Dp8Y8NryzSJnb6ZRiolgVYE5f0bzBJXHXQdZAVX4=;	b=gtN1yo72rFwZPLNU+9KMk39LG9TiIVz0puuxr0z55DhCDHLg+K61yuzEc947Sn1csN	PhwWFzL/4g9wx5nZCA1Ex6xVvzoYAgbpeInfzCj/xrbfYsIqHxcAGXlRadFO0s2j1YyM	GQDrNw5P6ma+q+RTLItorujOFlL/dQbInjVfHSbQvPXf0s0UsKlk9BkbQeEX+Pg4QCF5	PJPD5A6pSifJVHFhfvsUx8uKowBZng2LczkTnJxwwAacbfuK+JBKjotK6LWeA+CEzlt+	ixgxVtlHJhY62aB1QcqG7rsIABNKoZ0FTX17YhpeOXD6GNUDWJ/leZlp6OdqyhFt8+LL	O9Ig==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00229.html">CAED9pY9PdQ6Su3=H+F00yjDha8Dy3fAs_eJc2R=K6GapQwJ1NA@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;20130618-111658.sv20529.92371@xxxxxxx&gt;	&lt;20130621-104836.sv20529.74597@xxxxxxx&gt;	&lt;20130621-110326.sv20529.53221@xxxxxxx&gt;	&lt;20130621-125601.sv20529.4232@xxxxxxx&gt;	&lt;20130621-133538.sv20529.35811@xxxxxxx&gt;	&lt;20130621-133624.sv20529.28609@xxxxxxx&gt;	&lt;20130621-134734.sv20529.63622@xxxxxxx&gt;	&lt;20130621-135732.sv20529.11927@xxxxxxx&gt;	&lt;20130621-143814.sv20529.47445@xxxxxxx&gt;	&lt;20130621-144033.sv2782.32592@xxxxxxx&gt;	&lt;20130621-144059.sv2782.9513@xxxxxxx&gt;	&lt;20130621-152621.sv20529.10944@xxxxxxx&gt;	&lt;20130621-152918.sv2782.33904@xxxxxxx&gt;	&lt;20130621-155028.sv20529.59982@xxxxxxx&gt;	&lt;20130621-155445.sv20529.38949@xxxxxxx&gt;	&lt;20130621-160244.sv20529.97199@xxxxxxx&gt;	&lt;20130621-161055.sv20529.98641@xxxxxxx&gt;	&lt;20130621-161450.sv20529.54611@xxxxxxx&gt;	&lt;20130621-173006.sv20529.34821@xxxxxxx&gt;	&lt;20130621-174335.sv20529.95831@xxxxxxx&gt;	&lt;20130621-174724.sv20529.63909@xxxxxxx&gt;	&lt;20130621-175836.sv20529.88391@xxxxxxx&gt;	&lt;20130621-180416.sv20529.2309@xxxxxxx&gt;	&lt;20130624-094924.sv20529.63314@xxxxxxx&gt;	&lt;20130624-104521.sv20529.19556@xxxxxxx&gt;	&lt;20130624-124624.sv20529.87885@xxxxxxx&gt;	&lt;20130624-142927.sv20529.87827@xxxxxxx&gt;	&lt;20130625-170643.sv20529.66724@xxxxxxx&gt;	&lt;CAED9pY_o=Wo3-iGC5QX40qD3_WUw17Q6xQN=AkmYq6irvfCA0A@xxxxxxxxxxxxxx&gt;	&lt;CA+CBx2NWFJoNLptjgsVs23O=KWgATC2LGsD4Pfvq=K6Hsfks2w@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on June 26, 2013 - 17:01:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi,

This looks good.  Maybe I will just apply your patches one by one as
each looks reasonable.  I can apply them on my system using syntax
such as:

$ patch -p1 &lt; 0001-Imported-the-expected-used-modules-in-lib.software.n.patch

Before I apply them (which I cannot do until I return from holidays in
the second week of July), I have a number of comments:


patch 1 - No problems there, except for the missing '.' at the end of
the &quot;Progress sr #3043: ...&quot; line in the commit message.


patch 2 - The commit message should say rather than adding a
docstring, that you added a stub of a function with docstring.  The
function that has no contents would be called a stub.  The rest cannot
go too wrong ;)


patch 3 - For this one I have a few suggestions:

1)  I would like to suggest an improvement to future proof this code -
i.e. if the NMRPipe format slightly changes, then relax might still
work.  In this patch you assume fixed positions for the MODELINE and
VARSLINE.  But from the
test_suite/shared_data/peak_lists/seriesTab.ser file, it looks like
that these assumptions might be dangerous.  For example the line with
the 'Mode...' text is one of many REMARK lines.  The line starting
with the VARS text is after a number of REMARK lines.  My worry is
that it would be easy for nmrPipe to add more REMARK lines.  Therefore
I would suggest that we assume that there may be more than 14 header
lines.  I think this would be a fair assumption.  Then most of the
contents of this patch would be inside a loop over the file data.  As
you loop over the lines, you search for 'Mode:' and 'VARS', and then
store the data when it is encountered.  To find the number of header
lines, have a counter for each line in the loop, then maybe if
'NULLSTRING' is searched for and then add 1 for the empty line (or
search for the first data line starting with '1' and subtract 1) and
use the 'break' statement to end the loop.  Such an approach would be
much more robust for future nmrPipe versions, and maybe also the
current version if a user does something slightly differently.

2)  All variables should be in lower case to match the relax coding
style.  Exceptions do exist, for example for parameters such as 'pA',
but this is rare.

3)  There are two empty lines at one point.

4)  The third line of the commit message is unnecessary as all this
information is already in the header line.


patch 4 - It is best to avoid the re.match() function, and it appears
to unused in all the patches anyway.  The last line of the commit
message could be merged into the header line.  There's no need for 3
lines of commit messages for such a simple change.


patch 5 - Again a number of points:

1)  For Python 3, there should be spaces after all commas (at least
the 2to3 Python 2 to 3 conversion program enforces this, so it must be
important).

2)  There are still references to Sparky present.

3)  For the text &quot;The peak intensity value &quot; + repr(intensity) + &quot;
from the line &quot; + repr(line) + &quot; is invalid.&quot;, it is better to use the
string formatting with %s.  relax is slowly migrating to this format
throughout, as it is faster, easier to read and easier for Python 3
(in some cases).

4)  Again variables should be lower case (ASS_i and Z_A).

5)  It is best to avoid highly Pythonic constructs such as
enumerate(), filter, list construction using with mapping, zipping,
for loops, etc.  I.e. very Python specific ways of doing things.
Avoiding this future-proofs the code.  It is also easier on new relax
developers who do not know Python.  Keeping the constructs simple is a
good thing.  Nevertheless if the code is thoroughly checked using the
test suite, a little bit of Pythonicness is ok.

Cheers,

Edward






On 26 June 2013 15:25, Troels Emtek√¶r Linnet &lt;tlinnet@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Edward.

Just see this as a test round. :-)

Most important is, that you can read these patch files.
In each patch, is also stored the commit message, which I
hope should be auto-read as well.

I covered how it is possible to change the commit message.
I haven't tested yet, how it is possible to change the code commit.

I guess that you rebase and amend commit. (Another option than &quot;r&quot;)
git rebase -i HEAD~2


The most problematic thing for me, was the understanding of the need to
create a branch from master. Add files. Create a new branch from the
just created branch.
Then change files.
Then do a &quot;git format-patch PREVBRANCH&quot;

It's all about creating a lot of small branches, for each development step.
Merging, deleting them, comparing between them.

Best
Troels Emtek√¶r Linnet


2013/6/26 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Troels,

Would you be able to upload the patch either as the five original
files or at least in a different format.  On the Linux system I am
using, I am currently unable to open RAR files.  If you could use zip
or tar.gz, that would be much better.  On another note, why are there
5 patches and one commit message?  The implementation of the function
in lib.software.nmrpipe should only require one patch.  Once I can
read them, I'll start with the feedback.  I may be able to do this
tomorrow before I go on holidays next week.  Also, I was wondering if
you know how to use git to change the contents of a commit, as that
should be possible?

Cheers,

Edward


On 25 June 2013 19:06, Troels E. Linnet
&lt;NO-REPLY.INVALID-ADDRESS@xxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Follow-up Comment #33, sr #3043 (project relax):

Completed NMRPipe SeriesTab reader for assignment according to SPARKY 
format.

Progress sr #3043: (<a  rel="nofollow" href="https://gna.org/support/index.php?3043">https://gna.org/support/index.php?3043</a>) Support for
NMRPipe seriesTab format *.ser

Multiple spectra and intensity reading for NMRPipe SeriesTab formatted 
file
completed.

-----------
Zip file with 5 patches added

Completed according to:
<a  rel="nofollow" href="http://nmr-relax.kimlinnet.dk/index.php?title=Git_asynchronous_development#Complete_test_suite">http://nmr-relax.kimlinnet.dk/index.php?title=Git_asynchronous_development#Complete_test_suite</a>

Patches should be applied with:
patch -p1 -i 
0001-Imported-the-expected-used-modules-in-lib.software.n.patch

patch -p1 -i 
0002-Imported-the-expected-used-modules-in-lib.software.n.patch



(file #18166)
    _______________________________________________________

Additional Item Attachment:

File name: seriestab_patches_v1.rar       Size:4 KB


    _______________________________________________________

Reply to this item at:

  &lt;<a  rel="nofollow" href="http://gna.org/support/?3043">http://gna.org/support/?3043</a>&gt;

_______________________________________________
  Message sent via/by Gna!
  <a  rel="nofollow" href="http://gna.org/">http://gna.org/</a>


_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-devel mailing list
relax-devel@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="http://www.nmr-relax.com/mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a>
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00072" href="msg00072.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00156" href="msg00156.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00157" href="msg00157.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00159" href="msg00159.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00160" href="msg00160.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00161" href="msg00161.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00162" href="msg00162.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00163" href="msg00163.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00166" href="msg00166.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00167" href="msg00167.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Edward d Auvergne</li></ul></li>
<li><strong><a name="00168" href="msg00168.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Edward d Auvergne</li></ul></li>
<li><strong><a name="00178" href="msg00178.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00179" href="msg00179.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Edward d Auvergne</li></ul></li>
<li><strong><a name="00182" href="msg00182.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00183" href="msg00183.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00184" href="msg00184.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00185" href="msg00185.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00186" href="msg00186.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00193" href="msg00193.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00195" href="msg00195.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00196" href="msg00196.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00199" href="msg00199.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00200" href="msg00200.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00210" href="msg00210.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00213" href="msg00213.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00216" href="msg00216.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00218" href="msg00218.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00225" href="msg00225.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00226" href="msg00226.html">Re: [sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00228" href="msg00228.html">Re: [sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels Emtek√¶r Linnet</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Fri Jun 28 15:40:08 2013</div>  
</body>
</html>
