<!-- MHonArc v2.6.10 -->
<!--X-Subject: r3075 &#45; /1.3/docs/data_model_redesign -->
<!--X-From-R13: rqjneqNaze&#45;erynk.pbz -->
<!--X-Date: Sun, 04 Mar 2007 09:24:54 +0100 -->
<!--X-Message-Id: E1HNm11&#45;0005C6&#45;JX@subversion.gna.org -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>r3075 - /1.3/docs/data_model_redesign -- March 04, 2007 - 09:24</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />r3075 - /1.3/docs/data_model_redesign</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00016" class="tabs">Index by Date</a> | <a href="threads.html#00016" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00015.html">Date Prev</a>] [<a href="msg00017.html">Date Next</a>] [<a href="msg00015.html">Thread Prev</a>] [<a href="msg00017.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: relax-commits@xxxxxxx</li>
<li class="menuitem">
<em>Date</em>: Sun, 04 Mar 2007 08:24:23 -0000</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00016.html">E1HNm11-0005C6-JX@subversion.gna.org</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>edward</strong> on March 04, 2007 - 09:24:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Author: bugman
Date: Sun Mar  4 09:24:21 2007
New Revision: 3075

URL: <a  href="http://svn.gna.org/viewcvs/relax?rev=3075&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=3075&amp;view=rev</a>
Log:
Updated the data model redesign planning document.

All discussions on the relax-devel mailing list 
(<a  href="https://mail.gna.org/public/relax-devel/">https://mail.gna.org/public/relax-devel/</a>) should
now be included.


Modified:
    1.3/docs/data_model_redesign

Modified: 1.3/docs/data_model_redesign
URL: 
<a  href="http://svn.gna.org/viewcvs/relax/1.3/docs/data_model_redesign?rev=3075&amp;r1=3074&amp;r2=3075&amp;view=diff">http://svn.gna.org/viewcvs/relax/1.3/docs/data_model_redesign?rev=3075&amp;r1=3074&amp;r2=3075&amp;view=diff</a>
==============================================================================
--- 1.3/docs/data_model_redesign (original)
+++ 1.3/docs/data_model_redesign Sun Mar  4 09:24:21 2007
@@ -28,18 +28,61 @@
 # Preparation.
 ##############
 
+1 [Done].  Firstly release relax version 1.3.0 prior to any changes (to 
allow a functional version which handles RNA better, has the tensor PDB 
representation code, etc).
 
-* Firstly release relax version 1.3.0 prior to any changes (to allow a 
functional version which handles RNA better, has the tensor PDB 
representation code, etc).
+2.  Redesign 'self.relax.data'.
 
-* Redesign 'self.relax.data'.
+3.  Create the data pipe looping function for the 'pipes' argument (Chris 
MacRaild, <a  href="https://mail.gna.org/public/relax-devel/2006-10/msg00060.html">https://mail.gna.org/public/relax-devel/2006-10/msg00060.html</a>, 
Message-id: &lt;1160562239.14487.98.camel@mrspell&gt;).  The user functions could 
be implemented as functors (Chris MacRaild, 
<a  href="https://mail.gna.org/public/relax-devel/2007-01/msg00020.html">https://mail.gna.org/public/relax-devel/2007-01/msg00020.html</a>, Message-ID: 
&lt;1168432131.7569.338.camel@mrspell&gt;).  The design will need to take into 
account the user function docstrings, relax help system, and the relax manual 
docstring fetching code.
 
-* Rename 'prompt/run.py' to 'prompt/pipe.py'.  Rename 'generic_fns/runs.py' 
to 'generic_fns/pipes.py'.
+4.  Create the spin_loop function (Edward d'Auvergne, 
<a  href="https://mail.gna.org/public/relax-devel/2006-10/msg00057.html">https://mail.gna.org/public/relax-devel/2006-10/msg00057.html</a>, Message-id: 
&lt;1160557041.9523.74.camel@xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&gt;).  Use a 
generator function, using the yield statement, to return the spin data 
containers which are essentially pointers to the data (Gary Thompson, 
<a  href="https://mail.gna.org/public/relax-devel/2007-01/msg00014.html">https://mail.gna.org/public/relax-devel/2007-01/msg00014.html</a>, Message-id: 
&lt;f001463a0701071417w6bd7927cp8fdd052e698575ec@xxxxxxxxxxxxxx&gt;).  The 
implementation was essentially given by Chris MacRaild at 
<a  href="https://mail.gna.org/public/relax-devel/2007-01/msg00036.html">https://mail.gna.org/public/relax-devel/2007-01/msg00036.html</a> (Message-ID: 
&lt;1168883717.7569.511.camel@mrspell&gt;).
 
-* Create the data pipe looping function for the 'pipes' argument (Chris 
MacRaild, <a  href="https://mail.gna.org/public/relax-devel/2006-10/msg00060.html">https://mail.gna.org/public/relax-devel/2006-10/msg00060.html</a>, 
Message-id: &lt;1160562239.14487.98.camel@mrspell&gt;).
+5.  Implement a parser for the following molecule/residue/spin selection 
syntax (Gary Thompson, 
<a  href="https://mail.gna.org/public/relax-devel/2007-01/msg00014.html">https://mail.gna.org/public/relax-devel/2007-01/msg00014.html</a>, Message-id: 
&lt;f001463a0701071417w6bd7927cp8fdd052e698575ec@xxxxxxxxxxxxxx&gt;):
+    #&lt;molecule number&gt; | 
&lt;molecule_name&gt;:&lt;residue_selection&gt;[,&lt;residue_selection&gt;...]@&lt;atom_selection&gt; 
[,&lt;atom_selection&gt;]
+    residue_selection=&lt;residue_number&gt; | &lt;residue_range&gt; | &lt;residue_type&gt;
+    residue_selection=&lt;residue_number&gt;-&lt;residue_number&gt;
+    atom_selection=&lt;string_and_wildcards&gt;
+This syntax will need to be properly referenced (in addition to being fully 
described) in the user function docstrings.  I.e. the reference for Molmol 
syntax, the reference for UCSF syntax, etc.  We need to find the source and 
name of the syntax.
 
-* Create the spin loop function (Edward d'Auvergne, 
<a  href="https://mail.gna.org/public/relax-devel/2006-10/msg00057.html">https://mail.gna.org/public/relax-devel/2006-10/msg00057.html</a>, Message-id: 
&lt;1160557041.9523.74.camel@xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&gt;).
+6.  Convert the methods of the class 'Selection' from the file 
'generic_fns/selection.py' into methods and then add the following functions 
(Chris MacRaild at 
<a  href="https://mail.gna.org/public/relax-devel/2007-01/msg00036.html">https://mail.gna.org/public/relax-devel/2007-01/msg00036.html</a> Message-ID: 
&lt;1168883717.7569.511.camel@mrspell&gt;; Edward d'Auvergne, 
<a  href="https://mail.gna.org/public/relax-devel/2007-01/msg00041.html">https://mail.gna.org/public/relax-devel/2007-01/msg00041.html</a>, Message-ID: 
&lt;7f080ed10701190408i8a5dee3y8ccbe1aba11bcba@xxxxxxxxxxxxxx&gt;):
+    parse_token()
+    tokenise()
 
-* Create a function for returning specific spin data.
+7.  Create the spin_command function (Chris MacRaild, 
<a  href="https://mail.gna.org/public/relax-devel/2007-01/msg00036.html">https://mail.gna.org/public/relax-devel/2007-01/msg00036.html</a>, Message-ID: 
&lt;1168883717.7569.511.camel@mrspell&gt;).
+
+8.  Rename 'prompt/run.py' to 'prompt/pipe.py'.  Rename 
'generic_fns/runs.py' to 'generic_fns/pipes.py'.
+
+9.  Create the new pipe user functions (from the old run user functions):
+    pipe.copy()         # Create a new pipe with the current contents of 
another pipe.
+    pipe.create()       # Create a new pipe.  Switch to this pipe by default.
+    pipe.current()      # Print the current pipe name.
+    pipe.delete()       # Delete the pipe.
+    pipe.delete_all()   # Delete all pipes.  Essentially deleting 
'self.relax.data'.
+    pipe.hybridise()    # Fuse two pipes into the current pipe.  Overlapping 
data in the two pipes must be identical!
+    pipe.list()         # Print the details of all pipes.
+    pipe.switch()       # Switch to a different pipe.
+
+10.  Create the 'molecule' user function class:
+    molecule.add()
+    molecule.copy()     # Copy the molecule information (name and num) from 
another pipe.
+    molecule.delete()
+    molecule.info()     # Print the molecule info.
+The molecule.add() user function should be used to create all the residue 
and spin structures for that molecule from a loaded structure.  This can be 
done through an API to allow users to code their own PDB readers (which could 
in future be incorporated into relax).  For more information see Gary 
Thompson's post at 
<a  href="https://mail.gna.org/public/relax-devel/2007-01/msg00014.html">https://mail.gna.org/public/relax-devel/2007-01/msg00014.html</a> (Message-ID: 
&lt;f001463a0701071417w6bd7927cp8fdd052e698575ec@xxxxxxxxxxxxxx&gt;).  The user 
function should also allow for the creation of an empty molecule data 
container to allow for analyses whereby no structure is needed (relaxation 
curve-fitting, NOE calculation, model-free analysis with isotropic diffusion, 
etc.).  The sequence user function class can then be used to load the 
sequence (or spin.read()).
+
+11.  Create the 'residue' user function class:
+    residue.create()    # This is currently named 'sequence.add()'.
+    residue.delete()
+    residue.merge()
+    residue.rename()
+    residue.renumber()
+
+12.  Create the 'spin' user function class:
+    spin.copy()         # Copy the spin info (name and num) from another 
pipe.
+    spin.create()
+    spin.delete()
+    spin.display()
+    spin.read()
+    spin.sort()
+    spin.write()
 
 
 
@@ -48,19 +91,28 @@
 
 The following are the steps to be taken for the function to function, file 
to file incremental conversion of the old system to the new system.  For each 
function:
 
-* Rewrite the function docstring expanding to better describe what the 
function is doing.  Convert to the epytext format for describing what data is 
input, what data is returned, etc.
+1.  Rewrite the function docstring expanding to better describe what the 
function is doing.  Convert to the epytext format for describing what data is 
input, what data is returned, etc.
 
-* User function docstrings should not be converted to epytext format.  The 
variable __doctype__ should be set to 'plaintext' just after each docstring 
so that the API documentation can properly interpret the docstring.
+2.  User function docstrings should not be converted to epytext format.  The 
variable __doctype__ should be set to 'plaintext' just after each docstring 
so that the API documentation can properly interpret the docstring.
 
-* Write a unit test for the function.  This must be done prior to modifying 
the code.
+3.  Write unit tests for the function to check all its expected behaviour.  
This must be done prior to modifying the code.
 
-* Remove all the 'run' arguments and the code accessing it.
+4.  Remove all the 'run' arguments and the code accessing it.
 
-* Add the 'pipes' argument to each user function in the 'prompt' directory 
to allow looping over a number of data pipes (Chris MacRaild, 
<a  href="https://mail.gna.org/public/relax-devel/2006-10/msg00060.html">https://mail.gna.org/public/relax-devel/2006-10/msg00060.html</a>, Message-id: 
&lt;1160562239.14487.98.camel@mrspell&gt;).
+5.  Add the 'pipes' argument to each user function in the 'prompt' directory 
to allow looping over a number of data pipes (Chris MacRaild, 
<a  href="https://mail.gna.org/public/relax-devel/2006-10/msg00060.html">https://mail.gna.org/public/relax-devel/2006-10/msg00060.html</a>, Message-id: 
&lt;1160562239.14487.98.camel@mrspell&gt;).
 
-* Use the following code at the start if 'self.relax.data' is accessed by 
the function:
+6.  Use the following code at the start if 'self.relax.data' is accessed by 
the function:
 -----
 # Alias the data for the current data pipe.
 data = self.relax.data[self.relax.pipe]
 -----
 Then access the object 'data' throughout the function.
+
+
+
+# Bugs and improvements.
+########################
+
+If bugs are found in the code the a bug report should be added to the relax 
bug tracker (<a  href="https://gna.org/bugs/?group=relax">https://gna.org/bugs/?group=relax</a>).  The bug should be fixed 
and, if the 1.2 line is affected as well, then the revision can be requested 
to be back ported.
+
+As large amounts of old code will be read, ideas for improvements will be 
inevitable.  If small, these improvements can be implemented on the spot.  
Otherwise if the idea is large and disruptive, it can be lodged as a task 
(<a  href="https://gna.org/task/?group=relax">https://gna.org/task/?group=relax</a>).



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Sun Mar 04 10:00:07 2007</div>  
</body>
</html>
