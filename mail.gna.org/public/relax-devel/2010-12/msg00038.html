<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: r11822 &#45; /branches/bieri_gui/gui_bieri/relax_gui.py -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Fri, 17 Dec 2010 17:41:28 +0100 -->
<!--X-Message-Id: AANLkTin2+YoayiN192u9&#45;9LWzjsVsF&#45;ijD&#45;Kyj3SO2K=@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: E1PSejO&#45;0001DL&#45;Ha@subversion.gna.org -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: r11822 - /branches/bieri_gui/gui_bieri/relax_gui.py -- December 17, 2010 - 17:41</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: r11822 - /branches/bieri_gui/gui_bieri/relax_gui.py</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00038" class="tabs">Index by Date</a> | <a href="threads.html#00038" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00037.html">Date Prev</a>] [<a href="msg00039.html">Date Next</a>] [<a href="msg00037.html">Thread Prev</a>] [<a href="msg00042.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Date</em>: Fri, 17 Dec 2010 17:41:19 +0100</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;	h=domainkey-signature:mime-version:received:sender:received	:in-reply-to:references:date:x-google-sender-auth:message-id:subject	:from:to:content-type:content-transfer-encoding;	bh=DgKDMPByMNxplysWn0uVKspKuHRpTBi21bBV9O99eBw=;	b=RETA4bn0nxEw7+ASXuzrs6DVqIrYZ5bh1qTFj8S8v7wUdlpyJs2DVixUSGMM4YaCLR	Xjo7ApglMpjHVppwoDE9d65/xUB1rzx6lZnsiTkHF+2N6ASJQ7pPAXTZpfwCZ26l0A5R	U3vMLQ69RJrtS9jh4N+ps89V6CuMupMts6Z+U=</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00038.html">AANLkTin2+YoayiN192u9-9LWzjsVsF-ijD-Kyj3SO2K=@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;E1PSejO-0001DL-Ha@xxxxxxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on December 17, 2010 - 17:41:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi Michael,

I just tested this change, but unfortunately it does not solve bug
#17317 (<a  rel="nofollow" href="https://gna.org/bugs/index.php?17317">https://gna.org/bugs/index.php?17317</a>).  We will need to find a
different solution to this :S  I would suggest reverting this change,
and then trying to find another solution.  I'm looking into this now
to terminate threads cleanly.  To trigger the problem, attempt a
model-free analysis and exit at different points during execution.
Sometimes it exists cleanly.  At other times, errors are thrown.  Some
examples are given below, as you'll see it's very messy.

Regards,

Edward




### Example 1 ###

[edward@localhost relax_gui]$ /data/relax/branches/bieri_gui/relax -g


Thank you for citing:


relaxGUI
========

Bieri, M., d'Auvergne, E. J. and Gooley, P. R. (2010). relaxGUI: a new
software for fast and simple
NMR relaxation data analysis and calculation of ps-ns and micro-s
motion of proteins (submitted).



relax
=====

d'Auvergne, E. J. and Gooley, P. R. (2008). Optimisation of NMR
dynamic models I. Minimisation
algorithms and their performance within the model-free and Brownian
rotational diffusion spaces. J.
Biomol. NMR, 40(2), 107-119 (<a  rel="nofollow" href="http://dx.doi.org/10.1007/s10858-007-9214-2">http://dx.doi.org/10.1007/s10858-007-9214-2</a>).

d'Auvergne, E. J. and Gooley, P. R. (2008). Optimisation of NMR
dynamic models II. A new methodology
for the dual optimisation of the model-free parameters and the
Brownian rotational diffusion tensor.
J. Biomol. NMR, 40(2), 121-133 (<a  rel="nofollow" href="http://dx.doi.org/10.1007/s10858-007-9213-3">http://dx.doi.org/10.1007/s10858-007-9213-3</a>).

Unhandled exception in thread started by &lt;bound method
Auto_model_free.execute_thread of
&lt;gui_bieri.analyses.auto_model_free.Auto_model_free instance at
0x7f4943291d88&gt;&gt;
[edward@localhost relax_gui]$




### Example 2 ###

[edward@localhost relax_gui]$ /data/relax/branches/bieri_gui/relax -g


Thank you for citing:


relaxGUI
========

Bieri, M., d'Auvergne, E. J. and Gooley, P. R. (2010). relaxGUI: a new
software for fast and simple
NMR relaxation data analysis and calculation of ps-ns and micro-s
motion of proteins (submitted).



relax
=====

d'Auvergne, E. J. and Gooley, P. R. (2008). Optimisation of NMR
dynamic models I. Minimisation
algorithms and their performance within the model-free and Brownian
rotational diffusion spaces. J.
Biomol. NMR, 40(2), 107-119 (<a  rel="nofollow" href="http://dx.doi.org/10.1007/s10858-007-9214-2">http://dx.doi.org/10.1007/s10858-007-9214-2</a>).

d'Auvergne, E. J. and Gooley, P. R. (2008). Optimisation of NMR
dynamic models II. A new methodology
for the dual optimisation of the model-free parameters and the
Brownian rotational diffusion tensor.
J. Biomol. NMR, 40(2), 121-133 (<a  rel="nofollow" href="http://dx.doi.org/10.1007/s10858-007-9213-3">http://dx.doi.org/10.1007/s10858-007-9213-3</a>).

Unhandled exception in thread started by
Traceback (most recent call last):
  File &quot;/data/relax/branches/bieri_gui/gui_bieri/analyses/auto_model_free.py&quot;,
line 871, in execute_thread
    dAuvergne_protocol(save_dir=data.save_dir,
diff_model=global_model, mf_models=data.mf_models,
local_tm_models=data.local_tm_models, pdb_file=data.structure_file,
seq_args=data.seq_args, het_name=data.het_name,
relax_data=data.relax_data, unres=data.unres, exclude=data.exclude,
bond_length=data.bond_length, csa=data.csa, hetnuc=data.hetnuc,
proton=data.proton, grid_inc=data.inc, min_algor=data.min_algor,
mc_num=data.mc_num, max_iter=data.max_iter, conv_loop=data.conv_loop)
  File &quot;/data/relax/branches/bieri_gui/auto_analyses/dauvergne_protocol.py&quot;,
line 282, in __init__
    self.multi_model(local_tm=True)
  File &quot;/data/relax/branches/bieri_gui/auto_analyses/dauvergne_protocol.py&quot;,
line 842, in multi_model
    self.interpreter.relax_data.read(ri_label=data[0],
frq_label=data[1], frq=data[2], file=data[3], dir=data[4],
mol_name_col=data[5], res_num_col=data[6], res_name_col=data[7],
spin_num_col=data[8], spin_name_col=data[9], data_col=data[10],
error_col=data[11], sep=data[12])
  File &quot;/data/relax/branches/bieri_gui/prompt/relax_data.py&quot;, line 319, in 
read
    relax_data.read(ri_label=ri_label, frq_label=frq_label, frq=frq,
file=file, dir=dir, spin_id_col=spin_id_col,
mol_name_col=mol_name_col, res_num_col=res_num_col,
res_name_col=res_name_col, spin_num_col=spin_num_col,
spin_name_col=spin_name_col, data_col=data_col, error_col=error_col,
sep=sep, spin_id=spin_id)
  File &quot;/data/relax/branches/bieri_gui/generic_fns/relax_data.py&quot;,
line 660, in read
    pack_data(ri_label, frq_label, frq, values, errors, ids)
  File &quot;/data/relax/branches/bieri_gui/generic_fns/relax_data.py&quot;,
line 570, in pack_data
    spin = return_spin(id)
  File &quot;/data/relax/branches/bieri_gui/generic_fns/mol_res_spin.py&quot;,
line 1910, in return_spin
    if (mol, res, spin) not in select_obj[i]:
  File &quot;/data/relax/branches/bieri_gui/generic_fns/mol_res_spin.py&quot;,
line 147, in __contains__
    return (obj in self._intersect[0]) and (obj in self._intersect[1])
  File &quot;/data/relax/branches/bieri_gui/generic_fns/mol_res_spin.py&quot;,
line 155, in __contains__
    return self.__contains_mol_res_spin_containers(obj)
  File &quot;/data/relax/branches/bieri_gui/generic_fns/mol_res_spin.py&quot;,
line 240, in __contains_mol_res_spin_containers
    elif relax_re.search(self.residues, res.name) or res.num in self.residues:
  File &quot;/data/relax/branches/bieri_gui/generic_fns/relax_re.py&quot;, line
75, in search
    pattern_re = replace(pattern, '*', '.*')
TypeError: 'NoneType' object is not callable
[edward@localhost relax_gui]$




### Example 3 ###

[edward@localhost relax_gui]$ /data/relax/branches/bieri_gui/relax -g


Searching through 11 grid nodes.
k: 0        xk: [        1000] fk: 10173.3877242
k: 3        xk: [        4300] fk: 7779.43338854
k: 4        xk: [        5400] fk: 5092.82647948
k: 5        xk: [        6500] fk: 3214.5918094
k: 6        xk: [        7600] fk: 1967.6701103
k: 7        xk: [        8700] fk: 1157.37203626
k: 8        xk: [        9800] fk: 641.974121519
k: 9        xk: [       10900] fk: 327.772091917
k: 10       xk: [       12000] fk: 154.295417958


Thank you for citing:


relaxGUI
========

Bieri, M., d'Auvergne, E. J. and Gooley, P. R. (2010). relaxGUI: a new
software for fast and simple
NMR relaxation data analysis and calculation of ps-ns and micro-s
motion of proteins (submitted).



relax
=====

d'Auvergne, E. J. and Gooley, P. R. (2008). Optimisation of NMR
dynamic models I. Minimisation
algorithms and their performance within the model-free and Brownian
rotational diffusion spaces. J.
Biomol. NMR, 40(2), 107-119 (<a  rel="nofollow" href="http://dx.doi.org/10.1007/s10858-007-9214-2">http://dx.doi.org/10.1007/s10858-007-9214-2</a>).

d'Auvergne, E. J. and Gooley, P. R. (2008). Optimisation of NMR
dynamic models II. A new methodology
for the dual optimisation of the model-free parameters and the
Brownian rotational diffusion tensor.
J. Biomol. NMR, 40(2), 121-133 (<a  rel="nofollow" href="http://dx.doi.org/10.1007/s10858-007-9213-3">http://dx.doi.org/10.1007/s10858-007-9213-3</a>).



Fitting to spin ':149&amp;:thr@N'
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Unhandled exception in thread started by
Traceback (most recent call last):
  File &quot;/data/relax/branches/bieri_gui/gui_bieri/analyses/auto_model_free.py&quot;,
line 871, in execute_thread
    dAuvergne_protocol(save_dir=data.save_dir,
diff_model=global_model, mf_models=data.mf_models,
local_tm_models=data.local_tm_models, pdb_file=data.structure_file,
seq_args=data.seq_args, het_name=data.het_name,
relax_data=data.relax_data, unres=data.unres, exclude=data.exclude,
bond_length=data.bond_length, csa=data.csa, hetnuc=data.hetnuc,
proton=data.proton, grid_inc=data.inc, min_algor=data.min_algor,
mc_num=data.mc_num, max_iter=data.max_iter, conv_loop=data.conv_loop)
  File &quot;/data/relax/branches/bieri_gui/auto_analyses/dauvergne_protocol.py&quot;,
line 282, in __init__
    self.multi_model(local_tm=True)
  File &quot;/data/relax/branches/bieri_gui/auto_analyses/dauvergne_protocol.py&quot;,
line 866, in multi_model
    self.interpreter.grid_search(inc=self.grid_inc)
  File &quot;/data/relax/branches/bieri_gui/prompt/minimisation.py&quot;, line
106, in grid_search
    minimise.grid_search(lower=lower, upper=upper, inc=inc,
constraints=constraints, verbosity=verbosity)
  File &quot;/data/relax/branches/bieri_gui/generic_fns/minimise.py&quot;, line
133, in grid_search
    grid_search(lower=lower, upper=upper, inc=inc,
constraints=constraints, verbosity=verbosity)
  File 
&quot;/data/relax/branches/bieri_gui/specific_fns/model_free/mf_minimise.py&quot;,
line 1174, in grid_search
    self.minimise(min_algor='grid', lower=lower, upper=upper, inc=inc,
constraints=constraints, verbosity=verbosity, sim_index=sim_index)
  File 
&quot;/data/relax/branches/bieri_gui/specific_fns/model_free/mf_minimise.py&quot;,
line 1382, in minimise
    param_vector = self._assemble_param_vector(spin=spin, sim_index=sim_index)
  File &quot;/data/relax/branches/bieri_gui/specific_fns/model_free/main.py&quot;,
line 182, in _assemble_param_vector
    model_type = self._determine_model_type()
  File &quot;/data/relax/branches/bieri_gui/specific_fns/model_free/main.py&quot;,
line 688, in _determine_model_type
    if not exists_mol_res_spin_data():
  File &quot;/data/relax/branches/bieri_gui/generic_fns/mol_res_spin.py&quot;,
line 1211, in exists_mol_res_spin_data
    if dp.mol.is_empty():
  File &quot;/data/relax/branches/bieri_gui/data/mol_res_spin.py&quot;, line
639, in is_empty
    if len(self) == 1 and self[0].is_empty():
  File &quot;/data/relax/branches/bieri_gui/data/mol_res_spin.py&quot;, line
572, in is_empty
    if match(&quot;^__&quot;, name):
TypeError: 'NoneType' object is not callable




On 15 December 2010 00:56,  &lt;michael.bieri@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Author: michaelbieri
Date: Wed Dec 15 00:56:30 2010
New Revision: 11822

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=11822&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=11822&amp;view=rev</a>
Log:
relaxGUI job is killed upon exiting the program.

This is to completely kill running threads, which can't be controlled under 
Python. The error was detected by Edward d'Auvergne reported at 
<a  rel="nofollow" href="https://gna.org/bugs/index.php?17317">https://gna.org/bugs/index.php?17317</a>.

Modified:
   branches/bieri_gui/gui_bieri/relax_gui.py

Modified: branches/bieri_gui/gui_bieri/relax_gui.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/bieri_gui/gui_bieri/relax_gui.py?rev=11822&amp;r1=11821&amp;r2=11822&amp;view=diff">http://svn.gna.org/viewcvs/relax/branches/bieri_gui/gui_bieri/relax_gui.py?rev=11822&amp;r1=11821&amp;r2=11822&amp;view=diff</a>
==============================================================================
--- branches/bieri_gui/gui_bieri/relax_gui.py (original)
+++ branches/bieri_gui/gui_bieri/relax_gui.py Wed Dec 15 00:56:30 2010
@@ -362,16 +362,8 @@
            text = text + '\n'
            sys.__stdout__.write(text)

-            # Destroy all dialogs.
-            self.controller.Destroy()
-            self.dialog_about_gui.Destroy()
-            self.dialog_about_relax.Destroy()
-            self.relax_prompt.Destroy()
-            self.mol_res_spin_tree.Destroy()
-            self.user_functions.destroy()
-
-            # Destroy the main window.
-            self.Destroy()
+            # End application.
+            sys.exit()


    def import_seq(self, event):


_______________________________________________
relax (<a  rel="nofollow" href="http://nmr-relax.com">http://nmr-relax.com</a>)

This is the relax-commits mailing list
relax-commits@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-commits">https://mail.gna.org/listinfo/relax-commits</a>

</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Fri Dec 17 19:20:14 2010</div>  
</body>
</html>
