<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>generic_fns.structure.geometric</title>

  <!--Epydoc setup-->
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>

  <!--Mobile device support-->
  <meta name=viewport content="width=device-width, initial-scale=1">

  <!--Google analytics JS-->
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30096326-1']);
    _gaq.push(['_setDomainName', 'nmr-relax.com']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="/">relax</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="generic_fns-module.html">Package&nbsp;generic_fns</a> ::
        <a href="generic_fns.structure-module.html">Package&nbsp;structure</a> ::
        Module&nbsp;geometric
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="generic_fns.structure.geometric-pysrc.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<h1 class="epydoc">Source Code for <a href="generic_fns.structure.geometric-module.html">Module generic_fns.structure.geometric</a></h1>
<pre class="py-src">
<a name="L1"></a><tt class="py-lineno">   1</tt>  <tt class="py-line"><tt class="py-comment">###############################################################################</tt> </tt>
<a name="L2"></a><tt class="py-lineno">   2</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L3"></a><tt class="py-lineno">   3</tt>  <tt class="py-line"><tt class="py-comment"># Copyright (C) 2003-2013 Edward d'Auvergne                                   #</tt> </tt>
<a name="L4"></a><tt class="py-lineno">   4</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L5"></a><tt class="py-lineno">   5</tt>  <tt class="py-line"><tt class="py-comment"># This file is part of the program relax (http://www.nmr-relax.com).          #</tt> </tt>
<a name="L6"></a><tt class="py-lineno">   6</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L7"></a><tt class="py-lineno">   7</tt>  <tt class="py-line"><tt class="py-comment"># This program is free software: you can redistribute it and/or modify        #</tt> </tt>
<a name="L8"></a><tt class="py-lineno">   8</tt>  <tt class="py-line"><tt class="py-comment"># it under the terms of the GNU General Public License as published by        #</tt> </tt>
<a name="L9"></a><tt class="py-lineno">   9</tt>  <tt class="py-line"><tt class="py-comment"># the Free Software Foundation, either version 3 of the License, or           #</tt> </tt>
<a name="L10"></a><tt class="py-lineno">  10</tt>  <tt class="py-line"><tt class="py-comment"># (at your option) any later version.                                         #</tt> </tt>
<a name="L11"></a><tt class="py-lineno">  11</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L12"></a><tt class="py-lineno">  12</tt>  <tt class="py-line"><tt class="py-comment"># This program is distributed in the hope that it will be useful,             #</tt> </tt>
<a name="L13"></a><tt class="py-lineno">  13</tt>  <tt class="py-line"><tt class="py-comment"># but WITHOUT ANY WARRANTY; without even the implied warranty of              #</tt> </tt>
<a name="L14"></a><tt class="py-lineno">  14</tt>  <tt class="py-line"><tt class="py-comment"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the               #</tt> </tt>
<a name="L15"></a><tt class="py-lineno">  15</tt>  <tt class="py-line"><tt class="py-comment"># GNU General Public License for more details.                                #</tt> </tt>
<a name="L16"></a><tt class="py-lineno">  16</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L17"></a><tt class="py-lineno">  17</tt>  <tt class="py-line"><tt class="py-comment"># You should have received a copy of the GNU General Public License           #</tt> </tt>
<a name="L18"></a><tt class="py-lineno">  18</tt>  <tt class="py-line"><tt class="py-comment"># along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.       #</tt> </tt>
<a name="L19"></a><tt class="py-lineno">  19</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L20"></a><tt class="py-lineno">  20</tt>  <tt class="py-line"><tt class="py-comment">###############################################################################</tt> </tt>
<a name="L21"></a><tt class="py-lineno">  21</tt>  <tt class="py-line"> </tt>
<a name="L22"></a><tt class="py-lineno">  22</tt>  <tt class="py-line"><tt class="py-comment"># Python module imports.</tt> </tt>
<a name="L23"></a><tt class="py-lineno">  23</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">math</tt> <tt class="py-keyword">import</tt> <tt class="py-name">cos</tt><tt class="py-op">,</tt> <tt class="py-name">pi</tt><tt class="py-op">,</tt> <tt class="py-name">sin</tt> </tt>
<a name="L24"></a><tt class="py-lineno">  24</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">numpy</tt> <tt class="py-keyword">import</tt> <tt class="py-name">arccos</tt><tt class="py-op">,</tt> <tt class="py-name">array</tt><tt class="py-op">,</tt> <tt class="py-name">dot</tt><tt class="py-op">,</tt> <tt class="py-name">eye</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">,</tt> <tt id="link-0" class="py-name" targets="Function bmrblib.pystarlib.Utils.transpose()=bmrblib.pystarlib.Utils-module.html#transpose"><a title="bmrblib.pystarlib.Utils.transpose" class="py-name" href="#" onclick="return doclink('link-0', 'transpose', 'link-0');">transpose</a></tt><tt class="py-op">,</tt> <tt class="py-name">zeros</tt> </tt>
<a name="L25"></a><tt class="py-lineno">  25</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">os</tt> <tt class="py-keyword">import</tt> <tt class="py-name">getcwd</tt> </tt>
<a name="L26"></a><tt class="py-lineno">  26</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">string</tt> <tt class="py-keyword">import</tt> <tt class="py-name">ascii_uppercase</tt> </tt>
<a name="L27"></a><tt class="py-lineno">  27</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">warnings</tt> <tt class="py-keyword">import</tt> <tt class="py-name">warn</tt> </tt>
<a name="L28"></a><tt class="py-lineno">  28</tt>  <tt class="py-line"> </tt>
<a name="L29"></a><tt class="py-lineno">  29</tt>  <tt class="py-line"><tt class="py-comment"># relax module imports.</tt> </tt>
<a name="L30"></a><tt class="py-lineno">  30</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-1" class="py-name" targets="Package generic_fns=generic_fns-module.html"><a title="generic_fns" class="py-name" href="#" onclick="return doclink('link-1', 'generic_fns', 'link-1');">generic_fns</a></tt><tt class="py-op">.</tt><tt id="link-2" class="py-name" targets="Module data.interatomic=data.interatomic-module.html,Module generic_fns.interatomic=generic_fns.interatomic-module.html,Module test_suite.gui_tests.interatomic=test_suite.gui_tests.interatomic-module.html,Module test_suite.system_tests.interatomic=test_suite.system_tests.interatomic-module.html,Module user_functions.interatomic=user_functions.interatomic-module.html"><a title="data.interatomic
generic_fns.interatomic
test_suite.gui_tests.interatomic
test_suite.system_tests.interatomic
user_functions.interatomic" class="py-name" href="#" onclick="return doclink('link-2', 'interatomic', 'link-2');">interatomic</a></tt> <tt class="py-keyword">import</tt> <tt id="link-3" class="py-name" targets="Function generic_fns.interatomic.interatomic_loop()=generic_fns.interatomic-module.html#interatomic_loop"><a title="generic_fns.interatomic.interatomic_loop" class="py-name" href="#" onclick="return doclink('link-3', 'interatomic_loop', 'link-3');">interatomic_loop</a></tt> </tt>
<a name="L31"></a><tt class="py-lineno">  31</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-4" class="py-name"><a title="generic_fns" class="py-name" href="#" onclick="return doclink('link-4', 'generic_fns', 'link-1');">generic_fns</a></tt><tt class="py-op">.</tt><tt id="link-5" class="py-name" targets="Module data.mol_res_spin=data.mol_res_spin-module.html,Module generic_fns.mol_res_spin=generic_fns.mol_res_spin-module.html,Module test_suite.system_tests.mol_res_spin=test_suite.system_tests.mol_res_spin-module.html"><a title="data.mol_res_spin
generic_fns.mol_res_spin
test_suite.system_tests.mol_res_spin" class="py-name" href="#" onclick="return doclink('link-5', 'mol_res_spin', 'link-5');">mol_res_spin</a></tt> <tt class="py-keyword">import</tt> <tt id="link-6" class="py-name" targets="Function generic_fns.mol_res_spin.exists_mol_res_spin_data()=generic_fns.mol_res_spin-module.html#exists_mol_res_spin_data"><a title="generic_fns.mol_res_spin.exists_mol_res_spin_data" class="py-name" href="#" onclick="return doclink('link-6', 'exists_mol_res_spin_data', 'link-6');">exists_mol_res_spin_data</a></tt><tt class="py-op">,</tt> <tt id="link-7" class="py-name" targets="Function generic_fns.mol_res_spin.return_spin()=generic_fns.mol_res_spin-module.html#return_spin"><a title="generic_fns.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-7', 'return_spin', 'link-7');">return_spin</a></tt> </tt>
<a name="L32"></a><tt class="py-lineno">  32</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-8" class="py-name"><a title="generic_fns" class="py-name" href="#" onclick="return doclink('link-8', 'generic_fns', 'link-1');">generic_fns</a></tt> <tt class="py-keyword">import</tt> <tt id="link-9" class="py-name" targets="Module generic_fns.pipes=generic_fns.pipes-module.html,Module test_suite.gui_tests.pipes=test_suite.gui_tests.pipes-module.html,Module test_suite.system_tests.pipes=test_suite.system_tests.pipes-module.html"><a title="generic_fns.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-9', 'pipes', 'link-9');">pipes</a></tt> </tt>
<a name="L33"></a><tt class="py-lineno">  33</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-10" class="py-name"><a title="generic_fns" class="py-name" href="#" onclick="return doclink('link-10', 'generic_fns', 'link-1');">generic_fns</a></tt><tt class="py-op">.</tt><tt id="link-11" class="py-name" targets="Package bmrblib.structure=bmrblib.structure-module.html,Package generic_fns.structure=generic_fns.structure-module.html,Package lib.structure=lib.structure-module.html,Module test_suite.system_tests.structure=test_suite.system_tests.structure-module.html,Module user_functions.structure=user_functions.structure-module.html"><a title="bmrblib.structure
generic_fns.structure
lib.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-11', 'structure', 'link-11');">structure</a></tt><tt class="py-op">.</tt><tt id="link-12" class="py-name" targets="Module generic_fns.structure.internal=generic_fns.structure.internal-module.html"><a title="generic_fns.structure.internal" class="py-name" href="#" onclick="return doclink('link-12', 'internal', 'link-12');">internal</a></tt> <tt class="py-keyword">import</tt> <tt id="link-13" class="py-name" targets="Class generic_fns.structure.internal.Internal=generic_fns.structure.internal.Internal-class.html"><a title="generic_fns.structure.internal.Internal" class="py-name" href="#" onclick="return doclink('link-13', 'Internal', 'link-13');">Internal</a></tt> </tt>
<a name="L34"></a><tt class="py-lineno">  34</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-14" class="py-name"><a title="generic_fns" class="py-name" href="#" onclick="return doclink('link-14', 'generic_fns', 'link-1');">generic_fns</a></tt><tt class="py-op">.</tt><tt id="link-15" class="py-name"><a title="bmrblib.structure
generic_fns.structure
lib.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-15', 'structure', 'link-11');">structure</a></tt><tt class="py-op">.</tt><tt id="link-16" class="py-name" targets="Module generic_fns.structure.mass=generic_fns.structure.mass-module.html"><a title="generic_fns.structure.mass" class="py-name" href="#" onclick="return doclink('link-16', 'mass', 'link-16');">mass</a></tt> <tt class="py-keyword">import</tt> <tt id="link-17" class="py-name" targets="Function generic_fns.structure.mass.centre_of_mass()=generic_fns.structure.mass-module.html#centre_of_mass"><a title="generic_fns.structure.mass.centre_of_mass" class="py-name" href="#" onclick="return doclink('link-17', 'centre_of_mass', 'link-17');">centre_of_mass</a></tt> </tt>
<a name="L35"></a><tt class="py-lineno">  35</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-18" class="py-name" targets="Package lib=lib-module.html"><a title="lib" class="py-name" href="#" onclick="return doclink('link-18', 'lib', 'link-18');">lib</a></tt><tt class="py-op">.</tt><tt id="link-19" class="py-name"><a title="bmrblib.structure
generic_fns.structure
lib.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-19', 'structure', 'link-11');">structure</a></tt><tt class="py-op">.</tt><tt id="link-20" class="py-name" targets="Module lib.structure.rotor=lib.structure.rotor-module.html"><a title="lib.structure.rotor" class="py-name" href="#" onclick="return doclink('link-20', 'rotor', 'link-20');">rotor</a></tt> <tt class="py-keyword">import</tt> <tt id="link-21" class="py-name" targets="Function lib.structure.rotor.rotor_pdb()=lib.structure.rotor-module.html#rotor_pdb"><a title="lib.structure.rotor.rotor_pdb" class="py-name" href="#" onclick="return doclink('link-21', 'rotor_pdb', 'link-21');">rotor_pdb</a></tt> </tt>
<a name="L36"></a><tt class="py-lineno">  36</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-22" class="py-name" targets="Package maths_fns=maths_fns-module.html"><a title="maths_fns" class="py-name" href="#" onclick="return doclink('link-22', 'maths_fns', 'link-22');">maths_fns</a></tt><tt class="py-op">.</tt><tt id="link-23" class="py-name" targets="Module maths_fns.rotation_matrix=maths_fns.rotation_matrix-module.html"><a title="maths_fns.rotation_matrix" class="py-name" href="#" onclick="return doclink('link-23', 'rotation_matrix', 'link-23');">rotation_matrix</a></tt> <tt class="py-keyword">import</tt> <tt id="link-24" class="py-name" targets="Function maths_fns.rotation_matrix.two_vect_to_R()=maths_fns.rotation_matrix-module.html#two_vect_to_R"><a title="maths_fns.rotation_matrix.two_vect_to_R" class="py-name" href="#" onclick="return doclink('link-24', 'two_vect_to_R', 'link-24');">two_vect_to_R</a></tt> </tt>
<a name="L37"></a><tt class="py-lineno">  37</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-25" class="py-name" targets="Module relax_errors=relax_errors-module.html"><a title="relax_errors" class="py-name" href="#" onclick="return doclink('link-25', 'relax_errors', 'link-25');">relax_errors</a></tt> <tt class="py-keyword">import</tt> <tt id="link-26" class="py-name" targets="Class relax_errors.RelaxNoPdbError=relax_errors.RelaxNoPdbError-class.html"><a title="relax_errors.RelaxNoPdbError" class="py-name" href="#" onclick="return doclink('link-26', 'RelaxNoPdbError', 'link-26');">RelaxNoPdbError</a></tt><tt class="py-op">,</tt> <tt id="link-27" class="py-name" targets="Class relax_errors.RelaxNoSequenceError=relax_errors.RelaxNoSequenceError-class.html"><a title="relax_errors.RelaxNoSequenceError" class="py-name" href="#" onclick="return doclink('link-27', 'RelaxNoSequenceError', 'link-27');">RelaxNoSequenceError</a></tt><tt class="py-op">,</tt> <tt id="link-28" class="py-name" targets="Class relax_errors.RelaxNoTensorError=relax_errors.RelaxNoTensorError-class.html"><a title="relax_errors.RelaxNoTensorError" class="py-name" href="#" onclick="return doclink('link-28', 'RelaxNoTensorError', 'link-28');">RelaxNoTensorError</a></tt><tt class="py-op">,</tt> <tt id="link-29" class="py-name" targets="Class relax_errors.RelaxNoVectorsError=relax_errors.RelaxNoVectorsError-class.html"><a title="relax_errors.RelaxNoVectorsError" class="py-name" href="#" onclick="return doclink('link-29', 'RelaxNoVectorsError', 'link-29');">RelaxNoVectorsError</a></tt> </tt>
<a name="L38"></a><tt class="py-lineno">  38</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-30" class="py-name" targets="Module relax_io=relax_io-module.html"><a title="relax_io" class="py-name" href="#" onclick="return doclink('link-30', 'relax_io', 'link-30');">relax_io</a></tt> <tt class="py-keyword">import</tt> <tt id="link-31" class="py-name" targets="Function relax_io.get_file_path()=relax_io-module.html#get_file_path"><a title="relax_io.get_file_path" class="py-name" href="#" onclick="return doclink('link-31', 'get_file_path', 'link-31');">get_file_path</a></tt><tt class="py-op">,</tt> <tt id="link-32" class="py-name" targets="Function relax_io.open_write_file()=relax_io-module.html#open_write_file"><a title="relax_io.open_write_file" class="py-name" href="#" onclick="return doclink('link-32', 'open_write_file', 'link-32');">open_write_file</a></tt> </tt>
<a name="L39"></a><tt class="py-lineno">  39</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-33" class="py-name" targets="Module relax_warnings=relax_warnings-module.html"><a title="relax_warnings" class="py-name" href="#" onclick="return doclink('link-33', 'relax_warnings', 'link-33');">relax_warnings</a></tt> <tt class="py-keyword">import</tt> <tt id="link-34" class="py-name" targets="Class relax_warnings.RelaxWarning=relax_warnings.RelaxWarning-class.html"><a title="relax_warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-34', 'RelaxWarning', 'link-34');">RelaxWarning</a></tt> </tt>
<a name="L40"></a><tt class="py-lineno">  40</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-35" class="py-name" targets="Variable auto_analyses.dauvergne_protocol.status=auto_analyses.dauvergne_protocol-module.html#status,Variable auto_analyses.noe.status=auto_analyses.noe-module.html#status,Variable auto_analyses.relax_fit.status=auto_analyses.relax_fit-module.html#status,Variable auto_analyses.stereochem_analysis.status=auto_analyses.stereochem_analysis-module.html#status,Variable data.status=data-module.html#status,Variable generic_fns.bmrb.status=generic_fns.bmrb-module.html#status,Variable generic_fns.grace.status=generic_fns.grace-module.html#status,Variable generic_fns.minimise.status=generic_fns.minimise-module.html#status,Variable generic_fns.mol_res_spin.status=generic_fns.mol_res_spin-module.html#status,Variable generic_fns.molmol.status=generic_fns.molmol-module.html#status,Variable generic_fns.pipes.status=generic_fns.pipes-module.html#status,Variable generic_fns.pymol_control.status=generic_fns.pymol_control-module.html#status,Variable generic_fns.result_files.status=generic_fns.result_files-module.html#status,Variable generic_fns.script.status=generic_fns.script-module.html#status,Variable generic_fns.state.status=generic_fns.state-module.html#status,Variable generic_fns.structure.geometric.status=generic_fns.structure.geometric-module.html#status,Variable generic_fns.value.status=generic_fns.value-module.html#status,Variable gui.about.status=gui.about-module.html#status,Variable gui.analyses.auto_model_free.status=gui.analyses.auto_model_free-module.html#status,Variable gui.analyses.auto_noe.status=gui.analyses.auto_noe-module.html#status,Variable gui.analyses.auto_rx_base.status=gui.analyses.auto_rx_base-module.html#status,Variable gui.analyses.execute.status=gui.analyses.execute-module.html#status,Variable gui.analyses.results_analysis.status=gui.analyses.results_analysis-module.html#status,Variable gui.analyses.status=gui.analyses-module.html#status,Variable gui.components.base_list.status=gui.components.base_list-module.html#status,Variable gui.components.free_file_format.status=gui.components.free_file_format-module.html#status,Variable gui.components.grid.status=gui.components.grid-module.html#status,Variable gui.components.molecule.status=gui.components.molecule-module.html#status,Variable gui.components.relax_data.status=gui.components.relax_data-module.html#status,Variable gui.components.relax_data_meta.status=gui.components.relax_data_meta-module.html#status,Variable gui.components.spectrum.status=gui.components.spectrum-module.html#status,Variable gui.controller.status=gui.controller-module.html#status,Variable gui.errors.status=gui.errors-module.html#status,Variable gui.export_bmrb.status=gui.export_bmrb-module.html#status,Variable gui.filedialog.status=gui.filedialog-module.html#status,Variable gui.fonts.status=gui.fonts-module.html#status,Variable gui.icons.status=gui.icons-module.html#status,Variable gui.input_elements.bool.status=gui.input_elements.bool-module.html#status,Variable gui.input_elements.dir.status=gui.input_elements.dir-module.html#status,Variable gui.input_elements.file.status=gui.input_elements.file-module.html#status,Variable gui.input_elements.sequence.status=gui.input_elements.sequence-module.html#status,Variable gui.input_elements.sequence_2D.status=gui.input_elements.sequence_2D-module.html#status,Variable gui.interpreter.status=gui.interpreter-module.html#status,Variable gui.menu.status=gui.menu-module.html#status,Variable gui.message.status=gui.message-module.html#status,Variable gui.misc.status=gui.misc-module.html#status,Variable gui.paths.status=gui.paths-module.html#status,Variable gui.pipe_editor.status=gui.pipe_editor-module.html#status,Variable gui.relax_gui.status=gui.relax_gui-module.html#status,Variable gui.relax_prompt.status=gui.relax_prompt-module.html#status,Variable gui.results_viewer.status=gui.results_viewer-module.html#status,Variable gui.spin_viewer.frame.status=gui.spin_viewer.frame-module.html#status,Variable gui.spin_viewer.tree.status=gui.spin_viewer.tree-module.html#status,Variable gui.status=gui-module.html#status,Variable gui.string_conv.status=gui.string_conv-module.html#status,Variable gui.uf_objects.status=gui.uf_objects-module.html#status,Variable gui.wizard.status=gui.wizard-module.html#status,Variable info.Bieri11.status=info.Bieri11-class.html#status,Variable info.Clore90.status=info.Clore90-class.html#status,Variable info.Delaglio95.status=info.Delaglio95-class.html#status,Variable info.GoddardKneller.status=info.GoddardKneller-class.html#status,Variable info.LipariSzabo82a.status=info.LipariSzabo82a-class.html#status,Variable info.LipariSzabo82b.status=info.LipariSzabo82b-class.html#status,Variable info.Ref.status=info.Ref-class.html#status,Variable info.dAuvergne06.status=info.dAuvergne06-class.html#status,Variable info.dAuvergneGooley03.status=info.dAuvergneGooley03-class.html#status,Variable info.dAuvergneGooley06.status=info.dAuvergneGooley06-class.html#status,Variable info.dAuvergneGooley07.status=info.dAuvergneGooley07-class.html#status,Variable info.dAuvergneGooley08a.status=info.dAuvergneGooley08a-class.html#status,Variable info.dAuvergneGooley08b.status=info.dAuvergneGooley08b-class.html#status,Variable info.status=info-module.html#status,Variable prompt.command.status=prompt.command-module.html#status,Variable prompt.help.status=prompt.help-module.html#status,Variable prompt.interpreter.status=prompt.interpreter-module.html#status,Variable prompt.uf_docstring.status=prompt.uf_docstring-module.html#status,Variable prompt.uf_objects.status=prompt.uf_objects-module.html#status,Variable relax.status=relax-module.html#status,Variable relax_warnings.status=relax_warnings-module.html#status,Variable scons.manuals.status=scons.manuals-module.html#status,Variable setup.status=setup-module.html#status,Module status=status-module.html,Variable test_suite.gui_tests.base_classes.status=test_suite.gui_tests.base_classes-module.html#status,Variable test_suite.gui_tests.bruker.status=test_suite.gui_tests.bruker-module.html#status,Variable test_suite.gui_tests.model_free.status=test_suite.gui_tests.model_free-module.html#status,Variable test_suite.gui_tests.noe.status=test_suite.gui_tests.noe-module.html#status,Variable test_suite.gui_tests.rx.status=test_suite.gui_tests.rx-module.html#status,Variable test_suite.gui_tests.state.status=test_suite.gui_tests.state-module.html#status,Variable test_suite.gui_tests.test_user_functions.status=test_suite.gui_tests.test_user_functions-module.html#status,Variable test_suite.relax_test_loader.status=test_suite.relax_test_loader-module.html#status,Variable test_suite.relax_test_runner.status=test_suite.relax_test_runner-module.html#status,Variable test_suite.system_tests.angles.status=test_suite.system_tests.angles-module.html#status,Variable test_suite.system_tests.bmrb.status=test_suite.system_tests.bmrb-module.html#status,Variable test_suite.system_tests.bruker.status=test_suite.system_tests.bruker-module.html#status,Variable test_suite.system_tests.consistency_tests.status=test_suite.system_tests.consistency_tests-module.html#status,Variable test_suite.system_tests.dasha.status=test_suite.system_tests.dasha-module.html#status,Variable test_suite.system_tests.diffusion_tensor.status=test_suite.system_tests.diffusion_tensor-module.html#status,Variable test_suite.system_tests.frame_order.status=test_suite.system_tests.frame_order-module.html#status,Variable test_suite.system_tests.generic.status=test_suite.system_tests.generic-module.html#status,Variable test_suite.system_tests.grace.status=test_suite.system_tests.grace-module.html#status,Variable test_suite.system_tests.interatomic.status=test_suite.system_tests.interatomic-module.html#status,Variable test_suite.system_tests.jw_mapping.status=test_suite.system_tests.jw_mapping-module.html#status,Variable test_suite.system_tests.load_spins.status=test_suite.system_tests.load_spins-module.html#status,Variable test_suite.system_tests.model_elimination.status=test_suite.system_tests.model_elimination-module.html#status,Variable test_suite.system_tests.model_free.status=test_suite.system_tests.model_free-module.html#status,Variable test_suite.system_tests.model_selection.status=test_suite.system_tests.model_selection-module.html#status,Variable test_suite.system_tests.mol_res_spin.status=test_suite.system_tests.mol_res_spin-module.html#status,Variable test_suite.system_tests.n_state_model.status=test_suite.system_tests.n_state_model-module.html#status,Variable test_suite.system_tests.noe.status=test_suite.system_tests.noe-module.html#status,Variable test_suite.system_tests.noe_restraints.status=test_suite.system_tests.noe_restraints-module.html#status,Variable test_suite.system_tests.palmer.status=test_suite.system_tests.palmer-module.html#status,Variable test_suite.system_tests.pcs.status=test_suite.system_tests.pcs-module.html#status,Variable test_suite.system_tests.peak_lists.status=test_suite.system_tests.peak_lists-module.html#status,Variable test_suite.system_tests.pipes.status=test_suite.system_tests.pipes-module.html#status,Variable test_suite.system_tests.rdc.status=test_suite.system_tests.rdc-module.html#status,Variable test_suite.system_tests.relax_data.status=test_suite.system_tests.relax_data-module.html#status,Variable test_suite.system_tests.relax_fit.status=test_suite.system_tests.relax_fit-module.html#status,Variable test_suite.system_tests.results.status=test_suite.system_tests.results-module.html#status,Variable test_suite.system_tests.sequence.status=test_suite.system_tests.sequence-module.html#status,Variable test_suite.system_tests.state.status=test_suite.system_tests.state-module.html#status,Variable test_suite.system_tests.structure.status=test_suite.system_tests.structure-module.html#status,Variable test_suite.system_tests.unit_vectors.status=test_suite.system_tests.unit_vectors-module.html#status,Variable test_suite.test_suite_runner.status=test_suite.test_suite_runner-module.html#status,Variable test_suite.unit_tests._generic_fns._structure.test_api_base.status=test_suite.unit_tests._generic_fns._structure.test_api_base-module.html#status,Variable test_suite.unit_tests._generic_fns._structure.test_internal.status=test_suite.unit_tests._generic_fns._structure.test_internal-module.html#status,Variable test_suite.unit_tests._generic_fns._structure.test_scientific.status=test_suite.unit_tests._generic_fns._structure.test_scientific-module.html#status,Variable test_suite.unit_tests._maths_fns.test_frame_order_matrix_ops.status=test_suite.unit_tests._maths_fns.test_frame_order_matrix_ops-module.html#status,Variable test_suite.unit_tests._specific_fns._model_free.test_main.status=test_suite.unit_tests._specific_fns._model_free.test_main-module.html#status,Variable test_suite.unit_tests.relax_data_testing_base.status=test_suite.unit_tests.relax_data_testing_base-module.html#status,Variable test_suite.unit_tests.sequence_testing_base.status=test_suite.unit_tests.sequence_testing_base-module.html#status,Variable test_suite.unit_tests.state_testing_base.status=test_suite.unit_tests.state_testing_base-module.html#status,Variable version.status=version-module.html#status"><a title="auto_analyses.dauvergne_protocol.status
auto_analyses.noe.status
auto_analyses.relax_fit.status
auto_analyses.stereochem_analysis.status
data.status
generic_fns.bmrb.status
generic_fns.grace.status
generic_fns.minimise.status
generic_fns.mol_res_spin.status
generic_fns.molmol.status
generic_fns.pipes.status
generic_fns.pymol_control.status
generic_fns.result_files.status
generic_fns.script.status
generic_fns.state.status
generic_fns.structure.geometric.status
generic_fns.value.status
gui.about.status
gui.analyses.auto_model_free.status
gui.analyses.auto_noe.status
gui.analyses.auto_rx_base.status
gui.analyses.execute.status
gui.analyses.results_analysis.status
gui.analyses.status
gui.components.base_list.status
gui.components.free_file_format.status
gui.components.grid.status
gui.components.molecule.status
gui.components.relax_data.status
gui.components.relax_data_meta.status
gui.components.spectrum.status
gui.controller.status
gui.errors.status
gui.export_bmrb.status
gui.filedialog.status
gui.fonts.status
gui.icons.status
gui.input_elements.bool.status
gui.input_elements.dir.status
gui.input_elements.file.status
gui.input_elements.sequence.status
gui.input_elements.sequence_2D.status
gui.interpreter.status
gui.menu.status
gui.message.status
gui.misc.status
gui.paths.status
gui.pipe_editor.status
gui.relax_gui.status
gui.relax_prompt.status
gui.results_viewer.status
gui.spin_viewer.frame.status
gui.spin_viewer.tree.status
gui.status
gui.string_conv.status
gui.uf_objects.status
gui.wizard.status
info.Bieri11.status
info.Clore90.status
info.Delaglio95.status
info.GoddardKneller.status
info.LipariSzabo82a.status
info.LipariSzabo82b.status
info.Ref.status
info.dAuvergne06.status
info.dAuvergneGooley03.status
info.dAuvergneGooley06.status
info.dAuvergneGooley07.status
info.dAuvergneGooley08a.status
info.dAuvergneGooley08b.status
info.status
prompt.command.status
prompt.help.status
prompt.interpreter.status
prompt.uf_docstring.status
prompt.uf_objects.status
relax.status
relax_warnings.status
scons.manuals.status
setup.status
status
test_suite.gui_tests.base_classes.status
test_suite.gui_tests.bruker.status
test_suite.gui_tests.model_free.status
test_suite.gui_tests.noe.status
test_suite.gui_tests.rx.status
test_suite.gui_tests.state.status
test_suite.gui_tests.test_user_functions.status
test_suite.relax_test_loader.status
test_suite.relax_test_runner.status
test_suite.system_tests.angles.status
test_suite.system_tests.bmrb.status
test_suite.system_tests.bruker.status
test_suite.system_tests.consistency_tests.status
test_suite.system_tests.dasha.status
test_suite.system_tests.diffusion_tensor.status
test_suite.system_tests.frame_order.status
test_suite.system_tests.generic.status
test_suite.system_tests.grace.status
test_suite.system_tests.interatomic.status
test_suite.system_tests.jw_mapping.status
test_suite.system_tests.load_spins.status
test_suite.system_tests.model_elimination.status
test_suite.system_tests.model_free.status
test_suite.system_tests.model_selection.status
test_suite.system_tests.mol_res_spin.status
test_suite.system_tests.n_state_model.status
test_suite.system_tests.noe.status
test_suite.system_tests.noe_restraints.status
test_suite.system_tests.palmer.status
test_suite.system_tests.pcs.status
test_suite.system_tests.peak_lists.status
test_suite.system_tests.pipes.status
test_suite.system_tests.rdc.status
test_suite.system_tests.relax_data.status
test_suite.system_tests.relax_fit.status
test_suite.system_tests.results.status
test_suite.system_tests.sequence.status
test_suite.system_tests.state.status
test_suite.system_tests.structure.status
test_suite.system_tests.unit_vectors.status
test_suite.test_suite_runner.status
test_suite.unit_tests._generic_fns._structure.test_api_base.status
test_suite.unit_tests._generic_fns._structure.test_internal.status
test_suite.unit_tests._generic_fns._structure.test_scientific.status
test_suite.unit_tests._maths_fns.test_frame_order_matrix_ops.status
test_suite.unit_tests._specific_fns._model_free.test_main.status
test_suite.unit_tests.relax_data_testing_base.status
test_suite.unit_tests.sequence_testing_base.status
test_suite.unit_tests.state_testing_base.status
version.status" class="py-name" href="#" onclick="return doclink('link-35', 'status', 'link-35');">status</a></tt> <tt class="py-keyword">import</tt> <tt id="link-36" class="py-name" targets="Class status.Status=status.Status-class.html"><a title="status.Status" class="py-name" href="#" onclick="return doclink('link-36', 'Status', 'link-36');">Status</a></tt><tt class="py-op">;</tt> <tt id="link-37" class="py-name"><a title="auto_analyses.dauvergne_protocol.status
auto_analyses.noe.status
auto_analyses.relax_fit.status
auto_analyses.stereochem_analysis.status
data.status
generic_fns.bmrb.status
generic_fns.grace.status
generic_fns.minimise.status
generic_fns.mol_res_spin.status
generic_fns.molmol.status
generic_fns.pipes.status
generic_fns.pymol_control.status
generic_fns.result_files.status
generic_fns.script.status
generic_fns.state.status
generic_fns.structure.geometric.status
generic_fns.value.status
gui.about.status
gui.analyses.auto_model_free.status
gui.analyses.auto_noe.status
gui.analyses.auto_rx_base.status
gui.analyses.execute.status
gui.analyses.results_analysis.status
gui.analyses.status
gui.components.base_list.status
gui.components.free_file_format.status
gui.components.grid.status
gui.components.molecule.status
gui.components.relax_data.status
gui.components.relax_data_meta.status
gui.components.spectrum.status
gui.controller.status
gui.errors.status
gui.export_bmrb.status
gui.filedialog.status
gui.fonts.status
gui.icons.status
gui.input_elements.bool.status
gui.input_elements.dir.status
gui.input_elements.file.status
gui.input_elements.sequence.status
gui.input_elements.sequence_2D.status
gui.interpreter.status
gui.menu.status
gui.message.status
gui.misc.status
gui.paths.status
gui.pipe_editor.status
gui.relax_gui.status
gui.relax_prompt.status
gui.results_viewer.status
gui.spin_viewer.frame.status
gui.spin_viewer.tree.status
gui.status
gui.string_conv.status
gui.uf_objects.status
gui.wizard.status
info.Bieri11.status
info.Clore90.status
info.Delaglio95.status
info.GoddardKneller.status
info.LipariSzabo82a.status
info.LipariSzabo82b.status
info.Ref.status
info.dAuvergne06.status
info.dAuvergneGooley03.status
info.dAuvergneGooley06.status
info.dAuvergneGooley07.status
info.dAuvergneGooley08a.status
info.dAuvergneGooley08b.status
info.status
prompt.command.status
prompt.help.status
prompt.interpreter.status
prompt.uf_docstring.status
prompt.uf_objects.status
relax.status
relax_warnings.status
scons.manuals.status
setup.status
status
test_suite.gui_tests.base_classes.status
test_suite.gui_tests.bruker.status
test_suite.gui_tests.model_free.status
test_suite.gui_tests.noe.status
test_suite.gui_tests.rx.status
test_suite.gui_tests.state.status
test_suite.gui_tests.test_user_functions.status
test_suite.relax_test_loader.status
test_suite.relax_test_runner.status
test_suite.system_tests.angles.status
test_suite.system_tests.bmrb.status
test_suite.system_tests.bruker.status
test_suite.system_tests.consistency_tests.status
test_suite.system_tests.dasha.status
test_suite.system_tests.diffusion_tensor.status
test_suite.system_tests.frame_order.status
test_suite.system_tests.generic.status
test_suite.system_tests.grace.status
test_suite.system_tests.interatomic.status
test_suite.system_tests.jw_mapping.status
test_suite.system_tests.load_spins.status
test_suite.system_tests.model_elimination.status
test_suite.system_tests.model_free.status
test_suite.system_tests.model_selection.status
test_suite.system_tests.mol_res_spin.status
test_suite.system_tests.n_state_model.status
test_suite.system_tests.noe.status
test_suite.system_tests.noe_restraints.status
test_suite.system_tests.palmer.status
test_suite.system_tests.pcs.status
test_suite.system_tests.peak_lists.status
test_suite.system_tests.pipes.status
test_suite.system_tests.rdc.status
test_suite.system_tests.relax_data.status
test_suite.system_tests.relax_fit.status
test_suite.system_tests.results.status
test_suite.system_tests.sequence.status
test_suite.system_tests.state.status
test_suite.system_tests.structure.status
test_suite.system_tests.unit_vectors.status
test_suite.test_suite_runner.status
test_suite.unit_tests._generic_fns._structure.test_api_base.status
test_suite.unit_tests._generic_fns._structure.test_internal.status
test_suite.unit_tests._generic_fns._structure.test_scientific.status
test_suite.unit_tests._maths_fns.test_frame_order_matrix_ops.status
test_suite.unit_tests._specific_fns._model_free.test_main.status
test_suite.unit_tests.relax_data_testing_base.status
test_suite.unit_tests.sequence_testing_base.status
test_suite.unit_tests.state_testing_base.status
version.status" class="py-name" href="#" onclick="return doclink('link-37', 'status', 'link-35');">status</a></tt> <tt class="py-op">=</tt> <tt id="link-38" class="py-name"><a title="status.Status" class="py-name" href="#" onclick="return doclink('link-38', 'Status', 'link-36');">Status</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L41"></a><tt class="py-lineno">  41</tt>  <tt class="py-line"> </tt>
<a name="L42"></a><tt class="py-lineno">  42</tt>  <tt class="py-line"> </tt>
<a name="angles_regular"></a><div id="angles_regular-def"><a name="L43"></a><tt class="py-lineno">  43</tt> <a class="py-toggle" href="#" id="angles_regular-toggle" onclick="return toggle('angles_regular');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.geometric-module.html#angles_regular">angles_regular</a><tt class="py-op">(</tt><tt class="py-param">inc</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="angles_regular-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="angles_regular-expanded"><a name="L44"></a><tt class="py-lineno">  44</tt>  <tt class="py-line">    <tt class="py-docstring">"""Determine the spherical angles for a regular sphere point distribution.</tt> </tt>
<a name="L45"></a><tt class="py-lineno">  45</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L46"></a><tt class="py-lineno">  46</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword inc:   The number of increments in the distribution.</tt> </tt>
<a name="L47"></a><tt class="py-lineno">  47</tt>  <tt class="py-line"><tt class="py-docstring">    @type inc:      int</tt> </tt>
<a name="L48"></a><tt class="py-lineno">  48</tt>  <tt class="py-line"><tt class="py-docstring">    @return:        The phi angle array and the theta angle array.</tt> </tt>
<a name="L49"></a><tt class="py-lineno">  49</tt>  <tt class="py-line"><tt class="py-docstring">    @rtype:         array of float, array of float</tt> </tt>
<a name="L50"></a><tt class="py-lineno">  50</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L51"></a><tt class="py-lineno">  51</tt>  <tt class="py-line"> </tt>
<a name="L52"></a><tt class="py-lineno">  52</tt>  <tt class="py-line">    <tt class="py-comment"># Generate the increment values of u.</tt> </tt>
<a name="L53"></a><tt class="py-lineno">  53</tt>  <tt class="py-line">    <tt class="py-name">u</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">inc</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L54"></a><tt class="py-lineno">  54</tt>  <tt class="py-line">    <tt class="py-name">val</tt> <tt class="py-op">=</tt> <tt class="py-number">1.0</tt> <tt class="py-op">/</tt> <tt id="link-39" class="py-name" targets="Module float=float-module.html"><a title="float" class="py-name" href="#" onclick="return doclink('link-39', 'float', 'link-39');">float</a></tt><tt class="py-op">(</tt><tt class="py-name">inc</tt><tt class="py-op">)</tt> </tt>
<a name="L55"></a><tt class="py-lineno">  55</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-40" class="py-name" targets="Variable user_functions.molecule.i=user_functions.molecule-module.html#i"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-40', 'i', 'link-40');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">inc</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L56"></a><tt class="py-lineno">  56</tt>  <tt class="py-line">        <tt class="py-name">u</tt><tt class="py-op">[</tt><tt id="link-41" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-41', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-42" class="py-name"><a title="float" class="py-name" href="#" onclick="return doclink('link-42', 'float', 'link-39');">float</a></tt><tt class="py-op">(</tt><tt id="link-43" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-43', 'i', 'link-40');">i</a></tt><tt class="py-op">)</tt> <tt class="py-op">*</tt> <tt class="py-name">val</tt> </tt>
<a name="L57"></a><tt class="py-lineno">  57</tt>  <tt class="py-line"> </tt>
<a name="L58"></a><tt class="py-lineno">  58</tt>  <tt class="py-line">    <tt class="py-comment"># Generate the increment values of v.</tt> </tt>
<a name="L59"></a><tt class="py-lineno">  59</tt>  <tt class="py-line">    <tt class="py-name">v</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">inc</tt><tt class="py-op">/</tt><tt class="py-number">2</tt><tt class="py-op">+</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L60"></a><tt class="py-lineno">  60</tt>  <tt class="py-line">    <tt class="py-name">val</tt> <tt class="py-op">=</tt> <tt class="py-number">1.0</tt> <tt class="py-op">/</tt> <tt id="link-44" class="py-name"><a title="float" class="py-name" href="#" onclick="return doclink('link-44', 'float', 'link-39');">float</a></tt><tt class="py-op">(</tt><tt class="py-name">inc</tt><tt class="py-op">/</tt><tt class="py-number">2</tt><tt class="py-op">)</tt> </tt>
<a name="L61"></a><tt class="py-lineno">  61</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-45" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-45', 'i', 'link-40');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">int</tt><tt class="py-op">(</tt><tt class="py-name">inc</tt><tt class="py-op">/</tt><tt class="py-number">2</tt><tt class="py-op">+</tt><tt class="py-number">1</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L62"></a><tt class="py-lineno">  62</tt>  <tt class="py-line">        <tt class="py-name">v</tt><tt class="py-op">[</tt><tt id="link-46" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-46', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-47" class="py-name"><a title="float" class="py-name" href="#" onclick="return doclink('link-47', 'float', 'link-39');">float</a></tt><tt class="py-op">(</tt><tt id="link-48" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-48', 'i', 'link-40');">i</a></tt><tt class="py-op">)</tt> <tt class="py-op">*</tt> <tt class="py-name">val</tt> </tt>
<a name="L63"></a><tt class="py-lineno">  63</tt>  <tt class="py-line"> </tt>
<a name="L64"></a><tt class="py-lineno">  64</tt>  <tt class="py-line">    <tt class="py-comment"># Generate the distribution of spherical angles theta.</tt> </tt>
<a name="L65"></a><tt class="py-lineno">  65</tt>  <tt class="py-line">    <tt class="py-name">theta</tt> <tt class="py-op">=</tt> <tt class="py-number">2.0</tt> <tt class="py-op">*</tt> <tt class="py-name">pi</tt> <tt class="py-op">*</tt> <tt class="py-name">u</tt> </tt>
<a name="L66"></a><tt class="py-lineno">  66</tt>  <tt class="py-line"> </tt>
<a name="L67"></a><tt class="py-lineno">  67</tt>  <tt class="py-line">    <tt class="py-comment"># Generate the distribution of spherical angles phi (from bottom to top).</tt> </tt>
<a name="L68"></a><tt class="py-lineno">  68</tt>  <tt class="py-line">    <tt class="py-name">phi</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">v</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L69"></a><tt class="py-lineno">  69</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-49" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-49', 'i', 'link-40');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">v</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L70"></a><tt class="py-lineno">  70</tt>  <tt class="py-line">        <tt class="py-name">phi</tt><tt class="py-op">[</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">v</tt><tt class="py-op">)</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">-</tt><tt id="link-50" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-50', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">pi</tt> <tt class="py-op">*</tt> <tt class="py-name">v</tt><tt class="py-op">[</tt><tt id="link-51" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-51', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> </tt>
<a name="L71"></a><tt class="py-lineno">  71</tt>  <tt class="py-line"> </tt>
<a name="L72"></a><tt class="py-lineno">  72</tt>  <tt class="py-line">    <tt class="py-comment"># Return the angle arrays.</tt> </tt>
<a name="L73"></a><tt class="py-lineno">  73</tt>  <tt class="py-line">    <tt class="py-keyword">return</tt> <tt class="py-name">phi</tt><tt class="py-op">,</tt> <tt class="py-name">theta</tt> </tt>
</div><a name="L74"></a><tt class="py-lineno">  74</tt>  <tt class="py-line"> </tt>
<a name="L75"></a><tt class="py-lineno">  75</tt>  <tt class="py-line"> </tt>
<a name="angles_uniform"></a><div id="angles_uniform-def"><a name="L76"></a><tt class="py-lineno">  76</tt> <a class="py-toggle" href="#" id="angles_uniform-toggle" onclick="return toggle('angles_uniform');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.geometric-module.html#angles_uniform">angles_uniform</a><tt class="py-op">(</tt><tt class="py-param">inc</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="angles_uniform-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="angles_uniform-expanded"><a name="L77"></a><tt class="py-lineno">  77</tt>  <tt class="py-line">    <tt class="py-docstring">"""Determine the spherical angles for a uniform sphere point distribution.</tt> </tt>
<a name="L78"></a><tt class="py-lineno">  78</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L79"></a><tt class="py-lineno">  79</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword inc:   The number of increments in the distribution.</tt> </tt>
<a name="L80"></a><tt class="py-lineno">  80</tt>  <tt class="py-line"><tt class="py-docstring">    @type inc:      int</tt> </tt>
<a name="L81"></a><tt class="py-lineno">  81</tt>  <tt class="py-line"><tt class="py-docstring">    @return:        The phi angle array and the theta angle array.</tt> </tt>
<a name="L82"></a><tt class="py-lineno">  82</tt>  <tt class="py-line"><tt class="py-docstring">    @rtype:         array of float, array of float</tt> </tt>
<a name="L83"></a><tt class="py-lineno">  83</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L84"></a><tt class="py-lineno">  84</tt>  <tt class="py-line"> </tt>
<a name="L85"></a><tt class="py-lineno">  85</tt>  <tt class="py-line">    <tt class="py-comment"># Generate the increment values of u.</tt> </tt>
<a name="L86"></a><tt class="py-lineno">  86</tt>  <tt class="py-line">    <tt class="py-name">u</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">inc</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L87"></a><tt class="py-lineno">  87</tt>  <tt class="py-line">    <tt class="py-name">val</tt> <tt class="py-op">=</tt> <tt class="py-number">1.0</tt> <tt class="py-op">/</tt> <tt id="link-52" class="py-name"><a title="float" class="py-name" href="#" onclick="return doclink('link-52', 'float', 'link-39');">float</a></tt><tt class="py-op">(</tt><tt class="py-name">inc</tt><tt class="py-op">)</tt> </tt>
<a name="L88"></a><tt class="py-lineno">  88</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-53" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-53', 'i', 'link-40');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">inc</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L89"></a><tt class="py-lineno">  89</tt>  <tt class="py-line">        <tt class="py-name">u</tt><tt class="py-op">[</tt><tt id="link-54" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-54', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-55" class="py-name"><a title="float" class="py-name" href="#" onclick="return doclink('link-55', 'float', 'link-39');">float</a></tt><tt class="py-op">(</tt><tt id="link-56" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-56', 'i', 'link-40');">i</a></tt><tt class="py-op">)</tt> <tt class="py-op">*</tt> <tt class="py-name">val</tt> </tt>
<a name="L90"></a><tt class="py-lineno">  90</tt>  <tt class="py-line"> </tt>
<a name="L91"></a><tt class="py-lineno">  91</tt>  <tt class="py-line">    <tt class="py-comment"># Generate the increment values of v.</tt> </tt>
<a name="L92"></a><tt class="py-lineno">  92</tt>  <tt class="py-line">    <tt class="py-name">v</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">inc</tt><tt class="py-op">/</tt><tt class="py-number">2</tt><tt class="py-op">+</tt><tt class="py-number">2</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L93"></a><tt class="py-lineno">  93</tt>  <tt class="py-line">    <tt class="py-name">val</tt> <tt class="py-op">=</tt> <tt class="py-number">1.0</tt> <tt class="py-op">/</tt> <tt id="link-57" class="py-name"><a title="float" class="py-name" href="#" onclick="return doclink('link-57', 'float', 'link-39');">float</a></tt><tt class="py-op">(</tt><tt class="py-name">inc</tt><tt class="py-op">/</tt><tt class="py-number">2</tt><tt class="py-op">)</tt> </tt>
<a name="L94"></a><tt class="py-lineno">  94</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-58" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-58', 'i', 'link-40');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">int</tt><tt class="py-op">(</tt><tt class="py-name">inc</tt><tt class="py-op">/</tt><tt class="py-number">2</tt><tt class="py-op">)</tt><tt class="py-op">+</tt><tt class="py-number">1</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L95"></a><tt class="py-lineno">  95</tt>  <tt class="py-line">        <tt class="py-name">v</tt><tt class="py-op">[</tt><tt id="link-59" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-59', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-60" class="py-name"><a title="float" class="py-name" href="#" onclick="return doclink('link-60', 'float', 'link-39');">float</a></tt><tt class="py-op">(</tt><tt id="link-61" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-61', 'i', 'link-40');">i</a></tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> <tt class="py-op">*</tt> <tt class="py-name">val</tt> <tt class="py-op">+</tt> <tt class="py-name">val</tt><tt class="py-op">/</tt><tt class="py-number">2.0</tt> </tt>
<a name="L96"></a><tt class="py-lineno">  96</tt>  <tt class="py-line">    <tt class="py-name">v</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-number">1.0</tt> </tt>
<a name="L97"></a><tt class="py-lineno">  97</tt>  <tt class="py-line"> </tt>
<a name="L98"></a><tt class="py-lineno">  98</tt>  <tt class="py-line">    <tt class="py-comment"># Generate the distribution of spherical angles theta.</tt> </tt>
<a name="L99"></a><tt class="py-lineno">  99</tt>  <tt class="py-line">    <tt class="py-name">theta</tt> <tt class="py-op">=</tt> <tt class="py-number">2.0</tt> <tt class="py-op">*</tt> <tt class="py-name">pi</tt> <tt class="py-op">*</tt> <tt class="py-name">u</tt> </tt>
<a name="L100"></a><tt class="py-lineno"> 100</tt>  <tt class="py-line"> </tt>
<a name="L101"></a><tt class="py-lineno"> 101</tt>  <tt class="py-line">    <tt class="py-comment"># Generate the distribution of spherical angles phi.</tt> </tt>
<a name="L102"></a><tt class="py-lineno"> 102</tt>  <tt class="py-line">    <tt class="py-name">phi</tt> <tt class="py-op">=</tt> <tt class="py-name">arccos</tt><tt class="py-op">(</tt><tt class="py-number">2.0</tt> <tt class="py-op">*</tt> <tt class="py-name">v</tt> <tt class="py-op">-</tt> <tt class="py-number">1.0</tt><tt class="py-op">)</tt> </tt>
<a name="L103"></a><tt class="py-lineno"> 103</tt>  <tt class="py-line"> </tt>
<a name="L104"></a><tt class="py-lineno"> 104</tt>  <tt class="py-line">    <tt class="py-comment"># Return the angle arrays.</tt> </tt>
<a name="L105"></a><tt class="py-lineno"> 105</tt>  <tt class="py-line">    <tt class="py-keyword">return</tt> <tt class="py-name">phi</tt><tt class="py-op">,</tt> <tt class="py-name">theta</tt> </tt>
</div><a name="L106"></a><tt class="py-lineno"> 106</tt>  <tt class="py-line"> </tt>
<a name="L107"></a><tt class="py-lineno"> 107</tt>  <tt class="py-line"> </tt>
<a name="autoscale_tensor"></a><div id="autoscale_tensor-def"><a name="L108"></a><tt class="py-lineno"> 108</tt> <a class="py-toggle" href="#" id="autoscale_tensor-toggle" onclick="return toggle('autoscale_tensor');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.geometric-module.html#autoscale_tensor">autoscale_tensor</a><tt class="py-op">(</tt><tt class="py-param">method</tt><tt class="py-op">=</tt><tt class="py-string">'mass'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="autoscale_tensor-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="autoscale_tensor-expanded"><a name="L109"></a><tt class="py-lineno"> 109</tt>  <tt class="py-line">    <tt class="py-docstring">"""Automatically determine an appropriate scaling factor for display of the diffusion tensor.</tt> </tt>
<a name="L110"></a><tt class="py-lineno"> 110</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L111"></a><tt class="py-lineno"> 111</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword method:    The method used to determine the scaling of the diffusion tensor object.</tt> </tt>
<a name="L112"></a><tt class="py-lineno"> 112</tt>  <tt class="py-line"><tt class="py-docstring">    @type method:       str</tt> </tt>
<a name="L113"></a><tt class="py-lineno"> 113</tt>  <tt class="py-line"><tt class="py-docstring">    @return:            The scaling factor.</tt> </tt>
<a name="L114"></a><tt class="py-lineno"> 114</tt>  <tt class="py-line"><tt class="py-docstring">    @rtype:             float</tt> </tt>
<a name="L115"></a><tt class="py-lineno"> 115</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L116"></a><tt class="py-lineno"> 116</tt>  <tt class="py-line"> </tt>
<a name="L117"></a><tt class="py-lineno"> 117</tt>  <tt class="py-line">    <tt class="py-comment"># Centre of mass method.</tt> </tt>
<a name="L118"></a><tt class="py-lineno"> 118</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-62" class="py-name" targets="Module bmrblib.experimental_details.method=bmrblib.experimental_details.method-module.html"><a title="bmrblib.experimental_details.method" class="py-name" href="#" onclick="return doclink('link-62', 'method', 'link-62');">method</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'mass'</tt><tt class="py-op">:</tt> </tt>
<a name="L119"></a><tt class="py-lineno"> 119</tt>  <tt class="py-line">        <tt class="py-name">com</tt><tt class="py-op">,</tt> <tt id="link-63" class="py-name"><a title="generic_fns.structure.mass" class="py-name" href="#" onclick="return doclink('link-63', 'mass', 'link-16');">mass</a></tt> <tt class="py-op">=</tt> <tt id="link-64" class="py-name"><a title="generic_fns.structure.mass.centre_of_mass" class="py-name" href="#" onclick="return doclink('link-64', 'centre_of_mass', 'link-17');">centre_of_mass</a></tt><tt class="py-op">(</tt><tt class="py-name">return_mass</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L120"></a><tt class="py-lineno"> 120</tt>  <tt class="py-line">        <tt class="py-name">scale</tt> <tt class="py-op">=</tt> <tt id="link-65" class="py-name"><a title="generic_fns.structure.mass" class="py-name" href="#" onclick="return doclink('link-65', 'mass', 'link-16');">mass</a></tt> <tt class="py-op">*</tt> <tt class="py-number">6.8e-11</tt> </tt>
<a name="L121"></a><tt class="py-lineno"> 121</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">scale</tt> </tt>
<a name="L122"></a><tt class="py-lineno"> 122</tt>  <tt class="py-line"> </tt>
<a name="L123"></a><tt class="py-lineno"> 123</tt>  <tt class="py-line">    <tt class="py-comment"># Autoscaling method.</tt> </tt>
<a name="L124"></a><tt class="py-lineno"> 124</tt>  <tt class="py-line">    <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-66" class="py-name"><a title="relax_warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-66', 'RelaxWarning', 'link-34');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"Autoscale method %s not implimented. Reverting to scale=1.8e-6 A.s"</tt> <tt class="py-op">%</tt> <tt id="link-67" class="py-name"><a title="bmrblib.experimental_details.method" class="py-name" href="#" onclick="return doclink('link-67', 'method', 'link-62');">method</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L125"></a><tt class="py-lineno"> 125</tt>  <tt class="py-line">    <tt class="py-keyword">return</tt> <tt class="py-number">1.8e-6</tt> </tt>
</div><a name="L126"></a><tt class="py-lineno"> 126</tt>  <tt class="py-line"> </tt>
<a name="L127"></a><tt class="py-lineno"> 127</tt>  <tt class="py-line"> </tt>
<a name="cone_edge"></a><div id="cone_edge-def"><a name="L128"></a><tt class="py-lineno"> 128</tt> <a class="py-toggle" href="#" id="cone_edge-toggle" onclick="return toggle('cone_edge');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.geometric-module.html#cone_edge">cone_edge</a><tt class="py-op">(</tt><tt class="py-param">mol</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">cone</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">res_name</tt><tt class="py-op">=</tt><tt class="py-string">'CON'</tt><tt class="py-op">,</tt> <tt class="py-param">res_num</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">chain_id</tt><tt class="py-op">=</tt><tt class="py-string">''</tt><tt class="py-op">,</tt> <tt class="py-param">apex</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">axis</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">R</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">scale</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">inc</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">distribution</tt><tt class="py-op">=</tt><tt class="py-string">'uniform'</tt><tt class="py-op">,</tt> <tt class="py-param">debug</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="cone_edge-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="cone_edge-expanded"><a name="L129"></a><tt class="py-lineno"> 129</tt>  <tt class="py-line">    <tt class="py-docstring">"""Add a residue to the atomic data representing a cone of the given angle.</tt> </tt>
<a name="L130"></a><tt class="py-lineno"> 130</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L131"></a><tt class="py-lineno"> 131</tt>  <tt class="py-line"><tt class="py-docstring">    A series of vectors totalling the number of increments and starting at the origin are equally spaced around the cone axis.  The atoms representing neighbouring vectors will be directly bonded together.  This will generate an object representing the outer edge of a cone.</tt> </tt>
<a name="L132"></a><tt class="py-lineno"> 132</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L133"></a><tt class="py-lineno"> 133</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L134"></a><tt class="py-lineno"> 134</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword mol:           The molecule container.</tt> </tt>
<a name="L135"></a><tt class="py-lineno"> 135</tt>  <tt class="py-line"><tt class="py-docstring">    @type mol:              MolContainer instance</tt> </tt>
<a name="L136"></a><tt class="py-lineno"> 136</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword cone:          The cone object.  This should provide the limit_check() method with determines the limits of the distribution accepting two arguments, the polar angle phi and the azimuthal angle theta, and return True if the point is in the limits or False if outside.  It should also provide the phi_max() method for returning the phi value for the given theta.</tt> </tt>
<a name="L137"></a><tt class="py-lineno"> 137</tt>  <tt class="py-line"><tt class="py-docstring">    @type cone:             class instance</tt> </tt>
<a name="L138"></a><tt class="py-lineno"> 138</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword res_name:      The residue name.</tt> </tt>
<a name="L139"></a><tt class="py-lineno"> 139</tt>  <tt class="py-line"><tt class="py-docstring">    @type res_name:         str</tt> </tt>
<a name="L140"></a><tt class="py-lineno"> 140</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword res_num:       The residue number.</tt> </tt>
<a name="L141"></a><tt class="py-lineno"> 141</tt>  <tt class="py-line"><tt class="py-docstring">    @type res_num:          int</tt> </tt>
<a name="L142"></a><tt class="py-lineno"> 142</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword chain_id:      The chain identifier.</tt> </tt>
<a name="L143"></a><tt class="py-lineno"> 143</tt>  <tt class="py-line"><tt class="py-docstring">    @type chain_id:         str</tt> </tt>
<a name="L144"></a><tt class="py-lineno"> 144</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword apex:          The apex of the cone.</tt> </tt>
<a name="L145"></a><tt class="py-lineno"> 145</tt>  <tt class="py-line"><tt class="py-docstring">    @type apex:             numpy array, len 3</tt> </tt>
<a name="L146"></a><tt class="py-lineno"> 146</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword axis:          The central axis of the cone.  If supplied, then this arg will be used to construct the rotation matrix.</tt> </tt>
<a name="L147"></a><tt class="py-lineno"> 147</tt>  <tt class="py-line"><tt class="py-docstring">    @type axis:             numpy array, len 3</tt> </tt>
<a name="L148"></a><tt class="py-lineno"> 148</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword R:             A 3x3 rotation matrix.  If the axis arg supplied, then this matrix will be ignored.</tt> </tt>
<a name="L149"></a><tt class="py-lineno"> 149</tt>  <tt class="py-line"><tt class="py-docstring">    @type R:                3x3 numpy array</tt> </tt>
<a name="L150"></a><tt class="py-lineno"> 150</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword scale:         The scaling factor to stretch all points by.</tt> </tt>
<a name="L151"></a><tt class="py-lineno"> 151</tt>  <tt class="py-line"><tt class="py-docstring">    @type scale:            float</tt> </tt>
<a name="L152"></a><tt class="py-lineno"> 152</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword inc:           The number of increments or number of vectors used to generate the outer edge of the cone.</tt> </tt>
<a name="L153"></a><tt class="py-lineno"> 153</tt>  <tt class="py-line"><tt class="py-docstring">    @type inc:              int</tt> </tt>
<a name="L154"></a><tt class="py-lineno"> 154</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword distribution:  The type of point distribution to use.  This can be 'uniform' or 'regular'.</tt> </tt>
<a name="L155"></a><tt class="py-lineno"> 155</tt>  <tt class="py-line"><tt class="py-docstring">    @type distribution:     str</tt> </tt>
<a name="L156"></a><tt class="py-lineno"> 156</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L157"></a><tt class="py-lineno"> 157</tt>  <tt class="py-line"> </tt>
<a name="L158"></a><tt class="py-lineno"> 158</tt>  <tt class="py-line">    <tt class="py-comment"># The atom numbers (and indices).</tt> </tt>
<a name="L159"></a><tt class="py-lineno"> 159</tt>  <tt class="py-line">    <tt class="py-name">atom_num</tt> <tt class="py-op">=</tt> <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt class="py-name">atom_num</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">+</tt><tt class="py-number">1</tt> </tt>
<a name="L160"></a><tt class="py-lineno"> 160</tt>  <tt class="py-line"> </tt>
<a name="L161"></a><tt class="py-lineno"> 161</tt>  <tt class="py-line">    <tt class="py-comment"># Add an atom for the cone apex.</tt> </tt>
<a name="L162"></a><tt class="py-lineno"> 162</tt>  <tt class="py-line">    <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-68" class="py-name" targets="Method generic_fns.structure.internal.MolContainer.atom_add()=generic_fns.structure.internal.MolContainer-class.html#atom_add"><a title="generic_fns.structure.internal.MolContainer.atom_add" class="py-name" href="#" onclick="return doclink('link-68', 'atom_add', 'link-68');">atom_add</a></tt><tt class="py-op">(</tt><tt class="py-name">pdb_record</tt><tt class="py-op">=</tt><tt class="py-string">'HETATM'</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt class="py-string">'APX'</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">res_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt><tt class="py-op">=</tt><tt class="py-name">apex</tt><tt class="py-op">,</tt> <tt class="py-name">segment_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">element</tt><tt class="py-op">=</tt><tt class="py-string">'H'</tt><tt class="py-op">)</tt> </tt>
<a name="L163"></a><tt class="py-lineno"> 163</tt>  <tt class="py-line">    <tt class="py-name">origin_atom</tt> <tt class="py-op">=</tt> <tt class="py-name">atom_num</tt> </tt>
<a name="L164"></a><tt class="py-lineno"> 164</tt>  <tt class="py-line"> </tt>
<a name="L165"></a><tt class="py-lineno"> 165</tt>  <tt class="py-line">    <tt class="py-comment"># Get the polar and azimuthal angles for the distribution.</tt> </tt>
<a name="L166"></a><tt class="py-lineno"> 166</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">distribution</tt> <tt class="py-op">==</tt> <tt class="py-string">'uniform'</tt><tt class="py-op">:</tt> </tt>
<a name="L167"></a><tt class="py-lineno"> 167</tt>  <tt class="py-line">        <tt class="py-name">phi</tt><tt class="py-op">,</tt> <tt class="py-name">theta</tt> <tt class="py-op">=</tt> <tt id="link-69" class="py-name" targets="Function generic_fns.structure.geometric.angles_uniform()=generic_fns.structure.geometric-module.html#angles_uniform"><a title="generic_fns.structure.geometric.angles_uniform" class="py-name" href="#" onclick="return doclink('link-69', 'angles_uniform', 'link-69');">angles_uniform</a></tt><tt class="py-op">(</tt><tt class="py-name">inc</tt><tt class="py-op">)</tt> </tt>
<a name="L168"></a><tt class="py-lineno"> 168</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L169"></a><tt class="py-lineno"> 169</tt>  <tt class="py-line">        <tt class="py-name">phi</tt><tt class="py-op">,</tt> <tt class="py-name">theta</tt> <tt class="py-op">=</tt> <tt id="link-70" class="py-name" targets="Function generic_fns.structure.geometric.angles_regular()=generic_fns.structure.geometric-module.html#angles_regular"><a title="generic_fns.structure.geometric.angles_regular" class="py-name" href="#" onclick="return doclink('link-70', 'angles_regular', 'link-70');">angles_regular</a></tt><tt class="py-op">(</tt><tt class="py-name">inc</tt><tt class="py-op">)</tt> </tt>
<a name="L170"></a><tt class="py-lineno"> 170</tt>  <tt class="py-line"> </tt>
<a name="L171"></a><tt class="py-lineno"> 171</tt>  <tt class="py-line">    <tt class="py-comment"># Initialise the rotation matrix.</tt> </tt>
<a name="L172"></a><tt class="py-lineno"> 172</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-71" class="py-name" targets="Variable test_suite.unit_tests._maths_fns.test_rotation_matrix.R=test_suite.unit_tests._maths_fns.test_rotation_matrix-module.html#R"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-71', 'R', 'link-71');">R</a></tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L173"></a><tt class="py-lineno"> 173</tt>  <tt class="py-line">        <tt id="link-72" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-72', 'R', 'link-71');">R</a></tt> <tt class="py-op">=</tt> <tt class="py-name">eye</tt><tt class="py-op">(</tt><tt class="py-number">3</tt><tt class="py-op">)</tt> </tt>
<a name="L174"></a><tt class="py-lineno"> 174</tt>  <tt class="py-line"> </tt>
<a name="L175"></a><tt class="py-lineno"> 175</tt>  <tt class="py-line">    <tt class="py-comment"># Get the rotation matrix.</tt> </tt>
<a name="L176"></a><tt class="py-lineno"> 176</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">axis</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L177"></a><tt class="py-lineno"> 177</tt>  <tt class="py-line">        <tt id="link-73" class="py-name"><a title="maths_fns.rotation_matrix.two_vect_to_R" class="py-name" href="#" onclick="return doclink('link-73', 'two_vect_to_R', 'link-24');">two_vect_to_R</a></tt><tt class="py-op">(</tt><tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">axis</tt><tt class="py-op">,</tt> <tt id="link-74" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-74', 'R', 'link-71');">R</a></tt><tt class="py-op">)</tt> </tt>
<a name="L178"></a><tt class="py-lineno"> 178</tt>  <tt class="py-line"> </tt>
<a name="L179"></a><tt class="py-lineno"> 179</tt>  <tt class="py-line">    <tt class="py-comment"># Determine the maximum phi values and the indices of the point just above the edge.</tt> </tt>
<a name="L180"></a><tt class="py-lineno"> 180</tt>  <tt class="py-line">    <tt id="link-75" class="py-name" targets="Method generic_fns.structure.cones.Cosine.phi_max()=generic_fns.structure.cones.Cosine-class.html#phi_max,Method generic_fns.structure.cones.Elliptic.phi_max()=generic_fns.structure.cones.Elliptic-class.html#phi_max,Method generic_fns.structure.cones.Iso_cone.phi_max()=generic_fns.structure.cones.Iso_cone-class.html#phi_max,Method generic_fns.structure.cones.Pseudo_elliptic.phi_max()=generic_fns.structure.cones.Pseudo_elliptic-class.html#phi_max,Method generic_fns.structure.cones.Pseudo_elliptic2.phi_max()=generic_fns.structure.cones.Pseudo_elliptic2-class.html#phi_max,Method generic_fns.structure.cones.Square.phi_max()=generic_fns.structure.cones.Square-class.html#phi_max,Method generic_fns.structure.cones.Zig_zag.phi_max()=generic_fns.structure.cones.Zig_zag-class.html#phi_max"><a title="generic_fns.structure.cones.Cosine.phi_max
generic_fns.structure.cones.Elliptic.phi_max
generic_fns.structure.cones.Iso_cone.phi_max
generic_fns.structure.cones.Pseudo_elliptic.phi_max
generic_fns.structure.cones.Pseudo_elliptic2.phi_max
generic_fns.structure.cones.Square.phi_max
generic_fns.structure.cones.Zig_zag.phi_max" class="py-name" href="#" onclick="return doclink('link-75', 'phi_max', 'link-75');">phi_max</a></tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L181"></a><tt class="py-lineno"> 181</tt>  <tt class="py-line">    <tt class="py-name">edge_index</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">int</tt><tt class="py-op">)</tt> </tt>
<a name="L182"></a><tt class="py-lineno"> 182</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-76" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-76', 'i', 'link-40');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L183"></a><tt class="py-lineno"> 183</tt>  <tt class="py-line">        <tt class="py-comment"># Get the polar angle for the longitude edge atom.</tt> </tt>
<a name="L184"></a><tt class="py-lineno"> 184</tt>  <tt class="py-line">        <tt id="link-77" class="py-name"><a title="generic_fns.structure.cones.Cosine.phi_max
generic_fns.structure.cones.Elliptic.phi_max
generic_fns.structure.cones.Iso_cone.phi_max
generic_fns.structure.cones.Pseudo_elliptic.phi_max
generic_fns.structure.cones.Pseudo_elliptic2.phi_max
generic_fns.structure.cones.Square.phi_max
generic_fns.structure.cones.Zig_zag.phi_max" class="py-name" href="#" onclick="return doclink('link-77', 'phi_max', 'link-75');">phi_max</a></tt><tt class="py-op">[</tt><tt id="link-78" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-78', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">cone</tt><tt class="py-op">.</tt><tt id="link-79" class="py-name"><a title="generic_fns.structure.cones.Cosine.phi_max
generic_fns.structure.cones.Elliptic.phi_max
generic_fns.structure.cones.Iso_cone.phi_max
generic_fns.structure.cones.Pseudo_elliptic.phi_max
generic_fns.structure.cones.Pseudo_elliptic2.phi_max
generic_fns.structure.cones.Square.phi_max
generic_fns.structure.cones.Zig_zag.phi_max" class="py-name" href="#" onclick="return doclink('link-79', 'phi_max', 'link-75');">phi_max</a></tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">[</tt><tt id="link-80" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-80', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L185"></a><tt class="py-lineno"> 185</tt>  <tt class="py-line"> </tt>
<a name="L186"></a><tt class="py-lineno"> 186</tt>  <tt class="py-line">        <tt class="py-comment"># The index.</tt> </tt>
<a name="L187"></a><tt class="py-lineno"> 187</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">j</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">phi</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L188"></a><tt class="py-lineno"> 188</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">phi</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">]</tt> <tt class="py-op">&lt;=</tt> <tt id="link-81" class="py-name"><a title="generic_fns.structure.cones.Cosine.phi_max
generic_fns.structure.cones.Elliptic.phi_max
generic_fns.structure.cones.Iso_cone.phi_max
generic_fns.structure.cones.Pseudo_elliptic.phi_max
generic_fns.structure.cones.Pseudo_elliptic2.phi_max
generic_fns.structure.cones.Square.phi_max
generic_fns.structure.cones.Zig_zag.phi_max" class="py-name" href="#" onclick="return doclink('link-81', 'phi_max', 'link-75');">phi_max</a></tt><tt class="py-op">[</tt><tt id="link-82" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-82', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L189"></a><tt class="py-lineno"> 189</tt>  <tt class="py-line">                <tt class="py-name">edge_index</tt><tt class="py-op">[</tt><tt id="link-83" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-83', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">j</tt> </tt>
<a name="L190"></a><tt class="py-lineno"> 190</tt>  <tt class="py-line">                <tt class="py-keyword">break</tt> </tt>
<a name="L191"></a><tt class="py-lineno"> 191</tt>  <tt class="py-line"> </tt>
<a name="L192"></a><tt class="py-lineno"> 192</tt>  <tt class="py-line">    <tt class="py-comment"># Reverse edge index.</tt> </tt>
<a name="L193"></a><tt class="py-lineno"> 193</tt>  <tt class="py-line">    <tt class="py-name">edge_index_rev</tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">phi</tt><tt class="py-op">)</tt> <tt class="py-op">-</tt> <tt class="py-number">1</tt> <tt class="py-op">-</tt> <tt class="py-name">edge_index</tt> </tt>
<a name="L194"></a><tt class="py-lineno"> 194</tt>  <tt class="py-line"> </tt>
<a name="L195"></a><tt class="py-lineno"> 195</tt>  <tt class="py-line">    <tt class="py-comment"># Move around the azimuth.</tt> </tt>
<a name="L196"></a><tt class="py-lineno"> 196</tt>  <tt class="py-line">    <tt class="py-name">atom_num</tt> <tt class="py-op">=</tt> <tt class="py-name">atom_num</tt> <tt class="py-op">+</tt> <tt class="py-number">1</tt> </tt>
<a name="L197"></a><tt class="py-lineno"> 197</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-84" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-84', 'i', 'link-40');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L198"></a><tt class="py-lineno"> 198</tt>  <tt class="py-line">        <tt class="py-comment"># The vector in the unrotated frame.</tt> </tt>
<a name="L199"></a><tt class="py-lineno"> 199</tt>  <tt class="py-line">        <tt class="py-name">x</tt> <tt class="py-op">=</tt> <tt class="py-name">cos</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">[</tt><tt id="link-85" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-85', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> <tt class="py-op">*</tt> <tt class="py-name">sin</tt><tt class="py-op">(</tt><tt id="link-86" class="py-name"><a title="generic_fns.structure.cones.Cosine.phi_max
generic_fns.structure.cones.Elliptic.phi_max
generic_fns.structure.cones.Iso_cone.phi_max
generic_fns.structure.cones.Pseudo_elliptic.phi_max
generic_fns.structure.cones.Pseudo_elliptic2.phi_max
generic_fns.structure.cones.Square.phi_max
generic_fns.structure.cones.Zig_zag.phi_max" class="py-name" href="#" onclick="return doclink('link-86', 'phi_max', 'link-75');">phi_max</a></tt><tt class="py-op">[</tt><tt id="link-87" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-87', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L200"></a><tt class="py-lineno"> 200</tt>  <tt class="py-line">        <tt class="py-name">y</tt> <tt class="py-op">=</tt> <tt class="py-name">sin</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">[</tt><tt id="link-88" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-88', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">*</tt> <tt class="py-name">sin</tt><tt class="py-op">(</tt><tt id="link-89" class="py-name"><a title="generic_fns.structure.cones.Cosine.phi_max
generic_fns.structure.cones.Elliptic.phi_max
generic_fns.structure.cones.Iso_cone.phi_max
generic_fns.structure.cones.Pseudo_elliptic.phi_max
generic_fns.structure.cones.Pseudo_elliptic2.phi_max
generic_fns.structure.cones.Square.phi_max
generic_fns.structure.cones.Zig_zag.phi_max" class="py-name" href="#" onclick="return doclink('link-89', 'phi_max', 'link-75');">phi_max</a></tt><tt class="py-op">[</tt><tt id="link-90" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-90', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L201"></a><tt class="py-lineno"> 201</tt>  <tt class="py-line">        <tt class="py-name">z</tt> <tt class="py-op">=</tt> <tt class="py-name">cos</tt><tt class="py-op">(</tt><tt id="link-91" class="py-name"><a title="generic_fns.structure.cones.Cosine.phi_max
generic_fns.structure.cones.Elliptic.phi_max
generic_fns.structure.cones.Iso_cone.phi_max
generic_fns.structure.cones.Pseudo_elliptic.phi_max
generic_fns.structure.cones.Pseudo_elliptic2.phi_max
generic_fns.structure.cones.Square.phi_max
generic_fns.structure.cones.Zig_zag.phi_max" class="py-name" href="#" onclick="return doclink('link-91', 'phi_max', 'link-75');">phi_max</a></tt><tt class="py-op">[</tt><tt id="link-92" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-92', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L202"></a><tt class="py-lineno"> 202</tt>  <tt class="py-line">        <tt class="py-name">vector</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-name">x</tt><tt class="py-op">,</tt> <tt class="py-name">y</tt><tt class="py-op">,</tt> <tt class="py-name">z</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L203"></a><tt class="py-lineno"> 203</tt>  <tt class="py-line"> </tt>
<a name="L204"></a><tt class="py-lineno"> 204</tt>  <tt class="py-line">        <tt class="py-comment"># Rotate the vector.</tt> </tt>
<a name="L205"></a><tt class="py-lineno"> 205</tt>  <tt class="py-line">        <tt class="py-name">vector</tt> <tt class="py-op">=</tt> <tt class="py-name">dot</tt><tt class="py-op">(</tt><tt id="link-93" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-93', 'R', 'link-71');">R</a></tt><tt class="py-op">,</tt> <tt class="py-name">vector</tt><tt class="py-op">)</tt> </tt>
<a name="L206"></a><tt class="py-lineno"> 206</tt>  <tt class="py-line"> </tt>
<a name="L207"></a><tt class="py-lineno"> 207</tt>  <tt class="py-line">        <tt class="py-comment"># The atom id.</tt> </tt>
<a name="L208"></a><tt class="py-lineno"> 208</tt>  <tt class="py-line">        <tt class="py-name">atom_id</tt> <tt class="py-op">=</tt> <tt class="py-string">'T'</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt id="link-94" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-94', 'i', 'link-40');">i</a></tt><tt class="py-op">)</tt> </tt>
<a name="L209"></a><tt class="py-lineno"> 209</tt>  <tt class="py-line"> </tt>
<a name="L210"></a><tt class="py-lineno"> 210</tt>  <tt class="py-line">        <tt class="py-comment"># The atom position.</tt> </tt>
<a name="L211"></a><tt class="py-lineno"> 211</tt>  <tt class="py-line">        <tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt class="py-name">apex</tt><tt class="py-op">+</tt><tt class="py-name">vector</tt><tt class="py-op">*</tt><tt class="py-name">scale</tt> </tt>
<a name="L212"></a><tt class="py-lineno"> 212</tt>  <tt class="py-line"> </tt>
<a name="L213"></a><tt class="py-lineno"> 213</tt>  <tt class="py-line">        <tt class="py-comment"># Debugging.</tt> </tt>
<a name="L214"></a><tt class="py-lineno"> 214</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">debug</tt><tt class="py-op">:</tt> </tt>
<a name="L215"></a><tt class="py-lineno"> 215</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"i: %s; theta: %s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt id="link-95" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-95', 'i', 'link-40');">i</a></tt><tt class="py-op">,</tt> <tt class="py-name">theta</tt><tt class="py-op">[</tt><tt id="link-96" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-96', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L216"></a><tt class="py-lineno"> 216</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%sAdding atom %s."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">" "</tt><tt class="py-op">*</tt><tt class="py-number">4</tt><tt class="py-op">,</tt> <tt id="link-97" class="py-name" targets="Function generic_fns.structure.geometric.get_proton_name()=generic_fns.structure.geometric-module.html#get_proton_name"><a title="generic_fns.structure.geometric.get_proton_name" class="py-name" href="#" onclick="return doclink('link-97', 'get_proton_name', 'link-97');">get_proton_name</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_num</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L217"></a><tt class="py-lineno"> 217</tt>  <tt class="py-line"> </tt>
<a name="L218"></a><tt class="py-lineno"> 218</tt>  <tt class="py-line">        <tt class="py-comment"># Add the vector as a H atom of the cone residue.</tt> </tt>
<a name="L219"></a><tt class="py-lineno"> 219</tt>  <tt class="py-line">        <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-98" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_add" class="py-name" href="#" onclick="return doclink('link-98', 'atom_add', 'link-68');">atom_add</a></tt><tt class="py-op">(</tt><tt class="py-name">pdb_record</tt><tt class="py-op">=</tt><tt class="py-string">'HETATM'</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt id="link-99" class="py-name"><a title="generic_fns.structure.geometric.get_proton_name" class="py-name" href="#" onclick="return doclink('link-99', 'get_proton_name', 'link-97');">get_proton_name</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_num</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">res_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt><tt class="py-op">=</tt><tt class="py-name">pos</tt><tt class="py-op">,</tt> <tt class="py-name">segment_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">element</tt><tt class="py-op">=</tt><tt class="py-string">'H'</tt><tt class="py-op">)</tt> </tt>
<a name="L220"></a><tt class="py-lineno"> 220</tt>  <tt class="py-line"> </tt>
<a name="L221"></a><tt class="py-lineno"> 221</tt>  <tt class="py-line">        <tt class="py-comment"># Join the longitude atom to the cone apex.</tt> </tt>
<a name="L222"></a><tt class="py-lineno"> 222</tt>  <tt class="py-line">        <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-100" class="py-name" targets="Method generic_fns.structure.internal.MolContainer.atom_connect()=generic_fns.structure.internal.MolContainer-class.html#atom_connect"><a title="generic_fns.structure.internal.MolContainer.atom_connect" class="py-name" href="#" onclick="return doclink('link-100', 'atom_connect', 'link-100');">atom_connect</a></tt><tt class="py-op">(</tt><tt class="py-name">index1</tt><tt class="py-op">=</tt><tt class="py-name">origin_atom</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">index2</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L223"></a><tt class="py-lineno"> 223</tt>  <tt class="py-line"> </tt>
<a name="L224"></a><tt class="py-lineno"> 224</tt>  <tt class="py-line">        <tt class="py-comment"># Increment the atom number.</tt> </tt>
<a name="L225"></a><tt class="py-lineno"> 225</tt>  <tt class="py-line">        <tt class="py-name">atom_num</tt> <tt class="py-op">=</tt> <tt class="py-name">atom_num</tt> <tt class="py-op">+</tt> <tt class="py-number">1</tt> </tt>
<a name="L226"></a><tt class="py-lineno"> 226</tt>  <tt class="py-line"> </tt>
<a name="L227"></a><tt class="py-lineno"> 227</tt>  <tt class="py-line">        <tt class="py-comment"># Add latitude atoms for a smoother cone edge and better stitching to the cap.</tt> </tt>
<a name="L228"></a><tt class="py-lineno"> 228</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">j</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">phi</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L229"></a><tt class="py-lineno"> 229</tt>  <tt class="py-line">            <tt class="py-comment"># The index for the direction top to bottom!</tt> </tt>
<a name="L230"></a><tt class="py-lineno"> 230</tt>  <tt class="py-line">            <tt class="py-name">k</tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">phi</tt><tt class="py-op">)</tt> <tt class="py-op">-</tt> <tt class="py-number">1</tt> <tt class="py-op">-</tt> <tt class="py-name">j</tt> </tt>
<a name="L231"></a><tt class="py-lineno"> 231</tt>  <tt class="py-line"> </tt>
<a name="L232"></a><tt class="py-lineno"> 232</tt>  <tt class="py-line">            <tt class="py-comment"># Debugging.</tt> </tt>
<a name="L233"></a><tt class="py-lineno"> 233</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">debug</tt><tt class="py-op">:</tt> </tt>
<a name="L234"></a><tt class="py-lineno"> 234</tt>  <tt class="py-line">                <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%sj: %s; phi: %-20s; k: %s; phi: %-20s; phi_max: %-20s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">" "</tt><tt class="py-op">*</tt><tt class="py-number">4</tt><tt class="py-op">,</tt> <tt class="py-name">j</tt><tt class="py-op">,</tt> <tt class="py-name">phi</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">k</tt><tt class="py-op">,</tt> <tt class="py-name">phi</tt><tt class="py-op">[</tt><tt class="py-name">k</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt id="link-101" class="py-name"><a title="generic_fns.structure.cones.Cosine.phi_max
generic_fns.structure.cones.Elliptic.phi_max
generic_fns.structure.cones.Iso_cone.phi_max
generic_fns.structure.cones.Pseudo_elliptic.phi_max
generic_fns.structure.cones.Pseudo_elliptic2.phi_max
generic_fns.structure.cones.Square.phi_max
generic_fns.structure.cones.Zig_zag.phi_max" class="py-name" href="#" onclick="return doclink('link-101', 'phi_max', 'link-75');">phi_max</a></tt><tt class="py-op">[</tt><tt id="link-102" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-102', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L235"></a><tt class="py-lineno"> 235</tt>  <tt class="py-line"> </tt>
<a name="L236"></a><tt class="py-lineno"> 236</tt>  <tt class="py-line">            <tt class="py-comment"># No edge.</tt> </tt>
<a name="L237"></a><tt class="py-lineno"> 237</tt>  <tt class="py-line">            <tt class="py-name">skip</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L238"></a><tt class="py-lineno"> 238</tt>  <tt class="py-line"> </tt>
<a name="L239"></a><tt class="py-lineno"> 239</tt>  <tt class="py-line">            <tt class="py-comment"># Forward edge (skip when the latitude is phi max).</tt> </tt>
<a name="L240"></a><tt class="py-lineno"> 240</tt>  <tt class="py-line">            <tt class="py-name">fwd_index</tt> <tt class="py-op">=</tt> <tt id="link-103" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-103', 'i', 'link-40');">i</a></tt><tt class="py-op">+</tt><tt class="py-number">1</tt> </tt>
<a name="L241"></a><tt class="py-lineno"> 241</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-104" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-104', 'i', 'link-40');">i</a></tt> <tt class="py-op">==</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">)</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">:</tt> </tt>
<a name="L242"></a><tt class="py-lineno"> 242</tt>  <tt class="py-line">                <tt class="py-name">fwd_index</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L243"></a><tt class="py-lineno"> 243</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">j</tt> <tt class="py-op">&gt;=</tt> <tt class="py-name">edge_index</tt><tt class="py-op">[</tt><tt id="link-105" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-105', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> <tt class="py-keyword">and</tt> <tt class="py-name">j</tt> <tt class="py-op">&lt;</tt> <tt class="py-name">edge_index</tt><tt class="py-op">[</tt><tt class="py-name">fwd_index</tt><tt class="py-op">]</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">abs</tt><tt class="py-op">(</tt><tt id="link-106" class="py-name"><a title="generic_fns.structure.cones.Cosine.phi_max
generic_fns.structure.cones.Elliptic.phi_max
generic_fns.structure.cones.Iso_cone.phi_max
generic_fns.structure.cones.Pseudo_elliptic.phi_max
generic_fns.structure.cones.Pseudo_elliptic2.phi_max
generic_fns.structure.cones.Square.phi_max
generic_fns.structure.cones.Zig_zag.phi_max" class="py-name" href="#" onclick="return doclink('link-106', 'phi_max', 'link-75');">phi_max</a></tt><tt class="py-op">[</tt><tt class="py-name">fwd_index</tt><tt class="py-op">]</tt> <tt class="py-op">-</tt> <tt class="py-name">phi</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> <tt class="py-op">&lt;</tt> <tt class="py-number">1e-6</tt><tt class="py-op">:</tt> </tt>
<a name="L244"></a><tt class="py-lineno"> 244</tt>  <tt class="py-line">                <tt class="py-comment"># Debugging.</tt> </tt>
<a name="L245"></a><tt class="py-lineno"> 245</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">debug</tt><tt class="py-op">:</tt> </tt>
<a name="L246"></a><tt class="py-lineno"> 246</tt>  <tt class="py-line">                    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%sForward edge."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">" "</tt><tt class="py-op">*</tt><tt class="py-number">8</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L247"></a><tt class="py-lineno"> 247</tt>  <tt class="py-line"> </tt>
<a name="L248"></a><tt class="py-lineno"> 248</tt>  <tt class="py-line">                <tt class="py-comment"># Edge found.</tt> </tt>
<a name="L249"></a><tt class="py-lineno"> 249</tt>  <tt class="py-line">                <tt class="py-name">skip</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L250"></a><tt class="py-lineno"> 250</tt>  <tt class="py-line"> </tt>
<a name="L251"></a><tt class="py-lineno"> 251</tt>  <tt class="py-line">                <tt class="py-comment"># Find the theta value for this polar angle phi.</tt> </tt>
<a name="L252"></a><tt class="py-lineno"> 252</tt>  <tt class="py-line">                <tt class="py-name">phi_val</tt> <tt class="py-op">=</tt> <tt class="py-name">phi</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">]</tt> </tt>
<a name="L253"></a><tt class="py-lineno"> 253</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">fwd_index</tt> <tt class="py-op">==</tt> <tt class="py-number">0</tt><tt class="py-op">:</tt> </tt>
<a name="L254"></a><tt class="py-lineno"> 254</tt>  <tt class="py-line">                    <tt id="link-107" class="py-name" targets="Method generic_fns.structure.cones.Cosine.theta_max()=generic_fns.structure.cones.Cosine-class.html#theta_max,Method generic_fns.structure.cones.Elliptic.theta_max()=generic_fns.structure.cones.Elliptic-class.html#theta_max,Method generic_fns.structure.cones.Iso_cone.theta_max()=generic_fns.structure.cones.Iso_cone-class.html#theta_max,Method generic_fns.structure.cones.Pseudo_elliptic.theta_max()=generic_fns.structure.cones.Pseudo_elliptic-class.html#theta_max,Method generic_fns.structure.cones.Pseudo_elliptic2.theta_max()=generic_fns.structure.cones.Pseudo_elliptic2-class.html#theta_max,Method generic_fns.structure.cones.Square.theta_max()=generic_fns.structure.cones.Square-class.html#theta_max,Method generic_fns.structure.cones.Zig_zag.theta_max()=generic_fns.structure.cones.Zig_zag-class.html#theta_max"><a title="generic_fns.structure.cones.Cosine.theta_max
generic_fns.structure.cones.Elliptic.theta_max
generic_fns.structure.cones.Iso_cone.theta_max
generic_fns.structure.cones.Pseudo_elliptic.theta_max
generic_fns.structure.cones.Pseudo_elliptic2.theta_max
generic_fns.structure.cones.Square.theta_max
generic_fns.structure.cones.Zig_zag.theta_max" class="py-name" href="#" onclick="return doclink('link-107', 'theta_max', 'link-107');">theta_max</a></tt> <tt class="py-op">=</tt> <tt class="py-name">theta</tt><tt class="py-op">[</tt><tt class="py-name">fwd_index</tt><tt class="py-op">]</tt> <tt class="py-op">+</tt> <tt class="py-number">2</tt><tt class="py-op">*</tt><tt class="py-name">pi</tt> </tt>
<a name="L255"></a><tt class="py-lineno"> 255</tt>  <tt class="py-line">                <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L256"></a><tt class="py-lineno"> 256</tt>  <tt class="py-line">                    <tt id="link-108" class="py-name"><a title="generic_fns.structure.cones.Cosine.theta_max
generic_fns.structure.cones.Elliptic.theta_max
generic_fns.structure.cones.Iso_cone.theta_max
generic_fns.structure.cones.Pseudo_elliptic.theta_max
generic_fns.structure.cones.Pseudo_elliptic2.theta_max
generic_fns.structure.cones.Square.theta_max
generic_fns.structure.cones.Zig_zag.theta_max" class="py-name" href="#" onclick="return doclink('link-108', 'theta_max', 'link-107');">theta_max</a></tt> <tt class="py-op">=</tt> <tt class="py-name">theta</tt><tt class="py-op">[</tt><tt class="py-name">fwd_index</tt><tt class="py-op">]</tt> </tt>
<a name="L257"></a><tt class="py-lineno"> 257</tt>  <tt class="py-line">                <tt id="link-109" class="py-name"><a title="generic_fns.structure.cones.Cosine.theta_max
generic_fns.structure.cones.Elliptic.theta_max
generic_fns.structure.cones.Iso_cone.theta_max
generic_fns.structure.cones.Pseudo_elliptic.theta_max
generic_fns.structure.cones.Pseudo_elliptic2.theta_max
generic_fns.structure.cones.Square.theta_max
generic_fns.structure.cones.Zig_zag.theta_max" class="py-name" href="#" onclick="return doclink('link-109', 'theta_max', 'link-107');">theta_max</a></tt> <tt class="py-op">=</tt> <tt class="py-name">cone</tt><tt class="py-op">.</tt><tt id="link-110" class="py-name"><a title="generic_fns.structure.cones.Cosine.theta_max
generic_fns.structure.cones.Elliptic.theta_max
generic_fns.structure.cones.Iso_cone.theta_max
generic_fns.structure.cones.Pseudo_elliptic.theta_max
generic_fns.structure.cones.Pseudo_elliptic2.theta_max
generic_fns.structure.cones.Square.theta_max
generic_fns.structure.cones.Zig_zag.theta_max" class="py-name" href="#" onclick="return doclink('link-110', 'theta_max', 'link-107');">theta_max</a></tt><tt class="py-op">(</tt><tt class="py-name">phi_val</tt><tt class="py-op">,</tt> <tt class="py-name">theta_min</tt><tt class="py-op">=</tt><tt class="py-name">theta</tt><tt class="py-op">[</tt><tt id="link-111" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-111', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt id="link-112" class="py-name"><a title="generic_fns.structure.cones.Cosine.theta_max
generic_fns.structure.cones.Elliptic.theta_max
generic_fns.structure.cones.Iso_cone.theta_max
generic_fns.structure.cones.Pseudo_elliptic.theta_max
generic_fns.structure.cones.Pseudo_elliptic2.theta_max
generic_fns.structure.cones.Square.theta_max
generic_fns.structure.cones.Zig_zag.theta_max" class="py-name" href="#" onclick="return doclink('link-112', 'theta_max', 'link-107');">theta_max</a></tt><tt class="py-op">=</tt><tt id="link-113" class="py-name"><a title="generic_fns.structure.cones.Cosine.theta_max
generic_fns.structure.cones.Elliptic.theta_max
generic_fns.structure.cones.Iso_cone.theta_max
generic_fns.structure.cones.Pseudo_elliptic.theta_max
generic_fns.structure.cones.Pseudo_elliptic2.theta_max
generic_fns.structure.cones.Square.theta_max
generic_fns.structure.cones.Zig_zag.theta_max" class="py-name" href="#" onclick="return doclink('link-113', 'theta_max', 'link-107');">theta_max</a></tt><tt class="py-op">-</tt><tt class="py-number">1e-7</tt><tt class="py-op">)</tt> </tt>
<a name="L258"></a><tt class="py-lineno"> 258</tt>  <tt class="py-line"> </tt>
<a name="L259"></a><tt class="py-lineno"> 259</tt>  <tt class="py-line">            <tt class="py-comment"># Back edge (skip when the latitude is phi max).</tt> </tt>
<a name="L260"></a><tt class="py-lineno"> 260</tt>  <tt class="py-line">            <tt class="py-name">rev_index</tt> <tt class="py-op">=</tt> <tt id="link-114" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-114', 'i', 'link-40');">i</a></tt><tt class="py-op">-</tt><tt class="py-number">1</tt> </tt>
<a name="L261"></a><tt class="py-lineno"> 261</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-115" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-115', 'i', 'link-40');">i</a></tt> <tt class="py-op">==</tt> <tt class="py-number">0</tt><tt class="py-op">:</tt> </tt>
<a name="L262"></a><tt class="py-lineno"> 262</tt>  <tt class="py-line">                <tt class="py-name">rev_index</tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">)</tt><tt class="py-op">-</tt><tt class="py-number">1</tt> </tt>
<a name="L263"></a><tt class="py-lineno"> 263</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-116" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-116', 'i', 'link-40');">i</a></tt> <tt class="py-op">&lt;</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">)</tt><tt class="py-op">-</tt><tt class="py-number">1</tt> <tt class="py-keyword">and</tt> <tt class="py-name">j</tt> <tt class="py-op">&gt;</tt> <tt class="py-name">edge_index_rev</tt><tt class="py-op">[</tt><tt id="link-117" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-117', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> <tt class="py-keyword">and</tt> <tt class="py-name">j</tt> <tt class="py-op">&lt;=</tt> <tt class="py-name">edge_index_rev</tt><tt class="py-op">[</tt><tt id="link-118" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-118', 'i', 'link-40');">i</a></tt><tt class="py-op">+</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">abs</tt><tt class="py-op">(</tt><tt id="link-119" class="py-name"><a title="generic_fns.structure.cones.Cosine.phi_max
generic_fns.structure.cones.Elliptic.phi_max
generic_fns.structure.cones.Iso_cone.phi_max
generic_fns.structure.cones.Pseudo_elliptic.phi_max
generic_fns.structure.cones.Pseudo_elliptic2.phi_max
generic_fns.structure.cones.Square.phi_max
generic_fns.structure.cones.Zig_zag.phi_max" class="py-name" href="#" onclick="return doclink('link-119', 'phi_max', 'link-75');">phi_max</a></tt><tt class="py-op">[</tt><tt class="py-name">fwd_index</tt><tt class="py-op">]</tt> <tt class="py-op">-</tt> <tt class="py-name">phi</tt><tt class="py-op">[</tt><tt class="py-name">k</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> <tt class="py-op">&lt;</tt> <tt class="py-number">1e-6</tt><tt class="py-op">:</tt> </tt>
<a name="L264"></a><tt class="py-lineno"> 264</tt>  <tt class="py-line">                <tt class="py-comment"># Debugging.</tt> </tt>
<a name="L265"></a><tt class="py-lineno"> 265</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">debug</tt><tt class="py-op">:</tt> </tt>
<a name="L266"></a><tt class="py-lineno"> 266</tt>  <tt class="py-line">                    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%sBack edge."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">" "</tt><tt class="py-op">*</tt><tt class="py-number">8</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L267"></a><tt class="py-lineno"> 267</tt>  <tt class="py-line"> </tt>
<a name="L268"></a><tt class="py-lineno"> 268</tt>  <tt class="py-line">                <tt class="py-comment"># Edge found.</tt> </tt>
<a name="L269"></a><tt class="py-lineno"> 269</tt>  <tt class="py-line">                <tt class="py-name">skip</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L270"></a><tt class="py-lineno"> 270</tt>  <tt class="py-line"> </tt>
<a name="L271"></a><tt class="py-lineno"> 271</tt>  <tt class="py-line">                <tt class="py-comment"># Find the theta value for this polar angle phi.</tt> </tt>
<a name="L272"></a><tt class="py-lineno"> 272</tt>  <tt class="py-line">                <tt class="py-name">phi_val</tt> <tt class="py-op">=</tt> <tt class="py-name">phi</tt><tt class="py-op">[</tt><tt class="py-name">k</tt><tt class="py-op">]</tt> </tt>
<a name="L273"></a><tt class="py-lineno"> 273</tt>  <tt class="py-line">                <tt id="link-120" class="py-name"><a title="generic_fns.structure.cones.Cosine.theta_max
generic_fns.structure.cones.Elliptic.theta_max
generic_fns.structure.cones.Iso_cone.theta_max
generic_fns.structure.cones.Pseudo_elliptic.theta_max
generic_fns.structure.cones.Pseudo_elliptic2.theta_max
generic_fns.structure.cones.Square.theta_max
generic_fns.structure.cones.Zig_zag.theta_max" class="py-name" href="#" onclick="return doclink('link-120', 'theta_max', 'link-107');">theta_max</a></tt> <tt class="py-op">=</tt> <tt class="py-name">cone</tt><tt class="py-op">.</tt><tt id="link-121" class="py-name"><a title="generic_fns.structure.cones.Cosine.theta_max
generic_fns.structure.cones.Elliptic.theta_max
generic_fns.structure.cones.Iso_cone.theta_max
generic_fns.structure.cones.Pseudo_elliptic.theta_max
generic_fns.structure.cones.Pseudo_elliptic2.theta_max
generic_fns.structure.cones.Square.theta_max
generic_fns.structure.cones.Zig_zag.theta_max" class="py-name" href="#" onclick="return doclink('link-121', 'theta_max', 'link-107');">theta_max</a></tt><tt class="py-op">(</tt><tt class="py-name">phi_val</tt><tt class="py-op">,</tt> <tt class="py-name">theta_min</tt><tt class="py-op">=</tt><tt class="py-name">theta</tt><tt class="py-op">[</tt><tt id="link-122" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-122', 'i', 'link-40');">i</a></tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt id="link-123" class="py-name"><a title="generic_fns.structure.cones.Cosine.theta_max
generic_fns.structure.cones.Elliptic.theta_max
generic_fns.structure.cones.Iso_cone.theta_max
generic_fns.structure.cones.Pseudo_elliptic.theta_max
generic_fns.structure.cones.Pseudo_elliptic2.theta_max
generic_fns.structure.cones.Square.theta_max
generic_fns.structure.cones.Zig_zag.theta_max" class="py-name" href="#" onclick="return doclink('link-123', 'theta_max', 'link-107');">theta_max</a></tt><tt class="py-op">=</tt><tt class="py-name">theta</tt><tt class="py-op">[</tt><tt id="link-124" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-124', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L274"></a><tt class="py-lineno"> 274</tt>  <tt class="py-line"> </tt>
<a name="L275"></a><tt class="py-lineno"> 275</tt>  <tt class="py-line">            <tt class="py-comment"># Skipping.</tt> </tt>
<a name="L276"></a><tt class="py-lineno"> 276</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">skip</tt><tt class="py-op">:</tt> </tt>
<a name="L277"></a><tt class="py-lineno"> 277</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L278"></a><tt class="py-lineno"> 278</tt>  <tt class="py-line"> </tt>
<a name="L279"></a><tt class="py-lineno"> 279</tt>  <tt class="py-line">            <tt class="py-comment"># Debugging.</tt> </tt>
<a name="L280"></a><tt class="py-lineno"> 280</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">debug</tt><tt class="py-op">:</tt> </tt>
<a name="L281"></a><tt class="py-lineno"> 281</tt>  <tt class="py-line">                <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%sAdding atom %s."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">" "</tt><tt class="py-op">*</tt><tt class="py-number">8</tt><tt class="py-op">,</tt> <tt id="link-125" class="py-name"><a title="generic_fns.structure.geometric.get_proton_name" class="py-name" href="#" onclick="return doclink('link-125', 'get_proton_name', 'link-97');">get_proton_name</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_num</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L282"></a><tt class="py-lineno"> 282</tt>  <tt class="py-line"> </tt>
<a name="L283"></a><tt class="py-lineno"> 283</tt>  <tt class="py-line">            <tt class="py-comment"># The coordinates.</tt> </tt>
<a name="L284"></a><tt class="py-lineno"> 284</tt>  <tt class="py-line">            <tt class="py-name">x</tt> <tt class="py-op">=</tt> <tt class="py-name">cos</tt><tt class="py-op">(</tt><tt id="link-126" class="py-name"><a title="generic_fns.structure.cones.Cosine.theta_max
generic_fns.structure.cones.Elliptic.theta_max
generic_fns.structure.cones.Iso_cone.theta_max
generic_fns.structure.cones.Pseudo_elliptic.theta_max
generic_fns.structure.cones.Pseudo_elliptic2.theta_max
generic_fns.structure.cones.Square.theta_max
generic_fns.structure.cones.Zig_zag.theta_max" class="py-name" href="#" onclick="return doclink('link-126', 'theta_max', 'link-107');">theta_max</a></tt><tt class="py-op">)</tt> <tt class="py-op">*</tt> <tt class="py-name">sin</tt><tt class="py-op">(</tt><tt class="py-name">phi_val</tt><tt class="py-op">)</tt> </tt>
<a name="L285"></a><tt class="py-lineno"> 285</tt>  <tt class="py-line">            <tt class="py-name">y</tt> <tt class="py-op">=</tt> <tt class="py-name">sin</tt><tt class="py-op">(</tt><tt id="link-127" class="py-name"><a title="generic_fns.structure.cones.Cosine.theta_max
generic_fns.structure.cones.Elliptic.theta_max
generic_fns.structure.cones.Iso_cone.theta_max
generic_fns.structure.cones.Pseudo_elliptic.theta_max
generic_fns.structure.cones.Pseudo_elliptic2.theta_max
generic_fns.structure.cones.Square.theta_max
generic_fns.structure.cones.Zig_zag.theta_max" class="py-name" href="#" onclick="return doclink('link-127', 'theta_max', 'link-107');">theta_max</a></tt><tt class="py-op">)</tt> <tt class="py-op">*</tt> <tt class="py-name">sin</tt><tt class="py-op">(</tt><tt class="py-name">phi_val</tt><tt class="py-op">)</tt> </tt>
<a name="L286"></a><tt class="py-lineno"> 286</tt>  <tt class="py-line">            <tt class="py-name">z</tt> <tt class="py-op">=</tt> <tt class="py-name">cos</tt><tt class="py-op">(</tt><tt class="py-name">phi_val</tt><tt class="py-op">)</tt> </tt>
<a name="L287"></a><tt class="py-lineno"> 287</tt>  <tt class="py-line">            <tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-name">x</tt><tt class="py-op">,</tt> <tt class="py-name">y</tt><tt class="py-op">,</tt> <tt class="py-name">z</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> <tt class="py-op">*</tt> <tt class="py-name">scale</tt> </tt>
<a name="L288"></a><tt class="py-lineno"> 288</tt>  <tt class="py-line"> </tt>
<a name="L289"></a><tt class="py-lineno"> 289</tt>  <tt class="py-line">            <tt class="py-comment"># Rotate and shift.</tt> </tt>
<a name="L290"></a><tt class="py-lineno"> 290</tt>  <tt class="py-line">            <tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt class="py-name">apex</tt> <tt class="py-op">+</tt> <tt class="py-name">dot</tt><tt class="py-op">(</tt><tt id="link-128" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-128', 'R', 'link-71');">R</a></tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt><tt class="py-op">)</tt> </tt>
<a name="L291"></a><tt class="py-lineno"> 291</tt>  <tt class="py-line"> </tt>
<a name="L292"></a><tt class="py-lineno"> 292</tt>  <tt class="py-line">            <tt class="py-comment"># Add the atom.</tt> </tt>
<a name="L293"></a><tt class="py-lineno"> 293</tt>  <tt class="py-line">            <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-129" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_add" class="py-name" href="#" onclick="return doclink('link-129', 'atom_add', 'link-68');">atom_add</a></tt><tt class="py-op">(</tt><tt class="py-name">pdb_record</tt><tt class="py-op">=</tt><tt class="py-string">'HETATM'</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt id="link-130" class="py-name"><a title="generic_fns.structure.geometric.get_proton_name" class="py-name" href="#" onclick="return doclink('link-130', 'get_proton_name', 'link-97');">get_proton_name</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_num</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">res_name</tt><tt class="py-op">,</tt> <tt class="py-name">chain_id</tt><tt class="py-op">=</tt><tt class="py-name">chain_id</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt><tt class="py-op">=</tt><tt class="py-name">pos</tt><tt class="py-op">,</tt> <tt class="py-name">segment_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">element</tt><tt class="py-op">=</tt><tt class="py-string">'H'</tt><tt class="py-op">)</tt> </tt>
<a name="L294"></a><tt class="py-lineno"> 294</tt>  <tt class="py-line"> </tt>
<a name="L295"></a><tt class="py-lineno"> 295</tt>  <tt class="py-line">            <tt class="py-comment"># Increment the atom number.</tt> </tt>
<a name="L296"></a><tt class="py-lineno"> 296</tt>  <tt class="py-line">            <tt class="py-name">atom_num</tt> <tt class="py-op">=</tt> <tt class="py-name">atom_num</tt> <tt class="py-op">+</tt> <tt class="py-number">1</tt> </tt>
<a name="L297"></a><tt class="py-lineno"> 297</tt>  <tt class="py-line"> </tt>
<a name="L298"></a><tt class="py-lineno"> 298</tt>  <tt class="py-line">    <tt class="py-comment"># Debugging.</tt> </tt>
<a name="L299"></a><tt class="py-lineno"> 299</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">debug</tt><tt class="py-op">:</tt> </tt>
<a name="L300"></a><tt class="py-lineno"> 300</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\nBuilding the edge."</tt><tt class="py-op">)</tt> </tt>
<a name="L301"></a><tt class="py-lineno"> 301</tt>  <tt class="py-line"> </tt>
<a name="L302"></a><tt class="py-lineno"> 302</tt>  <tt class="py-line">    <tt class="py-comment"># Build the cone edge.</tt> </tt>
<a name="L303"></a><tt class="py-lineno"> 303</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-131" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-131', 'i', 'link-40');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">origin_atom</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">-</tt><tt class="py-number">2</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L304"></a><tt class="py-lineno"> 304</tt>  <tt class="py-line">        <tt class="py-comment"># Debugging.</tt> </tt>
<a name="L305"></a><tt class="py-lineno"> 305</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">debug</tt><tt class="py-op">:</tt> </tt>
<a name="L306"></a><tt class="py-lineno"> 306</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%sCone edge, connecting %s to %s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">" "</tt><tt class="py-op">*</tt><tt class="py-number">4</tt><tt class="py-op">,</tt> <tt id="link-132" class="py-name"><a title="generic_fns.structure.geometric.get_proton_name" class="py-name" href="#" onclick="return doclink('link-132', 'get_proton_name', 'link-97');">get_proton_name</a></tt><tt class="py-op">(</tt><tt id="link-133" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-133', 'i', 'link-40');">i</a></tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt id="link-134" class="py-name"><a title="generic_fns.structure.geometric.get_proton_name" class="py-name" href="#" onclick="return doclink('link-134', 'get_proton_name', 'link-97');">get_proton_name</a></tt><tt class="py-op">(</tt><tt id="link-135" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-135', 'i', 'link-40');">i</a></tt><tt class="py-op">+</tt><tt class="py-number">1</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L307"></a><tt class="py-lineno"> 307</tt>  <tt class="py-line"> </tt>
<a name="L308"></a><tt class="py-lineno"> 308</tt>  <tt class="py-line">        <tt class="py-comment"># Connect.</tt> </tt>
<a name="L309"></a><tt class="py-lineno"> 309</tt>  <tt class="py-line">        <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-136" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_connect" class="py-name" href="#" onclick="return doclink('link-136', 'atom_connect', 'link-100');">atom_connect</a></tt><tt class="py-op">(</tt><tt class="py-name">index1</tt><tt class="py-op">=</tt><tt id="link-137" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-137', 'i', 'link-40');">i</a></tt><tt class="py-op">,</tt> <tt class="py-name">index2</tt><tt class="py-op">=</tt><tt id="link-138" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-138', 'i', 'link-40');">i</a></tt><tt class="py-op">+</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L310"></a><tt class="py-lineno"> 310</tt>  <tt class="py-line"> </tt>
<a name="L311"></a><tt class="py-lineno"> 311</tt>  <tt class="py-line">    <tt class="py-comment"># Connect the last radial array to the first (to zip up the circle).</tt> </tt>
<a name="L312"></a><tt class="py-lineno"> 312</tt>  <tt class="py-line">    <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-139" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_connect" class="py-name" href="#" onclick="return doclink('link-139', 'atom_connect', 'link-100');">atom_connect</a></tt><tt class="py-op">(</tt><tt class="py-name">index1</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">-</tt><tt class="py-number">2</tt><tt class="py-op">,</tt> <tt class="py-name">index2</tt><tt class="py-op">=</tt><tt class="py-name">origin_atom</tt><tt class="py-op">)</tt> </tt>
</div><a name="L313"></a><tt class="py-lineno"> 313</tt>  <tt class="py-line"> </tt>
<a name="L314"></a><tt class="py-lineno"> 314</tt>  <tt class="py-line"> </tt>
<a name="create_cone_pdb"></a><div id="create_cone_pdb-def"><a name="L315"></a><tt class="py-lineno"> 315</tt> <a class="py-toggle" href="#" id="create_cone_pdb-toggle" onclick="return toggle('create_cone_pdb');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.geometric-module.html#create_cone_pdb">create_cone_pdb</a><tt class="py-op">(</tt><tt class="py-param">mol</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">cone</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">start_res</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-param">apex</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">axis</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">R</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">inc</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">scale</tt><tt class="py-op">=</tt><tt class="py-number">30.0</tt><tt class="py-op">,</tt> <tt class="py-param">distribution</tt><tt class="py-op">=</tt><tt class="py-string">'regular'</tt><tt class="py-op">,</tt> <tt class="py-param">file</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">dir</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">force</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">,</tt> <tt class="py-param">axis_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="create_cone_pdb-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="create_cone_pdb-expanded"><a name="L316"></a><tt class="py-lineno"> 316</tt>  <tt class="py-line">    <tt class="py-docstring">"""Create a PDB representation of the given cone object.</tt> </tt>
<a name="L317"></a><tt class="py-lineno"> 317</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L318"></a><tt class="py-lineno"> 318</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword mol:           The molecule container.</tt> </tt>
<a name="L319"></a><tt class="py-lineno"> 319</tt>  <tt class="py-line"><tt class="py-docstring">    @type mol:              MolContainer instance</tt> </tt>
<a name="L320"></a><tt class="py-lineno"> 320</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword cone:          The cone object.  This should provide the limit_check() method with determines the limits of the distribution accepting two arguments, the polar angle phi and the azimuthal angle theta, and return True if the point is in the limits or False if outside.  It should also provide the theta_max() method for returning the theta value for the given phi, the phi_max() method for returning the phi value for the given theta.</tt> </tt>
<a name="L321"></a><tt class="py-lineno"> 321</tt>  <tt class="py-line"><tt class="py-docstring">    @type cone:             class instance</tt> </tt>
<a name="L322"></a><tt class="py-lineno"> 322</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword start_res:     The starting residue number.</tt> </tt>
<a name="L323"></a><tt class="py-lineno"> 323</tt>  <tt class="py-line"><tt class="py-docstring">    @type start_res:        str</tt> </tt>
<a name="L324"></a><tt class="py-lineno"> 324</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword apex:          The apex of the cone.</tt> </tt>
<a name="L325"></a><tt class="py-lineno"> 325</tt>  <tt class="py-line"><tt class="py-docstring">    @type apex:             rank-1, 3D numpy array</tt> </tt>
<a name="L326"></a><tt class="py-lineno"> 326</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword axis:          The central axis of the cone.  If not supplied, the z-axis will be used.</tt> </tt>
<a name="L327"></a><tt class="py-lineno"> 327</tt>  <tt class="py-line"><tt class="py-docstring">    @type axis:             rank-1, 3D numpy array</tt> </tt>
<a name="L328"></a><tt class="py-lineno"> 328</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword R:             The rotation matrix.</tt> </tt>
<a name="L329"></a><tt class="py-lineno"> 329</tt>  <tt class="py-line"><tt class="py-docstring">    @type R:                rank-2, 3D numpy array</tt> </tt>
<a name="L330"></a><tt class="py-lineno"> 330</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword inc:           The increment number used to determine the number of latitude and longitude lines.</tt> </tt>
<a name="L331"></a><tt class="py-lineno"> 331</tt>  <tt class="py-line"><tt class="py-docstring">    @type inc:              int</tt> </tt>
<a name="L332"></a><tt class="py-lineno"> 332</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword scale:         The scaling factor to stretch the unit cone by.</tt> </tt>
<a name="L333"></a><tt class="py-lineno"> 333</tt>  <tt class="py-line"><tt class="py-docstring">    @type scale:            float</tt> </tt>
<a name="L334"></a><tt class="py-lineno"> 334</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword distribution:  The type of point distribution to use.  This can be 'uniform' or 'regular'.</tt> </tt>
<a name="L335"></a><tt class="py-lineno"> 335</tt>  <tt class="py-line"><tt class="py-docstring">    @type distribution:     str</tt> </tt>
<a name="L336"></a><tt class="py-lineno"> 336</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword file:          The name of the PDB file to create.</tt> </tt>
<a name="L337"></a><tt class="py-lineno"> 337</tt>  <tt class="py-line"><tt class="py-docstring">    @type file:             str</tt> </tt>
<a name="L338"></a><tt class="py-lineno"> 338</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword dir:           The name of the directory to place the PDB file into.</tt> </tt>
<a name="L339"></a><tt class="py-lineno"> 339</tt>  <tt class="py-line"><tt class="py-docstring">    @type dir:              str</tt> </tt>
<a name="L340"></a><tt class="py-lineno"> 340</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword force:         Flag which if set to True will overwrite any pre-existing file.</tt> </tt>
<a name="L341"></a><tt class="py-lineno"> 341</tt>  <tt class="py-line"><tt class="py-docstring">    @type force:            bool</tt> </tt>
<a name="L342"></a><tt class="py-lineno"> 342</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword axis_flag:     A flag which if True will create the cone's axis.</tt> </tt>
<a name="L343"></a><tt class="py-lineno"> 343</tt>  <tt class="py-line"><tt class="py-docstring">    @type axis_flag:        bool</tt> </tt>
<a name="L344"></a><tt class="py-lineno"> 344</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L345"></a><tt class="py-lineno"> 345</tt>  <tt class="py-line"> </tt>
<a name="L346"></a><tt class="py-lineno"> 346</tt>  <tt class="py-line">    <tt class="py-comment"># The cone axis default of the z-axis.</tt> </tt>
<a name="L347"></a><tt class="py-lineno"> 347</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">axis</tt><tt class="py-op">:</tt> </tt>
<a name="L348"></a><tt class="py-lineno"> 348</tt>  <tt class="py-line">        <tt class="py-name">axis</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L349"></a><tt class="py-lineno"> 349</tt>  <tt class="py-line"> </tt>
<a name="L350"></a><tt class="py-lineno"> 350</tt>  <tt class="py-line">    <tt class="py-comment"># No rotation.</tt> </tt>
<a name="L351"></a><tt class="py-lineno"> 351</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-140" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-140', 'R', 'link-71');">R</a></tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L352"></a><tt class="py-lineno"> 352</tt>  <tt class="py-line">        <tt id="link-141" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-141', 'R', 'link-71');">R</a></tt> <tt class="py-op">=</tt> <tt class="py-name">eye</tt><tt class="py-op">(</tt><tt class="py-number">3</tt><tt class="py-op">)</tt> </tt>
<a name="L353"></a><tt class="py-lineno"> 353</tt>  <tt class="py-line"> </tt>
<a name="L354"></a><tt class="py-lineno"> 354</tt>  <tt class="py-line">    <tt class="py-comment"># No molecule supplied.</tt> </tt>
<a name="L355"></a><tt class="py-lineno"> 355</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">mol</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L356"></a><tt class="py-lineno"> 356</tt>  <tt class="py-line">        <tt class="py-comment"># Create the structural object.</tt> </tt>
<a name="L357"></a><tt class="py-lineno"> 357</tt>  <tt class="py-line">        <tt id="link-142" class="py-name"><a title="bmrblib.structure
generic_fns.structure
lib.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-142', 'structure', 'link-11');">structure</a></tt> <tt class="py-op">=</tt> <tt id="link-143" class="py-name"><a title="generic_fns.structure.internal.Internal" class="py-name" href="#" onclick="return doclink('link-143', 'Internal', 'link-13');">Internal</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L358"></a><tt class="py-lineno"> 358</tt>  <tt class="py-line"> </tt>
<a name="L359"></a><tt class="py-lineno"> 359</tt>  <tt class="py-line">        <tt class="py-comment"># Add a molecule.</tt> </tt>
<a name="L360"></a><tt class="py-lineno"> 360</tt>  <tt class="py-line">        <tt id="link-144" class="py-name"><a title="bmrblib.structure
generic_fns.structure
lib.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-144', 'structure', 'link-11');">structure</a></tt><tt class="py-op">.</tt><tt id="link-145" class="py-name" targets="Method generic_fns.structure.api_base.Base_struct_API.add_molecule()=generic_fns.structure.api_base.Base_struct_API-class.html#add_molecule,Method generic_fns.structure.internal.Internal.add_molecule()=generic_fns.structure.internal.Internal-class.html#add_molecule"><a title="generic_fns.structure.api_base.Base_struct_API.add_molecule
generic_fns.structure.internal.Internal.add_molecule" class="py-name" href="#" onclick="return doclink('link-145', 'add_molecule', 'link-145');">add_molecule</a></tt><tt class="py-op">(</tt><tt id="link-146" class="py-name" targets="Variable bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name=bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe-class.html#name,Variable bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name=bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1-class.html#name,Variable bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name=bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name=bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name=bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name=bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name=bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1-class.html#name,Variable generic_fns.pipes.name=generic_fns.pipes-module.html#name,Variable user_functions.pipe.name=user_functions.pipe-module.html#name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
generic_fns.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-146', 'name', 'link-146');">name</a></tt><tt class="py-op">=</tt><tt class="py-string">'cone'</tt><tt class="py-op">)</tt> </tt>
<a name="L361"></a><tt class="py-lineno"> 361</tt>  <tt class="py-line"> </tt>
<a name="L362"></a><tt class="py-lineno"> 362</tt>  <tt class="py-line">        <tt class="py-comment"># Alias the single molecule from the single model.</tt> </tt>
<a name="L363"></a><tt class="py-lineno"> 363</tt>  <tt class="py-line">        <tt class="py-name">mol</tt> <tt class="py-op">=</tt> <tt id="link-147" class="py-name"><a title="bmrblib.structure
generic_fns.structure
lib.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-147', 'structure', 'link-11');">structure</a></tt><tt class="py-op">.</tt><tt class="py-name">structural_data</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">mol</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L364"></a><tt class="py-lineno"> 364</tt>  <tt class="py-line"> </tt>
<a name="L365"></a><tt class="py-lineno"> 365</tt>  <tt class="py-line">    <tt class="py-comment"># The first atom number.</tt> </tt>
<a name="L366"></a><tt class="py-lineno"> 366</tt>  <tt class="py-line">    <tt class="py-name">start_atom</tt> <tt class="py-op">=</tt> <tt class="py-number">1</tt> </tt>
<a name="L367"></a><tt class="py-lineno"> 367</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">mol</tt><tt class="py-op">,</tt> <tt class="py-string">'atom_num'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L368"></a><tt class="py-lineno"> 368</tt>  <tt class="py-line">        <tt class="py-name">start_atom</tt> <tt class="py-op">=</tt> <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt class="py-name">atom_num</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">+</tt><tt class="py-number">1</tt> </tt>
<a name="L369"></a><tt class="py-lineno"> 369</tt>  <tt class="py-line"> </tt>
<a name="L370"></a><tt class="py-lineno"> 370</tt>  <tt class="py-line">    <tt class="py-comment"># The axis.</tt> </tt>
<a name="L371"></a><tt class="py-lineno"> 371</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">axis_flag</tt><tt class="py-op">:</tt> </tt>
<a name="L372"></a><tt class="py-lineno"> 372</tt>  <tt class="py-line">        <tt class="py-comment"># Add the apex.</tt> </tt>
<a name="L373"></a><tt class="py-lineno"> 373</tt>  <tt class="py-line">        <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-148" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_add" class="py-name" href="#" onclick="return doclink('link-148', 'atom_add', 'link-68');">atom_add</a></tt><tt class="py-op">(</tt><tt class="py-name">pdb_record</tt><tt class="py-op">=</tt><tt class="py-string">'HETATM'</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">=</tt><tt class="py-name">start_atom</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt class="py-string">'R'</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-string">'APX'</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">start_res</tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt><tt class="py-op">=</tt><tt class="py-name">apex</tt><tt class="py-op">,</tt> <tt class="py-name">element</tt><tt class="py-op">=</tt><tt class="py-string">'C'</tt><tt class="py-op">)</tt> </tt>
<a name="L374"></a><tt class="py-lineno"> 374</tt>  <tt class="py-line"> </tt>
<a name="L375"></a><tt class="py-lineno"> 375</tt>  <tt class="py-line">        <tt class="py-comment"># Generate the axis vectors.</tt> </tt>
<a name="L376"></a><tt class="py-lineno"> 376</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\nGenerating the axis vectors."</tt><tt class="py-op">)</tt> </tt>
<a name="L377"></a><tt class="py-lineno"> 377</tt>  <tt class="py-line">        <tt class="py-name">res_num</tt> <tt class="py-op">=</tt> <tt id="link-149" class="py-name" targets="Function generic_fns.structure.geometric.generate_vector_residues()=generic_fns.structure.geometric-module.html#generate_vector_residues"><a title="generic_fns.structure.geometric.generate_vector_residues" class="py-name" href="#" onclick="return doclink('link-149', 'generate_vector_residues', 'link-149');">generate_vector_residues</a></tt><tt class="py-op">(</tt><tt class="py-name">mol</tt><tt class="py-op">=</tt><tt class="py-name">mol</tt><tt class="py-op">,</tt> <tt class="py-name">vector</tt><tt class="py-op">=</tt><tt class="py-name">dot</tt><tt class="py-op">(</tt><tt id="link-150" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-150', 'R', 'link-71');">R</a></tt><tt class="py-op">,</tt> <tt class="py-name">axis</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt class="py-string">'Axis'</tt><tt class="py-op">,</tt> <tt class="py-name">res_name_vect</tt><tt class="py-op">=</tt><tt class="py-string">'AXE'</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">start_res</tt><tt class="py-op">+</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">origin</tt><tt class="py-op">=</tt><tt class="py-name">apex</tt><tt class="py-op">,</tt> <tt class="py-name">scale</tt><tt class="py-op">=</tt><tt class="py-name">scale</tt><tt class="py-op">)</tt> </tt>
<a name="L378"></a><tt class="py-lineno"> 378</tt>  <tt class="py-line"> </tt>
<a name="L379"></a><tt class="py-lineno"> 379</tt>  <tt class="py-line">    <tt class="py-comment"># Generate the cone outer edge.</tt> </tt>
<a name="L380"></a><tt class="py-lineno"> 380</tt>  <tt class="py-line">    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\nGenerating the cone outer edge."</tt><tt class="py-op">)</tt> </tt>
<a name="L381"></a><tt class="py-lineno"> 381</tt>  <tt class="py-line">    <tt class="py-name">edge_start_atom</tt> <tt class="py-op">=</tt> <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt class="py-name">atom_num</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">+</tt><tt class="py-number">1</tt> </tt>
<a name="L382"></a><tt class="py-lineno"> 382</tt>  <tt class="py-line">    <tt id="link-151" class="py-name" targets="Function generic_fns.structure.geometric.cone_edge()=generic_fns.structure.geometric-module.html#cone_edge"><a title="generic_fns.structure.geometric.cone_edge" class="py-name" href="#" onclick="return doclink('link-151', 'cone_edge', 'link-151');">cone_edge</a></tt><tt class="py-op">(</tt><tt class="py-name">mol</tt><tt class="py-op">=</tt><tt class="py-name">mol</tt><tt class="py-op">,</tt> <tt class="py-name">cone</tt><tt class="py-op">=</tt><tt class="py-name">cone</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-string">'EDG'</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">start_res</tt><tt class="py-op">+</tt><tt class="py-number">2</tt><tt class="py-op">,</tt> <tt class="py-name">apex</tt><tt class="py-op">=</tt><tt class="py-name">apex</tt><tt class="py-op">,</tt> <tt id="link-152" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-152', 'R', 'link-71');">R</a></tt><tt class="py-op">=</tt><tt id="link-153" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-153', 'R', 'link-71');">R</a></tt><tt class="py-op">,</tt> <tt class="py-name">scale</tt><tt class="py-op">=</tt><tt class="py-name">scale</tt><tt class="py-op">,</tt> <tt class="py-name">inc</tt><tt class="py-op">=</tt><tt class="py-name">inc</tt><tt class="py-op">,</tt> <tt class="py-name">distribution</tt><tt class="py-op">=</tt><tt class="py-name">distribution</tt><tt class="py-op">)</tt> </tt>
<a name="L383"></a><tt class="py-lineno"> 383</tt>  <tt class="py-line"> </tt>
<a name="L384"></a><tt class="py-lineno"> 384</tt>  <tt class="py-line">    <tt class="py-comment"># Generate the cone cap, and stitch it to the cone edge.</tt> </tt>
<a name="L385"></a><tt class="py-lineno"> 385</tt>  <tt class="py-line">    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\nGenerating the cone cap."</tt><tt class="py-op">)</tt> </tt>
<a name="L386"></a><tt class="py-lineno"> 386</tt>  <tt class="py-line">    <tt class="py-name">cone_start_atom</tt> <tt class="py-op">=</tt> <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt class="py-name">atom_num</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">+</tt><tt class="py-number">1</tt> </tt>
<a name="L387"></a><tt class="py-lineno"> 387</tt>  <tt class="py-line">    <tt id="link-154" class="py-name" targets="Function generic_fns.structure.geometric.generate_vector_dist()=generic_fns.structure.geometric-module.html#generate_vector_dist"><a title="generic_fns.structure.geometric.generate_vector_dist" class="py-name" href="#" onclick="return doclink('link-154', 'generate_vector_dist', 'link-154');">generate_vector_dist</a></tt><tt class="py-op">(</tt><tt class="py-name">mol</tt><tt class="py-op">=</tt><tt class="py-name">mol</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-string">'CON'</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">start_res</tt><tt class="py-op">+</tt><tt class="py-number">3</tt><tt class="py-op">,</tt> <tt id="link-155" class="py-name" targets="Function generic_fns.paramag.centre()=generic_fns.paramag-module.html#centre,Function generic_fns.pcs.centre()=generic_fns.pcs-module.html#centre,Method info.Info_box.centre()=info.Info_box-class.html#centre"><a title="generic_fns.paramag.centre
generic_fns.pcs.centre
info.Info_box.centre" class="py-name" href="#" onclick="return doclink('link-155', 'centre', 'link-155');">centre</a></tt><tt class="py-op">=</tt><tt class="py-name">apex</tt><tt class="py-op">,</tt> <tt id="link-156" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-156', 'R', 'link-71');">R</a></tt><tt class="py-op">=</tt><tt id="link-157" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-157', 'R', 'link-71');">R</a></tt><tt class="py-op">,</tt> <tt id="link-158" class="py-name" targets="Method generic_fns.structure.cones.Base.limit_check()=generic_fns.structure.cones.Base-class.html#limit_check"><a title="generic_fns.structure.cones.Base.limit_check" class="py-name" href="#" onclick="return doclink('link-158', 'limit_check', 'link-158');">limit_check</a></tt><tt class="py-op">=</tt><tt class="py-name">cone</tt><tt class="py-op">.</tt><tt id="link-159" class="py-name"><a title="generic_fns.structure.cones.Base.limit_check" class="py-name" href="#" onclick="return doclink('link-159', 'limit_check', 'link-158');">limit_check</a></tt><tt class="py-op">,</tt> <tt class="py-name">scale</tt><tt class="py-op">=</tt><tt class="py-name">scale</tt><tt class="py-op">,</tt> <tt class="py-name">inc</tt><tt class="py-op">=</tt><tt class="py-name">inc</tt><tt class="py-op">,</tt> <tt class="py-name">distribution</tt><tt class="py-op">=</tt><tt class="py-name">distribution</tt><tt class="py-op">)</tt> </tt>
<a name="L388"></a><tt class="py-lineno"> 388</tt>  <tt class="py-line">    <tt id="link-160" class="py-name" targets="Function generic_fns.structure.geometric.stitch_cone_to_edge()=generic_fns.structure.geometric-module.html#stitch_cone_to_edge"><a title="generic_fns.structure.geometric.stitch_cone_to_edge" class="py-name" href="#" onclick="return doclink('link-160', 'stitch_cone_to_edge', 'link-160');">stitch_cone_to_edge</a></tt><tt class="py-op">(</tt><tt class="py-name">mol</tt><tt class="py-op">=</tt><tt class="py-name">mol</tt><tt class="py-op">,</tt> <tt class="py-name">cone</tt><tt class="py-op">=</tt><tt class="py-name">cone</tt><tt class="py-op">,</tt> <tt class="py-name">dome_start</tt><tt class="py-op">=</tt><tt class="py-name">cone_start_atom</tt><tt class="py-op">,</tt> <tt class="py-name">edge_start</tt><tt class="py-op">=</tt><tt class="py-name">edge_start_atom</tt><tt class="py-op">+</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">scale</tt><tt class="py-op">=</tt><tt class="py-name">scale</tt><tt class="py-op">,</tt> <tt class="py-name">inc</tt><tt class="py-op">=</tt><tt class="py-name">inc</tt><tt class="py-op">,</tt> <tt class="py-name">distribution</tt><tt class="py-op">=</tt><tt class="py-name">distribution</tt><tt class="py-op">)</tt> </tt>
<a name="L389"></a><tt class="py-lineno"> 389</tt>  <tt class="py-line"> </tt>
<a name="L390"></a><tt class="py-lineno"> 390</tt>  <tt class="py-line">    <tt class="py-comment"># Create the PDB file.</tt> </tt>
<a name="L391"></a><tt class="py-lineno"> 391</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-161" class="py-name" targets="Variable check_types.file=check_types-module.html#file,Variable dep_check.file=dep_check-module.html#file,Module gui.input_elements.file=gui.input_elements.file-module.html"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-161', 'file', 'link-161');">file</a></tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L392"></a><tt class="py-lineno"> 392</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\nGenerating the PDB file."</tt><tt class="py-op">)</tt> </tt>
<a name="L393"></a><tt class="py-lineno"> 393</tt>  <tt class="py-line">        <tt class="py-name">pdb_file</tt> <tt class="py-op">=</tt> <tt id="link-162" class="py-name"><a title="relax_io.open_write_file" class="py-name" href="#" onclick="return doclink('link-162', 'open_write_file', 'link-32');">open_write_file</a></tt><tt class="py-op">(</tt><tt class="py-name">file_name</tt><tt class="py-op">=</tt><tt id="link-163" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-163', 'file', 'link-161');">file</a></tt><tt class="py-op">,</tt> <tt id="link-164" class="py-name" targets="Module gui.input_elements.dir=gui.input_elements.dir-module.html"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-164', 'dir', 'link-164');">dir</a></tt><tt class="py-op">=</tt><tt id="link-165" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-165', 'dir', 'link-164');">dir</a></tt><tt class="py-op">,</tt> <tt class="py-name">force</tt><tt class="py-op">=</tt><tt class="py-name">force</tt><tt class="py-op">)</tt> </tt>
<a name="L394"></a><tt class="py-lineno"> 394</tt>  <tt class="py-line">        <tt id="link-166" class="py-name"><a title="bmrblib.structure
generic_fns.structure
lib.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-166', 'structure', 'link-11');">structure</a></tt><tt class="py-op">.</tt><tt id="link-167" class="py-name" targets="Method generic_fns.structure.api_base.Base_struct_API.write_pdb()=generic_fns.structure.api_base.Base_struct_API-class.html#write_pdb,Method generic_fns.structure.internal.Internal.write_pdb()=generic_fns.structure.internal.Internal-class.html#write_pdb,Function generic_fns.structure.main.write_pdb()=generic_fns.structure.main-module.html#write_pdb"><a title="generic_fns.structure.api_base.Base_struct_API.write_pdb
generic_fns.structure.internal.Internal.write_pdb
generic_fns.structure.main.write_pdb" class="py-name" href="#" onclick="return doclink('link-167', 'write_pdb', 'link-167');">write_pdb</a></tt><tt class="py-op">(</tt><tt class="py-name">pdb_file</tt><tt class="py-op">)</tt> </tt>
<a name="L395"></a><tt class="py-lineno"> 395</tt>  <tt class="py-line">        <tt class="py-name">pdb_file</tt><tt class="py-op">.</tt><tt id="link-168" class="py-name" targets="Method gui.input_elements.sequence.Sequence_window.close()=gui.input_elements.sequence.Sequence_window-class.html#close,Method relax_io.DummyFileObject.close()=relax_io.DummyFileObject-class.html#close"><a title="gui.input_elements.sequence.Sequence_window.close
relax_io.DummyFileObject.close" class="py-name" href="#" onclick="return doclink('link-168', 'close', 'link-168');">close</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L396"></a><tt class="py-lineno"> 396</tt>  <tt class="py-line"> </tt>
<a name="L397"></a><tt class="py-lineno"> 397</tt>  <tt class="py-line">    <tt class="py-comment"># Add the file to the results file list.</tt> </tt>
<a name="L398"></a><tt class="py-lineno"> 398</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'result_files'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L399"></a><tt class="py-lineno"> 399</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-169" class="py-name" targets="Module generic_fns.result_files=generic_fns.result_files-module.html"><a title="generic_fns.result_files" class="py-name" href="#" onclick="return doclink('link-169', 'result_files', 'link-169');">result_files</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L400"></a><tt class="py-lineno"> 400</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-170" class="py-name"><a title="generic_fns.result_files" class="py-name" href="#" onclick="return doclink('link-170', 'result_files', 'link-169');">result_files</a></tt><tt class="py-op">.</tt><tt id="link-171" class="py-name" targets="Method data.align_tensor.AlignTensorSimList.append()=data.align_tensor.AlignTensorSimList-class.html#append,Method data.diff_tensor.DiffTensorSimList.append()=data.diff_tensor.DiffTensorSimList-class.html#append"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-171', 'append', 'link-171');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-string">'cone_pdb'</tt><tt class="py-op">,</tt> <tt class="py-string">'Cone PDB'</tt><tt class="py-op">,</tt> <tt id="link-172" class="py-name"><a title="relax_io.get_file_path" class="py-name" href="#" onclick="return doclink('link-172', 'get_file_path', 'link-31');">get_file_path</a></tt><tt class="py-op">(</tt><tt id="link-173" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-173', 'file', 'link-161');">file</a></tt><tt class="py-op">,</tt> <tt id="link-174" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-174', 'dir', 'link-164');">dir</a></tt><tt class="py-op">)</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L401"></a><tt class="py-lineno"> 401</tt>  <tt class="py-line">    <tt id="link-175" class="py-name"><a title="auto_analyses.dauvergne_protocol.status
auto_analyses.noe.status
auto_analyses.relax_fit.status
auto_analyses.stereochem_analysis.status
data.status
generic_fns.bmrb.status
generic_fns.grace.status
generic_fns.minimise.status
generic_fns.mol_res_spin.status
generic_fns.molmol.status
generic_fns.pipes.status
generic_fns.pymol_control.status
generic_fns.result_files.status
generic_fns.script.status
generic_fns.state.status
generic_fns.structure.geometric.status
generic_fns.value.status
gui.about.status
gui.analyses.auto_model_free.status
gui.analyses.auto_noe.status
gui.analyses.auto_rx_base.status
gui.analyses.execute.status
gui.analyses.results_analysis.status
gui.analyses.status
gui.components.base_list.status
gui.components.free_file_format.status
gui.components.grid.status
gui.components.molecule.status
gui.components.relax_data.status
gui.components.relax_data_meta.status
gui.components.spectrum.status
gui.controller.status
gui.errors.status
gui.export_bmrb.status
gui.filedialog.status
gui.fonts.status
gui.icons.status
gui.input_elements.bool.status
gui.input_elements.dir.status
gui.input_elements.file.status
gui.input_elements.sequence.status
gui.input_elements.sequence_2D.status
gui.interpreter.status
gui.menu.status
gui.message.status
gui.misc.status
gui.paths.status
gui.pipe_editor.status
gui.relax_gui.status
gui.relax_prompt.status
gui.results_viewer.status
gui.spin_viewer.frame.status
gui.spin_viewer.tree.status
gui.status
gui.string_conv.status
gui.uf_objects.status
gui.wizard.status
info.Bieri11.status
info.Clore90.status
info.Delaglio95.status
info.GoddardKneller.status
info.LipariSzabo82a.status
info.LipariSzabo82b.status
info.Ref.status
info.dAuvergne06.status
info.dAuvergneGooley03.status
info.dAuvergneGooley06.status
info.dAuvergneGooley07.status
info.dAuvergneGooley08a.status
info.dAuvergneGooley08b.status
info.status
prompt.command.status
prompt.help.status
prompt.interpreter.status
prompt.uf_docstring.status
prompt.uf_objects.status
relax.status
relax_warnings.status
scons.manuals.status
setup.status
status
test_suite.gui_tests.base_classes.status
test_suite.gui_tests.bruker.status
test_suite.gui_tests.model_free.status
test_suite.gui_tests.noe.status
test_suite.gui_tests.rx.status
test_suite.gui_tests.state.status
test_suite.gui_tests.test_user_functions.status
test_suite.relax_test_loader.status
test_suite.relax_test_runner.status
test_suite.system_tests.angles.status
test_suite.system_tests.bmrb.status
test_suite.system_tests.bruker.status
test_suite.system_tests.consistency_tests.status
test_suite.system_tests.dasha.status
test_suite.system_tests.diffusion_tensor.status
test_suite.system_tests.frame_order.status
test_suite.system_tests.generic.status
test_suite.system_tests.grace.status
test_suite.system_tests.interatomic.status
test_suite.system_tests.jw_mapping.status
test_suite.system_tests.load_spins.status
test_suite.system_tests.model_elimination.status
test_suite.system_tests.model_free.status
test_suite.system_tests.model_selection.status
test_suite.system_tests.mol_res_spin.status
test_suite.system_tests.n_state_model.status
test_suite.system_tests.noe.status
test_suite.system_tests.noe_restraints.status
test_suite.system_tests.palmer.status
test_suite.system_tests.pcs.status
test_suite.system_tests.peak_lists.status
test_suite.system_tests.pipes.status
test_suite.system_tests.rdc.status
test_suite.system_tests.relax_data.status
test_suite.system_tests.relax_fit.status
test_suite.system_tests.results.status
test_suite.system_tests.sequence.status
test_suite.system_tests.state.status
test_suite.system_tests.structure.status
test_suite.system_tests.unit_vectors.status
test_suite.test_suite_runner.status
test_suite.unit_tests._generic_fns._structure.test_api_base.status
test_suite.unit_tests._generic_fns._structure.test_internal.status
test_suite.unit_tests._generic_fns._structure.test_scientific.status
test_suite.unit_tests._maths_fns.test_frame_order_matrix_ops.status
test_suite.unit_tests._specific_fns._model_free.test_main.status
test_suite.unit_tests.relax_data_testing_base.status
test_suite.unit_tests.sequence_testing_base.status
test_suite.unit_tests.state_testing_base.status
version.status" class="py-name" href="#" onclick="return doclink('link-175', 'status', 'link-35');">status</a></tt><tt class="py-op">.</tt><tt class="py-name">observers</tt><tt class="py-op">.</tt><tt class="py-name">result_file</tt><tt class="py-op">.</tt><tt id="link-176" class="py-name" targets="Method status.Observer.notify()=status.Observer-class.html#notify"><a title="status.Observer.notify" class="py-name" href="#" onclick="return doclink('link-176', 'notify', 'link-176');">notify</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
</div><a name="L402"></a><tt class="py-lineno"> 402</tt>  <tt class="py-line"> </tt>
<a name="L403"></a><tt class="py-lineno"> 403</tt>  <tt class="py-line"> </tt>
<a name="create_diff_tensor_pdb"></a><div id="create_diff_tensor_pdb-def"><a name="L404"></a><tt class="py-lineno"> 404</tt> <a class="py-toggle" href="#" id="create_diff_tensor_pdb-toggle" onclick="return toggle('create_diff_tensor_pdb');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.geometric-module.html#create_diff_tensor_pdb">create_diff_tensor_pdb</a><tt class="py-op">(</tt><tt class="py-param">scale</tt><tt class="py-op">=</tt><tt class="py-number">1.8e-6</tt><tt class="py-op">,</tt> <tt class="py-param">file</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">dir</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">force</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="create_diff_tensor_pdb-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="create_diff_tensor_pdb-expanded"><a name="L405"></a><tt class="py-lineno"> 405</tt>  <tt class="py-line">    <tt class="py-docstring">"""Create the PDB representation of the diffusion tensor.</tt> </tt>
<a name="L406"></a><tt class="py-lineno"> 406</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L407"></a><tt class="py-lineno"> 407</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword scale: The scaling factor for the diffusion tensor.</tt> </tt>
<a name="L408"></a><tt class="py-lineno"> 408</tt>  <tt class="py-line"><tt class="py-docstring">    @type scale:    float</tt> </tt>
<a name="L409"></a><tt class="py-lineno"> 409</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword file:  The name of the PDB file to create.</tt> </tt>
<a name="L410"></a><tt class="py-lineno"> 410</tt>  <tt class="py-line"><tt class="py-docstring">    @type file:     str</tt> </tt>
<a name="L411"></a><tt class="py-lineno"> 411</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword dir:   The name of the directory to place the PDB file into.</tt> </tt>
<a name="L412"></a><tt class="py-lineno"> 412</tt>  <tt class="py-line"><tt class="py-docstring">    @type dir:      str</tt> </tt>
<a name="L413"></a><tt class="py-lineno"> 413</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword force: Flag which if set to True will overwrite any pre-existing file.</tt> </tt>
<a name="L414"></a><tt class="py-lineno"> 414</tt>  <tt class="py-line"><tt class="py-docstring">    @type force:    bool</tt> </tt>
<a name="L415"></a><tt class="py-lineno"> 415</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L416"></a><tt class="py-lineno"> 416</tt>  <tt class="py-line"> </tt>
<a name="L417"></a><tt class="py-lineno"> 417</tt>  <tt class="py-line">    <tt class="py-comment"># Arguments.</tt> </tt>
<a name="L418"></a><tt class="py-lineno"> 418</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">scale</tt> <tt class="py-op">==</tt> <tt class="py-string">'mass'</tt><tt class="py-op">:</tt> </tt>
<a name="L419"></a><tt class="py-lineno"> 419</tt>  <tt class="py-line">        <tt class="py-name">scale</tt> <tt class="py-op">=</tt> <tt id="link-177" class="py-name" targets="Function generic_fns.structure.geometric.autoscale_tensor()=generic_fns.structure.geometric-module.html#autoscale_tensor"><a title="generic_fns.structure.geometric.autoscale_tensor" class="py-name" href="#" onclick="return doclink('link-177', 'autoscale_tensor', 'link-177');">autoscale_tensor</a></tt><tt class="py-op">(</tt><tt class="py-name">scale</tt><tt class="py-op">)</tt> </tt>
<a name="L420"></a><tt class="py-lineno"> 420</tt>  <tt class="py-line"> </tt>
<a name="L421"></a><tt class="py-lineno"> 421</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L422"></a><tt class="py-lineno"> 422</tt>  <tt class="py-line">    <tt id="link-178" class="py-name"><a title="generic_fns.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-178', 'pipes', 'link-9');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-179" class="py-name" targets="Method bmrblib.pystarlib.TextTest.AllChecks.test()=bmrblib.pystarlib.TextTest.AllChecks-class.html#test,Method bmrblib.pystarlib.UtilsTest.AllChecks.test()=bmrblib.pystarlib.UtilsTest.AllChecks-class.html#test,Function generic_fns.pipes.test()=generic_fns.pipes-module.html#test"><a title="bmrblib.pystarlib.TextTest.AllChecks.test
bmrblib.pystarlib.UtilsTest.AllChecks.test
generic_fns.pipes.test" class="py-name" href="#" onclick="return doclink('link-179', 'test', 'link-179');">test</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L423"></a><tt class="py-lineno"> 423</tt>  <tt class="py-line"> </tt>
<a name="L424"></a><tt class="py-lineno"> 424</tt>  <tt class="py-line">    <tt class="py-comment"># Create an array of data pipes to loop over (hybrid support).</tt> </tt>
<a name="L425"></a><tt class="py-lineno"> 425</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pipe_type</tt> <tt class="py-op">==</tt> <tt class="py-string">'hybrid'</tt><tt class="py-op">:</tt> </tt>
<a name="L426"></a><tt class="py-lineno"> 426</tt>  <tt class="py-line">        <tt class="py-name">pipe_list</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">hybrid_pipes</tt> </tt>
<a name="L427"></a><tt class="py-lineno"> 427</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L428"></a><tt class="py-lineno"> 428</tt>  <tt class="py-line">        <tt class="py-name">pipe_list</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt id="link-180" class="py-name"><a title="generic_fns.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-180', 'pipes', 'link-9');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-181" class="py-name" targets="Function generic_fns.pipes.cdp_name()=generic_fns.pipes-module.html#cdp_name"><a title="generic_fns.pipes.cdp_name" class="py-name" href="#" onclick="return doclink('link-181', 'cdp_name', 'link-181');">cdp_name</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">]</tt> </tt>
<a name="L429"></a><tt class="py-lineno"> 429</tt>  <tt class="py-line"> </tt>
<a name="L430"></a><tt class="py-lineno"> 430</tt>  <tt class="py-line">    <tt class="py-comment"># Create the structural object.</tt> </tt>
<a name="L431"></a><tt class="py-lineno"> 431</tt>  <tt class="py-line">    <tt id="link-182" class="py-name"><a title="bmrblib.structure
generic_fns.structure
lib.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-182', 'structure', 'link-11');">structure</a></tt> <tt class="py-op">=</tt> <tt id="link-183" class="py-name"><a title="generic_fns.structure.internal.Internal" class="py-name" href="#" onclick="return doclink('link-183', 'Internal', 'link-13');">Internal</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L432"></a><tt class="py-lineno"> 432</tt>  <tt class="py-line"> </tt>
<a name="L433"></a><tt class="py-lineno"> 433</tt>  <tt class="py-line">    <tt class="py-comment"># Add a structure.</tt> </tt>
<a name="L434"></a><tt class="py-lineno"> 434</tt>  <tt class="py-line">    <tt id="link-184" class="py-name"><a title="bmrblib.structure
generic_fns.structure
lib.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-184', 'structure', 'link-11');">structure</a></tt><tt class="py-op">.</tt><tt id="link-185" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.add_molecule
generic_fns.structure.internal.Internal.add_molecule" class="py-name" href="#" onclick="return doclink('link-185', 'add_molecule', 'link-145');">add_molecule</a></tt><tt class="py-op">(</tt><tt id="link-186" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
generic_fns.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-186', 'name', 'link-146');">name</a></tt><tt class="py-op">=</tt><tt class="py-string">'diff_tensor'</tt><tt class="py-op">)</tt> </tt>
<a name="L435"></a><tt class="py-lineno"> 435</tt>  <tt class="py-line"> </tt>
<a name="L436"></a><tt class="py-lineno"> 436</tt>  <tt class="py-line">    <tt class="py-comment"># Alias the single molecule from the single model.</tt> </tt>
<a name="L437"></a><tt class="py-lineno"> 437</tt>  <tt class="py-line">    <tt class="py-name">mol</tt> <tt class="py-op">=</tt> <tt id="link-187" class="py-name"><a title="bmrblib.structure
generic_fns.structure
lib.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-187', 'structure', 'link-11');">structure</a></tt><tt class="py-op">.</tt><tt id="link-188" class="py-name" targets="Method generic_fns.structure.api_base.Base_struct_API.get_molecule()=generic_fns.structure.api_base.Base_struct_API-class.html#get_molecule,Method generic_fns.structure.internal.Internal.get_molecule()=generic_fns.structure.internal.Internal-class.html#get_molecule,Method generic_fns.structure.scientific.Scientific_data.get_molecule()=generic_fns.structure.scientific.Scientific_data-class.html#get_molecule"><a title="generic_fns.structure.api_base.Base_struct_API.get_molecule
generic_fns.structure.internal.Internal.get_molecule
generic_fns.structure.scientific.Scientific_data.get_molecule" class="py-name" href="#" onclick="return doclink('link-188', 'get_molecule', 'link-188');">get_molecule</a></tt><tt class="py-op">(</tt><tt class="py-string">'diff_tensor'</tt><tt class="py-op">)</tt> </tt>
<a name="L438"></a><tt class="py-lineno"> 438</tt>  <tt class="py-line"> </tt>
<a name="L439"></a><tt class="py-lineno"> 439</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over the pipes.</tt> </tt>
<a name="L440"></a><tt class="py-lineno"> 440</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">pipe_index</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">pipe_list</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L441"></a><tt class="py-lineno"> 441</tt>  <tt class="py-line">        <tt class="py-comment"># Get the pipe container.</tt> </tt>
<a name="L442"></a><tt class="py-lineno"> 442</tt>  <tt class="py-line">        <tt id="link-189" class="py-name" targets="Module user_functions.pipe=user_functions.pipe-module.html"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-189', 'pipe', 'link-189');">pipe</a></tt> <tt class="py-op">=</tt> <tt id="link-190" class="py-name"><a title="generic_fns.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-190', 'pipes', 'link-9');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-191" class="py-name" targets="Function generic_fns.pipes.get_pipe()=generic_fns.pipes-module.html#get_pipe"><a title="generic_fns.pipes.get_pipe" class="py-name" href="#" onclick="return doclink('link-191', 'get_pipe', 'link-191');">get_pipe</a></tt><tt class="py-op">(</tt><tt class="py-name">pipe_list</tt><tt class="py-op">[</tt><tt class="py-name">pipe_index</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L443"></a><tt class="py-lineno"> 443</tt>  <tt class="py-line"> </tt>
<a name="L444"></a><tt class="py-lineno"> 444</tt>  <tt class="py-line"> </tt>
<a name="L445"></a><tt class="py-lineno"> 445</tt>  <tt class="py-line">        <tt class="py-comment"># Tests.</tt> </tt>
<a name="L446"></a><tt class="py-lineno"> 446</tt>  <tt class="py-line">        <tt class="py-comment">########</tt> </tt>
<a name="L447"></a><tt class="py-lineno"> 447</tt>  <tt class="py-line"> </tt>
<a name="L448"></a><tt class="py-lineno"> 448</tt>  <tt class="py-line">        <tt class="py-comment"># Test if the diffusion tensor data is loaded.</tt> </tt>
<a name="L449"></a><tt class="py-lineno"> 449</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-192" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-192', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">,</tt> <tt class="py-string">'diff_tensor'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L450"></a><tt class="py-lineno"> 450</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-193" class="py-name"><a title="relax_errors.RelaxNoTensorError" class="py-name" href="#" onclick="return doclink('link-193', 'RelaxNoTensorError', 'link-28');">RelaxNoTensorError</a></tt><tt class="py-op">(</tt><tt class="py-string">'diffusion'</tt><tt class="py-op">)</tt> </tt>
<a name="L451"></a><tt class="py-lineno"> 451</tt>  <tt class="py-line"> </tt>
<a name="L452"></a><tt class="py-lineno"> 452</tt>  <tt class="py-line">        <tt class="py-comment"># Test if a structure has been loaded.</tt> </tt>
<a name="L453"></a><tt class="py-lineno"> 453</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L454"></a><tt class="py-lineno"> 454</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-194" class="py-name"><a title="relax_errors.RelaxNoPdbError" class="py-name" href="#" onclick="return doclink('link-194', 'RelaxNoPdbError', 'link-26');">RelaxNoPdbError</a></tt> </tt>
<a name="L455"></a><tt class="py-lineno"> 455</tt>  <tt class="py-line"> </tt>
<a name="L456"></a><tt class="py-lineno"> 456</tt>  <tt class="py-line"> </tt>
<a name="L457"></a><tt class="py-lineno"> 457</tt>  <tt class="py-line">        <tt class="py-comment"># Initialise.</tt> </tt>
<a name="L458"></a><tt class="py-lineno"> 458</tt>  <tt class="py-line">        <tt class="py-comment">#############</tt> </tt>
<a name="L459"></a><tt class="py-lineno"> 459</tt>  <tt class="py-line"> </tt>
<a name="L460"></a><tt class="py-lineno"> 460</tt>  <tt class="py-line">        <tt class="py-comment"># Initialise the residue number.</tt> </tt>
<a name="L461"></a><tt class="py-lineno"> 461</tt>  <tt class="py-line">        <tt class="py-name">res_num</tt> <tt class="py-op">=</tt> <tt class="py-number">1</tt> </tt>
<a name="L462"></a><tt class="py-lineno"> 462</tt>  <tt class="py-line"> </tt>
<a name="L463"></a><tt class="py-lineno"> 463</tt>  <tt class="py-line">        <tt class="py-comment"># The chain identifier.</tt> </tt>
<a name="L464"></a><tt class="py-lineno"> 464</tt>  <tt class="py-line">        <tt class="py-name">chain_id</tt> <tt class="py-op">=</tt> <tt class="py-name">ascii_uppercase</tt><tt class="py-op">[</tt><tt class="py-name">pipe_index</tt><tt class="py-op">]</tt> </tt>
<a name="L465"></a><tt class="py-lineno"> 465</tt>  <tt class="py-line"> </tt>
<a name="L466"></a><tt class="py-lineno"> 466</tt>  <tt class="py-line">        <tt class="py-comment"># Atom ID extension (allow for multiple chains for hybrid data pipes).</tt> </tt>
<a name="L467"></a><tt class="py-lineno"> 467</tt>  <tt class="py-line">        <tt class="py-name">atom_id_ext</tt> <tt class="py-op">=</tt> <tt class="py-string">'_'</tt> <tt class="py-op">+</tt> <tt class="py-name">chain_id</tt> </tt>
<a name="L468"></a><tt class="py-lineno"> 468</tt>  <tt class="py-line"> </tt>
<a name="L469"></a><tt class="py-lineno"> 469</tt>  <tt class="py-line">        <tt class="py-comment"># Print out.</tt> </tt>
<a name="L470"></a><tt class="py-lineno"> 470</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\nChain "</tt> <tt class="py-op">+</tt> <tt class="py-name">chain_id</tt> <tt class="py-op">+</tt> <tt class="py-string">"\n"</tt><tt class="py-op">)</tt> </tt>
<a name="L471"></a><tt class="py-lineno"> 471</tt>  <tt class="py-line"> </tt>
<a name="L472"></a><tt class="py-lineno"> 472</tt>  <tt class="py-line"> </tt>
<a name="L473"></a><tt class="py-lineno"> 473</tt>  <tt class="py-line">        <tt class="py-comment"># Centre of mass.</tt> </tt>
<a name="L474"></a><tt class="py-lineno"> 474</tt>  <tt class="py-line">        <tt class="py-comment">#################</tt> </tt>
<a name="L475"></a><tt class="py-lineno"> 475</tt>  <tt class="py-line"> </tt>
<a name="L476"></a><tt class="py-lineno"> 476</tt>  <tt class="py-line">        <tt class="py-comment"># Calculate the centre of mass.</tt> </tt>
<a name="L477"></a><tt class="py-lineno"> 477</tt>  <tt class="py-line">        <tt class="py-name">CoM</tt> <tt class="py-op">=</tt> <tt id="link-195" class="py-name"><a title="generic_fns.structure.mass.centre_of_mass" class="py-name" href="#" onclick="return doclink('link-195', 'centre_of_mass', 'link-17');">centre_of_mass</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L478"></a><tt class="py-lineno"> 478</tt>  <tt class="py-line"> </tt>
<a name="L479"></a><tt class="py-lineno"> 479</tt>  <tt class="py-line">        <tt class="py-comment"># Add the central atom.</tt> </tt>
<a name="L480"></a><tt class="py-lineno"> 480</tt>  <tt class="py-line">        <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-196" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_add" class="py-name" href="#" onclick="return doclink('link-196', 'atom_add', 'link-68');">atom_add</a></tt><tt class="py-op">(</tt><tt class="py-name">pdb_record</tt><tt class="py-op">=</tt><tt class="py-string">'HETATM'</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt class="py-string">'R'</tt><tt class="py-op">+</tt><tt class="py-name">atom_id_ext</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-string">'COM'</tt><tt class="py-op">,</tt> <tt class="py-name">chain_id</tt><tt class="py-op">=</tt><tt class="py-name">chain_id</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt><tt class="py-op">=</tt><tt class="py-name">CoM</tt><tt class="py-op">,</tt> <tt class="py-name">segment_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">element</tt><tt class="py-op">=</tt><tt class="py-string">'C'</tt><tt class="py-op">)</tt> </tt>
<a name="L481"></a><tt class="py-lineno"> 481</tt>  <tt class="py-line"> </tt>
<a name="L482"></a><tt class="py-lineno"> 482</tt>  <tt class="py-line">        <tt class="py-comment"># Increment the residue number.</tt> </tt>
<a name="L483"></a><tt class="py-lineno"> 483</tt>  <tt class="py-line">        <tt class="py-name">res_num</tt> <tt class="py-op">=</tt> <tt class="py-name">res_num</tt> <tt class="py-op">+</tt> <tt class="py-number">1</tt> </tt>
<a name="L484"></a><tt class="py-lineno"> 484</tt>  <tt class="py-line"> </tt>
<a name="L485"></a><tt class="py-lineno"> 485</tt>  <tt class="py-line"> </tt>
<a name="L486"></a><tt class="py-lineno"> 486</tt>  <tt class="py-line">        <tt class="py-comment"># Vector distribution.</tt> </tt>
<a name="L487"></a><tt class="py-lineno"> 487</tt>  <tt class="py-line">        <tt class="py-comment">######################</tt> </tt>
<a name="L488"></a><tt class="py-lineno"> 488</tt>  <tt class="py-line"> </tt>
<a name="L489"></a><tt class="py-lineno"> 489</tt>  <tt class="py-line">        <tt class="py-comment"># Print out.</tt> </tt>
<a name="L490"></a><tt class="py-lineno"> 490</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\nGenerating the geometric object."</tt><tt class="py-op">)</tt> </tt>
<a name="L491"></a><tt class="py-lineno"> 491</tt>  <tt class="py-line"> </tt>
<a name="L492"></a><tt class="py-lineno"> 492</tt>  <tt class="py-line">        <tt class="py-comment"># Swap the x and z axes for the oblate spheroid (the vector distributions are centred on the z-axis).</tt> </tt>
<a name="L493"></a><tt class="py-lineno"> 493</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-197" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-197', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-198" class="py-name" targets="Module data.diff_tensor=data.diff_tensor-module.html"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-198', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt id="link-199" class="py-name" targets="Function generic_fns.relax_data.type()=generic_fns.relax_data-module.html#type,Variable info.Bieri11.type=info.Bieri11-class.html#type,Variable info.Clore90.type=info.Clore90-class.html#type,Variable info.Delaglio95.type=info.Delaglio95-class.html#type,Variable info.GoddardKneller.type=info.GoddardKneller-class.html#type,Variable info.LipariSzabo82a.type=info.LipariSzabo82a-class.html#type,Variable info.LipariSzabo82b.type=info.LipariSzabo82b-class.html#type,Variable info.Ref.type=info.Ref-class.html#type,Variable info.dAuvergne06.type=info.dAuvergne06-class.html#type,Variable info.dAuvergneGooley03.type=info.dAuvergneGooley03-class.html#type,Variable info.dAuvergneGooley06.type=info.dAuvergneGooley06-class.html#type,Variable info.dAuvergneGooley07.type=info.dAuvergneGooley07-class.html#type,Variable info.dAuvergneGooley08a.type=info.dAuvergneGooley08a-class.html#type,Variable info.dAuvergneGooley08b.type=info.dAuvergneGooley08b-class.html#type"><a title="generic_fns.relax_data.type
info.Bieri11.type
info.Clore90.type
info.Delaglio95.type
info.GoddardKneller.type
info.LipariSzabo82a.type
info.LipariSzabo82b.type
info.Ref.type
info.dAuvergne06.type
info.dAuvergneGooley03.type
info.dAuvergneGooley06.type
info.dAuvergneGooley07.type
info.dAuvergneGooley08a.type
info.dAuvergneGooley08b.type" class="py-name" href="#" onclick="return doclink('link-199', 'type', 'link-199');">type</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'spheroid'</tt> <tt class="py-keyword">and</tt> <tt id="link-200" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-200', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-201" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-201', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">spheroid_type</tt> <tt class="py-op">==</tt> <tt class="py-string">'oblate'</tt><tt class="py-op">:</tt> </tt>
<a name="L494"></a><tt class="py-lineno"> 494</tt>  <tt class="py-line">            <tt class="py-comment"># 90 deg rotation about the diffusion frame y-axis.</tt> </tt>
<a name="L495"></a><tt class="py-lineno"> 495</tt>  <tt class="py-line">            <tt class="py-name">y_rot</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">[</tt>  <tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-number">0</tt><tt class="py-op">,</tt>  <tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> </tt>
<a name="L496"></a><tt class="py-lineno"> 496</tt>  <tt class="py-line">                           <tt class="py-op">[</tt>  <tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-number">1</tt><tt class="py-op">,</tt>  <tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> </tt>
<a name="L497"></a><tt class="py-lineno"> 497</tt>  <tt class="py-line">                           <tt class="py-op">[</tt> <tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-number">0</tt><tt class="py-op">,</tt>  <tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L498"></a><tt class="py-lineno"> 498</tt>  <tt class="py-line"> </tt>
<a name="L499"></a><tt class="py-lineno"> 499</tt>  <tt class="py-line">            <tt class="py-comment"># Rotate the tensor and rotation matrix.</tt> </tt>
<a name="L500"></a><tt class="py-lineno"> 500</tt>  <tt class="py-line">            <tt class="py-name">rotation</tt> <tt class="py-op">=</tt> <tt class="py-name">dot</tt><tt class="py-op">(</tt><tt id="link-202" class="py-name"><a title="bmrblib.pystarlib.Utils.transpose" class="py-name" href="#" onclick="return doclink('link-202', 'transpose', 'link-0');">transpose</a></tt><tt class="py-op">(</tt><tt id="link-203" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-203', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-204" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-204', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">rotation</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">y_rot</tt><tt class="py-op">)</tt> </tt>
<a name="L501"></a><tt class="py-lineno"> 501</tt>  <tt class="py-line">            <tt id="link-205" class="py-name" targets="Module bmrblib.structure.tensor=bmrblib.structure.tensor-module.html"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-205', 'tensor', 'link-205');">tensor</a></tt> <tt class="py-op">=</tt> <tt class="py-name">dot</tt><tt class="py-op">(</tt><tt class="py-name">y_rot</tt><tt class="py-op">,</tt> <tt class="py-name">dot</tt><tt class="py-op">(</tt><tt id="link-206" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-206', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-207" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-207', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">tensor_diag</tt><tt class="py-op">,</tt> <tt id="link-208" class="py-name"><a title="bmrblib.pystarlib.Utils.transpose" class="py-name" href="#" onclick="return doclink('link-208', 'transpose', 'link-0');">transpose</a></tt><tt class="py-op">(</tt><tt class="py-name">y_rot</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L502"></a><tt class="py-lineno"> 502</tt>  <tt class="py-line">            <tt id="link-209" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-209', 'tensor', 'link-205');">tensor</a></tt> <tt class="py-op">=</tt> <tt class="py-name">dot</tt><tt class="py-op">(</tt><tt class="py-name">rotation</tt><tt class="py-op">,</tt> <tt class="py-name">dot</tt><tt class="py-op">(</tt><tt id="link-210" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-210', 'tensor', 'link-205');">tensor</a></tt><tt class="py-op">,</tt> <tt id="link-211" class="py-name"><a title="bmrblib.pystarlib.Utils.transpose" class="py-name" href="#" onclick="return doclink('link-211', 'transpose', 'link-0');">transpose</a></tt><tt class="py-op">(</tt><tt class="py-name">rotation</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L503"></a><tt class="py-lineno"> 503</tt>  <tt class="py-line"> </tt>
<a name="L504"></a><tt class="py-lineno"> 504</tt>  <tt class="py-line">        <tt class="py-comment"># All other systems stay as normal.</tt> </tt>
<a name="L505"></a><tt class="py-lineno"> 505</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L506"></a><tt class="py-lineno"> 506</tt>  <tt class="py-line">            <tt id="link-212" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-212', 'tensor', 'link-205');">tensor</a></tt> <tt class="py-op">=</tt> <tt id="link-213" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-213', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-214" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-214', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt id="link-215" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-215', 'tensor', 'link-205');">tensor</a></tt> </tt>
<a name="L507"></a><tt class="py-lineno"> 507</tt>  <tt class="py-line">            <tt class="py-name">rotation</tt> <tt class="py-op">=</tt> <tt id="link-216" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-216', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-217" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-217', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">rotation</tt> </tt>
<a name="L508"></a><tt class="py-lineno"> 508</tt>  <tt class="py-line"> </tt>
<a name="L509"></a><tt class="py-lineno"> 509</tt>  <tt class="py-line">        <tt class="py-comment"># The distribution.</tt> </tt>
<a name="L510"></a><tt class="py-lineno"> 510</tt>  <tt class="py-line">        <tt id="link-218" class="py-name"><a title="generic_fns.structure.geometric.generate_vector_dist" class="py-name" href="#" onclick="return doclink('link-218', 'generate_vector_dist', 'link-154');">generate_vector_dist</a></tt><tt class="py-op">(</tt><tt class="py-name">mol</tt><tt class="py-op">=</tt><tt class="py-name">mol</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-string">'TNS'</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">chain_id</tt><tt class="py-op">=</tt><tt class="py-name">chain_id</tt><tt class="py-op">,</tt> <tt id="link-219" class="py-name"><a title="generic_fns.paramag.centre
generic_fns.pcs.centre
info.Info_box.centre" class="py-name" href="#" onclick="return doclink('link-219', 'centre', 'link-155');">centre</a></tt><tt class="py-op">=</tt><tt class="py-name">CoM</tt><tt class="py-op">,</tt> <tt id="link-220" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-220', 'R', 'link-71');">R</a></tt><tt class="py-op">=</tt><tt class="py-name">rotation</tt><tt class="py-op">,</tt> <tt class="py-name">warp</tt><tt class="py-op">=</tt><tt id="link-221" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-221', 'tensor', 'link-205');">tensor</a></tt><tt class="py-op">,</tt> <tt class="py-name">scale</tt><tt class="py-op">=</tt><tt class="py-name">scale</tt><tt class="py-op">,</tt> <tt class="py-name">inc</tt><tt class="py-op">=</tt><tt class="py-number">20</tt><tt class="py-op">)</tt> </tt>
<a name="L511"></a><tt class="py-lineno"> 511</tt>  <tt class="py-line"> </tt>
<a name="L512"></a><tt class="py-lineno"> 512</tt>  <tt class="py-line">        <tt class="py-comment"># Increment the residue number.</tt> </tt>
<a name="L513"></a><tt class="py-lineno"> 513</tt>  <tt class="py-line">        <tt class="py-name">res_num</tt> <tt class="py-op">=</tt> <tt class="py-name">res_num</tt> <tt class="py-op">+</tt> <tt class="py-number">1</tt> </tt>
<a name="L514"></a><tt class="py-lineno"> 514</tt>  <tt class="py-line"> </tt>
<a name="L515"></a><tt class="py-lineno"> 515</tt>  <tt class="py-line"> </tt>
<a name="L516"></a><tt class="py-lineno"> 516</tt>  <tt class="py-line">        <tt class="py-comment"># Axes of the tensor.</tt> </tt>
<a name="L517"></a><tt class="py-lineno"> 517</tt>  <tt class="py-line">        <tt class="py-comment">#####################</tt> </tt>
<a name="L518"></a><tt class="py-lineno"> 518</tt>  <tt class="py-line"> </tt>
<a name="L519"></a><tt class="py-lineno"> 519</tt>  <tt class="py-line">        <tt class="py-comment"># Create the unique axis of the spheroid.</tt> </tt>
<a name="L520"></a><tt class="py-lineno"> 520</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-222" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-222', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-223" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-223', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt id="link-224" class="py-name"><a title="generic_fns.relax_data.type
info.Bieri11.type
info.Clore90.type
info.Delaglio95.type
info.GoddardKneller.type
info.LipariSzabo82a.type
info.LipariSzabo82b.type
info.Ref.type
info.dAuvergne06.type
info.dAuvergneGooley03.type
info.dAuvergneGooley06.type
info.dAuvergneGooley07.type
info.dAuvergneGooley08a.type
info.dAuvergneGooley08b.type" class="py-name" href="#" onclick="return doclink('link-224', 'type', 'link-199');">type</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'spheroid'</tt><tt class="py-op">:</tt> </tt>
<a name="L521"></a><tt class="py-lineno"> 521</tt>  <tt class="py-line">            <tt class="py-comment"># Print out.</tt> </tt>
<a name="L522"></a><tt class="py-lineno"> 522</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\nGenerating the unique axis of the diffusion tensor."</tt><tt class="py-op">)</tt> </tt>
<a name="L523"></a><tt class="py-lineno"> 523</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"    Scaling factor:                      "</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">scale</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L524"></a><tt class="py-lineno"> 524</tt>  <tt class="py-line"> </tt>
<a name="L525"></a><tt class="py-lineno"> 525</tt>  <tt class="py-line">            <tt class="py-comment"># Simulations.</tt> </tt>
<a name="L526"></a><tt class="py-lineno"> 526</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-225" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-225', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-226" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-226', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">,</tt> <tt class="py-string">'tm_sim'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L527"></a><tt class="py-lineno"> 527</tt>  <tt class="py-line">                <tt class="py-name">sim_vectors</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L528"></a><tt class="py-lineno"> 528</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt id="link-227" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-227', 'i', 'link-40');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-228" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-228', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-229" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-229', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">tm_sim</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L529"></a><tt class="py-lineno"> 529</tt>  <tt class="py-line">                    <tt class="py-name">sim_vectors</tt><tt class="py-op">.</tt><tt id="link-230" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-230', 'append', 'link-171');">append</a></tt><tt class="py-op">(</tt><tt id="link-231" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-231', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-232" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-232', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dpar_sim</tt><tt class="py-op">[</tt><tt id="link-233" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-233', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">*</tt> <tt id="link-234" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-234', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-235" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-235', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dpar_unit_sim</tt><tt class="py-op">[</tt><tt id="link-236" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-236', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L530"></a><tt class="py-lineno"> 530</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L531"></a><tt class="py-lineno"> 531</tt>  <tt class="py-line">                <tt class="py-name">sim_vectors</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L532"></a><tt class="py-lineno"> 532</tt>  <tt class="py-line"> </tt>
<a name="L533"></a><tt class="py-lineno"> 533</tt>  <tt class="py-line">            <tt class="py-comment"># Generate the axes representation.</tt> </tt>
<a name="L534"></a><tt class="py-lineno"> 534</tt>  <tt class="py-line">            <tt class="py-name">res_num</tt> <tt class="py-op">=</tt> <tt id="link-237" class="py-name"><a title="generic_fns.structure.geometric.generate_vector_residues" class="py-name" href="#" onclick="return doclink('link-237', 'generate_vector_residues', 'link-149');">generate_vector_residues</a></tt><tt class="py-op">(</tt><tt class="py-name">mol</tt><tt class="py-op">=</tt><tt class="py-name">mol</tt><tt class="py-op">,</tt> <tt class="py-name">vector</tt><tt class="py-op">=</tt><tt id="link-238" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-238', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-239" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-239', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dpar</tt><tt class="py-op">*</tt><tt id="link-240" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-240', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-241" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-241', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dpar_unit</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt class="py-string">'Dpar'</tt><tt class="py-op">,</tt> <tt class="py-name">res_name_vect</tt><tt class="py-op">=</tt><tt class="py-string">'AXS'</tt><tt class="py-op">,</tt> <tt class="py-name">sim_vectors</tt><tt class="py-op">=</tt><tt class="py-name">sim_vectors</tt><tt class="py-op">,</tt> <tt class="py-name">chain_id</tt><tt class="py-op">=</tt><tt class="py-name">chain_id</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">origin</tt><tt class="py-op">=</tt><tt class="py-name">CoM</tt><tt class="py-op">,</tt> <tt class="py-name">scale</tt><tt class="py-op">=</tt><tt class="py-name">scale</tt><tt class="py-op">,</tt> <tt class="py-name">neg</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L535"></a><tt class="py-lineno"> 535</tt>  <tt class="py-line"> </tt>
<a name="L536"></a><tt class="py-lineno"> 536</tt>  <tt class="py-line"> </tt>
<a name="L537"></a><tt class="py-lineno"> 537</tt>  <tt class="py-line">        <tt class="py-comment"># Create the three axes of the ellipsoid.</tt> </tt>
<a name="L538"></a><tt class="py-lineno"> 538</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-242" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-242', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-243" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-243', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt id="link-244" class="py-name"><a title="generic_fns.relax_data.type
info.Bieri11.type
info.Clore90.type
info.Delaglio95.type
info.GoddardKneller.type
info.LipariSzabo82a.type
info.LipariSzabo82b.type
info.Ref.type
info.dAuvergne06.type
info.dAuvergneGooley03.type
info.dAuvergneGooley06.type
info.dAuvergneGooley07.type
info.dAuvergneGooley08a.type
info.dAuvergneGooley08b.type" class="py-name" href="#" onclick="return doclink('link-244', 'type', 'link-199');">type</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'ellipsoid'</tt><tt class="py-op">:</tt> </tt>
<a name="L539"></a><tt class="py-lineno"> 539</tt>  <tt class="py-line">            <tt class="py-comment"># Print out.</tt> </tt>
<a name="L540"></a><tt class="py-lineno"> 540</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Generating the three axes of the ellipsoid."</tt><tt class="py-op">)</tt> </tt>
<a name="L541"></a><tt class="py-lineno"> 541</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"    Scaling factor:                      "</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">scale</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L542"></a><tt class="py-lineno"> 542</tt>  <tt class="py-line"> </tt>
<a name="L543"></a><tt class="py-lineno"> 543</tt>  <tt class="py-line">            <tt class="py-comment"># Simulations.</tt> </tt>
<a name="L544"></a><tt class="py-lineno"> 544</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-245" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-245', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-246" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-246', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">,</tt> <tt class="py-string">'tm_sim'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L545"></a><tt class="py-lineno"> 545</tt>  <tt class="py-line">                <tt class="py-name">sim_Dx_vectors</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L546"></a><tt class="py-lineno"> 546</tt>  <tt class="py-line">                <tt class="py-name">sim_Dy_vectors</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L547"></a><tt class="py-lineno"> 547</tt>  <tt class="py-line">                <tt class="py-name">sim_Dz_vectors</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L548"></a><tt class="py-lineno"> 548</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt id="link-247" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-247', 'i', 'link-40');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-248" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-248', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-249" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-249', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">tm_sim</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L549"></a><tt class="py-lineno"> 549</tt>  <tt class="py-line">                    <tt class="py-name">sim_Dx_vectors</tt><tt class="py-op">.</tt><tt id="link-250" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-250', 'append', 'link-171');">append</a></tt><tt class="py-op">(</tt><tt id="link-251" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-251', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-252" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-252', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dx_sim</tt><tt class="py-op">[</tt><tt id="link-253" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-253', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">*</tt> <tt id="link-254" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-254', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-255" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-255', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dx_unit_sim</tt><tt class="py-op">[</tt><tt id="link-256" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-256', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L550"></a><tt class="py-lineno"> 550</tt>  <tt class="py-line">                    <tt class="py-name">sim_Dy_vectors</tt><tt class="py-op">.</tt><tt id="link-257" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-257', 'append', 'link-171');">append</a></tt><tt class="py-op">(</tt><tt id="link-258" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-258', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-259" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-259', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dy_sim</tt><tt class="py-op">[</tt><tt id="link-260" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-260', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">*</tt> <tt id="link-261" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-261', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-262" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-262', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dy_unit_sim</tt><tt class="py-op">[</tt><tt id="link-263" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-263', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L551"></a><tt class="py-lineno"> 551</tt>  <tt class="py-line">                    <tt class="py-name">sim_Dz_vectors</tt><tt class="py-op">.</tt><tt id="link-264" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-264', 'append', 'link-171');">append</a></tt><tt class="py-op">(</tt><tt id="link-265" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-265', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-266" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-266', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dz_sim</tt><tt class="py-op">[</tt><tt id="link-267" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-267', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">*</tt> <tt id="link-268" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-268', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-269" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-269', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dz_unit_sim</tt><tt class="py-op">[</tt><tt id="link-270" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-270', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L552"></a><tt class="py-lineno"> 552</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L553"></a><tt class="py-lineno"> 553</tt>  <tt class="py-line">                <tt class="py-name">sim_Dx_vectors</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L554"></a><tt class="py-lineno"> 554</tt>  <tt class="py-line">                <tt class="py-name">sim_Dy_vectors</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L555"></a><tt class="py-lineno"> 555</tt>  <tt class="py-line">                <tt class="py-name">sim_Dz_vectors</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L556"></a><tt class="py-lineno"> 556</tt>  <tt class="py-line"> </tt>
<a name="L557"></a><tt class="py-lineno"> 557</tt>  <tt class="py-line">            <tt class="py-comment"># Generate the axes representation.</tt> </tt>
<a name="L558"></a><tt class="py-lineno"> 558</tt>  <tt class="py-line">            <tt class="py-name">res_num</tt> <tt class="py-op">=</tt> <tt id="link-271" class="py-name"><a title="generic_fns.structure.geometric.generate_vector_residues" class="py-name" href="#" onclick="return doclink('link-271', 'generate_vector_residues', 'link-149');">generate_vector_residues</a></tt><tt class="py-op">(</tt><tt class="py-name">mol</tt><tt class="py-op">=</tt><tt class="py-name">mol</tt><tt class="py-op">,</tt> <tt class="py-name">vector</tt><tt class="py-op">=</tt><tt id="link-272" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-272', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-273" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-273', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dx</tt><tt class="py-op">*</tt><tt id="link-274" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-274', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-275" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-275', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dx_unit</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt class="py-string">'Dx'</tt><tt class="py-op">,</tt> <tt class="py-name">res_name_vect</tt><tt class="py-op">=</tt><tt class="py-string">'AXS'</tt><tt class="py-op">,</tt> <tt class="py-name">sim_vectors</tt><tt class="py-op">=</tt><tt class="py-name">sim_Dx_vectors</tt><tt class="py-op">,</tt> <tt class="py-name">chain_id</tt><tt class="py-op">=</tt><tt class="py-name">chain_id</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">origin</tt><tt class="py-op">=</tt><tt class="py-name">CoM</tt><tt class="py-op">,</tt> <tt class="py-name">scale</tt><tt class="py-op">=</tt><tt class="py-name">scale</tt><tt class="py-op">,</tt> <tt class="py-name">neg</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L559"></a><tt class="py-lineno"> 559</tt>  <tt class="py-line">            <tt class="py-name">res_num</tt> <tt class="py-op">=</tt> <tt id="link-276" class="py-name"><a title="generic_fns.structure.geometric.generate_vector_residues" class="py-name" href="#" onclick="return doclink('link-276', 'generate_vector_residues', 'link-149');">generate_vector_residues</a></tt><tt class="py-op">(</tt><tt class="py-name">mol</tt><tt class="py-op">=</tt><tt class="py-name">mol</tt><tt class="py-op">,</tt> <tt class="py-name">vector</tt><tt class="py-op">=</tt><tt id="link-277" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-277', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-278" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-278', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dy</tt><tt class="py-op">*</tt><tt id="link-279" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-279', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-280" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-280', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dy_unit</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt class="py-string">'Dy'</tt><tt class="py-op">,</tt> <tt class="py-name">res_name_vect</tt><tt class="py-op">=</tt><tt class="py-string">'AXS'</tt><tt class="py-op">,</tt> <tt class="py-name">sim_vectors</tt><tt class="py-op">=</tt><tt class="py-name">sim_Dy_vectors</tt><tt class="py-op">,</tt> <tt class="py-name">chain_id</tt><tt class="py-op">=</tt><tt class="py-name">chain_id</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">origin</tt><tt class="py-op">=</tt><tt class="py-name">CoM</tt><tt class="py-op">,</tt> <tt class="py-name">scale</tt><tt class="py-op">=</tt><tt class="py-name">scale</tt><tt class="py-op">,</tt> <tt class="py-name">neg</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L560"></a><tt class="py-lineno"> 560</tt>  <tt class="py-line">            <tt class="py-name">res_num</tt> <tt class="py-op">=</tt> <tt id="link-281" class="py-name"><a title="generic_fns.structure.geometric.generate_vector_residues" class="py-name" href="#" onclick="return doclink('link-281', 'generate_vector_residues', 'link-149');">generate_vector_residues</a></tt><tt class="py-op">(</tt><tt class="py-name">mol</tt><tt class="py-op">=</tt><tt class="py-name">mol</tt><tt class="py-op">,</tt> <tt class="py-name">vector</tt><tt class="py-op">=</tt><tt id="link-282" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-282', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-283" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-283', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dz</tt><tt class="py-op">*</tt><tt id="link-284" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-284', 'pipe', 'link-189');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-285" class="py-name"><a title="data.diff_tensor" class="py-name" href="#" onclick="return doclink('link-285', 'diff_tensor', 'link-198');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dz_unit</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt class="py-string">'Dz'</tt><tt class="py-op">,</tt> <tt class="py-name">res_name_vect</tt><tt class="py-op">=</tt><tt class="py-string">'AXS'</tt><tt class="py-op">,</tt> <tt class="py-name">sim_vectors</tt><tt class="py-op">=</tt><tt class="py-name">sim_Dz_vectors</tt><tt class="py-op">,</tt> <tt class="py-name">chain_id</tt><tt class="py-op">=</tt><tt class="py-name">chain_id</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">origin</tt><tt class="py-op">=</tt><tt class="py-name">CoM</tt><tt class="py-op">,</tt> <tt class="py-name">scale</tt><tt class="py-op">=</tt><tt class="py-name">scale</tt><tt class="py-op">,</tt> <tt class="py-name">neg</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L561"></a><tt class="py-lineno"> 561</tt>  <tt class="py-line"> </tt>
<a name="L562"></a><tt class="py-lineno"> 562</tt>  <tt class="py-line"> </tt>
<a name="L563"></a><tt class="py-lineno"> 563</tt>  <tt class="py-line">    <tt class="py-comment"># Create the PDB file.</tt> </tt>
<a name="L564"></a><tt class="py-lineno"> 564</tt>  <tt class="py-line">    <tt class="py-comment">######################</tt> </tt>
<a name="L565"></a><tt class="py-lineno"> 565</tt>  <tt class="py-line"> </tt>
<a name="L566"></a><tt class="py-lineno"> 566</tt>  <tt class="py-line">    <tt class="py-comment"># Print out.</tt> </tt>
<a name="L567"></a><tt class="py-lineno"> 567</tt>  <tt class="py-line">    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\nGenerating the PDB file."</tt><tt class="py-op">)</tt> </tt>
<a name="L568"></a><tt class="py-lineno"> 568</tt>  <tt class="py-line"> </tt>
<a name="L569"></a><tt class="py-lineno"> 569</tt>  <tt class="py-line">    <tt class="py-comment"># Open the PDB file for writing.</tt> </tt>
<a name="L570"></a><tt class="py-lineno"> 570</tt>  <tt class="py-line">    <tt class="py-name">tensor_pdb_file</tt> <tt class="py-op">=</tt> <tt id="link-286" class="py-name"><a title="relax_io.open_write_file" class="py-name" href="#" onclick="return doclink('link-286', 'open_write_file', 'link-32');">open_write_file</a></tt><tt class="py-op">(</tt><tt id="link-287" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-287', 'file', 'link-161');">file</a></tt><tt class="py-op">,</tt> <tt id="link-288" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-288', 'dir', 'link-164');">dir</a></tt><tt class="py-op">,</tt> <tt class="py-name">force</tt><tt class="py-op">=</tt><tt class="py-name">force</tt><tt class="py-op">)</tt> </tt>
<a name="L571"></a><tt class="py-lineno"> 571</tt>  <tt class="py-line"> </tt>
<a name="L572"></a><tt class="py-lineno"> 572</tt>  <tt class="py-line">    <tt class="py-comment"># Write the data.</tt> </tt>
<a name="L573"></a><tt class="py-lineno"> 573</tt>  <tt class="py-line">    <tt id="link-289" class="py-name"><a title="bmrblib.structure
generic_fns.structure
lib.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-289', 'structure', 'link-11');">structure</a></tt><tt class="py-op">.</tt><tt id="link-290" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.write_pdb
generic_fns.structure.internal.Internal.write_pdb
generic_fns.structure.main.write_pdb" class="py-name" href="#" onclick="return doclink('link-290', 'write_pdb', 'link-167');">write_pdb</a></tt><tt class="py-op">(</tt><tt class="py-name">tensor_pdb_file</tt><tt class="py-op">)</tt> </tt>
<a name="L574"></a><tt class="py-lineno"> 574</tt>  <tt class="py-line"> </tt>
<a name="L575"></a><tt class="py-lineno"> 575</tt>  <tt class="py-line">    <tt class="py-comment"># Close the file.</tt> </tt>
<a name="L576"></a><tt class="py-lineno"> 576</tt>  <tt class="py-line">    <tt class="py-name">tensor_pdb_file</tt><tt class="py-op">.</tt><tt id="link-291" class="py-name"><a title="gui.input_elements.sequence.Sequence_window.close
relax_io.DummyFileObject.close" class="py-name" href="#" onclick="return doclink('link-291', 'close', 'link-168');">close</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L577"></a><tt class="py-lineno"> 577</tt>  <tt class="py-line"> </tt>
<a name="L578"></a><tt class="py-lineno"> 578</tt>  <tt class="py-line">    <tt class="py-comment"># Add the file to the results file list.</tt> </tt>
<a name="L579"></a><tt class="py-lineno"> 579</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'result_files'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L580"></a><tt class="py-lineno"> 580</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-292" class="py-name"><a title="generic_fns.result_files" class="py-name" href="#" onclick="return doclink('link-292', 'result_files', 'link-169');">result_files</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L581"></a><tt class="py-lineno"> 581</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-293" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-293', 'dir', 'link-164');">dir</a></tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L582"></a><tt class="py-lineno"> 582</tt>  <tt class="py-line">        <tt id="link-294" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-294', 'dir', 'link-164');">dir</a></tt> <tt class="py-op">=</tt> <tt class="py-name">getcwd</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L583"></a><tt class="py-lineno"> 583</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-295" class="py-name"><a title="generic_fns.result_files" class="py-name" href="#" onclick="return doclink('link-295', 'result_files', 'link-169');">result_files</a></tt><tt class="py-op">.</tt><tt id="link-296" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-296', 'append', 'link-171');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-string">'diff_tensor_pdb'</tt><tt class="py-op">,</tt> <tt class="py-string">'Diffusion tensor PDB'</tt><tt class="py-op">,</tt> <tt id="link-297" class="py-name"><a title="relax_io.get_file_path" class="py-name" href="#" onclick="return doclink('link-297', 'get_file_path', 'link-31');">get_file_path</a></tt><tt class="py-op">(</tt><tt id="link-298" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-298', 'file', 'link-161');">file</a></tt><tt class="py-op">,</tt> <tt id="link-299" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-299', 'dir', 'link-164');">dir</a></tt><tt class="py-op">)</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L584"></a><tt class="py-lineno"> 584</tt>  <tt class="py-line">    <tt id="link-300" class="py-name"><a title="auto_analyses.dauvergne_protocol.status
auto_analyses.noe.status
auto_analyses.relax_fit.status
auto_analyses.stereochem_analysis.status
data.status
generic_fns.bmrb.status
generic_fns.grace.status
generic_fns.minimise.status
generic_fns.mol_res_spin.status
generic_fns.molmol.status
generic_fns.pipes.status
generic_fns.pymol_control.status
generic_fns.result_files.status
generic_fns.script.status
generic_fns.state.status
generic_fns.structure.geometric.status
generic_fns.value.status
gui.about.status
gui.analyses.auto_model_free.status
gui.analyses.auto_noe.status
gui.analyses.auto_rx_base.status
gui.analyses.execute.status
gui.analyses.results_analysis.status
gui.analyses.status
gui.components.base_list.status
gui.components.free_file_format.status
gui.components.grid.status
gui.components.molecule.status
gui.components.relax_data.status
gui.components.relax_data_meta.status
gui.components.spectrum.status
gui.controller.status
gui.errors.status
gui.export_bmrb.status
gui.filedialog.status
gui.fonts.status
gui.icons.status
gui.input_elements.bool.status
gui.input_elements.dir.status
gui.input_elements.file.status
gui.input_elements.sequence.status
gui.input_elements.sequence_2D.status
gui.interpreter.status
gui.menu.status
gui.message.status
gui.misc.status
gui.paths.status
gui.pipe_editor.status
gui.relax_gui.status
gui.relax_prompt.status
gui.results_viewer.status
gui.spin_viewer.frame.status
gui.spin_viewer.tree.status
gui.status
gui.string_conv.status
gui.uf_objects.status
gui.wizard.status
info.Bieri11.status
info.Clore90.status
info.Delaglio95.status
info.GoddardKneller.status
info.LipariSzabo82a.status
info.LipariSzabo82b.status
info.Ref.status
info.dAuvergne06.status
info.dAuvergneGooley03.status
info.dAuvergneGooley06.status
info.dAuvergneGooley07.status
info.dAuvergneGooley08a.status
info.dAuvergneGooley08b.status
info.status
prompt.command.status
prompt.help.status
prompt.interpreter.status
prompt.uf_docstring.status
prompt.uf_objects.status
relax.status
relax_warnings.status
scons.manuals.status
setup.status
status
test_suite.gui_tests.base_classes.status
test_suite.gui_tests.bruker.status
test_suite.gui_tests.model_free.status
test_suite.gui_tests.noe.status
test_suite.gui_tests.rx.status
test_suite.gui_tests.state.status
test_suite.gui_tests.test_user_functions.status
test_suite.relax_test_loader.status
test_suite.relax_test_runner.status
test_suite.system_tests.angles.status
test_suite.system_tests.bmrb.status
test_suite.system_tests.bruker.status
test_suite.system_tests.consistency_tests.status
test_suite.system_tests.dasha.status
test_suite.system_tests.diffusion_tensor.status
test_suite.system_tests.frame_order.status
test_suite.system_tests.generic.status
test_suite.system_tests.grace.status
test_suite.system_tests.interatomic.status
test_suite.system_tests.jw_mapping.status
test_suite.system_tests.load_spins.status
test_suite.system_tests.model_elimination.status
test_suite.system_tests.model_free.status
test_suite.system_tests.model_selection.status
test_suite.system_tests.mol_res_spin.status
test_suite.system_tests.n_state_model.status
test_suite.system_tests.noe.status
test_suite.system_tests.noe_restraints.status
test_suite.system_tests.palmer.status
test_suite.system_tests.pcs.status
test_suite.system_tests.peak_lists.status
test_suite.system_tests.pipes.status
test_suite.system_tests.rdc.status
test_suite.system_tests.relax_data.status
test_suite.system_tests.relax_fit.status
test_suite.system_tests.results.status
test_suite.system_tests.sequence.status
test_suite.system_tests.state.status
test_suite.system_tests.structure.status
test_suite.system_tests.unit_vectors.status
test_suite.test_suite_runner.status
test_suite.unit_tests._generic_fns._structure.test_api_base.status
test_suite.unit_tests._generic_fns._structure.test_internal.status
test_suite.unit_tests._generic_fns._structure.test_scientific.status
test_suite.unit_tests._maths_fns.test_frame_order_matrix_ops.status
test_suite.unit_tests._specific_fns._model_free.test_main.status
test_suite.unit_tests.relax_data_testing_base.status
test_suite.unit_tests.sequence_testing_base.status
test_suite.unit_tests.state_testing_base.status
version.status" class="py-name" href="#" onclick="return doclink('link-300', 'status', 'link-35');">status</a></tt><tt class="py-op">.</tt><tt class="py-name">observers</tt><tt class="py-op">.</tt><tt class="py-name">result_file</tt><tt class="py-op">.</tt><tt id="link-301" class="py-name"><a title="status.Observer.notify" class="py-name" href="#" onclick="return doclink('link-301', 'notify', 'link-176');">notify</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
</div><a name="L585"></a><tt class="py-lineno"> 585</tt>  <tt class="py-line"> </tt>
<a name="L586"></a><tt class="py-lineno"> 586</tt>  <tt class="py-line"> </tt>
<a name="create_rotor_pdb"></a><div id="create_rotor_pdb-def"><a name="L587"></a><tt class="py-lineno"> 587</tt> <a class="py-toggle" href="#" id="create_rotor_pdb-toggle" onclick="return toggle('create_rotor_pdb');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.geometric-module.html#create_rotor_pdb">create_rotor_pdb</a><tt class="py-op">(</tt><tt class="py-param">file</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">dir</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">rotor_angle</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">axis</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">axis_pt</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-param">centre</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">span</tt><tt class="py-op">=</tt><tt class="py-number">2e-9</tt><tt class="py-op">,</tt> <tt class="py-param">blade_length</tt><tt class="py-op">=</tt><tt class="py-number">5e-10</tt><tt class="py-op">,</tt> <tt class="py-param">force</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">,</tt> <tt class="py-param">staggered</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="create_rotor_pdb-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="create_rotor_pdb-expanded"><a name="L588"></a><tt class="py-lineno"> 588</tt>  <tt class="py-line">    <tt class="py-docstring">"""Create a PDB representation of a rotor motional model.</tt> </tt>
<a name="L589"></a><tt class="py-lineno"> 589</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L590"></a><tt class="py-lineno"> 590</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword file:          The name of the PDB file to create.</tt> </tt>
<a name="L591"></a><tt class="py-lineno"> 591</tt>  <tt class="py-line"><tt class="py-docstring">    @type file:             str</tt> </tt>
<a name="L592"></a><tt class="py-lineno"> 592</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword dir:           The name of the directory to place the PDB file into.</tt> </tt>
<a name="L593"></a><tt class="py-lineno"> 593</tt>  <tt class="py-line"><tt class="py-docstring">    @type dir:              str</tt> </tt>
<a name="L594"></a><tt class="py-lineno"> 594</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword rotor_angle:   The angle of the rotor motion in degrees.</tt> </tt>
<a name="L595"></a><tt class="py-lineno"> 595</tt>  <tt class="py-line"><tt class="py-docstring">    @type rotor_angle:      float</tt> </tt>
<a name="L596"></a><tt class="py-lineno"> 596</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword axis:          The vector defining the rotor axis.</tt> </tt>
<a name="L597"></a><tt class="py-lineno"> 597</tt>  <tt class="py-line"><tt class="py-docstring">    @type axis:             numpy rank-1, 3D array</tt> </tt>
<a name="L598"></a><tt class="py-lineno"> 598</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword axis_pt:       A point lying anywhere on the rotor axis.  This is used to define the position of the axis in 3D space.</tt> </tt>
<a name="L599"></a><tt class="py-lineno"> 599</tt>  <tt class="py-line"><tt class="py-docstring">    @type axis_pt:          numpy rank-1, 3D array</tt> </tt>
<a name="L600"></a><tt class="py-lineno"> 600</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword centre:        The central point of the representation.  If this point is not on the rotor axis, then the closest point on the axis will be used for the centre.</tt> </tt>
<a name="L601"></a><tt class="py-lineno"> 601</tt>  <tt class="py-line"><tt class="py-docstring">    @type centre:           numpy rank-1, 3D array</tt> </tt>
<a name="L602"></a><tt class="py-lineno"> 602</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword span:          The distance from the central point to the rotor blades (meters).</tt> </tt>
<a name="L603"></a><tt class="py-lineno"> 603</tt>  <tt class="py-line"><tt class="py-docstring">    @type span:             float</tt> </tt>
<a name="L604"></a><tt class="py-lineno"> 604</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword blade_length:  The length of the representative rotor blades.</tt> </tt>
<a name="L605"></a><tt class="py-lineno"> 605</tt>  <tt class="py-line"><tt class="py-docstring">    @type blade_length:     float</tt> </tt>
<a name="L606"></a><tt class="py-lineno"> 606</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword force:         A flag which if set will overwrite any pre-existing file.</tt> </tt>
<a name="L607"></a><tt class="py-lineno"> 607</tt>  <tt class="py-line"><tt class="py-docstring">    @type force:            bool</tt> </tt>
<a name="L608"></a><tt class="py-lineno"> 608</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword staggered:     A flag which if True will cause the rotor blades to be staggered.  This is used to avoid blade overlap.</tt> </tt>
<a name="L609"></a><tt class="py-lineno"> 609</tt>  <tt class="py-line"><tt class="py-docstring">    @type staggered:        bool</tt> </tt>
<a name="L610"></a><tt class="py-lineno"> 610</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L611"></a><tt class="py-lineno"> 611</tt>  <tt class="py-line"> </tt>
<a name="L612"></a><tt class="py-lineno"> 612</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current pipe exists.</tt> </tt>
<a name="L613"></a><tt class="py-lineno"> 613</tt>  <tt class="py-line">    <tt id="link-302" class="py-name"><a title="generic_fns.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-302', 'pipes', 'link-9');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-303" class="py-name"><a title="bmrblib.pystarlib.TextTest.AllChecks.test
bmrblib.pystarlib.UtilsTest.AllChecks.test
generic_fns.pipes.test" class="py-name" href="#" onclick="return doclink('link-303', 'test', 'link-179');">test</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L614"></a><tt class="py-lineno"> 614</tt>  <tt class="py-line"> </tt>
<a name="L615"></a><tt class="py-lineno"> 615</tt>  <tt class="py-line">    <tt class="py-comment"># Convert the angle to radians.</tt> </tt>
<a name="L616"></a><tt class="py-lineno"> 616</tt>  <tt class="py-line">    <tt class="py-name">rotor_angle</tt> <tt class="py-op">=</tt> <tt class="py-name">rotor_angle</tt> <tt class="py-op">/</tt> <tt class="py-number">360.0</tt> <tt class="py-op">*</tt> <tt class="py-number">2.0</tt> <tt class="py-op">*</tt> <tt class="py-name">pi</tt> </tt>
<a name="L617"></a><tt class="py-lineno"> 617</tt>  <tt class="py-line"> </tt>
<a name="L618"></a><tt class="py-lineno"> 618</tt>  <tt class="py-line">    <tt class="py-comment"># Create the structural object.</tt> </tt>
<a name="L619"></a><tt class="py-lineno"> 619</tt>  <tt class="py-line">    <tt id="link-304" class="py-name"><a title="bmrblib.structure
generic_fns.structure
lib.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-304', 'structure', 'link-11');">structure</a></tt> <tt class="py-op">=</tt> <tt id="link-305" class="py-name"><a title="generic_fns.structure.internal.Internal" class="py-name" href="#" onclick="return doclink('link-305', 'Internal', 'link-13');">Internal</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L620"></a><tt class="py-lineno"> 620</tt>  <tt class="py-line"> </tt>
<a name="L621"></a><tt class="py-lineno"> 621</tt>  <tt class="py-line">    <tt class="py-comment"># Generate the rotor object.</tt> </tt>
<a name="L622"></a><tt class="py-lineno"> 622</tt>  <tt class="py-line">    <tt id="link-306" class="py-name"><a title="lib.structure.rotor.rotor_pdb" class="py-name" href="#" onclick="return doclink('link-306', 'rotor_pdb', 'link-21');">rotor_pdb</a></tt><tt class="py-op">(</tt><tt id="link-307" class="py-name"><a title="bmrblib.structure
generic_fns.structure
lib.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-307', 'structure', 'link-11');">structure</a></tt><tt class="py-op">=</tt><tt id="link-308" class="py-name"><a title="bmrblib.structure
generic_fns.structure
lib.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-308', 'structure', 'link-11');">structure</a></tt><tt class="py-op">,</tt> <tt class="py-name">rotor_angle</tt><tt class="py-op">=</tt><tt class="py-name">rotor_angle</tt><tt class="py-op">,</tt> <tt class="py-name">axis</tt><tt class="py-op">=</tt><tt class="py-name">axis</tt><tt class="py-op">,</tt> <tt class="py-name">axis_pt</tt><tt class="py-op">=</tt><tt class="py-name">axis_pt</tt><tt class="py-op">,</tt> <tt id="link-309" class="py-name"><a title="generic_fns.paramag.centre
generic_fns.pcs.centre
info.Info_box.centre" class="py-name" href="#" onclick="return doclink('link-309', 'centre', 'link-155');">centre</a></tt><tt class="py-op">=</tt><tt id="link-310" class="py-name"><a title="generic_fns.paramag.centre
generic_fns.pcs.centre
info.Info_box.centre" class="py-name" href="#" onclick="return doclink('link-310', 'centre', 'link-155');">centre</a></tt><tt class="py-op">,</tt> <tt class="py-name">span</tt><tt class="py-op">=</tt><tt class="py-name">span</tt><tt class="py-op">,</tt> <tt class="py-name">blade_length</tt><tt class="py-op">=</tt><tt class="py-name">blade_length</tt><tt class="py-op">,</tt> <tt class="py-name">staggered</tt><tt class="py-op">=</tt><tt class="py-name">staggered</tt><tt class="py-op">)</tt> </tt>
<a name="L623"></a><tt class="py-lineno"> 623</tt>  <tt class="py-line"> </tt>
<a name="L624"></a><tt class="py-lineno"> 624</tt>  <tt class="py-line">    <tt class="py-comment"># Print out.</tt> </tt>
<a name="L625"></a><tt class="py-lineno"> 625</tt>  <tt class="py-line">    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\nGenerating the PDB file."</tt><tt class="py-op">)</tt> </tt>
<a name="L626"></a><tt class="py-lineno"> 626</tt>  <tt class="py-line"> </tt>
<a name="L627"></a><tt class="py-lineno"> 627</tt>  <tt class="py-line">    <tt class="py-comment"># Open the PDB file for writing.</tt> </tt>
<a name="L628"></a><tt class="py-lineno"> 628</tt>  <tt class="py-line">    <tt class="py-name">tensor_pdb_file</tt> <tt class="py-op">=</tt> <tt id="link-311" class="py-name"><a title="relax_io.open_write_file" class="py-name" href="#" onclick="return doclink('link-311', 'open_write_file', 'link-32');">open_write_file</a></tt><tt class="py-op">(</tt><tt id="link-312" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-312', 'file', 'link-161');">file</a></tt><tt class="py-op">,</tt> <tt id="link-313" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-313', 'dir', 'link-164');">dir</a></tt><tt class="py-op">,</tt> <tt class="py-name">force</tt><tt class="py-op">=</tt><tt class="py-name">force</tt><tt class="py-op">)</tt> </tt>
<a name="L629"></a><tt class="py-lineno"> 629</tt>  <tt class="py-line"> </tt>
<a name="L630"></a><tt class="py-lineno"> 630</tt>  <tt class="py-line">    <tt class="py-comment"># Write the data.</tt> </tt>
<a name="L631"></a><tt class="py-lineno"> 631</tt>  <tt class="py-line">    <tt id="link-314" class="py-name"><a title="bmrblib.structure
generic_fns.structure
lib.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-314', 'structure', 'link-11');">structure</a></tt><tt class="py-op">.</tt><tt id="link-315" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.write_pdb
generic_fns.structure.internal.Internal.write_pdb
generic_fns.structure.main.write_pdb" class="py-name" href="#" onclick="return doclink('link-315', 'write_pdb', 'link-167');">write_pdb</a></tt><tt class="py-op">(</tt><tt class="py-name">tensor_pdb_file</tt><tt class="py-op">)</tt> </tt>
<a name="L632"></a><tt class="py-lineno"> 632</tt>  <tt class="py-line"> </tt>
<a name="L633"></a><tt class="py-lineno"> 633</tt>  <tt class="py-line">    <tt class="py-comment"># Close the file.</tt> </tt>
<a name="L634"></a><tt class="py-lineno"> 634</tt>  <tt class="py-line">    <tt class="py-name">tensor_pdb_file</tt><tt class="py-op">.</tt><tt id="link-316" class="py-name"><a title="gui.input_elements.sequence.Sequence_window.close
relax_io.DummyFileObject.close" class="py-name" href="#" onclick="return doclink('link-316', 'close', 'link-168');">close</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L635"></a><tt class="py-lineno"> 635</tt>  <tt class="py-line"> </tt>
<a name="L636"></a><tt class="py-lineno"> 636</tt>  <tt class="py-line">    <tt class="py-comment"># Add the file to the results file list.</tt> </tt>
<a name="L637"></a><tt class="py-lineno"> 637</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'result_files'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L638"></a><tt class="py-lineno"> 638</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-317" class="py-name"><a title="generic_fns.result_files" class="py-name" href="#" onclick="return doclink('link-317', 'result_files', 'link-169');">result_files</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L639"></a><tt class="py-lineno"> 639</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-318" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-318', 'dir', 'link-164');">dir</a></tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L640"></a><tt class="py-lineno"> 640</tt>  <tt class="py-line">        <tt id="link-319" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-319', 'dir', 'link-164');">dir</a></tt> <tt class="py-op">=</tt> <tt class="py-name">getcwd</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L641"></a><tt class="py-lineno"> 641</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-320" class="py-name"><a title="generic_fns.result_files" class="py-name" href="#" onclick="return doclink('link-320', 'result_files', 'link-169');">result_files</a></tt><tt class="py-op">.</tt><tt id="link-321" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-321', 'append', 'link-171');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-string">'diff_tensor_pdb'</tt><tt class="py-op">,</tt> <tt class="py-string">'Diffusion tensor PDB'</tt><tt class="py-op">,</tt> <tt id="link-322" class="py-name"><a title="relax_io.get_file_path" class="py-name" href="#" onclick="return doclink('link-322', 'get_file_path', 'link-31');">get_file_path</a></tt><tt class="py-op">(</tt><tt id="link-323" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-323', 'file', 'link-161');">file</a></tt><tt class="py-op">,</tt> <tt id="link-324" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-324', 'dir', 'link-164');">dir</a></tt><tt class="py-op">)</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L642"></a><tt class="py-lineno"> 642</tt>  <tt class="py-line">    <tt id="link-325" class="py-name"><a title="auto_analyses.dauvergne_protocol.status
auto_analyses.noe.status
auto_analyses.relax_fit.status
auto_analyses.stereochem_analysis.status
data.status
generic_fns.bmrb.status
generic_fns.grace.status
generic_fns.minimise.status
generic_fns.mol_res_spin.status
generic_fns.molmol.status
generic_fns.pipes.status
generic_fns.pymol_control.status
generic_fns.result_files.status
generic_fns.script.status
generic_fns.state.status
generic_fns.structure.geometric.status
generic_fns.value.status
gui.about.status
gui.analyses.auto_model_free.status
gui.analyses.auto_noe.status
gui.analyses.auto_rx_base.status
gui.analyses.execute.status
gui.analyses.results_analysis.status
gui.analyses.status
gui.components.base_list.status
gui.components.free_file_format.status
gui.components.grid.status
gui.components.molecule.status
gui.components.relax_data.status
gui.components.relax_data_meta.status
gui.components.spectrum.status
gui.controller.status
gui.errors.status
gui.export_bmrb.status
gui.filedialog.status
gui.fonts.status
gui.icons.status
gui.input_elements.bool.status
gui.input_elements.dir.status
gui.input_elements.file.status
gui.input_elements.sequence.status
gui.input_elements.sequence_2D.status
gui.interpreter.status
gui.menu.status
gui.message.status
gui.misc.status
gui.paths.status
gui.pipe_editor.status
gui.relax_gui.status
gui.relax_prompt.status
gui.results_viewer.status
gui.spin_viewer.frame.status
gui.spin_viewer.tree.status
gui.status
gui.string_conv.status
gui.uf_objects.status
gui.wizard.status
info.Bieri11.status
info.Clore90.status
info.Delaglio95.status
info.GoddardKneller.status
info.LipariSzabo82a.status
info.LipariSzabo82b.status
info.Ref.status
info.dAuvergne06.status
info.dAuvergneGooley03.status
info.dAuvergneGooley06.status
info.dAuvergneGooley07.status
info.dAuvergneGooley08a.status
info.dAuvergneGooley08b.status
info.status
prompt.command.status
prompt.help.status
prompt.interpreter.status
prompt.uf_docstring.status
prompt.uf_objects.status
relax.status
relax_warnings.status
scons.manuals.status
setup.status
status
test_suite.gui_tests.base_classes.status
test_suite.gui_tests.bruker.status
test_suite.gui_tests.model_free.status
test_suite.gui_tests.noe.status
test_suite.gui_tests.rx.status
test_suite.gui_tests.state.status
test_suite.gui_tests.test_user_functions.status
test_suite.relax_test_loader.status
test_suite.relax_test_runner.status
test_suite.system_tests.angles.status
test_suite.system_tests.bmrb.status
test_suite.system_tests.bruker.status
test_suite.system_tests.consistency_tests.status
test_suite.system_tests.dasha.status
test_suite.system_tests.diffusion_tensor.status
test_suite.system_tests.frame_order.status
test_suite.system_tests.generic.status
test_suite.system_tests.grace.status
test_suite.system_tests.interatomic.status
test_suite.system_tests.jw_mapping.status
test_suite.system_tests.load_spins.status
test_suite.system_tests.model_elimination.status
test_suite.system_tests.model_free.status
test_suite.system_tests.model_selection.status
test_suite.system_tests.mol_res_spin.status
test_suite.system_tests.n_state_model.status
test_suite.system_tests.noe.status
test_suite.system_tests.noe_restraints.status
test_suite.system_tests.palmer.status
test_suite.system_tests.pcs.status
test_suite.system_tests.peak_lists.status
test_suite.system_tests.pipes.status
test_suite.system_tests.rdc.status
test_suite.system_tests.relax_data.status
test_suite.system_tests.relax_fit.status
test_suite.system_tests.results.status
test_suite.system_tests.sequence.status
test_suite.system_tests.state.status
test_suite.system_tests.structure.status
test_suite.system_tests.unit_vectors.status
test_suite.test_suite_runner.status
test_suite.unit_tests._generic_fns._structure.test_api_base.status
test_suite.unit_tests._generic_fns._structure.test_internal.status
test_suite.unit_tests._generic_fns._structure.test_scientific.status
test_suite.unit_tests._maths_fns.test_frame_order_matrix_ops.status
test_suite.unit_tests._specific_fns._model_free.test_main.status
test_suite.unit_tests.relax_data_testing_base.status
test_suite.unit_tests.sequence_testing_base.status
test_suite.unit_tests.state_testing_base.status
version.status" class="py-name" href="#" onclick="return doclink('link-325', 'status', 'link-35');">status</a></tt><tt class="py-op">.</tt><tt class="py-name">observers</tt><tt class="py-op">.</tt><tt class="py-name">result_file</tt><tt class="py-op">.</tt><tt id="link-326" class="py-name"><a title="status.Observer.notify" class="py-name" href="#" onclick="return doclink('link-326', 'notify', 'link-176');">notify</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
</div><a name="L643"></a><tt class="py-lineno"> 643</tt>  <tt class="py-line"> </tt>
<a name="L644"></a><tt class="py-lineno"> 644</tt>  <tt class="py-line"> </tt>
<a name="create_vector_dist"></a><div id="create_vector_dist-def"><a name="L645"></a><tt class="py-lineno"> 645</tt> <a class="py-toggle" href="#" id="create_vector_dist-toggle" onclick="return toggle('create_vector_dist');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.geometric-module.html#create_vector_dist">create_vector_dist</a><tt class="py-op">(</tt><tt class="py-param">length</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">symmetry</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-param">file</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">dir</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">force</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="create_vector_dist-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="create_vector_dist-expanded"><a name="L646"></a><tt class="py-lineno"> 646</tt>  <tt class="py-line">    <tt class="py-docstring">"""Create a PDB representation of the vector distribution.</tt> </tt>
<a name="L647"></a><tt class="py-lineno"> 647</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L648"></a><tt class="py-lineno"> 648</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword length:    The length to set the vectors to in the PDB file.</tt> </tt>
<a name="L649"></a><tt class="py-lineno"> 649</tt>  <tt class="py-line"><tt class="py-docstring">    @type length:       float</tt> </tt>
<a name="L650"></a><tt class="py-lineno"> 650</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword symmetry:  The symmetry flag which if set will create a second PDB chain 'B' which is the same as chain 'A' but with the vectors reversed.</tt> </tt>
<a name="L651"></a><tt class="py-lineno"> 651</tt>  <tt class="py-line"><tt class="py-docstring">    @type symmetry:     bool</tt> </tt>
<a name="L652"></a><tt class="py-lineno"> 652</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword file:      The name of the PDB file to create.</tt> </tt>
<a name="L653"></a><tt class="py-lineno"> 653</tt>  <tt class="py-line"><tt class="py-docstring">    @type file:         str</tt> </tt>
<a name="L654"></a><tt class="py-lineno"> 654</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword dir:       The name of the directory to place the PDB file into.</tt> </tt>
<a name="L655"></a><tt class="py-lineno"> 655</tt>  <tt class="py-line"><tt class="py-docstring">    @type dir:          str</tt> </tt>
<a name="L656"></a><tt class="py-lineno"> 656</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword force:     Flag which if set will overwrite any pre-existing file.</tt> </tt>
<a name="L657"></a><tt class="py-lineno"> 657</tt>  <tt class="py-line"><tt class="py-docstring">    @type force:        bool</tt> </tt>
<a name="L658"></a><tt class="py-lineno"> 658</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L659"></a><tt class="py-lineno"> 659</tt>  <tt class="py-line"> </tt>
<a name="L660"></a><tt class="py-lineno"> 660</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current pipe exists.</tt> </tt>
<a name="L661"></a><tt class="py-lineno"> 661</tt>  <tt class="py-line">    <tt id="link-327" class="py-name"><a title="generic_fns.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-327', 'pipes', 'link-9');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-328" class="py-name"><a title="bmrblib.pystarlib.TextTest.AllChecks.test
bmrblib.pystarlib.UtilsTest.AllChecks.test
generic_fns.pipes.test" class="py-name" href="#" onclick="return doclink('link-328', 'test', 'link-179');">test</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L662"></a><tt class="py-lineno"> 662</tt>  <tt class="py-line"> </tt>
<a name="L663"></a><tt class="py-lineno"> 663</tt>  <tt class="py-line">    <tt class="py-comment"># Test if a structure has been loaded.</tt> </tt>
<a name="L664"></a><tt class="py-lineno"> 664</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-329" class="py-name"><a title="bmrblib.structure
generic_fns.structure
lib.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-329', 'structure', 'link-11');">structure</a></tt><tt class="py-op">.</tt><tt id="link-330" class="py-name" targets="Method generic_fns.structure.api_base.Base_struct_API.num_models()=generic_fns.structure.api_base.Base_struct_API-class.html#num_models"><a title="generic_fns.structure.api_base.Base_struct_API.num_models" class="py-name" href="#" onclick="return doclink('link-330', 'num_models', 'link-330');">num_models</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-op">&gt;</tt> <tt class="py-number">0</tt><tt class="py-op">:</tt> </tt>
<a name="L665"></a><tt class="py-lineno"> 665</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-331" class="py-name"><a title="relax_errors.RelaxNoPdbError" class="py-name" href="#" onclick="return doclink('link-331', 'RelaxNoPdbError', 'link-26');">RelaxNoPdbError</a></tt> </tt>
<a name="L666"></a><tt class="py-lineno"> 666</tt>  <tt class="py-line"> </tt>
<a name="L667"></a><tt class="py-lineno"> 667</tt>  <tt class="py-line">    <tt class="py-comment"># Test if sequence data is loaded.</tt> </tt>
<a name="L668"></a><tt class="py-lineno"> 668</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-332" class="py-name"><a title="generic_fns.mol_res_spin.exists_mol_res_spin_data" class="py-name" href="#" onclick="return doclink('link-332', 'exists_mol_res_spin_data', 'link-6');">exists_mol_res_spin_data</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L669"></a><tt class="py-lineno"> 669</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-333" class="py-name"><a title="relax_errors.RelaxNoSequenceError" class="py-name" href="#" onclick="return doclink('link-333', 'RelaxNoSequenceError', 'link-27');">RelaxNoSequenceError</a></tt> </tt>
<a name="L670"></a><tt class="py-lineno"> 670</tt>  <tt class="py-line"> </tt>
<a name="L671"></a><tt class="py-lineno"> 671</tt>  <tt class="py-line">    <tt class="py-comment"># Test if unit vectors exist.</tt> </tt>
<a name="L672"></a><tt class="py-lineno"> 672</tt>  <tt class="py-line">    <tt id="link-334" class="py-name" targets="Function generic_fns.structure.main.vectors()=generic_fns.structure.main-module.html#vectors,Module maths_fns.vectors=maths_fns.vectors-module.html"><a title="generic_fns.structure.main.vectors
maths_fns.vectors" class="py-name" href="#" onclick="return doclink('link-334', 'vectors', 'link-334');">vectors</a></tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L673"></a><tt class="py-lineno"> 673</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">interatom</tt> <tt class="py-keyword">in</tt> <tt id="link-335" class="py-name"><a title="generic_fns.interatomic.interatomic_loop" class="py-name" href="#" onclick="return doclink('link-335', 'interatomic_loop', 'link-3');">interatomic_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L674"></a><tt class="py-lineno"> 674</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">interatom</tt><tt class="py-op">,</tt> <tt class="py-string">'vector'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L675"></a><tt class="py-lineno"> 675</tt>  <tt class="py-line">            <tt id="link-336" class="py-name"><a title="generic_fns.structure.main.vectors
maths_fns.vectors" class="py-name" href="#" onclick="return doclink('link-336', 'vectors', 'link-334');">vectors</a></tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L676"></a><tt class="py-lineno"> 676</tt>  <tt class="py-line">            <tt class="py-keyword">break</tt> </tt>
<a name="L677"></a><tt class="py-lineno"> 677</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-337" class="py-name"><a title="generic_fns.structure.main.vectors
maths_fns.vectors" class="py-name" href="#" onclick="return doclink('link-337', 'vectors', 'link-334');">vectors</a></tt><tt class="py-op">:</tt> </tt>
<a name="L678"></a><tt class="py-lineno"> 678</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-338" class="py-name"><a title="relax_errors.RelaxNoVectorsError" class="py-name" href="#" onclick="return doclink('link-338', 'RelaxNoVectorsError', 'link-29');">RelaxNoVectorsError</a></tt> </tt>
<a name="L679"></a><tt class="py-lineno"> 679</tt>  <tt class="py-line"> </tt>
<a name="L680"></a><tt class="py-lineno"> 680</tt>  <tt class="py-line"> </tt>
<a name="L681"></a><tt class="py-lineno"> 681</tt>  <tt class="py-line">    <tt class="py-comment"># Initialise.</tt> </tt>
<a name="L682"></a><tt class="py-lineno"> 682</tt>  <tt class="py-line">    <tt class="py-comment">#############</tt> </tt>
<a name="L683"></a><tt class="py-lineno"> 683</tt>  <tt class="py-line"> </tt>
<a name="L684"></a><tt class="py-lineno"> 684</tt>  <tt class="py-line">    <tt class="py-comment"># Create the structural object.</tt> </tt>
<a name="L685"></a><tt class="py-lineno"> 685</tt>  <tt class="py-line">    <tt id="link-339" class="py-name"><a title="bmrblib.structure
generic_fns.structure
lib.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-339', 'structure', 'link-11');">structure</a></tt> <tt class="py-op">=</tt> <tt id="link-340" class="py-name"><a title="generic_fns.structure.internal.Internal" class="py-name" href="#" onclick="return doclink('link-340', 'Internal', 'link-13');">Internal</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L686"></a><tt class="py-lineno"> 686</tt>  <tt class="py-line"> </tt>
<a name="L687"></a><tt class="py-lineno"> 687</tt>  <tt class="py-line">    <tt class="py-comment"># Add a structure.</tt> </tt>
<a name="L688"></a><tt class="py-lineno"> 688</tt>  <tt class="py-line">    <tt id="link-341" class="py-name"><a title="bmrblib.structure
generic_fns.structure
lib.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-341', 'structure', 'link-11');">structure</a></tt><tt class="py-op">.</tt><tt id="link-342" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.add_molecule
generic_fns.structure.internal.Internal.add_molecule" class="py-name" href="#" onclick="return doclink('link-342', 'add_molecule', 'link-145');">add_molecule</a></tt><tt class="py-op">(</tt><tt id="link-343" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
generic_fns.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-343', 'name', 'link-146');">name</a></tt><tt class="py-op">=</tt><tt class="py-string">'vector_dist'</tt><tt class="py-op">)</tt> </tt>
<a name="L689"></a><tt class="py-lineno"> 689</tt>  <tt class="py-line"> </tt>
<a name="L690"></a><tt class="py-lineno"> 690</tt>  <tt class="py-line">    <tt class="py-comment"># Alias the single molecule from the single model.</tt> </tt>
<a name="L691"></a><tt class="py-lineno"> 691</tt>  <tt class="py-line">    <tt class="py-name">mol</tt> <tt class="py-op">=</tt> <tt id="link-344" class="py-name"><a title="bmrblib.structure
generic_fns.structure
lib.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-344', 'structure', 'link-11');">structure</a></tt><tt class="py-op">.</tt><tt class="py-name">structural_data</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">mol</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L692"></a><tt class="py-lineno"> 692</tt>  <tt class="py-line"> </tt>
<a name="L693"></a><tt class="py-lineno"> 693</tt>  <tt class="py-line">    <tt class="py-comment"># Initialise the residue and atom numbers.</tt> </tt>
<a name="L694"></a><tt class="py-lineno"> 694</tt>  <tt class="py-line">    <tt class="py-name">res_num</tt> <tt class="py-op">=</tt> <tt class="py-number">1</tt> </tt>
<a name="L695"></a><tt class="py-lineno"> 695</tt>  <tt class="py-line">    <tt class="py-name">atom_num</tt> <tt class="py-op">=</tt> <tt class="py-number">1</tt> </tt>
<a name="L696"></a><tt class="py-lineno"> 696</tt>  <tt class="py-line"> </tt>
<a name="L697"></a><tt class="py-lineno"> 697</tt>  <tt class="py-line"> </tt>
<a name="L698"></a><tt class="py-lineno"> 698</tt>  <tt class="py-line">    <tt class="py-comment"># Centre of mass.</tt> </tt>
<a name="L699"></a><tt class="py-lineno"> 699</tt>  <tt class="py-line">    <tt class="py-comment">#################</tt> </tt>
<a name="L700"></a><tt class="py-lineno"> 700</tt>  <tt class="py-line"> </tt>
<a name="L701"></a><tt class="py-lineno"> 701</tt>  <tt class="py-line">    <tt class="py-comment"># Calculate the centre of mass.</tt> </tt>
<a name="L702"></a><tt class="py-lineno"> 702</tt>  <tt class="py-line">    <tt id="link-345" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-345', 'R', 'link-71');">R</a></tt> <tt class="py-op">=</tt> <tt id="link-346" class="py-name"><a title="generic_fns.structure.mass.centre_of_mass" class="py-name" href="#" onclick="return doclink('link-346', 'centre_of_mass', 'link-17');">centre_of_mass</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L703"></a><tt class="py-lineno"> 703</tt>  <tt class="py-line"> </tt>
<a name="L704"></a><tt class="py-lineno"> 704</tt>  <tt class="py-line">    <tt class="py-comment"># Increment the residue number.</tt> </tt>
<a name="L705"></a><tt class="py-lineno"> 705</tt>  <tt class="py-line">    <tt class="py-name">res_num</tt> <tt class="py-op">=</tt> <tt class="py-name">res_num</tt> <tt class="py-op">+</tt> <tt class="py-number">1</tt> </tt>
<a name="L706"></a><tt class="py-lineno"> 706</tt>  <tt class="py-line"> </tt>
<a name="L707"></a><tt class="py-lineno"> 707</tt>  <tt class="py-line"> </tt>
<a name="L708"></a><tt class="py-lineno"> 708</tt>  <tt class="py-line">    <tt class="py-comment"># The vectors.</tt> </tt>
<a name="L709"></a><tt class="py-lineno"> 709</tt>  <tt class="py-line">    <tt class="py-comment">##############</tt> </tt>
<a name="L710"></a><tt class="py-lineno"> 710</tt>  <tt class="py-line"> </tt>
<a name="L711"></a><tt class="py-lineno"> 711</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over the interatomic data containers.</tt> </tt>
<a name="L712"></a><tt class="py-lineno"> 712</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">interatom</tt> <tt class="py-keyword">in</tt> <tt id="link-347" class="py-name"><a title="generic_fns.interatomic.interatomic_loop" class="py-name" href="#" onclick="return doclink('link-347', 'interatomic_loop', 'link-3');">interatomic_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L713"></a><tt class="py-lineno"> 713</tt>  <tt class="py-line">        <tt class="py-comment"># Get the spins.</tt> </tt>
<a name="L714"></a><tt class="py-lineno"> 714</tt>  <tt class="py-line">        <tt class="py-name">spin1</tt> <tt class="py-op">=</tt> <tt id="link-348" class="py-name"><a title="generic_fns.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-348', 'return_spin', 'link-7');">return_spin</a></tt><tt class="py-op">(</tt><tt class="py-name">interatom</tt><tt class="py-op">.</tt><tt class="py-name">spin_id1</tt><tt class="py-op">)</tt> </tt>
<a name="L715"></a><tt class="py-lineno"> 715</tt>  <tt class="py-line">        <tt class="py-name">spin2</tt> <tt class="py-op">=</tt> <tt id="link-349" class="py-name"><a title="generic_fns.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-349', 'return_spin', 'link-7');">return_spin</a></tt><tt class="py-op">(</tt><tt class="py-name">interatom</tt><tt class="py-op">.</tt><tt class="py-name">spin_id2</tt><tt class="py-op">)</tt> </tt>
<a name="L716"></a><tt class="py-lineno"> 716</tt>  <tt class="py-line"> </tt>
<a name="L717"></a><tt class="py-lineno"> 717</tt>  <tt class="py-line">        <tt class="py-comment"># Skip deselected spin systems.</tt> </tt>
<a name="L718"></a><tt class="py-lineno"> 718</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">spin1</tt><tt class="py-op">.</tt><tt id="link-350" class="py-name" targets="Function generic_fns.model_selection.select()=generic_fns.model_selection-module.html#select,Module user_functions.select=user_functions.select-module.html"><a title="generic_fns.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-350', 'select', 'link-350');">select</a></tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">spin2</tt><tt class="py-op">.</tt><tt id="link-351" class="py-name"><a title="generic_fns.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-351', 'select', 'link-350');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L719"></a><tt class="py-lineno"> 719</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L720"></a><tt class="py-lineno"> 720</tt>  <tt class="py-line"> </tt>
<a name="L721"></a><tt class="py-lineno"> 721</tt>  <tt class="py-line">        <tt class="py-comment"># Skip containers missing vectors.</tt> </tt>
<a name="L722"></a><tt class="py-lineno"> 722</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">interatom</tt><tt class="py-op">,</tt> <tt class="py-string">'vector'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L723"></a><tt class="py-lineno"> 723</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L724"></a><tt class="py-lineno"> 724</tt>  <tt class="py-line"> </tt>
<a name="L725"></a><tt class="py-lineno"> 725</tt>  <tt class="py-line">        <tt class="py-comment"># Scale the vector.</tt> </tt>
<a name="L726"></a><tt class="py-lineno"> 726</tt>  <tt class="py-line">        <tt class="py-name">vector</tt> <tt class="py-op">=</tt> <tt class="py-name">interatom</tt><tt class="py-op">.</tt><tt class="py-name">vector</tt> <tt class="py-op">*</tt> <tt class="py-name">length</tt> <tt class="py-op">*</tt> <tt class="py-number">1e10</tt> </tt>
<a name="L727"></a><tt class="py-lineno"> 727</tt>  <tt class="py-line"> </tt>
<a name="L728"></a><tt class="py-lineno"> 728</tt>  <tt class="py-line">        <tt class="py-comment"># Add the first spin as the central atom.</tt> </tt>
<a name="L729"></a><tt class="py-lineno"> 729</tt>  <tt class="py-line">        <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-352" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_add" class="py-name" href="#" onclick="return doclink('link-352', 'atom_add', 'link-68');">atom_add</a></tt><tt class="py-op">(</tt><tt class="py-name">pdb_record</tt><tt class="py-op">=</tt><tt class="py-string">'ATOM'</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt class="py-name">spin1</tt><tt class="py-op">.</tt><tt id="link-353" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
generic_fns.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-353', 'name', 'link-146');">name</a></tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">spin1</tt><tt class="py-op">.</tt><tt class="py-name">_res_name</tt><tt class="py-op">,</tt> <tt class="py-name">chain_id</tt><tt class="py-op">=</tt><tt class="py-string">'A'</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">spin1</tt><tt class="py-op">.</tt><tt class="py-name">_res_num</tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt><tt class="py-op">=</tt><tt id="link-354" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-354', 'R', 'link-71');">R</a></tt><tt class="py-op">,</tt> <tt class="py-name">segment_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">element</tt><tt class="py-op">=</tt><tt class="py-name">spin1</tt><tt class="py-op">.</tt><tt class="py-name">element</tt><tt class="py-op">)</tt> </tt>
<a name="L730"></a><tt class="py-lineno"> 730</tt>  <tt class="py-line"> </tt>
<a name="L731"></a><tt class="py-lineno"> 731</tt>  <tt class="py-line">        <tt class="py-comment"># Add the second spin as the end atom.</tt> </tt>
<a name="L732"></a><tt class="py-lineno"> 732</tt>  <tt class="py-line">        <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-355" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_add" class="py-name" href="#" onclick="return doclink('link-355', 'atom_add', 'link-68');">atom_add</a></tt><tt class="py-op">(</tt><tt class="py-name">pdb_record</tt><tt class="py-op">=</tt><tt class="py-string">'ATOM'</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">+</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt class="py-name">spin2</tt><tt class="py-op">.</tt><tt id="link-356" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
generic_fns.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-356', 'name', 'link-146');">name</a></tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">spin2</tt><tt class="py-op">.</tt><tt class="py-name">_res_name</tt><tt class="py-op">,</tt> <tt class="py-name">chain_id</tt><tt class="py-op">=</tt><tt class="py-string">'A'</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">spin2</tt><tt class="py-op">.</tt><tt class="py-name">_res_num</tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt><tt class="py-op">=</tt><tt id="link-357" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-357', 'R', 'link-71');">R</a></tt><tt class="py-op">+</tt><tt class="py-name">vector</tt><tt class="py-op">,</tt> <tt class="py-name">segment_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">element</tt><tt class="py-op">=</tt><tt class="py-name">spin2</tt><tt class="py-op">.</tt><tt class="py-name">element</tt><tt class="py-op">)</tt> </tt>
<a name="L733"></a><tt class="py-lineno"> 733</tt>  <tt class="py-line"> </tt>
<a name="L734"></a><tt class="py-lineno"> 734</tt>  <tt class="py-line">        <tt class="py-comment"># Connect the two atoms.</tt> </tt>
<a name="L735"></a><tt class="py-lineno"> 735</tt>  <tt class="py-line">        <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-358" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_connect" class="py-name" href="#" onclick="return doclink('link-358', 'atom_connect', 'link-100');">atom_connect</a></tt><tt class="py-op">(</tt><tt class="py-name">index1</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">index2</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">)</tt> </tt>
<a name="L736"></a><tt class="py-lineno"> 736</tt>  <tt class="py-line"> </tt>
<a name="L737"></a><tt class="py-lineno"> 737</tt>  <tt class="py-line">        <tt class="py-comment"># Increment the atom number.</tt> </tt>
<a name="L738"></a><tt class="py-lineno"> 738</tt>  <tt class="py-line">        <tt class="py-name">atom_num</tt> <tt class="py-op">=</tt> <tt class="py-name">atom_num</tt> <tt class="py-op">+</tt> <tt class="py-number">2</tt> </tt>
<a name="L739"></a><tt class="py-lineno"> 739</tt>  <tt class="py-line"> </tt>
<a name="L740"></a><tt class="py-lineno"> 740</tt>  <tt class="py-line">    <tt class="py-comment"># Symmetry chain.</tt> </tt>
<a name="L741"></a><tt class="py-lineno"> 741</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">symmetry</tt><tt class="py-op">:</tt> </tt>
<a name="L742"></a><tt class="py-lineno"> 742</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the interatomic data containers.</tt> </tt>
<a name="L743"></a><tt class="py-lineno"> 743</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">interatom</tt> <tt class="py-keyword">in</tt> <tt id="link-359" class="py-name"><a title="generic_fns.interatomic.interatomic_loop" class="py-name" href="#" onclick="return doclink('link-359', 'interatomic_loop', 'link-3');">interatomic_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L744"></a><tt class="py-lineno"> 744</tt>  <tt class="py-line">            <tt class="py-comment"># Get the spins.</tt> </tt>
<a name="L745"></a><tt class="py-lineno"> 745</tt>  <tt class="py-line">            <tt class="py-name">spin1</tt> <tt class="py-op">=</tt> <tt id="link-360" class="py-name"><a title="generic_fns.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-360', 'return_spin', 'link-7');">return_spin</a></tt><tt class="py-op">(</tt><tt class="py-name">interatom</tt><tt class="py-op">.</tt><tt class="py-name">spin_id1</tt><tt class="py-op">)</tt> </tt>
<a name="L746"></a><tt class="py-lineno"> 746</tt>  <tt class="py-line">            <tt class="py-name">spin2</tt> <tt class="py-op">=</tt> <tt id="link-361" class="py-name"><a title="generic_fns.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-361', 'return_spin', 'link-7');">return_spin</a></tt><tt class="py-op">(</tt><tt class="py-name">interatom</tt><tt class="py-op">.</tt><tt class="py-name">spin_id2</tt><tt class="py-op">)</tt> </tt>
<a name="L747"></a><tt class="py-lineno"> 747</tt>  <tt class="py-line"> </tt>
<a name="L748"></a><tt class="py-lineno"> 748</tt>  <tt class="py-line">            <tt class="py-comment"># Skip deselected spin systems.</tt> </tt>
<a name="L749"></a><tt class="py-lineno"> 749</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">spin1</tt><tt class="py-op">.</tt><tt id="link-362" class="py-name"><a title="generic_fns.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-362', 'select', 'link-350');">select</a></tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">spin2</tt><tt class="py-op">.</tt><tt id="link-363" class="py-name"><a title="generic_fns.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-363', 'select', 'link-350');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L750"></a><tt class="py-lineno"> 750</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L751"></a><tt class="py-lineno"> 751</tt>  <tt class="py-line"> </tt>
<a name="L752"></a><tt class="py-lineno"> 752</tt>  <tt class="py-line">            <tt class="py-comment"># Skip containers missing vectors.</tt> </tt>
<a name="L753"></a><tt class="py-lineno"> 753</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">interatom</tt><tt class="py-op">,</tt> <tt class="py-string">'vector'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L754"></a><tt class="py-lineno"> 754</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L755"></a><tt class="py-lineno"> 755</tt>  <tt class="py-line"> </tt>
<a name="L756"></a><tt class="py-lineno"> 756</tt>  <tt class="py-line">            <tt class="py-comment"># Scale the vector.</tt> </tt>
<a name="L757"></a><tt class="py-lineno"> 757</tt>  <tt class="py-line">            <tt class="py-name">vector</tt> <tt class="py-op">=</tt> <tt class="py-name">interatom</tt><tt class="py-op">.</tt><tt class="py-name">vector</tt> <tt class="py-op">*</tt> <tt class="py-name">length</tt> <tt class="py-op">*</tt> <tt class="py-number">1e10</tt> </tt>
<a name="L758"></a><tt class="py-lineno"> 758</tt>  <tt class="py-line"> </tt>
<a name="L759"></a><tt class="py-lineno"> 759</tt>  <tt class="py-line">            <tt class="py-comment"># Add the first spin as the central atom.</tt> </tt>
<a name="L760"></a><tt class="py-lineno"> 760</tt>  <tt class="py-line">            <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-364" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_add" class="py-name" href="#" onclick="return doclink('link-364', 'atom_add', 'link-68');">atom_add</a></tt><tt class="py-op">(</tt><tt class="py-name">pdb_record</tt><tt class="py-op">=</tt><tt class="py-string">'ATOM'</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt class="py-name">spin1</tt><tt class="py-op">.</tt><tt id="link-365" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
generic_fns.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-365', 'name', 'link-146');">name</a></tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">spin1</tt><tt class="py-op">.</tt><tt class="py-name">_res_name</tt><tt class="py-op">,</tt> <tt class="py-name">chain_id</tt><tt class="py-op">=</tt><tt class="py-string">'B'</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">spin1</tt><tt class="py-op">.</tt><tt class="py-name">_res_num</tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt><tt class="py-op">=</tt><tt id="link-366" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-366', 'R', 'link-71');">R</a></tt><tt class="py-op">,</tt> <tt class="py-name">segment_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">element</tt><tt class="py-op">=</tt><tt class="py-name">spin1</tt><tt class="py-op">.</tt><tt class="py-name">element</tt><tt class="py-op">)</tt> </tt>
<a name="L761"></a><tt class="py-lineno"> 761</tt>  <tt class="py-line"> </tt>
<a name="L762"></a><tt class="py-lineno"> 762</tt>  <tt class="py-line">            <tt class="py-comment"># Add the second spin as the end atom.</tt> </tt>
<a name="L763"></a><tt class="py-lineno"> 763</tt>  <tt class="py-line">            <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-367" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_add" class="py-name" href="#" onclick="return doclink('link-367', 'atom_add', 'link-68');">atom_add</a></tt><tt class="py-op">(</tt><tt class="py-name">pdb_record</tt><tt class="py-op">=</tt><tt class="py-string">'ATOM'</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">+</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt class="py-name">spin2</tt><tt class="py-op">.</tt><tt id="link-368" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
generic_fns.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-368', 'name', 'link-146');">name</a></tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">spin2</tt><tt class="py-op">.</tt><tt class="py-name">_res_name</tt><tt class="py-op">,</tt> <tt class="py-name">chain_id</tt><tt class="py-op">=</tt><tt class="py-string">'B'</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">spin2</tt><tt class="py-op">.</tt><tt class="py-name">_res_num</tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt><tt class="py-op">=</tt><tt id="link-369" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-369', 'R', 'link-71');">R</a></tt><tt class="py-op">-</tt><tt class="py-name">vector</tt><tt class="py-op">,</tt> <tt class="py-name">segment_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">element</tt><tt class="py-op">=</tt><tt class="py-name">spin2</tt><tt class="py-op">.</tt><tt class="py-name">element</tt><tt class="py-op">)</tt> </tt>
<a name="L764"></a><tt class="py-lineno"> 764</tt>  <tt class="py-line"> </tt>
<a name="L765"></a><tt class="py-lineno"> 765</tt>  <tt class="py-line">            <tt class="py-comment"># Connect the two atoms.</tt> </tt>
<a name="L766"></a><tt class="py-lineno"> 766</tt>  <tt class="py-line">            <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-370" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_connect" class="py-name" href="#" onclick="return doclink('link-370', 'atom_connect', 'link-100');">atom_connect</a></tt><tt class="py-op">(</tt><tt class="py-name">index1</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">index2</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">)</tt> </tt>
<a name="L767"></a><tt class="py-lineno"> 767</tt>  <tt class="py-line"> </tt>
<a name="L768"></a><tt class="py-lineno"> 768</tt>  <tt class="py-line">            <tt class="py-comment"># Increment the atom number.</tt> </tt>
<a name="L769"></a><tt class="py-lineno"> 769</tt>  <tt class="py-line">            <tt class="py-name">atom_num</tt> <tt class="py-op">=</tt> <tt class="py-name">atom_num</tt> <tt class="py-op">+</tt> <tt class="py-number">2</tt> </tt>
<a name="L770"></a><tt class="py-lineno"> 770</tt>  <tt class="py-line"> </tt>
<a name="L771"></a><tt class="py-lineno"> 771</tt>  <tt class="py-line"> </tt>
<a name="L772"></a><tt class="py-lineno"> 772</tt>  <tt class="py-line">    <tt class="py-comment"># Create the PDB file.</tt> </tt>
<a name="L773"></a><tt class="py-lineno"> 773</tt>  <tt class="py-line">    <tt class="py-comment">######################</tt> </tt>
<a name="L774"></a><tt class="py-lineno"> 774</tt>  <tt class="py-line"> </tt>
<a name="L775"></a><tt class="py-lineno"> 775</tt>  <tt class="py-line">    <tt class="py-comment"># Print out.</tt> </tt>
<a name="L776"></a><tt class="py-lineno"> 776</tt>  <tt class="py-line">    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\nGenerating the PDB file."</tt><tt class="py-op">)</tt> </tt>
<a name="L777"></a><tt class="py-lineno"> 777</tt>  <tt class="py-line"> </tt>
<a name="L778"></a><tt class="py-lineno"> 778</tt>  <tt class="py-line">    <tt class="py-comment"># Open the PDB file for writing.</tt> </tt>
<a name="L779"></a><tt class="py-lineno"> 779</tt>  <tt class="py-line">    <tt class="py-name">tensor_pdb_file</tt> <tt class="py-op">=</tt> <tt id="link-371" class="py-name"><a title="relax_io.open_write_file" class="py-name" href="#" onclick="return doclink('link-371', 'open_write_file', 'link-32');">open_write_file</a></tt><tt class="py-op">(</tt><tt id="link-372" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-372', 'file', 'link-161');">file</a></tt><tt class="py-op">,</tt> <tt id="link-373" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-373', 'dir', 'link-164');">dir</a></tt><tt class="py-op">,</tt> <tt class="py-name">force</tt><tt class="py-op">=</tt><tt class="py-name">force</tt><tt class="py-op">)</tt> </tt>
<a name="L780"></a><tt class="py-lineno"> 780</tt>  <tt class="py-line"> </tt>
<a name="L781"></a><tt class="py-lineno"> 781</tt>  <tt class="py-line">    <tt class="py-comment"># Write the data.</tt> </tt>
<a name="L782"></a><tt class="py-lineno"> 782</tt>  <tt class="py-line">    <tt id="link-374" class="py-name"><a title="bmrblib.structure
generic_fns.structure
lib.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-374', 'structure', 'link-11');">structure</a></tt><tt class="py-op">.</tt><tt id="link-375" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.write_pdb
generic_fns.structure.internal.Internal.write_pdb
generic_fns.structure.main.write_pdb" class="py-name" href="#" onclick="return doclink('link-375', 'write_pdb', 'link-167');">write_pdb</a></tt><tt class="py-op">(</tt><tt class="py-name">tensor_pdb_file</tt><tt class="py-op">)</tt> </tt>
<a name="L783"></a><tt class="py-lineno"> 783</tt>  <tt class="py-line"> </tt>
<a name="L784"></a><tt class="py-lineno"> 784</tt>  <tt class="py-line">    <tt class="py-comment"># Close the file.</tt> </tt>
<a name="L785"></a><tt class="py-lineno"> 785</tt>  <tt class="py-line">    <tt class="py-name">tensor_pdb_file</tt><tt class="py-op">.</tt><tt id="link-376" class="py-name"><a title="gui.input_elements.sequence.Sequence_window.close
relax_io.DummyFileObject.close" class="py-name" href="#" onclick="return doclink('link-376', 'close', 'link-168');">close</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L786"></a><tt class="py-lineno"> 786</tt>  <tt class="py-line"> </tt>
<a name="L787"></a><tt class="py-lineno"> 787</tt>  <tt class="py-line">    <tt class="py-comment"># Add the file to the results file list.</tt> </tt>
<a name="L788"></a><tt class="py-lineno"> 788</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'result_files'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L789"></a><tt class="py-lineno"> 789</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-377" class="py-name"><a title="generic_fns.result_files" class="py-name" href="#" onclick="return doclink('link-377', 'result_files', 'link-169');">result_files</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L790"></a><tt class="py-lineno"> 790</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-378" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-378', 'dir', 'link-164');">dir</a></tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L791"></a><tt class="py-lineno"> 791</tt>  <tt class="py-line">        <tt id="link-379" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-379', 'dir', 'link-164');">dir</a></tt> <tt class="py-op">=</tt> <tt class="py-name">getcwd</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L792"></a><tt class="py-lineno"> 792</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-380" class="py-name"><a title="generic_fns.result_files" class="py-name" href="#" onclick="return doclink('link-380', 'result_files', 'link-169');">result_files</a></tt><tt class="py-op">.</tt><tt id="link-381" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-381', 'append', 'link-171');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-string">'vector_dist_pdb'</tt><tt class="py-op">,</tt> <tt class="py-string">'Vector distribution PDB'</tt><tt class="py-op">,</tt> <tt id="link-382" class="py-name"><a title="relax_io.get_file_path" class="py-name" href="#" onclick="return doclink('link-382', 'get_file_path', 'link-31');">get_file_path</a></tt><tt class="py-op">(</tt><tt id="link-383" class="py-name"><a title="check_types.file
dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-383', 'file', 'link-161');">file</a></tt><tt class="py-op">,</tt> <tt id="link-384" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-384', 'dir', 'link-164');">dir</a></tt><tt class="py-op">)</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L793"></a><tt class="py-lineno"> 793</tt>  <tt class="py-line">    <tt id="link-385" class="py-name"><a title="auto_analyses.dauvergne_protocol.status
auto_analyses.noe.status
auto_analyses.relax_fit.status
auto_analyses.stereochem_analysis.status
data.status
generic_fns.bmrb.status
generic_fns.grace.status
generic_fns.minimise.status
generic_fns.mol_res_spin.status
generic_fns.molmol.status
generic_fns.pipes.status
generic_fns.pymol_control.status
generic_fns.result_files.status
generic_fns.script.status
generic_fns.state.status
generic_fns.structure.geometric.status
generic_fns.value.status
gui.about.status
gui.analyses.auto_model_free.status
gui.analyses.auto_noe.status
gui.analyses.auto_rx_base.status
gui.analyses.execute.status
gui.analyses.results_analysis.status
gui.analyses.status
gui.components.base_list.status
gui.components.free_file_format.status
gui.components.grid.status
gui.components.molecule.status
gui.components.relax_data.status
gui.components.relax_data_meta.status
gui.components.spectrum.status
gui.controller.status
gui.errors.status
gui.export_bmrb.status
gui.filedialog.status
gui.fonts.status
gui.icons.status
gui.input_elements.bool.status
gui.input_elements.dir.status
gui.input_elements.file.status
gui.input_elements.sequence.status
gui.input_elements.sequence_2D.status
gui.interpreter.status
gui.menu.status
gui.message.status
gui.misc.status
gui.paths.status
gui.pipe_editor.status
gui.relax_gui.status
gui.relax_prompt.status
gui.results_viewer.status
gui.spin_viewer.frame.status
gui.spin_viewer.tree.status
gui.status
gui.string_conv.status
gui.uf_objects.status
gui.wizard.status
info.Bieri11.status
info.Clore90.status
info.Delaglio95.status
info.GoddardKneller.status
info.LipariSzabo82a.status
info.LipariSzabo82b.status
info.Ref.status
info.dAuvergne06.status
info.dAuvergneGooley03.status
info.dAuvergneGooley06.status
info.dAuvergneGooley07.status
info.dAuvergneGooley08a.status
info.dAuvergneGooley08b.status
info.status
prompt.command.status
prompt.help.status
prompt.interpreter.status
prompt.uf_docstring.status
prompt.uf_objects.status
relax.status
relax_warnings.status
scons.manuals.status
setup.status
status
test_suite.gui_tests.base_classes.status
test_suite.gui_tests.bruker.status
test_suite.gui_tests.model_free.status
test_suite.gui_tests.noe.status
test_suite.gui_tests.rx.status
test_suite.gui_tests.state.status
test_suite.gui_tests.test_user_functions.status
test_suite.relax_test_loader.status
test_suite.relax_test_runner.status
test_suite.system_tests.angles.status
test_suite.system_tests.bmrb.status
test_suite.system_tests.bruker.status
test_suite.system_tests.consistency_tests.status
test_suite.system_tests.dasha.status
test_suite.system_tests.diffusion_tensor.status
test_suite.system_tests.frame_order.status
test_suite.system_tests.generic.status
test_suite.system_tests.grace.status
test_suite.system_tests.interatomic.status
test_suite.system_tests.jw_mapping.status
test_suite.system_tests.load_spins.status
test_suite.system_tests.model_elimination.status
test_suite.system_tests.model_free.status
test_suite.system_tests.model_selection.status
test_suite.system_tests.mol_res_spin.status
test_suite.system_tests.n_state_model.status
test_suite.system_tests.noe.status
test_suite.system_tests.noe_restraints.status
test_suite.system_tests.palmer.status
test_suite.system_tests.pcs.status
test_suite.system_tests.peak_lists.status
test_suite.system_tests.pipes.status
test_suite.system_tests.rdc.status
test_suite.system_tests.relax_data.status
test_suite.system_tests.relax_fit.status
test_suite.system_tests.results.status
test_suite.system_tests.sequence.status
test_suite.system_tests.state.status
test_suite.system_tests.structure.status
test_suite.system_tests.unit_vectors.status
test_suite.test_suite_runner.status
test_suite.unit_tests._generic_fns._structure.test_api_base.status
test_suite.unit_tests._generic_fns._structure.test_internal.status
test_suite.unit_tests._generic_fns._structure.test_scientific.status
test_suite.unit_tests._maths_fns.test_frame_order_matrix_ops.status
test_suite.unit_tests._specific_fns._model_free.test_main.status
test_suite.unit_tests.relax_data_testing_base.status
test_suite.unit_tests.sequence_testing_base.status
test_suite.unit_tests.state_testing_base.status
version.status" class="py-name" href="#" onclick="return doclink('link-385', 'status', 'link-35');">status</a></tt><tt class="py-op">.</tt><tt class="py-name">observers</tt><tt class="py-op">.</tt><tt class="py-name">result_file</tt><tt class="py-op">.</tt><tt id="link-386" class="py-name"><a title="status.Observer.notify" class="py-name" href="#" onclick="return doclink('link-386', 'notify', 'link-176');">notify</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
</div><a name="L794"></a><tt class="py-lineno"> 794</tt>  <tt class="py-line"> </tt>
<a name="L795"></a><tt class="py-lineno"> 795</tt>  <tt class="py-line"> </tt>
<a name="generate_vector_dist"></a><div id="generate_vector_dist-def"><a name="L796"></a><tt class="py-lineno"> 796</tt> <a class="py-toggle" href="#" id="generate_vector_dist-toggle" onclick="return toggle('generate_vector_dist');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.geometric-module.html#generate_vector_dist">generate_vector_dist</a><tt class="py-op">(</tt><tt class="py-param">mol</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">res_name</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">res_num</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">chain_id</tt><tt class="py-op">=</tt><tt class="py-string">''</tt><tt class="py-op">,</tt> <tt class="py-param">centre</tt><tt class="py-op">=</tt><tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-number">3</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-param">R</tt><tt class="py-op">=</tt><tt class="py-name">eye</tt><tt class="py-op">(</tt><tt class="py-number">3</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-param">warp</tt><tt class="py-op">=</tt><tt class="py-name">eye</tt><tt class="py-op">(</tt><tt class="py-number">3</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-param">limit_check</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">scale</tt><tt class="py-op">=</tt><tt class="py-number">1.0</tt><tt class="py-op">,</tt> <tt class="py-param">inc</tt><tt class="py-op">=</tt><tt class="py-number">20</tt><tt class="py-op">,</tt> <tt class="py-param">distribution</tt><tt class="py-op">=</tt><tt class="py-string">'uniform'</tt><tt class="py-op">,</tt> <tt class="py-param">debug</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="generate_vector_dist-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="generate_vector_dist-expanded"><a name="L797"></a><tt class="py-lineno"> 797</tt>  <tt class="py-line">    <tt class="py-docstring">"""Generate a uniformly distributed distribution of atoms on a warped sphere.</tt> </tt>
<a name="L798"></a><tt class="py-lineno"> 798</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L799"></a><tt class="py-lineno"> 799</tt>  <tt class="py-line"><tt class="py-docstring">    The vectors from the function vect_dist_spherical_angles() are used to generate the distribution.  These vectors are rotated to the desired frame using the rotation matrix 'R', then each compressed or stretched by the dot product with the 'warp' matrix.  Each vector is centred and at the head of the vector, a proton is placed.</tt> </tt>
<a name="L800"></a><tt class="py-lineno"> 800</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L801"></a><tt class="py-lineno"> 801</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L802"></a><tt class="py-lineno"> 802</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword mol:           The molecule container.</tt> </tt>
<a name="L803"></a><tt class="py-lineno"> 803</tt>  <tt class="py-line"><tt class="py-docstring">    @type mol:              MolContainer instance</tt> </tt>
<a name="L804"></a><tt class="py-lineno"> 804</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword res_name:      The residue name.</tt> </tt>
<a name="L805"></a><tt class="py-lineno"> 805</tt>  <tt class="py-line"><tt class="py-docstring">    @type res_name:         str</tt> </tt>
<a name="L806"></a><tt class="py-lineno"> 806</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword res_num:       The residue number.</tt> </tt>
<a name="L807"></a><tt class="py-lineno"> 807</tt>  <tt class="py-line"><tt class="py-docstring">    @type res_num:          int</tt> </tt>
<a name="L808"></a><tt class="py-lineno"> 808</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword chain_id:      The chain identifier.</tt> </tt>
<a name="L809"></a><tt class="py-lineno"> 809</tt>  <tt class="py-line"><tt class="py-docstring">    @type chain_id:         str</tt> </tt>
<a name="L810"></a><tt class="py-lineno"> 810</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword centre:        The centre of the distribution.</tt> </tt>
<a name="L811"></a><tt class="py-lineno"> 811</tt>  <tt class="py-line"><tt class="py-docstring">    @type centre:           numpy array, len 3</tt> </tt>
<a name="L812"></a><tt class="py-lineno"> 812</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword R:             The optional 3x3 rotation matrix.</tt> </tt>
<a name="L813"></a><tt class="py-lineno"> 813</tt>  <tt class="py-line"><tt class="py-docstring">    @type R:                3x3 numpy array</tt> </tt>
<a name="L814"></a><tt class="py-lineno"> 814</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword warp:          The optional 3x3 warping matrix.</tt> </tt>
<a name="L815"></a><tt class="py-lineno"> 815</tt>  <tt class="py-line"><tt class="py-docstring">    @type warp:             3x3 numpy array</tt> </tt>
<a name="L816"></a><tt class="py-lineno"> 816</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword limit_check:   A function with determines the limits of the distribution.  It should accept two arguments, the polar angle phi and the azimuthal angle theta, and return True if the point is in the limits or False if outside.</tt> </tt>
<a name="L817"></a><tt class="py-lineno"> 817</tt>  <tt class="py-line"><tt class="py-docstring">    @type limit_check:      function</tt> </tt>
<a name="L818"></a><tt class="py-lineno"> 818</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword scale:         The scaling factor to stretch all rotated and warped vectors by.</tt> </tt>
<a name="L819"></a><tt class="py-lineno"> 819</tt>  <tt class="py-line"><tt class="py-docstring">    @type scale:            float</tt> </tt>
<a name="L820"></a><tt class="py-lineno"> 820</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword inc:           The number of increments or number of vectors used to generate the outer edge of the cone.</tt> </tt>
<a name="L821"></a><tt class="py-lineno"> 821</tt>  <tt class="py-line"><tt class="py-docstring">    @type inc:              int</tt> </tt>
<a name="L822"></a><tt class="py-lineno"> 822</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword distribution:  The type of point distribution to use.  This can be 'uniform' or 'regular'.</tt> </tt>
<a name="L823"></a><tt class="py-lineno"> 823</tt>  <tt class="py-line"><tt class="py-docstring">    @type distribution:     str</tt> </tt>
<a name="L824"></a><tt class="py-lineno"> 824</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L825"></a><tt class="py-lineno"> 825</tt>  <tt class="py-line"> </tt>
<a name="L826"></a><tt class="py-lineno"> 826</tt>  <tt class="py-line">    <tt class="py-comment"># Initial atom number.</tt> </tt>
<a name="L827"></a><tt class="py-lineno"> 827</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">mol</tt><tt class="py-op">.</tt><tt class="py-name">atom_num</tt><tt class="py-op">)</tt> <tt class="py-op">==</tt> <tt class="py-number">0</tt><tt class="py-op">:</tt> </tt>
<a name="L828"></a><tt class="py-lineno"> 828</tt>  <tt class="py-line">        <tt class="py-name">origin_num</tt> <tt class="py-op">=</tt> <tt class="py-number">1</tt> </tt>
<a name="L829"></a><tt class="py-lineno"> 829</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L830"></a><tt class="py-lineno"> 830</tt>  <tt class="py-line">        <tt class="py-name">origin_num</tt> <tt class="py-op">=</tt> <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt class="py-name">atom_num</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">+</tt><tt class="py-number">1</tt> </tt>
<a name="L831"></a><tt class="py-lineno"> 831</tt>  <tt class="py-line">    <tt class="py-name">atom_num</tt> <tt class="py-op">=</tt> <tt class="py-name">origin_num</tt> </tt>
<a name="L832"></a><tt class="py-lineno"> 832</tt>  <tt class="py-line"> </tt>
<a name="L833"></a><tt class="py-lineno"> 833</tt>  <tt class="py-line">    <tt class="py-comment"># Get the uniform vector distribution.</tt> </tt>
<a name="L834"></a><tt class="py-lineno"> 834</tt>  <tt class="py-line">    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"    Creating the uniform vector distribution."</tt><tt class="py-op">)</tt> </tt>
<a name="L835"></a><tt class="py-lineno"> 835</tt>  <tt class="py-line">    <tt id="link-387" class="py-name"><a title="generic_fns.structure.main.vectors
maths_fns.vectors" class="py-name" href="#" onclick="return doclink('link-387', 'vectors', 'link-334');">vectors</a></tt> <tt class="py-op">=</tt> <tt id="link-388" class="py-name" targets="Function generic_fns.structure.geometric.vect_dist_spherical_angles()=generic_fns.structure.geometric-module.html#vect_dist_spherical_angles"><a title="generic_fns.structure.geometric.vect_dist_spherical_angles" class="py-name" href="#" onclick="return doclink('link-388', 'vect_dist_spherical_angles', 'link-388');">vect_dist_spherical_angles</a></tt><tt class="py-op">(</tt><tt class="py-name">inc</tt><tt class="py-op">=</tt><tt class="py-name">inc</tt><tt class="py-op">,</tt> <tt class="py-name">distribution</tt><tt class="py-op">=</tt><tt class="py-name">distribution</tt><tt class="py-op">)</tt> </tt>
<a name="L836"></a><tt class="py-lineno"> 836</tt>  <tt class="py-line"> </tt>
<a name="L837"></a><tt class="py-lineno"> 837</tt>  <tt class="py-line">    <tt class="py-comment"># Get the polar and azimuthal angles for the distribution.</tt> </tt>
<a name="L838"></a><tt class="py-lineno"> 838</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">distribution</tt> <tt class="py-op">==</tt> <tt class="py-string">'uniform'</tt><tt class="py-op">:</tt> </tt>
<a name="L839"></a><tt class="py-lineno"> 839</tt>  <tt class="py-line">        <tt class="py-name">phi</tt><tt class="py-op">,</tt> <tt class="py-name">theta</tt> <tt class="py-op">=</tt> <tt id="link-389" class="py-name"><a title="generic_fns.structure.geometric.angles_uniform" class="py-name" href="#" onclick="return doclink('link-389', 'angles_uniform', 'link-69');">angles_uniform</a></tt><tt class="py-op">(</tt><tt class="py-name">inc</tt><tt class="py-op">)</tt> </tt>
<a name="L840"></a><tt class="py-lineno"> 840</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L841"></a><tt class="py-lineno"> 841</tt>  <tt class="py-line">        <tt class="py-name">phi</tt><tt class="py-op">,</tt> <tt class="py-name">theta</tt> <tt class="py-op">=</tt> <tt id="link-390" class="py-name"><a title="generic_fns.structure.geometric.angles_regular" class="py-name" href="#" onclick="return doclink('link-390', 'angles_regular', 'link-70');">angles_regular</a></tt><tt class="py-op">(</tt><tt class="py-name">inc</tt><tt class="py-op">)</tt> </tt>
<a name="L842"></a><tt class="py-lineno"> 842</tt>  <tt class="py-line"> </tt>
<a name="L843"></a><tt class="py-lineno"> 843</tt>  <tt class="py-line">    <tt class="py-comment"># Init the arrays for stitching together.</tt> </tt>
<a name="L844"></a><tt class="py-lineno"> 844</tt>  <tt class="py-line">    <tt class="py-name">edge</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L845"></a><tt class="py-lineno"> 845</tt>  <tt class="py-line">    <tt class="py-name">edge_index</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">int</tt><tt class="py-op">)</tt> </tt>
<a name="L846"></a><tt class="py-lineno"> 846</tt>  <tt class="py-line">    <tt class="py-name">edge_phi</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L847"></a><tt class="py-lineno"> 847</tt>  <tt class="py-line">    <tt class="py-name">edge_atom</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L848"></a><tt class="py-lineno"> 848</tt>  <tt class="py-line"> </tt>
<a name="L849"></a><tt class="py-lineno"> 849</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over the radial array of vectors (change in longitude).</tt> </tt>
<a name="L850"></a><tt class="py-lineno"> 850</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-391" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-391', 'i', 'link-40');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L851"></a><tt class="py-lineno"> 851</tt>  <tt class="py-line">        <tt class="py-comment"># Debugging.</tt> </tt>
<a name="L852"></a><tt class="py-lineno"> 852</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">debug</tt><tt class="py-op">:</tt> </tt>
<a name="L853"></a><tt class="py-lineno"> 853</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"i: %s; theta: %s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt id="link-392" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-392', 'i', 'link-40');">i</a></tt><tt class="py-op">,</tt> <tt class="py-name">theta</tt><tt class="py-op">[</tt><tt id="link-393" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-393', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L854"></a><tt class="py-lineno"> 854</tt>  <tt class="py-line"> </tt>
<a name="L855"></a><tt class="py-lineno"> 855</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the vectors of the radial array (change in latitude).</tt> </tt>
<a name="L856"></a><tt class="py-lineno"> 856</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">j</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">phi</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L857"></a><tt class="py-lineno"> 857</tt>  <tt class="py-line">            <tt class="py-comment"># Debugging.</tt> </tt>
<a name="L858"></a><tt class="py-lineno"> 858</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">debug</tt><tt class="py-op">:</tt> </tt>
<a name="L859"></a><tt class="py-lineno"> 859</tt>  <tt class="py-line">                <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%sj: %s; phi: %s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">" "</tt><tt class="py-op">*</tt><tt class="py-number">4</tt><tt class="py-op">,</tt> <tt class="py-name">j</tt><tt class="py-op">,</tt> <tt class="py-name">phi</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L860"></a><tt class="py-lineno"> 860</tt>  <tt class="py-line"> </tt>
<a name="L861"></a><tt class="py-lineno"> 861</tt>  <tt class="py-line">            <tt class="py-comment"># Skip the vector if the point is outside of the limits.</tt> </tt>
<a name="L862"></a><tt class="py-lineno"> 862</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-394" class="py-name"><a title="generic_fns.structure.cones.Base.limit_check" class="py-name" href="#" onclick="return doclink('link-394', 'limit_check', 'link-158');">limit_check</a></tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt id="link-395" class="py-name"><a title="generic_fns.structure.cones.Base.limit_check" class="py-name" href="#" onclick="return doclink('link-395', 'limit_check', 'link-158');">limit_check</a></tt><tt class="py-op">(</tt><tt class="py-name">phi</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">theta</tt><tt class="py-op">[</tt><tt id="link-396" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-396', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L863"></a><tt class="py-lineno"> 863</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">debug</tt><tt class="py-op">:</tt> </tt>
<a name="L864"></a><tt class="py-lineno"> 864</tt>  <tt class="py-line">                    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%sOut of cone."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">" "</tt><tt class="py-op">*</tt><tt class="py-number">8</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L865"></a><tt class="py-lineno"> 865</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L866"></a><tt class="py-lineno"> 866</tt>  <tt class="py-line"> </tt>
<a name="L867"></a><tt class="py-lineno"> 867</tt>  <tt class="py-line">            <tt class="py-comment"># Update the edge for this longitude.</tt> </tt>
<a name="L868"></a><tt class="py-lineno"> 868</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">edge</tt><tt class="py-op">[</tt><tt id="link-397" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-397', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L869"></a><tt class="py-lineno"> 869</tt>  <tt class="py-line">                <tt class="py-name">edge</tt><tt class="py-op">[</tt><tt id="link-398" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-398', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-number">1</tt> </tt>
<a name="L870"></a><tt class="py-lineno"> 870</tt>  <tt class="py-line">                <tt class="py-name">edge_index</tt><tt class="py-op">[</tt><tt id="link-399" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-399', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">j</tt> </tt>
<a name="L871"></a><tt class="py-lineno"> 871</tt>  <tt class="py-line">                <tt class="py-name">edge_phi</tt><tt class="py-op">[</tt><tt id="link-400" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-400', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">phi</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">]</tt> </tt>
<a name="L872"></a><tt class="py-lineno"> 872</tt>  <tt class="py-line">                <tt class="py-name">edge_atom</tt><tt class="py-op">[</tt><tt id="link-401" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-401', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">atom_num</tt> </tt>
<a name="L873"></a><tt class="py-lineno"> 873</tt>  <tt class="py-line"> </tt>
<a name="L874"></a><tt class="py-lineno"> 874</tt>  <tt class="py-line">                <tt class="py-comment"># Debugging.</tt> </tt>
<a name="L875"></a><tt class="py-lineno"> 875</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">debug</tt><tt class="py-op">:</tt> </tt>
<a name="L876"></a><tt class="py-lineno"> 876</tt>  <tt class="py-line">                    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%sEdge detected."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">" "</tt><tt class="py-op">*</tt><tt class="py-number">8</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L877"></a><tt class="py-lineno"> 877</tt>  <tt class="py-line">                    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%sEdge index: %s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">" "</tt><tt class="py-op">*</tt><tt class="py-number">8</tt><tt class="py-op">,</tt> <tt class="py-name">edge_index</tt><tt class="py-op">[</tt><tt id="link-402" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-402', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L878"></a><tt class="py-lineno"> 878</tt>  <tt class="py-line">                    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%sEdge phi pos: %s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">" "</tt><tt class="py-op">*</tt><tt class="py-number">8</tt><tt class="py-op">,</tt> <tt class="py-name">edge_phi</tt><tt class="py-op">[</tt><tt id="link-403" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-403', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L879"></a><tt class="py-lineno"> 879</tt>  <tt class="py-line">                    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%sEdge atom: %s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">" "</tt><tt class="py-op">*</tt><tt class="py-number">8</tt><tt class="py-op">,</tt> <tt class="py-name">edge_atom</tt><tt class="py-op">[</tt><tt id="link-404" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-404', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L880"></a><tt class="py-lineno"> 880</tt>  <tt class="py-line"> </tt>
<a name="L881"></a><tt class="py-lineno"> 881</tt>  <tt class="py-line">            <tt class="py-comment"># Rotate the vector into the diffusion frame.</tt> </tt>
<a name="L882"></a><tt class="py-lineno"> 882</tt>  <tt class="py-line">            <tt class="py-name">vector</tt> <tt class="py-op">=</tt> <tt class="py-name">dot</tt><tt class="py-op">(</tt><tt id="link-405" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-405', 'R', 'link-71');">R</a></tt><tt class="py-op">,</tt> <tt id="link-406" class="py-name"><a title="generic_fns.structure.main.vectors
maths_fns.vectors" class="py-name" href="#" onclick="return doclink('link-406', 'vectors', 'link-334');">vectors</a></tt><tt class="py-op">[</tt><tt id="link-407" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-407', 'i', 'link-40');">i</a></tt> <tt class="py-op">+</tt> <tt class="py-name">j</tt><tt class="py-op">*</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">)</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L883"></a><tt class="py-lineno"> 883</tt>  <tt class="py-line"> </tt>
<a name="L884"></a><tt class="py-lineno"> 884</tt>  <tt class="py-line">            <tt class="py-comment"># Set the length of the vector to its diffusion rate within the diffusion tensor geometric object.</tt> </tt>
<a name="L885"></a><tt class="py-lineno"> 885</tt>  <tt class="py-line">            <tt class="py-name">vector</tt> <tt class="py-op">=</tt> <tt class="py-name">dot</tt><tt class="py-op">(</tt><tt class="py-name">warp</tt><tt class="py-op">,</tt> <tt class="py-name">vector</tt><tt class="py-op">)</tt> </tt>
<a name="L886"></a><tt class="py-lineno"> 886</tt>  <tt class="py-line"> </tt>
<a name="L887"></a><tt class="py-lineno"> 887</tt>  <tt class="py-line">            <tt class="py-comment"># Scale the vector.</tt> </tt>
<a name="L888"></a><tt class="py-lineno"> 888</tt>  <tt class="py-line">            <tt class="py-name">vector</tt> <tt class="py-op">=</tt> <tt class="py-name">vector</tt> <tt class="py-op">*</tt> <tt class="py-name">scale</tt> </tt>
<a name="L889"></a><tt class="py-lineno"> 889</tt>  <tt class="py-line"> </tt>
<a name="L890"></a><tt class="py-lineno"> 890</tt>  <tt class="py-line">            <tt class="py-comment"># Position relative to the centre of mass.</tt> </tt>
<a name="L891"></a><tt class="py-lineno"> 891</tt>  <tt class="py-line">            <tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt id="link-408" class="py-name"><a title="generic_fns.paramag.centre
generic_fns.pcs.centre
info.Info_box.centre" class="py-name" href="#" onclick="return doclink('link-408', 'centre', 'link-155');">centre</a></tt> <tt class="py-op">+</tt> <tt class="py-name">vector</tt> </tt>
<a name="L892"></a><tt class="py-lineno"> 892</tt>  <tt class="py-line"> </tt>
<a name="L893"></a><tt class="py-lineno"> 893</tt>  <tt class="py-line">            <tt class="py-comment"># Debugging.</tt> </tt>
<a name="L894"></a><tt class="py-lineno"> 894</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">debug</tt><tt class="py-op">:</tt> </tt>
<a name="L895"></a><tt class="py-lineno"> 895</tt>  <tt class="py-line">                <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%sAdding atom %s."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">" "</tt><tt class="py-op">*</tt><tt class="py-number">8</tt><tt class="py-op">,</tt> <tt id="link-409" class="py-name"><a title="generic_fns.structure.geometric.get_proton_name" class="py-name" href="#" onclick="return doclink('link-409', 'get_proton_name', 'link-97');">get_proton_name</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_num</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L896"></a><tt class="py-lineno"> 896</tt>  <tt class="py-line"> </tt>
<a name="L897"></a><tt class="py-lineno"> 897</tt>  <tt class="py-line">            <tt class="py-comment"># Add the vector as a H atom of the TNS residue.</tt> </tt>
<a name="L898"></a><tt class="py-lineno"> 898</tt>  <tt class="py-line">            <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-410" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_add" class="py-name" href="#" onclick="return doclink('link-410', 'atom_add', 'link-68');">atom_add</a></tt><tt class="py-op">(</tt><tt class="py-name">pdb_record</tt><tt class="py-op">=</tt><tt class="py-string">'HETATM'</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt id="link-411" class="py-name"><a title="generic_fns.structure.geometric.get_proton_name" class="py-name" href="#" onclick="return doclink('link-411', 'get_proton_name', 'link-97');">get_proton_name</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_num</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">res_name</tt><tt class="py-op">,</tt> <tt class="py-name">chain_id</tt><tt class="py-op">=</tt><tt class="py-name">chain_id</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt><tt class="py-op">=</tt><tt class="py-name">pos</tt><tt class="py-op">,</tt> <tt class="py-name">segment_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">element</tt><tt class="py-op">=</tt><tt class="py-string">'H'</tt><tt class="py-op">)</tt> </tt>
<a name="L899"></a><tt class="py-lineno"> 899</tt>  <tt class="py-line"> </tt>
<a name="L900"></a><tt class="py-lineno"> 900</tt>  <tt class="py-line">            <tt class="py-comment"># Connect to the previous atom to generate the longitudinal lines (except for the first point).</tt> </tt>
<a name="L901"></a><tt class="py-lineno"> 901</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">j</tt> <tt class="py-op">&gt;</tt> <tt class="py-name">edge_index</tt><tt class="py-op">[</tt><tt id="link-412" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-412', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L902"></a><tt class="py-lineno"> 902</tt>  <tt class="py-line">                <tt class="py-comment"># Debugging.</tt> </tt>
<a name="L903"></a><tt class="py-lineno"> 903</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">debug</tt><tt class="py-op">:</tt> </tt>
<a name="L904"></a><tt class="py-lineno"> 904</tt>  <tt class="py-line">                    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%sLongitude line, connecting %s to %s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">" "</tt><tt class="py-op">*</tt><tt class="py-number">8</tt><tt class="py-op">,</tt> <tt id="link-413" class="py-name"><a title="generic_fns.structure.geometric.get_proton_name" class="py-name" href="#" onclick="return doclink('link-413', 'get_proton_name', 'link-97');">get_proton_name</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_num</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt id="link-414" class="py-name"><a title="generic_fns.structure.geometric.get_proton_name" class="py-name" href="#" onclick="return doclink('link-414', 'get_proton_name', 'link-97');">get_proton_name</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_num</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L905"></a><tt class="py-lineno"> 905</tt>  <tt class="py-line"> </tt>
<a name="L906"></a><tt class="py-lineno"> 906</tt>  <tt class="py-line">                <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-415" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_connect" class="py-name" href="#" onclick="return doclink('link-415', 'atom_connect', 'link-100');">atom_connect</a></tt><tt class="py-op">(</tt><tt class="py-name">index1</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">index2</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">-</tt><tt class="py-number">2</tt><tt class="py-op">)</tt> </tt>
<a name="L907"></a><tt class="py-lineno"> 907</tt>  <tt class="py-line"> </tt>
<a name="L908"></a><tt class="py-lineno"> 908</tt>  <tt class="py-line">            <tt class="py-comment"># Connect across the radial arrays (to generate the latitudinal lines).</tt> </tt>
<a name="L909"></a><tt class="py-lineno"> 909</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-416" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-416', 'i', 'link-40');">i</a></tt> <tt class="py-op">!=</tt> <tt class="py-number">0</tt> <tt class="py-keyword">and</tt> <tt class="py-name">j</tt> <tt class="py-op">&gt;=</tt> <tt class="py-name">edge_index</tt><tt class="py-op">[</tt><tt id="link-417" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-417', 'i', 'link-40');">i</a></tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L910"></a><tt class="py-lineno"> 910</tt>  <tt class="py-line">                <tt class="py-comment"># The number of atoms back to the previous longitude.</tt> </tt>
<a name="L911"></a><tt class="py-lineno"> 911</tt>  <tt class="py-line">                <tt class="py-name">num</tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">phi</tt><tt class="py-op">)</tt> <tt class="py-op">-</tt> <tt class="py-name">edge_index</tt><tt class="py-op">[</tt><tt id="link-418" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-418', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> </tt>
<a name="L912"></a><tt class="py-lineno"> 912</tt>  <tt class="py-line"> </tt>
<a name="L913"></a><tt class="py-lineno"> 913</tt>  <tt class="py-line">                <tt class="py-comment"># Debugging.</tt> </tt>
<a name="L914"></a><tt class="py-lineno"> 914</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">debug</tt><tt class="py-op">:</tt> </tt>
<a name="L915"></a><tt class="py-lineno"> 915</tt>  <tt class="py-line">                    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%sLatitude line, connecting %s to %s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">" "</tt><tt class="py-op">*</tt><tt class="py-number">8</tt><tt class="py-op">,</tt> <tt id="link-419" class="py-name"><a title="generic_fns.structure.geometric.get_proton_name" class="py-name" href="#" onclick="return doclink('link-419', 'get_proton_name', 'link-97');">get_proton_name</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_num</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt id="link-420" class="py-name"><a title="generic_fns.structure.geometric.get_proton_name" class="py-name" href="#" onclick="return doclink('link-420', 'get_proton_name', 'link-97');">get_proton_name</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_num</tt><tt class="py-op">-</tt><tt class="py-name">num</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L916"></a><tt class="py-lineno"> 916</tt>  <tt class="py-line"> </tt>
<a name="L917"></a><tt class="py-lineno"> 917</tt>  <tt class="py-line">                <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-421" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_connect" class="py-name" href="#" onclick="return doclink('link-421', 'atom_connect', 'link-100');">atom_connect</a></tt><tt class="py-op">(</tt><tt class="py-name">index1</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">index2</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">-</tt><tt class="py-name">num</tt><tt class="py-op">)</tt> </tt>
<a name="L918"></a><tt class="py-lineno"> 918</tt>  <tt class="py-line"> </tt>
<a name="L919"></a><tt class="py-lineno"> 919</tt>  <tt class="py-line">            <tt class="py-comment"># Connect the last radial array to the first (to zip up the geometric object and close the latitudinal lines).</tt> </tt>
<a name="L920"></a><tt class="py-lineno"> 920</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-422" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-422', 'i', 'link-40');">i</a></tt> <tt class="py-op">==</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">)</tt><tt class="py-op">-</tt><tt class="py-number">1</tt> <tt class="py-keyword">and</tt> <tt class="py-name">j</tt> <tt class="py-op">&gt;=</tt> <tt class="py-name">edge_index</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L921"></a><tt class="py-lineno"> 921</tt>  <tt class="py-line">                <tt class="py-comment"># The number of atom in the first longitude line.</tt> </tt>
<a name="L922"></a><tt class="py-lineno"> 922</tt>  <tt class="py-line">                <tt class="py-name">num</tt> <tt class="py-op">=</tt> <tt class="py-name">origin_num</tt> <tt class="py-op">+</tt> <tt class="py-name">j</tt> <tt class="py-op">-</tt> <tt class="py-name">edge_index</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L923"></a><tt class="py-lineno"> 923</tt>  <tt class="py-line"> </tt>
<a name="L924"></a><tt class="py-lineno"> 924</tt>  <tt class="py-line">                <tt class="py-comment"># Debugging.</tt> </tt>
<a name="L925"></a><tt class="py-lineno"> 925</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">debug</tt><tt class="py-op">:</tt> </tt>
<a name="L926"></a><tt class="py-lineno"> 926</tt>  <tt class="py-line">                    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%sZipping up, connecting %s to %s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">" "</tt><tt class="py-op">*</tt><tt class="py-number">8</tt><tt class="py-op">,</tt> <tt id="link-423" class="py-name"><a title="generic_fns.structure.geometric.get_proton_name" class="py-name" href="#" onclick="return doclink('link-423', 'get_proton_name', 'link-97');">get_proton_name</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_num</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt id="link-424" class="py-name"><a title="generic_fns.structure.geometric.get_proton_name" class="py-name" href="#" onclick="return doclink('link-424', 'get_proton_name', 'link-97');">get_proton_name</a></tt><tt class="py-op">(</tt><tt class="py-name">num</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L927"></a><tt class="py-lineno"> 927</tt>  <tt class="py-line"> </tt>
<a name="L928"></a><tt class="py-lineno"> 928</tt>  <tt class="py-line">                <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-425" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_connect" class="py-name" href="#" onclick="return doclink('link-425', 'atom_connect', 'link-100');">atom_connect</a></tt><tt class="py-op">(</tt><tt class="py-name">index1</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">index2</tt><tt class="py-op">=</tt><tt class="py-name">num</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L929"></a><tt class="py-lineno"> 929</tt>  <tt class="py-line"> </tt>
<a name="L930"></a><tt class="py-lineno"> 930</tt>  <tt class="py-line">            <tt class="py-comment"># Increment the atom number.</tt> </tt>
<a name="L931"></a><tt class="py-lineno"> 931</tt>  <tt class="py-line">            <tt class="py-name">atom_num</tt> <tt class="py-op">=</tt> <tt class="py-name">atom_num</tt> <tt class="py-op">+</tt> <tt class="py-number">1</tt> </tt>
</div><a name="L932"></a><tt class="py-lineno"> 932</tt>  <tt class="py-line"> </tt>
<a name="L933"></a><tt class="py-lineno"> 933</tt>  <tt class="py-line"> </tt>
<a name="generate_vector_residues"></a><div id="generate_vector_residues-def"><a name="L934"></a><tt class="py-lineno"> 934</tt> <a class="py-toggle" href="#" id="generate_vector_residues-toggle" onclick="return toggle('generate_vector_residues');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.geometric-module.html#generate_vector_residues">generate_vector_residues</a><tt class="py-op">(</tt><tt class="py-param">mol</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">vector</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">atom_name</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">res_name_vect</tt><tt class="py-op">=</tt><tt class="py-string">'AXS'</tt><tt class="py-op">,</tt> <tt class="py-param">sim_vectors</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">res_name_sim</tt><tt class="py-op">=</tt><tt class="py-string">'SIM'</tt><tt class="py-op">,</tt> <tt class="py-param">chain_id</tt><tt class="py-op">=</tt><tt class="py-string">''</tt><tt class="py-op">,</tt> <tt class="py-param">res_num</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">origin</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">scale</tt><tt class="py-op">=</tt><tt class="py-number">1.0</tt><tt class="py-op">,</tt> <tt class="py-param">label_placement</tt><tt class="py-op">=</tt><tt class="py-number">1.1</tt><tt class="py-op">,</tt> <tt class="py-param">neg</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="generate_vector_residues-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="generate_vector_residues-expanded"><a name="L935"></a><tt class="py-lineno"> 935</tt>  <tt class="py-line">    <tt class="py-docstring">"""Generate residue representations for the vector and the MC simulationed vectors.</tt> </tt>
<a name="L936"></a><tt class="py-lineno"> 936</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L937"></a><tt class="py-lineno"> 937</tt>  <tt class="py-line"><tt class="py-docstring">    This is used to create a PDB representation of any vector, including its Monte Carlo simulations.</tt> </tt>
<a name="L938"></a><tt class="py-lineno"> 938</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L939"></a><tt class="py-lineno"> 939</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword mol:               The molecule container.</tt> </tt>
<a name="L940"></a><tt class="py-lineno"> 940</tt>  <tt class="py-line"><tt class="py-docstring">    @type mol:                  MolContainer instance</tt> </tt>
<a name="L941"></a><tt class="py-lineno"> 941</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword vector:            The vector to be represented in the PDB.</tt> </tt>
<a name="L942"></a><tt class="py-lineno"> 942</tt>  <tt class="py-line"><tt class="py-docstring">    @type vector:               numpy array, len 3</tt> </tt>
<a name="L943"></a><tt class="py-lineno"> 943</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_name:         The atom name used to label the atom representing the head of the vector.</tt> </tt>
<a name="L944"></a><tt class="py-lineno"> 944</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_name:            str</tt> </tt>
<a name="L945"></a><tt class="py-lineno"> 945</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword res_name_vect:     The 3 letter PDB residue code used to represent the vector.</tt> </tt>
<a name="L946"></a><tt class="py-lineno"> 946</tt>  <tt class="py-line"><tt class="py-docstring">    @type res_name_vect:        str</tt> </tt>
<a name="L947"></a><tt class="py-lineno"> 947</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword sim_vectors:       The optional Monte Carlo simulation vectors to be represented in the PDB.</tt> </tt>
<a name="L948"></a><tt class="py-lineno"> 948</tt>  <tt class="py-line"><tt class="py-docstring">    @type sim_vectors:          list of numpy array, each len 3</tt> </tt>
<a name="L949"></a><tt class="py-lineno"> 949</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword res_name_sim:      The 3 letter PDB residue code used to represent the Monte Carlo simulation vectors.</tt> </tt>
<a name="L950"></a><tt class="py-lineno"> 950</tt>  <tt class="py-line"><tt class="py-docstring">    @type res_name_sim:         str</tt> </tt>
<a name="L951"></a><tt class="py-lineno"> 951</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword chain_id:          The chain identification code.</tt> </tt>
<a name="L952"></a><tt class="py-lineno"> 952</tt>  <tt class="py-line"><tt class="py-docstring">    @type chain_id:             str</tt> </tt>
<a name="L953"></a><tt class="py-lineno"> 953</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword res_num:           The residue number.</tt> </tt>
<a name="L954"></a><tt class="py-lineno"> 954</tt>  <tt class="py-line"><tt class="py-docstring">    @type res_num:              int</tt> </tt>
<a name="L955"></a><tt class="py-lineno"> 955</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword origin:            The origin for the axis.</tt> </tt>
<a name="L956"></a><tt class="py-lineno"> 956</tt>  <tt class="py-line"><tt class="py-docstring">    @type origin:               numpy array, len 3</tt> </tt>
<a name="L957"></a><tt class="py-lineno"> 957</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword scale:             The scaling factor to stretch the vectors by.</tt> </tt>
<a name="L958"></a><tt class="py-lineno"> 958</tt>  <tt class="py-line"><tt class="py-docstring">    @type scale:                float</tt> </tt>
<a name="L959"></a><tt class="py-lineno"> 959</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword label_placement:   A scaling factor to multiply the pre-scaled vector by.  This is used to place the vector labels a little further out from the vector itself.</tt> </tt>
<a name="L960"></a><tt class="py-lineno"> 960</tt>  <tt class="py-line"><tt class="py-docstring">    @type label_placement:      float</tt> </tt>
<a name="L961"></a><tt class="py-lineno"> 961</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword neg:               If True, then the negative vector positioned at the origin will also be included.</tt> </tt>
<a name="L962"></a><tt class="py-lineno"> 962</tt>  <tt class="py-line"><tt class="py-docstring">    @type neg:                  bool</tt> </tt>
<a name="L963"></a><tt class="py-lineno"> 963</tt>  <tt class="py-line"><tt class="py-docstring">    @return:                    The new residue number.</tt> </tt>
<a name="L964"></a><tt class="py-lineno"> 964</tt>  <tt class="py-line"><tt class="py-docstring">    @rtype:                     int</tt> </tt>
<a name="L965"></a><tt class="py-lineno"> 965</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L966"></a><tt class="py-lineno"> 966</tt>  <tt class="py-line"> </tt>
<a name="L967"></a><tt class="py-lineno"> 967</tt>  <tt class="py-line">    <tt class="py-comment"># The atom numbers (and indices).</tt> </tt>
<a name="L968"></a><tt class="py-lineno"> 968</tt>  <tt class="py-line">    <tt class="py-name">origin_num</tt> <tt class="py-op">=</tt> <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt class="py-name">atom_num</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">+</tt><tt class="py-number">1</tt> </tt>
<a name="L969"></a><tt class="py-lineno"> 969</tt>  <tt class="py-line">    <tt class="py-name">atom_num</tt> <tt class="py-op">=</tt> <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt class="py-name">atom_num</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">+</tt><tt class="py-number">2</tt> </tt>
<a name="L970"></a><tt class="py-lineno"> 970</tt>  <tt class="py-line">    <tt class="py-name">atom_neg_num</tt> <tt class="py-op">=</tt> <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt class="py-name">atom_num</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">+</tt><tt class="py-number">3</tt> </tt>
<a name="L971"></a><tt class="py-lineno"> 971</tt>  <tt class="py-line"> </tt>
<a name="L972"></a><tt class="py-lineno"> 972</tt>  <tt class="py-line">    <tt class="py-comment"># The origin atom.</tt> </tt>
<a name="L973"></a><tt class="py-lineno"> 973</tt>  <tt class="py-line">    <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-426" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_add" class="py-name" href="#" onclick="return doclink('link-426', 'atom_add', 'link-68');">atom_add</a></tt><tt class="py-op">(</tt><tt class="py-name">pdb_record</tt><tt class="py-op">=</tt><tt class="py-string">'HETATM'</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">=</tt><tt class="py-name">origin_num</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt class="py-string">'R'</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">res_name_vect</tt><tt class="py-op">,</tt> <tt class="py-name">chain_id</tt><tt class="py-op">=</tt><tt class="py-name">chain_id</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt><tt class="py-op">=</tt><tt class="py-name">origin</tt><tt class="py-op">,</tt> <tt class="py-name">segment_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">element</tt><tt class="py-op">=</tt><tt class="py-string">'C'</tt><tt class="py-op">)</tt> </tt>
<a name="L974"></a><tt class="py-lineno"> 974</tt>  <tt class="py-line"> </tt>
<a name="L975"></a><tt class="py-lineno"> 975</tt>  <tt class="py-line">    <tt class="py-comment"># Create the PDB residue representing the vector.</tt> </tt>
<a name="L976"></a><tt class="py-lineno"> 976</tt>  <tt class="py-line">    <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-427" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_add" class="py-name" href="#" onclick="return doclink('link-427', 'atom_add', 'link-68');">atom_add</a></tt><tt class="py-op">(</tt><tt class="py-name">pdb_record</tt><tt class="py-op">=</tt><tt class="py-string">'HETATM'</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt class="py-name">atom_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">res_name_vect</tt><tt class="py-op">,</tt> <tt class="py-name">chain_id</tt><tt class="py-op">=</tt><tt class="py-name">chain_id</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt><tt class="py-op">=</tt><tt class="py-name">origin</tt><tt class="py-op">+</tt><tt class="py-name">vector</tt><tt class="py-op">*</tt><tt class="py-name">scale</tt><tt class="py-op">,</tt> <tt class="py-name">segment_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">element</tt><tt class="py-op">=</tt><tt class="py-string">'C'</tt><tt class="py-op">)</tt> </tt>
<a name="L977"></a><tt class="py-lineno"> 977</tt>  <tt class="py-line">    <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-428" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_connect" class="py-name" href="#" onclick="return doclink('link-428', 'atom_connect', 'link-100');">atom_connect</a></tt><tt class="py-op">(</tt><tt class="py-name">index1</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">index2</tt><tt class="py-op">=</tt><tt class="py-name">origin_num</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L978"></a><tt class="py-lineno"> 978</tt>  <tt class="py-line">    <tt class="py-name">num</tt> <tt class="py-op">=</tt> <tt class="py-number">1</tt> </tt>
<a name="L979"></a><tt class="py-lineno"> 979</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">neg</tt><tt class="py-op">:</tt> </tt>
<a name="L980"></a><tt class="py-lineno"> 980</tt>  <tt class="py-line">        <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-429" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_add" class="py-name" href="#" onclick="return doclink('link-429', 'atom_add', 'link-68');">atom_add</a></tt><tt class="py-op">(</tt><tt class="py-name">pdb_record</tt><tt class="py-op">=</tt><tt class="py-string">'HETATM'</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">=</tt><tt class="py-name">atom_neg_num</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt class="py-name">atom_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">res_name_vect</tt><tt class="py-op">,</tt> <tt class="py-name">chain_id</tt><tt class="py-op">=</tt><tt class="py-name">chain_id</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt><tt class="py-op">=</tt><tt class="py-name">origin</tt><tt class="py-op">-</tt><tt class="py-name">vector</tt><tt class="py-op">*</tt><tt class="py-name">scale</tt><tt class="py-op">,</tt> <tt class="py-name">segment_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">element</tt><tt class="py-op">=</tt><tt class="py-string">'C'</tt><tt class="py-op">)</tt> </tt>
<a name="L981"></a><tt class="py-lineno"> 981</tt>  <tt class="py-line">        <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-430" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_connect" class="py-name" href="#" onclick="return doclink('link-430', 'atom_connect', 'link-100');">atom_connect</a></tt><tt class="py-op">(</tt><tt class="py-name">index1</tt><tt class="py-op">=</tt><tt class="py-name">atom_neg_num</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">index2</tt><tt class="py-op">=</tt><tt class="py-name">origin_num</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L982"></a><tt class="py-lineno"> 982</tt>  <tt class="py-line">        <tt class="py-name">num</tt> <tt class="py-op">=</tt> <tt class="py-number">2</tt> </tt>
<a name="L983"></a><tt class="py-lineno"> 983</tt>  <tt class="py-line"> </tt>
<a name="L984"></a><tt class="py-lineno"> 984</tt>  <tt class="py-line">    <tt class="py-comment"># Add another atom to allow the axis labels to be shifted just outside of the vector itself.</tt> </tt>
<a name="L985"></a><tt class="py-lineno"> 985</tt>  <tt class="py-line">    <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-431" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_add" class="py-name" href="#" onclick="return doclink('link-431', 'atom_add', 'link-68');">atom_add</a></tt><tt class="py-op">(</tt><tt class="py-name">pdb_record</tt><tt class="py-op">=</tt><tt class="py-string">'HETATM'</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">+</tt><tt class="py-name">num</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt class="py-name">atom_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">res_name_vect</tt><tt class="py-op">,</tt> <tt class="py-name">chain_id</tt><tt class="py-op">=</tt><tt class="py-name">chain_id</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt><tt class="py-op">=</tt><tt class="py-name">origin</tt><tt class="py-op">+</tt><tt class="py-name">label_placement</tt><tt class="py-op">*</tt><tt class="py-name">vector</tt><tt class="py-op">*</tt><tt class="py-name">scale</tt><tt class="py-op">,</tt> <tt class="py-name">segment_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">element</tt><tt class="py-op">=</tt><tt class="py-string">'N'</tt><tt class="py-op">)</tt> </tt>
<a name="L986"></a><tt class="py-lineno"> 986</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">neg</tt><tt class="py-op">:</tt> </tt>
<a name="L987"></a><tt class="py-lineno"> 987</tt>  <tt class="py-line">        <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-432" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_add" class="py-name" href="#" onclick="return doclink('link-432', 'atom_add', 'link-68');">atom_add</a></tt><tt class="py-op">(</tt><tt class="py-name">pdb_record</tt><tt class="py-op">=</tt><tt class="py-string">'HETATM'</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">=</tt><tt class="py-name">atom_neg_num</tt><tt class="py-op">+</tt><tt class="py-name">num</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt class="py-name">atom_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">res_name_vect</tt><tt class="py-op">,</tt> <tt class="py-name">chain_id</tt><tt class="py-op">=</tt><tt class="py-name">chain_id</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt><tt class="py-op">=</tt><tt class="py-name">origin</tt><tt class="py-op">-</tt><tt class="py-name">label_placement</tt><tt class="py-op">*</tt><tt class="py-name">vector</tt><tt class="py-op">*</tt><tt class="py-name">scale</tt><tt class="py-op">,</tt> <tt class="py-name">segment_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">element</tt><tt class="py-op">=</tt><tt class="py-string">'N'</tt><tt class="py-op">)</tt> </tt>
<a name="L988"></a><tt class="py-lineno"> 988</tt>  <tt class="py-line"> </tt>
<a name="L989"></a><tt class="py-lineno"> 989</tt>  <tt class="py-line">    <tt class="py-comment"># Print out.</tt> </tt>
<a name="L990"></a><tt class="py-lineno"> 990</tt>  <tt class="py-line">    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"    "</tt> <tt class="py-op">+</tt> <tt class="py-name">atom_name</tt> <tt class="py-op">+</tt> <tt class="py-string">" vector (scaled + shifted to origin): "</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">origin</tt><tt class="py-op">+</tt><tt class="py-name">vector</tt><tt class="py-op">*</tt><tt class="py-name">scale</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L991"></a><tt class="py-lineno"> 991</tt>  <tt class="py-line">    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"    Creating the MC simulation vectors."</tt><tt class="py-op">)</tt> </tt>
<a name="L992"></a><tt class="py-lineno"> 992</tt>  <tt class="py-line"> </tt>
<a name="L993"></a><tt class="py-lineno"> 993</tt>  <tt class="py-line">    <tt class="py-comment"># Monte Carlo simulations.</tt> </tt>
<a name="L994"></a><tt class="py-lineno"> 994</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">sim_vectors</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L995"></a><tt class="py-lineno"> 995</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-433" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-433', 'i', 'link-40');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">sim_vectors</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L996"></a><tt class="py-lineno"> 996</tt>  <tt class="py-line">            <tt class="py-comment"># Increment the residue number, so each simulation is a new residue.</tt> </tt>
<a name="L997"></a><tt class="py-lineno"> 997</tt>  <tt class="py-line">            <tt class="py-name">res_num</tt> <tt class="py-op">=</tt> <tt class="py-name">res_num</tt> <tt class="py-op">+</tt> <tt class="py-number">1</tt> </tt>
<a name="L998"></a><tt class="py-lineno"> 998</tt>  <tt class="py-line"> </tt>
<a name="L999"></a><tt class="py-lineno"> 999</tt>  <tt class="py-line">            <tt class="py-comment"># The atom numbers (and indices).</tt> </tt>
<a name="L1000"></a><tt class="py-lineno">1000</tt>  <tt class="py-line">            <tt class="py-name">atom_num</tt> <tt class="py-op">=</tt> <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt class="py-name">atom_num</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">+</tt><tt class="py-number">1</tt> </tt>
<a name="L1001"></a><tt class="py-lineno">1001</tt>  <tt class="py-line">            <tt class="py-name">atom_neg_num</tt> <tt class="py-op">=</tt> <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt class="py-name">atom_num</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">+</tt><tt class="py-number">2</tt> </tt>
<a name="L1002"></a><tt class="py-lineno">1002</tt>  <tt class="py-line"> </tt>
<a name="L1003"></a><tt class="py-lineno">1003</tt>  <tt class="py-line">            <tt class="py-comment"># Create the PDB residue representing the vector.</tt> </tt>
<a name="L1004"></a><tt class="py-lineno">1004</tt>  <tt class="py-line">            <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-434" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_add" class="py-name" href="#" onclick="return doclink('link-434', 'atom_add', 'link-68');">atom_add</a></tt><tt class="py-op">(</tt><tt class="py-name">pdb_record</tt><tt class="py-op">=</tt><tt class="py-string">'HETATM'</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt class="py-name">atom_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">res_name_sim</tt><tt class="py-op">,</tt> <tt class="py-name">chain_id</tt><tt class="py-op">=</tt><tt class="py-name">chain_id</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt><tt class="py-op">=</tt><tt class="py-name">origin</tt><tt class="py-op">+</tt><tt class="py-name">sim_vectors</tt><tt class="py-op">[</tt><tt id="link-435" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-435', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">*</tt><tt class="py-name">scale</tt><tt class="py-op">,</tt> <tt class="py-name">segment_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">element</tt><tt class="py-op">=</tt><tt class="py-string">'C'</tt><tt class="py-op">)</tt> </tt>
<a name="L1005"></a><tt class="py-lineno">1005</tt>  <tt class="py-line">            <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-436" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_connect" class="py-name" href="#" onclick="return doclink('link-436', 'atom_connect', 'link-100');">atom_connect</a></tt><tt class="py-op">(</tt><tt class="py-name">index1</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">index2</tt><tt class="py-op">=</tt><tt class="py-name">origin_num</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L1006"></a><tt class="py-lineno">1006</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">neg</tt><tt class="py-op">:</tt> </tt>
<a name="L1007"></a><tt class="py-lineno">1007</tt>  <tt class="py-line">                <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-437" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_add" class="py-name" href="#" onclick="return doclink('link-437', 'atom_add', 'link-68');">atom_add</a></tt><tt class="py-op">(</tt><tt class="py-name">pdb_record</tt><tt class="py-op">=</tt><tt class="py-string">'HETATM'</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">+</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt class="py-name">atom_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">res_name_sim</tt><tt class="py-op">,</tt> <tt class="py-name">chain_id</tt><tt class="py-op">=</tt><tt class="py-name">chain_id</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt><tt class="py-op">=</tt><tt class="py-name">origin</tt><tt class="py-op">-</tt><tt class="py-name">sim_vectors</tt><tt class="py-op">[</tt><tt id="link-438" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-438', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">*</tt><tt class="py-name">scale</tt><tt class="py-op">,</tt> <tt class="py-name">segment_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">element</tt><tt class="py-op">=</tt><tt class="py-string">'C'</tt><tt class="py-op">)</tt> </tt>
<a name="L1008"></a><tt class="py-lineno">1008</tt>  <tt class="py-line">                <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-439" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_connect" class="py-name" href="#" onclick="return doclink('link-439', 'atom_connect', 'link-100');">atom_connect</a></tt><tt class="py-op">(</tt><tt class="py-name">index1</tt><tt class="py-op">=</tt><tt class="py-name">atom_neg_num</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">index2</tt><tt class="py-op">=</tt><tt class="py-name">origin_num</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L1009"></a><tt class="py-lineno">1009</tt>  <tt class="py-line"> </tt>
<a name="L1010"></a><tt class="py-lineno">1010</tt>  <tt class="py-line">    <tt class="py-comment"># Return the new residue number.</tt> </tt>
<a name="L1011"></a><tt class="py-lineno">1011</tt>  <tt class="py-line">    <tt class="py-keyword">return</tt> <tt class="py-name">res_num</tt> </tt>
</div><a name="L1012"></a><tt class="py-lineno">1012</tt>  <tt class="py-line"> </tt>
<a name="L1013"></a><tt class="py-lineno">1013</tt>  <tt class="py-line"> </tt>
<a name="get_proton_name"></a><div id="get_proton_name-def"><a name="L1014"></a><tt class="py-lineno">1014</tt> <a class="py-toggle" href="#" id="get_proton_name-toggle" onclick="return toggle('get_proton_name');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.geometric-module.html#get_proton_name">get_proton_name</a><tt class="py-op">(</tt><tt class="py-param">atom_num</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="get_proton_name-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="get_proton_name-expanded"><a name="L1015"></a><tt class="py-lineno">1015</tt>  <tt class="py-line">    <tt class="py-docstring">"""Return a valid PDB atom name of &lt;4 characters.</tt> </tt>
<a name="L1016"></a><tt class="py-lineno">1016</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1017"></a><tt class="py-lineno">1017</tt>  <tt class="py-line"><tt class="py-docstring">    @param atom_num:    The number of the atom.</tt> </tt>
<a name="L1018"></a><tt class="py-lineno">1018</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_num:     int</tt> </tt>
<a name="L1019"></a><tt class="py-lineno">1019</tt>  <tt class="py-line"><tt class="py-docstring">    @return:            The atom name to use in the PDB.</tt> </tt>
<a name="L1020"></a><tt class="py-lineno">1020</tt>  <tt class="py-line"><tt class="py-docstring">    @rtype:             str</tt> </tt>
<a name="L1021"></a><tt class="py-lineno">1021</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L1022"></a><tt class="py-lineno">1022</tt>  <tt class="py-line"> </tt>
<a name="L1023"></a><tt class="py-lineno">1023</tt>  <tt class="py-line">    <tt class="py-comment"># Init the proton first letters and the atom number folding limits.</tt> </tt>
<a name="L1024"></a><tt class="py-lineno">1024</tt>  <tt class="py-line">    <tt id="link-440" class="py-name" targets="Method data.align_tensor.AlignTensorList.names()=data.align_tensor.AlignTensorList-class.html#names"><a title="data.align_tensor.AlignTensorList.names" class="py-name" href="#" onclick="return doclink('link-440', 'names', 'link-440');">names</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-string">'H'</tt><tt class="py-op">,</tt> <tt class="py-string">'I'</tt><tt class="py-op">,</tt> <tt class="py-string">'J'</tt><tt class="py-op">,</tt> <tt class="py-string">'K'</tt><tt class="py-op">,</tt> <tt class="py-string">'L'</tt><tt class="py-op">,</tt> <tt class="py-string">'M'</tt><tt class="py-op">,</tt> <tt class="py-string">'N'</tt><tt class="py-op">,</tt> <tt class="py-string">'O'</tt><tt class="py-op">,</tt> <tt class="py-string">'P'</tt><tt class="py-op">,</tt> <tt class="py-string">'Q'</tt><tt class="py-op">]</tt> </tt>
<a name="L1025"></a><tt class="py-lineno">1025</tt>  <tt class="py-line">    <tt class="py-name">lims</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-number">1000</tt><tt class="py-op">,</tt> <tt class="py-number">2000</tt><tt class="py-op">,</tt> <tt class="py-number">3000</tt><tt class="py-op">,</tt> <tt class="py-number">4000</tt><tt class="py-op">,</tt> <tt class="py-number">5000</tt><tt class="py-op">,</tt> <tt class="py-number">6000</tt><tt class="py-op">,</tt> <tt class="py-number">7000</tt><tt class="py-op">,</tt> <tt class="py-number">8000</tt><tt class="py-op">,</tt> <tt class="py-number">9000</tt><tt class="py-op">,</tt> <tt class="py-number">10000</tt><tt class="py-op">]</tt> </tt>
<a name="L1026"></a><tt class="py-lineno">1026</tt>  <tt class="py-line"> </tt>
<a name="L1027"></a><tt class="py-lineno">1027</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over the proton names.</tt> </tt>
<a name="L1028"></a><tt class="py-lineno">1028</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-441" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-441', 'i', 'link-40');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-442" class="py-name"><a title="data.align_tensor.AlignTensorList.names" class="py-name" href="#" onclick="return doclink('link-442', 'names', 'link-440');">names</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1029"></a><tt class="py-lineno">1029</tt>  <tt class="py-line">        <tt class="py-comment"># In the bounds.</tt> </tt>
<a name="L1030"></a><tt class="py-lineno">1030</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">atom_num</tt> <tt class="py-op">&gt;=</tt> <tt class="py-name">lims</tt><tt class="py-op">[</tt><tt id="link-443" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-443', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> <tt class="py-keyword">and</tt> <tt class="py-name">atom_num</tt> <tt class="py-op">&lt;</tt> <tt class="py-name">lims</tt><tt class="py-op">[</tt><tt id="link-444" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-444', 'i', 'link-40');">i</a></tt><tt class="py-op">+</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L1031"></a><tt class="py-lineno">1031</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt id="link-445" class="py-name"><a title="data.align_tensor.AlignTensorList.names" class="py-name" href="#" onclick="return doclink('link-445', 'names', 'link-440');">names</a></tt><tt class="py-op">[</tt><tt id="link-446" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-446', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">atom_num</tt> <tt class="py-op">-</tt> <tt class="py-name">lims</tt><tt class="py-op">[</tt><tt id="link-447" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-447', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
</div><a name="L1032"></a><tt class="py-lineno">1032</tt>  <tt class="py-line"> </tt>
<a name="L1033"></a><tt class="py-lineno">1033</tt>  <tt class="py-line"> </tt>
<a name="stitch_cone_to_edge"></a><div id="stitch_cone_to_edge-def"><a name="L1034"></a><tt class="py-lineno">1034</tt> <a class="py-toggle" href="#" id="stitch_cone_to_edge-toggle" onclick="return toggle('stitch_cone_to_edge');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.geometric-module.html#stitch_cone_to_edge">stitch_cone_to_edge</a><tt class="py-op">(</tt><tt class="py-param">mol</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">cone</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">chain_id</tt><tt class="py-op">=</tt><tt class="py-string">''</tt><tt class="py-op">,</tt> <tt class="py-param">dome_start</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">edge_start</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">scale</tt><tt class="py-op">=</tt><tt class="py-number">1.0</tt><tt class="py-op">,</tt> <tt class="py-param">inc</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">distribution</tt><tt class="py-op">=</tt><tt class="py-string">'uniform'</tt><tt class="py-op">,</tt> <tt class="py-param">debug</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="stitch_cone_to_edge-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="stitch_cone_to_edge-expanded"><a name="L1035"></a><tt class="py-lineno">1035</tt>  <tt class="py-line">    <tt class="py-docstring">"""Function for stitching the cone dome to its edge, in the PDB representations.</tt> </tt>
<a name="L1036"></a><tt class="py-lineno">1036</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1037"></a><tt class="py-lineno">1037</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword mol:           The molecule container.</tt> </tt>
<a name="L1038"></a><tt class="py-lineno">1038</tt>  <tt class="py-line"><tt class="py-docstring">    @type mol:              MolContainer instance</tt> </tt>
<a name="L1039"></a><tt class="py-lineno">1039</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword cone:          The cone object.  This should provide the limit_check() method with determines the limits of the distribution accepting two arguments, the polar angle phi and the azimuthal angle theta, and return True if the point is in the limits or False if outside.  It should also provide the theta_max() method for returning the theta value for the given phi.</tt> </tt>
<a name="L1040"></a><tt class="py-lineno">1040</tt>  <tt class="py-line"><tt class="py-docstring">    @type cone:             class instance</tt> </tt>
<a name="L1041"></a><tt class="py-lineno">1041</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword chain_id:      The chain identifier.</tt> </tt>
<a name="L1042"></a><tt class="py-lineno">1042</tt>  <tt class="py-line"><tt class="py-docstring">    @type chain_id:         str</tt> </tt>
<a name="L1043"></a><tt class="py-lineno">1043</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword dome_start:    The starting atom number of the cone dome residue.</tt> </tt>
<a name="L1044"></a><tt class="py-lineno">1044</tt>  <tt class="py-line"><tt class="py-docstring">    @type dome_start:       int</tt> </tt>
<a name="L1045"></a><tt class="py-lineno">1045</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword edge_start:    The starting atom number of the cone edge residue.</tt> </tt>
<a name="L1046"></a><tt class="py-lineno">1046</tt>  <tt class="py-line"><tt class="py-docstring">    @type edge_start:       int</tt> </tt>
<a name="L1047"></a><tt class="py-lineno">1047</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword scale:         The scaling factor to stretch all points by.</tt> </tt>
<a name="L1048"></a><tt class="py-lineno">1048</tt>  <tt class="py-line"><tt class="py-docstring">    @type scale:            float</tt> </tt>
<a name="L1049"></a><tt class="py-lineno">1049</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword inc:           The number of increments or number of vectors used to generate the outer edge of the cone.</tt> </tt>
<a name="L1050"></a><tt class="py-lineno">1050</tt>  <tt class="py-line"><tt class="py-docstring">    @type inc:              int</tt> </tt>
<a name="L1051"></a><tt class="py-lineno">1051</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword distribution:  The type of point distribution to use.  This can be 'uniform' or 'regular'.</tt> </tt>
<a name="L1052"></a><tt class="py-lineno">1052</tt>  <tt class="py-line"><tt class="py-docstring">    @type distribution:     str</tt> </tt>
<a name="L1053"></a><tt class="py-lineno">1053</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L1054"></a><tt class="py-lineno">1054</tt>  <tt class="py-line"> </tt>
<a name="L1055"></a><tt class="py-lineno">1055</tt>  <tt class="py-line">    <tt class="py-comment"># Get the polar and azimuthal angles for the distribution.</tt> </tt>
<a name="L1056"></a><tt class="py-lineno">1056</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">distribution</tt> <tt class="py-op">==</tt> <tt class="py-string">'uniform'</tt><tt class="py-op">:</tt> </tt>
<a name="L1057"></a><tt class="py-lineno">1057</tt>  <tt class="py-line">        <tt class="py-name">phi</tt><tt class="py-op">,</tt> <tt class="py-name">theta</tt> <tt class="py-op">=</tt> <tt id="link-448" class="py-name"><a title="generic_fns.structure.geometric.angles_uniform" class="py-name" href="#" onclick="return doclink('link-448', 'angles_uniform', 'link-69');">angles_uniform</a></tt><tt class="py-op">(</tt><tt class="py-name">inc</tt><tt class="py-op">)</tt> </tt>
<a name="L1058"></a><tt class="py-lineno">1058</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1059"></a><tt class="py-lineno">1059</tt>  <tt class="py-line">        <tt class="py-name">phi</tt><tt class="py-op">,</tt> <tt class="py-name">theta</tt> <tt class="py-op">=</tt> <tt id="link-449" class="py-name"><a title="generic_fns.structure.geometric.angles_regular" class="py-name" href="#" onclick="return doclink('link-449', 'angles_regular', 'link-70');">angles_regular</a></tt><tt class="py-op">(</tt><tt class="py-name">inc</tt><tt class="py-op">)</tt> </tt>
<a name="L1060"></a><tt class="py-lineno">1060</tt>  <tt class="py-line"> </tt>
<a name="L1061"></a><tt class="py-lineno">1061</tt>  <tt class="py-line">    <tt class="py-comment"># Determine the maximum phi values and the indices of the point just above the edge.</tt> </tt>
<a name="L1062"></a><tt class="py-lineno">1062</tt>  <tt class="py-line">    <tt id="link-450" class="py-name"><a title="generic_fns.structure.cones.Cosine.phi_max
generic_fns.structure.cones.Elliptic.phi_max
generic_fns.structure.cones.Iso_cone.phi_max
generic_fns.structure.cones.Pseudo_elliptic.phi_max
generic_fns.structure.cones.Pseudo_elliptic2.phi_max
generic_fns.structure.cones.Square.phi_max
generic_fns.structure.cones.Zig_zag.phi_max" class="py-name" href="#" onclick="return doclink('link-450', 'phi_max', 'link-75');">phi_max</a></tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L1063"></a><tt class="py-lineno">1063</tt>  <tt class="py-line">    <tt class="py-name">edge_index</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">int</tt><tt class="py-op">)</tt> </tt>
<a name="L1064"></a><tt class="py-lineno">1064</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-451" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-451', 'i', 'link-40');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1065"></a><tt class="py-lineno">1065</tt>  <tt class="py-line">        <tt class="py-comment"># Get the polar angle for the longitude edge atom.</tt> </tt>
<a name="L1066"></a><tt class="py-lineno">1066</tt>  <tt class="py-line">        <tt id="link-452" class="py-name"><a title="generic_fns.structure.cones.Cosine.phi_max
generic_fns.structure.cones.Elliptic.phi_max
generic_fns.structure.cones.Iso_cone.phi_max
generic_fns.structure.cones.Pseudo_elliptic.phi_max
generic_fns.structure.cones.Pseudo_elliptic2.phi_max
generic_fns.structure.cones.Square.phi_max
generic_fns.structure.cones.Zig_zag.phi_max" class="py-name" href="#" onclick="return doclink('link-452', 'phi_max', 'link-75');">phi_max</a></tt><tt class="py-op">[</tt><tt id="link-453" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-453', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">cone</tt><tt class="py-op">.</tt><tt id="link-454" class="py-name"><a title="generic_fns.structure.cones.Cosine.phi_max
generic_fns.structure.cones.Elliptic.phi_max
generic_fns.structure.cones.Iso_cone.phi_max
generic_fns.structure.cones.Pseudo_elliptic.phi_max
generic_fns.structure.cones.Pseudo_elliptic2.phi_max
generic_fns.structure.cones.Square.phi_max
generic_fns.structure.cones.Zig_zag.phi_max" class="py-name" href="#" onclick="return doclink('link-454', 'phi_max', 'link-75');">phi_max</a></tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">[</tt><tt id="link-455" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-455', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1067"></a><tt class="py-lineno">1067</tt>  <tt class="py-line"> </tt>
<a name="L1068"></a><tt class="py-lineno">1068</tt>  <tt class="py-line">        <tt class="py-comment"># The index.</tt> </tt>
<a name="L1069"></a><tt class="py-lineno">1069</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">j</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">phi</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1070"></a><tt class="py-lineno">1070</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">phi</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">]</tt> <tt class="py-op">&lt;=</tt> <tt id="link-456" class="py-name"><a title="generic_fns.structure.cones.Cosine.phi_max
generic_fns.structure.cones.Elliptic.phi_max
generic_fns.structure.cones.Iso_cone.phi_max
generic_fns.structure.cones.Pseudo_elliptic.phi_max
generic_fns.structure.cones.Pseudo_elliptic2.phi_max
generic_fns.structure.cones.Square.phi_max
generic_fns.structure.cones.Zig_zag.phi_max" class="py-name" href="#" onclick="return doclink('link-456', 'phi_max', 'link-75');">phi_max</a></tt><tt class="py-op">[</tt><tt id="link-457" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-457', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L1071"></a><tt class="py-lineno">1071</tt>  <tt class="py-line">                <tt class="py-name">edge_index</tt><tt class="py-op">[</tt><tt id="link-458" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-458', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">j</tt> </tt>
<a name="L1072"></a><tt class="py-lineno">1072</tt>  <tt class="py-line">                <tt class="py-keyword">break</tt> </tt>
<a name="L1073"></a><tt class="py-lineno">1073</tt>  <tt class="py-line"> </tt>
<a name="L1074"></a><tt class="py-lineno">1074</tt>  <tt class="py-line">    <tt class="py-comment"># Reverse edge index.</tt> </tt>
<a name="L1075"></a><tt class="py-lineno">1075</tt>  <tt class="py-line">    <tt class="py-name">edge_index_rev</tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">phi</tt><tt class="py-op">)</tt> <tt class="py-op">-</tt> <tt class="py-number">1</tt> <tt class="py-op">-</tt> <tt class="py-name">edge_index</tt> </tt>
<a name="L1076"></a><tt class="py-lineno">1076</tt>  <tt class="py-line"> </tt>
<a name="L1077"></a><tt class="py-lineno">1077</tt>  <tt class="py-line">    <tt class="py-comment"># Debugging.</tt> </tt>
<a name="L1078"></a><tt class="py-lineno">1078</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">debug</tt><tt class="py-op">:</tt> </tt>
<a name="L1079"></a><tt class="py-lineno">1079</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\nDome start: %s"</tt> <tt class="py-op">%</tt> <tt class="py-name">dome_start</tt><tt class="py-op">)</tt> </tt>
<a name="L1080"></a><tt class="py-lineno">1080</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Edge start: %s"</tt> <tt class="py-op">%</tt> <tt class="py-name">edge_start</tt><tt class="py-op">)</tt> </tt>
<a name="L1081"></a><tt class="py-lineno">1081</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Edge indices:     %s"</tt> <tt class="py-op">%</tt> <tt class="py-name">edge_index</tt><tt class="py-op">)</tt> </tt>
<a name="L1082"></a><tt class="py-lineno">1082</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Edge indices rev: %s"</tt> <tt class="py-op">%</tt> <tt class="py-name">edge_index_rev</tt><tt class="py-op">)</tt> </tt>
<a name="L1083"></a><tt class="py-lineno">1083</tt>  <tt class="py-line"> </tt>
<a name="L1084"></a><tt class="py-lineno">1084</tt>  <tt class="py-line">    <tt class="py-comment"># Move around the azimuth.</tt> </tt>
<a name="L1085"></a><tt class="py-lineno">1085</tt>  <tt class="py-line">    <tt class="py-name">dome_atom</tt> <tt class="py-op">=</tt> <tt class="py-name">dome_start</tt> </tt>
<a name="L1086"></a><tt class="py-lineno">1086</tt>  <tt class="py-line">    <tt class="py-name">edge_atom</tt> <tt class="py-op">=</tt> <tt class="py-name">edge_start</tt> </tt>
<a name="L1087"></a><tt class="py-lineno">1087</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-459" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-459', 'i', 'link-40');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1088"></a><tt class="py-lineno">1088</tt>  <tt class="py-line">        <tt class="py-comment"># Debugging.</tt> </tt>
<a name="L1089"></a><tt class="py-lineno">1089</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">debug</tt><tt class="py-op">:</tt> </tt>
<a name="L1090"></a><tt class="py-lineno">1090</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"i: %s; theta: %s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt id="link-460" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-460', 'i', 'link-40');">i</a></tt><tt class="py-op">,</tt> <tt class="py-name">theta</tt><tt class="py-op">[</tt><tt id="link-461" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-461', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1091"></a><tt class="py-lineno">1091</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%sDome atom: %s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">" "</tt><tt class="py-op">*</tt><tt class="py-number">4</tt><tt class="py-op">,</tt> <tt id="link-462" class="py-name"><a title="generic_fns.structure.geometric.get_proton_name" class="py-name" href="#" onclick="return doclink('link-462', 'get_proton_name', 'link-97');">get_proton_name</a></tt><tt class="py-op">(</tt><tt class="py-name">dome_atom</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1092"></a><tt class="py-lineno">1092</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%sStitching longitudinal line to edge - %s to %s."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">" "</tt><tt class="py-op">*</tt><tt class="py-number">4</tt><tt class="py-op">,</tt> <tt id="link-463" class="py-name"><a title="generic_fns.structure.geometric.get_proton_name" class="py-name" href="#" onclick="return doclink('link-463', 'get_proton_name', 'link-97');">get_proton_name</a></tt><tt class="py-op">(</tt><tt class="py-name">edge_atom</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt id="link-464" class="py-name"><a title="generic_fns.structure.geometric.get_proton_name" class="py-name" href="#" onclick="return doclink('link-464', 'get_proton_name', 'link-97');">get_proton_name</a></tt><tt class="py-op">(</tt><tt class="py-name">dome_atom</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1093"></a><tt class="py-lineno">1093</tt>  <tt class="py-line"> </tt>
<a name="L1094"></a><tt class="py-lineno">1094</tt>  <tt class="py-line">        <tt class="py-comment"># Connect the two atoms (to stitch up the 2 objects).</tt> </tt>
<a name="L1095"></a><tt class="py-lineno">1095</tt>  <tt class="py-line">        <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-465" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_connect" class="py-name" href="#" onclick="return doclink('link-465', 'atom_connect', 'link-100');">atom_connect</a></tt><tt class="py-op">(</tt><tt class="py-name">index1</tt><tt class="py-op">=</tt><tt class="py-name">dome_atom</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">index2</tt><tt class="py-op">=</tt><tt class="py-name">edge_atom</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L1096"></a><tt class="py-lineno">1096</tt>  <tt class="py-line"> </tt>
<a name="L1097"></a><tt class="py-lineno">1097</tt>  <tt class="py-line">        <tt class="py-comment"># Update the edge atom.</tt> </tt>
<a name="L1098"></a><tt class="py-lineno">1098</tt>  <tt class="py-line">        <tt class="py-name">edge_atom</tt> <tt class="py-op">=</tt> <tt class="py-name">edge_atom</tt> <tt class="py-op">+</tt> <tt class="py-number">1</tt> </tt>
<a name="L1099"></a><tt class="py-lineno">1099</tt>  <tt class="py-line"> </tt>
<a name="L1100"></a><tt class="py-lineno">1100</tt>  <tt class="py-line">        <tt class="py-comment"># Stitch up the latitude atoms.</tt> </tt>
<a name="L1101"></a><tt class="py-lineno">1101</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">j</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">phi</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1102"></a><tt class="py-lineno">1102</tt>  <tt class="py-line">            <tt class="py-comment"># The index for the direction top to bottom!</tt> </tt>
<a name="L1103"></a><tt class="py-lineno">1103</tt>  <tt class="py-line">            <tt class="py-name">k</tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">phi</tt><tt class="py-op">)</tt> <tt class="py-op">-</tt> <tt class="py-number">1</tt> <tt class="py-op">-</tt> <tt class="py-name">j</tt> </tt>
<a name="L1104"></a><tt class="py-lineno">1104</tt>  <tt class="py-line"> </tt>
<a name="L1105"></a><tt class="py-lineno">1105</tt>  <tt class="py-line">            <tt class="py-comment"># Debugging.</tt> </tt>
<a name="L1106"></a><tt class="py-lineno">1106</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">debug</tt><tt class="py-op">:</tt> </tt>
<a name="L1107"></a><tt class="py-lineno">1107</tt>  <tt class="py-line">                <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%sj: %s; phi: %-20s; k: %s; phi: %-20s; phi_max: %-20s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">" "</tt><tt class="py-op">*</tt><tt class="py-number">4</tt><tt class="py-op">,</tt> <tt class="py-name">j</tt><tt class="py-op">,</tt> <tt class="py-name">phi</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">k</tt><tt class="py-op">,</tt> <tt class="py-name">phi</tt><tt class="py-op">[</tt><tt class="py-name">k</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt id="link-466" class="py-name"><a title="generic_fns.structure.cones.Cosine.phi_max
generic_fns.structure.cones.Elliptic.phi_max
generic_fns.structure.cones.Iso_cone.phi_max
generic_fns.structure.cones.Pseudo_elliptic.phi_max
generic_fns.structure.cones.Pseudo_elliptic2.phi_max
generic_fns.structure.cones.Square.phi_max
generic_fns.structure.cones.Zig_zag.phi_max" class="py-name" href="#" onclick="return doclink('link-466', 'phi_max', 'link-75');">phi_max</a></tt><tt class="py-op">[</tt><tt id="link-467" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-467', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1108"></a><tt class="py-lineno">1108</tt>  <tt class="py-line"> </tt>
<a name="L1109"></a><tt class="py-lineno">1109</tt>  <tt class="py-line">            <tt class="py-comment"># No edge.</tt> </tt>
<a name="L1110"></a><tt class="py-lineno">1110</tt>  <tt class="py-line">            <tt class="py-name">skip</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L1111"></a><tt class="py-lineno">1111</tt>  <tt class="py-line"> </tt>
<a name="L1112"></a><tt class="py-lineno">1112</tt>  <tt class="py-line">            <tt class="py-comment"># Forward edge (skip when the latitude is phi max).</tt> </tt>
<a name="L1113"></a><tt class="py-lineno">1113</tt>  <tt class="py-line">            <tt class="py-name">fwd_index</tt> <tt class="py-op">=</tt> <tt id="link-468" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-468', 'i', 'link-40');">i</a></tt><tt class="py-op">+</tt><tt class="py-number">1</tt> </tt>
<a name="L1114"></a><tt class="py-lineno">1114</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-469" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-469', 'i', 'link-40');">i</a></tt> <tt class="py-op">==</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">)</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">:</tt> </tt>
<a name="L1115"></a><tt class="py-lineno">1115</tt>  <tt class="py-line">                <tt class="py-name">fwd_index</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L1116"></a><tt class="py-lineno">1116</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">j</tt> <tt class="py-op">&gt;=</tt> <tt class="py-name">edge_index</tt><tt class="py-op">[</tt><tt id="link-470" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-470', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> <tt class="py-keyword">and</tt> <tt class="py-name">j</tt> <tt class="py-op">&lt;</tt> <tt class="py-name">edge_index</tt><tt class="py-op">[</tt><tt class="py-name">fwd_index</tt><tt class="py-op">]</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">abs</tt><tt class="py-op">(</tt><tt id="link-471" class="py-name"><a title="generic_fns.structure.cones.Cosine.phi_max
generic_fns.structure.cones.Elliptic.phi_max
generic_fns.structure.cones.Iso_cone.phi_max
generic_fns.structure.cones.Pseudo_elliptic.phi_max
generic_fns.structure.cones.Pseudo_elliptic2.phi_max
generic_fns.structure.cones.Square.phi_max
generic_fns.structure.cones.Zig_zag.phi_max" class="py-name" href="#" onclick="return doclink('link-471', 'phi_max', 'link-75');">phi_max</a></tt><tt class="py-op">[</tt><tt class="py-name">fwd_index</tt><tt class="py-op">]</tt> <tt class="py-op">-</tt> <tt class="py-name">phi</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> <tt class="py-op">&lt;</tt> <tt class="py-number">1e-6</tt><tt class="py-op">:</tt> </tt>
<a name="L1117"></a><tt class="py-lineno">1117</tt>  <tt class="py-line">                <tt class="py-comment"># Debugging.</tt> </tt>
<a name="L1118"></a><tt class="py-lineno">1118</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">debug</tt><tt class="py-op">:</tt> </tt>
<a name="L1119"></a><tt class="py-lineno">1119</tt>  <tt class="py-line">                    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%sForward edge."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">" "</tt><tt class="py-op">*</tt><tt class="py-number">8</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1120"></a><tt class="py-lineno">1120</tt>  <tt class="py-line"> </tt>
<a name="L1121"></a><tt class="py-lineno">1121</tt>  <tt class="py-line">                <tt class="py-comment"># Edge found.</tt> </tt>
<a name="L1122"></a><tt class="py-lineno">1122</tt>  <tt class="py-line">                <tt class="py-name">skip</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L1123"></a><tt class="py-lineno">1123</tt>  <tt class="py-line">                <tt class="py-name">forward</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L1124"></a><tt class="py-lineno">1124</tt>  <tt class="py-line"> </tt>
<a name="L1125"></a><tt class="py-lineno">1125</tt>  <tt class="py-line">            <tt class="py-comment"># Back edge (skip when the latitude is phi max).</tt> </tt>
<a name="L1126"></a><tt class="py-lineno">1126</tt>  <tt class="py-line">            <tt class="py-name">rev_index</tt> <tt class="py-op">=</tt> <tt id="link-472" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-472', 'i', 'link-40');">i</a></tt><tt class="py-op">-</tt><tt class="py-number">1</tt> </tt>
<a name="L1127"></a><tt class="py-lineno">1127</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-473" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-473', 'i', 'link-40');">i</a></tt> <tt class="py-op">==</tt> <tt class="py-number">0</tt><tt class="py-op">:</tt> </tt>
<a name="L1128"></a><tt class="py-lineno">1128</tt>  <tt class="py-line">                <tt class="py-name">rev_index</tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">)</tt><tt class="py-op">-</tt><tt class="py-number">1</tt> </tt>
<a name="L1129"></a><tt class="py-lineno">1129</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-474" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-474', 'i', 'link-40');">i</a></tt> <tt class="py-op">&lt;</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">)</tt><tt class="py-op">-</tt><tt class="py-number">1</tt> <tt class="py-keyword">and</tt> <tt class="py-name">j</tt> <tt class="py-op">&gt;</tt> <tt class="py-name">edge_index_rev</tt><tt class="py-op">[</tt><tt id="link-475" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-475', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> <tt class="py-keyword">and</tt> <tt class="py-name">j</tt> <tt class="py-op">&lt;=</tt> <tt class="py-name">edge_index_rev</tt><tt class="py-op">[</tt><tt id="link-476" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-476', 'i', 'link-40');">i</a></tt><tt class="py-op">+</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">abs</tt><tt class="py-op">(</tt><tt id="link-477" class="py-name"><a title="generic_fns.structure.cones.Cosine.phi_max
generic_fns.structure.cones.Elliptic.phi_max
generic_fns.structure.cones.Iso_cone.phi_max
generic_fns.structure.cones.Pseudo_elliptic.phi_max
generic_fns.structure.cones.Pseudo_elliptic2.phi_max
generic_fns.structure.cones.Square.phi_max
generic_fns.structure.cones.Zig_zag.phi_max" class="py-name" href="#" onclick="return doclink('link-477', 'phi_max', 'link-75');">phi_max</a></tt><tt class="py-op">[</tt><tt class="py-name">fwd_index</tt><tt class="py-op">]</tt> <tt class="py-op">-</tt> <tt class="py-name">phi</tt><tt class="py-op">[</tt><tt class="py-name">k</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> <tt class="py-op">&lt;</tt> <tt class="py-number">1e-6</tt><tt class="py-op">:</tt> </tt>
<a name="L1130"></a><tt class="py-lineno">1130</tt>  <tt class="py-line">                <tt class="py-comment"># Debugging.</tt> </tt>
<a name="L1131"></a><tt class="py-lineno">1131</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">debug</tt><tt class="py-op">:</tt> </tt>
<a name="L1132"></a><tt class="py-lineno">1132</tt>  <tt class="py-line">                    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%sBack edge."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">" "</tt><tt class="py-op">*</tt><tt class="py-number">8</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1133"></a><tt class="py-lineno">1133</tt>  <tt class="py-line"> </tt>
<a name="L1134"></a><tt class="py-lineno">1134</tt>  <tt class="py-line">                <tt class="py-comment"># Edge found.</tt> </tt>
<a name="L1135"></a><tt class="py-lineno">1135</tt>  <tt class="py-line">                <tt class="py-name">skip</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L1136"></a><tt class="py-lineno">1136</tt>  <tt class="py-line">                <tt class="py-name">forward</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L1137"></a><tt class="py-lineno">1137</tt>  <tt class="py-line"> </tt>
<a name="L1138"></a><tt class="py-lineno">1138</tt>  <tt class="py-line">            <tt class="py-comment"># Skipping.</tt> </tt>
<a name="L1139"></a><tt class="py-lineno">1139</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">skip</tt><tt class="py-op">:</tt> </tt>
<a name="L1140"></a><tt class="py-lineno">1140</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L1141"></a><tt class="py-lineno">1141</tt>  <tt class="py-line"> </tt>
<a name="L1142"></a><tt class="py-lineno">1142</tt>  <tt class="py-line">            <tt class="py-comment"># The dome atom to stitch to (current dome atom + one latitude line to shift across).</tt> </tt>
<a name="L1143"></a><tt class="py-lineno">1143</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">forward</tt><tt class="py-op">:</tt> </tt>
<a name="L1144"></a><tt class="py-lineno">1144</tt>  <tt class="py-line">                <tt id="link-478" class="py-name" targets="Function generic_fns.structure.pdb_read.atom()=generic_fns.structure.pdb_read-module.html#atom,Function generic_fns.structure.pdb_write.atom()=generic_fns.structure.pdb_write-module.html#atom"><a title="generic_fns.structure.pdb_read.atom
generic_fns.structure.pdb_write.atom" class="py-name" href="#" onclick="return doclink('link-478', 'atom', 'link-478');">atom</a></tt> <tt class="py-op">=</tt> <tt class="py-name">dome_atom</tt> <tt class="py-op">+</tt> <tt class="py-name">j</tt> <tt class="py-op">-</tt> <tt class="py-name">edge_index</tt><tt class="py-op">[</tt><tt id="link-479" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-479', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt> </tt>
<a name="L1145"></a><tt class="py-lineno">1145</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1146"></a><tt class="py-lineno">1146</tt>  <tt class="py-line">                <tt id="link-480" class="py-name"><a title="generic_fns.structure.pdb_read.atom
generic_fns.structure.pdb_write.atom" class="py-name" href="#" onclick="return doclink('link-480', 'atom', 'link-478');">atom</a></tt> <tt class="py-op">=</tt> <tt class="py-name">dome_atom</tt> <tt class="py-op">+</tt> <tt class="py-op">(</tt><tt class="py-name">edge_index_rev</tt><tt class="py-op">[</tt><tt id="link-481" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-481', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">+</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-name">k</tt> <tt class="py-op">-</tt> <tt class="py-name">edge_index</tt><tt class="py-op">[</tt><tt class="py-name">fwd_index</tt><tt class="py-op">]</tt> </tt>
<a name="L1147"></a><tt class="py-lineno">1147</tt>  <tt class="py-line"> </tt>
<a name="L1148"></a><tt class="py-lineno">1148</tt>  <tt class="py-line">            <tt class="py-comment"># Debugging.</tt> </tt>
<a name="L1149"></a><tt class="py-lineno">1149</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">debug</tt><tt class="py-op">:</tt> </tt>
<a name="L1150"></a><tt class="py-lineno">1150</tt>  <tt class="py-line">                <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%sStitching latitude line to edge - %s to %s."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">" "</tt><tt class="py-op">*</tt><tt class="py-number">8</tt><tt class="py-op">,</tt> <tt id="link-482" class="py-name"><a title="generic_fns.structure.geometric.get_proton_name" class="py-name" href="#" onclick="return doclink('link-482', 'get_proton_name', 'link-97');">get_proton_name</a></tt><tt class="py-op">(</tt><tt class="py-name">edge_atom</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt id="link-483" class="py-name"><a title="generic_fns.structure.geometric.get_proton_name" class="py-name" href="#" onclick="return doclink('link-483', 'get_proton_name', 'link-97');">get_proton_name</a></tt><tt class="py-op">(</tt><tt id="link-484" class="py-name"><a title="generic_fns.structure.pdb_read.atom
generic_fns.structure.pdb_write.atom" class="py-name" href="#" onclick="return doclink('link-484', 'atom', 'link-478');">atom</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1151"></a><tt class="py-lineno">1151</tt>  <tt class="py-line"> </tt>
<a name="L1152"></a><tt class="py-lineno">1152</tt>  <tt class="py-line">            <tt class="py-comment"># Connect the two atoms (to stitch up the 2 objects).</tt> </tt>
<a name="L1153"></a><tt class="py-lineno">1153</tt>  <tt class="py-line">            <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-485" class="py-name"><a title="generic_fns.structure.internal.MolContainer.atom_connect" class="py-name" href="#" onclick="return doclink('link-485', 'atom_connect', 'link-100');">atom_connect</a></tt><tt class="py-op">(</tt><tt class="py-name">index1</tt><tt class="py-op">=</tt><tt id="link-486" class="py-name"><a title="generic_fns.structure.pdb_read.atom
generic_fns.structure.pdb_write.atom" class="py-name" href="#" onclick="return doclink('link-486', 'atom', 'link-478');">atom</a></tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">index2</tt><tt class="py-op">=</tt><tt class="py-name">edge_atom</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L1154"></a><tt class="py-lineno">1154</tt>  <tt class="py-line"> </tt>
<a name="L1155"></a><tt class="py-lineno">1155</tt>  <tt class="py-line">            <tt class="py-comment"># Increment the cone edge atom number.</tt> </tt>
<a name="L1156"></a><tt class="py-lineno">1156</tt>  <tt class="py-line">            <tt class="py-name">edge_atom</tt> <tt class="py-op">=</tt> <tt class="py-name">edge_atom</tt> <tt class="py-op">+</tt> <tt class="py-number">1</tt> </tt>
<a name="L1157"></a><tt class="py-lineno">1157</tt>  <tt class="py-line"> </tt>
<a name="L1158"></a><tt class="py-lineno">1158</tt>  <tt class="py-line">        <tt class="py-comment"># Update the cone dome atom.</tt> </tt>
<a name="L1159"></a><tt class="py-lineno">1159</tt>  <tt class="py-line">        <tt class="py-name">dome_atom</tt> <tt class="py-op">=</tt> <tt class="py-name">dome_atom</tt> <tt class="py-op">+</tt> <tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">phi</tt><tt class="py-op">)</tt> <tt class="py-op">-</tt> <tt class="py-name">edge_index</tt><tt class="py-op">[</tt><tt id="link-487" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-487', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
</div><a name="L1160"></a><tt class="py-lineno">1160</tt>  <tt class="py-line"> </tt>
<a name="L1161"></a><tt class="py-lineno">1161</tt>  <tt class="py-line"> </tt>
<a name="vect_dist_spherical_angles"></a><div id="vect_dist_spherical_angles-def"><a name="L1162"></a><tt class="py-lineno">1162</tt> <a class="py-toggle" href="#" id="vect_dist_spherical_angles-toggle" onclick="return toggle('vect_dist_spherical_angles');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.geometric-module.html#vect_dist_spherical_angles">vect_dist_spherical_angles</a><tt class="py-op">(</tt><tt class="py-param">inc</tt><tt class="py-op">=</tt><tt class="py-number">20</tt><tt class="py-op">,</tt> <tt class="py-param">distribution</tt><tt class="py-op">=</tt><tt class="py-string">'uniform'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="vect_dist_spherical_angles-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="vect_dist_spherical_angles-expanded"><a name="L1163"></a><tt class="py-lineno">1163</tt>  <tt class="py-line">    <tt class="py-docstring">"""Create a distribution of vectors on a sphere using a distribution of spherical angles.</tt> </tt>
<a name="L1164"></a><tt class="py-lineno">1164</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1165"></a><tt class="py-lineno">1165</tt>  <tt class="py-line"><tt class="py-docstring">    This function returns an array of unit vectors distributed within 3D space.  The unit vectors are generated using the equation::</tt> </tt>
<a name="L1166"></a><tt class="py-lineno">1166</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1167"></a><tt class="py-lineno">1167</tt>  <tt class="py-line"><tt class="py-docstring">                   | cos(theta) * sin(phi) |</tt> </tt>
<a name="L1168"></a><tt class="py-lineno">1168</tt>  <tt class="py-line"><tt class="py-docstring">        vector  =  | sin(theta) * sin(phi) |.</tt> </tt>
<a name="L1169"></a><tt class="py-lineno">1169</tt>  <tt class="py-line"><tt class="py-docstring">                   |      cos(phi)         |</tt> </tt>
<a name="L1170"></a><tt class="py-lineno">1170</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1171"></a><tt class="py-lineno">1171</tt>  <tt class="py-line"><tt class="py-docstring">    The vectors of this distribution generate both longitudinal and latitudinal lines.</tt> </tt>
<a name="L1172"></a><tt class="py-lineno">1172</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1173"></a><tt class="py-lineno">1173</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1174"></a><tt class="py-lineno">1174</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword inc:           The number of increments in the distribution.</tt> </tt>
<a name="L1175"></a><tt class="py-lineno">1175</tt>  <tt class="py-line"><tt class="py-docstring">    @type inc:              int</tt> </tt>
<a name="L1176"></a><tt class="py-lineno">1176</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword distribution:  The type of point distribution to use.  This can be 'uniform' or 'regular'.</tt> </tt>
<a name="L1177"></a><tt class="py-lineno">1177</tt>  <tt class="py-line"><tt class="py-docstring">    @type distribution:     str</tt> </tt>
<a name="L1178"></a><tt class="py-lineno">1178</tt>  <tt class="py-line"><tt class="py-docstring">    @return:                The distribution of vectors on a sphere.</tt> </tt>
<a name="L1179"></a><tt class="py-lineno">1179</tt>  <tt class="py-line"><tt class="py-docstring">    @rtype:                 list of rank-1, 3D numpy arrays</tt> </tt>
<a name="L1180"></a><tt class="py-lineno">1180</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L1181"></a><tt class="py-lineno">1181</tt>  <tt class="py-line"> </tt>
<a name="L1182"></a><tt class="py-lineno">1182</tt>  <tt class="py-line">    <tt class="py-comment"># Get the polar and azimuthal angles for the distribution.</tt> </tt>
<a name="L1183"></a><tt class="py-lineno">1183</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">distribution</tt> <tt class="py-op">==</tt> <tt class="py-string">'uniform'</tt><tt class="py-op">:</tt> </tt>
<a name="L1184"></a><tt class="py-lineno">1184</tt>  <tt class="py-line">        <tt class="py-name">phi</tt><tt class="py-op">,</tt> <tt class="py-name">theta</tt> <tt class="py-op">=</tt> <tt id="link-488" class="py-name"><a title="generic_fns.structure.geometric.angles_uniform" class="py-name" href="#" onclick="return doclink('link-488', 'angles_uniform', 'link-69');">angles_uniform</a></tt><tt class="py-op">(</tt><tt class="py-name">inc</tt><tt class="py-op">)</tt> </tt>
<a name="L1185"></a><tt class="py-lineno">1185</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1186"></a><tt class="py-lineno">1186</tt>  <tt class="py-line">        <tt class="py-name">phi</tt><tt class="py-op">,</tt> <tt class="py-name">theta</tt> <tt class="py-op">=</tt> <tt id="link-489" class="py-name"><a title="generic_fns.structure.geometric.angles_regular" class="py-name" href="#" onclick="return doclink('link-489', 'angles_regular', 'link-70');">angles_regular</a></tt><tt class="py-op">(</tt><tt class="py-name">inc</tt><tt class="py-op">)</tt> </tt>
<a name="L1187"></a><tt class="py-lineno">1187</tt>  <tt class="py-line"> </tt>
<a name="L1188"></a><tt class="py-lineno">1188</tt>  <tt class="py-line">    <tt class="py-comment"># Initialise array of the distribution of vectors.</tt> </tt>
<a name="L1189"></a><tt class="py-lineno">1189</tt>  <tt class="py-line">    <tt id="link-490" class="py-name"><a title="generic_fns.structure.main.vectors
maths_fns.vectors" class="py-name" href="#" onclick="return doclink('link-490', 'vectors', 'link-334');">vectors</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L1190"></a><tt class="py-lineno">1190</tt>  <tt class="py-line"> </tt>
<a name="L1191"></a><tt class="py-lineno">1191</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over the longitudinal lines.</tt> </tt>
<a name="L1192"></a><tt class="py-lineno">1192</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">j</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">phi</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1193"></a><tt class="py-lineno">1193</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the latitudinal lines.</tt> </tt>
<a name="L1194"></a><tt class="py-lineno">1194</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-491" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-491', 'i', 'link-40');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1195"></a><tt class="py-lineno">1195</tt>  <tt class="py-line">            <tt class="py-comment"># X coordinate.</tt> </tt>
<a name="L1196"></a><tt class="py-lineno">1196</tt>  <tt class="py-line">            <tt class="py-name">x</tt> <tt class="py-op">=</tt> <tt class="py-name">cos</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">[</tt><tt id="link-492" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-492', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> <tt class="py-op">*</tt> <tt class="py-name">sin</tt><tt class="py-op">(</tt><tt class="py-name">phi</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1197"></a><tt class="py-lineno">1197</tt>  <tt class="py-line"> </tt>
<a name="L1198"></a><tt class="py-lineno">1198</tt>  <tt class="py-line">            <tt class="py-comment"># Y coordinate.</tt> </tt>
<a name="L1199"></a><tt class="py-lineno">1199</tt>  <tt class="py-line">            <tt class="py-name">y</tt> <tt class="py-op">=</tt>  <tt class="py-name">sin</tt><tt class="py-op">(</tt><tt class="py-name">theta</tt><tt class="py-op">[</tt><tt id="link-493" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-493', 'i', 'link-40');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">*</tt> <tt class="py-name">sin</tt><tt class="py-op">(</tt><tt class="py-name">phi</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1200"></a><tt class="py-lineno">1200</tt>  <tt class="py-line"> </tt>
<a name="L1201"></a><tt class="py-lineno">1201</tt>  <tt class="py-line">            <tt class="py-comment"># Z coordinate.</tt> </tt>
<a name="L1202"></a><tt class="py-lineno">1202</tt>  <tt class="py-line">            <tt class="py-name">z</tt> <tt class="py-op">=</tt> <tt class="py-name">cos</tt><tt class="py-op">(</tt><tt class="py-name">phi</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1203"></a><tt class="py-lineno">1203</tt>  <tt class="py-line"> </tt>
<a name="L1204"></a><tt class="py-lineno">1204</tt>  <tt class="py-line">            <tt class="py-comment"># Append the vector.</tt> </tt>
<a name="L1205"></a><tt class="py-lineno">1205</tt>  <tt class="py-line">            <tt id="link-494" class="py-name"><a title="generic_fns.structure.main.vectors
maths_fns.vectors" class="py-name" href="#" onclick="return doclink('link-494', 'vectors', 'link-334');">vectors</a></tt><tt class="py-op">.</tt><tt id="link-495" class="py-name"><a title="data.align_tensor.AlignTensorSimList.append
data.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-495', 'append', 'link-171');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-name">x</tt><tt class="py-op">,</tt> <tt class="py-name">y</tt><tt class="py-op">,</tt> <tt class="py-name">z</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1206"></a><tt class="py-lineno">1206</tt>  <tt class="py-line"> </tt>
<a name="L1207"></a><tt class="py-lineno">1207</tt>  <tt class="py-line">    <tt class="py-comment"># Return the array of vectors and angles.</tt> </tt>
<a name="L1208"></a><tt class="py-lineno">1208</tt>  <tt class="py-line">    <tt class="py-keyword">return</tt> <tt id="link-496" class="py-name"><a title="generic_fns.structure.main.vectors
maths_fns.vectors" class="py-name" href="#" onclick="return doclink('link-496', 'vectors', 'link-334');">vectors</a></tt> </tt>
</div><a name="L1209"></a><tt class="py-lineno">1209</tt>  <tt class="py-line"> </tt><script type="text/javascript">
<!--
expandto(location.href);
// -->
</script>
</pre>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="/">relax</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Wed Apr 10 15:06:44 2013
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
