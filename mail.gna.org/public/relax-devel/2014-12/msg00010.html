<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: Implement handles for nmrglue in relax -->
<!--X-From-R13: Xbanguna Vryzhf &#60;wwuryzhfNtznvy.pbz> -->
<!--X-Date: Tue, 02 Dec 2014 17:41:53 +0100 -->
<!--X-Message-Id: 547DEB9B.3050902@gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: CA+CBx2N9gB94wrRMMjh8ETw8yZxmtL5c5uhJx58sCdtV_7HYMQ@mail.gmail.com -->
<!--X-Reference: CAED9pY&#45;vUGKBSrvK2WJw2=6kUXC&#45;0OnVeWTp+17TEJSijSgwBg@mail.gmail.com -->
<!--X-Reference: CA+CBx2NOfBd_LRo5yLuygzqJY7YfFTXX_NzhbFd_10QSvqr16A@mail.gmail.com -->
<!--X-Reference: CAED9pY_hXBUo1MzqTq7y9_JW8Zrq_JOW38rpMNAp6LPatRn8cw@mail.gmail.com -->
<!--X-Reference: CAED9pY9UnksSbfm4b2bBXWDcoJv&#45;9xGfdepB9RmhGAnEc5eZnA@mail.gmail.com -->
<!--X-Reference: 547CB55B.6070306@gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Implement handles for nmrglue in relax -- December 02, 2014 - 17:41</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Implement handles for nmrglue in relax</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00010" class="tabs">Index by Date</a> | <a href="threads.html#00010" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00005.html">Date Prev</a>] [<a href="msg00006.html">Date Next</a>] [<a href="msg00005.html">Thread Prev</a>] [<a href="msg00006.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;, Troels Emtek√¶r Linnet &lt;tlinnet@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Tue, 02 Dec 2014 10:40:59 -0600</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113; h=message-id:date:from:user-agent:mime-version:to:cc:subject :references:in-reply-to:content-type:content-transfer-encoding; bh=vcpqU4QAaCMmhvsjH56nfVS6BfFuv6BdFtUyEG6gsCg=; b=tmpKTjJSo5uwdNk9TSekc9zyoOPcI/ulXoraH17ptkF6c+y5k3w/5QtPswvZdBeYhY UgwgjuaPzvarN+bCsRv6EfPb2qyexhpmDME++HnO8ZtMK17NCDv3eI82QOdKdZOat4ZM 03nLnab1xFgU/+SA0YezOlKe1lBBGIXtcTbia9Du1HwBq4Fr4cW0Hu77S+ExidhvC8Ui nINbKoci6N7qFsiXopmj+3Seyk9oqgxHGTps45Hz8RbtHB33x8oRSwRZNupVSYDMge6G AQjelIRAgr3OVN8nSX4unBfskXB7XCADTXdTas8Q0dmuGGRndxhjkyoc1d79gZO2+m0U q8BA==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00010.html">547DEB9B.3050902@gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;CA+CBx2N9gB94wrRMMjh8ETw8yZxmtL5c5uhJx58sCdtV_7HYMQ@mail.gmail.com&gt;	&lt;CAED9pY-vUGKBSrvK2WJw2=6kUXC-0OnVeWTp+17TEJSijSgwBg@mail.gmail.com&gt;	&lt;CA+CBx2NOfBd_LRo5yLuygzqJY7YfFTXX_NzhbFd_10QSvqr16A@mail.gmail.com&gt;	&lt;CAED9pY_hXBUo1MzqTq7y9_JW8Zrq_JOW38rpMNAp6LPatRn8cw@mail.gmail.com&gt; &lt;CAED9pY9UnksSbfm4b2bBXWDcoJv-9xGfdepB9RmhGAnEc5eZnA@mail.gmail.com&gt; &lt;<a href="msg00005.html">547CB55B.6070306@gmail.com</a>&gt;</li>
<li class="menuitem">
<em>User-agent</em>: Mozilla/5.0 (X11; Linux x86_64; rv:31.0) Gecko/20100101 Thunderbird/31.2.0</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Jonathan Helmus</strong> on December 02, 2014 - 17:41:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<tt>I uploaded the nmrglue logo in a number of formats including a SVG and 
</tt><tt>PS from which high-res raster images can be created to 
</tt><tt><a  rel="nofollow" href="https://github.com/jjhelmus/nmrglue_logo">https://github.com/jjhelmus/nmrglue_logo</a>.  Feel free to include these or 
</tt><tt>files generated from these in relax.
</tt><pre style="margin: 0em;">

    - Jonathan Helmus

On 12/01/2014 12:37 PM, Jonathan Helmus wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">
Edward and Troels,

</pre><tt>    A few points regarding nmrglue in this discussion.  The main 
</tt><tt>nmrglue website is www.nmrglue.com, links to that site are best in any 
</tt><tt>documentation or credits.  The source code and issue tracker are on 
</tt><tt>GitHub at <a  rel="nofollow" href="https://github.com/jjhelmus/nmrglue">https://github.com/jjhelmus/nmrglue</a>.
</tt><pre style="margin: 0em;">

</pre><tt>    The representation of NMR data is in NumPy multi-dimenstional 
</tt><tt>ndarray objects [1].  These can be serialized to strings using the 
</tt><tt>.tostring() or .tobytes() methods.  Spectral metadata is stored in a 
</tt><tt>Python dictionary, there are a number of options for serializing 
</tt><tt>these.  Also both objects can be pickled.
</tt><pre style="margin: 0em;">

</pre><tt>    Python 3 support is available in the development version of 
</tt><tt>nmrglue, 0.5-dev, available on GitHub.  There is an issue with 
</tt><tt>installing the package in a Python 3 environment which I need to work 
</tt><tt>out but then I plan or releasing version 0.5 which will be the first 
</tt><tt>release to support Python 3.  Expect it out and available on PyPI by 
</tt><tt>the end of the week.
</tt><pre style="margin: 0em;">

</pre><tt>    I have an SVG file of the nmrglue logo from which the small jpg 
</tt><tt>was created.  I'll need to find where it is stored on my computer at 
</tt><tt>home but I'll send it along with a higher resolution png/jpg once I 
</tt><tt>locate it.
</tt><pre style="margin: 0em;">

</pre><tt>    Best of luck on getting relax to play nicely with nmrglue.  If 
</tt><tt>there is anything I can do to help on the nmrglue side feel free to 
</tt><tt>ask.  nmrglue is BSD licensed and I would like to keep it that way, if 
</tt><tt>you send any code my way I'd appreciate if it could be licensed under 
</tt><tt>the same terms.
</tt><pre style="margin: 0em;">

Cheers,

    - Jonathan Helmus


</pre><tt>[1] 
</tt><tt><a  rel="nofollow" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html">http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html</a>
</tt><pre style="margin: 0em;">

On 11/27/2014 07:30 AM, Edward d'Auvergne wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">
Hi Troels,

This appears to be the main nmrglue website <a  rel="nofollow" href="http://www.nmrglue.com/">http://www.nmrglue.com/</a> .
I can see here that there is an nmrglue icon
(<a  rel="nofollow" href="http://www.nmrglue.com/images/nmrglue_logo.jpg">http://www.nmrglue.com/images/nmrglue_logo.jpg</a>).  This may be useful
for the relax GUI graphics for the spectrum.nmrglue_* user function
menu entries and wizard pages.  The wizard graphics (in the
graphics/wizard directory) have a width of 200 px though.  You should
ask on the nmrglue forum
(<a  rel="nofollow" href="http://groups.google.com/group/nmrglue-discuss">http://groups.google.com/group/nmrglue-discuss</a>) about the use of such
a graphic and if there is a higher resolution version.

Cheers,

Edward

</pre><tt>On 27 November 2014 at 12:16, Edward d'Auvergne 
</tt><tt>&lt;edward@xxxxxxxxxxxxx&gt; wrote:
</tt><blockquote class="blockquote"><pre style="margin: 0em;">
Hi,

This sounds good.  And rather simple, the backend of the
spectrum.nmrglue_read user function could simply be the single line of
</pre><tt>the tutorial 
</tt><tt><a  rel="nofollow" href="http://nmrglue.readthedocs.org/en/latest/tutorial.html#reading-nmr-files:">http://nmrglue.readthedocs.org/en/latest/tutorial.html#reading-nmr-files:</a>
</tt><pre style="margin: 0em;">

</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">
import nmrglue as ng
dic,data = ng.pipe.read(&quot;test.fid&quot;)
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">
For the *.ft2 files, how big are they?  I wonder if you can downsample
the original *.fid files so that the *.ft2 files are within 10 to 100
kB (using the nmrPipe extract command, etc.).  Anyway, just add a
system test, and we can then discuss more of the design before
implementing the nmrglue interface.  From your aims, it sounds pretty
straightforward.  If the number of relax spectrum.nmrglue_* user
functions expand significantly to access more of the nmrglue
functionality, maybe we can create a dedicated nmrglue user function
class later on.  Anyway, we just have to make sure that relax
continues to operate smoothly when the scipy/matplotlib/nmrglue
packages are absent.

One problem will be storage of the nmrglue data.  This will probably
not fit into the relax data store, as it absolutely requires to_xml()
and from_xml() methods to allow the data to be saved and read again.
Any ideas?  We could create a special class in lib.spectrum.nmrglue
which uses the singleton design pattern
(<a  rel="nofollow" href="https://en.wikipedia.org/wiki/Singleton_pattern">https://en.wikipedia.org/wiki/Singleton_pattern</a>), as is used
extensively in relax.  Just 'grep -i' for 'singleton'.  The data
storage would then be temporary.  Or, ideally, we could modify the
nmrglue data structures to be convertible to and from XML. Some ideas
should be discussed with the nmrglue authors though (which is why I
have CCed Jonathan, so he knows we are developing a simple
relax-nmrglue interface).  At the moment, I don't know much about the
nmrglue designs.

For the user functions, do you know if nmrglue has an icon that we can
use for the menus and user function wizard pages in the GUI?

Cheers,

Edward



</pre><tt>On 27 November 2014 at 11:54, Troels Emtek√¶r Linnet 
</tt><tt>&lt;tlinnet@xxxxxxxxx&gt; wrote:
</tt><blockquote class="blockquote"><pre style="margin: 0em;">
Hi Edward.

To:
</pre><tt>test_suite/shared_data/dispersion/repeated_analysis/SOD1/cpmg_disp_sod1d90a_060521/cpmg_disp_sod1d90a_060521_normal.fid/ft2_data 
</tt><tt>
</tt><pre style="margin: 0em;">

</pre><tt>I will add the corresponding .ft2 files. To limit size use, I will 
</tt><tt>add just
</tt><pre style="margin: 0em;">
very few .ft2 files.

I will add wrapper functions which will:
- read a ft2 file
- read a range of ft2 files according to a glob of file names
- plot the spectrum

manipulate the numpy arrray, to certain functions.

Plotting in matplotlib.

Best
Troels




Troels Emtek√¶r Linnet

2014-11-27 11:33 GMT+01:00 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">
Hi Troels,

This is no problem.  Just create the branch.  But before adding code,
</pre><tt>we should discuss the design.  This has two benefits - it will be 
</tt><tt>much
</tt><pre style="margin: 0em;">
simpler for you in the long run, and it would avoid any redesigns if
the first attempt doesn't fit into the relax infrastructure well.
</pre><tt>Could you describe nmrglue, including links, and what you'd like 
</tt><tt>to do
</tt><pre style="margin: 0em;">
with it?  Would you like to interact with the program at runtime, or
simply read its output?  Would you like to create input files?

Cheers,

Edward



</pre><tt>On 27 November 2014 at 11:01, Troels Emtek√¶r Linnet 
</tt><tt>&lt;tlinnet@xxxxxxxxx&gt;
</tt><pre style="margin: 0em;">
wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">
Dear Edward.

I am about to setup a new test branch for using nmrglue.

I would need to compare all intensities in a long range of spectra.

I will setup a new branch by:
<a  rel="nofollow" href="http://wiki.nmr-relax.com/Git_branch_creation">http://wiki.nmr-relax.com/Git_branch_creation</a>

I already have some test code, which is working.

I am a little unsure where this will be going.

But essentially, I would like to write some wrapper functions to
nmrglue,
which can be handsome.

Best
Troels Emtek√¶r Linnet
_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-devel mailing list
relax-devel@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="http://www.nmr-relax.com/mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a>
</pre></blockquote></blockquote><pre style="margin: 0em;">

</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">

</pre></blockquote><pre style="margin: 0em;">



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00005" href="msg00005.html">Re: Implement handles for nmrglue in relax</a></strong>
<ul><li><em>From:</em> Jonathan Helmus</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Tue Dec 02 23:20:10 2014</div>  
</body>
</html>
