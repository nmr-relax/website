<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: generic_fns.relaxation_data.delete() -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Tue, 20 Jan 2009 00:09:13 +0100 -->
<!--X-Message-Id: 7f080ed10901191508h1af52ce2n5bb2bec6551c44b5@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 4974CC48.9090704@ncbr.chemi.muni.cz -->
<!--X-Reference: 7f080ed10901191234j37263801gff2c838a4793c466@mail.gmail.com -->
<!--X-Reference: 4974FC73.4090401@ncbr.chemi.muni.cz -->
<!--X-Reference: 7f080ed10901191454p4511e3d1n706cc2c1fd64c242@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: generic_fns.relaxation_data.delete() -- January 20, 2009 - 00:09</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: generic_fns.relaxation_data.delete()</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00104" class="tabs">Index by Date</a> | <a href="threads.html#00104" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00103.html">Date Prev</a>] [<a href="msg00105.html">Date Next</a>] [<a href="msg00103.html">Thread Prev</a>] [<a href="msg00105.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Petr Novak &lt;shaman@xxxxxxxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Tue, 20 Jan 2009 00:08:37 +0100</li>
<li class="menuitem">
<em>Cc</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00104.html">7f080ed10901191508h1af52ce2n5bb2bec6551c44b5@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;4974CC48.9090704@xxxxxxxxxxxxxxxxxx&gt;	&lt;7f080ed10901191234j37263801gff2c838a4793c466@xxxxxxxxxxxxxx&gt;	&lt;4974FC73.4090401@xxxxxxxxxxxxxxxxxx&gt;	&lt;7f080ed10901191454p4511e3d1n706cc2c1fd64c242@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on January 20, 2009 - 00:09:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi,

I've created the generic_fns/chemical_shift.py file by copying
generic_fns/relax_data.py for you.  This name can change later.  I'm
off to bed now, so I won't be able to respond to any questions until
later.  But please see the relax-commits mailing list
(<a  rel="nofollow" href="/mail.gna.org/public/relax-commits">https://mail.gna.org/public/relax-commits</a>) for details, although the
archive can take up to 1 hour to update.  I would suggest subscribing
to this list to see the changes to your code.

Regards,

Edward


On Mon, Jan 19, 2009 at 11:54 PM, Edward d'Auvergne
&lt;edward@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">On Mon, Jan 19, 2009 at 11:19 PM, Petr Novak &lt;shaman@xxxxxxxxxxxxxxxxxx&gt; 
wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">

</pre></blockquote><pre style="margin: 0em;">[snip]

</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">I am working with Pavel Kaderavek on 'relax_csa' branch. Since I am not
experienced coder I use existing code as an inspiration and sort of
'template code' for our own changes/features. Just now I am trying to
implement functions for manipulating with chemical shift tensor data
(cs_tensor.read/copy/delete/display()) to generic_fns. As a template for
these functions I've taken generic_fns/relaxation_data.py. When I got to
delete() and display() I found this in code:


</pre></blockquote><pre style="margin: 0em;">

Coding by replication is also how I do most of my coding in relax
nowadays, even for core infrastructure changes.  A lot of new
functionality is very similar to the current code, so this makes life
much easier.

As for taking 'generic_fns/relax_data.py' (I'm assuming this is the
file and not 'generic_fns/relaxation_data.py'), is this actually the
best starting point?  It gives you code which works at the spin system
level, which is what you need, but the concepts and code in
'generic_fns/diffusion_tensor.py' will also be extremely useful.



</pre></blockquote><pre style="margin: 0em;">Exactly as you said. 'generic_fns/relax_data.py' is template for
spin-level functionality and 'generic_fns/diffusion_tensor.py'
inspiration for tensor-related functionality.
</pre></blockquote><pre style="margin: 0em;">

This sounds like the file to copy then.


</pre><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">If 'generic_fns/relax_data.py' is the best, then I will use the
subversion command 'svn cp' to copy 'generic_fns/relax_data.py' to
some other file for you.  This preserves the historic links between
the files in the repository so developers now and in the future can
see where you started from - this is essential.  So I need to know
what you would like to call the new file.  Once I have made the copy,
you can use 'svn up' on your checked out copy of the 'cst' branch to
get the code.




</pre></blockquote><pre style="margin: 0em;">Aforementioned 'duality' in the templates makes me hasitate which file
should be the copied ('generic_fns/relax_data.py' or
'generic_fns/diffusion_tensor.py'). Is it good idea to simply add
'_cst', e.g. 'generic_fns/relax_data_cst.py' ?
</pre></blockquote><pre style="margin: 0em;">

The name has of this file has nothing to do with relaxation data.  I
would suggest a name related to it's function, something that is also
generalisable for other chemical shift related functions.  I would
therefore suggest:

generic_fns/chemical_shift.py

There may be a better suited name though that you could think of.


</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">relax&gt; relax_data.delete(ri_label='R1', frq_label='600')
Traceback (most recent call last):
File &quot;&lt;console&gt;&quot;, line 1, in ?
File &quot;/home/shaman/relax/prompt/relax_data.py&quot;, line 195, in delete
  relax_data.delete(ri_label=ri_label, frq_label=frq_label)
File &quot;/home/shaman/relax/generic_fns/relax_data.py&quot;, line 410, in delete
  self.run = run
NameError: global name 'run' is not defined


</pre></blockquote><pre style="margin: 0em;">

And this is the result.  The relaxation data deletion code is
currently non-functional in the 1.3 line.  It's not used much and is
not in a system test, hence why it hasn't been converted yet.  But if
you convert it for your code, that will be very good for learning the
differences between the two lines.

</pre></blockquote><pre style="margin: 0em;">Yes, I did the conversion for delete() function and after finishing this
email I will do the same for display() function. Do you want me to post
it here or should it be included in our patch ?
</pre></blockquote><pre style="margin: 0em;">

For this code, I would suggest one patch per small increment of code
you make - for example fixing the delete() function should be 1 single
patch.  Once you have made the patch, you need to write a commit
message for me to use.  This is all finely documented in the
development chapter of the relax manual.

I have a question though, how do you know that this function now
works?  One part of the new relax design of the 1.3 line, thanks to
Gary Thompson's work with the test suite, is the power and simplicity
of the unit tests and system/functional tests.  To check that delete()
works, either a unit test or system test could be written for it.
Then if the function works, the test passes.  Otherwise the test
fails.  This is extremely useful for coding and debugging, and the
test should ideally be written before coding or fixing the actual
function.

This also applies for the full analysis of the ellipsoidal CS tensor.
Please have a close look at the system test framework, and the scripts
in 'test_suite/system_tests/scripts' to see how this is done.  You
should before you start anything have a system test which checks the
full behaviour of the modified analysis - carefully checking the
results to see if it is the same as what your code based on the 1.2
line returns.  Do you have a link for that code that you could post
here, just for reference?  The test will only pass once absolutely
everything is functional!


</pre><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">Was it you that coded the original
version of the ellipsoidal CS tensor, based on the 1.2 line code?


</pre></blockquote><pre style="margin: 0em;">Yes, it was me. Pavel did implementation of code for equations and I did
the code dealing with reading/handling/writing of data.
</pre></blockquote><pre style="margin: 0em;">

Ah, ok.  This will be useful to know.


</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">My theory about this is:
a) I missed something important in my python self.education :-) (I
deserted from biochemistry field so it is very probable)


</pre></blockquote><pre style="margin: 0em;">

This is relax's design, and nothing to do with python.  And my
undergrad background is pure biochemistry as well ;)  No chemistry,
physics, maths, statistics, or coding (well apart from first year
classes for all but the coding).



</pre></blockquote><pre style="margin: 0em;">Well, knowing that this &quot;conversion&quot; is doable is inspiring and
motivating :-)
</pre></blockquote><pre style="margin: 0em;">

I wouldn't call it a conversion - I still remember all my biology
skills.  It can freak some people out when they get a question they
weren't expecting from someone they would least expect to be a
biologist ;)


</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">c) There is always some other option :-P :-)


</pre></blockquote><pre style="margin: 0em;">

I'm too slow converting the entire code base :)




</pre></blockquote><pre style="margin: 0em;">As I understood it's now way bigger then original &quot;script&quot; for executing
Model free program and reading its results :-)
</pre></blockquote><pre style="margin: 0em;">

There is quite a lot of code in there nowadays!


</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">Can you please comment on this ? Btw do you think it should be deleted
from every pipe or just from 'cdp' ( = pipes.get_pipe() ).


</pre></blockquote><pre style="margin: 0em;">

I hope the comments above cover it all.  If not, feel free to ask
about anything on this list.

Cheers,

Edward



</pre></blockquote><pre style="margin: 0em;">Thanks for your valuable comments and I'll get back to coding :-)
</pre></blockquote><pre style="margin: 0em;">

Before you do, remember that patches should be small and cover only
one concept/idea/fix.  If they are over 50 lines of code, I would be
worried.  This will slow development for a while, but I need to
carefully check every last line of code.  And this is how the
development should be done also when you have commit access.  Other
relax developers may also check your code.  These small changes should
continually be applied to the repository, one by one.  One massive
patch cannot be accepted into an open source project, or any project
for that matter.

Cheers,

Edward

</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00096" href="msg00096.html">generic_fns.relaxation_data.delete()</a></strong>
<ul><li><em>From:</em> Petr Novak</li></ul></li>
<li><strong><a name="00097" href="msg00097.html">Re: generic_fns.relaxation_data.delete()</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00102" href="msg00102.html">Re: generic_fns.relaxation_data.delete()</a></strong>
<ul><li><em>From:</em> Petr Novak</li></ul></li>
<li><strong><a name="00103" href="msg00103.html">Re: generic_fns.relaxation_data.delete()</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Tue Jan 20 02:00:33 2009</div>  
</body>
</html>
