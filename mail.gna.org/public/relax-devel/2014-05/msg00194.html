<!-- MHonArc v2.6.18 -->
<!--X-Subject: [bug #22017] LinAlgError, for all numerical CPMG models. -->
<!--X-From-R13: "Febryf S. Zvaarg" &#60;@A&#45;DSBZK.W@HOZWR&#45;ORRDSEENtan.bet> -->
<!--X-Date: Wed, 07 May 2014 17:07:50 +0200 -->
<!--X-Message-Id: 20140507&#45;150749.sv20529.5081@gna.org -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>[bug #22017] LinAlgError, for all numerical CPMG models. -- May 07, 2014 - 17:07</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />[bug #22017] LinAlgError, for all numerical CPMG models.</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00194" class="tabs">Index by Date</a> | <a href="threads.html#00194" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00193.html">Date Prev</a>] [<a href="msg00195.html">Date Next</a>] [<a href="msg00193.html">Thread Prev</a>] [<a href="msg00195.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Troels E. Linnet&quot; &lt;tlinnet@xxxxxxxxxxxxx&gt;, relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Date</em>: Wed, 07 May 2014 17:07:50 +0200</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00194.html">20140507-150749.sv20529.5081@gna.org</a>&gt;</li>
<li class="menuitem">
<em>References</em>: </li>
<li class="menuitem">
<em>User-agent</em>: Mozilla/5.0 (X11; Linux x86_64; rv:24.0) Gecko/20100101 Firefox/24.0</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Troels E. Linnet</strong> on May 07, 2014 - 17:07:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">URL:
  &lt;<a  rel="nofollow" href="http://gna.org/bugs/?22017">http://gna.org/bugs/?22017</a>&gt;

                 Summary: LinAlgError, for all numerical CPMG models.
                 Project: relax
            Submitted by: tlinnet
            Submitted on: Wed 07 May 2014 03:07:49 PM UTC
                Category: relax's source code
Specific analysis category: Relaxation dispersion
                Priority: 7 - High
                Severity: 4 - Important
                  Status: None
             Assigned to: None
         Originator Name: 
        Originator Email: 
             Open/Closed: Open
                 Release: Repository: trunk
         Discussion Lock: Any
        Operating System: All systems

    _______________________________________________________

Details:

Hi Edward.

The attached script, will make relax trip.

I am reading in fake R2eff points, and then do a back calculation with:

    sfrq_1 = 599.8908617*1E6
    ncycs_1 = [2, 4, 8, 10, 20, 30, 40, 60]
    sfrq_2 = 499.8908617*1E6
    ncycs_2 = [2, 4, 8, 10, 30, 35, 40, 50]

With the following dynamic parameters
['Ala', 1, 'N', {'r2': {r20_key_1:10, r20_key_2:11.5}, 'r2a': {r20_key_1:10,
r20_key_2:11.5}, 'r2b': {r20_key_1:10, r20_key_2:11.5}, 'kex': 1000, 'pA':
0.99, 'dw': 2} ]

#################3
relax_disp.r2eff_read_spin(id='CPMG_599.9', spin_id=':1@N',
file='CPMG_599.9_1_N.txt', dir=None, disp_point_col=1, offset_col=None,
data_col=2, error_col=3, sep=None)
Opening the file 'CPMG_599.9_1_N.txt' for reading.
The following R2eff/R1rho data has been loaded into the relax data store:

# R2eff_key                                 Disp_point              R2eff     
             R2eff_error             
sq_cpmg_599.89086170_0.000_33.333             33.333333333333336      
1.000000000000000       0.100000000000000    
sq_cpmg_599.89086170_0.000_66.667             66.666666666666671      
1.000000000000000       0.100000000000000    
sq_cpmg_599.89086170_0.000_133.333           133.333333333333343      
1.000000000000000       0.100000000000000    
sq_cpmg_599.89086170_0.000_166.667           166.666666666666686      
1.000000000000000       0.100000000000000    
sq_cpmg_599.89086170_0.000_333.333           333.333333333333371      
1.000000000000000       0.100000000000000    
sq_cpmg_599.89086170_0.000_500.000           500.000000000000000      
1.000000000000000       0.100000000000000    
sq_cpmg_599.89086170_0.000_666.667           666.666666666666742      
1.000000000000000       0.100000000000000    
sq_cpmg_599.89086170_0.000_1000.000         1000.000000000000000      
1.000000000000000       0.100000000000000    
Traceback (most recent call last):
  File &quot;/sbinlab2/tlinnet/software/NMR-relax/relax_trunk/multi/processor.py&quot;,
line 494, in run
    self.callback.init_master(self)
  File &quot;/sbinlab2/tlinnet/software/NMR-relax/relax_trunk/multi/__init__.py&quot;,
line 318, in default_init_master
    self.master.run()
  File &quot;/sbinlab2/tlinnet/software/NMR-relax/relax_trunk/relax.py&quot;, line 194,
in run
    self.interpreter.run(self.script_file)
  File
&quot;/sbinlab2/tlinnet/software/NMR-relax/relax_trunk/prompt/interpreter.py&quot;, line
275, in run
    return run_script(intro=self.__intro_string, local=locals(),
script_file=script_file, show_script=self.__show_script,
raise_relax_error=self.__raise_relax_error)
  File
&quot;/sbinlab2/tlinnet/software/NMR-relax/relax_trunk/prompt/interpreter.py&quot;, line
569, in run_script
    return console.interact(intro, local, script_file,
show_script=show_script, raise_relax_error=raise_relax_error)
  File
&quot;/sbinlab2/tlinnet/software/NMR-relax/relax_trunk/prompt/interpreter.py&quot;, line
468, in interact_script
    exec_script(script_file, local)
  File
&quot;/sbinlab2/tlinnet/software/NMR-relax/relax_trunk/prompt/interpreter.py&quot;, line
347, in exec_script
    runpy.run_module(module, globals)
  File &quot;/usr/lib64/python2.6/runpy.py&quot;, line 140, in run_module
    fname, loader, pkg_name)
  File &quot;/usr/lib64/python2.6/runpy.py&quot;, line 34, in _run_code
    exec code in run_globals
  File
&quot;/sbinlab2/tlinnet/software/NMR-relax/relax_trunk/test_suite/system_tests/scripts/relax_disp/cpmg_synthetic.py&quot;,
line 270, in &lt;module&gt;
    r2effs = optimisation.back_calc_r2eff(spin=cur_spin, spin_id=cur_spin_id)
  File
&quot;/sbinlab2/tlinnet/software/NMR-relax/relax_trunk/specific_analyses/relax_disp/optimisation.py&quot;,
line 188, in back_calc_r2eff
    chi2 = model.func(param_vector)
  File
&quot;/sbinlab2/tlinnet/software/NMR-relax/relax_trunk/target_functions/relax_disp.py&quot;,
line 1419, in func_ns_cpmg_2site_3D
    return self.calc_ns_cpmg_2site_3D_chi2(R20A=R20, R20B=R20, dw=dw, pA=pA,
kex=kex)
  File
&quot;/sbinlab2/tlinnet/software/NMR-relax/relax_trunk/target_functions/relax_disp.py&quot;,
line 542, in calc_ns_cpmg_2site_3D_chi2
    r2eff_ns_cpmg_2site_3D(r180x=self.r180x, M0=self.M0, r20a=R20A[r20_index],
r20b=R20B[r20_index], pA=pA, pB=pB, dw=dw_frq, k_AB=k_AB, k_BA=k_BA,
inv_tcpmg=self.inv_relax_times[0][mi], tcp=self.tau_cpmg[0][mi],
back_calc=self.back_calc[0][si][mi][0],
num_points=self.num_disp_points[0][si][mi][0], power=self.power[0][mi])
  File
&quot;/sbinlab2/tlinnet/software/NMR-relax/relax_trunk/lib/dispersion/ns_cpmg_2site_3d.py&quot;,
line 115, in r2eff_ns_cpmg_2site_3D
    Rexpo = matrix_exponential(R*tcp[i])
  File
&quot;/sbinlab2/tlinnet/software/NMR-relax/relax_trunk/lib/linear_algebra/matrix_exponential.py&quot;,
line 46, in matrix_exponential
    W, V = eig(A)
  File &quot;/usr/lib64/python2.6/site-packages/numpy/linalg/linalg.py&quot;, line 999,
in eig
    _assertFinite(a)
  File &quot;/usr/lib64/python2.6/site-packages/numpy/linalg/linalg.py&quot;, line 144,
in _assertFinite
    raise LinAlgError, &quot;Array must not contain infs or NaNs&quot;
LinAlgError: Array must not contain infs or NaNs
#########################






    _______________________________________________________

File Attachments:


-------------------------------------------------------
Date: Wed 07 May 2014 03:07:49 PM UTC  Name: cpmg_synthetic.py  Size: 16kB  
By: tlinnet

&lt;<a  rel="nofollow" href="http://gna.org/bugs/download.php?file_id=20667">http://gna.org/bugs/download.php?file_id=20667</a>&gt;

    _______________________________________________________

Reply to this item at:

  &lt;<a  rel="nofollow" href="http://gna.org/bugs/?22017">http://gna.org/bugs/?22017</a>&gt;

_______________________________________________
  Message sent via/by Gna!
  <a  rel="nofollow" href="http://gna.org/">http://gna.org/</a>



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00264" href="msg00264.html">[bug #22017] LinAlgError, for all numerical CPMG models.</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00195" href="msg00195.html">Re: [bug #22017] LinAlgError, for all numerical CPMG models.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu May 08 20:40:10 2014</div>  
</body>
</html>
