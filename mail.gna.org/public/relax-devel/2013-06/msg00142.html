<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: [bug #20821] Optimisation failure / round error on windows 64 bit -->
<!--X-From-R13: Febryf Szgrxæe Zvaarg <gyvaargNtznvy.pbz> -->
<!--X-Date: Thu, 20 Jun 2013 15:18:49 +0200 -->
<!--X-Message-Id: CA+CBx2Ocaao9TR7QV+gJc04h8N6xtMUCytXpUxCFpqjQ=_jAvA@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20130516&#45;220427.sv20529.24009@gna.org -->
<!--X-Reference: 20130517&#45;081119.sv2782.89797@gna.org -->
<!--X-Reference: 20130618&#45;160441.sv20529.22737@gna.org -->
<!--X-Reference: 20130619&#45;174212.sv20529.70413@gna.org -->
<!--X-Reference: 20130619&#45;174557.sv20529.43060@gna.org -->
<!--X-Reference: 20130619&#45;180259.sv2782.21288@gna.org -->
<!--X-Reference: 20130620&#45;071823.sv20529.55156@gna.org -->
<!--X-Reference: CAED9pY8f=TEm5nAZNOCz&#45;=KD41gLnGfnZ2Ng8QL69u=vj&#45;rWPA@mail.gmail.com -->
<!--X-Reference: CA+CBx2NJjsM9FeT_tijFuFKz2gKy3aSu4tC0Npb+ZXz0htKptQ@mail.gmail.com -->
<!--X-Reference: CAED9pY_kXVEi+WaGQiOMiGkCdyf2=AsNDFMzT+xNvsQ3R&#45;4B9A@mail.gmail.com -->
<!--X-Reference: CA+CBx2OvR1Z7xKYNAw3QnU53pcJx=wAUh_AWvbBk0syXTEcrTg@mail.gmail.com -->
<!--X-Reference: CAED9pY_AY8sx1YB5VZLkSDZK02vXS1K0EPLX2uEti8YvvvBVQQ@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [bug #20821] Optimisation failure / round error on windows 64 bit -- June 20, 2013 - 15:18</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: [bug #20821] Optimisation failure / round error on windows 64 bit</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00142" class="tabs">Index by Date</a> | <a href="threads.html#00142" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00141.html">Date Prev</a>] [<a href="msg00143.html">Date Next</a>] [<a href="msg00141.html">Thread Prev</a>] [<a href="msg00143.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Edward d'Auvergne&quot; &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Thu, 20 Jun 2013 15:17:58 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113;	h=mime-version:in-reply-to:references:from:date:message-id:subject:to	:cc:content-type:content-transfer-encoding;	bh=W67NshVS2l7xNDHnqn2BbLkVdPWyYrJXZgwxd9Tktwo=;	b=zJvkemH29ucP8zSbaRy8fynytf/sI+lBa4GQkhkPn4okBI1huC6vvlRx31Tpy8YOav	xiFObp+jMqbkgj8OIEFgOQAi2n/vQa97JPo/4XZs+ZexlmrS2jBEPjZUd/riTFre11eG	o+qxac+c9XYbSIcgjkRBBcJkQ9i9AS7jUsM3qB1km5TQiC1pVIPjCvQ4WeRranNRCYe4	tZZF8EcbQ/5EasxnC+HQsAHsijyD//DOyZgVcxdMTAKPgEUbL4TQicfxtso7moH5qiOb	9U6lguogN7000xY92AulZi2AFFsZWV+EX+1RD+/iV36KVSdbMQaPBV4DZNdEZC2epGzJ	8Ofg==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00142.html">CA+CBx2Ocaao9TR7QV+gJc04h8N6xtMUCytXpUxCFpqjQ=_jAvA@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;20130516-220427.sv20529.24009@xxxxxxx&gt;	&lt;20130517-081119.sv2782.89797@xxxxxxx&gt;	&lt;20130618-160441.sv20529.22737@xxxxxxx&gt;	&lt;20130619-174212.sv20529.70413@xxxxxxx&gt;	&lt;20130619-174557.sv20529.43060@xxxxxxx&gt;	&lt;20130619-180259.sv2782.21288@xxxxxxx&gt;	&lt;20130620-071823.sv20529.55156@xxxxxxx&gt;	&lt;CAED9pY8f=TEm5nAZNOCz-=KD41gLnGfnZ2Ng8QL69u=vj-rWPA@xxxxxxxxxxxxxx&gt;	&lt;CA+CBx2NJjsM9FeT_tijFuFKz2gKy3aSu4tC0Npb+ZXz0htKptQ@xxxxxxxxxxxxxx&gt;	&lt;CAED9pY_kXVEi+WaGQiOMiGkCdyf2=AsNDFMzT+xNvsQ3R-4B9A@xxxxxxxxxxxxxx&gt;	&lt;CA+CBx2OvR1Z7xKYNAw3QnU53pcJx=wAUh_AWvbBk0syXTEcrTg@xxxxxxxxxxxxxx&gt;	&lt;CAED9pY_AY8sx1YB5VZLkSDZK02vXS1K0EPLX2uEti8YvvvBVQQ@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Troels Emtekær Linnet</strong> on June 20, 2013 - 15:18:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">I think we should close the bug.

I will stay with python32 setyp for relax

Best
Troels

Troels Emtekær Linnet


2013/6/20 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

Sorry for all the hassles!  Normally you don't need the Microsoft
compiler to use relax as the C modules are pre-compiled for 32-bit
Python systems (<a  rel="nofollow" href="http://www.nmr-relax.com/download.html#MS_Windows">http://www.nmr-relax.com/download.html#MS_Windows</a>).
It's only relax developers who need to use this.  Sometimes users will
install non-supported software (64-bit Python, non-official Python,
etc.) and then they may require it.  But I can only support one
official Python release, currently only 2.7, for the MS Windows
distribution archive.

Once the relax_disp branch supports more models, then it will be
merged back into the relax trunk and probably released as relax 3.1.
Though first relax 3.0 will need to be released.  It may take a while
for relax 3.1 to come out with full support for relaxation dispersion
analyses, and hence pre-compiled modules.

As for the errors with 64-bit WinPython, it is probably safe to assume
that they have jumped the gun and bundled 64-bit Numpy for Windows
before it is ready to be shipped to users.  What is strange is that on
my Linux test system, I have self compiled 64-bit
Python+numpy+scipy+wxPython and I don't have any precision issues.
There is something fishy with this WinPython 2.7.5 version.

Cheers,

Edward



On 20 June 2013 14:09, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Edward.

I have spent several hours, to try to fix this issue.

If you have winpython 64 bit, you need  - Visual Studio Professional 2012
to compile. This is because: target_functions\relax_fit.c
make an include to the header file #include &lt;Python.h&gt;

And if you only have &quot;Visual Studio Express 2012 for Windows Desktop&quot;,
there will
be a link error. I think then Scons try to compile x86, and the header
files in python will not be
matched.

If you have professional, Scons try to compile amd64, and will find
the correct link in the header files.
(Or something like this )

This setup is listed here:
<a  rel="nofollow" href="http://nmr-relax.kimlinnet.dk/index.php?title=Installation_windows_Python_x86-64_Visual_Studio_Express_Professional">http://nmr-relax.kimlinnet.dk/index.php?title=Installation_windows_Python_x86-64_Visual_Studio_Express_Professional</a>

But I am happy to announce, that with python 32 I have NO errors!
This setup is listed here:
<a  rel="nofollow" href="http://nmr-relax.kimlinnet.dk/index.php?title=Installation_windows_Python_x86-32_Visual_Studio_Express_for_Windows_Desktop">http://nmr-relax.kimlinnet.dk/index.php?title=Installation_windows_Python_x86-32_Visual_Studio_Express_for_Windows_Desktop</a>


Weird!


Troels Emtekær Linnet


2013/6/20 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Ok, then we'll have to go with that.  It's good that the icons are
back :)  Could I ask you to make one more small change to patch3
(<a  rel="nofollow" href="https://gna.org/support/download.php?file_id=18123">https://gna.org/support/download.php?file_id=18123</a>).  Could you add a
line or two to the comments with information about the WinPython
version that you are using, and anything else to do with WinPython
that you think might be important?  It would be good to make it clear
in the comments that this is not results from the official Python
sources.

Cheers,

Edward



On 20 June 2013 13:11, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">The te, should have places=1, since else I get the error.

Traceback (most recent call last):
  File 
&quot;C:\WinPython27\relax_disp_64\test_suite\system_tests\model_free.py&quot;,
line 1782, in test_opt_constr_cd_mt_S2_0_970_te_2048_Rex_0_149
    self.value_test(spin, select=select, s2=s2, te=te, rex=rex, 
chi2=chi2)
  File 
&quot;C:\WinPython27\relax_disp_64\test_suite\system_tests\model_free.py&quot;,
line 3142, in value_test
    self.assertAlmostEqual(spin.te / 1e-12, te, places=2, msg=mesg)
AssertionError: Optimisation failure.


And I am enjoying the icons in the menu. :-)

/Troels



2013/6/20 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Does this work with places=2 or 3 for the te value?  That would be
better.  The precision is shocking, I have to say.  I would suggest
that in the comments, that something about this being the WinPython
distribution would also be useful for these precision records.  I
would not think that it is the Microsoft C compiler that is a problem,
but rather the numpy packages bundled with this Python derivative.
The Microsoft compiler has never been an issue before, so I would
suggest that the WinPython people have a precision bug in their code.
Or maybe they have deliberately turned down their precision so that it
appears as if their distribution is much faster than standard
Python+numpy?  Is it also WinPython that has problems with icons in
the menus?

Regards,

Edward


On 20 June 2013 09:18, Troels E. Linnet
&lt;NO-REPLY.INVALID-ADDRESS@xxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Follow-up Comment #5, bug #20821 (project relax):

Reply to bug #20821: (<a  rel="nofollow" href="https://web.archive.org/web/https://gna.org/bugs/?20821">https://gna.org/bugs/?20821</a>) Optimisation 
failure /
round error on windows 64 bit

I experienced more precision problems.

I had a terrible need, to turn down precision, quite a lot.

So much, that I think something is wrong with the MS
Visual Studio Express &quot;&quot;&quot; Professional &quot;&quot;&quot; 64 bit compilation.

-            self.assertAlmostEqual(spin.s2, s2, msg=mesg)
+            self.assertAlmostEqual(spin.s2, s2, places=6, msg=mesg)

-            self.assertAlmostEqual(spin.te / 1e-12, te, 5, msg=mesg)
+            self.assertAlmostEqual(spin.te / 1e-12, te, places=1, 
msg=mesg)

-            self.assertAlmostEqual(spin.rex * (2.0 * pi *
cdp.spectrometer_frq[cdp.ri_ids[0]])**2, rex * (2.0 * pi *
cdp.spectrometer_frq[cdp.ri_ids[0]])**2, msg=mesg)
+            self.assertAlmostEqual(spin.rex * (2.0 * pi *
cdp.spectrometer_frq[cdp.ri_ids[0]])**2, rex * (2.0 * pi *
cdp.spectrometer_frq[cdp.ri_ids[0]])**2, places=4, msg=mesg)

        # Optimisation values.
        s2 = 0.9699999999999995
        te = 2048.000000000022283
        rex = 0.14900000000000566 / (2.0 * pi *
cdp.spectrometer_frq[cdp.ri_ids[0]])**2

My value
# s2: 0.9700002183674102 : Diff -2.18367410709e-07
# te: 2048.015293187 Diff: -0.0152931869779
# rex: 0.14899473115727899 Diff: 5.26884272667e-06

# 64-bit Windows 7 (<a  rel="nofollow" href="https://web.archive.org/web/https://gna.org/bugs/?20821">https://gna.org/bugs/?20821</a>).
# System: Windows
# Release: 7
# Version: 6.1.7601
# Architecture: 64bit WindowsPE
# Machine: AMD64
# Processor: Intel64 Family 6 Model 37 Stepping 2, GenuineIntel
# Python version: 2.7.5
# numpy version: 1.7.1
# Compilation: Visual Studio Express 2012, Professional, for 64 bit
compilation
# s2: 0.9700002183674102
# te: 2048.015293187
# rex: 0.14899473115727899
# chi2: 2.3195994119090742e-10
# iter: 116
# f_count: 411
# g_count: 411
# h_count: 0
# warning: None

(file #18123)
    _______________________________________________________

Additional Item Attachment:

File name: patch3                         Size:2 KB


    _______________________________________________________

Reply to this item at:

  &lt;<a  rel="nofollow" href="http://gna.org/bugs/?20821">http://gna.org/bugs/?20821</a>&gt;

_______________________________________________
  Message sent via/by Gna!
  <a  rel="nofollow" href="http://gna.org/">http://gna.org/</a>


_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-devel mailing list
relax-devel@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a>
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00094" href="msg00094.html">[bug #20821] Optimisation failure / round error on windows 64 bit</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00124" href="msg00124.html">[bug #20821] Optimisation failure / round error on windows 64 bit</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00125" href="msg00125.html">[bug #20821] Optimisation failure / round error on windows 64 bit</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00126" href="msg00126.html">[bug #20821] Optimisation failure / round error on windows 64 bit</a></strong>
<ul><li><em>From:</em> Edward d Auvergne</li></ul></li>
<li><strong><a name="00132" href="msg00132.html">[bug #20821] Optimisation failure / round error on windows 64 bit</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00134" href="msg00134.html">Re: [bug #20821] Optimisation failure / round error on windows 64 bit</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00138" href="msg00138.html">Re: [bug #20821] Optimisation failure / round error on windows 64 bit</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00139" href="msg00139.html">Re: [bug #20821] Optimisation failure / round error on windows 64 bit</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00140" href="msg00140.html">Re: [bug #20821] Optimisation failure / round error on windows 64 bit</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00141" href="msg00141.html">Re: [bug #20821] Optimisation failure / round error on windows 64 bit</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu Jun 20 17:00:09 2013</div>  
</body>
</html>
