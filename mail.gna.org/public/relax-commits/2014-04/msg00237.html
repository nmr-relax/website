<!-- MHonArc v2.6.18 -->
<!--X-Subject: r22848 &#45; /trunk/auto_analyses/relax_disp.py -->
<!--X-From-R13: rqjneqNaze&#45;erynk.pbz -->
<!--X-Date: Thu, 24 Apr 2014 15:32:35 +0200 -->
<!--X-Message-Id: E1WdJlT&#45;0003C8&#45;AR@subversion.gna.org -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>r22848 - /trunk/auto_analyses/relax_disp.py -- April 24, 2014 - 15:32</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />r22848 - /trunk/auto_analyses/relax_disp.py</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00237" class="tabs">Index by Date</a> | <a href="threads.html#00237" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00236.html">Date Prev</a>] [<a href="msg00238.html">Date Next</a>] [<a href="msg00236.html">Thread Prev</a>] [<a href="msg00238.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: relax-commits@xxxxxxx</li>
<li class="menuitem">
<em>Date</em>: Thu, 24 Apr 2014 13:32:35 -0000</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00237.html">E1WdJlT-0003C8-AR@subversion.gna.org</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>edward</strong> on April 24, 2014 - 15:32:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Author: bugman
Date: Thu Apr 24 15:32:34 2014
New Revision: 22848

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=22848&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=22848&amp;view=rev</a>
Log:
Expanded the relaxation dispersion auto-analysis to allow the grid search to 
be turned off.

By setting the grid_inc argument to None, the grid search will be turned off. 
 As a replacement, the
value.set user function is used for all model parameters to set them to their 
default values prior
to minimisation.  This design is for speed as optimisation from the defaults 
is often - though not
always - good enough.  It can be used, for example, in the test suite to make 
the system tests much
faster.


Modified:
    trunk/auto_analyses/relax_disp.py

Modified: trunk/auto_analyses/relax_disp.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/auto_analyses/relax_disp.py?rev=22848&amp;r1=22847&amp;r2=22848&amp;view=diff">http://svn.gna.org/viewcvs/relax/trunk/auto_analyses/relax_disp.py?rev=22848&amp;r1=22847&amp;r2=22848&amp;view=diff</a>
==============================================================================
--- trunk/auto_analyses/relax_disp.py   (original)
+++ trunk/auto_analyses/relax_disp.py   Thu Apr 24 15:32:34 2014
@@ -36,7 +36,7 @@
 from pipe_control.pipes import has_pipe
 from prompt.interpreter import Interpreter
 from specific_analyses.relax_disp.data import has_exponential_exp_type, 
has_cpmg_exp_type, has_fixed_time_exp_type, has_r1rho_exp_type, loop_frq
-from specific_analyses.relax_disp.variables import MODEL_CR72, 
MODEL_CR72_FULL, MODEL_DPL94, MODEL_IT99, MODEL_LIST_ANALYTIC, 
MODEL_LIST_R1RHO, MODEL_LIST_R1RHO_FULL, MODEL_LM63, MODEL_LM63_3SITE, 
MODEL_M61, MODEL_M61B, MODEL_MP05, MODEL_MMQ_CR72, MODEL_NS_CPMG_2SITE_3D, 
MODEL_NS_CPMG_2SITE_3D_FULL, MODEL_NS_CPMG_2SITE_EXPANDED, 
MODEL_NS_CPMG_2SITE_STAR, MODEL_NS_CPMG_2SITE_STAR_FULL, MODEL_NS_MMQ_2SITE, 
MODEL_NS_MMQ_3SITE, MODEL_NS_MMQ_3SITE_LINEAR, MODEL_NS_R1RHO_2SITE, 
MODEL_NS_R1RHO_3SITE, MODEL_NS_R1RHO_3SITE_LINEAR, MODEL_R2EFF, MODEL_TAP03, 
MODEL_TP02, MODEL_TSMFK01
+from specific_analyses.relax_disp.variables import MODEL_CR72, 
MODEL_CR72_FULL, MODEL_DPL94, MODEL_IT99, MODEL_LIST_ANALYTIC, 
MODEL_LIST_R1RHO, MODEL_LIST_R1RHO_FULL, MODEL_LM63, MODEL_LM63_3SITE, 
MODEL_M61, MODEL_M61B, MODEL_MP05, MODEL_MMQ_CR72, MODEL_NS_CPMG_2SITE_3D, 
MODEL_NS_CPMG_2SITE_3D_FULL, MODEL_NS_CPMG_2SITE_EXPANDED, 
MODEL_NS_CPMG_2SITE_STAR, MODEL_NS_CPMG_2SITE_STAR_FULL, MODEL_NS_MMQ_2SITE, 
MODEL_NS_MMQ_3SITE, MODEL_NS_MMQ_3SITE_LINEAR, MODEL_NS_R1RHO_2SITE, 
MODEL_NS_R1RHO_3SITE, MODEL_NS_R1RHO_3SITE_LINEAR, MODEL_PARAMS, MODEL_R2EFF, 
MODEL_TAP03, MODEL_TP02, MODEL_TSMFK01
 from status import Status; status = Status()
 
 
@@ -58,8 +58,8 @@
         @type results_dir:          str
         @keyword models:            The list of relaxation dispersion models 
to optimise.
         @type models:               list of str
-        @keyword grid_inc:          Number of grid search increments.
-        @type grid_inc:             int
+        @keyword grid_inc:          Number of grid search increments.  If 
set to None, then the grid search will be turned off and the default 
parameter values will be used instead.
+        @type grid_inc:             int or None
         @keyword mc_sim_num:        The number of Monte Carlo simulations to 
be used for error analysis at the end of the analysis.
         @type mc_sim_num:           int
         @keyword exp_mc_sim_num:    The number of Monte Carlo simulations 
for the error analysis in the 'R2eff' model when exponential curves are 
fitted.  This defaults to the value of the mc_sim_num argument when not 
given.  For the 2-point fixed-time calculation for the 'R2eff' model, this 
argument is ignored.
@@ -365,9 +365,16 @@
             # Nested model simplification.
             nested = self.nesting(model=model)
 
-            # Grid search.
+            # Otherwise use a grid search of default values to start 
optimisation with.
             if not nested:
-                self.interpreter.grid_search(inc=self.grid_inc)
+                # Grid search.
+                if self.grid_inc:
+                    self.interpreter.grid_search(inc=self.grid_inc)
+
+                # Default values.
+                else:
+                    for param in MODEL_PARAMS[model]:
+                        self.interpreter.value.set(param=param)
 
         # Minimise.
         self.interpreter.minimise('simplex', func_tol=self.opt_func_tol, 
max_iter=self.opt_max_iterations, constraints=True)



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu Apr 24 16:00:02 2014</div>  
</body>
</html>
