<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: Cool pictures of the Brownian rotational diffusion tensor in	PyMOL. -->
<!--X-From-R13: "Unel E. Fubzcfba" <tnelgNozo.yrrqf.np.hx> -->
<!--X-Date: Tue, 31 Oct 2006 11:53:05 +0100 -->
<!--X-Message-Id: 45472AEA.3060204@bmb.leeds.ac.uk -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 7f080ed10610252045r3dcbba38q58aa53142af96e5a@mail.gmail.com -->
<!--X-Reference: 1162288553.26731.7.camel@pc172&#45;31&#45;2&#45;63.biochem.unimelb.edu.au -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Cool pictures of the Brownian rotational diffusion tensor in	PyMOL. -- October 31, 2006 - 11:53</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Cool pictures of the Brownian rotational diffusion tensor in	PyMOL.</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00202" class="tabs">Index by Date</a> | <a href="threads.html#00202" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00201.html">Date Prev</a>] [<a href="msg00203.html">Date Next</a>] [<a href="msg00198.html">Thread Prev</a>] [<a href="msg00211.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Edward d'Auvergne &lt;edward.dauvergne@xxxxxxxxx&gt;, relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Date</em>: Tue, 31 Oct 2006 10:52:26 +0000</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00202.html">45472AEA.3060204@bmb.leeds.ac.uk</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;<a href="msg00136.html">7f080ed10610252045r3dcbba38q58aa53142af96e5a@mail.gmail.com</a>&gt;	&lt;<a href="msg00198.html">1162288553.26731.7.camel@pc172-31-2-63.biochem.unimelb.edu.au</a>&gt;</li>
<li class="menuitem">
<em>User-agent</em>: Mozilla Thunderbird 1.0 (X11/20041206)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Gary S. Thompson</strong> on October 31, 2006 - 11:53:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Edward d'Auvergne wrote:</pre><br>
<blockquote class="blockquote"><pre style="margin: 0em;">I have implemented a user function for creating a PDB representation of
the Brownian rotational diffusion tensor.  The changes have been made to
the 'tensor_pdb' branch of the repository.  The user function is called
'pdb.create_tensor_pdb()'.</pre><br>
<pre style="margin: 0em;">Unfortunately Molmol refuses to recognise PDB CONECT records.  The
CalcBond function only calculates bonds when two atoms are within a
certain distance.</pre><br>
<tt> </tt><br>
<br>
</blockquote><pre style="margin: 0em;">This is not the complete story... There is an addBond function</pre><br>
<pre style="margin: 0em;"><br> AddBond</pre><br>
<pre style="margin: 0em;">*NAME*</pre><br>
<pre style="margin: 0em;">AddBond - add bond between two atoms</pre><br>
<pre style="margin: 0em;">*SYNOPSIS*</pre><br>
<pre style="margin: 0em;">AddBond</pre><br>
<pre style="margin: 0em;">*DESCRIPTION*</pre><br>
<tt>Add a bond between the two selected atoms. Exactly two atoms must be 
selected before this command is executed, an error message will be 
issued otherwise.</tt><br>
<br>
<pre style="margin: 0em;">*EXAMPLE*</pre><br>
<pre style="margin: 0em;">AddBond</pre><br>
<pre style="margin: 0em;">*SEE ALSO*</pre><br>
<tt>RemoveBond 
&lt;<a  href="http://www.hhmi.umbc.edu/toolkit/structure/molmol/RemoveBond.html">http://www.hhmi.umbc.edu/toolkit/structure/molmol/RemoveBond.html</a>&gt;</tt><br>
<br>
<pre style="margin: 0em;">*DATE*</pre><br>
<pre style="margin: 0em;">931126</pre><br>
<pre style="margin: 0em;">url <a  href="http://www.hhmi.umbc.edu/toolkit/structure/*molmol*/*AddBond*.html">http://www.hhmi.umbc.edu/toolkit/structure/*molmol*/*AddBond*.html</a></pre><br>
<pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">However this function does require atoms...</pre><br>
<pre style="margin: 0em;">you can also add drawing objetcs</pre><br>
<pre style="margin: 0em;"><br> AddDrawobj</pre><br>
<pre style="margin: 0em;">*NAME*</pre><br>
<pre style="margin: 0em;">AddDrawobj - add line, rectangle or circle</pre><br>
<pre style="margin: 0em;">*SYNOPSIS*</pre><br>
<pre style="margin: 0em;">AddDrawobj ( line | rect | circle ) ( 2D | 3D )</pre><br>
<pre style="margin: 0em;">*DESCRIPTION*</pre><br>
<tt>Add a line, rectangle or circle for annotation. The first argument 
selects the type of drawing object.</tt><br>
<br>
<tt>If the second argument is 2D, the object is placed at a default location 
and can be moved to the desired place. It will always keep its screen 
position and is not related to any atoms.</tt><br>
<br>
<tt>If the second argument is 3D, a label is added for each molecule that 
has selected atoms. The initial position in space is calculated as the 
average of the coordinates of all selected atoms of the molecule. The 
positon relative to these atoms can be changed with the mouse or with 
the MoveDrawobj 
&lt;<a  href="http://hugin.ethz.ch/wuthrich/software/molmol/help/html/MoveDrawobj.html">http://hugin.ethz.ch/wuthrich/software/molmol/help/html/MoveDrawobj.html</a>&gt; 
command.</tt><br>
<br>
<pre style="margin: 0em;">The created primitives have the property &quot;drawobj&quot;.</pre><br>
<pre style="margin: 0em;">*EXAMPLES*</pre><br>
<pre style="margin: 0em;">AddDrawobj line 3D</pre><br>
<pre style="margin: 0em;">*SEE ALSO*</pre><br>
<tt>SelectAtom 
&lt;<a  href="http://hugin.ethz.ch/wuthrich/software/molmol/help/html/SelectAtom.html">http://hugin.ethz.ch/wuthrich/software/molmol/help/html/SelectAtom.html</a>&gt;, 
ColorPrim 
&lt;<a  href="http://hugin.ethz.ch/wuthrich/software/molmol/help/html/ColorPrim.html">http://hugin.ethz.ch/wuthrich/software/molmol/help/html/ColorPrim.html</a>&gt;, 
LinePrim 
&lt;<a  href="http://hugin.ethz.ch/wuthrich/software/molmol/help/html/LinePrim.html">http://hugin.ethz.ch/wuthrich/software/molmol/help/html/LinePrim.html</a>&gt;, 
StyleDrawobj 
&lt;<a  href="http://hugin.ethz.ch/wuthrich/software/molmol/help/html/StyleDrawobj.html">http://hugin.ethz.ch/wuthrich/software/molmol/help/html/StyleDrawobj.html</a>&gt;, 
MoveDrawobj 
&lt;<a  href="http://hugin.ethz.ch/wuthrich/software/molmol/help/html/MoveDrawobj.html">http://hugin.ethz.ch/wuthrich/software/molmol/help/html/MoveDrawobj.html</a>&gt;, 
RemovePrim 
&lt;<a  href="http://hugin.ethz.ch/wuthrich/software/molmol/help/html/RemovePrim.html">http://hugin.ethz.ch/wuthrich/software/molmol/help/html/RemovePrim.html</a>&gt;, 
AddTitle 
&lt;<a  href="http://hugin.ethz.ch/wuthrich/software/molmol/help/html/AddTitle.html">http://hugin.ethz.ch/wuthrich/software/molmol/help/html/AddTitle.html</a>&gt;, 
AddText 
&lt;<a  href="http://hugin.ethz.ch/wuthrich/software/molmol/help/html/AddText.html">http://hugin.ethz.ch/wuthrich/software/molmol/help/html/AddText.html</a>&gt;</tt><br>
<br>
<pre style="margin: 0em;">*DATE
*</pre><br>
<pre style="margin: 0em;">*<a  href="http://hugin.ethz.ch/wuthrich/software/molmol/help/html/AddDrawobj.html">http://hugin.ethz.ch/wuthrich/software/molmol/help/html/AddDrawobj.html</a>
*</pre><br>
<pre style="margin: 0em;"><br> MoveDrawobj</pre><br>
<pre style="margin: 0em;">*NAME*</pre><br>
<pre style="margin: 0em;">MoveDrawobj - move draw object</pre><br>
<pre style="margin: 0em;">*SYNOPSIS*</pre><br>
<pre style="margin: 0em;">MoveDrawobj expr expr expr expr</pre><br>
<pre style="margin: 0em;">*DESCRIPTION*</pre><br>
<tt>Move all selected draw objects (like lines or rectangles) by the given 
amount. The first argument gives the index of the control point 
(starting at 0) to be moved, the rest of the arguments give the amount 
of movement in each direction.</tt><br>
<br>
<tt>Moving the control points of drawing objects is normally done 
interactively by using the middle mouse button.</tt><br>
<br>
<pre style="margin: 0em;">*EXAMPLE*</pre><br>
<pre style="margin: 0em;">MoveDrawObj 0 0.3 0.1 0.2</pre><br>
<pre style="margin: 0em;">*SEE ALSO*</pre><br>
<tt>AddDrawobj 
&lt;<a  href="http://hugin.ethz.ch/wuthrich/software/molmol/help/html/AddDrawobj.html">http://hugin.ethz.ch/wuthrich/software/molmol/help/html/AddDrawobj.html</a>&gt;, 
SelectPrim 
&lt;<a  href="http://hugin.ethz.ch/wuthrich/software/molmol/help/html/SelectPrim.html">http://hugin.ethz.ch/wuthrich/software/molmol/help/html/SelectPrim.html</a>&gt;</tt><br>
<br>
<pre style="margin: 0em;">*DATE*</pre><br>
<pre style="margin: 0em;">950618</pre><br>
<pre style="margin: 0em;"><a  href="http://hugin.ethz.ch/wuthrich/software/molmol/help/html/MoveDrawobj.html">http://hugin.ethz.ch/wuthrich/software/molmol/help/html/MoveDrawobj.html</a></pre><br>
<pre style="margin: 0em;"><br>*
*</pre><br>
<pre style="margin: 0em;">which can be moved</pre><br>
<pre style="margin: 0em;"><br></pre><br>
<blockquote class="blockquote"><pre style="margin: 0em;">The representation in PyMOL is however impressive.  If you have
diffusion tensor results, I recommend generating the tensor PDB
representation and then loading the file into PyMOL together with the
structure of the macromolecule.  Make sure to read the information in
the docstring of the 'pdb.create_tensor_pdb()' user function about what
the tensor PDB representation means.</pre><br>
<pre style="margin: 0em;">To create the tensor representation, I have added a number of algorithms
to relax.  Firstly the centre of mass is calculated for the selected
residues (represented by a C atom).  Then the axes of the diffusion are
calculated, as unit vectors scaled to the appropriate length, and a C
atom placed at the position of this vector plus the centre of mass.
Finally a uniform distribution of vectors on a sphere is generated using
spherical coordinates.  By incrementing the polar angle using an arccos
distribution, a radial array of vectors representing latitude are
created while incrementing the azimuthal angle evenly creates the
longitudinal vectors.  These unit vectors, which are distributed within
the PDB frame and are of 1 Angstrom in length, are first rotated into
the diffusion frame using a rotation matrix (the spherical diffusion
tensor is not rotated).  Then they are multiplied by the diffusion
tensor matrix to extend the vector out to the correct length, and
finally scaled by 1.8e-6 so that the vectors reasonably superimpose onto
the macromolecular structure.  The last set of algorithms place all this
information into a PDB file.  The distribution of vectors are
represented by H atoms and are all connected using PDB CONECT records.
Each H atom is connected to its two neighbours on the both the longitude
and latitude.  This results in a representation with longitudinal and
latitudinal lines.</pre><br>
<pre style="margin: 0em;">Edward</pre><br>
<pre style="margin: 0em;"><br>P.S.  I will probably soon merge all this new code back into the 1.3
line.  It appears to be bug free at the moment.</pre><br>
<tt><br>On Thu, 2006-10-26 at 13:45 +1000, Edward d'Auvergne wrote: 
 </tt><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">During discussions with James Horne, James helped with a lot of
debugging of relax back in 2004 prior to relax being publicly
released, a few ideas were raised about how to represent the diffusion
tensor superimposed onto the 3D molecular structure.  This
representation would significantly help in the comparison of different
diffusion tensors.  To compare diffusion tensors, you really need to
compare the eigenvalues (Dx, Dy, and Dz, or Dpar and Dper).  However
because the corresponding eigenvectors, the axes of the tensor, may
not be the same between two tensors (they could be 90 degrees out),
you really need to orient the diffusion tensor with respect to the
molecule so that you can compare the correct eigenvalues.  I'll send
another post with a quick tutorial on diffusion tensors which may help
if there were parts of this paragraph which didn't make sense.</pre><br>
<pre style="margin: 0em;">At minimum you need to have the eigenvector representing the unique
axis of the spheroid tensors superimposed onto the structure in 3D, or
the three eigenvectors (axes) of the ellipsoid.  For the spheroids
this could possibly be done by adding two bonded atoms into a PDB
file, one at the center of mass, the other placed in the correct
orientation at a scaled distance away from the center atom.  Then you
could use the 'neon' representation for them in Molmol.</pre><br>
<pre style="margin: 0em;">Extending on the idea, it could be possible to create a picture of the
diffusion tensors in Molmol.  This would look similar to the contours
presented in Tensor.  By calculating the center of mass, adding atoms
to a PDB file, connecting them, and then using 'neon' or 'line' in
Molmol, a polygon representation of the tensor could be created.
This, combined with the new model-free analysis protocol encoded in
the 'full_analysis.py' sample script, could be the final nail in
Tensor's coffin ;)</pre><br>
<pre style="margin: 0em;">In the new PDB file, which by default could be called 'tensor.pdb',
the atoms could all be set to a new residue called 'TNS' (an abbrev.
of tensor).  The residue could be setup using the HET, HETNAM, and
FORMUL records, each atom could be represented by a HETATM record,
followed by the TER record, and then all the atoms joined up by CONECT
records.  The file could be terminated with the MASTER and END
records.  Would anyone know how to get Molmol 2K to recognise the
CONECT records as being bonds???</pre><br>
<pre style="margin: 0em;">I might try to implement these ideas into the 1.3 development line.</pre><br>
<tt>Edward<br>
   </tt><br>
<br>
</blockquote><pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">_______________________________________________
relax (<a  href="http://nmr-relax.com">http://nmr-relax.com</a>)</pre><br>
<pre style="margin: 0em;">This is the relax-devel mailing list
relax-devel@xxxxxxx</pre><br>
<pre style="margin: 0em;">To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  href="https://mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a></pre><br>
<pre style="margin: 0em;">.</pre><br>
<tt> </tt><br>
<br>
</blockquote><pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">--
-------------------------------------------------------------------
Dr Gary Thompson
Astbury Centre for Structural Molecular Biology,
University of Leeds, Astbury Building,
Leeds, LS2 9JT, West-Yorkshire, UK             Tel. +44-113-3433024
email: garyt@xxxxxxxxxxxxxxx                   Fax  +44-113-2331407
-------------------------------------------------------------------</pre><br>
<pre style="margin: 0em;"><br></pre><br>
<br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00211" href="msg00211.html">Re: Cool pictures of the Brownian rotational diffusion tensor in	PyMOL.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00136" href="msg00136.html">Representing the Brownian rotational diffusion tensor in Molmol, etc.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00198" href="msg00198.html">Cool pictures of the Brownian rotational diffusion tensor in PyMOL.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Tue Oct 31 16:41:23 2006</div>  
</body>
</html>
