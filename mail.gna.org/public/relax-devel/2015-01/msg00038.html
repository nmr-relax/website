<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [task #7882] Implement Monte&#45;Carlo simulation, where errors are generated with width of standard deviation or residuals -->
<!--X-From-R13: Febryf Szgrxæe Zvaarg &#60;gyvaargNaze&#45;erynk.pbz> -->
<!--X-Date: Fri, 16 Jan 2015 18:26:16 +0100 -->
<!--X-Message-Id: CA+CBx2P_mhA1hcB01ACYcyqAZwFakMD6BLwJ3q8jdWBwQYJ_ZA@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20150116&#45;161430.sv20529.18990@gna.org -->
<!--X-Reference: CAED9pY9Ptz7oi+jFAENz=kk9+62Cy+BSjQ+_YHpk6ou5iivqkw@mail.gmail.com -->
<!--X-Reference: CA+CBx2PXMLmqGVVfKZWwV_OR2Qx0QPVebaYnoebZ4W&#45;t3fj6CA@mail.gmail.com -->
<!--X-Reference: CAED9pY9xFdgK=y==pHoEbd5=0v1qXd&#45;SXdM+czNo0vE2Fx7FQg@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [task #7882] Implement Monte-Carlo simulation, where errors are generated with width of standard deviation or residuals -- January 16, 2015 - 18:26</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: [task #7882] Implement Monte-Carlo simulation, where errors are generated with width of standard deviation or residuals</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00038" class="tabs">Index by Date</a> | <a href="threads.html#00038" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00037.html">Date Prev</a>] [<a href="msg00039.html">Date Next</a>] [<a href="msg00037.html">Thread Prev</a>] [<a href="msg00039.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Edward d'Auvergne&quot; &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Fri, 16 Jan 2015 18:25:31 +0100</li>
<li class="menuitem">
<em>Cc</em>: &quot;Troels E. Linnet&quot; &lt;NO-REPLY.INVALID-ADDRESS@xxxxxxx&gt;, &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113; h=mime-version:sender:in-reply-to:references:from:date:message-id :subject:to:cc:content-type; bh=j8/1Jy7tC0Bc0M32iH7n6NpTlXcba4uDjLKNrnCpRU0=; b=m2rxbesRvlFbhKKOHVg8RLs0qdX63x45ocPE2K5kAELuKwl+8OzR4EBnKUjdqmYm3A FFHOqVczpbqbeigsB45ln3RS8i0GKUWGa+B013MeJYNNLzQKZX944SS7nDx7jFeKyMbV 8PBJWEUHBK+ZkxK8y2TYhmy5JhND5DZzAllO5NZk9iSjI16MPf8KxCx46BNwkYWNT0vv QFL37UvEhcicWYQkhbtAB2Ku8XIYHl+/kXlELZQ6qWxa0gWBL/9jOOUXPjGJuM0VzmaR GHCoauS6AYEPieRqiFupUCgBTchEYx0L4nsSnZ3EOoGrKQi4qSwrZ0WDtLqqrvYowKxW Nqsg==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00038.html">CA+CBx2P_mhA1hcB01ACYcyqAZwFakMD6BLwJ3q8jdWBwQYJ_ZA@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;<a href="msg00034.html">20150116-161430.sv20529.18990@gna.org</a>&gt; &lt;CAED9pY9Ptz7oi+jFAENz=kk9+62Cy+BSjQ+_YHpk6ou5iivqkw@mail.gmail.com&gt; &lt;<a href="msg00036.html">CA+CBx2PXMLmqGVVfKZWwV_OR2Qx0QPVebaYnoebZ4W-t3fj6CA@mail.gmail.com</a>&gt; &lt;CAED9pY9xFdgK=y==pHoEbd5=0v1qXd-SXdM+czNo0vE2Fx7FQg@mail.gmail.com&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Troels Emtekær Linnet</strong> on January 16, 2015 - 18:26:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi Edward.

I do not claim that &quot;Monte Carlo simulations&quot; is not the gold standard.

I am merely trying to investigate the method by which one draw the errors.

In the current case for dispersion, one trust the R2eff errors to be the
distribution.
These are individual per spin.

Another distribution could be from how well the clustered fit performed.
And this is what I am looking into.

Best
Troels

2015-01-16 18:09 GMT+01:00 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:

</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

Do the R2eff errors look reasonable?  Another issue is in clustered
analysis, certain parameters can be over-constrained by being shared
between multiple data sets.  This is the biased introduced by an
under-fitted problem.  This can artificially decrease the errors.
Anyway, you should plot the Monte Carlo simulations, a bit like I did
in figure 4 of my paper:

   d'Auvergne, E. J. and Gooley, P. R. (2006). Model-free model
elimination: A new step in the model-free dynamic analysis of NMR
relaxation data. J. Biomol. NMR, 35(2), 117-135.
(<a  rel="nofollow" href="http://dx.doi.org/10.1007/s10858-006-9007-z">http://dx.doi.org/10.1007/s10858-006-9007-z</a>)

That might indicate if something is wrong - i.e. if optimisation of
certain simulations have failed.  However this problem only causes
errors to be bigger than they should be (unless all simulations have
failed).  I don't know how Monte Carlo simulations could fail
otherwise.  Monte Carlo simulations are the gold standard for error
analysis.  All other error analysis techniques are judged based on how
close the approach this gold standard.  Saying that the Monte Carlo
simulations technique failed is about equivalent to claiming the Earth
is flat!  I challenge you to test the statement on a statistics
professor at your Uni ;)  Anyway, if Monte Carlo failed, using
residuals will not save you as the failure point will be present in
both techniques.  What could have failed is the model or the input
data.  Under-fitting due to too much R2eff data variability in the
spins of the cluster would be my guess.  Do you see similarly small
errors in the non-clustered analysis of the same data?

Regards,

Edward






On 16 January 2015 at 17:48, Troels Emtekær Linnet
&lt;tlinnet@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Edward.

At the moment, I am fairly confident that I should investigate the
distribution from which the errors are drawn.

The method in relax draws from a Gauss distribution of the R2eff errors,
</pre></blockquote><pre style="margin: 0em;">but
</pre><blockquote class="blockquote"><pre style="margin: 0em;">I should try to draw errors from the
overall residual instead.

It is two different methods.

My PI, has earlier has before analysed the data with the aforementioned
method, and got errors in the hundreds.
Errors are 5-10% of the fitted global parameters.

Having 0.5-1 percent error is way to small, and I see this for 4 of my
datasets.

So, something is fishy.

Best
Troels

2015-01-16 17:30 GMT+01:00 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">

Hi Troels,

You should be very careful with your interpretation here.  The
curvature of the chi-squared space does not correlate with the
parameter errors!  Well, it most cases it doesn't.  You will see this
if you map the space for different Monte Carlo simulations.  Some
extreme edge cases might help in understanding the problem.  Lets say
you have a kex value of 100 with a real error of 1000.  In this case,
you could still have a small, perfectly quadratic minimum.  But this
minimum will jump all over the place with the simulations.  Another
extreme example might be kex of 100 with a real error of 0.00000001.
In this case, the chi-squared space could look similar to the
screenshot you attached to the task ( <a  rel="nofollow" href="http://gna.org/task/?7882">http://gna.org/task/?7882</a>).
However Monte Carlo simulations may hardly perturb the chi-squared
space.  I have observed scenarios similar to these hypothetical cases
with the Lipari and Szabo model-free protein dynamics analysis.

There is one case where the chi-squared space and error space match,
and that is at the limit of the minimum when the chi-squared space
becomes quadratic.  This happens when you zoom right into the minimum.
The correlation matrix approach makes this assumption.  Monte Carlo
simulations do not.  In fact, Monte Carlo simulations are the gold
standard.  There is no technique which is better than Monte Carlo
simulations, if you use enough simulations.  You can only match it by
deriving exact symbolic error equations.

Therefore you really should investigate how your optimisation space is
perturbed by Monte Carlo simulations to understand the correlation -
or non-correlation - of the chi-squared curvature and the parameter
errors.  Try mapping the minimum for the simulations and see if the
distribution of minima matches the chi-squared curvature
(<a  rel="nofollow" href="http://gna.org/task/download.php?file_id=23527">http://gna.org/task/download.php?file_id=23527</a>).

Regards,

Edward


On 16 January 2015 at 17:14, Troels E. Linnet
&lt;NO-REPLY.INVALID-ADDRESS@xxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">URL:
  &lt;<a  rel="nofollow" href="http://gna.org/task/?7882">http://gna.org/task/?7882</a>&gt;

                 Summary: Implement Monte-Carlo simulation, where
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">errors
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">are
generated with width of standard deviation or residuals
                 Project: relax
            Submitted by: tlinnet
            Submitted on: Fri 16 Jan 2015 04:14:30 PM UTC
         Should Start On: Fri 16 Jan 2015 12:00:00 AM UTC
   Should be Finished on: Fri 16 Jan 2015 12:00:00 AM UTC
                Category: relax's source code
                Priority: 5 - Normal
                  Status: In Progress
        Percent Complete: 0%
             Assigned to: tlinnet
             Open/Closed: Open
         Discussion Lock: Any
                  Effort: 0.00

    _______________________________________________________

Details:

This is implemented due to strange results.

A relaxation dispersion on data with 61 spins, and a monte carlo
simulation
with 500 steps, showed un-expected low errors.

-------
results.read(file=fname_results, dir=dir_results)

# Number of MC
mc_nr = 500

monte_carlo.setup(number=mc_nr)
monte_carlo.create_data()
monte_carlo.initial_values()
minimise.execute(min_algor='simplex', func_tol=1e-25,
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">max_iter=int(1e7),
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">constraints=True)
monte_carlo.error_analysis()
--------

The kex was 2111 and with error 16.6.

When performing a dx.map, some weird results was found:

i_sort    dw_sort    pA_sort    kex_sort      chi2_sort
471       4.50000    0.99375    2125.00000    4664.31083
470       4.50000    0.99375    1750.00000    4665.23872

So, even a small change with chi2, should reflect a larger
deviation with kex.

It seems, that change of R2eff values according to their errors, is
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">not
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">&quot;enough&quot;.

According to the regression book of Graphpad
<a  rel="nofollow" href="http://www.graphpad.com/faq/file/Prism4RegressionBook.pdf">http://www.graphpad.com/faq/file/Prism4RegressionBook.pdf</a>

Page 33, and 104.
Standard deviation of residuals is:

Sxy = sqrt(SS/(N-p))

where SS is sum of squares. N - p, is the number of degrees of
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">freedom.
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">In relax, SS is spin.chi2, and is weighted.

The random scatter to each R2eff point should be drawn from a gaussian
distribution with a mean of Zero and SD equal to Sxy.

Additional, find the 2.5 and 97.5 percentile for each parameter.
The range between these values is the confidence interval.




    _______________________________________________________

File Attachments:


-------------------------------------------------------
Date: Fri 16 Jan 2015 04:14:30 PM UTC  Name: Screenshot-1.png  Size:
161kB
By: tlinnet

&lt;<a  rel="nofollow" href="http://gna.org/task/download.php?file_id=23527">http://gna.org/task/download.php?file_id=23527</a>&gt;

    _______________________________________________________

Reply to this item at:

  &lt;<a  rel="nofollow" href="http://gna.org/task/?7882">http://gna.org/task/?7882</a>&gt;

_______________________________________________
  Message sent via/by Gna!
  <a  rel="nofollow" href="http://gna.org/">http://gna.org/</a>


_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-devel mailing list
relax-devel@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a>
</pre></blockquote></blockquote><pre style="margin: 0em;">


</pre></blockquote><pre style="margin: 0em;">

</pre></blockquote><pre style="margin: 0em;">

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00039" href="msg00039.html">Re: [task #7882] Implement Monte-Carlo simulation, where errors are generated with width of standard deviation or residuals</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00034" href="msg00034.html">[task #7882] Implement Monte-Carlo simulation, where errors are generated with width of standard deviation or residuals</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00035" href="msg00035.html">Re: [task #7882] Implement Monte-Carlo simulation, where errors are generated with width of standard deviation or residuals</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00036" href="msg00036.html">Re: [task #7882] Implement Monte-Carlo simulation, where errors are generated with width of standard deviation or residuals</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00037" href="msg00037.html">Re: [task #7882] Implement Monte-Carlo simulation, where errors are generated with width of standard deviation or residuals</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Fri Jan 16 19:20:15 2015</div>  
</body>
</html>
