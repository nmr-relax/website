<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: Why does one have to loop over the dispersion points? -->
<!--X-From-R13: "Sqjneq q'Ohiretar" &#60;rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Mon, 05 May 2014 19:07:52 +0200 -->
<!--X-Message-Id: CAED9pY8Zb35J7m=2_0Mj4_7aBAaD_61SUQN5ZeBwAcsS27yiOg@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: CA+CBx2MkmjbAbk0zn5Wj0jf5A6kBqg=sMQW&#45;ATxTdjTS7+M8AQ@mail.gmail.com -->
<!--X-Reference: CAED9pY8ZfvZefM9zN_eJzNV2BmDN2J2StBmQ=baWPxi&#45;14RxZg@mail.gmail.com -->
<!--X-Reference: CA+CBx2NgPVtEXyHqSJO8ChAPGFg=a_u93GT6fz6d&#45;ETZG2g+7Q@mail.gmail.com -->
<!--X-Reference: CAED9pY8suh6NjnU5HfQAwZNEhh6Y7vg5&#45;uYDdBGDZ0xv7Zaeow@mail.gmail.com -->
<!--X-Reference: CA+CBx2OvwrdmmHs1QtA7GdzjiREdSbz&#45;COzDQESbpDh=LRNszw@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Why does one have to loop over the dispersion points? -- May 05, 2014 - 19:07</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Why does one have to loop over the dispersion points?</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00130" class="tabs">Index by Date</a> | <a href="threads.html#00130" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00129.html">Date Prev</a>] [<a href="msg00131.html">Date Next</a>] [<a href="msg00129.html">Thread Prev</a>] [<a href="msg00271.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Mon, 5 May 2014 19:07:01 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113; h=mime-version:sender:in-reply-to:references:date:message-id:subject :from:to:cc:content-type:content-transfer-encoding; bh=lc8AKONbklhdULIDJGfVC0bIxV/nw0m7RGuiMtQKm+E=; b=n5GYC4FsLn/cURaaCGhDCmSs3GsaxPN4oPqMUoIbVnK8aHQcJd+MrfvKaYH4Yg44nq zf2xgw95rlDg3XhH8H2bWauG6gNKhMrUbfy2jJ9nf0cbrmOdGSmIwNeD0Ic9jR4rVXpp gUvW51XmANJljwGPMWDWeqjqOdZ6kgZZND8mmj4ev9PoWhaPxBNmS0wyfeab+ugZdNVz 2kYM3iYk6vAqVPqWeNHvoNF3iRs7QOapLyEiagVdi97jqZ0fIoJNC1Pxpq2cgQF9YxTi WQI6C/YnIlDoTPRPPJxjNaWFgfCdj3E26jcfXTa47CxPH/hC6pn/Z0ywmxt6gC+tUSk0 bhew==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;CAED9pY8Zb35J7m=2_0Mj4_7aBAaD_61SUQN5ZeBwAcsS27yiOg@mail.gmail.com&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;CA+CBx2MkmjbAbk0zn5Wj0jf5A6kBqg=sMQW-ATxTdjTS7+M8AQ@mail.gmail.com&gt; &lt;CAED9pY8ZfvZefM9zN_eJzNV2BmDN2J2StBmQ=baWPxi-14RxZg@mail.gmail.com&gt; &lt;CA+CBx2NgPVtEXyHqSJO8ChAPGFg=a_u93GT6fz6d-ETZG2g+7Q@mail.gmail.com&gt; &lt;<a href="msg00128.html">CAED9pY8suh6NjnU5HfQAwZNEhh6Y7vg5-uYDdBGDZ0xv7Zaeow@mail.gmail.com</a>&gt; &lt;CA+CBx2OvwrdmmHs1QtA7GdzjiREdSbz-COzDQESbpDh=LRNszw@mail.gmail.com&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on May 05, 2014 - 19:07:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">:)  It does slow it down a little, but that's unavoidable.  It's also
unavoidable in C, Fortran, Perl, etc.  As long as the number of
operations in that loop is minimal, then it's the best you can do.  If
it worries you, you could run a test where you call the target
function say 1e6 times, with and without the loop to see the timing
difference.  Or simply running in Python 2:

for i in xrange(1000000):
 x = 1

Then try:

for i in xrange(100000000):
 x = 2

These two demonstrate the slowness of the Python loop.  But the second
case is extreme and you won't encounter that much looping in these
functions.  So while it is theoretically slower than C and Fortran
looping, you can probably see that no one would care :)  Here is
another test, with Python 2 code:

&quot;&quot;&quot;
import cProfile as profile

def loop_1e6():
    for i in xrange(int(1e6)):
        x = 1

def loop_1e8():
    for i in xrange(int(1e8)):
        x = 1

def sum_conv():
    for i in xrange(100000000):
        x = 2 + 2.

def sum_normal():
    for i in xrange(100000000):
        x = 2. + 2.

def test():
    loop_1e6()
    loop_1e8()
    sum_normal()
    sum_conv()

profile.runctx('test()', globals(), locals())
&quot;&quot;&quot;

Running this on my system shows:

&quot;&quot;&quot;
         7 function calls in 6.707 seconds

   Ordered by: standard name

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    6.707    6.707 &lt;string&gt;:1(&lt;module&gt;)
        1    2.228    2.228    2.228    2.228 aaa.py:11(sum_conv)
        1    2.228    2.228    2.228    2.228 aaa.py:15(sum_normal)
        1    0.000    0.000    6.707    6.707 aaa.py:19(test)
        1    0.022    0.022    0.022    0.022 aaa.py:3(loop_1e6)
        1    2.228    2.228    2.228    2.228 aaa.py:7(loop_1e8)
        1    0.000    0.000    0.000    0.000 {method 'disable' of
'_lsprof.Profiler' objects}
&quot;&quot;&quot;

That should be self explanatory.  The better optimisation targets are
the repeated maths operations and the maths operations that can be
shifted into the target function or the target function
initialisation.  Despite the numbers above which prove my int to float
speed argument as utter nonsense, it might still good to remove the
int to float conversions, if only to match the other functions.

Regards,

Edward




On 5 May 2014 18:45, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">The reason why I ask, is that I am afraid that this for loop slows
everything down.

What do you think?

2014-05-05 18:41 GMT+02:00 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">This is not Python specific though :)  As far as I know, C uses
pass-by-value for arguments, unless they are arrays or other funky
objects/functions/etc..  This is the same behaviour as Python.
Pass-by-reference and pass-by-value is something that needs to be
mastered in all languages, whether or not you have pointers to play
with.

Regards,

Edward



On 5 May 2014 18:30, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">This reminds me:

<a  rel="nofollow" href="http://combichem.blogspot.dk/2013/08/you-know-what-really-grinds-my-gears-in.html">http://combichem.blogspot.dk/2013/08/you-know-what-really-grinds-my-gears-in.html</a>

2014-05-05 17:52 GMT+02:00 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

This is an important difference.  In the first case (back_calc[i] =
Minty[i]), what is happening is that your are copying the data into a
pre-existing structure.  In the second case (back_calc = Minty), the
existing back_calc structure will be overwritten.  Therefore the
back_calc structure in the calling code will be modified in the first
case but not the second.  Here is some demo code:

def mod1(x):
    x[0] = 1

def mod2(x):
    x = [3, 2]

x = [0, 2]
print(x)
mod1(x)
print(x)
mod2(x)
print(x)

I don't know of a way around this.

Regards,

Edward


On 5 May 2014 17:42, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Edward.

In the library function of b14.py, i am looping over
the dispersion points to put in the data.

    for i in range(num_points):

        # The full formula.
        back_calc[i] = Minty[i]

Why can I not just set:
back_calc = Minty

_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-devel mailing list
relax-devel@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="http://www.nmr-relax.com/mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a>
</pre></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00271" href="msg00271.html">Re: Why does one have to loop over the dispersion points?</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00122" href="msg00122.html">Why does one have to loop over the dispersion points?</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00126" href="msg00126.html">Re: Why does one have to loop over the dispersion points?</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00127" href="msg00127.html">Re: Why does one have to loop over the dispersion points?</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00128" href="msg00128.html">Re: Why does one have to loop over the dispersion points?</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00129" href="msg00129.html">Re: Why does one have to loop over the dispersion points?</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Fri May 09 14:20:12 2014</div>  
</body>
</html>
