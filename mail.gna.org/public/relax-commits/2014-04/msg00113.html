<!-- MHonArc v2.6.18 -->
<!--X-Subject: r22724 &#45; in /trunk/specific_analyses: ./ consistency_tests/ frame_order/ jw_mapping/ model_free/ n_state_model/ noe/ relax_d... -->
<!--X-From-R13: rqjneqNaze&#45;erynk.pbz -->
<!--X-Date: Fri, 11 Apr 2014 19:55:59 +0200 -->
<!--X-Message-Id: E1WYfgF&#45;0007df&#45;2u@subversion.gna.org -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>r22724 - in /trunk/specific_analyses: ./ consistency_tests/ frame_order/ jw_mapping/ model_free/ n_state_model/ noe/ relax_d... -- April 11, 2014 - 19:55</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />r22724 - in /trunk/specific_analyses: ./ consistency_tests/ frame_order/ jw_mapping/ model_free/ n_state_model/ noe/ relax_d...</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00113" class="tabs">Index by Date</a> | <a href="threads.html#00113" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00112.html">Date Prev</a>] [<a href="msg00114.html">Date Next</a>] [<a href="msg00112.html">Thread Prev</a>] [<a href="msg00114.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: relax-commits@xxxxxxx</li>
<li class="menuitem">
<em>Date</em>: Fri, 11 Apr 2014 17:55:59 -0000</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00113.html">E1WYfgF-0007df-2u@subversion.gna.org</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>edward</strong> on April 11, 2014 - 19:55:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Author: bugman
Date: Fri Apr 11 19:55:58 2014
New Revision: 22724

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=22724&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=22724&amp;view=rev</a>
Log:
The label and caption for the parameter list user function documentation is 
now supplied to uf_doc().

This allows different types of tables to be generated, for example the 
default value is useful for
the value.set user function but not value.write, while allowing tables to 
still be shared.


Modified:
    trunk/specific_analyses/consistency_tests/parameter_object.py
    trunk/specific_analyses/frame_order/parameter_object.py
    trunk/specific_analyses/jw_mapping/parameter_object.py
    trunk/specific_analyses/model_free/parameter_object.py
    trunk/specific_analyses/n_state_model/parameter_object.py
    trunk/specific_analyses/noe/parameter_object.py
    trunk/specific_analyses/parameter_object.py
    trunk/specific_analyses/relax_disp/parameter_object.py
    trunk/specific_analyses/relax_fit/parameter_object.py

Modified: trunk/specific_analyses/consistency_tests/parameter_object.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/specific_analyses/consistency_tests/parameter_object.py?rev=22724&amp;r1=22723&amp;r2=22724&amp;view=diff">http://svn.gna.org/viewcvs/relax/trunk/specific_analyses/consistency_tests/parameter_object.py?rev=22724&amp;r1=22723&amp;r2=22724&amp;view=diff</a>
==============================================================================
--- trunk/specific_analyses/consistency_tests/parameter_object.py       
(original)
+++ trunk/specific_analyses/consistency_tests/parameter_object.py       Fri 
Apr 11 19:55:58 2014
@@ -49,3 +49,6 @@
         self._add('j0', scope='spin', desc='Spectral density value at 0 MHz 
(from Farrow et al. (1995) JBNMR, 6: 153-162)', py_type=float, set='params', 
grace_string='\\qJ(0)\\Q', err=True, sim=True)
         self._add('f_eta', scope='spin', desc='Eta-test (from Fushman et al. 
(1998) JACS, 120: 10947-10952)', py_type=float, set='params', 
grace_string='\\qF\\s\\xh\\Q', err=True, sim=True)
         self._add('f_r2', scope='spin', desc='R2-test (from Fushman et al. 
(1998) JACS, 120: 10947-10952)', py_type=float, set='params', 
grace_string='\\qF\\sR2\\Q', err=True, sim=True)
+
+        # Set up the user function documentation.
+        self._set_uf_title(&quot;Consistency testing parameters&quot;)

Modified: trunk/specific_analyses/frame_order/parameter_object.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/specific_analyses/frame_order/parameter_object.py?rev=22724&amp;r1=22723&amp;r2=22724&amp;view=diff">http://svn.gna.org/viewcvs/relax/trunk/specific_analyses/frame_order/parameter_object.py?rev=22724&amp;r1=22723&amp;r2=22724&amp;view=diff</a>
==============================================================================
--- trunk/specific_analyses/frame_order/parameter_object.py     (original)
+++ trunk/specific_analyses/frame_order/parameter_object.py     Fri Apr 11 
19:55:58 2014
@@ -68,4 +68,3 @@
 
         # Set up the user function documentation.
         self._set_uf_title(&quot;Frame order parameters&quot;)
-        self._set_uf_table(label=&quot;table: frame order parameters&quot;, 
caption=&quot;Frame order parameters.&quot;)

Modified: trunk/specific_analyses/jw_mapping/parameter_object.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/specific_analyses/jw_mapping/parameter_object.py?rev=22724&amp;r1=22723&amp;r2=22724&amp;view=diff">http://svn.gna.org/viewcvs/relax/trunk/specific_analyses/jw_mapping/parameter_object.py?rev=22724&amp;r1=22723&amp;r2=22724&amp;view=diff</a>
==============================================================================
--- trunk/specific_analyses/jw_mapping/parameter_object.py      (original)
+++ trunk/specific_analyses/jw_mapping/parameter_object.py      Fri Apr 11 
19:55:58 2014
@@ -49,4 +49,3 @@
 
         # Set up the user function documentation.
         self._set_uf_title(&quot;Reduced spectral density mapping parameters&quot;)
-        self._set_uf_table(label=&quot;table: J(w) parameters&quot;, caption=&quot;Reduced 
spectral density mapping parameters.&quot;)

Modified: trunk/specific_analyses/model_free/parameter_object.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/specific_analyses/model_free/parameter_object.py?rev=22724&amp;r1=22723&amp;r2=22724&amp;view=diff">http://svn.gna.org/viewcvs/relax/trunk/specific_analyses/model_free/parameter_object.py?rev=22724&amp;r1=22723&amp;r2=22724&amp;view=diff</a>
==============================================================================
--- trunk/specific_analyses/model_free/parameter_object.py      (original)
+++ trunk/specific_analyses/model_free/parameter_object.py      Fri Apr 11 
19:55:58 2014
@@ -67,4 +67,3 @@
 
         # Set up the user function documentation.
         self._set_uf_title(&quot;Model-free parameters&quot;)
-        self._set_uf_table(label=&quot;table: mf parameters&quot;, caption=&quot;Model-free 
parameters.&quot;)

Modified: trunk/specific_analyses/n_state_model/parameter_object.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/specific_analyses/n_state_model/parameter_object.py?rev=22724&amp;r1=22723&amp;r2=22724&amp;view=diff">http://svn.gna.org/viewcvs/relax/trunk/specific_analyses/n_state_model/parameter_object.py?rev=22724&amp;r1=22723&amp;r2=22724&amp;view=diff</a>
==============================================================================
--- trunk/specific_analyses/n_state_model/parameter_object.py   (original)
+++ trunk/specific_analyses/n_state_model/parameter_object.py   Fri Apr 11 
19:55:58 2014
@@ -53,4 +53,3 @@
 
         # Set up the user function documentation.
         self._set_uf_title(&quot;N-state model parameters&quot;)
-        self._set_uf_table(label=&quot;table: N-state parameters&quot;, 
caption=&quot;N-state model parameters.&quot;)

Modified: trunk/specific_analyses/noe/parameter_object.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/specific_analyses/noe/parameter_object.py?rev=22724&amp;r1=22723&amp;r2=22724&amp;view=diff">http://svn.gna.org/viewcvs/relax/trunk/specific_analyses/noe/parameter_object.py?rev=22724&amp;r1=22723&amp;r2=22724&amp;view=diff</a>
==============================================================================
--- trunk/specific_analyses/noe/parameter_object.py     (original)
+++ trunk/specific_analyses/noe/parameter_object.py     Fri Apr 11 19:55:58 
2014
@@ -46,4 +46,3 @@
 
         # Set up the user function documentation.
         self._set_uf_title(&quot;Steady-state NOE parameters&quot;)
-        self._set_uf_table(label=&quot;table: NOE parameters&quot;, 
caption=&quot;Steady-state NOE parameters.&quot;)

Modified: trunk/specific_analyses/parameter_object.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/specific_analyses/parameter_object.py?rev=22724&amp;r1=22723&amp;r2=22724&amp;view=diff">http://svn.gna.org/viewcvs/relax/trunk/specific_analyses/parameter_object.py?rev=22724&amp;r1=22723&amp;r2=22724&amp;view=diff</a>
==============================================================================
--- trunk/specific_analyses/parameter_object.py (original)
+++ trunk/specific_analyses/parameter_object.py Fri Apr 11 19:55:58 2014
@@ -70,8 +70,9 @@
 
         # Default user function documentation.
         self._uf_title = &quot;Parameters&quot;
-        self._uf_table_label = &quot;table: parameters&quot;
         self._uf_table_caption = &quot;Parameters&quot;
+        self._uf_docs = {}
+        self._uf_captions = {}
 
 
     def __new__(self, *args, **kargs):
@@ -258,20 +259,6 @@
         self._add('peak_intensity', scope='spin', desc='The peak 
intensities', py_type=dict, grace_string='\\qPeak intensities\\Q')
 
 
-    def _set_uf_table(self, label=None, caption=None):
-        &quot;&quot;&quot;Set the title for the user function documentation.
-
-        @keyword label:     The unique label of the table.  This is used to 
identify tables, and is also used in the table referencing in the LaTeX 
compilation of the user manual.
-        @type label:        str
-        @keyword caption:   The caption for the table.
-        @type caption:      str
-        &quot;&quot;&quot;
-
-        # Store the text.
-        self._uf_table_label = label
-        self._uf_table_caption = caption
-
-
     def _set_uf_title(self, title):
         &quot;&quot;&quot;Set the title for the user function documentation.
 
@@ -593,9 +580,15 @@
         return text.split(&quot;'&quot;)[1]
 
 
-    def uf_doc(self, default=False, units=False, type=False):
+    def uf_doc(self, label=None, caption=None, scope=None, default=False, 
units=False, type=False):
         &quot;&quot;&quot;&quot;Create the parameter documentation for the user function 
docstrings.
 
+        @keyword label:     The label of the table.  This is used to 
identify replicated tables, and is also used in the table referencing in the 
LaTeX compilation of the user manual.  If this label is already used, the 
corresponding pre-constructed documentation object will be returned.
+        @type label:        str
+        @keyword caption:   The caption for the table.
+        @type caption:      str
+        @keyword scope:     The parameter scope to restrict the table to.  
If not given, then all parameters of the 'params' and 'fixed' sets will be 
added.
+        @type scope:        str or None
         @keyword default:   A flag which if True will cause the default 
parameter value to be included in the table.
         @type default:      bool
         @keyword units:     A flag which if True will cause the units to be 
included in the table.
@@ -604,11 +597,27 @@
         @type type:         bool
         &quot;&quot;&quot;
 
+        # Sanity check.
+        if label == None:
+            raise RelaxError(&quot;The table identifying label must be supplied.&quot;)
+
+        # The documentation is already set up.
+        if label in self._uf_docs:
+            # Check that the captions are consistent.
+            if self._uf_captions[label] != caption:
+                raise RelaxError(&quot;The new caption '%s' does not match the 
old '%s'.&quot; % (caption, self._uf_captions[label]))
+
+            # Return the existing documentation object.
+            return self._uf_docs[label]
+
         # Initialise the documentation object.
-        doc = Desc_container(self._uf_title)
+        self._uf_docs[label] = Desc_container(self._uf_title)
+
+        # Store the caption for checking purposes.
+        self._uf_captions[label] = caption
 
         # The parameter table.
-        table = uf_tables.add_table(label=self._uf_table_label, 
caption=self._uf_table_caption)
+        table = uf_tables.add_table(label=label, caption=caption)
 
         # Add the headings.
         headings = [&quot;Name&quot;, &quot;Description&quot;]
@@ -623,6 +632,10 @@
         # Add each parameter, first of the parameter set, then the 'generic' 
set.
         for set in ['params', 'fixed']:
             for param in self.loop(set=set):
+                # Limit the scope.
+                if scope and self.scope(param) != scope:
+                    continue
+
                 row = []
                 row.append(param)
                 row.append(self.description(param))
@@ -635,10 +648,10 @@
                 table.add_row(row)
 
         # Add the table to the documentation object.
-        doc.add_table(table.label)
+        self._uf_docs[label].add_table(table.label)
 
         # Return the documentation object.
-        return doc
+        return self._uf_docs[label]
 
 
     def units(self, name):

Modified: trunk/specific_analyses/relax_disp/parameter_object.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/specific_analyses/relax_disp/parameter_object.py?rev=22724&amp;r1=22723&amp;r2=22724&amp;view=diff">http://svn.gna.org/viewcvs/relax/trunk/specific_analyses/relax_disp/parameter_object.py?rev=22724&amp;r1=22723&amp;r2=22724&amp;view=diff</a>
==============================================================================
--- trunk/specific_analyses/relax_disp/parameter_object.py      (original)
+++ trunk/specific_analyses/relax_disp/parameter_object.py      Fri Apr 11 
19:55:58 2014
@@ -89,4 +89,3 @@
 
         # Set up the user function documentation.
         self._set_uf_title(&quot;Relaxation dispersion parameters&quot;)
-        self._set_uf_table(label=&quot;table: dispersion parameters&quot;, 
caption=&quot;Relaxation dispersion parameters.&quot;)

Modified: trunk/specific_analyses/relax_fit/parameter_object.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/specific_analyses/relax_fit/parameter_object.py?rev=22724&amp;r1=22723&amp;r2=22724&amp;view=diff">http://svn.gna.org/viewcvs/relax/trunk/specific_analyses/relax_fit/parameter_object.py?rev=22724&amp;r1=22723&amp;r2=22724&amp;view=diff</a>
==============================================================================
--- trunk/specific_analyses/relax_fit/parameter_object.py       (original)
+++ trunk/specific_analyses/relax_fit/parameter_object.py       Fri Apr 11 
19:55:58 2014
@@ -57,4 +57,3 @@
 
         # Set up the user function documentation.
         self._set_uf_title(&quot;Relaxation curve fitting parameters&quot;)
-        self._set_uf_table(label=&quot;table: curve-fit parameters&quot;, 
caption=&quot;Relaxation curve fitting parameters.&quot;)



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Fri Apr 11 20:20:01 2014</div>  
</body>
</html>
