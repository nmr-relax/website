<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: r26946 &#45; /branches/nmrglue/test_suite/system_tests/nmrglue.py -->
<!--X-From-R13: "Sqjneq q'Ohiretar" &#60;rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Wed, 03 Dec 2014 22:26:07 +0100 -->
<!--X-Message-Id: CAED9pY_Yx25XxHJjk7E5scxCztr&#45;NcK=C8Mo5&#45;6zSopz6GB&#45;dQ@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: E1XwH2V&#45;0003DA&#45;DE@subversion.gna.org -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: r26946 - /branches/nmrglue/test_suite/system_tests/nmrglue.py -- December 03, 2014 - 22:26</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: r26946 - /branches/nmrglue/test_suite/system_tests/nmrglue.py</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00015" class="tabs">Index by Date</a> | <a href="threads.html#00015" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00014.html">Date Prev</a>] [<a href="msg00016.html">Date Next</a>] [<a href="msg00014.html">Thread Prev</a>] [<a href="msg00016.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Wed, 3 Dec 2014 22:25:37 +0100</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113; h=mime-version:sender:in-reply-to:references:date:message-id:subject :from:to:content-type; bh=TdGyga1N0f4Qm707gSYaOX4hahXCGa56EKAWBrRMWjk=; b=vHpGpYYeQfsKdzL1NY9vqagV/TfdToYuXKA19IAiGsNxcuyZcJqKZHpgrm2N0YEfyM nPFRolXhSC3HRJjVMH6lnyrI29bqfw9FCeKCJs/D+bJT02qVCbKCN9Wfg6Bn7bdsA480 uPuIy229CAAKTPKL7tSgV6Yq5BqBJ6liJwxMMGn4e0BdFXQcmNNAoo9exnxswLxOwKJU vwfBv5kB+PpvgWtk6WVT64V30doGuwZXlRN19sOJxXySCq5xAqfeKtBggNRothr8sJmB 0QBLnynTDhgeRq1CCxVzX45oVHgyukigYcKAeznUINjilSjQuPFvnZYxj+LXobHKja0N TzmA==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;CAED9pY_Yx25XxHJjk7E5scxCztr-NcK=C8Mo5-6zSopz6GB-dQ@mail.gmail.com&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;E1XwH2V-0003DA-DE@subversion.gna.org&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on December 03, 2014 - 22:26:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi Troels,

I really wonder if we can use a matplotlib function like savefig() and
then check the resultant file?  Maybe it could be output as PNG and
the hashlib library used to make an md5sum hash of the resultant file,
and then the test checks the md5sum to be sure the figure was
correctly created.  This would require first looking at the PNG file
to make sure it is what you expect, and then permanently lock in the
behaviour with the hash check (updating the test and md5sum as
required).

Regards,

Edward



On 3 December 2014 at 22:00,  &lt;tlinnet@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Author: tlinnet
Date: Wed Dec  3 22:00:46 2014
New Revision: 26946

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=26946&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=26946&amp;view=rev</a>
Log:
Split the systemtest Nmrglue.xtest_plot_contour_cpmg into a setup, test and 
plot test.

Task #7873 (<a  rel="nofollow" href="https://web.archive.org/web/https://gna.org/task/index.php?7873">https://gna.org/task/index.php?7873</a>): Write wrapper function to 
nmrglue, to read .ft2 files and process them.
Homepage: <a  rel="nofollow" href="http://www.nmrglue.com/">http://www.nmrglue.com/</a>
Link to nmrglue discussion: 
<a  rel="nofollow" href="https://groups.google.com/forum/#!forum/nmrglue-discuss">https://groups.google.com/forum/#!forum/nmrglue-discuss</a>
The code is develop at Github: <a  rel="nofollow" href="https://github.com/jjhelmus/nmrglue/">https://github.com/jjhelmus/nmrglue/</a>
Documentation: <a  rel="nofollow" href="http://nmrglue.readthedocs.org/en/latest/index.html">http://nmrglue.readthedocs.org/en/latest/index.html</a>

Modified:
    branches/nmrglue/test_suite/system_tests/nmrglue.py

Modified: branches/nmrglue/test_suite/system_tests/nmrglue.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/nmrglue/test_suite/system_tests/nmrglue.py?rev=26946&amp;r1=26945&amp;r2=26946&amp;view=diff">http://svn.gna.org/viewcvs/relax/branches/nmrglue/test_suite/system_tests/nmrglue.py?rev=26946&amp;r1=26945&amp;r2=26946&amp;view=diff</a>
==============================================================================
--- branches/nmrglue/test_suite/system_tests/nmrglue.py (original)
+++ branches/nmrglue/test_suite/system_tests/nmrglue.py Wed Dec  3 22:00:46 
2014
@@ -63,6 +63,21 @@
         plt.show()


+    def plot_plot_contour_cpmg(self, show=False):
+        &quot;&quot;&quot;Tetst the plot_contour function in pipe_control.
+        This is from the 
U{tutorial&lt;<a  rel="nofollow" href="http://jjhelmus.github.io/nmrglue/current/examples/plot_2d_spectrum.html">http://jjhelmus.github.io/nmrglue/current/examples/plot_2d_spectrum.html</a>&gt;}.
+
+        The data is from systemtest -s Relax_disp.test_repeat_cpmg
+        U{task #7826&lt;<a  rel="nofollow" href="https://web.archive.org/web/https://gna.org/task/index.php?7826">https://gna.org/task/index.php?7826</a>&gt;}. Write an 
python class for the repeated analysis of dispersion data.
+        &quot;&quot;&quot;
+
+        # Call setup function.
+        self.setup_plot_contour_cpmg(show=False)
+
+        # Now show
+        plt.show()
+
+
     def setUp(self):
         &quot;&quot;&quot;Set up for all the functional tests.&quot;&quot;&quot;

@@ -87,6 +102,33 @@

         # Call the pipe_control function and get the return axis.
         ds.ax = plot_contour(spectrum_id=sp_id, ppm=True, show=show)
+
+
+    def setup_plot_contour_cpmg(self, show=False):
+        &quot;&quot;&quot;Setup the plot_contour function in pipe_control.
+        This is from the 
U{tutorial&lt;<a  rel="nofollow" href="http://jjhelmus.github.io/nmrglue/current/examples/plot_2d_spectrum.html">http://jjhelmus.github.io/nmrglue/current/examples/plot_2d_spectrum.html</a>&gt;}.
+
+        The data is from systemtest -s Relax_disp.test_repeat_cpmg
+        U{task #7826&lt;<a  rel="nofollow" href="https://web.archive.org/web/https://gna.org/task/index.php?7826">https://gna.org/task/index.php?7826</a>&gt;}. Write an 
python class for the repeated analysis of dispersion data.
+        &quot;&quot;&quot;
+
+        # Define base path to files.
+        base_path = status.install_path + 
sep+'test_suite'+sep+'shared_data'+sep+'dispersion'+sep+'repeated_analysis'+sep+'SOD1'
+
+        # Define folder to all ft files.
+        ft2_folder_1 = base_path +sep+ 'cpmg_disp_sod1d90a_060518' +sep+ 
'cpmg_disp_sod1d90a_060518_normal.fid' +sep+ 'ft2_data'
+        ft2_folder_2 = base_path +sep+ 'cpmg_disp_sod1d90a_060521' +sep+ 
'cpmg_disp_sod1d90a_060521_normal.fid' +sep+ 'ft2_data'
+
+        # Read the spectrum.
+        fname = '128_0_FT.ft2'
+        sp_id = file_root(fname)
+        self.interpreter.spectrum.nmrglue_read(file=fname, 
dir=ft2_folder_1, spectrum_id=sp_id)
+
+        # Call the pipe_control function and get the return axis.
+        ds.ax = plot_contour(spectrum_id=sp_id, contour_start=200000., 
contour_num=20, contour_factor=1.20, ppm=True, show=show)
+
+        # Set a new title.
+        ds.ax.set_title(&quot;CPMG Spectrum&quot;)


     def test_nmrglue_read(self):
@@ -161,6 +203,18 @@
         self.setup_plot_contour(show=False)


+    def test_plot_contour_cpmg(self, show=False):
+        &quot;&quot;&quot;Tetst the plot_contour function in pipe_control.
+        This is from the 
U{tutorial&lt;<a  rel="nofollow" href="http://jjhelmus.github.io/nmrglue/current/examples/plot_2d_spectrum.html">http://jjhelmus.github.io/nmrglue/current/examples/plot_2d_spectrum.html</a>&gt;}.
+
+        The data is from systemtest -s Relax_disp.test_repeat_cpmg
+        U{task #7826&lt;<a  rel="nofollow" href="https://web.archive.org/web/https://gna.org/task/index.php?7826">https://gna.org/task/index.php?7826</a>&gt;}. Write an 
python class for the repeated analysis of dispersion data.
+        &quot;&quot;&quot;
+
+        # Call setup function.
+        self.setup_plot_contour_cpmg(show=False)
+
+
     def test_version(self):
         &quot;&quot;&quot;Test version of nmrglue.&quot;&quot;&quot;

@@ -170,37 +224,6 @@

         # Assert the version to be 0.4.
         self.assertEqual(ng_vers, '0.4')
-
-
-    def xtest_plot_contour_cpmg(self):
-        &quot;&quot;&quot;Test the plot_contour function in pipe_control.
-        This is from the 
U{tutorial&lt;<a  rel="nofollow" href="http://jjhelmus.github.io/nmrglue/current/examples/plot_2d_spectrum.html">http://jjhelmus.github.io/nmrglue/current/examples/plot_2d_spectrum.html</a>&gt;}.
-
-        The data is from systemtest -s Relax_disp.test_repeat_cpmg
-        U{task #7826&lt;<a  rel="nofollow" href="https://web.archive.org/web/https://gna.org/task/index.php?7826">https://gna.org/task/index.php?7826</a>&gt;}. Write an 
python class for the repeated analysis of dispersion data.
-        &quot;&quot;&quot;
-
-        # Define base path to files.
-        base_path = status.install_path + 
sep+'test_suite'+sep+'shared_data'+sep+'dispersion'+sep+'repeated_analysis'+sep+'SOD1'
-
-        # Define folder to all ft files.
-        ft2_folder_1 = base_path +sep+ 'cpmg_disp_sod1d90a_060518' +sep+ 
'cpmg_disp_sod1d90a_060518_normal.fid' +sep+ 'ft2_data'
-        ft2_folder_2 = base_path +sep+ 'cpmg_disp_sod1d90a_060521' +sep+ 
'cpmg_disp_sod1d90a_060521_normal.fid' +sep+ 'ft2_data'
-
-        # Read the spectrum.
-        fname = '128_0_FT.ft2'
-        sp_id = file_root(fname)
-        self.interpreter.spectrum.nmrglue_read(file=fname, 
dir=ft2_folder_1, spectrum_id=sp_id)
-
-        # Call the pipe_control function and get the return axis.
-        ax = plot_contour(spectrum_id=sp_id, contour_start=200000., 
contour_num=20, contour_factor=1.20, ppm=True, show=False)
-
-        # Set a new title.
-        ax.set_title(&quot;CPMG Spectrum&quot;)
-
-        # Now show
-        import matplotlib.pyplot as plt
-        plt.show()


     def xtest_plot_hist_cpmg(self):


_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-commits mailing list
relax-commits@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-commits">https://mail.gna.org/listinfo/relax-commits</a>
</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu Dec 04 09:40:08 2014</div>  
</body>
</html>
