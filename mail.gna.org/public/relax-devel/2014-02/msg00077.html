<!-- MHonArc v2.6.16 -->
<!--X-Subject: Fwd: r22184 &#45; in /trunk: prompt/interpreter.py relax.py -->
<!--X-From-R13: Febryf Szgrxæe Zvaarg <gyvaargNaze&#45;erynk.pbz> -->
<!--X-Date: Fri, 14 Feb 2014 11:25:49 +0100 -->
<!--X-Message-Id: CA+CBx2NjidRgN7bUYtRcciwvAKDKpqCGWaKEKRB3ar72xb76zw@mail.gmail.com -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: E1WEFv8&#45;0008LV&#45;FE@subversion.gna.org -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Fwd: r22184 - in /trunk: prompt/interpreter.py relax.py -- February 14, 2014 - 11:25</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Fwd: r22184 - in /trunk: prompt/interpreter.py relax.py</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00077" class="tabs">Index by Date</a> | <a href="threads.html#00077" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00076.html">Date Prev</a>] [<a href="msg00078.html">Date Next</a>] [<a href="msg00076.html">Thread Prev</a>] [<a href="msg00080.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;,	&quot;Edward d'Auvergne&quot; &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Fri, 14 Feb 2014 11:24:55 +0100</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113;	h=mime-version:sender:in-reply-to:references:from:date:message-id	:subject:to:content-type;	bh=RWbIVTKJJHA30LCKbW/8Gl0j3k1MQfWGirZxmjiOvOA=;	b=odVOmxt6WwydthitBF5KM1+JeGUn+6ClUG5TlQeXT9V382KHdNs+W/jQ6IDzrUNXiW	KU1sFK+xEovo6Mj/AmyEu0nRENrMfDxgygySkcifKMATaVcokVz3iBeD9b6jFEMnHZXd	BHjusE+GYVUHgSI5I4DRI9YS/SLHruPk92dEB4YvJ/AwjRBpZE6a1XkkKaFFm9c5/HVt	rvPzCpFbf0CzCRDAZkBGn+tpPjUgia3rYgcm7MOZPAQe+T6XafAThE5wbJQXQ8diY6ut	MS9LW1sibS2nm5bqyJDnA1jhys1hIuf24ExRdAfHqCpNL6HdVE33b897zdM5gKpzMZMi	zIhQ==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00077.html">CA+CBx2NjidRgN7bUYtRcciwvAKDKpqCGWaKEKRB3ar72xb76zw@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;E1WEFv8-0008LV-FE@xxxxxxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Troels Emtekær Linnet</strong> on February 14, 2014 - 11:25:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<div dir="ltr">Hi Edward.<br><div><br></div><div>I did a huge error in the commit process.<br></div><div>How do I roll back two commits?<br><br></div><div>Sorry!<br></div><div><br>Best<br>Troels<br></div><div><div><br><div class="gmail_quote">

---------- Forwarded message ----------<br>From: <b class="gmail_sendername"></b> <span dir="ltr">&lt;<a rel="nofollow" href="mailto:tlinnet@xxxxxxxxxxxxx">tlinnet@xxxxxxxxxxxxx</a>&gt;</span><br>Date: 2014-02-14 11:22 GMT+01:00<br>Subject: r22184 - in /trunk: prompt/interpreter.py relax.py<br>

To: <a rel="nofollow" href="mailto:relax-commits@xxxxxxx">relax-commits@xxxxxxx</a><br><br><br>Author: tlinnet<br>
Date: Fri Feb 14 11:22:57 2014<br>
New Revision: 22184<br>
<br>
URL: <a rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=22184&amp;view=rev" target="_blank">http://svn.gna.org/viewcvs/relax?rev=22184&amp;view=rev</a><br>
Log:<br>
Modified the help text to explain that -p will launch relax in prompt mode after running any optionally supplied scripts.<br>
<br>
Fix for sr #3117, (<a rel="nofollow" href="https://gna.org/support/?3117" target="_blank">https://gna.org/support/?3117</a>) - Functionality to inspect interactively after running script - The equivalence to python -i<br>
<br>
This is to allow the -p --prompt option to be given without a script. relax should support this so that a user doesn&#39;t get too confused when<br>
trying to start in prompt mode with the --prompt flag and support the --prompt argument without a script being supplied.<br>
<br>
Modified:<br>
    trunk/prompt/interpreter.py<br>
    trunk/relax.py<br>
<br>
Modified: trunk/prompt/interpreter.py<br>
URL: <a rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/prompt/interpreter.py?rev=22184&amp;r1=22183&amp;r2=22184&amp;view=diff" target="_blank">http://svn.gna.org/viewcvs/relax/trunk/prompt/interpreter.py?rev=22184&amp;r1=22183&amp;r2=22184&amp;view=diff</a><br>


==============================================================================<br>
--- trunk/prompt/interpreter.py (original)<br>
+++ trunk/prompt/interpreter.py Fri Feb 14 11:22:57 2014<br>
@@ -336,14 +336,18 @@<br>
         # Reverse the system path so that the script path is first.<br>
         sys.path.reverse()<br>
<br>
-        # Execute the script as a module.<br>
-        #if dep_check.runpy_module:<br>
-        #    runpy.run_module(module, globals)<br>
+        # Execute the script as a module if the inspect interactively prompt flag is not true.<br>
+        if dep_check.runpy_module and not status.prompt:<br>
+            runpy.run_module(module, globals)<br>
+<br>
+        # Execute the script as a module if the inspect interactively prompt flag is not true.<br>
+        elif dep_check.runpy_module and not status.prompt:<br>
+            runpy.run_module(module, globals)<br>
<br>
         # Allow scripts to run under Python &lt;= 2.4.<br>
-        #else:<br>
-        #    exec(compile(open(name).read(), name, &#39;exec&#39;), globals)<br>
-        exec(compile(open(name).read(), name, &#39;exec&#39;), globals)<br>
+        else:<br>
+            exec(compile(open(name).read(), name, &#39;exec&#39;), globals)<br>
+<br>
<br>
     finally:<br>
         # Switch back to the original working directory.<br>
<br>
Modified: trunk/relax.py<br>
URL: <a rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/relax.py?rev=22184&amp;r1=22183&amp;r2=22184&amp;view=diff" target="_blank">http://svn.gna.org/viewcvs/relax/trunk/relax.py?rev=22184&amp;r1=22183&amp;r2=22184&amp;view=diff</a><br>


==============================================================================<br>
--- trunk/relax.py (original)<br>
+++ trunk/relax.py Fri Feb 14 11:22:57 2014<br>
@@ -215,7 +215,7 @@<br>
             # Only import the module in the test modes (to improve program start up speeds).<br>
             from test_suite.test_suite_runner import Test_suite_runner<br>
<br>
-            # Load the interpreter and turn intros on.<br>
+            # Load the interpreter and turn intros on.launch relax in prompt mode after running any optionally supplied scripts<br>
             self.interpreter = interpreter.Interpreter(show_script=False, raise_relax_error=True)<br>
             self.interpreter.on()<br>
<br>
@@ -280,7 +280,7 @@<br>
         parser.add_option(&#39;-t&#39;, &#39;--tee&#39;, action="" type=&#39;string&#39;, dest=&#39;tee&#39;, help=&#39;tee relax output to stdout and the file LOG_FILE&#39;, metavar=&#39;LOG_FILE&#39;)<br>


         parser.add_option(&#39;-g&#39;, &#39;--gui&#39;, action="" dest=&#39;gui&#39;, default=0, help=&#39;launch the relax GUI&#39;)<br>
         parser.add_option(&#39;-e&#39;, &#39;--escalate&#39;, action="" dest=&#39;escalate&#39;, default=0, help=&#39;escalate all warnings to errors&#39;)<br>
-        parser.add_option(&#39;-p&#39;, &#39;--prompt&#39;, action="" dest=&#39;prompt&#39;, default=0, help=&#39;execute the given script and continue into the prompt mode to allow for interactive inspection&#39;)<br>


+        parser.add_option(&#39;-p&#39;, &#39;--prompt&#39;, action="" dest=&#39;prompt&#39;, default=0, help=&#39;launch relax in prompt mode after running any optionally supplied scripts&#39;)<br>
         parser.add_option(&#39;--test&#39;, action="" dest=&#39;test&#39;, default=0, help=&#39;run relax in test mode&#39;)<br>
         parser.add_option(&#39;-x&#39;, &#39;--test-suite&#39;, action="" dest=&#39;test_suite&#39;, default=0, help=&#39;execute the relax test suite&#39;)<br>
         parser.add_option(&#39;-s&#39;, &#39;--system-tests&#39;, action="" dest=&#39;system_tests&#39;, default=0, help=&#39;execute the relax system/functional tests (part of the test suite)&#39;)<br>


<br>
<br>
_______________________________________________<br>
relax (<a rel="nofollow" href="http://www.nmr-relax.com" target="_blank">http://www.nmr-relax.com</a>)<br>
<br>
This is the relax-commits mailing list<br>
<a rel="nofollow" href="mailto:relax-commits@xxxxxxx">relax-commits@xxxxxxx</a><br>
<br>
To unsubscribe from this list, get a password<br>
reminder, or change your subscription options,<br>
visit the list information page at<br>
<a rel="nofollow" href="https://mail.gna.org/listinfo/relax-commits" target="_blank">https://mail.gna.org/listinfo/relax-commits</a><br>
</div><br></div></div></div>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00080" href="msg00080.html">Re: r22184 - in /trunk: prompt/interpreter.py relax.py</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Fri Feb 14 11:40:19 2014</div>  
</body>
</html>
