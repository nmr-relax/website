<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: numerical cpmg fit -->
<!--X-From-R13: Bnhy Epunaqn <cnhy.fpunaqnNtzk.ng> -->
<!--X-Date: Fri, 12 Jul 2013 07:51:48 +0200 -->
<!--X-Message-Id: A1B15ABA&#45;695A&#45;4B49&#45;9855&#45;6EFFE3318C72@gmx.at -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: 35036407&#45;39A6&#45;4B59&#45;B529&#45;7074D5F10DBA@gmx.at -->
<!--X-Reference: CAED9pY_zKf+1kML6UNezswM1NQtvZh7n7Jdz_Ss1H5Kn2cj5kw@mail.gmail.com -->
<!--X-Reference: CAED9pY9HUHQ1X6zQpY8CmPR3NFoSXJwgeP02Nme1Y447&#45;6U9RQ@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: numerical cpmg fit -- July 12, 2013 - 07:51</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: numerical cpmg fit</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00013" class="tabs">Index by Date</a> | <a href="threads.html#00013" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00012.html">Date Prev</a>] [<a href="msg00014.html">Date Next</a>] [<a href="msg00012.html">Thread Prev</a>] [<a href="msg00014.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Fri, 12 Jul 2013 07:51:13 +0200</li>
<li class="menuitem">
<em>Cc</em>: mathilde lescanne &lt;mathilde.lescanne@xxxxxxxxx&gt;,	&quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00013.html">A1B15ABA-695A-4B49-9855-6EFFE3318C72@gmx.at</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;35036407-39A6-4B59-B529-7074D5F10DBA@xxxxxx&gt;	&lt;CAED9pY_zKf+1kML6UNezswM1NQtvZh7n7Jdz_Ss1H5Kn2cj5kw@xxxxxxxxxxxxxx&gt;	&lt;CAED9pY9HUHQ1X6zQpY8CmPR3NFoSXJwgeP02Nme1Y447-6U9RQ@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Paul Schanda</strong> on July 12, 2013 - 07:51:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<table width="100%"><tr><td style="">Hi Edward,<div><br></div><div>Yes, R2E and R2G are the exchange-free R2 values. Sometimes also referred to as R20 or R2infinity. They are the Redfield-relaxation part.</div><div>Currently, the functions do not use populations (pA, pB) but they use the two exchange rates (forward, backward), rather than one rate constant and one population. The two different approaches are in essence the same, as populations can be calculated from forward/backward rates in a straightforward manner.</div><div>We can easily change this if it is more in the logic of the existing code.&nbsp;<br><div><div><br></div><div>paul</div><div><br></div><div><br></div><blockquote type="cite">Hello,<br><br>Another question I have is what are the parameters of this model? &nbsp;It<br>relates to the function arguments currently labelled as unknown in the<br>function docstring. &nbsp;I would like to implement step 2 of the tutorial<br>on adding relaxation dispersion models to relax (the<br>relax_disp.select_model user function front end, see<br><a rel="nofollow" href="http://article.gmane.org/gmane.science.nmr.relax.devel/3907">http://article.gmane.org/gmane.science.nmr.relax.devel/3907</a>), but I'm<br>not sure how to list the parameters of the model for the user. &nbsp;Is<br>there a population parameter (pA or pB)? &nbsp;Are R2E and R2G the same as<br>the R20A and R20B rates (the R2 rates in the absence of exchange for<br>states A and B for a fixed magnetic field strength)?<br><br>Cheers,<br><br>Edward<br><br><br>On 11 July 2013 16:14, Edward d'Auvergne &lt;<a rel="nofollow" href="mailto:edward@xxxxxxxxxxxxx">edward@xxxxxxxxxxxxx</a>&gt; wrote:<br><blockquote type="cite">Hi Paul,<br><br>I have now incorporated this code into relax (see<br><a rel="nofollow" href="http://article.gmane.org/gmane.science.nmr.relax.scm/18025">http://article.gmane.org/gmane.science.nmr.relax.scm/18025</a>). &nbsp;Could<br>you please check the code, comments, and docstrings carefully and see<br>if there are any issues? &nbsp;Could you also tell me if anyone else should<br>be included in the copyright notice? &nbsp;It would be useful to replace<br>the 'Unknown' elements in the function docstring with basic<br>descriptions of the parameter and its Python object type. &nbsp;And any<br>suggestions for comments describing in basic NMR terms what the code<br>is doing (the physics of the propagations, for example) would also be<br>appreciated.<br><br>You can get the new code by typing the following in the base directory<br>of the checked out copy of the relax_disp branch:<br><br>$ svn up<br><br>There was an indentation problem that I have tried to solve. &nbsp;Also I<br>cannot determine where the mpower() function comes from - it appears<br>not to be part of numpy or scipy. &nbsp;Is this an outside function you<br>wrote? &nbsp;I have also made a number of significant speed ups of the code<br>(see <a rel="nofollow" href="http://article.gmane.org/gmane.science.nmr.relax.scm/18029">article.gmane.org/gmane.science.nmr.relax.scm/18029</a>). &nbsp;Note that<br>this cannot be selected as a model in the dispersion analysis yet.<br><br>Cheers,<br><br>Edward<br><br><br><br><br>On 11 July 2013 13:47, Paul Schanda &lt;<a rel="nofollow" href="mailto:paul.schanda@xxxxxx">paul.schanda@xxxxxx</a>&gt; wrote:<br><blockquote type="cite"><br>Hi Edward,<br><br>Here is a function that does a numerical fit of CPMG. It uses an explicit matrix that contains relaxation, exchange and chemical shift terms. It does the 180deg pulses in the CPMG train with conjugate complex matrices.<br>It returns calculated R2eff values, so it can be used for numerical fitting of CPMG.<br>It is an addition to the functions that I previously sent to you.<br>The approach of Bloch-McConnell can be found in chapter 3.1 of Palmer, A. G. Chem Rev 2004, 104, 3623â€“3640.<br>I wrote this function (initially in MATLAB) in 2010.<br>I agree that this code is released under the GPL3 or higher licence.<br><br>Paul<br><br><br>def func1(R2E,R2G,fg,kge,keg, cpmgfreq,tcpmg):<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kex=kge+keg<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rcalc_array=np.zeros(len(cpmgfreq))<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rr &nbsp;= -1.*np.matrix([[R2G, 0.],[0., R2E]])<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rex = -1.*np.matrix([[kge,-keg],[-kge, keg]])<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RCS = complex(0.,-1.)*np.matrix([[0. ,0.],[0.,fg]])<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R = Rr + Rex + RCS<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cR = np.conj(R)<br><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IGeq=keg/kex; IEeq=kge/kex<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M0=np.matrix([[IGeq],[IEeq]])<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for k in range(len(cpmgfreq)):<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tcp=1./(4.*cpmgfreq[k])<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prop_2 =np.dot(np.dot(sci.expm(R*tcp),sci.expm(cR*2.*tcp)),sci.expm(R*tcp))<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prop_total =mpower(prop_2,cpmgfreq[k]*tcpmg)<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Moft = prop_total*M0<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mgx=Moft[0].real/M0[0]<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rcalc=-(1./tcpmg)*math.log(Mgx);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rcalc_array[k]=Rcalc<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return Rcalc_array<br><br><br><br><br>_______________________________________________<br>relax (<a rel="nofollow" href="/">http://www.nmr-relax.com</a>)<br><br>This is the relax-devel mailing list<br><a rel="nofollow" href="mailto:relax-devel@xxxxxxx">relax-devel@xxxxxxx</a><br><br>To unsubscribe from this list, get a password<br>reminder, or change your subscription options,<br>visit the list information page at<br>https://mail.gna.org/listinfo/relax-devel<br></blockquote></blockquote></blockquote></div><br><div apple-content-edited="true">
<span class="Apple-style-span" style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: -webkit-auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; -webkit-text-decorations-in-effect: none; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; font-size: medium; "><span class="Apple-style-span" style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: -webkit-auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; -webkit-text-decorations-in-effect: none; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; font-size: medium; "><span class="Apple-style-span" style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: -webkit-auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; -webkit-text-decorations-in-effect: none; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; font-size: medium; "><div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; "><div><br class="Apple-interchange-newline"><br></div><div>***************************</div><div><br></div><div>Paul Schanda</div><div><a rel="nofollow" href="mailto:paul.schanda@xxxxxx">paul.schanda@xxxxxx</a></div><div><br></div></div></span><br class="Apple-interchange-newline"></span><br class="Apple-interchange-newline"></span>
</div>
<br></div></td></tr></table>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00014" href="msg00014.html">Re: numerical cpmg fit</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00010" href="msg00010.html">numerical cpmg fit</a></strong>
<ul><li><em>From:</em> Paul Schanda</li></ul></li>
<li><strong><a name="00011" href="msg00011.html">Re: numerical cpmg fit</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00012" href="msg00012.html">Re: numerical cpmg fit</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Fri Jul 12 10:00:08 2013</div>  
</body>
</html>
