<!-- MHonArc v2.6.16 -->
<!--X-Subject: r21458 &#45; in /branches/relax_disp/test_suite/system_tests:	relax_disp.py scripts/relax_disp/r1rho_off_res_tp02.py -->
<!--X-From-R13: rqjneqNaze&#45;erynk.pbz -->
<!--X-Date: Sat, 16 Nov 2013 17:12:30 +0100 -->
<!--X-Message-Id: E1VhiU2&#45;0005j2&#45;91@subversion.gna.org -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>r21458 - in /branches/relax_disp/test_suite/system_tests:	relax_disp.py scripts/relax_disp/r1rho_off_res_tp02.py -- November 16, 2013 - 17:12</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />r21458 - in /branches/relax_disp/test_suite/system_tests:	relax_disp.py scripts/relax_disp/r1rho_off_res_tp02.py</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00116" class="tabs">Index by Date</a> | <a href="threads.html#00116" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00115.html">Date Prev</a>] [<a href="msg00117.html">Date Next</a>] [<a href="msg00115.html">Thread Prev</a>] [<a href="msg00117.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: relax-commits@xxxxxxx</li>
<li class="menuitem">
<em>Date</em>: Sat, 16 Nov 2013 16:12:30 -0000</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00116.html">E1VhiU2-0005j2-91@subversion.gna.org</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>edward</strong> on November 16, 2013 - 17:12:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Author: bugman
Date: Sat Nov 16 17:12:29 2013
New Revision: 21458

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=21458&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=21458&amp;view=rev</a>
Log:
Created the Relax_disp.test_tp02_data_to_mp05 system test.

This was copied from the Relax_disp.test_tp02_data_to_tp02 system test.  The 
r1rho_off_res_tp02.py
system test script was modified to handle both tests by allowing the list of 
models to optimise to
be set via the ds.models variable.

This follows the tutorial for adding relaxation dispersion models at:
<a  rel="nofollow" href="http://wiki.nmr-relax.com/Tutorial_for_adding_relaxation_dispersion_models_to_relax#The_test_suite">http://wiki.nmr-relax.com/Tutorial_for_adding_relaxation_dispersion_models_to_relax#The_test_suite</a>

Modified:
    branches/relax_disp/test_suite/system_tests/relax_disp.py
    
branches/relax_disp/test_suite/system_tests/scripts/relax_disp/r1rho_off_res_tp02.py

Modified: branches/relax_disp/test_suite/system_tests/relax_disp.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/relax_disp/test_suite/system_tests/relax_disp.py?rev=21458&amp;r1=21457&amp;r2=21458&amp;view=diff">http://svn.gna.org/viewcvs/relax/branches/relax_disp/test_suite/system_tests/relax_disp.py?rev=21458&amp;r1=21457&amp;r2=21458&amp;view=diff</a>
==============================================================================
--- branches/relax_disp/test_suite/system_tests/relax_disp.py (original)
+++ branches/relax_disp/test_suite/system_tests/relax_disp.py Sat Nov 16 
17:12:29 2013
@@ -2146,6 +2146,39 @@
         self.assertAlmostEqual(spin2.chi2, 0.000133191682505916, 4)
 
 
+    def test_tp02_data_to_mp05(self):
+        &quot;&quot;&quot;Test the dispersion 'MP05' model fitting against the 'TP02' test 
data.&quot;&quot;&quot;
+
+        # Fixed time variable and the models.
+        ds.fixed = True
+        ds.models = ['R2eff', 'MP05']
+
+        # Execute the script.
+        self.interpreter.run(script_file=status.install_path + 
sep+'test_suite'+sep+'system_tests'+sep+'scripts'+sep+'relax_disp'+sep+'r1rho_off_res_tp02.py')
+
+        # The original parameters.
+        r1rho_prime = [[10.0, 15.0], [12.0, 18.0]]
+        pA = 0.7654321
+        kex = 1234.56789
+        delta_omega = [7.0, 9.0]
+
+        # Switch to the 'MP05' model data pipe, then check for each spin.
+        self.interpreter.pipe.switch('MP05')
+        spin_index = 0
+        for spin, spin_id in spin_loop(return_id=True):
+            # Printout.
+            print(&quot;\nSpin %s.&quot; % spin_id)
+
+            # Check the fitted parameters.
+            self.assertAlmostEqual(spin.r2[0]/10, 
r1rho_prime[spin_index][0]/10, 4)
+            self.assertAlmostEqual(spin.r2[1]/10, 
r1rho_prime[spin_index][1]/10, 4)
+            self.assertAlmostEqual(spin.dw, delta_omega[spin_index], 3)
+            self.assertAlmostEqual(spin.kex/1000.0, kex/1000.0, 3)
+
+            # Increment the spin index.
+            spin_index += 1
+
+
     def test_tp02_data_to_tp02(self):
         &quot;&quot;&quot;Test the relaxation dispersion 'TP02' model curve fitting to 
fixed time synthetic data.&quot;&quot;&quot;
 

Modified: 
branches/relax_disp/test_suite/system_tests/scripts/relax_disp/r1rho_off_res_tp02.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/relax_disp/test_suite/system_tests/scripts/relax_disp/r1rho_off_res_tp02.py?rev=21458&amp;r1=21457&amp;r2=21458&amp;view=diff">http://svn.gna.org/viewcvs/relax/branches/relax_disp/test_suite/system_tests/scripts/relax_disp/r1rho_off_res_tp02.py?rev=21458&amp;r1=21457&amp;r2=21458&amp;view=diff</a>
==============================================================================
--- 
branches/relax_disp/test_suite/system_tests/scripts/relax_disp/r1rho_off_res_tp02.py
 (original)
+++ 
branches/relax_disp/test_suite/system_tests/scripts/relax_disp/r1rho_off_res_tp02.py
 Sat Nov 16 17:12:29 2013
@@ -14,7 +14,8 @@
 #####################
 
 # The dispersion models.
-MODELS = ['R2eff', 'TP02']
+if not hasattr(ds, 'models'):
+    ds.models = ['R2eff', 'TP02']
 
 # The grid search size (the number of increments per dimension).
 GRID_INC = 4
@@ -112,7 +113,7 @@
 Relax_disp.opt_max_iterations = 10000
 
 # Do not change!
-Relax_disp(pipe_name=pipe_name, pipe_bundle=pipe_bundle, 
results_dir=ds.tmpdir, models=MODELS, grid_inc=GRID_INC, mc_sim_num=MC_NUM)
+Relax_disp(pipe_name=pipe_name, pipe_bundle=pipe_bundle, 
results_dir=ds.tmpdir, models=ds.models, grid_inc=GRID_INC, mc_sim_num=MC_NUM)
 
 # Save the program state.
 state.save('devnull', force=True)



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Sat Nov 16 17:20:02 2013</div>  
</body>
</html>
