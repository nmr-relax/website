<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: r26260 &#45; /trunk/test_suite/system_tests/relax_disp.py -->
<!--X-From-R13: "Sqjneq q'Ohiretar" &#60;rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Mon, 13 Oct 2014 18:35:54 +0200 -->
<!--X-Message-Id: CAED9pY_AYX2M9NTaocijKu=R=OUFxc1OvgaD1LBosW4rV3mwQA@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: E1XdhOn&#45;0002A9&#45;KN@subversion.gna.org -->
<!--X-Reference: CAED9pY&#45;HNXMHUA4M8T=KGcEYU=qHs1Nwr56B9J+R6U&#45;+EUMsww@mail.gmail.com -->
<!--X-Reference: CA+CBx2NYpsWfnY1x2&#45;rOXJMWQoEvvWFg1BYFwqDFUX=aPBDcOw@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: r26260 - /trunk/test_suite/system_tests/relax_disp.py -- October 13, 2014 - 18:35</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: r26260 - /trunk/test_suite/system_tests/relax_disp.py</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00086" class="tabs">Index by Date</a> | <a href="threads.html#00086" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00085.html">Date Prev</a>] [<a href="msg00087.html">Date Next</a>] [<a href="msg00084.html">Thread Prev</a>] [<a href="msg00085.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Mon, 13 Oct 2014 18:35:24 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113; h=mime-version:sender:in-reply-to:references:date:message-id:subject :from:to:cc:content-type:content-transfer-encoding; bh=SXOGcNH+xmXusb+7CnUxaS+XDOk+VQ6/smLHZDXKrRM=; b=uiOwHOtcEjCCQ8mLNMs6apw8gDuvPpaKXvW0sQbxsvu1koHwSuqDLuHApjz12i19ox ODeTErynte9If7/8tPcDIQ6ZQLYTJXVMkzXI1FGcygli4RL3mIueiYWPSu/B4keyqXWK R7Zei1I0pmxawrHYmXG9d3zuHYtacbc0Q115F9331ULzrAfeOfSrqmzu3GKYiJ3XV3rQ +P2DrnqF9oDu4wjbwyBuSPhf46eZbmoQSw+wyh69wEjp493YJQW8zHIj14ZpUtstaZh2 SN/LG/X8novdSvYVWKCxhOUF97vQNqLhjfNhqT9ZxcZkU12Q1UI2NwnnTyxUi0itwCok 1TyA==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;CAED9pY_AYX2M9NTaocijKu=R=OUFxc1OvgaD1LBosW4rV3mwQA@mail.gmail.com&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;E1XdhOn-0002A9-KN@subversion.gna.org&gt; &lt;CAED9pY-HNXMHUA4M8T=KGcEYU=qHs1Nwr56B9J+R6U-+EUMsww@mail.gmail.com&gt; &lt;CA+CBx2NYpsWfnY1x2-rOXJMWQoEvvWFg1BYFwqDFUX=aPBDcOw@mail.gmail.com&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on October 13, 2014 - 18:35:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi,

That was not the implementation I suggested.  Note the differences
between the two:

    self.assertRaises(RelaxError,
self.interpreter.minimise.grid_search(inc=GRID_INC) )
    self.assertRaises(RelaxError,
self.interpreter.minimise.grid_search, inc=GRID_INC)

Regards,

Edward



On 13 October 2014 18:18, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Edward.

If I convert to:
self.assertRaises(RelaxError,
self.interpreter.minimise.grid_search(inc=GRID_INC) )

I get:

R1rho at 900.2 MHz, for offset=141.010 ppm and dispersion point 1500.0, with
1 time points.
Traceback (most recent call last):
  File
&quot;/sbinlab2/tlinnet/software/NMR-relax/relax_trunk/test_suite/system_tests/relax_disp.py&quot;,
line 1753, in test_bug_atul_srivastava
    self.assertRaises(RelaxError,
self.interpreter.minimise.grid_search(inc=GRID_INC) )
  File
&quot;/sbinlab2/tlinnet/software/NMR-relax/relax_trunk/prompt/uf_objects.py&quot;,
line 226, in __call__
    self._backend(*new_args, **uf_kargs)
  File
&quot;/sbinlab2/tlinnet/software/NMR-relax/relax_trunk/pipe_control/minimise.py&quot;,
line 213, in grid_search
    api.grid_search(lower=model_lower, upper=model_upper, inc=model_inc,
scaling_matrix=scaling_matrix, constraints=constraints, verbosity=verbosity)
  File
&quot;/sbinlab2/tlinnet/software/NMR-relax/relax_trunk/specific_analyses/relax_disp/api.py&quot;,
line 622, in grid_search
    self.minimise(min_algor='grid', lower=lower, upper=upper, inc=inc,
scaling_matrix=scaling_matrix, constraints=constraints, verbosity=verbosity,
sim_index=sim_index)
  File
&quot;/sbinlab2/tlinnet/software/NMR-relax/relax_trunk/specific_analyses/relax_disp/api.py&quot;,
line 813, in minimise
    minimise_r2eff(spins=spins, spin_ids=spin_ids, min_algor=min_algor,
min_options=min_options, func_tol=func_tol, grad_tol=grad_tol,
max_iterations=max_iterations, constraints=constraints,
scaling_matrix=scaling_matrix[model_index], verbosity=verbosity,
sim_index=sim_index, lower=lower_i, upper=upper_i, inc=inc_i)
  File
&quot;/sbinlab2/tlinnet/software/NMR-relax/relax_trunk/specific_analyses/relax_disp/optimisation.py&quot;,
line 402, in minimise_r2eff
    raise RelaxError(&quot;The data setup points to exponential curve fitting,
but only %i time points was found, where 3 time points is minimum.  If
calculating R2eff values for fixed relaxation time period data, check that a
reference intensity has been specified for each offset value.&quot;%(len(times)))
RelaxError: RelaxError: The data setup points to exponential curve fitting,
but only 1 time points was found, where 3 time points is minimum.  If
calculating R2eff values for fixed relaxation time period data, check that a
reference intensity has been specified for each offset value.


So, I guess this does not work.

best
Troels

2014-10-13 17:47 GMT+02:00 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">

Hi Troels,

We shouldn't skip tests due to different versions of mandatory
dependencies - in this case Python.  This test skipping infrastructure
is only for skipping tests for the optional Python packages and
external software.  I've been trying to work out why the 'with'
statements have been used.  For example one case is:

                with self.assertRaises(RelaxError):
                    self.interpreter.minimise.grid_search(inc=GRID_INC)

Is there a reason why this does not use the standard notation of:

                self.assertRaises(RelaxError,
self.interpreter.minimise.grid_search, inc=GRID_INC)

This is used everywhere else:

$ grep self.assertRaises -r test_suite

If there is no specific reason, then the 3 instances can be converted
to the standard notation and then the test would work on earlier
Python versions.

Cheers,

Edward









On 13 October 2014 17:19,  &lt;tlinnet@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Author: tlinnet
Date: Mon Oct 13 17:19:00 2014
New Revision: 26260

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=26260&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=26260&amp;view=rev</a>
Log:
Fix for testing the raise of expected errors in systemtests.

The systemtest will not be tested, if python version is under version
2.7.

Bug #22801 (<a  rel="nofollow" href="https://web.archive.org/web/https://gna.org/bugs/?22801">https://gna.org/bugs/?22801</a>): Failure of the relax test
suite on Python 2.5.

Modified:
    trunk/test_suite/system_tests/relax_disp.py

Modified: trunk/test_suite/system_tests/relax_disp.py
URL:
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/test_suite/system_tests/relax_disp.py?rev=26260&amp;r1=26259&amp;r2=26260&amp;view=diff">http://svn.gna.org/viewcvs/relax/trunk/test_suite/system_tests/relax_disp.py?rev=26260&amp;r1=26259&amp;r2=26260&amp;view=diff</a>

==============================================================================
--- trunk/test_suite/system_tests/relax_disp.py (original)
+++ trunk/test_suite/system_tests/relax_disp.py Mon Oct 13 17:19:00 2014
@@ -27,6 +27,7 @@
 from minfx.generic import generic_minimise
 from random import gauss
 import re, math
+from sys import version_info
 from tempfile import mkdtemp, NamedTemporaryFile


@@ -140,6 +141,18 @@
             # Store in the status object.
             if methodName in to_skip:
                 status.skipped_tests.append([methodName, 'matplotlib
module', self._skip_type])
+
+        # If not python 2.7, bug #22801 (<a  rel="nofollow" href="https://web.archive.org/web/https://gna.org/bugs/?22801">https://gna.org/bugs/?22801</a>):
Failure of the relax test suite on Python 2.5.
+        # It is not possible to call: with self.assertRaises() before
version 2.7
+        if not version_info &gt;= (2,7):
+            # The list of tests to skip.
+            to_skip = [
+                &quot;test_bug_atul_srivastava&quot;
+            ]
+
+            # Store in the status object.
+            if methodName in to_skip:
+                status.skipped_tests.append([methodName, 'python 2.7',
self._skip_type])


     def setUp(self):


_______________________________________________
relax (<a  rel="nofollow" href="/">http://www.nmr-relax.com</a>)

This is the relax-commits mailing list
relax-commits@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="/mail.gna.org/listinfo/relax-commits">https://mail.gna.org/listinfo/relax-commits</a>
</pre></blockquote><pre style="margin: 0em;">

_______________________________________________
relax (<a  rel="nofollow" href="/">http://www.nmr-relax.com</a>)

This is the relax-devel mailing list
relax-devel@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="/mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a>
</pre></blockquote><pre style="margin: 0em;">


</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00083" href="msg00083.html">Re: r26260 - /trunk/test_suite/system_tests/relax_disp.py</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00084" href="msg00084.html">Re: r26260 - /trunk/test_suite/system_tests/relax_disp.py</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Mon Oct 13 19:00:11 2014</div>  
</body>
</html>
