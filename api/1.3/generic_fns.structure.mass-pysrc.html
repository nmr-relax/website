<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>generic_fns.structure.mass</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
  <!--Google analytics JS-->
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30096326-1']);
    _gaq.push(['_setDomainName', 'nmr-relax.com']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://www.nmr-relax.com">relax</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="generic_fns-module.html">Package&nbsp;generic_fns</a> ::
        <a href="generic_fns.structure-module.html">Package&nbsp;structure</a> ::
        Module&nbsp;mass
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="generic_fns.structure.mass-pysrc.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<h1 class="epydoc">Source Code for <a href="generic_fns.structure.mass-module.html">Module generic_fns.structure.mass</a></h1>
<pre class="py-src">
<a name="L1"></a><tt class="py-lineno">  1</tt>  <tt class="py-line"><tt class="py-comment">###############################################################################</tt> </tt>
<a name="L2"></a><tt class="py-lineno">  2</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L3"></a><tt class="py-lineno">  3</tt>  <tt class="py-line"><tt class="py-comment"># Copyright (C) 2003-2011 Edward d'Auvergne                                   #</tt> </tt>
<a name="L4"></a><tt class="py-lineno">  4</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L5"></a><tt class="py-lineno">  5</tt>  <tt class="py-line"><tt class="py-comment"># This file is part of the program relax.                                     #</tt> </tt>
<a name="L6"></a><tt class="py-lineno">  6</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L7"></a><tt class="py-lineno">  7</tt>  <tt class="py-line"><tt class="py-comment"># relax is free software; you can redistribute it and/or modify               #</tt> </tt>
<a name="L8"></a><tt class="py-lineno">  8</tt>  <tt class="py-line"><tt class="py-comment"># it under the terms of the GNU General Public License as published by        #</tt> </tt>
<a name="L9"></a><tt class="py-lineno">  9</tt>  <tt class="py-line"><tt class="py-comment"># the Free Software Foundation; either version 2 of the License, or           #</tt> </tt>
<a name="L10"></a><tt class="py-lineno"> 10</tt>  <tt class="py-line"><tt class="py-comment"># (at your option) any later version.                                         #</tt> </tt>
<a name="L11"></a><tt class="py-lineno"> 11</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L12"></a><tt class="py-lineno"> 12</tt>  <tt class="py-line"><tt class="py-comment"># relax is distributed in the hope that it will be useful,                    #</tt> </tt>
<a name="L13"></a><tt class="py-lineno"> 13</tt>  <tt class="py-line"><tt class="py-comment"># but WITHOUT ANY WARRANTY; without even the implied warranty of              #</tt> </tt>
<a name="L14"></a><tt class="py-lineno"> 14</tt>  <tt class="py-line"><tt class="py-comment"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the               #</tt> </tt>
<a name="L15"></a><tt class="py-lineno"> 15</tt>  <tt class="py-line"><tt class="py-comment"># GNU General Public License for more details.                                #</tt> </tt>
<a name="L16"></a><tt class="py-lineno"> 16</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L17"></a><tt class="py-lineno"> 17</tt>  <tt class="py-line"><tt class="py-comment"># You should have received a copy of the GNU General Public License           #</tt> </tt>
<a name="L18"></a><tt class="py-lineno"> 18</tt>  <tt class="py-line"><tt class="py-comment"># along with relax; if not, write to the Free Software                        #</tt> </tt>
<a name="L19"></a><tt class="py-lineno"> 19</tt>  <tt class="py-line"><tt class="py-comment"># Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA   #</tt> </tt>
<a name="L20"></a><tt class="py-lineno"> 20</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L21"></a><tt class="py-lineno"> 21</tt>  <tt class="py-line"><tt class="py-comment">###############################################################################</tt> </tt>
<a name="L22"></a><tt class="py-lineno"> 22</tt>  <tt class="py-line"> </tt>
<a name="L23"></a><tt class="py-lineno"> 23</tt>  <tt class="py-line"><tt class="py-comment"># Python module imports.</tt> </tt>
<a name="L24"></a><tt class="py-lineno"> 24</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">numpy</tt> <tt class="py-keyword">import</tt> <tt class="py-name">float64</tt><tt class="py-op">,</tt> <tt class="py-name">zeros</tt> </tt>
<a name="L25"></a><tt class="py-lineno"> 25</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">warnings</tt> <tt class="py-keyword">import</tt> <tt class="py-name">warn</tt> </tt>
<a name="L26"></a><tt class="py-lineno"> 26</tt>  <tt class="py-line"> </tt>
<a name="L27"></a><tt class="py-lineno"> 27</tt>  <tt class="py-line"><tt class="py-comment"># relax module imports.</tt> </tt>
<a name="L28"></a><tt class="py-lineno"> 28</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-0" class="py-name" targets="Package generic_fns=generic_fns-module.html"><a title="generic_fns" class="py-name" href="#" onclick="return doclink('link-0', 'generic_fns', 'link-0');">generic_fns</a></tt><tt class="py-op">.</tt><tt id="link-1" class="py-name" targets="Module data.mol_res_spin=data.mol_res_spin-module.html,Module generic_fns.mol_res_spin=generic_fns.mol_res_spin-module.html,Module gui.user_functions.mol_res_spin=gui.user_functions.mol_res_spin-module.html"><a title="data.mol_res_spin
generic_fns.mol_res_spin
gui.user_functions.mol_res_spin" class="py-name" href="#" onclick="return doclink('link-1', 'mol_res_spin', 'link-1');">mol_res_spin</a></tt> <tt class="py-keyword">import</tt> <tt id="link-2" class="py-name" targets="Function generic_fns.mol_res_spin.return_molecule()=generic_fns.mol_res_spin-module.html#return_molecule"><a title="generic_fns.mol_res_spin.return_molecule" class="py-name" href="#" onclick="return doclink('link-2', 'return_molecule', 'link-2');">return_molecule</a></tt><tt class="py-op">,</tt> <tt id="link-3" class="py-name" targets="Function generic_fns.mol_res_spin.return_residue()=generic_fns.mol_res_spin-module.html#return_residue"><a title="generic_fns.mol_res_spin.return_residue" class="py-name" href="#" onclick="return doclink('link-3', 'return_residue', 'link-3');">return_residue</a></tt><tt class="py-op">,</tt> <tt id="link-4" class="py-name" targets="Function generic_fns.mol_res_spin.return_spin()=generic_fns.mol_res_spin-module.html#return_spin"><a title="generic_fns.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-4', 'return_spin', 'link-4');">return_spin</a></tt> </tt>
<a name="L29"></a><tt class="py-lineno"> 29</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-5" class="py-name" targets="Module physical_constants=physical_constants-module.html"><a title="physical_constants" class="py-name" href="#" onclick="return doclink('link-5', 'physical_constants', 'link-5');">physical_constants</a></tt> <tt class="py-keyword">import</tt> <tt id="link-6" class="py-name" targets="Function physical_constants.return_atomic_mass()=physical_constants-module.html#return_atomic_mass"><a title="physical_constants.return_atomic_mass" class="py-name" href="#" onclick="return doclink('link-6', 'return_atomic_mass', 'link-6');">return_atomic_mass</a></tt> </tt>
<a name="L30"></a><tt class="py-lineno"> 30</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-7" class="py-name" targets="Module relax_errors=relax_errors-module.html"><a title="relax_errors" class="py-name" href="#" onclick="return doclink('link-7', 'relax_errors', 'link-7');">relax_errors</a></tt> <tt class="py-keyword">import</tt> <tt id="link-8" class="py-name" targets="Class relax_errors.RelaxError=relax_errors.RelaxError-class.html"><a title="relax_errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-8', 'RelaxError', 'link-8');">RelaxError</a></tt><tt class="py-op">,</tt> <tt id="link-9" class="py-name" targets="Class relax_errors.RelaxNoPdbError=relax_errors.RelaxNoPdbError-class.html"><a title="relax_errors.RelaxNoPdbError" class="py-name" href="#" onclick="return doclink('link-9', 'RelaxNoPdbError', 'link-9');">RelaxNoPdbError</a></tt> </tt>
<a name="L31"></a><tt class="py-lineno"> 31</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-10" class="py-name" targets="Module relax_warnings=relax_warnings-module.html"><a title="relax_warnings" class="py-name" href="#" onclick="return doclink('link-10', 'relax_warnings', 'link-10');">relax_warnings</a></tt> <tt class="py-keyword">import</tt> <tt id="link-11" class="py-name" targets="Class relax_warnings.RelaxWarning=relax_warnings.RelaxWarning-class.html"><a title="relax_warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-11', 'RelaxWarning', 'link-11');">RelaxWarning</a></tt> </tt>
<a name="L32"></a><tt class="py-lineno"> 32</tt>  <tt class="py-line"> </tt>
<a name="L33"></a><tt class="py-lineno"> 33</tt>  <tt class="py-line"> </tt>
<a name="L34"></a><tt class="py-lineno"> 34</tt>  <tt class="py-line"> </tt>
<a name="centre_of_mass"></a><div id="centre_of_mass-def"><a name="L35"></a><tt class="py-lineno"> 35</tt> <a class="py-toggle" href="#" id="centre_of_mass-toggle" onclick="return toggle('centre_of_mass');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="generic_fns.structure.mass-module.html#centre_of_mass">centre_of_mass</a><tt class="py-op">(</tt><tt class="py-param">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">model</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">return_mass</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="centre_of_mass-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="centre_of_mass-expanded"><a name="L36"></a><tt class="py-lineno"> 36</tt>  <tt class="py-line">    <tt class="py-docstring">"""Calculate and return the centre of mass of the structure.</tt> </tt>
<a name="L37"></a><tt class="py-lineno"> 37</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L38"></a><tt class="py-lineno"> 38</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_id:       The molecule, residue, and atom identifier string.  Only atoms matching this selection will be used.</tt> </tt>
<a name="L39"></a><tt class="py-lineno"> 39</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_id:          str or None</tt> </tt>
<a name="L40"></a><tt class="py-lineno"> 40</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword model:         Only use a specific model.</tt> </tt>
<a name="L41"></a><tt class="py-lineno"> 41</tt>  <tt class="py-line"><tt class="py-docstring">    @type model:            int or None</tt> </tt>
<a name="L42"></a><tt class="py-lineno"> 42</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword return_mass:   A flag which if False will cause only the centre of mass to be returned, but if True will cause the centre of mass and the mass itself to be returned as a tuple.</tt> </tt>
<a name="L43"></a><tt class="py-lineno"> 43</tt>  <tt class="py-line"><tt class="py-docstring">    @type return_mass:      bool</tt> </tt>
<a name="L44"></a><tt class="py-lineno"> 44</tt>  <tt class="py-line"><tt class="py-docstring">    @return:                The centre of mass vector, and additionally the mass.</tt> </tt>
<a name="L45"></a><tt class="py-lineno"> 45</tt>  <tt class="py-line"><tt class="py-docstring">    @rtype:                 list of 3 floats (or tuple of a list of 3 floats and one float)</tt> </tt>
<a name="L46"></a><tt class="py-lineno"> 46</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L47"></a><tt class="py-lineno"> 47</tt>  <tt class="py-line"> </tt>
<a name="L48"></a><tt class="py-lineno"> 48</tt>  <tt class="py-line">    <tt class="py-comment"># Test if a structure has been loaded.</tt> </tt>
<a name="L49"></a><tt class="py-lineno"> 49</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L50"></a><tt class="py-lineno"> 50</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-12" class="py-name"><a title="relax_errors.RelaxNoPdbError" class="py-name" href="#" onclick="return doclink('link-12', 'RelaxNoPdbError', 'link-9');">RelaxNoPdbError</a></tt> </tt>
<a name="L51"></a><tt class="py-lineno"> 51</tt>  <tt class="py-line"> </tt>
<a name="L52"></a><tt class="py-lineno"> 52</tt>  <tt class="py-line">    <tt class="py-comment"># Print out.</tt> </tt>
<a name="L53"></a><tt class="py-lineno"> 53</tt>  <tt class="py-line">    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Calculating the centre of mass."</tt><tt class="py-op">)</tt> </tt>
<a name="L54"></a><tt class="py-lineno"> 54</tt>  <tt class="py-line"> </tt>
<a name="L55"></a><tt class="py-lineno"> 55</tt>  <tt class="py-line">    <tt class="py-comment"># Initialise the centre of mass.</tt> </tt>
<a name="L56"></a><tt class="py-lineno"> 56</tt>  <tt class="py-line">    <tt id="link-13" class="py-name" targets="Variable test_suite.unit_tests._maths_fns.test_rotation_matrix.R=test_suite.unit_tests._maths_fns.test_rotation_matrix-module.html#R"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-13', 'R', 'link-13');">R</a></tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-number">3</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L57"></a><tt class="py-lineno"> 57</tt>  <tt class="py-line"> </tt>
<a name="L58"></a><tt class="py-lineno"> 58</tt>  <tt class="py-line">    <tt class="py-comment"># Initialise the total mass.</tt> </tt>
<a name="L59"></a><tt class="py-lineno"> 59</tt>  <tt class="py-line">    <tt class="py-name">M</tt> <tt class="py-op">=</tt> <tt class="py-number">0.0</tt> </tt>
<a name="L60"></a><tt class="py-lineno"> 60</tt>  <tt class="py-line"> </tt>
<a name="L61"></a><tt class="py-lineno"> 61</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over all atoms.</tt> </tt>
<a name="L62"></a><tt class="py-lineno"> 62</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">,</tt> <tt id="link-14" class="py-name" targets="Method gui.user_functions.spin.Spin.element()=gui.user_functions.spin.Spin-class.html#element,Method prompt.spin.Spin.element()=prompt.spin.Spin-class.html#element"><a title="gui.user_functions.spin.Spin.element
prompt.spin.Spin.element" class="py-name" href="#" onclick="return doclink('link-14', 'element', 'link-14');">element</a></tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-15" class="py-name" targets="Package bmrblib.structure=bmrblib.structure-module.html,Package generic_fns.structure=generic_fns.structure-module.html,Module gui.user_functions.structure=gui.user_functions.structure-module.html,Module prompt.structure=prompt.structure-module.html,Module test_suite.system_tests.structure=test_suite.system_tests.structure-module.html"><a title="bmrblib.structure
generic_fns.structure
gui.user_functions.structure
prompt.structure
test_suite.system_tests.structure" class="py-name" href="#" onclick="return doclink('link-15', 'structure', 'link-15');">structure</a></tt><tt class="py-op">.</tt><tt id="link-16" class="py-name" targets="Method generic_fns.structure.api_base.Base_struct_API.atom_loop()=generic_fns.structure.api_base.Base_struct_API-class.html#atom_loop,Method generic_fns.structure.internal.Internal.atom_loop()=generic_fns.structure.internal.Internal-class.html#atom_loop,Method generic_fns.structure.scientific.Scientific_data.atom_loop()=generic_fns.structure.scientific.Scientific_data-class.html#atom_loop"><a title="generic_fns.structure.api_base.Base_struct_API.atom_loop
generic_fns.structure.internal.Internal.atom_loop
generic_fns.structure.scientific.Scientific_data.atom_loop" class="py-name" href="#" onclick="return doclink('link-16', 'atom_loop', 'link-16');">atom_loop</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">atom_id</tt><tt class="py-op">,</tt> <tt class="py-name">model_num</tt><tt class="py-op">=</tt><tt class="py-name">model</tt><tt class="py-op">,</tt> <tt class="py-name">mol_name_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">res_num_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">res_name_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">element_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">pos_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L63"></a><tt class="py-lineno"> 63</tt>  <tt class="py-line">        <tt class="py-comment"># Initialise the spin id string.</tt> </tt>
<a name="L64"></a><tt class="py-lineno"> 64</tt>  <tt class="py-line">        <tt id="link-17" class="py-name" targets="Variable generic_fns.structure.api_base.Base_struct_API.id=generic_fns.structure.api_base.Base_struct_API-class.html#id,Variable generic_fns.structure.internal.Internal.id=generic_fns.structure.internal.Internal-class.html#id,Variable generic_fns.structure.scientific.Scientific_data.id=generic_fns.structure.scientific.Scientific_data-class.html#id"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-17', 'id', 'link-17');">id</a></tt> <tt class="py-op">=</tt> <tt class="py-string">''</tt> </tt>
<a name="L65"></a><tt class="py-lineno"> 65</tt>  <tt class="py-line"> </tt>
<a name="L66"></a><tt class="py-lineno"> 66</tt>  <tt class="py-line">        <tt class="py-comment"># Get the corresponding molecule container.</tt> </tt>
<a name="L67"></a><tt class="py-lineno"> 67</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">mol_name</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L68"></a><tt class="py-lineno"> 68</tt>  <tt class="py-line">            <tt class="py-name">mol_cont</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">mol</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L69"></a><tt class="py-lineno"> 69</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L70"></a><tt class="py-lineno"> 70</tt>  <tt class="py-line">            <tt id="link-18" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-18', 'id', 'link-17');">id</a></tt> <tt class="py-op">=</tt> <tt id="link-19" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-19', 'id', 'link-17');">id</a></tt> <tt class="py-op">+</tt> <tt class="py-string">'#'</tt> <tt class="py-op">+</tt> <tt class="py-name">mol_name</tt> </tt>
<a name="L71"></a><tt class="py-lineno"> 71</tt>  <tt class="py-line">            <tt class="py-name">mol_cont</tt> <tt class="py-op">=</tt> <tt id="link-20" class="py-name"><a title="generic_fns.mol_res_spin.return_molecule" class="py-name" href="#" onclick="return doclink('link-20', 'return_molecule', 'link-2');">return_molecule</a></tt><tt class="py-op">(</tt><tt id="link-21" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-21', 'id', 'link-17');">id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L72"></a><tt class="py-lineno"> 72</tt>  <tt class="py-line"> </tt>
<a name="L73"></a><tt class="py-lineno"> 73</tt>  <tt class="py-line">        <tt class="py-comment"># Get the corresponding residue container.</tt> </tt>
<a name="L74"></a><tt class="py-lineno"> 74</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">res_name</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt> <tt class="py-keyword">and</tt> <tt class="py-name">res_num</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L75"></a><tt class="py-lineno"> 75</tt>  <tt class="py-line">            <tt class="py-name">res_cont</tt> <tt class="py-op">=</tt> <tt class="py-name">mol_cont</tt><tt class="py-op">.</tt><tt class="py-name">res</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L76"></a><tt class="py-lineno"> 76</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L77"></a><tt class="py-lineno"> 77</tt>  <tt class="py-line">            <tt id="link-22" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-22', 'id', 'link-17');">id</a></tt> <tt class="py-op">=</tt> <tt id="link-23" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-23', 'id', 'link-17');">id</a></tt> <tt class="py-op">+</tt> <tt class="py-string">':'</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">res_num</tt><tt class="py-op">)</tt> </tt>
<a name="L78"></a><tt class="py-lineno"> 78</tt>  <tt class="py-line">            <tt class="py-name">res_cont</tt> <tt class="py-op">=</tt> <tt id="link-24" class="py-name"><a title="generic_fns.mol_res_spin.return_residue" class="py-name" href="#" onclick="return doclink('link-24', 'return_residue', 'link-3');">return_residue</a></tt><tt class="py-op">(</tt><tt id="link-25" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-25', 'id', 'link-17');">id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L79"></a><tt class="py-lineno"> 79</tt>  <tt class="py-line"> </tt>
<a name="L80"></a><tt class="py-lineno"> 80</tt>  <tt class="py-line">        <tt class="py-comment"># Get the corresponding spin container.</tt> </tt>
<a name="L81"></a><tt class="py-lineno"> 81</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">atom_name</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt> <tt class="py-keyword">and</tt> <tt class="py-name">atom_num</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L82"></a><tt class="py-lineno"> 82</tt>  <tt class="py-line">            <tt class="py-name">spin_cont</tt> <tt class="py-op">=</tt> <tt class="py-name">res_cont</tt><tt class="py-op">.</tt><tt id="link-26" class="py-name" targets="Method gui.user_functions.deselect.Deselect.spin()=gui.user_functions.deselect.Deselect-class.html#spin,Method gui.user_functions.select.Select.spin()=gui.user_functions.select.Select-class.html#spin,Module gui.user_functions.spin=gui.user_functions.spin-module.html,Method prompt.deselect.Deselect.spin()=prompt.deselect.Deselect-class.html#spin,Method prompt.select.Select.spin()=prompt.select.Select-class.html#spin,Module prompt.spin=prompt.spin-module.html,Module test_suite.unit_tests._generic_fns.spin=test_suite.unit_tests._generic_fns.spin-module.html"><a title="gui.user_functions.deselect.Deselect.spin
gui.user_functions.select.Select.spin
gui.user_functions.spin
prompt.deselect.Deselect.spin
prompt.select.Select.spin
prompt.spin
test_suite.unit_tests._generic_fns.spin" class="py-name" href="#" onclick="return doclink('link-26', 'spin', 'link-26');">spin</a></tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L83"></a><tt class="py-lineno"> 83</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L84"></a><tt class="py-lineno"> 84</tt>  <tt class="py-line">            <tt id="link-27" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-27', 'id', 'link-17');">id</a></tt> <tt class="py-op">=</tt> <tt id="link-28" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-28', 'id', 'link-17');">id</a></tt> <tt class="py-op">+</tt> <tt class="py-string">'@'</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">atom_num</tt><tt class="py-op">)</tt> </tt>
<a name="L85"></a><tt class="py-lineno"> 85</tt>  <tt class="py-line">            <tt class="py-name">spin_cont</tt> <tt class="py-op">=</tt> <tt id="link-29" class="py-name"><a title="generic_fns.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-29', 'return_spin', 'link-4');">return_spin</a></tt><tt class="py-op">(</tt><tt id="link-30" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-30', 'id', 'link-17');">id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L86"></a><tt class="py-lineno"> 86</tt>  <tt class="py-line"> </tt>
<a name="L87"></a><tt class="py-lineno"> 87</tt>  <tt class="py-line">        <tt class="py-comment"># Deselected spins.</tt> </tt>
<a name="L88"></a><tt class="py-lineno"> 88</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">spin_cont</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">spin_cont</tt><tt class="py-op">.</tt><tt id="link-31" class="py-name" targets="Function generic_fns.model_selection.select()=generic_fns.model_selection-module.html#select,Module gui.user_functions.select=gui.user_functions.select-module.html,Module prompt.select=prompt.select-module.html"><a title="generic_fns.model_selection.select
gui.user_functions.select
prompt.select" class="py-name" href="#" onclick="return doclink('link-31', 'select', 'link-31');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L89"></a><tt class="py-lineno"> 89</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L90"></a><tt class="py-lineno"> 90</tt>  <tt class="py-line"> </tt>
<a name="L91"></a><tt class="py-lineno"> 91</tt>  <tt class="py-line">        <tt class="py-comment"># No element?</tt> </tt>
<a name="L92"></a><tt class="py-lineno"> 92</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-32" class="py-name"><a title="gui.user_functions.spin.Spin.element
prompt.spin.Spin.element" class="py-name" href="#" onclick="return doclink('link-32', 'element', 'link-14');">element</a></tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L93"></a><tt class="py-lineno"> 93</tt>  <tt class="py-line">            <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-33" class="py-name"><a title="relax_warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-33', 'RelaxWarning', 'link-11');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"Skipping the atom '%s' as the element type cannot be determined."</tt> <tt class="py-op">%</tt> <tt id="link-34" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-34', 'id', 'link-17');">id</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L94"></a><tt class="py-lineno"> 94</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L95"></a><tt class="py-lineno"> 95</tt>  <tt class="py-line"> </tt>
<a name="L96"></a><tt class="py-lineno"> 96</tt>  <tt class="py-line">        <tt class="py-comment"># Atomic mass.</tt> </tt>
<a name="L97"></a><tt class="py-lineno"> 97</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L98"></a><tt class="py-lineno"> 98</tt>  <tt class="py-line">            <tt id="link-35" class="py-name" targets="Module generic_fns.structure.mass=generic_fns.structure.mass-module.html"><a title="generic_fns.structure.mass" class="py-name" href="#" onclick="return doclink('link-35', 'mass', 'link-35');">mass</a></tt> <tt class="py-op">=</tt> <tt id="link-36" class="py-name"><a title="physical_constants.return_atomic_mass" class="py-name" href="#" onclick="return doclink('link-36', 'return_atomic_mass', 'link-6');">return_atomic_mass</a></tt><tt class="py-op">(</tt><tt id="link-37" class="py-name"><a title="gui.user_functions.spin.Spin.element
prompt.spin.Spin.element" class="py-name" href="#" onclick="return doclink('link-37', 'element', 'link-14');">element</a></tt><tt class="py-op">)</tt> </tt>
<a name="L99"></a><tt class="py-lineno"> 99</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt id="link-38" class="py-name"><a title="relax_errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-38', 'RelaxError', 'link-8');">RelaxError</a></tt><tt class="py-op">:</tt> </tt>
<a name="L100"></a><tt class="py-lineno">100</tt>  <tt class="py-line">            <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-39" class="py-name"><a title="relax_warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-39', 'RelaxWarning', 'link-11');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"Skipping the atom '%s' as the element '%s' is unknown."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt id="link-40" class="py-name"><a title="generic_fns.structure.api_base.Base_struct_API.id
generic_fns.structure.internal.Internal.id
generic_fns.structure.scientific.Scientific_data.id" class="py-name" href="#" onclick="return doclink('link-40', 'id', 'link-17');">id</a></tt><tt class="py-op">,</tt> <tt id="link-41" class="py-name"><a title="gui.user_functions.spin.Spin.element
prompt.spin.Spin.element" class="py-name" href="#" onclick="return doclink('link-41', 'element', 'link-14');">element</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L101"></a><tt class="py-lineno">101</tt>  <tt class="py-line"> </tt>
<a name="L102"></a><tt class="py-lineno">102</tt>  <tt class="py-line">        <tt class="py-comment"># Total mass.</tt> </tt>
<a name="L103"></a><tt class="py-lineno">103</tt>  <tt class="py-line">        <tt class="py-name">M</tt> <tt class="py-op">=</tt> <tt class="py-name">M</tt> <tt class="py-op">+</tt> <tt id="link-42" class="py-name"><a title="generic_fns.structure.mass" class="py-name" href="#" onclick="return doclink('link-42', 'mass', 'link-35');">mass</a></tt> </tt>
<a name="L104"></a><tt class="py-lineno">104</tt>  <tt class="py-line"> </tt>
<a name="L105"></a><tt class="py-lineno">105</tt>  <tt class="py-line">        <tt class="py-comment"># Sum of mass * position.</tt> </tt>
<a name="L106"></a><tt class="py-lineno">106</tt>  <tt class="py-line">        <tt id="link-43" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-43', 'R', 'link-13');">R</a></tt> <tt class="py-op">=</tt> <tt id="link-44" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-44', 'R', 'link-13');">R</a></tt> <tt class="py-op">+</tt> <tt id="link-45" class="py-name"><a title="generic_fns.structure.mass" class="py-name" href="#" onclick="return doclink('link-45', 'mass', 'link-35');">mass</a></tt> <tt class="py-op">*</tt> <tt class="py-name">pos</tt> </tt>
<a name="L107"></a><tt class="py-lineno">107</tt>  <tt class="py-line"> </tt>
<a name="L108"></a><tt class="py-lineno">108</tt>  <tt class="py-line">    <tt class="py-comment"># Normalise.</tt> </tt>
<a name="L109"></a><tt class="py-lineno">109</tt>  <tt class="py-line">    <tt id="link-46" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-46', 'R', 'link-13');">R</a></tt> <tt class="py-op">=</tt> <tt id="link-47" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-47', 'R', 'link-13');">R</a></tt> <tt class="py-op">/</tt> <tt class="py-name">M</tt> </tt>
<a name="L110"></a><tt class="py-lineno">110</tt>  <tt class="py-line"> </tt>
<a name="L111"></a><tt class="py-lineno">111</tt>  <tt class="py-line">    <tt class="py-comment"># Final print out.</tt> </tt>
<a name="L112"></a><tt class="py-lineno">112</tt>  <tt class="py-line">    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-string">"    Total mass:      M = "</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">M</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L113"></a><tt class="py-lineno">113</tt>  <tt class="py-line">    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-string">"    Centre of mass:  R = "</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt id="link-48" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-48', 'R', 'link-13');">R</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L114"></a><tt class="py-lineno">114</tt>  <tt class="py-line"> </tt>
<a name="L115"></a><tt class="py-lineno">115</tt>  <tt class="py-line">    <tt class="py-comment"># Return the centre of mass.</tt> </tt>
<a name="L116"></a><tt class="py-lineno">116</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">return_mass</tt><tt class="py-op">:</tt> </tt>
<a name="L117"></a><tt class="py-lineno">117</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt id="link-49" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-49', 'R', 'link-13');">R</a></tt><tt class="py-op">,</tt> <tt class="py-name">M</tt> </tt>
<a name="L118"></a><tt class="py-lineno">118</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L119"></a><tt class="py-lineno">119</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt id="link-50" class="py-name"><a title="test_suite.unit_tests._maths_fns.test_rotation_matrix.R" class="py-name" href="#" onclick="return doclink('link-50', 'R', 'link-13');">R</a></tt> </tt>
</div><a name="L120"></a><tt class="py-lineno">120</tt>  <tt class="py-line"> </tt><script type="text/javascript">
<!--
expandto(location.href);
// -->
</script>
</pre>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://www.nmr-relax.com">relax</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Wed Apr 10 13:32:49 2013
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
