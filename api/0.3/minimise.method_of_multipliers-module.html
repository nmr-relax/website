<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>minimise.method_of_multipliers</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://www.nmr-relax.com">relax</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="minimise-module.html">Package&nbsp;minimise</a> ::
        Module&nbsp;method_of_multipliers
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="minimise.method_of_multipliers-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module method_of_multipliers</h1><p class="nomargin-top"><span class="codelink"><a href="minimise.method_of_multipliers-pysrc.html">source&nbsp;code</a></span></p>
<!-- ==================== CLASSES ==================== -->
<a name="section-Classes"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Classes</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Classes"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="minimise.method_of_multipliers.Method_of_multipliers-class.html" class="summary-name">Method_of_multipliers</a>
    </td>
  </tr>
</table>
<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Functions</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Functions"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="minimise.method_of_multipliers-module.html#method_of_multipliers" class="summary-sig-name">method_of_multipliers</a>(<span class="summary-sig-arg">func</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">dfunc</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">d2func</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">args</span>=<span class="summary-sig-default"><code class="variable-group">(</code><code class="variable-group">)</code></span>,
        <span class="summary-sig-arg">x0</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">min_options</span>=<span class="summary-sig-default"><code class="variable-group">(</code><code class="variable-group">)</code></span>,
        <span class="summary-sig-arg">A</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">b</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">l</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">u</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">c</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">dc</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">d2c</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">lambda0</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">init_lambda</span>=<span class="summary-sig-default">10000.0</span>,
        <span class="summary-sig-arg">mu0</span>=<span class="summary-sig-default">1e-05</span>,
        <span class="summary-sig-arg">epsilon0</span>=<span class="summary-sig-default">0.01</span>,
        <span class="summary-sig-arg">gamma0</span>=<span class="summary-sig-default">0.01</span>,
        <span class="summary-sig-arg">scale_mu</span>=<span class="summary-sig-default">0.5</span>,
        <span class="summary-sig-arg">scale_epsilon</span>=<span class="summary-sig-default">0.01</span>,
        <span class="summary-sig-arg">scale_gamma</span>=<span class="summary-sig-default">0.01</span>,
        <span class="summary-sig-arg">func_tol</span>=<span class="summary-sig-default">1e-25</span>,
        <span class="summary-sig-arg">grad_tol</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">maxiter</span>=<span class="summary-sig-default">1000000.0</span>,
        <span class="summary-sig-arg">inner_maxiter</span>=<span class="summary-sig-default">500</span>,
        <span class="summary-sig-arg">full_output</span>=<span class="summary-sig-default">0</span>,
        <span class="summary-sig-arg">print_flag</span>=<span class="summary-sig-default">0</span>)</span><br />
      The method of multipliers, also known as the augmented Lagrangian method.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="minimise.method_of_multipliers-pysrc.html#method_of_multipliers">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<p class="indent-wrapped-lines"><b>Imports:</b>
  <span title="Numeric.Float64">Float64</span>,
  <span title="Numeric.dot">dot</span>,
  <span title="Numeric.outerproduct">outerproduct</span>,
  <span title="Numeric.sqrt">sqrt</span>,
  <span title="Numeric.zeros">zeros</span>,
  <span title="re.match">match</span>,
  <a href="minimise.constraint_linear.Constraint_linear-class.html" title="minimise.constraint_linear.Constraint_linear">Constraint_linear</a>,
  <a href="minimise.base_classes.Min-class.html" title="minimise.base_classes.Min">Min</a>
</p><br />
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Function Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-FunctionDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="method_of_multipliers"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">method_of_multipliers</span>(<span class="sig-arg">func</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">dfunc</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">d2func</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">args</span>=<span class="sig-default"><code class="variable-group">(</code><code class="variable-group">)</code></span>,
        <span class="sig-arg">x0</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">min_options</span>=<span class="sig-default"><code class="variable-group">(</code><code class="variable-group">)</code></span>,
        <span class="sig-arg">A</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">b</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">l</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">u</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">c</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">dc</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">d2c</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">lambda0</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">init_lambda</span>=<span class="sig-default">10000.0</span>,
        <span class="sig-arg">mu0</span>=<span class="sig-default">1e-05</span>,
        <span class="sig-arg">epsilon0</span>=<span class="sig-default">0.01</span>,
        <span class="sig-arg">gamma0</span>=<span class="sig-default">0.01</span>,
        <span class="sig-arg">scale_mu</span>=<span class="sig-default">0.5</span>,
        <span class="sig-arg">scale_epsilon</span>=<span class="sig-default">0.01</span>,
        <span class="sig-arg">scale_gamma</span>=<span class="sig-default">0.01</span>,
        <span class="sig-arg">func_tol</span>=<span class="sig-default">1e-25</span>,
        <span class="sig-arg">grad_tol</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">maxiter</span>=<span class="sig-default">1000000.0</span>,
        <span class="sig-arg">inner_maxiter</span>=<span class="sig-default">500</span>,
        <span class="sig-arg">full_output</span>=<span class="sig-default">0</span>,
        <span class="sig-arg">print_flag</span>=<span class="sig-default">0</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="minimise.method_of_multipliers-pysrc.html#method_of_multipliers">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
The method of multipliers, also known as the augmented Lagrangian method.

Page 515 from 'Numerical Optimization' by Jorge Nocedal and Stephen J. Wright, 1999, 2nd ed.

The algorithm is:

Given u0 &gt; 0, tolerance t0 &gt; 0, starting points x0s and lambda0
while 1:
    Find an approximate minimiser xk of LA(.,lambdak; uk), starting at xks, and terminating when
        the augmented Lagrangian gradient &lt;= tk
    Final convergence test
    Update Lagrange multipliers using formula 17.58
    Choose new penalty parameter uk+1 within (0, uk)
    Set starting point for the next iteration to xk+1s = xk
    k = k + 1


Three types of inequality constraint are supported.  These are linear, bound, and general
constraints and must be setup as follows.  The vector x is the vector of model parameters.
Don't use bound constriants yet as this code is incomplete!

Equality constraints are currently unimplemented.


Linear constraints
~~~~~~~~~~~~~~~~~~

These are defined as:

    A.x &gt;= b

where:
    A is an m*n matrix where the rows are the transposed vectors, ai, of length n.  The elements
    of ai are the coefficients of the model parameters.

    x is the vector of model parameters of dimension n.

    b is the vector of scalars of dimension m.

    m is the number of constraints.

    n is the number of model parameters.

eg if 0 &lt;= q &lt;= 1, q &gt;= 1 - 2r, and 0 &lt;= r, then:

    | 1  0 |            |  0 |
    |      |            |    |
    |-1  0 |   | q |    | -1 |
    |      | . |   | &gt;= |    |
    | 1  2 |   | r |    |  1 |
    |      |            |    |
    | 0  1 |            |  2 |

To use linear constraints both the matrix A and vector b need to be supplied.


Bound constraints
~~~~~~~~~~~~~~~~~

Bound constraints are defined as:

    l &lt;= x &lt;= u

where l and u are the vectors of lower and upper bounds respectively.

eg if 0 &lt;= q &lt;= 1, r &gt;= 0, s &lt;= 3, then:

    |  0  |    | q |    |  1  |
    |  0  | &lt;= | r | &lt;= | inf |
    |-inf |    | s |    |  3  |

To use bound constraints both vectors l and u need to be supplied.


General constraints
~~~~~~~~~~~~~~~~~~~

These are defined as:

    ci(x) &gt;= 0

where ci(x) are the constraint functions.

To use general constrains the functions c, dc, and d2c need to be supplied.  The function c is
the constraint function which should return the vector of constraint values.  The function dc is
the constraint gradient function which should return the matrix of constraint gradients.  The
function d2c is the constraint Hessian function which should return the 3D matrix of constraint
Hessians.


Initial values
~~~~~~~~~~~~~~

These are the default initial values:

    mu0 = 1e-5
    epsilon0 = 1e-2
    gamma0 = 1e-2
    scale_mu = 0.5
    scale_epsilon = 1e-2
    scale_gamma = 1e-2

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://www.nmr-relax.com">relax</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Tue Nov 25 10:46:27 2014
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
