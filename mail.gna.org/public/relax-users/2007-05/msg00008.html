<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: Convergence of the full_analysis.py script. -->
<!--X-From-R13: Qyner&#45;Zbhvfr Sinaf <cpkpyrNabggvatunz.np.hx> -->
<!--X-Date: Tue, 08 May 2007 09:38:42 +0200 -->
<!--X-Message-Id: 464028E7.3030309@nottingham.ac.uk -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 1172829093.45e7f3a5c5ccd@imp2.webmail.hku.hk -->
<!--X-Reference: 7f080ed10703040822u588e9689r2faf47cfba37d021@mail.gmail.com -->
<!--X-Reference: 1177901186.4635588238653@imp4.webmail.hku.hk -->
<!--X-Reference: 4635F91A.9050704@nottingham.ac.uk -->
<!--X-Reference: 1178578073.7421.11.camel@localhost -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Convergence of the full_analysis.py script. -- May 08, 2007 - 09:38</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Convergence of the full_analysis.py script.</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00008" class="tabs">Index by Date</a> | <a href="threads.html#00008" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00007.html">Date Prev</a>] [<a href="msg00009.html">Date Next</a>] [<a href="msg00003.html">Thread Prev</a>] [<a href="msg00009.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Edward d'Auvergne &lt;edward.dauvergne@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Tue, 08 May 2007 08:38:15 +0100</li>
<li class="menuitem">
<em>Cc</em>: relax-users@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00008.html">464028E7.3030309@nottingham.ac.uk</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;1172829093.45e7f3a5c5ccd@xxxxxxxxxxxxxxxxxxx&gt;		&lt;7f080ed10703040822u588e9689r2faf47cfba37d021@xxxxxxxxxxxxxx&gt;		&lt;1177901186.4635588238653@xxxxxxxxxxxxxxxxxxx&gt;		&lt;4635F91A.9050704@xxxxxxxxxxxxxxxx&gt;	&lt;<a href="msg00003.html">1178578073.7421.11.camel@localhost</a>&gt;</li>
<li class="menuitem">
<em>User-agent</em>: Thunderbird 1.5.0.10 (Macintosh/20070221)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Clare-Louise Evans</strong> on May 08, 2007 - 09:38:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Hi,

</pre><tt>Thanks for your responses.  I didn't realise full_analysis.py was 
</tt><tt>insufficent for single field data, opps! 
</tt><tt>
</tt><tt>You mentioned in reply to my other message 
</tt><tt>(<a  rel="nofollow" href="https://mail.gna.org/public/relax-users/2007-04/msg00006.html">https://mail.gna.org/public/relax-users/2007-04/msg00006.html</a>), that 
</tt><tt>performing model-free using models m1 and m5 was still ok for single 
</tt><tt>field data, although there could still be problems.  Currently, I've 
</tt><tt>only got access to a single field, can I simply edit the 
</tt><tt>full_analysis.py script to only run the optimisations using tm1 - tm5 
</tt><tt>and m1 - m5, or is it more complex than that?  Is the model-free.py ok 
</tt><tt>for use with single-field data?
</tt><pre style="margin: 0em;">

Many thanks
Clare

Edward d'Auvergne wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">
Hi,

As optimisation should converge very quickly when the differences
between iterations is at such low significant figures, I'm unsure as to
what is causing the problem.  For the spheroidal and ellipsoidal
diffusion tensors convergence should occur between 10-15 iterations, and
maximally after 20.  The reason could be because the script is trapped
jumping between the same two models for each alternate iteration.  I
have a feeling though that this is an issue caused by over-fitting and
the parameter values are just drifting aimlessly through the parameter
space.  Actually, thinking about this, I can almost guarantee that that
is what is happening.  The data at only a single field strength
(<a  rel="nofollow" href="https://mail.gna.org/public/relax-users/2007-04/msg00006.html">https://mail.gna.org/public/relax-users/2007-04/msg00006.html</a>) is
insufficient for the full_analysis.py script.  Sorry for not responding
earlier.

Cheers,

Edward



On Mon, 2007-04-30 at 15:11 +0100, Clare-Louise Evans wrote:
</pre><tt>  
</tt><blockquote class="blockquote"><pre style="margin: 0em;">
Dear Edward,

</pre><tt>Sorry for the thread hijack, but I noticed in the PS section of the 
</tt><tt>quote Hongyan has included below your comment regarding convergence. 
</tt><tt>
</tt><tt>I am having problems with convergence at the moment when running the 
</tt><tt>full_analysis.py script.  I have run the optimisation of the diffusion 
</tt><tt>models on the same PC.  For the oblate, prolate and ellipsoid models I 
</tt><tt>have failed to reach convergence after 30+ rounds.  The sphere model 
</tt><tt>converged within 5 rounds.  However, when I look at the output the only 
</tt><tt>difference between the chi-squared and other parameter values is in the 
</tt><tt>10th and later decimal places.  Surely, with having such small 
</tt><tt>differences between the values they can be considered to have 
</tt><tt>converged.  However, in your comment you state they have to be 
</tt><tt>identical.  If this really is the case then I'm not sure how to proceed 
</tt><tt>given that I'm failing to reach convergence on these 3 models?
</tt><pre style="margin: 0em;">

</pre><tt>Apologies if this ties in to the question I asked yesterday regarding 
</tt><tt>full_analysis.py.
</tt><pre style="margin: 0em;">

Kind regards
Clare

Hongyan Li wrote:
</pre><tt>    
</tt><blockquote class="blockquote"><pre style="margin: 0em;">
Dear Edward,
Thanks for your early suggestion regarding different model selections. I have
been busy on other stuff and only recently got time to focus on this subject
again.
I have run all the diffusion models e.g. isotropic, prolate, oblate and
ellipsoid and model selections were made within each model (in aic directory).
</pre><tt>I am not sure how to write a script to select different models using 
</tt><tt>'model_selection()'. Could you please do me a favor?
</tt><pre style="margin: 0em;">
Your help is highly appreciated!
Best wishes,
Hongyan

Quoting Edward d'Auvergne &lt;edward.dauvergne@xxxxxxxxx&gt;:

</pre><tt>  
</tt><tt>      
</tt><blockquote class="blockquote"><pre style="margin: 0em;">
Hi,

To compare the results what you need to employ is a technique from the
statistical field of model selection.  The spherical diffusion
(isotropic) + all model-free models of all selected residues is one
single mathematical model.  The prolate and oblate spheroids (prolate
and oblate axially symmetric anisotropic diffusion tensors) + all
model-free models, and the ellipsoid (fully anisotropic or three
different eigenvalues) + all model-free models, are three additional
mathematical models.  Therefore to compare these four different models
you need to select the model which best represents your relaxation
data.  These models are, however, not nested and therefore cannot be
compared using ANOVA F-tests!  Firstly the three types of diffusion
tensor are not nested (there is a reference from Dominique Marion's
group in which they say ANOVA statistics cannot be used but I can't
find it at the moment (although it shouldn't be too hard to track
down, it's related to Tensor)).  Secondly the model-free models
selected will be different between the four models.  Hence chi-squared
and F-tests cannot be used.

A useful reference (I'm not at all biased ;) for this problem is my
paper d'Auvergne, E. J. and Gooley, P. R. (2003), (see
<a  rel="nofollow" href="http://www.nmr-relax.com/refs.html">http://www.nmr-relax.com/refs.html</a> for the full reference).  On page
37 at the end of that paper I discuss how AIC model selection is
perfect for selecting between these non-nested models.  The AIC
criterion is still

AIC = chi2 + 2k,

however chi2 is the minimised chi-squared value for the complete model
and k is the sum of the number of diffusion parameters and number of
model-free parameters for all spin systems.  BIC model selection is
likely to work quite well as well.  If you have four runs, one for
each of the diffusion models, then the relax user function
'model_selection()' is designed to select between these models.  I
hope this helps and hasn't been too biased.

Cheers,

Edward


P.S.  Prior to model selection between the diffusion models, the
diffusion models must have fully converged.  Multiple iterations of
optimisation of the model-free models, AIC model selection, and
optimisation of all parameters together (diffusion tensor + model-free
parameter of all residues) must be executed.  Convergence is when two
iterations possess identical chi-squared values, identical model-free
models, and identical parameter values.


On 3/2/07, Hongyan Li &lt;hylichem@xxxxxxxxxxxx&gt; wrote:
</pre><tt>    
</tt><tt>        
</tt><blockquote class="blockquote"><pre style="margin: 0em;">
Dear relax users,
I have managed to use Relax to run my dynamics data by both isotropic and
axial-oblate models. My qestion is how to compare the results, by
</pre><tt>      
</tt><tt>          
</tt></blockquote><pre style="margin: 0em;">
chi-square??
</pre><tt>    
</tt><tt>        
</tt><blockquote class="blockquote"><pre style="margin: 0em;">
what is the criteria to make judgment that which residues is beter
</pre><tt>      
</tt><tt>          
</tt></blockquote><pre style="margin: 0em;">
simulated
</pre><tt>    
</tt><tt>        
</tt><blockquote class="blockquote"><pre style="margin: 0em;">
with which model?

Thanks for your kind help!

Best wishes,

Hongyan

Dr. Hongyan Li
Department of Chemistry
The University of Hong Kong
Pokfulam Road
Hong Kong


_______________________________________________
relax (<a  rel="nofollow" href="http://nmr-relax.com">http://nmr-relax.com</a>)

This is the relax-users mailing list
relax-users@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-users">https://mail.gna.org/listinfo/relax-users</a>

</pre><tt>      
</tt><tt>          
</tt></blockquote></blockquote><pre style="margin: 0em;">
Dr. Hongyan Li
Department of Chemistry
The University of Hong Kong
Pokfulam Road
Hong Kong


_______________________________________________
relax (<a  rel="nofollow" href="http://nmr-relax.com">http://nmr-relax.com</a>)

This is the relax-users mailing list
relax-users@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-users">https://mail.gna.org/listinfo/relax-users</a>
</pre><tt>  
</tt><tt>      
</tt></blockquote><pre style="margin: 0em;">
This message has been checked for viruses but the contents of an attachment
may still contain software viruses, which could damage your computer system:
you are advised to perform your own checks. Email communications with the
University of Nottingham may be monitored as permitted by UK legislation.


_______________________________________________
relax (<a  rel="nofollow" href="http://nmr-relax.com">http://nmr-relax.com</a>)

This is the relax-users mailing list
relax-users@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-users">https://mail.gna.org/listinfo/relax-users</a>
</pre><tt>    
</tt></blockquote><pre style="margin: 0em;">

</pre><tt>  
</tt></blockquote><pre style="margin: 0em;">

This message has been checked for viruses but the contents of an attachment
may still contain software viruses, which could damage your computer system:
you are advised to perform your own checks. Email communications with the
University of Nottingham may be monitored as permitted by UK legislation.



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00009" href="msg00009.html">Re: Convergence of the full_analysis.py script.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00003" href="msg00003.html">Convergence of the full_analysis.py script.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Tue May 08 10:20:12 2007</div>  
</body>
</html>
