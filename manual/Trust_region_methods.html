<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.1//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Trust region methods</TITLE>
<META NAME="description" CONTENT="Trust region methods">
<META NAME="keywords" CONTENT="relax">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">

  <!--Google analytics JS-->
  <script type="text/javascript">
  
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30096326-1']);
    _gaq.push(['_setDomainName', 'nmr-relax.com']);
    _gaq.push(['_trackPageview']);
  
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  
  </script>

<LINK REL="STYLESHEET" HREF="relax.css">

<LINK REL="next" HREF="Conjugate_gradient_methods.html">
<LINK REL="previous" HREF="Line_search_methods.html">
<LINK REL="up" HREF="Optimisation_algorithms.html">
<LINK REL="next" HREF="Conjugate_gradient_methods.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html10124"
  HREF="Conjugate_gradient_methods.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Next" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html10118"
  HREF="Optimisation_algorithms.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Up" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html10112"
  HREF="Line_search_methods.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Previous" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html10120"
  HREF="Contents.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Contents" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html10122"
  HREF="Index.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Index" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html1"
  HREF="http://download.gna.org/relax/manual/relax.pdf"><IMG
 ALIGN="BOTTOM" BORDER="0" SRC="http://www.nmr-relax.com/images/pdf_icon_nav.png"
 ALT="pdf_icon_nav.png"></A><A NAME="tex2html2"
  HREF="http://www.nmr-relax.com"><IMG
 ALIGN="BOTTOM" BORDER="0" SRC="http://www.nmr-relax.com/images/relax_logo_nav.png"
 ALT="relax_logo_nav.png"></A>
<BR>
<B> Next:</B> <A NAME="tex2html10125"
  HREF="Conjugate_gradient_methods.html">Conjugate gradient methods</A>
<B> Up:</B> <A NAME="tex2html10119"
  HREF="Optimisation_algorithms.html">Optimisation algorithms</A>
<B> Previous:</B> <A NAME="tex2html10113"
  HREF="Line_search_methods.html">Line search methods</A>
 &nbsp; <B>  <A NAME="tex2html10121"
  HREF="Contents.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html10123"
  HREF="Index.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><A NAME="tex2html10126"
  HREF="Trust_region_methods.html#SECTION07142100000000000000">The Cauchy point algorithm</A>
<LI><A NAME="tex2html10127"
  HREF="Trust_region_methods.html#SECTION07142200000000000000">The dogleg algorithm</A>
<LI><A NAME="tex2html10128"
  HREF="Trust_region_methods.html#SECTION07142300000000000000">Steihaug's algorithm</A>
<LI><A NAME="tex2html10129"
  HREF="Trust_region_methods.html#SECTION07142400000000000000">The exact trust region</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H2><A NAME="SECTION07142000000000000000">
Trust region methods</A>
</H2>

<P>
In the trust region class of algorithms the curvature of the space is modelled quadratically by (<A HREF="The_Hessian.html#eq:_quadratic_model">13.5</A>).
This model is assumed to be reliable only within a region of trust defined by the inequality <!-- MATH
 $\lVert p \rVert \leqslant \Delta_k$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="13" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img310.png"
 ALT="$ \lVert$"><I>p</I><IMG
 WIDTH="12" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img311.png"
 ALT="$ \rVert$"> <IMG
 WIDTH="18" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img72.png"
 ALT="$ \leqslant$"> <I>Δ</I><SUB>k</SUB></SPAN> where <SPAN CLASS="MATH"><I>p</I></SPAN> is the step taken by the algorithm and <SPAN CLASS="MATH"><I>Δ</I><SUB>k</SUB></SPAN> is the radius of the <SPAN CLASS="MATH"><I>n</I></SPAN>-dimensional sphere of trust (<A
 HREF="Bibliography.html#NocedalWright99">Nocedal and Wright, 1999</A>).
The solution sought for each iteration of the algorithm is
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="eq:_trust_region"></A><!-- MATH
 \begin{equation}
\min_{p \in \mathbb{R}^n} m_k(p) = f_k  +  p^{T} \nabla f_k  +  \tfrac{1}{2} p^{T} B_k p,  \qquad \textrm{s.t. } \lVert p \rVert \leqslant \Delta_k,
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="38" HEIGHT="41" ALIGN="MIDDLE" BORDER="0"
 SRC="img312.png"
 ALT="$\displaystyle \min_{{p \in \mathbb{R}^n}}^{}$"><I>m</I><SUB>k</SUB>(<I>p</I>) = <I>f</I><SUB>k</SUB> + <I>p</I><SUP>T</SUP>∇<I>f</I><SUB>k</SUB> + <IMG
 WIDTH="15" HEIGHT="38" ALIGN="MIDDLE" BORDER="0"
 SRC="img308.png"
 ALT="$\displaystyle {\tfrac{{1}}{{2}}}$"><I>p</I><SUP>T</SUP><I>B</I><SUB>k</SUB><I>p</I>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.t.<IMG
 WIDTH="12" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img313.png"
 ALT="$\displaystyle \lVert$"><I>p</I><IMG
 WIDTH="13" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img314.png"
 ALT="$\displaystyle \rVert$"> <IMG
 WIDTH="17" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img315.png"
 ALT="$\displaystyle \leqslant$"> <I>Δ</I><SUB>k</SUB>,</SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">13</SPAN>.<SPAN CLASS="arabic">9</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>

<P>
where <SPAN CLASS="MATH"><I>m</I><SUB>k</SUB>(<I>p</I>)</SPAN> is the quadratic model, <SPAN CLASS="MATH"><I>B</I><SUB>k</SUB></SPAN> is a positive definite matrix which can be the true Hessian as in the Newton model or an approximation such as the BFGS<A NAME="20796"></A> matrix, and <!-- MATH
 $\lVert p \rVert$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="13" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img310.png"
 ALT="$ \lVert$"><I>p</I><IMG
 WIDTH="12" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img311.png"
 ALT="$ \rVert$"></SPAN> is the Euclidean norm of <SPAN CLASS="MATH"><I>p</I></SPAN>.
The trust region radius <SPAN CLASS="MATH"><I>Δ</I><SUB>k</SUB></SPAN> is modified dynamically during optimisation - if the quadratic model is found to be a poor representation of the space the radius is decreased whereas if the quadratic model is found to be reasonable the radius is increased to allow larger, more efficient steps to be taken.

<P>

<H3><A NAME="SECTION07142100000000000000"></A>
<A NAME="20798"></A>
<BR>
The Cauchy point algorithm
</H3>

<P>
The Cauchy point algorithm is similar in concept to the steepest descent<A NAME="20799"></A> line search algorithm.
The Cauchy point is the point lying on the gradient which minimises the quadratic model subject to the step being within the trust region.
By iteratively finding the Cauchy point the local minimum can be found.
The convergence of the technique is inefficient, being similar to that of the steepest descent algorithm.

<P>

<H3><A NAME="SECTION07142200000000000000"></A>
<A NAME="20801"></A>
<BR>
The dogleg algorithm
</H3>

<P>
In changing the trust region radius the exact solutions to (<A HREF="#eq:_trust_region">13.9</A>) map out a curved trajectory which starts parallel to the gradient for small radii.
The end of the trajectory, which occurs for radii greater than the step length, is the bottom of the quadratic model.
The dogleg algorithm attempts to follow a similar path by first finding the minimum along the gradient and then finding the minimum along a trajectory from the current point to the bottom of the quadratic model.
The minimum along the second path is either the trust region boundary or the quadratic solution.
The matrix <SPAN CLASS="MATH"><I>B</I><SUB>k</SUB></SPAN> of (<A HREF="#eq:_trust_region">13.9</A>) can be the BFGS matrix, the unmodified Hessian, or a Hessian modified to be positive definite.

<P>

<H3><A NAME="SECTION07142300000000000000"></A>
<A NAME="20805"></A>
<BR>
Steihaug's algorithm
</H3>

<P>
Another trust region algorithm is Steihaug's modified conjugate gradient approach (<A
 HREF="Bibliography.html#Steihaug83">Steihaug, 1983</A>).
For each step <SPAN CLASS="MATH"><I>k</I></SPAN> an iterative technique is used which is almost identical to the standard conjugate gradient procedure except for two additional termination conditions.
The first is if the next step is outside the trust region, the second is if a direction of zero or negative curvature is encountered.

<P>

<H3><A NAME="SECTION07142400000000000000"></A>
<A NAME="20808"></A>
<BR>
The exact trust region
</H3>

<P>
An almost exact solution to (<A HREF="#eq:_trust_region">13.9</A>) can be found using an algorithm described in <A
 HREF="Bibliography.html#NocedalWright99">Nocedal and Wright (1999)</A>.
This exact trust region algorithm aims to precisely find the minimum of the quadratic model <SPAN CLASS="MATH"><I>m</I><SUB>k</SUB></SPAN> of the space within the trust region <SPAN CLASS="MATH"><I>Δ</I><SUB>k</SUB></SPAN>.
Any matrix <SPAN CLASS="MATH"><I>B</I><SUB>k</SUB></SPAN> can be used to construct the quadratic model.
However, the technique is computationally expensive.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html10124"
  HREF="Conjugate_gradient_methods.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Next" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html10118"
  HREF="Optimisation_algorithms.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Up" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html10112"
  HREF="Line_search_methods.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Previous" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html10120"
  HREF="Contents.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Contents" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html10122"
  HREF="Index.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Index" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html1"
  HREF="http://download.gna.org/relax/manual/relax.pdf"><IMG
 ALIGN="BOTTOM" BORDER="0" SRC="http://www.nmr-relax.com/images/pdf_icon_nav.png"
 ALT="pdf_icon_nav.png"></A><A NAME="tex2html2"
  HREF="http://www.nmr-relax.com"><IMG
 ALIGN="BOTTOM" BORDER="0" SRC="http://www.nmr-relax.com/images/relax_logo_nav.png"
 ALT="relax_logo_nav.png"></A>
<BR>
<B> Next:</B> <A NAME="tex2html10125"
  HREF="Conjugate_gradient_methods.html">Conjugate gradient methods</A>
<B> Up:</B> <A NAME="tex2html10119"
  HREF="Optimisation_algorithms.html">Optimisation algorithms</A>
<B> Previous:</B> <A NAME="tex2html10113"
  HREF="Line_search_methods.html">Line search methods</A>
 &nbsp; <B>  <A NAME="tex2html10121"
  HREF="Contents.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html10123"
  HREF="Index.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
The <a href="http://www.nmr-relax.com">relax</a> <a href="http://www.nmr-relax.com/manual/">user manual</a> (<a href="http://download.gna.org/relax/manual/relax.pdf">PDF</a>), created 2014-12-03.
</ADDRESS>
</BODY>
</HTML>
