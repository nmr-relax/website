<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: The singleton design pattern for the old 'self.relax.data' data	structure. -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Thu, 08 Mar 2007 10:33:07 +0100 -->
<!--X-Message-Id: 7f080ed10703080132t25cd765axa0b7d9920bebc8ea@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 7f080ed10703070006s309a1e1do38e621f48d8f6d9e@mail.gmail.com -->
<!--X-Reference: 1173263918.8066.238.camel@mrspell -->
<!--X-Reference: 45EFCABC.9040905@bmb.leeds.ac.uk -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: The singleton design pattern for the old 'self.relax.data' data	structure. -- March 08, 2007 - 10:33</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: The singleton design pattern for the old 'self.relax.data' data	structure.</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00024" class="tabs">Index by Date</a> | <a href="threads.html#00024" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00023.html">Date Prev</a>] [<a href="msg00025.html">Date Next</a>] [<a href="msg00020.html">Thread Prev</a>] [<a href="msg00015.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Gary S. Thompson&quot; &lt;garyt@xxxxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Thu, 8 Mar 2007 20:32:28 +1100</li>
<li class="menuitem">
<em>Cc</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Dkim-signature</em>: a=rsa-sha1; c=relaxed/relaxed; d=gmail.com; s=beta;	h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:cc:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;	b=DGGZT9xaTZ8Yvx3jjNa01doqWa0ru4rc5VjoGCDrqoFrpEUrU7hpUWFVHLhH/C8Zu7CvYIqgUegLX0QX82Y7+nrjNlQRNih8PcHXLuZetI/7cxAzMTd2xOJHfEmF/Y39Hvh468cnTJQBE8PIQWzLF2mXmsAuHF4gSt1QYvF45tc=</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00024.html">7f080ed10703080132t25cd765axa0b7d9920bebc8ea@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;<a href="msg00012.html">7f080ed10703070006s309a1e1do38e621f48d8f6d9e@mail.gmail.com</a>&gt;	&lt;<a href="msg00013.html">1173263918.8066.238.camel@mrspell</a>&gt; &lt;<a href="msg00020.html">45EFCABC.9040905@bmb.leeds.ac.uk</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on March 08, 2007 - 10:33:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<tt>On 3/8/07, Gary S. Thompson &lt;garyt@xxxxxxxxxxxxxxx&gt; wrote:
</tt><blockquote class="blockquote"><pre style="margin: 0em;">Chris MacRaild wrote:</pre><br>
<pre style="margin: 0em;">&gt;On Wed, 2007-03-07 at 19:06 +1100, Edward d'Auvergne wrote:
&gt;
&gt;
&gt;
&gt;&gt;Hi,
&gt;&gt;
&gt;&gt;After careful thought about design patterns, I've decided to try to
&gt;&gt;use the singleton pattern for the old 'self.relax.data' data
&gt;&gt;structure.  See <a  href="http://en.wikipedia.org/wiki/Singleton_pattern">http://en.wikipedia.org/wiki/Singleton_pattern</a> for
&gt;&gt;more information about this design pattern.  I'll try to use the
&gt;&gt;second simple example under the heading 'Python Borg pattern'.  The
&gt;&gt;benefit of this pattern is that each module can use the code:
&gt;&gt;
&gt;&gt;from data import Data
&gt;&gt;relax_data = Data()
&gt;&gt;
&gt;&gt;As Data will be a singleton if two modules used by relax instantiate
&gt;&gt;the Data class then the global 'relax_data' in both modules will be
&gt;&gt;the same instance.  Therefore if a method from the
&gt;&gt;'special_fns.model_free' module modifies the data structure, all the
&gt;&gt;other relax modules using the singleton will see the changes.  The
&gt;&gt;benefit of this pattern is that the data structure is similar in
&gt;&gt;concept to a global variable but only modules utilising it will have
&gt;&gt;it in one of their namespaces.  Also 'self.relax.data' will not need
&gt;&gt;to be passed around inside the program, simplifying the code.  What do
&gt;&gt;you think of the idea?
&gt;&gt;
&gt;&gt;
&gt;
&gt;One issue here, identified on the wikipedia page, is that __init__() is
&gt;called for each call of Singleton(). Therefore all of the standard
&gt;__init__() stuff - inialising variables and empty containers - will
&gt;happen every time the Singleton instance is sought. This is clearly not
&gt;what we want. Ofcourse there are many ways around that by cleverly
&gt;hiding the initialisation stuff, but its starting to look like a complex
&gt;solution to what should be a simple problem.
&gt;
&gt;Something like:
&gt;
&gt;class Data:
&gt;    ...
&gt;Data = Data()
&gt;
&gt;in the data module, then everywhere else:
&gt;
&gt;from data import Data as relax_data
&gt;
&gt;
&gt;By rebinding the name 'Data' with an instance of the class, we
&gt;effectively prevent accidental creation of additional instances, and the
&gt;import makes that instance availible wherever we need it.
&gt;
&gt;Chris
&gt;
&gt;
&gt;
I agree</pre><br>
<pre style="margin: 0em;">another alternative would be a more classic singleton such as</pre><br>
<pre style="margin: 0em;"><br>class _Singleton(object):</pre><br>
<pre style="margin: 0em;">    def __init__(self):
        # just for the sake of information
        self.instance = &quot;Instance at %d&quot; % self.__hash__()</pre><br>
<pre style="margin: 0em;"><br>_singleton = _Singleton()</pre><br>
<pre style="margin: 0em;">def Singleton(): return _singleton</pre><br>
<pre style="margin: 0em;">=====</pre><br>
<pre style="margin: 0em;">&gt;&gt;&gt; from singleton import Singleton
&gt;&gt;&gt; s1 = Singleton()
&gt;&gt;&gt; s2 = Singleton()
&gt;&gt;&gt; s1.instance
'Instance at -1226695220'
&gt;&gt;&gt; s2.instance
'Instance at -1226695220'
&gt;&gt;&gt; s1 == s2
True</pre><br>
<pre style="margin: 0em;">which is from the discussion on
<a  href="http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/52558">http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/52558</a>
</pre></blockquote><pre style="margin: 0em;"><br>Although using slightly different approach from the code currently in
the 1.3 line the end result is identical in both implementations.  In
the above example the instance reference is stored in the global
namespace of the module whereas in the file 'data/__init__.py' the
instance reference is stored in the scope of the Data class.  Both the
__new__() method and the Singleton() function then return that
reference to the import statement.  From the point of view of the rest
of relax, the import and initiation is identical.  Gary, do you see a
benefit from using the alternative example?</pre><br>
<pre style="margin: 0em;">Cheers,</pre><br>
<pre style="margin: 0em;">Edward</pre><br>
<br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00012" href="msg00012.html">The singleton design pattern for the old 'self.relax.data' data	structure.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00013" href="msg00013.html">Re: The singleton design pattern for the old 'self.relax.data' data	structure.</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00020" href="msg00020.html">Re: The singleton design pattern for the old 'self.relax.data' data	structure.</a></strong>
<ul><li><em>From:</em> Gary S. Thompson</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu Mar 08 11:00:23 2007</div>  
</body>
</html>
