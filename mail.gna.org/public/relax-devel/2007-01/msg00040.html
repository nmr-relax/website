<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: Redesign of the relax data model: 3. Molecules, residues,	and spins -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneq.qnhiretarNtznvy.pbz> -->
<!--X-Date: Fri, 19 Jan 2007 08:33:29 +0100 -->
<!--X-Message-Id: 7f080ed10701182332v1364d112i2a408f35cc119a76@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: f001463a0701071417w6bd7927cp8fdd052e698575ec@mail.gmail.com -->
<!--X-Reference: 1168433714.7569.359.camel@mrspell -->
<!--X-Reference: 7f080ed10701150145q53b01785ucc3b04a3a61fdc07@mail.gmail.com -->
<!--X-Reference: 1168883717.7569.511.camel@mrspell -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Redesign of the relax data model: 3. Molecules, residues,	and spins -- January 19, 2007 - 08:33</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Redesign of the relax data model: 3. Molecules, residues,	and spins</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00040" class="tabs">Index by Date</a> | <a href="threads.html#00040" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00039.html">Date Prev</a>] [<a href="msg00041.html">Date Next</a>] [<a href="msg00036.html">Thread Prev</a>] [<a href="msg00041.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Chris MacRaild&quot; &lt;c.a.macraild@xxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Fri, 19 Jan 2007 18:32:44 +1100</li>
<li class="menuitem">
<em>Cc</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00040.html">7f080ed10701182332v1364d112i2a408f35cc119a76@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;<a href="msg00014.html">f001463a0701071417w6bd7927cp8fdd052e698575ec@mail.gmail.com</a>&gt;	&lt;<a href="msg00021.html">1168433714.7569.359.camel@mrspell</a>&gt;	&lt;<a href="msg00032.html">7f080ed10701150145q53b01785ucc3b04a3a61fdc07@mail.gmail.com</a>&gt;	&lt;<a href="msg00036.html">1168883717.7569.511.camel@mrspell</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on January 19, 2007 - 08:33:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<blockquote class="blockquote"><pre style="margin: 0em;">&gt; &gt; To extend things a bit further, we could incorporate all of this with a
&gt; &gt; functor similar to that proposed for handling multiple run selections
&gt; &gt; (<a  href="http://www.nmr-relax.com/mail.gna.org/public/relax-devel/2007-01/msg00013.html">https://mail.gna.org/public/relax-devel/2007-01/msg00013.html</a> and
&gt; &gt; <a  href="http://www.nmr-relax.com/mail.gna.org/public/relax-devel/2007-01/msg00020.html">https://mail.gna.org/public/relax-devel/2007-01/msg00020.html</a> ). Of
&gt; &gt; course the spin functor would opperate at a different level of code to
&gt; &gt; the run functor - whereas all user functions would be instances of the
&gt; &gt; run functor, only certain internal functions (those that act on a single
&gt; &gt; spin) would be instances of the spin functor.
&gt;
&gt; The user functions are instances of the run functor?  Do you mean the
&gt; functions called by the user functions are instances?</pre><br>
<pre style="margin: 0em;">No. In my interpretation of Gary's initial suggestion (gary:
<a  href="http://www.nmr-relax.com/mail.gna.org/public/relax-devel/2007-01/msg00013.html">https://mail.gna.org/public/relax-devel/2007-01/msg00013.html</a> and me:
<a  href="http://www.nmr-relax.com/mail.gna.org/public/relax-devel/2007-01/msg00020.html">https://mail.gna.org/public/relax-devel/2007-01/msg00020.html</a> ), each
relax user command is an instance of a functor which catches the runs
argument if passed, impliments the run loop (or run stack in Gary's
implimentation), and calls the relevant function in prompt/
</pre></blockquote><pre style="margin: 0em;"><br>I see what you mean.  We could implement this in the file
'prompt/interpreter.py' and pass in the functions to the functor
class, overwriting the function in the user function class with the
instance.  I do see a problem though and that is how this will affect
the docstrings and the relax help system.</pre><br>
<br>
<blockquote class="blockquote"><tt>Then all internal relax functions act only on the current run.
</tt></blockquote><pre style="margin: 0em;"><br>That would be best.</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">Because spin selection is used differently by different relax functions,
and because there is no concept of a 'current spin', my suggestion of a
spin functor lacks the generality and elegance of Gary's idea, but it
might still be worth considering for its code simplification potential.
There are plenty of functions in relax that opperate on a single spin,
and there will be plenty of occasions where we need to code something
like:
</pre></blockquote><tt>'&gt;
</tt><blockquote class="blockquote"><pre style="margin: 0em;">for spin in spin_loop(selection):
    do_something(spin)</pre><br>
<pre style="margin: 0em;">The spin functor idea is simply that this code can be replaced with:</pre><br>
<pre style="margin: 0em;">do_something(selection)</pre><br>
<pre style="margin: 0em;">where the 'function' do_something is in fact an instance of the spin
functor:</pre><br>
<pre style="margin: 0em;">class Spin_command():
    def __init__(self, function):
        self.function = function
    def __call__(self, *args, **kwds):
        if 'selection' in kwds.keys():
            selection = kwds['selection']
            del kwds['selection']
            for spin in spin_loop(selection):
                args.insert(0, spin)
                # or kwds['spin'] = spin
                # depending on the agreed syntax of function
                self.function(*args, **kwds)</pre><br>
<pre style="margin: 0em;">The gain in simplicity is arguably marginal, but there will be a lot of
examples where it might apply.
</pre></blockquote><pre style="margin: 0em;"><br>If we have both the spin_loop and the spin_command, then the developer
can choose the best option as needed.  I thought you meant completely
dropping the spin_loop concept.  Chris, would you like to add the idea
to the 'docs/data_model_redesign' file (as well as any other ideas
which have been discussed)?</pre><br>
<pre style="margin: 0em;">Cheers,</pre><br>
<pre style="margin: 0em;">Edward</pre><br>
<pre style="margin: 0em;"><br>P.S.  I'll respond to the rest of the post in a second message.</pre><br>
<br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00014" href="msg00014.html">re: Redesign of the relax data model: 3. Molecules, residues,	and spins</a></strong>
<ul><li><em>From:</em> gary thompson</li></ul></li>
<li><strong><a name="00021" href="msg00021.html">re: Redesign of the relax data model: 3. Molecules, residues,	and spins</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00032" href="msg00032.html">Re: Redesign of the relax data model: 3. Molecules, residues,	and spins</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00036" href="msg00036.html">Re: Redesign of the relax data model: 3. Molecules, residues,	and spins</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Fri Jan 19 13:20:19 2007</div>  
</body>
</html>
