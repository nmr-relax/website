<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [task #7822] Implement user function to estimate R2eff and associated errors for exponential curve fitting. -->
<!--X-From-R13: "Sqjneq q'Ohiretar" &#60;rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Tue, 26 Aug 2014 10:06:08 +0200 -->
<!--X-Message-Id: CAED9pY_7c7ieieAERp61kvSPy0cgXnKyJsxzMbdrrrFsk6Un=A@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20140824&#45;155636.sv20529.53107@gna.org -->
<!--X-Reference: CAED9pY_puiVM6DoWtqoda8ZfVnWMbPEJcEcZZO4c209DWD0yaQ@mail.gmail.com -->
<!--X-Reference: CA+CBx2NHKXbVDKuAgevtx1syQqnWZPWNmuRJgHRuvt7z6obtkA@mail.gmail.com -->
<!--X-Reference: CAED9pY8vaV_gi4rc0vGAJFFQLrfAO09LL+GD=Vh20tMkkmSQEQ@mail.gmail.com -->
<!--X-Reference: CA+CBx2Pys_ewniR015rSvoO7JRuaCYM9OoCCcVQ06QVutt3jtw@mail.gmail.com -->
<!--X-Reference: CAED9pY_xJdMSZpt5MQm2DxcHUy5nCF+kf3i7+rPOM7Njvt=bJw@mail.gmail.com -->
<!--X-Reference: CA+CBx2O82OfpNVQhXPpcy7OrEG5L6_yaqw60sX4mpd=6uvdb0A@mail.gmail.com -->
<!--X-Reference: CAED9pY8UnNb08oJcLBbhZUvTh78qSdjpiF_w9720skoG0Pt+=g@mail.gmail.com -->
<!--X-Reference: CA+CBx2MBiFLu0C5tf1WEfPoMi_PqxXSBF5grjPuFcuUKH8Cd+w@mail.gmail.com -->
<!--X-Reference: CAED9pY&#45;PhATt930_2387GY0ALsrf5CtYQ&#45;NrUx6VD2+Z4YA&#45;tA@mail.gmail.com -->
<!--X-Reference: CAED9pY_9KE8tMFQQ16=Nb_9dWpd9mVVEZFKCL+tc_6tYKTMcdg@mail.gmail.com -->
<!--X-Reference: CAED9pY_k6OX_7BD9D0ERY2jmfO2obkvA49Jf5JYd8eWX+B+nQg@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [task #7822] Implement user function to estimate R2eff and associated errors for exponential curve fitting. -- August 26, 2014 - 10:06</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: [task #7822] Implement user function to estimate R2eff and associated errors for exponential curve fitting.</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00292" class="tabs">Index by Date</a> | <a href="threads.html#00292" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00291.html">Date Prev</a>] [<a href="msg00293.html">Date Next</a>] [<a href="msg00290.html">Thread Prev</a>] [<a href="msg00295.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Tue, 26 Aug 2014 10:05:36 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;Troels E. Linnet&quot; &lt;NO-REPLY.INVALID-ADDRESS@xxxxxxx&gt;, &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113; h=mime-version:sender:in-reply-to:references:date:message-id:subject :from:to:cc:content-type; bh=WxGkzMFY5jOgBHYrdBCqNLqObqXS8bLgpM+BJgiVmwo=; b=UpKMyegEqFNwqxa0tXmxb+X6mMnfNOHjQmB5PLBnL9o5ANMVeTsT3XOCstKD/2spnD mVtZ9WXrqNrxmlk43OoniiiTKS5zxiGCkUjvE4lIiVABXSJUicQvKfDd7g+arwbAqy7R fCfaD2+79tCY2bAfSUTtw/dC+4SnPuyV538nt4/b4V+7aL5XnJyqwzTlC/l1tkFJP89p wWyRqJmGCQvHJ1KpsMZ3ASvWMdxgiyI8NMMKWbqU1ZfI/xX9JZ53immKU30CdCdaZlgC 22ntIJpRXZrlTj6ZE92+DbVYzYyCw+vlpo+/+1WGd4/EFdsJATlCnbcFCOPMeiGoClDi mYFg==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;CAED9pY_7c7ieieAERp61kvSPy0cgXnKyJsxzMbdrrrFsk6Un=A@mail.gmail.com&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;<a href="msg00254.html">20140824-155636.sv20529.53107@gna.org</a>&gt; &lt;<a href="msg00264.html">CAED9pY_puiVM6DoWtqoda8ZfVnWMbPEJcEcZZO4c209DWD0yaQ@mail.gmail.com</a>&gt; &lt;<a href="msg00271.html">CA+CBx2NHKXbVDKuAgevtx1syQqnWZPWNmuRJgHRuvt7z6obtkA@mail.gmail.com</a>&gt; &lt;CAED9pY8vaV_gi4rc0vGAJFFQLrfAO09LL+GD=Vh20tMkkmSQEQ@mail.gmail.com&gt; &lt;<a href="msg00279.html">CA+CBx2Pys_ewniR015rSvoO7JRuaCYM9OoCCcVQ06QVutt3jtw@mail.gmail.com</a>&gt; &lt;CAED9pY_xJdMSZpt5MQm2DxcHUy5nCF+kf3i7+rPOM7Njvt=bJw@mail.gmail.com&gt; &lt;CA+CBx2O82OfpNVQhXPpcy7OrEG5L6_yaqw60sX4mpd=6uvdb0A@mail.gmail.com&gt; &lt;CAED9pY8UnNb08oJcLBbhZUvTh78qSdjpiF_w9720skoG0Pt+=g@mail.gmail.com&gt; &lt;<a href="msg00284.html">CA+CBx2MBiFLu0C5tf1WEfPoMi_PqxXSBF5grjPuFcuUKH8Cd+w@mail.gmail.com</a>&gt; &lt;<a href="msg00285.html">CAED9pY-PhATt930_2387GY0ALsrf5CtYQ-NrUx6VD2+Z4YA-tA@mail.gmail.com</a>&gt; &lt;CAED9pY_9KE8tMFQQ16=Nb_9dWpd9mVVEZFKCL+tc_6tYKTMcdg@mail.gmail.com&gt; &lt;<a href="msg00287.html">CAED9pY_k6OX_7BD9D0ERY2jmfO2obkvA49Jf5JYd8eWX+B+nQg@mail.gmail.com</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on August 26, 2014 - 10:06:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi Troels,

I would like to extend on this idea of a synthetic data set:

On 25 August 2014 19:15, Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

Maybe to help work out what is happing both in Scipy and in relax, a
simple test data set could be created.  For example if you set I0 to
1000, R to 1, and then pick the time points 0, 1, 2, 3, 4, you would
then have the intensity data:

0 1000.0
1 367.879441171
2 135.335283237
3 49.7870683679
4 18.3156388887

It might take some Bootstrapping simulations to obtain intensity
errors.  Just randomise I0 and R with a Gaussian distribution a large
number of times, then work out the intensity SD values for each time
point.

Then you could pass the data and errors into the Scipy and relax code
paths and see what you get for a covariance matrix.  That might show
if the double R2eff error is a bug or a failure of the covariance
matrix error estimate.  As it is synthetic data, you will know the
exact parameter values.  And you will know the exact error values to
search for in the covariance matrix.
</pre></blockquote><pre style="margin: 0em;">

This would really help you in understanding and debugging the problem,
if you were to create it.  Such data sets was how I implemented the
model-free analysis originally in relax.  With this data set, you can
directly calculate the numeric values of the elements of the Jacobian,
the chi-squared gradient, the chi-squared Hessian, and the covariance
matrix.  And this can be done both at the minimum where the gradient
should be zero (and the Hessian quadratic) but also as some {Rx, I0}
point in the space away from the minimum.  If you know the numeric
value of all elements, implementing and debugging is incredibly
simple!

There is another way which uses only the original exponential equation
and that is to use the Scipy QUADPACK interface to numerically
integrate the equation to estimate both the chi-squared gradient and
Hessian (the Jacobian and covariance matrix numeric values cannot be
found this way).  But this is much more complicated than calculating
it by hand.

Unfortunately my hand calculated gradients and Hessian values no
longer exist, so cannot be used as a reference.  Gary Thompson, and
Chris MacRaild, created the relax test suite a number of years after I
implemented the model-free, exponential curve-fitting and NOE
analyses.

Regards,

Edward


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00254" href="msg00254.html">[task #7822] Implement user function to estimate R2eff and associated errors for exponential curve fitting.</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00264" href="msg00264.html">Re: [task #7822] Implement user function to estimate R2eff and associated errors for exponential curve fitting.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00271" href="msg00271.html">Re: [task #7822] Implement user function to estimate R2eff and associated errors for exponential curve fitting.</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00272" href="msg00272.html">Re: [task #7822] Implement user function to estimate R2eff and associated errors for exponential curve fitting.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00279" href="msg00279.html">Re: [task #7822] Implement user function to estimate R2eff and associated errors for exponential curve fitting.</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00280" href="msg00280.html">Re: [task #7822] Implement user function to estimate R2eff and associated errors for exponential curve fitting.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00282" href="msg00282.html">Re: [task #7822] Implement user function to estimate R2eff and associated errors for exponential curve fitting.</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00283" href="msg00283.html">Re: [task #7822] Implement user function to estimate R2eff and associated errors for exponential curve fitting.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00284" href="msg00284.html">Re: [task #7822] Implement user function to estimate R2eff and associated errors for exponential curve fitting.</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00285" href="msg00285.html">Re: [task #7822] Implement user function to estimate R2eff and associated errors for exponential curve fitting.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00286" href="msg00286.html">Re: [task #7822] Implement user function to estimate R2eff and associated errors for exponential curve fitting.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00287" href="msg00287.html">Re: [task #7822] Implement user function to estimate R2eff and associated errors for exponential curve fitting.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Tue Aug 26 13:20:17 2014</div>  
</body>
</html>
