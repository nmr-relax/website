<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: r3080 &#45; /1.3/test_suite/unit_tests/unit_test_runner.py -->
<!--X-From-R13: "Unel E. Fubzcfba" <tnelgNozo.yrrqf.np.hx> -->
<!--X-Date: Tue, 06 Mar 2007 09:45:48 +0100 -->
<!--X-Message-Id: 45ED2A08.6090207@bmb.leeds.ac.uk -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: E1HO9rU&#45;0004g2&#45;14@subversion.gna.org -->
<!--X-Reference: 45EBEA6A.7030809@bmb.leeds.ac.uk -->
<!--X-Reference: 7f080ed10703052357i7fc20379n835048c0cc3c84c1@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: r3080 - /1.3/test_suite/unit_tests/unit_test_runner.py -- March 06, 2007 - 09:45</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: r3080 - /1.3/test_suite/unit_tests/unit_test_runner.py</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00008" class="tabs">Index by Date</a> | <a href="threads.html#00008" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00007.html">Date Prev</a>] [<a href="msg00009.html">Date Next</a>] [<a href="msg00005.html">Thread Prev</a>] [<a href="msg00009.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Tue, 06 Mar 2007 08:44:56 +0000</li>
<li class="menuitem">
<em>Cc</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00008.html">45ED2A08.6090207@bmb.leeds.ac.uk</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;E1HO9rU-0004g2-14@subversion.gna.org&gt;	&lt;<a href="msg00004.html">45EBEA6A.7030809@bmb.leeds.ac.uk</a>&gt;	&lt;<a href="msg00005.html">7f080ed10703052357i7fc20379n835048c0cc3c84c1@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>User-agent</em>: Mozilla Thunderbird 1.0 (X11/20041206)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Gary S. Thompson</strong> on March 06, 2007 - 09:45:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Edward d'Auvergne wrote:</pre><br>
<blockquote class="blockquote"><tt>The function arguments are definitely clearly described.  
</tt></blockquote><pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">oh good!</pre><br>
<blockquote class="blockquote"><pre style="margin: 0em;">Do you think
that the arguments of the command line usage of 'unit_test_runner.py'
should be sent in as the argument 'test_module' or the argument
'root_path'?  Is 'test_module' supposed to be a file name or module
name (eg. 'data/test_diff_tensor.py' vs 'data.test_diff_tensor')?
</pre></blockquote><pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">oh bad! obviously not quite well enough defined... a module name</pre><br>
<blockquote class="blockquote"><blockquote class="blockquote"><tt>From the parser usage string, I would assume the former.
</tt></blockquote><pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">For the argument 'rootSystemDirectory', could this not be changed to a
single string?  The second array element, the relative path, could
easily be determined by a function which converts all directories in
the first element to '..' (well actually 'os.pardir' to be
cross-platform compatible).  Oh, I just noticed but the directory
separators should be made OS independent and portable by using the
'sep' variable from the 'os' module.  It may be possible to also write
a function which determines these directories automatically, removing
the need for the argument (eg. walking up directories from os.getcwd()
until an executable file 'relax' is found).   Would it be possible to
determine the values of the 'root_unit_test_directory' argument
automatically as well?
</pre></blockquote><pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">There are a few things here</pre><br>
<tt>1. yes I should be using os.pardir() and I have bee trying to use 
os.sep, if it is missing its an oversight<br>
2. both the unit test funtion and the system directoy function pass into 
a general directory searcher<br>
 so the second argument is needed<br>
3. I could look for an executable relax file but I feel makes me more 
dystem dependant than looking for a directory structure</tt><br>
<br>
<blockquote class="blockquote"><tt><br>One last thing is do we need the 'test_pattern' argument?  I think we<br>
should enforce that unit test files must always start with 'test_' and<br>
end in '.py'.  Can you see exceptions to this rule requiring the<br>
argument?  
</tt></blockquote><pre style="margin: 0em;"><br></pre><br>
<tt>I don't in general see any exceptions to this rule , but I designed the 
setup to be general again. I guess the search string could be come an 
inrenal constant</tt><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">Also do you think that we should have a single unit test
file per relax module?  I can see value in not enforcing this rule.
For example the 'specific_fns.model_free' module contains a very large
number of class methods.  This could be better served by a directory
such as 'test_suite/unit_tests/specific_fns/model_free/' and allowing
that directory to have a separate unit test model per class methods
(each containing numerous tests of that one method).  As each relax
function or method will require numerous tests for proper functioning,
proper throwing of RelaxErrors, etc, the unit test modules could
become quite large and unwieldy, especially if the self.setUp and
self.tearDown() methods need to be different for different
functions/methods.</pre><br>
</blockquote><tt>It would be ideal to have one file per because then we can check for 
basic coverage and overlooked unit tests. However there is nothing to 
stop you adding imports to auxiliary classes to carry out the individual 
tests....</tt><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">Sorry about the large number of questions,</pre><br>
<pre style="margin: 0em;">Edward</pre><br>
</blockquote><pre style="margin: 0em;">no problem</pre><br>
<pre style="margin: 0em;">regards
gary</pre><br>
<blockquote class="blockquote"><pre style="margin: 0em;"><br>On 3/5/07, Gary S. Thompson &lt;garyt@xxxxxxxxxxxxxxx&gt; wrote:</pre><br>
<blockquote class="blockquote"><pre style="margin: 0em;">Dear All
as you can see I have updated the doc string for
Run_unit_tests.__init__ could you have a look and see if it makes sense
(the previous incarnation patently didn't ;-) )</pre><br>
<pre style="margin: 0em;">note:
1 Please note that of course the implementation is trailing the
documentation...
2. There are FIXMES  and other notes still floating around</pre><br>
<pre style="margin: 0em;">regards
gary</pre><br>
<pre style="margin: 0em;">garyt@xxxxxxxxxxxxxxx wrote:</pre><br>
<tt>&gt;Author: varioustoxins<br>
&gt;Date: Mon Mar  5 10:52:07 2007<br>
&gt;New Revision: 3080<br>
&gt;<br>
&gt;URL: <a  href="http://svn.gna.org/viewcvs/relax?rev=3080&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=3080&amp;view=rev</a><br>
&gt;Log:<br>
&gt;improve command line docs and doc string for Run_unit_tests.__init__<br>
&gt;<br>
&gt;<br>
&gt;Modified:<br>
&gt;    1.3/test_suite/unit_tests/unit_test_runner.py<br>
&gt;<br>
&gt;Modified: 1.3/test_suite/unit_tests/unit_test_runner.py<br>
&gt;URL: 
<a  href="http://svn.gna.org/viewcvs/relax/1.3/test_suite/unit_tests/unit_test_runner.py?rev=3080&amp;r1=3079&amp;r2=3080&amp;view=diff">http://svn.gna.org/viewcvs/relax/1.3/test_suite/unit_tests/unit_test_runner.py?rev=3080&amp;r1=3079&amp;r2=3080&amp;view=diff</a> </tt><br>
<br>
<tt>&gt;============================================================================== </tt><br>
<br>
<tt>&gt;--- 1.3/test_suite/unit_tests/unit_test_runner.py (original)<br>
&gt;+++ 1.3/test_suite/unit_tests/unit_test_runner.py Mon Mar  5 
10:52:07 2007<br>
&gt;@@ -56,9 +56,14 @@<br>
&gt;<br>
&gt; import os,re,unittest,string,sys<br>
&gt; from optparse import OptionParser<br>
&gt;+from textwrap import dedent<br>
&gt;<br>
&gt; #import Tkinter as tk<br>
&gt; #import unittest.unittestgui as unitgui<br>
&gt;+<br>
&gt;+# constants<br>
&gt;+###########<br>
&gt;+PY_FILE_EXTENSION='py'<br>
&gt;<br>
&gt; # utility functions<br>
&gt; ###################<br>
&gt;@@ -287,23 +292,27 @@<br>
&gt;<br>
&gt;           @type  root_path: a string containing a directory name<br>
&gt;           @param root_path: root path to start searching for 
modules to unit test<br>
&gt;-                 from usually this is the current working directory.<br>
&gt;+                 from. Two special cases arise: if the string 
contains '.'<br>
&gt;+                 the search starts from the current working 
directory, if the value is<br>
&gt;+                 the special value TEST_SUITE defined in this file 
the root of the<br>
&gt;+                 test suite is sought from the current working 
directory using<br>
&gt;+                 find_unit_test_directory_path() and used instead.<br>
&gt;<br>
&gt;           @type  test_module: string<br>
&gt;           @param test_module: the name of a module to unit test. If 
the variable<br>
&gt;-                 is None it will be interpreted as<br>
&gt;-                 the current working directory<br>
&gt;-                 contents. Otherwise it will be used as a module 
path from the<br>
&gt;+                 is None a search for unit tests using 
&lt;test-pattern&gt; will start<br>
&gt;+                 form &lt;root_path&gt;, otherwise it will be used as a 
module path from the<br>
&gt;                  current working directory.<br>
&gt;<br>
&gt;-          @type  test_pattern: a list of strings containing patterns<br>
&gt;-          @param test_pattern: a list of patterns against which 
files will be<br>
&gt;+          FIXME: rename as testcase_file_pattern<br>
&gt;+          @type  test_pattern: a list of strings containing regex 
patterns<br>
&gt;+          @param test_pattern: a list of regex patterns against 
which files will be<br>
&gt;                  tested to see if they are expected to contain unit 
tests. If<br>
&gt;-                 the file has the correct pattern the class<br>
&gt;-                 &lt;fileName&gt;.&lt;capitalisedFileName&gt; will be searched for<br>
&gt;-                 testCases e.g in the case of test_float.py the 
combination<br>
&gt;-                 would be test_float.Test_float.<br>
&gt;-<br>
&gt;+                 the file has the correct pattern the module 
contained inside the<br>
&gt;+                 file will be searched for testCases e.g in the 
case of test_float.py<br>
&gt;+                 the  module to be searched for would be 
test_float.Test_float.<br>
&gt;+<br>
&gt;+          FIXME: the following to options are search paths and 
should be named so<br>
&gt;           @type  rootSystemDirectory: a list containing a directory 
name followed by a<br>
&gt;                  relative path<br>
&gt;           @param rootSystemDirectory: the directory from which the 
distribution<br>
&gt;@@ -312,13 +321,16 @@<br>
&gt;                  relative to the test suite. For the current setup<br>
&gt;                  in relax this is (\'test_suite\', /'..\'). The 
first string is a<br>
&gt;                  directory to match the second string is a relative 
path from that<br>
&gt;-                 directory to the system directory<br>
&gt;+                 directory to the system directory. The search is 
started from the true<br>
&gt;+                 value of root_path in the file system.<br>
&gt;<br>
&gt;           @type  root_unit_test_directory: a list containing a 
directory name followed by a<br>
&gt;                  relative path<br>
&gt;           @param root_unit_test_directory: the directory from which 
all unit<br>
&gt;                  module directories descend. For the current setup 
in relax<br>
&gt;-                 this is (\'unit_tests\', \'.\').<br>
&gt;+                 this is (\'unit_tests\', \'.\'). The search is 
started from the true<br>
&gt;+                 value of root_path in the file system.<br>
&gt;+<br>
&gt;           @type  verbose: Boolean<br>
&gt;           @param verbose: produce verbose output during testing 
e.g. directories<br>
&gt;                  searched root directories etc<br>
&gt;@@ -431,6 +443,7 @@<br>
&gt;         elems = python_module_path.split('.')<br>
&gt;         return os.sep.join(elems)<br>
&gt;<br>
&gt;+# FIXME: logic error two uses for self.testModule<br>
&gt;     def paths_from_test_module(self, root_path):<br>
&gt;         '''Determine the possible path of the self.test_module.<br>
&gt;<br>
&gt;@@ -441,6 +454,7 @@<br>
&gt;                2. the rootPath itself (self.testModule ==  None)<br>
&gt;                3. a file or directory relative to the unitTestRootPath<br>
&gt;                4. the unit test directory itself (self.testModule 
==  None)<br>
&gt;+<br>
&gt;<br>
&gt;            currently this assumes that if the last two names in 
testModule are<br>
&gt;            the same barring an initial  capital letter in the class 
name<br>
&gt;@@ -559,7 +573,33 @@<br>
&gt;<br>
&gt;     parser.add_option(&quot;-v&quot;, &quot;--verbose&quot;, dest=&quot;verbose&quot;,<br>
&gt;                       help=&quot;verbose test ouput&quot;, default=False, 
action='store_true')<br>
&gt;+<br>
&gt;+    usage=&quot;&quot;&quot;<br>
&gt;+    %%prog [options] [&lt;file-or-dir&gt;...]<br>
&gt;+<br>
&gt;+      a program to find and run subsets of the relax unit test 
suite using pyunit.<br>
&gt;+      (details of how to write pyunit tests can be found in your 
python distributions<br>
&gt;+      library reference)<br>
&gt;+<br>
&gt;+<br>
&gt;+    arguments:<br>
&gt;+      &lt;file-or-dir&gt; = &lt;file-path&gt; | &lt;dir-path&gt; is a list which can 
contain<br>
&gt;+                      inter-mixed directories and files<br>
&gt;+<br>
&gt;+      &lt;file-path&gt;  =  a file containing a test case class files of 
the same<br>
&gt;+                      name with the first letter capitalised<br>
&gt;+<br>
&gt;+                      e.g. maths_fns/test_chi2.py will be assumed 
to contain<br>
&gt;+                      a test case class called Test_chi2<br>
&gt;+<br>
&gt;+      &lt;dir-path&gt;   =  a path which will be recursivley searched for 
&lt;file-path&gt;s<br>
&gt;+                      which end in %s<br>
&gt;+      &quot;&quot;&quot; % PY_FILE_EXTENSION<br>
&gt;+<br>
&gt;+    parser.set_usage(dedent(usage))<br>
&gt;+<br>
&gt;     (options, args) = parser.parse_args()<br>
&gt;+<br>
&gt;<br>
&gt;     for arg in args:<br>
&gt;         runner = Run_unit_tests(test_module=arg, 
verbose=options.verbose)<br>
&gt;<br>
&gt;<br>
&gt;_______________________________________________<br>
&gt;relax (<a  href="http://nmr-relax.com">http://nmr-relax.com</a>)<br>
&gt;<br>
&gt;This is the relax-commits mailing list<br>
&gt;relax-commits@xxxxxxx<br>
&gt;<br>
&gt;To unsubscribe from this list, get a password<br>
&gt;reminder, or change your subscription options,<br>
&gt;visit the list information page at<br>
&gt;<a  href="https://mail.gna.org/listinfo/relax-commits">https://mail.gna.org/listinfo/relax-commits</a><br>
&gt;<br>
&gt;.<br>
&gt;<br>
&gt;<br>
&gt;</tt><br>
<br>
<pre style="margin: 0em;"><br>--
-------------------------------------------------------------------
Dr Gary Thompson
Astbury Centre for Structural Molecular Biology,
University of Leeds, Astbury Building,
Leeds, LS2 9JT, West-Yorkshire, UK             Tel. +44-113-3433024
email: garyt@xxxxxxxxxxxxxxx                   Fax  +44-113-2331407
-------------------------------------------------------------------</pre><br>
<pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">_______________________________________________
relax (<a  href="http://nmr-relax.com">http://nmr-relax.com</a>)</pre><br>
<pre style="margin: 0em;">This is the relax-devel mailing list
relax-devel@xxxxxxx</pre><br>
<pre style="margin: 0em;">To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  href="https://mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a></pre><br>
</blockquote><pre style="margin: 0em;"><br>.</pre><br>
</blockquote><pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">--
-------------------------------------------------------------------
Dr Gary Thompson
Astbury Centre for Structural Molecular Biology,
University of Leeds, Astbury Building,
Leeds, LS2 9JT, West-Yorkshire, UK             Tel. +44-113-3433024
email: garyt@xxxxxxxxxxxxxxx                   Fax  +44-113-2331407
-------------------------------------------------------------------</pre><br>
<pre style="margin: 0em;"><br></pre><br>
<br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00011" href="msg00011.html">Re: r3080 - /1.3/test_suite/unit_tests/unit_test_runner.py</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00009" href="msg00009.html">Re: r3080 - /1.3/test_suite/unit_tests/unit_test_runner.py</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00004" href="msg00004.html">Re: r3080 - /1.3/test_suite/unit_tests/unit_test_runner.py</a></strong>
<ul><li><em>From:</em> Gary S. Thompson</li></ul></li>
<li><strong><a name="00005" href="msg00005.html">Re: r3080 - /1.3/test_suite/unit_tests/unit_test_runner.py</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Wed Mar 07 08:40:25 2007</div>  
</body>
</html>
