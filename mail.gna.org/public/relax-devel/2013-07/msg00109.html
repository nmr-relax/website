<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: Implementation of the Schanda, Lescanne and Marion numeric	dispersion model code in relax. -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Tue, 23 Jul 2013 12:17:39 +0200 -->
<!--X-Message-Id: CAED9pY9JKadTPZ2Ch1&#45;U1UC5mN3fkre7Jx+h1cWQ8Gzo8DE2MQ@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: CAED9pY_cvrHQ+vDOSStAxsBunzkoUXXkWAxN9qda&#45;Xg2qbC6rg@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Implementation of the Schanda, Lescanne and Marion numeric	dispersion model code in relax. -- July 23, 2013 - 12:17</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Implementation of the Schanda, Lescanne and Marion numeric	dispersion model code in relax.</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00109" class="tabs">Index by Date</a> | <a href="threads.html#00109" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00108.html">Date Prev</a>] [<a href="msg00110.html">Date Next</a>] [<a href="msg00101.html">Thread Prev</a>] [<a href="msg00113.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Tue, 23 Jul 2013 12:17:08 +0200</li>
<li class="menuitem">
<em>Cc</em>: Dominique Marion &lt;Dominique.Marion@xxxxxx&gt;,	mathilde lescanne &lt;mathilde.lescanne@xxxxxxxxx&gt;,	Paul Schanda &lt;paul.schanda@xxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113;	h=mime-version:sender:in-reply-to:references:date	:x-google-sender-auth:message-id:subject:from:to:cc:content-type;	bh=SKWv8xQl6k/liBq0rsHWRecP4eIA1rpqVS14S0z/V0c=;	b=ia96Z/C6VuYaew72b0gNsmZvJDdFcPciUK/kcXF0EFSPAq3969KPB9DSWAGyWMqoTN	WHa5OP/laz9PhEYAJYcv1XRQAWl/+pIxR0cKBxdkxz6UK7VA9CtMPPRcnzvDNNi2DqVB	WPpmhc6thbOiIgR/s3HTNq5xnajjNN1MMO202R4hZLeNjx9/bLqAn75C8Ix9JLha3InN	xQLsHYyxGfu7j04d65NNSXzcoYBWWeR821HNiWODtAWx7oN+30E6fzbaIWm8a0jP4bX6	xOhMDT3FGOnFjSaGBHJPwCoB561NY4+XHuTXZ/Y5Fp65phpPGNtCisnqtnd6NgeIIW0q	BbFQ==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00109.html">CAED9pY9JKadTPZ2Ch1-U1UC5mN3fkre7Jx+h1cWQ8Gzo8DE2MQ@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;CAED9pY_cvrHQ+vDOSStAxsBunzkoUXXkWAxN9qda-Xg2qbC6rg@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on July 23, 2013 - 12:17:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi,

I forgot to mention how I validated that the numeric model code in
relax is functional and finding the correct result.  I would have
liked to compare the results with Flemming Hansen's CATIA program
(<a  rel="nofollow" href="http://www.biochem.ucl.ac.uk/hansen/catia/">http://www.biochem.ucl.ac.uk/hansen/catia/</a>), but this relax export
function is not implemented yet (unlike those for CMPGFit, ShereKhan,
and NESSY).  I therefore compared the results to those of the Carver
and Richards (CR72) analytic model using Flemming Hansen's data from
his 2008 J. Phys. Chem. B paper (<a  rel="nofollow" href="http://dx.doi.org/10.1021/jp074793o">http://dx.doi.org/10.1021/jp074793o</a>).
 For residues 70 and 71, the analytic CR72 model results from the
various programs and the numeric relax results are:


The CR72 model
==============


Residue :70
-----------

Param       relax       NESSY       CPMGFit     ShereKhan
R2 (500)        7.011       7.236       6.263       7.011
R2 (800)        9.465      10.027       6.263       9.465
pA              0.990       0.989       0.978       0.990
dw              5.577       5.373       0.937       5.577
kex          1765.993    1522.059       1.774    1765.988
chi2           18.450       7.701      65.237      18.450


Residue :71
-----------

Param       relax       NESSY       CPMGFit     ShereKhan
R2 (500)        4.978           -       4.983       4.978
pA              0.997           -       0.994       0.997
dw              4.460           -       0.757       4.461
kex          1879.584           -       0.896    1879.618
chi2            1.379           -       1.382       1.379


The numeric models in relax
===========================

Residue :70
-----------

Param     NS 2-site 3D  NS 2-site expanded   NS 2-site star
R2 (500)         6.996               6.996            6.996
R2 (800)         9.453               9.453            9.453
pA               0.990               0.990            0.990
dw               5.645               5.645            5.645
kex           1723.443            1723.443         1723.078
chi2            18.098              18.098           18.098


Residue :71
-----------

Param     NS 2-site 3D  NS 2-site expanded   NS 2-site star
R2 (500)         4.980               4.980            4.980
pA               0.997               0.997            0.997
dw               4.629               4.629            4.629
kex           1805.665            1805.676         1805.110
chi2             1.371               1.371            1.371


This comes from the
test_suite/shared_data/dispersion/Hansen/software_comparison file.
For these residues, you can see that the CR72 and numeric results are
very similar.  It could be hard to argue that they are statistically
different.  But this shows that the code is functioning perfectly.

Regards,

Edward



On 23 July 2013 09:28, Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

The 2-site numeric dispersion models for CPMG data are now fully functional
within relax!  The following describes how these are implemented in relax
(to be permanently archived at
<a  rel="nofollow" href="http://dir.gmane.org/gmane.science.nmr.relax.devel">http://dir.gmane.org/gmane.science.nmr.relax.devel</a>).  I hope that you will
check all of this by running relax and seeing for yourself.  I also have a
few questions below.  Note that the code is in the relax_disp branch of the
source code repository and that there is no official release at
<a  rel="nofollow" href="http://www.nmr-relax.com/download.html">http://www.nmr-relax.com/download.html</a> yet.

I have documented the numeric models now present in relax in Chapter 10 of
the user manual.  I have compiled the current manual for the branch and
uploaded it to <a  rel="nofollow" href="http://download.gna.org/relax/manual/relax_disp_manual.pdf">http://download.gna.org/relax/manual/relax_disp_manual.pdf</a>.
Please have a look and see what you think.  The text is extremely minimal
and needs to be expanded.  If you have any suggestions or additional
material (equations, figures, etc., and in LaTeX preferably), it would be
happily accepted.  For example equations for the matrices and the
propagation used.  The aim is to be a complete stand-alone relaxation
dispersion reference for the users, pointing them to all the relevant
literature at all possible points.  Cheers!

As a summary, from the relax_disp.select_model user function description,
the numeric models are:

    'NS 2-site 3D':  The reduced numerical solution for the 2-site
Bloch-McConnell equations using 3D magnetisation vectors whereby the
simplification R20A = R20B is assumed.  Its parameters are {R20, ..., pA,
dw, kex}.

    'NS 2-site 3D full':  The full numerical solution for the 2-site
Bloch-McConnell equations using 3D magnetisation vectors.  Its parameters
are {R20A, R20B, ..., pA, dw, kex}.

    'NS 2-site star':  The reduced numerical solution for the 2-site
Bloch-McConnell equations using complex conjugate matrices whereby the
simplification R20A = R20B is assumed.  It has the parameters {R20, ..., pA,
dw, kex}.

    'NS 2-site star full':  The full numerical solution for the 2-site
Bloch-McConnell equations using complex conjugate matrices with parameters
{R20A, R20B, ..., pA, dw, kex}.

    'NS 2-site expanded':  The numerical solution for the 2-site
Bloch-McConnell equations expanded using Maple by Nikolai Skrynnikov.  It
has the parameters {R20, ..., pA, dw, kex}.

I would be interested to hear if you have suggestions for saner model names.

In the auto-analysis in relax - the blackbox analysis script to make the
lives of users extremely easy - the *full models are not turned on by
default.  If curious, you can see auto-analysis script in the file
auto_analyses/relax_disp.py.  The auto-analysis script is normally hidden
from the user.  Also, please run the relax GUI with:

$ relax --gui

and start the relaxation dispersion analysis to see how it is implemented.
Note that the auto-analyses are used for the operation of all GUI analyses.
Using scripts, the relax user is free to do anything they wish and implement
any protocol they can imagine (if useful for other users, these can then be
converted into an auto-analysis).

Part of the auto-analysis that I have implemented is the concept of using
optimised parameters from a simpler or equivalent model to speed up
optimisation by avoiding an expensive grid search.  For the 'full' models
above, I use the parameters of the simpler model and start with R20A = R20B
= R20.  Then, during optimisation, R20A and R20B diverge.

For the model equivalence, this is a bit different.  I use the optimised
parameter values from the analytic Carver and Richards model (CR72) as the
starting parameters for the 'NS 2-site 3D', 'NS 2-site star' and 'NS 2-site
expanded' models.  This avoids the grid search and really speeds up the
optimisation by orders of magnitude.  It can be done because the CR72
results are often very similar to the numeric results.  And even a failed
CR72 solution is close enough to the minima to be used as a starting point
for the numeric models.

I have a few other implementation questions, but I'll send these in a
different message for saner threads in the mailing list archives.

Cheers,

Edward


P. S.  Actually, I might take some of this text into the relax manual :)
</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00113" href="msg00113.html">Re: Implementation of the Schanda,	Lescanne and Marion numeric dispersion model code in relax.</a></strong>
<ul><li><em>From:</em> Paul Schanda</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00097" href="msg00097.html">Implementation of the Schanda, Lescanne and Marion numeric dispersion	model code in relax.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Tue Jul 23 13:20:08 2013</div>  
</body>
</html>
