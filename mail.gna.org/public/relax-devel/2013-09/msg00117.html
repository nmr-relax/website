<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: [sr #3071] Implementation of Tollinger/Kay dispersion model (2001) -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Tue, 10 Sep 2013 13:35:45 +0200 -->
<!--X-Message-Id: CAED9pY_QjXorGYywe4M_JXHQ61icL+1WKCuqPCSXwcwOAnjA1g@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20130817&#45;121906.sv20529.33791@gna.org -->
<!--X-Reference: 20130817&#45;130317.sv20529.86053@gna.org -->
<!--X-Reference: 20130817&#45;194759.sv20529.14461@gna.org -->
<!--X-Reference: 20130818&#45;180809.sv20529.99171@gna.org -->
<!--X-Reference: 20130820&#45;192858.sv20529.11242@gna.org -->
<!--X-Reference: 20130826&#45;144015.sv20529.53054@gna.org -->
<!--X-Reference: 20130826&#45;145816.sv2782.75054@gna.org -->
<!--X-Reference: 20130902&#45;131641.sv20529.61571@gna.org -->
<!--X-Reference: 20130902&#45;132317.sv20529.8263@gna.org -->
<!--X-Reference: 20130903&#45;063614.sv20529.56559@gna.org -->
<!--X-Reference: 20130903&#45;150002.sv20529.78667@gna.org -->
<!--X-Reference: 20130903&#45;150037.sv20529.73473@gna.org -->
<!--X-Reference: 20130903&#45;161822.sv20529.71876@gna.org -->
<!--X-Reference: 20130904&#45;112339.sv20529.2174@gna.org -->
<!--X-Reference: 20130904&#45;115721.sv20529.34751@gna.org -->
<!--X-Reference: 20130904&#45;132009.sv20529.18963@gna.org -->
<!--X-Reference: 20130904&#45;134717.sv20529.6289@gna.org -->
<!--X-Reference: 20130906&#45;073527.sv20529.76828@gna.org -->
<!--X-Reference: 20130906&#45;093233.sv20529.36161@gna.org -->
<!--X-Reference: 20130906&#45;114318.sv20529.62161@gna.org -->
<!--X-Reference: 20130906&#45;123652.sv20529.49677@gna.org -->
<!--X-Reference: 20130906&#45;131618.sv20529.38415@gna.org -->
<!--X-Reference: 20130906&#45;150146.sv20529.11716@gna.org -->
<!--X-Reference: 20130909&#45;151719.sv20529.4225@gna.org -->
<!--X-Reference: 20130909&#45;192940.sv20529.95343@gna.org -->
<!--X-Reference: 20130909&#45;200743.sv20529.83240@gna.org -->
<!--X-Reference: 20130910&#45;064310.sv2782.58182@gna.org -->
<!--X-Reference: 20130910&#45;102954.sv20529.53517@gna.org -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [sr #3071] Implementation of Tollinger/Kay dispersion model (2001) -- September 10, 2013 - 13:35</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: [sr #3071] Implementation of Tollinger/Kay dispersion model (2001)</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00117" class="tabs">Index by Date</a> | <a href="threads.html#00117" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00116.html">Date Prev</a>] [<a href="msg00118.html">Date Next</a>] [<a href="msg00116.html">Thread Prev</a>] [<a href="msg00118.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Troels E. Linnet&quot; &lt;NO-REPLY.INVALID-ADDRESS@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Tue, 10 Sep 2013 13:35:12 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113;	h=mime-version:sender:in-reply-to:references:date:message-id:subject	:from:to:cc:content-type;	bh=G6JJvS313ND/RfsJkppav2Q1ywpwQVpaK7gopf3z2BA=;	b=USppa6vc7vcIRTOvjKiga5lv4JfXvgo/RRHdRrogRfpz1d/szWDOC2d9T/PekqArMl	kggBaXUbismEwPAqtGfzEN9eGiuCMHyr2fOK1YKlOW3XtpBW0eUeFmodW4leZvCqwXHv	HghZH9Vf2VzGgq3Nd2i0owKQmVXSfgSFEVS3DoZReJsy5MrwoEhm7w8lxMMeRNttdFqn	F4fnPptqR2hX4ehpBsOjSNQHLopGmi6h/zyQuAhD8u6ltMuqgBA0jecwXVXOKdecAQU/	RgyB0002c7pKavskXLOtBGMvYgdSG1DX9aBdeZ5jGmplWZ09w6PDqth2pinkrhSsI2DK	Y+Ug==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00117.html">CAED9pY_QjXorGYywe4M_JXHQ61icL+1WKCuqPCSXwcwOAnjA1g@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;20130817-121906.sv20529.33791@xxxxxxx&gt;	&lt;20130817-130317.sv20529.86053@xxxxxxx&gt;	&lt;20130817-194759.sv20529.14461@xxxxxxx&gt;	&lt;20130818-180809.sv20529.99171@xxxxxxx&gt;	&lt;20130820-192858.sv20529.11242@xxxxxxx&gt;	&lt;20130826-144015.sv20529.53054@xxxxxxx&gt;	&lt;20130826-145816.sv2782.75054@xxxxxxx&gt;	&lt;20130902-131641.sv20529.61571@xxxxxxx&gt;	&lt;20130902-132317.sv20529.8263@xxxxxxx&gt;	&lt;20130903-063614.sv20529.56559@xxxxxxx&gt;	&lt;20130903-150002.sv20529.78667@xxxxxxx&gt;	&lt;20130903-150037.sv20529.73473@xxxxxxx&gt;	&lt;20130903-161822.sv20529.71876@xxxxxxx&gt;	&lt;20130904-112339.sv20529.2174@xxxxxxx&gt;	&lt;20130904-115721.sv20529.34751@xxxxxxx&gt;	&lt;20130904-132009.sv20529.18963@xxxxxxx&gt;	&lt;20130904-134717.sv20529.6289@xxxxxxx&gt;	&lt;20130906-073527.sv20529.76828@xxxxxxx&gt;	&lt;20130906-093233.sv20529.36161@xxxxxxx&gt;	&lt;20130906-114318.sv20529.62161@xxxxxxx&gt;	&lt;20130906-123652.sv20529.49677@xxxxxxx&gt;	&lt;20130906-131618.sv20529.38415@xxxxxxx&gt;	&lt;20130906-150146.sv20529.11716@xxxxxxx&gt;	&lt;20130909-151719.sv20529.4225@xxxxxxx&gt;	&lt;20130909-192940.sv20529.95343@xxxxxxx&gt;	&lt;20130909-200743.sv20529.83240@xxxxxxx&gt;	&lt;20130910-064310.sv2782.58182@xxxxxxx&gt;	&lt;20130910-102954.sv20529.53517@xxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on September 10, 2013 - 13:35:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi,

I'm looking at your patches and here are some comments.  Unfortunately
every patch needs either some refinement, or the concept needs to be
changed:

0001-Added-the-write-out-of-dw-and-k_AB-for-model-TSMFK01.patch - Not
applied as the MODEL_TSMFK01 variable is duplicated in one place.
This is an easy fix.

0002-Added-the-spin.model-when-writing-out-parameters.patch - Not
applied as the correct way would be to send the models in as the
'data' argument.  This is a generic function for any type of data
associated with a spin system.  This can be any NMR parameter, data,
or spin associated concept you can imagine.  Therefore adding
arguments for different bits of information, such as model
information, is not how to keep the function general.  Such spin
associated information is what the 'data' argument is for.  This patch
is the easiest way to have this information sent to a file, but it is
a very undesirable solution.  If needed, this should probably be
discussed in a new thread.

0003-Re-inserted-the-writeout-of-the-r2-and-r2a-parameter.patch - Not
applied as this is currently fatal.  This can be seen by running the
Relax_disp.test_hansen_cpmg_data_auto_analysis system test.  It would
be best to add the infrastructure to support this first.  The lines
can be uncommented to aid development, but it should not be committed
yet.  I have commented the lines out exactly because they are
currently fatal.

0004-Added-to-calculate-the-tau_cpmg-times-when-model-is-.patch - Not
applied due to code repetition, the same self.tau_cpmg is generated a
few lines below.  Code repetition should always be avoided as this
results in a debugging nightmare.  The two instances of self.tau_cpmg
being set up might be separated in the future (this will happen if the
__init__() method becomes too long, for example).  And the code might
change, as code always does, but only in one location.  This is
dangerous!  I would suggest having only one &quot;if model in [...]&quot;
statement for the self.tau_cpmg data structure, i.e. separate it out
from the self.power structure.  Therefore there would be one if block
for tau_cpmg, and one if block for the matrix exponential power data
structure - each being generated for a different set of models.

0005-Optimized-the-target-function-for-model-TSMFK.patch - Not applied
as there can be slight improvements.  The line tau_CP = tcp[i] is not
needed, simply use tcp[i] when it is needed.  This Python operation
will cause memory to be allocated to the tau_CP variable, the value
from the numpy data structure copied to the new memory location, and
then that memory destroyed in the next iteration of the loop or when
the function is exited.  There's no need to slow the optimisation for
this.  Such operations might exist in other modules of lib.dispersion,
but they should all be eliminated.  Another point about the patch is
that the indentation for the epydoc arguments in the docstring does
not line up.

0006-Added-the-conversion-to-k_AB-from-kex-and-pA.-k_AB-k.patch - Also
not applied :S  This commit is very close though.  For the mathematics
operations, please replace '1' with '1.0'.  This avoids Python type
conversions (from int to float).

Cheers,

Edward



On 10 September 2013 12:29, Troels E. Linnet
&lt;NO-REPLY.INVALID-ADDRESS@xxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Follow-up Comment #69, sr #3071 (project relax):

Modified write out functions for parameters and optimized the target 
function.

(file #18955)
    _______________________________________________________

Additional Item Attachment:

File name: write_out_patches.patch.tar.gz Size:5 KB


    _______________________________________________________

Reply to this item at:

  &lt;<a  rel="nofollow" href="http://gna.org/support/?3071">http://gna.org/support/?3071</a>&gt;

_______________________________________________
  Message sent via/by Gna!
  <a  rel="nofollow" href="http://gna.org/">http://gna.org/</a>


_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-devel mailing list
relax-devel@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a>
</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00013" href="msg00013.html">[sr #3071] Implementation of Tollinger/Kay dispersion model (2001)</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00014" href="msg00014.html">[sr #3071] Implementation of Tollinger/Kay dispersion model (2001)</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00024" href="msg00024.html">[sr #3071] Implementation of Tollinger/Kay dispersion model (2001)</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00034" href="msg00034.html">[sr #3071] Implementation of Tollinger/Kay dispersion model (2001)</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00035" href="msg00035.html">[sr #3071] Implementation of Tollinger/Kay dispersion model (2001)</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00039" href="msg00039.html">[sr #3071] Implementation of Tollinger/Kay dispersion model (2001)</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00051" href="msg00051.html">[sr #3071] Implementation of Tollinger/Kay dispersion model (2001)</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00054" href="msg00054.html">[sr #3071] Implementation of Tollinger/Kay dispersion model (2001)</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00058" href="msg00058.html">[sr #3071] Implementation of Tollinger/Kay dispersion model (2001)</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00061" href="msg00061.html">[sr #3071] Implementation of Tollinger/Kay dispersion model (2001)</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00067" href="msg00067.html">[sr #3071] Implementation of Tollinger/Kay dispersion model (2001)</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00071" href="msg00071.html">[sr #3071] Implementation of Tollinger/Kay dispersion model (2001)</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00076" href="msg00076.html">[sr #3071] Implementation of Tollinger/Kay dispersion model (2001)</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00079" href="msg00079.html">[sr #3071] Implementation of Tollinger/Kay dispersion model (2001)</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00081" href="msg00081.html">[sr #3071] Implementation of Tollinger/Kay dispersion model (2001)</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00085" href="msg00085.html">[sr #3071] Implementation of Tollinger/Kay dispersion model (2001)</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00093" href="msg00093.html">[sr #3071] Implementation of Tollinger/Kay dispersion model (2001)</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00098" href="msg00098.html">[sr #3071] Implementation of Tollinger/Kay dispersion model (2001)</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00101" href="msg00101.html">[sr #3071] Implementation of Tollinger/Kay dispersion model (2001)</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00105" href="msg00105.html">[sr #3071] Implementation of Tollinger/Kay dispersion model (2001)</a></strong>
<ul><li><em>From:</em> Edward d Auvergne</li></ul></li>
<li><strong><a name="00116" href="msg00116.html">[sr #3071] Implementation of Tollinger/Kay dispersion model (2001)</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Tue Sep 10 14:40:08 2013</div>  
</body>
</html>
