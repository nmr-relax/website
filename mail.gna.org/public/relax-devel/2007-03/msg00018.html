<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: Multiple test cases and the splitting up of large modules. -->
<!--X-From-R13: "Unel E. Fubzcfba" <tnelgNozo.yrrqf.np.hx> -->
<!--X-Date: Thu, 08 Mar 2007 09:29:44 +0100 -->
<!--X-Message-Id: 45EFC94F.6000101@bmb.leeds.ac.uk -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: E1HO9rU&#45;0004g2&#45;14@subversion.gna.org -->
<!--X-Reference: 45EBEA6A.7030809@bmb.leeds.ac.uk -->
<!--X-Reference: 7f080ed10703052357i7fc20379n835048c0cc3c84c1@mail.gmail.com -->
<!--X-Reference: 45ED2A08.6090207@bmb.leeds.ac.uk -->
<!--X-Reference: 1173174583.8066.223.camel@mrspell -->
<!--X-Reference: 1173248473.29411.21.camel@pc172&#45;31&#45;2&#45;63.biochem.unimelb.edu.au -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Multiple test cases and the splitting up of large modules. -- March 08, 2007 - 09:29</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Multiple test cases and the splitting up of large modules.</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00018" class="tabs">Index by Date</a> | <a href="threads.html#00018" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00017.html">Date Prev</a>] [<a href="msg00019.html">Date Next</a>] [<a href="msg00010.html">Thread Prev</a>] [<a href="msg00021.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Edward d'Auvergne &lt;edward.dauvergne@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Thu, 08 Mar 2007 08:29:03 +0000</li>
<li class="menuitem">
<em>Cc</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00018.html">45EFC94F.6000101@bmb.leeds.ac.uk</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;E1HO9rU-0004g2-14@subversion.gna.org&gt;	&lt;<a href="msg00004.html">45EBEA6A.7030809@bmb.leeds.ac.uk</a>&gt;	&lt;<a href="msg00005.html">7f080ed10703052357i7fc20379n835048c0cc3c84c1@mail.gmail.com</a>&gt;	&lt;<a href="msg00008.html">45ED2A08.6090207@bmb.leeds.ac.uk</a>&gt;	&lt;<a href="msg00009.html">1173174583.8066.223.camel@mrspell</a>&gt;	&lt;<a href="msg00010.html">1173248473.29411.21.camel@pc172-31-2-63.biochem.unimelb.edu.au</a>&gt;</li>
<li class="menuitem">
<em>User-agent</em>: Mozilla Thunderbird 1.0 (X11/20041206)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Gary S. Thompson</strong> on March 08, 2007 - 09:29:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Edward d'Auvergne wrote:</pre><br>
<blockquote class="blockquote"><tt>On Tue, 2007-03-06 at 09:49 +0000, Chris MacRaild wrote:<br>
 </tt><br>
<br>
<blockquote class="blockquote"><tt>On Tue, 2007-03-06 at 08:44 퍍㐙ꫲ S. Thompson wrote:<br>
   </tt><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">Edward d'Auvergne wrote:</pre><br>
<tt>     </tt><br>
<br>
</blockquote><tt>snip<br>
   </tt><br>
<br>
<blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">Also do you think that we should have a single unit test
file per relax module?  I can see value in not enforcing this rule.
For example the 'specific_fns.model_free' module contains a very large
number of class methods.  This could be better served by a directory
such as 'test_suite/unit_tests/specific_fns/model_free/' and allowing
that directory to have a separate unit test model per class methods
(each containing numerous tests of that one method).  As each relax
function or method will require numerous tests for proper functioning,
proper throwing of RelaxErrors, etc, the unit test modules could
become quite large and unwieldy, especially if the self.setUp and
self.tearDown() methods need to be different for different
functions/methods.</pre><br>
<tt>       </tt><br>
<br>
</blockquote><tt>It would be ideal to have one file per because then we can check for 
basic coverage and overlooked unit tests. However there is nothing to 
stop you adding imports to auxiliary classes to carry out the individual 
tests....</tt><br>
<br>
<tt>     </tt><br>
<br>
</blockquote><tt>Although I take the point about multiple tests, setUps and tearDowns per<br>
method, I'd generally suggest that if the unit test file is getting too<br>
unwieldy, the related module probably is too. So perhaps we should<br>
enforce this rule, and split modules when neccessary, not split unit<br>
test files. (still more work, still more breakages, but that might be<br>
the cost of a manageable code base)<br>
   </tt><br>
<br>
</blockquote><pre style="margin: 0em;"><br></pre><br>
<tt>We could have multiple test case classes derived from TestCase within<br>
the single module file (corresponding to the single relax source<br>
file).  That way we can, if needed, have one class per function. I<br>
think this is really important as the data structures, etc that need to<br>
be created for that one function will be different to what is needed<br>
for another function (if common self.setUp() and self.tearDown()<br>
methods are needed for different functions, we can simply use<br>
inheritance or the same class).  For example the setUp() for the<br>
'calc_jw()' function of the module 'maths_fns.jw_mf.py' may need to be<br>
different to that of the subsequent function 'calc_S2_jw()' (then again<br>
maybe not).  In fact each of the 128 functions in that single module<br>
may need different setUp() and tearDown() methods (that code was an<br>
absolute nightmare to debug back in 2003, but this setup is very<br>
important for numerical efficiency).  A better example might be the<br>
'self.execute()' and 'self.create()' methods of the module<br>
'generic_fns.dasha' which execute Dasha and create Dasha input files<br>
respectively.  The tearDown() method for the input file creation tests<br>
will require the deletion of the temporary input files whereas<br>
tearDown() for Dasha execution will be different.<br>
 </tt><br>
<br>
</blockquote><tt>Hi Ed<br>
   Setup and teardown whould only be for common stae between a set of 
unit tests... os function specific setup and teardown whould go in the 
inviviual functions. If a number of   functions share specific setup and 
teardown functionality that could go in a separate utiltiy function.</tt><br>
<br>
<tt>On another note one of the things that the the unit test framework 
allows us to do is to return a test suite when we load a unit test from 
a file (testsuite and test case are polymorphic)... Obviously this 
allows multiple different test_cases or suites to be loaded from one 
file.. However. overall i agree with chris that if the the files are too 
complex they should be split</tt><br>
<br>
<blockquote class="blockquote"><tt>As for splitting up large modules such as the 66 method, 5701 line<br>
'specific_fns/model_free.py' file, I've been playing around with a few<br>
ideas.  I have committed to the 1.3 repository line a change which does<br>
not affect program operation in any way but lays down a foundation for<br>
the breaking up of the model_free.py file<br>
(<a  href="http://www.nmr-relax.com/mail.gna.org/public/relax-commits/2007-03/msg00029.html">https://mail.gna.org/public/relax-commits/2007-03/msg00029.html</a>). This<br>
change introduces the directory 'specific_fns/model_free/' while still<br>
retaining the module namespace of 'specific_fns.model_free' by using<br>
import statements in the directory's '__init__.py' file.  I've borrowed<br>
this concept from the Python site-packages, especially the Numeric and<br>
scipy modules. </tt><br>
<br>
</blockquote><tt>note numeric and scipy (especially) do carry some baggae and have code 
bases which are known to be 'tricky'</tt><br>
<br>
<blockquote class="blockquote"><tt>This foundation can be used to split up the old module<br>
into more manageable, multiple smaller modules, hence simplifying<br>
this code and the future unit test code.  The idea should be perfectly<br>
compatible with the possible future conversion of the class methods<br>
into module functions, if this is desired.<br>
 </tt><br>
<br>
</blockquote><tt>I can see a problem here, ideally modules and file structures should 
mirror each other otherwise you add an extra layer of structure anf 
complication understanding the source code base. I t would be better 
break and complicate things by moving them than to make the code base 
more complicated</tt><br>
<br>
<pre style="margin: 0em;">regards
gary</pre><br>
<blockquote class="blockquote"><pre style="margin: 0em;"><br>Cheers,</pre><br>
<pre style="margin: 0em;">Edward</pre><br>
<pre style="margin: 0em;"><br>_______________________________________________
relax (<a  href="http://nmr-relax.com">http://nmr-relax.com</a>)</pre><br>
<pre style="margin: 0em;">This is the relax-devel mailing list
relax-devel@xxxxxxx</pre><br>
<pre style="margin: 0em;">To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  href="http://www.nmr-relax.com/mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a></pre><br>
<pre style="margin: 0em;">.</pre><br>
<tt> </tt><br>
<br>
</blockquote><pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">--
-------------------------------------------------------------------
Dr Gary Thompson
Astbury Centre for Structural Molecular Biology,
University of Leeds, Astbury Building,
Leeds, LS2 9JT, West-Yorkshire, UK             Tel. +44-113-3433024
email: garyt@xxxxxxxxxxxxxxx                   Fax  +44-113-2331407
-------------------------------------------------------------------</pre><br>
<pre style="margin: 0em;"><br></pre><br>
<br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00022" href="msg00022.html">Re: Multiple test cases and the splitting up of large modules.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00021" href="msg00021.html">Re: Multiple test cases and the splitting up of large modules.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00004" href="msg00004.html">Re: r3080 - /1.3/test_suite/unit_tests/unit_test_runner.py</a></strong>
<ul><li><em>From:</em> Gary S. Thompson</li></ul></li>
<li><strong><a name="00005" href="msg00005.html">Re: r3080 - /1.3/test_suite/unit_tests/unit_test_runner.py</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00008" href="msg00008.html">Re: r3080 - /1.3/test_suite/unit_tests/unit_test_runner.py</a></strong>
<ul><li><em>From:</em> Gary S. Thompson</li></ul></li>
<li><strong><a name="00009" href="msg00009.html">Re: r3080 - /1.3/test_suite/unit_tests/unit_test_runner.py</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00010" href="msg00010.html">Multiple test cases and the splitting up of large modules.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu Mar 08 10:20:26 2007</div>  
</body>
</html>
