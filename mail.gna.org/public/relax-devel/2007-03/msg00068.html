<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: Vote for the design of the relax data storage object singleton. -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Thu, 15 Mar 2007 17:21:43 +0100 -->
<!--X-Message-Id: 7f080ed10703150921g7469b0d6ia5506c3c47c537c8@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 7f080ed10703140609p70d35295ye10ee5939da494a2@mail.gmail.com -->
<!--X-Reference: 1173960604.8066.341.camel@mrspell -->
<!--X-Reference: 7f080ed10703150700v2c7296behc146501949d618bf@mail.gmail.com -->
<!--X-Reference: 1173968940.8066.351.camel@mrspell -->
<!--X-Reference: 7f080ed10703150750k3c2b765fpfad3030a1db9ed12@mail.gmail.com -->
<!--X-Reference: 1173971938.8066.377.camel@mrspell -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Vote for the design of the relax data storage object singleton. -- March 15, 2007 - 17:21</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Vote for the design of the relax data storage object singleton.</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00068" class="tabs">Index by Date</a> | <a href="threads.html#00068" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00067.html">Date Prev</a>] [<a href="msg00069.html">Date Next</a>] [<a href="msg00066.html">Thread Prev</a>] [<a href="msg00070.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Chris MacRaild&quot; &lt;c.a.macraild@xxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Fri, 16 Mar 2007 03:21:04 +1100</li>
<li class="menuitem">
<em>Cc</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Dkim-signature</em>: a=rsa-sha1; c=relaxed/relaxed; d=gmail.com; s=beta;	h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:cc:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;	b=V0iDeU70oPWix2toC2QUf2De4sVMHm0j+74OyB+Afymkvdf7Gzt8TZz8nVvJy2IG3ADDASRmF2b8iBIrnagyG1o8DA+Ui7pH0gTcFTaTqTlqW6eMQGXSL64ay6n3n7TJH/8mLVXQ1WmoPY1K/NKmtN6hUksjv7drjRbZND/RV2s=</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00068.html">7f080ed10703150921g7469b0d6ia5506c3c47c537c8@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;<a href="msg00046.html">7f080ed10703140609p70d35295ye10ee5939da494a2@mail.gmail.com</a>&gt;	&lt;<a href="msg00057.html">1173960604.8066.341.camel@mrspell</a>&gt;	&lt;<a href="msg00058.html">7f080ed10703150700v2c7296behc146501949d618bf@mail.gmail.com</a>&gt;	&lt;<a href="msg00063.html">1173968940.8066.351.camel@mrspell</a>&gt;	&lt;<a href="msg00065.html">7f080ed10703150750k3c2b765fpfad3030a1db9ed12@mail.gmail.com</a>&gt;	&lt;<a href="msg00066.html">1173971938.8066.377.camel@mrspell</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on March 15, 2007 - 17:21:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<tt>On 3/16/07, Chris MacRaild &lt;c.a.macraild@xxxxxxxxxxx&gt; wrote:
</tt><blockquote class="blockquote"><pre style="margin: 0em;">On Fri, 2007-03-16 at 01:50 +1100, Edward d'Auvergne wrote:
&gt; On 3/16/07, Chris MacRaild &lt;c.a.macraild@xxxxxxxxxxx&gt; wrote:
&gt; &gt; On Fri, 2007-03-16 at 01:00 +1100, Edward d'Auvergne wrote:
&gt; &gt; &gt; On 3/15/07, Chris MacRaild &lt;c.a.macraild@xxxxxxxxxxx&gt; wrote:
&gt; &gt; &gt; &gt; On Thu, 2007-03-15 at 00:09 +1100, Edward d'Auvergne wrote:
&gt; &gt; &gt; &gt; &gt; On 3/14/07, Chris MacRaild &lt;c.a.macraild@xxxxxxxxxxx&gt; wrote:
&gt; &gt; &gt; &gt; &gt; &gt; On Tue, 2007-03-13 at 19:51 +1100, Edward d'Auvergne wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Gary,
&gt; &gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; I've written some unit tests which are located in the file
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 'test_suite/unit_tests/data/__init__.py'.  Would you know what
&gt; &gt; &gt; &gt; &gt; &gt; &gt; modifications I need to apply to make these tests run?  These 
tests
&gt; &gt; &gt; &gt; &gt; &gt; &gt; are for the methods of the Data singleton class (the relax data
&gt; &gt; &gt; &gt; &gt; &gt; &gt; storage object) which is located in 'data/__init__.py'.  I 
haven't
&gt; &gt; &gt; &gt; &gt; &gt; &gt; used the statement 'from x import Data' for this class so it is 
the
&gt; &gt; &gt; &gt; &gt; &gt; &gt; legal and ubiquitous usage of an __init__.py file.  Would
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 'unit_test_runner.py' handle this code?
&gt; &gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Thanks,
&gt; &gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; Edward
&gt; &gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; P.S.  These tests demonstrate the utility of subclassing the 
singleton
&gt; &gt; &gt; &gt; &gt; &gt; &gt; and is one reason I was arguing for the use of the class import 
rather
&gt; &gt; &gt; &gt; &gt; &gt; &gt; than reference import.
&gt; &gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &gt; It is of course correct that the Singleton implimentation I 
proposed
&gt; &gt; &gt; &gt; &gt; &gt; does not allow for subclassing. This however might well be seen 
as a
&gt; &gt; &gt; &gt; &gt; &gt; design feature, given the well known conceptual problems with
&gt; &gt; &gt; &gt; &gt; &gt; subclassing Singleton. Essentially, subclassing violates the 
Singleton
&gt; &gt; &gt; &gt; &gt; &gt; Design Pattern:
&gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &gt; class Singleton:
&gt; &gt; &gt; &gt; &gt; &gt;     def __new__(self):
&gt; &gt; &gt; &gt; &gt; &gt;         ...
&gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &gt; class Sub(Singleton): pass
&gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt;&gt;&gt; a = Singleton()
&gt; &gt; &gt; &gt; &gt; &gt; &gt;&gt;&gt; b = Sub()
&gt; &gt; &gt; &gt; &gt; &gt; &gt;&gt;&gt; isinstance(a,Singleton)
&gt; &gt; &gt; &gt; &gt; &gt; True
&gt; &gt; &gt; &gt; &gt; &gt; &gt;&gt;&gt; isinstance(b,Singleton)
&gt; &gt; &gt; &gt; &gt; &gt; True
&gt; &gt; &gt; &gt; &gt; &gt; &gt;&gt;&gt; a is b
&gt; &gt; &gt; &gt; &gt; &gt; False
&gt; &gt; &gt; &gt; &gt; &gt; &gt;&gt;&gt; a == b
&gt; &gt; &gt; &gt; &gt; &gt; False
&gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &gt; ie. we have 2 instances of Singleton that are not the same thing, 
and
&gt; &gt; &gt; &gt; &gt; &gt; not even equal! If this is the behaviour you want, then you need
&gt; &gt; &gt; &gt; &gt; &gt; something other than Singleton. On the other hand, if you really 
want
&gt; &gt; &gt; &gt; &gt; &gt; Singleton, then you can't also hope for subclassability.
&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; Actually one is an instance of Singleton and the other is an 
instance
&gt; &gt; &gt; &gt; &gt; of Sub.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; The definition of inheritance is that an instance of the subclass is
&gt; &gt; &gt; &gt; also an instance of the parent class. ie. b is an instance of both Sub
&gt; &gt; &gt; &gt; and Singleton. Inheritance from a Singleton class is therefore a 
logical
&gt; &gt; &gt; &gt; contradiction.
&gt; &gt; &gt;
&gt; &gt; &gt; That is actually incorrect!
&gt; &gt;
&gt; &gt; Sorry to drag this on, but I'm not incorrect here, and its a fairly
&gt; &gt; fundamental point of OO philosophy and practice that is well worth
&gt; &gt; getting right. This is pasted directly from my Python command line (the
&gt; &gt; interpreter does not lie!):
&gt; &gt;
&gt; &gt; &gt;&gt;&gt; class A: pass
&gt; &gt; ...
&gt; &gt; &gt;&gt;&gt; class B(A): pass
&gt; &gt; ...
&gt; &gt; &gt;&gt;&gt; a= A()
&gt; &gt; &gt;&gt;&gt; b = B()
&gt; &gt; &gt;&gt;&gt; isinstance(a,A)
&gt; &gt; True
&gt; &gt; &gt;&gt;&gt; isinstance(a,B)
&gt; &gt; False
&gt; &gt; &gt;&gt;&gt; isinstance(b,B)
&gt; &gt; True
&gt; &gt; &gt;&gt;&gt; isinstance(b,A)
&gt; &gt; True
&gt; &gt;
&gt; &gt; Because B is a subclass of A, all instances of B are also instances of A
&gt;
&gt; The 'isinstance()' built-in function will return true if object x is
&gt; an instance of the supplied class or, importantly, a subclass.  This
&gt; is what it's docstring says.  Try the following instead (after
&gt; reissuing the above statements):
&gt;
&gt; &gt;&gt;&gt; a is b
&gt; False
&gt; &gt;&gt;&gt; hash(a)
&gt; -1217311764
&gt; &gt;&gt;&gt; hash(b)
&gt; -1214788020
&gt; &gt;&gt;&gt; id(a)
&gt; -1217311764
&gt; &gt;&gt;&gt; id(b)
&gt; -1214788020
&gt;
&gt; If b was the same instance as a, then the first statement would return
&gt; true.  The two hash() statements show that a and b are different.  The
&gt; two id() statements show that they occupy different locations in
&gt; memory - the number is the object's memory address.  Another test is
&gt; populating the empty containers:
&gt;
&gt; &gt;&gt;&gt; a.x = 1
&gt; &gt;&gt;&gt; b.y = 2
&gt; &gt;&gt;&gt; dir(a)
&gt; ['__doc__', '__module__', 'x']
&gt; &gt;&gt;&gt; dir(b)
&gt; ['__doc__', '__module__', 'y']
&gt;
&gt; The instances a and b are very much different!</pre><br>
<pre style="margin: 0em;">This is all true, but misses the point. a and b are different objects,
but they are of the same type:</pre><br>
<pre style="margin: 0em;">&gt;&gt;&gt; type(a) is type(b)
True
</pre></blockquote><pre style="margin: 0em;"><br>They are necessarily the same type, both are &lt;type 'instance'&gt;.</pre><br>
<blockquote class="blockquote"><pre style="margin: 0em;">and both of them are instances of the parent class A. So to go back to
where we started: for almost any implimentation of Singleton
</pre></blockquote><pre style="margin: 0em;"><br>Both are not instances of A.  The Python builtin function
'isinstance()' is poorly named.  It returns True if object b is an
instance of class B.  But it also returns true if object b is an
instance of class B which is subclassed from A (isinstance(b, A)).
Note that there is no reference to an instance of A in this second
test, either here or when typing 'help(isinstance)').</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">&gt;&gt;&gt; single = Singleton()
&gt;&gt;&gt; class Sub(Singleton): pass
...
&gt;&gt;&gt; sub = Sub()
&gt;&gt;&gt; isinstance(sub,Singleton)
True
</pre></blockquote><pre style="margin: 0em;"><br>This is the second part of the isinstance test, seeing if sub is and
instance of some class which is itself subclassed from Singleton.</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">&gt;&gt;&gt; isinstance(single,Singleton)
True
</pre></blockquote><pre style="margin: 0em;"><br>This is the first part of the isinstance test, the actual testing if
it is an instance.</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">&gt;&gt;&gt; sub is single
False</pre><br>
<pre style="margin: 0em;">This breaches the Singleton design because we have two *different*
objects that are both instances of the Singleton class.
</pre></blockquote><pre style="margin: 0em;"><br>WRONG!!!  We now have two different singletons!  They occupy different
memory addresses and will have different contents.  For example one
dictionary type can be the relax data storage object and the other can
be an object storing the various components used in the chi-squared
equation, relaxation equations, spectral density values, and geometric
components all calculated by the module 'maths_fns.mf'.  Both these
two objects benefit by being singletons - the alternative currently
used by 'maths_fns.mf' is to pass a single data object into the
hundreds of functions which use that object.</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">To put this in terms of the favourite metaphore, because apple is a
subclass of fruit, all apples are also fruits (ie. all instances of
class Apple in also instances of class Fruit). Even if you have several
different apples, this does not make them any less fruity.
</pre></blockquote><pre style="margin: 0em;"><br>True it is a fruit, but it isn't the fruit object.  To place this
subclassing into this type of context, we could create a dictionary
type singleton and then subclass both the relax data storage object
and any new objects from this single base class.  Then both objects
are side by side on this inheritance tree with the ancestral singleton
base class at the bottom of the tree.  This inheritance pattern is
useful if one object is more than just a subset of the other.  However
if you are happily using the Fruit object in your program and would
like to add support for Apples, there is no need for this branching
pattern.  Simply subclass Fruit and add the additional features
required for the Apple.</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">Instance refers to a non-exclusive relationship between class and
object: many different objects can be instances of the same class
</pre></blockquote><pre style="margin: 0em;"><br>In this case the different objects are different instances of the same
class, they are located in different parts of the memory.</pre><br>
<blockquote class="blockquote"><pre style="margin: 0em;">and
any one object can be an instance of many different classes.
</pre></blockquote><pre style="margin: 0em;"><br>There I completely disagree.</pre><br>
<blockquote class="blockquote"><pre style="margin: 0em;">Inheritance
is the mechanism of this non-exclusivity; Singlton seeks to limit it.
Hence the two are incompatible when applied to the same object.
</pre></blockquote><pre style="margin: 0em;"><br>The concept of the Singleton and the concept of Inheritance are in no
way related and are perfectly compatible with each other.  Singletons
can have Inheritance.  Classes, which can be inherited, can also be
singletons.</pre><br>
<pre style="margin: 0em;">Edward</pre><br>
<pre style="margin: 0em;"><br>P.S.  For those still following this thread, this argument is not
related to what was voted upon :)</pre><br>
<br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00070" href="msg00070.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Gary S. Thompson</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00046" href="msg00046.html">Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00057" href="msg00057.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00058" href="msg00058.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00063" href="msg00063.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00065" href="msg00065.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00066" href="msg00066.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu Mar 15 18:40:17 2007</div>  
</body>
</html>
