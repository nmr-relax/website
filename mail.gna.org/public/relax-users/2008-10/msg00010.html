<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: Difficulty with noe.py sample script -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneq.qnhiretarNtznvy.pbz> -->
<!--X-Date: Tue, 07 Oct 2008 16:44:07 +0200 -->
<!--X-Message-Id: 7f080ed10810070744u466075f1oc242f3741870f48e@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20081006103122.7gfeyzj11lsk4ok4@my5.dal.ca -->
<!--X-Reference: 7f080ed10810061244m46d2575s3a543ce31ecffc52@mail.gmail.com -->
<!--X-Reference: 20081007111240.c6amr0pfzoggk4ww@my2.dal.ca -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Difficulty with noe.py sample script -- October 07, 2008 - 16:44</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Difficulty with noe.py sample script</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00010" class="tabs">Index by Date</a> | <a href="threads.html#00010" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00009.html">Date Prev</a>] [<a href="msg00011.html">Date Next</a>] [<a href="msg00009.html">Thread Prev</a>] [<a href="msg00011.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Tyler Reddy&quot; &lt;TREDDY@xxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Tue, 7 Oct 2008 16:44:02 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-users@xxxxxxx&quot; &lt;relax-users@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00010.html">7f080ed10810070744u466075f1oc242f3741870f48e@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;20081006103122.7gfeyzj11lsk4ok4@xxxxxxxxxx&gt;	&lt;7f080ed10810061244m46d2575s3a543ce31ecffc52@xxxxxxxxxxxxxx&gt;	&lt;20081007111240.c6amr0pfzoggk4ww@xxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on October 07, 2008 - 16:44:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi,

This is again a bug, as relax hasn't managed to catch a file formatted
in a way it cannot recognise and then respond with a error message
which is understandable.  The error indicates to me that relax is
thinking this is a Sparky formatted peak list, but that the intensity
column is missing (at least in one position).  The file should look
something like:

      Assignment         w1         w2   Data Height

         LEU3N-HN    122.454      8.397       129722
         GLY4N-HN    111.999      8.719       422375
         SER5N-HN    115.085      8.176       384180
         MET6N-HN    120.934      8.812       272100
         ASP7N-HN    122.394      8.750       174970
         SER8N-HN    113.916      7.836       218762
        GLU11N-HN    122.194      8.604        30412
        GLY12N-HN    110.525      9.028        90144

The NOE analysis works in version 1.2.14, but not in 1.3.1 yet.  The
idea for filing the bug report and then me creating a system test
within relax using a tiny subset of the data was simply a suggestion
that would allow me to quickly make the NOE analysis functional in the
next relax 1.3 version.  Then other relax users would benefit from
having this code functional again too.  But if you need the NOE data
quickly, relax 1.2.14 will do the job with a Sparky peak list
possessing all four columns.

Regards,

Edward



On Tue, Oct 7, 2008 at 4:12 PM, Tyler Reddy &lt;TREDDY@xxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">I ran the 1.2 version of the noe.py script with the 1.2 version of relax on
the
same machine and had a slightly different error output (below). If this is
simply a version-change problem with the script as you say, then I'm not
sure
why I'd get a convoluted error with version 1.2 as well.

Output:

Calculating and averaging the unit XH vectors from all structures.

relax&gt; noe.read(run='noe', file='NOnoe500.list', dir=None,
spectrum_type='ref',
format='sparky', heteronuc='N', proton='HN', int_col=None)
Reference spectrum.
Sparky formatted data file.

Opening the file 'NOnoe500.list' for reading.
Number of header lines found: 2
Traceback (most recent call last):
 File &quot;/Applications/relax-1.2.14/relax&quot;, line 457, in &lt;module&gt;
  Relax()
 File &quot;/Applications/relax-1.2.14/relax&quot;, line 167, in __init__
  self.interpreter.run()
 File &quot;/Applications/relax-1.2.14/prompt/interpreter.py&quot;, line 216, in run
  run_script(intro=self.relax.intro_string, local=self.local,
script_file=self.relax.script_file, quit=1)
 File &quot;/Applications/relax-1.2.14/prompt/interpreter.py&quot;, line 391, in
run_script
  console.interact(intro, local, script_file, quit)
 File &quot;/Applications/relax-1.2.14/prompt/interpreter.py&quot;, line 343, in
interact_script
  execfile(script_file, local)
 File &quot;noe_12.py&quot;, line 35, in &lt;module&gt;
  noe.read(name, file='NOnoe500.list', spectrum_type='ref')
 File &quot;/Applications/relax-1.2.14/prompt/noe.py&quot;, line 226, in read
  self.__relax__.specific.noe.read(run=run, file=file, dir=dir,
spectrum_type=spectrum_type, format=format, heteronuc=heteronuc,
proton=proton,
int_col=int_col)
 File &quot;/Applications/relax-1.2.14/specific_fns/noe.py&quot;, line 110, in read
  self.relax.generic.intensity.read(run=run, file=file, dir=dir,
format=format, heteronuc=heteronuc, proton=proton, int_col=int_col,
assign_func=self.assign_function)
 File &quot;/Applications/relax-1.2.14/generic_fns/intensity.py&quot;, line 232, in
read
  res_num, H_name, X_name, intensity = self.intensity(self.file_data[i])
 File &quot;/Applications/relax-1.2.14/generic_fns/intensity.py&quot;, line 92, in
intensity_sparky
  intensity = float(line[self.int_col])
IndexError: list index out of range



Quoting Edward d'Auvergne &lt;edward.dauvergne@xxxxxxxxx&gt;:

</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

This is definitely a bug!  If you could file a bug report
(<a  rel="nofollow" href="https://web.archive.org/web/https://gna.org/bugs/?func=additem&amp;group=relax">https://gna.org/bugs/?func=additem&amp;group=relax</a>), that would be much
appreciated.  If you would like a description of how this is done,
please see section 3.3 of the relax manual (version 1.3) or the online
HTML version (currently at
<a  rel="nofollow" href="http://www.nmr-relax.com/manual/1.3/node49.html">http://www.nmr-relax.com/manual/1.3/node49.html</a>).

The reason this is failing is because this code in the 1.3 relax
versions has not been converted to the new design yet.  For me or the
relax developers to implement this, first a system test should be
added to the test suite.  The test suite can be run by typing:

$ relax --test-suite

The system test is simply a very tiny, although complete, version of
the analysis you would like to do.  This can include a small subset of
the base data, randomised if you'd like to protect the data prior to
publication.  With the small data subset, I can include your full
analysis script into the test suite and execute it with the data.
Then once the test passes, an NOE analysis will be possible.  The data
and script can be attached to the bug report.  If you would like to
help in getting this test implemented, that would be much appreciated.

Thanks,

Edward



On Mon, Oct 6, 2008 at 3:31 PM, Tyler Reddy &lt;TREDDY@xxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">

Hello,

I am having trouble with the noe.py script. I have peptide data with 6
backbone
15N labels, and I suspect it's a problem with input. I've tried several
permutations of full PDB file and full .list Sparky format files as well
as
files trimmed down to include only the labeled residues. I'm not sure
which is
preferable/required for input, and if unlabeled residues can simply be
left
with a blank column value or if there is a special way to treat this?

Here is a sample of the output I get with any of my tries so far:

Scientific Python PDB parser.
Loading all structures from the PDB file.
Structure('select.pdb'):
 Peptide chain A of length 6


relax&gt; structure.load_spins(spin_id='@N', ave_pos=True)
Adding the following spins to the relax data store.

Mol_name   Res_num    Res_name   Spin_num   Spin_name
A          254        LEU        68         N
A          258        LEU        142        N
A          261        GLY        197        N
A          264        LEU        230        N
A          268        ALA        294        N
A          273        LEU        366        N

relax&gt; noe.read(file='NOnoe500_true.list', dir=None, spectrum_type='ref',
format='sparky', heteronuc='N', proton='HN', int_col=None)
Reference spectrum.
Traceback (most recent call last):
 File &quot;/Applications/relax-1.3.1/relax&quot;, line 408, in &lt;module&gt;
  Relax()
 File &quot;/Applications/relax-1.3.1/relax&quot;, line 125, in __init__
  self.interpreter.run(self.script_file)
 File &quot;/Applications/relax-1.3.1/prompt/interpreter.py&quot;, line 270, in run
  return run_script(intro=self.__intro_string, local=self.local,
script_file=script_file, quit=self.__quit_flag,
show_script=self.__show_script,
raise_relax_error=self.__raise_relax_error)
 File &quot;/Applications/relax-1.3.1/prompt/interpreter.py&quot;, line 531, in
run_script
  return console.interact(intro, local, script_file, quit,
show_script=show_script, raise_relax_error=raise_relax_error)
 File &quot;/Applications/relax-1.3.1/prompt/interpreter.py&quot;, line 427, in
interact_script
  execfile(script_file, local)
 File &quot;noe.py&quot;, line 36, in &lt;module&gt;
  noe.read(file='NOnoe500_true.list', spectrum_type='ref')
 File &quot;/Applications/relax-1.3.1/prompt/noe.py&quot;, line 216, in read
  noe_obj.read(file=file, dir=dir, spectrum_type=spectrum_type,
format=format,
heteronuc=heteronuc, proton=proton, int_col=int_col)
 File &quot;/Applications/relax-1.3.1/specific_fns/noe.py&quot;, line 114, in read
  self.relax.generic.intensity.read(run=run, file=file, dir=dir,
format=format, heteronuc=heteronuc, proton=proton, int_col=int_col,
assign_func=self.assign_function)
AttributeError: Noe instance has no attribute 'relax'


_______________________________________________
relax (<a  rel="nofollow" href="http://nmr-relax.com">http://nmr-relax.com</a>)

This is the relax-users mailing list
relax-users@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-users">https://mail.gna.org/listinfo/relax-users</a>

</pre></blockquote><pre style="margin: 0em;">

_______________________________________________
relax (<a  rel="nofollow" href="http://nmr-relax.com">http://nmr-relax.com</a>)

This is the relax-users mailing list
relax-users@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-users">https://mail.gna.org/listinfo/relax-users</a>

</pre></blockquote><pre style="margin: 0em;">




</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00011" href="msg00011.html">Re: Difficulty with noe.py sample script</a></strong>
<ul><li><em>From:</em> Tyler Reddy</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00005" href="msg00005.html">Difficulty with noe.py sample script</a></strong>
<ul><li><em>From:</em> Tyler Reddy</li></ul></li>
<li><strong><a name="00008" href="msg00008.html">Re: Difficulty with noe.py sample script</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00009" href="msg00009.html">Re: Difficulty with noe.py sample script</a></strong>
<ul><li><em>From:</em> Tyler Reddy</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Tue Oct 07 20:00:14 2008</div>  
</body>
</html>
