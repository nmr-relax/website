<!-- MHonArc v2.6.16 -->
<!--X-Subject: r16180 &#45; in /branches/uf_redesign: prompt/ user_functions/ -->
<!--X-From-R13: rqjneqNaze&#45;erynk.pbz -->
<!--X-Date: Thu, 10 May 2012 12:40:04 +0200 -->
<!--X-Message-Id: E1SSQmy&#45;0002Hi&#45;1q@subversion.gna.org -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>r16180 - in /branches/uf_redesign: prompt/ user_functions/ -- May 10, 2012 - 12:40</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />r16180 - in /branches/uf_redesign: prompt/ user_functions/</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00317" class="tabs">Index by Date</a> | <a href="threads.html#00317" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00316.html">Date Prev</a>] [<a href="msg00318.html">Date Next</a>] [<a href="msg00316.html">Thread Prev</a>] [<a href="msg00318.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: relax-commits@xxxxxxx</li>
<li class="menuitem">
<em>Date</em>: Thu, 10 May 2012 10:40:03 -0000</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00317.html">E1SSQmy-0002Hi-1q@subversion.gna.org</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>edward</strong> on May 10, 2012 - 12:40:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Author: bugman
Date: Thu May 10 12:40:03 2012
New Revision: 16180

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=16180&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=16180&amp;view=rev</a>
Log:
Converted the paramag.centre user function to the auto-generation design.


Added:
    branches/uf_redesign/user_functions/paramag.py
      - copied, changed from r16173, branches/uf_redesign/prompt/paramag.py
Removed:
    branches/uf_redesign/prompt/paramag.py
Modified:
    branches/uf_redesign/prompt/__init__.py
    branches/uf_redesign/prompt/interpreter.py
    branches/uf_redesign/user_functions/__init__.py

Modified: branches/uf_redesign/prompt/__init__.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/uf_redesign/prompt/__init__.py?rev=16180&amp;r1=16179&amp;r2=16180&amp;view=diff">http://svn.gna.org/viewcvs/relax/branches/uf_redesign/prompt/__init__.py?rev=16180&amp;r1=16179&amp;r2=16180&amp;view=diff</a>
==============================================================================
--- branches/uf_redesign/prompt/__init__.py (original)
+++ branches/uf_redesign/prompt/__init__.py Thu May 10 12:40:03 2012
@@ -28,7 +28,6 @@
            'help',
            'interpreter',
            'objects',
-           'paramag',
            'pcs',
            'rdc',
            'relax_fit',

Modified: branches/uf_redesign/prompt/interpreter.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/uf_redesign/prompt/interpreter.py?rev=16180&amp;r1=16179&amp;r2=16180&amp;view=diff">http://svn.gna.org/viewcvs/relax/branches/uf_redesign/prompt/interpreter.py?rev=16180&amp;r1=16179&amp;r2=16180&amp;view=diff</a>
==============================================================================
--- branches/uf_redesign/prompt/interpreter.py (original)
+++ branches/uf_redesign/prompt/interpreter.py Thu May 10 12:40:03 2012
@@ -63,7 +63,6 @@
 # User classes.
 from residue import Residue
 from structure import Structure
-from paramag import Paramag
 from pcs import PCS
 from rdc import RDC
 from relax_fit import Relax_fit
@@ -190,7 +189,6 @@
         objects['temperature'] = temp.set
 
         # Place the user classes in the local namespace.
-        objects['paramag'] = Paramag()
         objects['pcs'] = PCS()
         objects['rdc'] = RDC()
         objects['relax_fit'] = Relax_fit()

Removed: branches/uf_redesign/prompt/paramag.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/uf_redesign/prompt/paramag.py?rev=16179&amp;view=auto">http://svn.gna.org/viewcvs/relax/branches/uf_redesign/prompt/paramag.py?rev=16179&amp;view=auto</a>
==============================================================================
--- branches/uf_redesign/prompt/paramag.py (original)
+++ branches/uf_redesign/prompt/paramag.py (removed)
@@ -1,123 +1,0 @@
-###############################################################################
-#                                                                            
 #
-# Copyright (C) 2003-2012 Edward d'Auvergne                                  
 #
-#                                                                            
 #
-# This file is part of the program relax.                                    
 #
-#                                                                            
 #
-# relax is free software; you can redistribute it and/or modify              
 #
-# it under the terms of the GNU General Public License as published by       
 #
-# the Free Software Foundation; either version 2 of the License, or          
 #
-# (at your option) any later version.                                        
 #
-#                                                                            
 #
-# relax is distributed in the hope that it will be useful,                   
 #
-# but WITHOUT ANY WARRANTY; without even the implied warranty of             
 #
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the              
 #
-# GNU General Public License for more details.                               
 #
-#                                                                            
 #
-# You should have received a copy of the GNU General Public License          
 #
-# along with relax; if not, write to the Free Software                       
 #
-# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA  
 #
-#                                                                            
 #
-###############################################################################
-
-# Module docstring.
-&quot;&quot;&quot;Module containing the user function class for paramagnetic related 
functions.&quot;&quot;&quot;
-__docformat__ = 'plaintext'
-
-# relax module imports.
-from base_class import User_fn_class
-import arg_check
-from generic_fns import paramag
-from relax_errors import RelaxError
-from status import Status; status = Status()
-
-
-class Paramag(User_fn_class):
-    &quot;&quot;&quot;Class for handling paramagnetic information.&quot;&quot;&quot;
-
-    def centre(self, pos=None, atom_id=None, pipe=None, verbosity=1, 
fix=True, ave_pos=True, force=False):
-        &quot;&quot;&quot;Specify which atom is the paramagnetic centre.
-
-        Keyword Arguments
-        ~~~~~~~~~~~~~~~~~
-
-        pos:  The atomic position.
-
-        atom_id:  The atom ID string.
-
-        pipe:  The data pipe containing the structures to extract the centre 
from.
-
-        verbosity:  The amount of information to print out.
-
-        fix:  A flag specifying if the paramagnetic centre should be fixed 
during optimisation.
-
-        ave_pos:  A flag specifying if the position of the atom is to be 
averaged across all models.
-
-        force:  A flag which if True will cause the current paramagnetic 
centre to be overwritten.
-
-
-        Description
-        ~~~~~~~~~~~
-
-        This function is required for specifying where the paramagnetic 
centre is located in the
-        loaded structure file.  If no structure number is given, then the 
average atom position will
-        be calculated if multiple structures are loaded.
-
-        A different set of structures than those loaded into the current 
data pipe can also be used
-        to determine the position, or its average.  This can be achieved by 
loading the alternative
-        structures into another data pipe, and then specifying that pipe 
through the pipe argument.
-
-        If the ave_pos flag is set to True, the average position from all 
models will be used as the
-        position of the paramagnetic centre.  If False, then the positions 
from all structures will
-        be used.  If multiple positions are used, then a fast paramagnetic 
centre motion will be
-        assumed so that PCSs for a single tensor will be calculated for each 
position, and the PCS
-        values linearly averaged.
-
-
-        Examples
-        ~~~~~~~~
-
-        If the paramagnetic centre is the lanthanide Dysprosium which is 
labelled as Dy in a loaded
-        PDB file, then type one of:
-
-        relax&gt; paramag.centre('Dy')
-        relax&gt; paramag.centre(atom_id='Dy')
-
-        If the carbon atom 'C1' of residue '4' in the PDB file is to be used 
as the paramagnetic
-        centre, then type:
-
-        relax&gt; paramag.centre(':4@C1')
-        
-        To state that the Dy3+ atomic position is [0.136, 12.543, 4.356], 
type one of:
-
-        relax&gt; paramag.centre([0.136, 12.543, 4.356])
-        relax&gt; paramag.centre(pos=[0.136, 12.543, 4.356])
-
-        To find an unknown paramagnetic centre, type:
-
-        relax&gt; paramag.centre(fix=False)
-        &quot;&quot;&quot;
-
-        # Function intro text.
-        if status.prompt_intro:
-            text = status.ps3 + &quot;paramag.centre(&quot;
-            text = text + &quot;pos=&quot; + repr(pos)
-            text = text + &quot;, atom_id=&quot; + repr(atom_id)
-            text = text + &quot;, pipe=&quot; + repr(pipe)
-            text = text + &quot;, verbosity=&quot; + repr(verbosity)
-            text = text + &quot;, fix=&quot; + repr(fix)
-            text = text + &quot;, ave_pos=&quot; + repr(ave_pos)
-            text = text + &quot;, force=&quot; + repr(force) + &quot;)&quot;
-            print(text)
-
-        # The argument checks.
-        arg_check.is_num_list(pos, 'atomic position', size=3, 
can_be_none=True)
-        arg_check.is_str(atom_id, 'atom ID string', can_be_none=True)
-        arg_check.is_str(pipe, 'data pipe', can_be_none=True)
-        arg_check.is_int(verbosity, 'verbosity level')
-        arg_check.is_bool(fix, 'fix flag')
-        arg_check.is_bool(ave_pos, 'average position flag')
-        arg_check.is_bool(force, 'force flag')
-
-        # Execute the functional code.
-        paramag.centre(pos=pos, atom_id=atom_id, pipe=pipe, 
verbosity=verbosity, fix=fix, ave_pos=ave_pos, force=force)

Modified: branches/uf_redesign/user_functions/__init__.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/uf_redesign/user_functions/__init__.py?rev=16180&amp;r1=16179&amp;r2=16180&amp;view=diff">http://svn.gna.org/viewcvs/relax/branches/uf_redesign/user_functions/__init__.py?rev=16180&amp;r1=16179&amp;r2=16180&amp;view=diff</a>
==============================================================================
--- branches/uf_redesign/user_functions/__init__.py (original)
+++ branches/uf_redesign/user_functions/__init__.py Thu May 10 12:40:03 2012
@@ -58,6 +58,7 @@
     'n_state_model',
     'noe',
     'palmer',
+    'paramag',
     'pipe',
     'pymol_control',
     'relax_data',
@@ -90,6 +91,7 @@
 import user_functions.n_state_model
 import user_functions.noe
 import user_functions.palmer
+import user_functions.paramag
 import user_functions.pipe
 import user_functions.pymol_control
 import user_functions.relax_data

Copied: branches/uf_redesign/user_functions/paramag.py (from r16173, 
branches/uf_redesign/prompt/paramag.py)
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/uf_redesign/user_functions/paramag.py?p2=branches/uf_redesign/user_functions/paramag.py&amp;p1=branches/uf_redesign/prompt/paramag.py&amp;r1=16173&amp;r2=16180&amp;rev=16180&amp;view=diff">http://svn.gna.org/viewcvs/relax/branches/uf_redesign/user_functions/paramag.py?p2=branches/uf_redesign/user_functions/paramag.py&amp;p1=branches/uf_redesign/prompt/paramag.py&amp;r1=16173&amp;r2=16180&amp;rev=16180&amp;view=diff</a>
==============================================================================
--- branches/uf_redesign/prompt/paramag.py (original)
+++ branches/uf_redesign/user_functions/paramag.py Thu May 10 12:40:03 2012
@@ -21,103 +21,106 @@
 
###############################################################################
 
 # Module docstring.
-&quot;&quot;&quot;Module containing the user function class for paramagnetic related 
functions.&quot;&quot;&quot;
-__docformat__ = 'plaintext'
+&quot;&quot;&quot;Module containing the user function data for paramagnetic related 
functions.&quot;&quot;&quot;
 
 # relax module imports.
-from base_class import User_fn_class
-import arg_check
-from generic_fns import paramag
-from relax_errors import RelaxError
-from status import Status; status = Status()
+from generic_fns import paramag, pipes
+from graphics import WIZARD_IMAGE_PATH
+from user_functions.data import Uf_info; uf_info = Uf_info()
 
 
-class Paramag(User_fn_class):
-    &quot;&quot;&quot;Class for handling paramagnetic information.&quot;&quot;&quot;
-
-    def centre(self, pos=None, atom_id=None, pipe=None, verbosity=1, 
fix=True, ave_pos=True, force=False):
-        &quot;&quot;&quot;Specify which atom is the paramagnetic centre.
-
-        Keyword Arguments
-        ~~~~~~~~~~~~~~~~~
-
-        pos:  The atomic position.
-
-        atom_id:  The atom ID string.
-
-        pipe:  The data pipe containing the structures to extract the centre 
from.
-
-        verbosity:  The amount of information to print out.
-
-        fix:  A flag specifying if the paramagnetic centre should be fixed 
during optimisation.
-
-        ave_pos:  A flag specifying if the position of the atom is to be 
averaged across all models.
-
-        force:  A flag which if True will cause the current paramagnetic 
centre to be overwritten.
+# The user function class.
+uf_class = uf_info.add_class('paramag')
+uf_class.title = &quot;Class for handling paramagnetic information.&quot;
+uf_class.menu_text = &quot;&amp;paramag&quot;
 
 
-        Description
-        ~~~~~~~~~~~
+# The paramag.centre user function.
+uf = uf_info.add_uf('paramag.centre')
+uf.title = &quot;Specify which atom is the paramagnetic centre.&quot;
+uf.title_short = &quot;Paramagnetic centre selection.&quot;
+uf.add_keyarg(
+    name = &quot;pos&quot;,
+    py_type = &quot;num_list&quot;,
+    size = 3,
+    desc_short = &quot;atomic position&quot;,
+    desc = &quot;The atomic position of the paramagnetic centre.&quot;,
+    can_be_none = True
+)
+uf.add_keyarg(
+    name = &quot;atom_id&quot;,
+    py_type = &quot;str&quot;,
+    desc_short = &quot;atom ID string&quot;,
+    desc = &quot;The atom ID string.&quot;,
+    can_be_none = True
+)
+uf.add_keyarg(
+    name = &quot;pipe&quot;,
+    py_type = &quot;str&quot;,
+    desc_short = &quot;data pipe&quot;,
+    desc = &quot;The data pipe containing the structures to extract the centre 
from.&quot;,
+    wiz_element_type = 'combo',
+    wiz_combo_iter = pipes.pipe_names,
+    can_be_none = True
+)
+uf.add_keyarg(
+    name = &quot;verbosity&quot;,
+    default = 1,
+    py_type = &quot;int&quot;,
+    desc_short = &quot;verbosity level&quot;,
+    desc = &quot;The amount of information to print out.&quot;
+)
+uf.add_keyarg(
+    name = &quot;fix&quot;,
+    default = True,
+    py_type = &quot;bool&quot;,
+    desc_short = &quot;fix flag&quot;,
+    desc = &quot;A flag specifying if the paramagnetic centre should be fixed 
during optimisation.&quot;
+)
+uf.add_keyarg(
+    name = &quot;ave_pos&quot;,
+    default = True,
+    py_type = &quot;bool&quot;,
+    desc_short = &quot;average position flag&quot;,
+    desc = &quot;A flag specifying if the position of the atom is to be averaged 
across all models.&quot;
+)
+uf.add_keyarg(
+    name = &quot;force&quot;,
+    default = False,
+    py_type = &quot;bool&quot;,
+    desc_short = &quot;force flag&quot;,
+    desc = &quot;A flag which if True will cause the current paramagnetic centre 
to be overwritten.&quot;
+)
+uf.desc = &quot;&quot;&quot;
+This is required for specifying where the paramagnetic centre is located in 
the loaded structure file.  If no structure number is given, then the average 
atom position will be calculated if multiple structures are loaded.
 
-        This function is required for specifying where the paramagnetic 
centre is located in the
-        loaded structure file.  If no structure number is given, then the 
average atom position will
-        be calculated if multiple structures are loaded.
+A different set of structures than those loaded into the current data pipe 
can also be used to determine the position, or its average.  This can be 
achieved by loading the alternative structures into another data pipe, and 
then specifying that pipe through the pipe argument.
 
-        A different set of structures than those loaded into the current 
data pipe can also be used
-        to determine the position, or its average.  This can be achieved by 
loading the alternative
-        structures into another data pipe, and then specifying that pipe 
through the pipe argument.
+If the average position flag is set to True, the average position from all 
models will be used as the position of the paramagnetic centre.  If False, 
then the positions from all structures will be used.  If multiple positions 
are used, then a fast paramagnetic centre motion will be assumed so that PCSs 
for a single tensor will be calculated for each position, and the PCS values 
linearly averaged.
+&quot;&quot;&quot;
+uf.prompt_examples = &quot;&quot;&quot;
+If the paramagnetic centre is the lanthanide Dysprosium which is labelled as 
Dy in a loaded
+PDB file, then type one of:
 
-        If the ave_pos flag is set to True, the average position from all 
models will be used as the
-        position of the paramagnetic centre.  If False, then the positions 
from all structures will
-        be used.  If multiple positions are used, then a fast paramagnetic 
centre motion will be
-        assumed so that PCSs for a single tensor will be calculated for each 
position, and the PCS
-        values linearly averaged.
+relax&gt; paramag.centre('Dy')
+relax&gt; paramag.centre(atom_id='Dy')
 
+If the carbon atom 'C1' of residue '4' in the PDB file is to be used as the 
paramagnetic
+centre, then type:
 
-        Examples
-        ~~~~~~~~
+relax&gt; paramag.centre(':4@C1')
 
-        If the paramagnetic centre is the lanthanide Dysprosium which is 
labelled as Dy in a loaded
-        PDB file, then type one of:
+To state that the Dy3+ atomic position is [0.136, 12.543, 4.356], type one 
of:
 
-        relax&gt; paramag.centre('Dy')
-        relax&gt; paramag.centre(atom_id='Dy')
+relax&gt; paramag.centre([0.136, 12.543, 4.356])
+relax&gt; paramag.centre(pos=[0.136, 12.543, 4.356])
 
-        If the carbon atom 'C1' of residue '4' in the PDB file is to be used 
as the paramagnetic
-        centre, then type:
+To find an unknown paramagnetic centre, type:
 
-        relax&gt; paramag.centre(':4@C1')
-        
-        To state that the Dy3+ atomic position is [0.136, 12.543, 4.356], 
type one of:
-
-        relax&gt; paramag.centre([0.136, 12.543, 4.356])
-        relax&gt; paramag.centre(pos=[0.136, 12.543, 4.356])
-
-        To find an unknown paramagnetic centre, type:
-
-        relax&gt; paramag.centre(fix=False)
-        &quot;&quot;&quot;
-
-        # Function intro text.
-        if status.prompt_intro:
-            text = status.ps3 + &quot;paramag.centre(&quot;
-            text = text + &quot;pos=&quot; + repr(pos)
-            text = text + &quot;, atom_id=&quot; + repr(atom_id)
-            text = text + &quot;, pipe=&quot; + repr(pipe)
-            text = text + &quot;, verbosity=&quot; + repr(verbosity)
-            text = text + &quot;, fix=&quot; + repr(fix)
-            text = text + &quot;, ave_pos=&quot; + repr(ave_pos)
-            text = text + &quot;, force=&quot; + repr(force) + &quot;)&quot;
-            print(text)
-
-        # The argument checks.
-        arg_check.is_num_list(pos, 'atomic position', size=3, 
can_be_none=True)
-        arg_check.is_str(atom_id, 'atom ID string', can_be_none=True)
-        arg_check.is_str(pipe, 'data pipe', can_be_none=True)
-        arg_check.is_int(verbosity, 'verbosity level')
-        arg_check.is_bool(fix, 'fix flag')
-        arg_check.is_bool(ave_pos, 'average position flag')
-        arg_check.is_bool(force, 'force flag')
-
-        # Execute the functional code.
-        paramag.centre(pos=pos, atom_id=atom_id, pipe=pipe, 
verbosity=verbosity, fix=fix, ave_pos=ave_pos, force=force)
+relax&gt; paramag.centre(fix=False)
+&quot;&quot;&quot;
+uf.backend = paramag.centre
+uf.menu_text = &quot;&amp;centre&quot;
+uf.wizard_height_desc = 400
+uf.wizard_size = (1000, 800)
+uf.wizard_apply_button = False



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu May 10 13:00:02 2012</div>  
</body>
</html>
