<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: [bug #11913] Problems with reading Sparky formatted file -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Sat, 05 Jul 2008 13:49:01 +0200 -->
<!--X-Message-Id: 7f080ed10807050448v6d846d05qe3f1d92dc8ef9a83@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20080627&#45;231018.sv11501.24819@gna.org -->
<!--X-Reference: 7f080ed10806280536v717e9da3r1db86a8bd14af401@mail.gmail.com -->
<!--X-Reference: 45B1B475&#45;D1A5&#45;4957&#45;8B7B&#45;A3E58E82AB45@gmail.com -->
<!--X-Reference: 7f080ed10807031123s4b95545er39edd5d168e5c4e@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [bug #11913] Problems with reading Sparky formatted file -- July 05, 2008 - 13:49</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: [bug #11913] Problems with reading Sparky formatted file</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00019" class="tabs">Index by Date</a> | <a href="threads.html#00019" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00018.html">Date Prev</a>] [<a href="msg00020.html">Date Next</a>] [<a href="msg00004.html">Thread Prev</a>] [<a href="msg00005.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;RMB Hoffman&quot; &lt;rmb.hoffman@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Sat, 5 Jul 2008 13:48:53 +0200</li>
<li class="menuitem">
<em>Cc</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00019.html">7f080ed10807050448v6d846d05qe3f1d92dc8ef9a83@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;20080627-231018.sv11501.24819@xxxxxxx&gt;	&lt;7f080ed10806280536v717e9da3r1db86a8bd14af401@xxxxxxxxxxxxxx&gt;	&lt;45B1B475-D1A5-4957-8B7B-A3E58E82AB45@xxxxxxxxx&gt;	&lt;7f080ed10807031123s4b95545er39edd5d168e5c4e@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on July 05, 2008 - 13:49:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Ryan,

I've added your file into the relax 1.3 repository line and have
created a system test around it (which currently fails).  You can get
a copy of this code, if you like, by typing:

svn co <a  rel="nofollow" href="http://svn.gna.org/svn/relax/1.3">http://svn.gna.org/svn/relax/1.3</a> relax-1.3

This requires subversion to be installed.  To see the test fail, just type:

relax --test-suite

or, more simply:

relax -x

To add support for this file, I've been trying to unsuccessfully find
information about the NMRView assignment format in the xpk file.
Would you know anything about this format?  Or do you have a useful
link, as those of the NMRView manual don't work at the moment?  I can
see which is the intensity column, although I don't know if this
changes is you use the peak height or peak volume as the intensity.
I'm also not sure if the number of columns per line is preserved.
With the assignment, e.g. {70.HN} and {70.N}, is 70 the residue number
or the spin system number?

For the 1.3 line, there are 5 pieces of information associated with a
single spin.  These are the molecule name, residue number, residue
name, spin number, and spin name and are generated and placed into the
relax data storage object by the sequence.read() or
structure.load_spins() user functions.  So the xpk assignment must in
some way match at least some of these to be read into the relax data
storage object.  If 70 is the residue number, this should be
sufficient.  Otherwise if it is the spin system number, then this is a
bit harder.  Is there another file output by NMRView which contains
more assignment information?

Regards,

Edward


On Thu, Jul 3, 2008 at 8:23 PM, Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt; 
wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">On Mon, Jun 30, 2008 at 3:18 AM, RMB Hoffman &lt;rmb.hoffman@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hello,

</pre><blockquote class="blockquote"><pre style="margin: 0em;">these peak lists.  So would it be ok if I add the debug.xpk file to
the relax test-suite (in the data store)?

</pre></blockquote><pre style="margin: 0em;">

Yes, that's okay.
</pre></blockquote><pre style="margin: 0em;">

Thanks.


</pre><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">If so, would you have a
more descriptive name for the file I can rename it to for better
identification?

</pre></blockquote><pre style="margin: 0em;">

For the purpose of having an identifier, we can call it &quot;cNTnC.xpk&quot;. I'm 
not
sure I understand the question...does that answer it?
</pre></blockquote><pre style="margin: 0em;">

Yes, that answers the question.  I just needed a more descriptive file
name so that it is more obvious what the file is.  I'll add the file
to relax and try to write a system test loading the peak heights.

Cheers,

Edward


</pre><blockquote class="blockquote"><pre style="margin: 0em;">

ry
</pre><blockquote class="blockquote"><pre style="margin: 0em;">

</pre></blockquote><pre style="margin: 0em;">On 28-Jun-08, at 6:36 AM, Edward d'Auvergne wrote:

</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

Thank you for the report.  This is a hard one to decide were to post
it.  Ideally the feature request and discussion would be posted to the
relax-devel mailing list and then I would create a task for this
(<a  rel="nofollow" href="https://web.archive.org/web/https://gna.org/task/?group=relax">https://gna.org/task/?group=relax</a>).  The bug would then be placed in
the bug tracker separately.  But, anyway, this is too complex and it
really doesn't matter.

So, for the NMRView peak list support, this can easily be added.  I'm
happy to add support for any input data into relax, and anyone is free
to add this to relax themselves if they wish.  Outputting to any
format will also be accepted.  There's not much point spending effort
on converting data to one of the formats relax currently supports.
The effort may be better spent adding the support directly to relax
(and this would be less effort anyway), and then everyone using
NMRView will benefit.

For the addition of this feature, I would like to first add a system
test to the relax test suite for the reading of this data before the
support is implemented.  This will make the addition of the NMRView
support much easier, and will safeguard the introduction of
regressions in future relax versions causing bugs in the reading of
these peak lists.  So would it be ok if I add the debug.xpk file to
the relax test-suite (in the data store)?  If so, would you have a
more descriptive name for the file I can rename it to for better
identification?  I will implement NMRView support in relax-1.3 and if
it not too disruptive, and only if you need it in the 1.2 versions,
maybe I'll port it back to the 1.2 line.

I might start a second thread for the Sparkly peak list reading bug.

Regards,

Edward


On Sat, Jun 28, 2008 at 1:10 AM, Ryan MB Hoffman
&lt;NO-REPLY.INVALID-ADDRESS@xxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">

URL:
 &lt;<a  rel="nofollow" href="http://gna.org/bugs/?11913">http://gna.org/bugs/?11913</a>&gt;

               Summary: Problems with reading Sparky formatted file
               Project: relax
          Submitted by: rydog
          Submitted on: Friday 06/27/2008 at 23:10
              Category: relax's source code
              Severity: 3 - Normal
              Priority: 5 - Normal
                Status: None
               Privacy: Public
           Assigned to: None
       Originator Name:
      Originator Email:
           Open/Closed: Open
       Discussion Lock: Any
               Release: 1.2.13
      Operating System: GNU/Linux

  _______________________________________________________

Details:

Hello,

First of all, I would like to request that relax support NMRView peak
lists.
I appreciate this is not the right location to request this, but the
community is still small, and I'm submitting a bug anyways. I have
attached
an example of this type of file (debug.xpk), and a Perl script that can
extract the volume lines (xpk2list.pl). They are attached as the tarball
&quot;convert.tgz&quot;

For the meantime, I have been converting the NMRView peaklists to Sparky
with
a script.

The actual session I/O looks like:


noe.read(name,file='cNTnC_noe0_3.list',spectrum_type='ref',format='sparky')
Reference spectrum.
Sparky formatted data file.

Opening the file 'cNTnC_noe0_3.list' for reading.
Number of header lines found: 2
RelaxError: Improperly formatted Sparky file.

I get the same error with a handful of .list files, generated either by
my
conversion scripts or from Sparky itself. Three files are attached. The
one
ending in '_2' was directly outputted from Sparky.




  _______________________________________________________

File Attachments:


-------------------------------------------------------
Date: Friday 06/27/2008 at 23:10  Name: cNTnC_noe0_2.list  Size: 8kB
By:
rydog

&lt;<a  rel="nofollow" href="http://gna.org/bugs/download.php?file_id=4485">http://gna.org/bugs/download.php?file_id=4485</a>&gt;
-------------------------------------------------------
Date: Friday 06/27/2008 at 23:10  Name: cNTnC_noe0_3.list  Size: 157B
By:
rydog

&lt;<a  rel="nofollow" href="http://gna.org/bugs/download.php?file_id=4486">http://gna.org/bugs/download.php?file_id=4486</a>&gt;
-------------------------------------------------------
Date: Friday 06/27/2008 at 23:10  Name: cNTnC_noe0-2.list  Size: 153B
By:
rydog

&lt;<a  rel="nofollow" href="http://gna.org/bugs/download.php?file_id=4487">http://gna.org/bugs/download.php?file_id=4487</a>&gt;
-------------------------------------------------------
Date: Friday 06/27/2008 at 23:10  Name: convert.tgz  Size: 776B   By:
rydog

&lt;<a  rel="nofollow" href="http://gna.org/bugs/download.php?file_id=4488">http://gna.org/bugs/download.php?file_id=4488</a>&gt;

  _______________________________________________________

Reply to this item at:

 &lt;<a  rel="nofollow" href="http://gna.org/bugs/?11913">http://gna.org/bugs/?11913</a>&gt;

_______________________________________________
 Message sent via/by Gna!
 <a  rel="nofollow" href="http://gna.org/">http://gna.org/</a>


_______________________________________________
relax (<a  rel="nofollow" href="http://nmr-relax.com">http://nmr-relax.com</a>)

This is the relax-devel mailing list
relax-devel@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="http://www.nmr-relax.com/mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a>

</pre></blockquote><pre style="margin: 0em;">

</pre></blockquote><pre style="margin: 0em;">


</pre></blockquote><pre style="margin: 0em;">

</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00004" href="msg00004.html">Re: [bug #11913] Problems with reading Sparky formatted file</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Sun Jul 06 15:02:36 2008</div>  
</body>
</html>
