<!-- MHonArc v2.6.16 -->
<!--X-Subject: r18152 &#45; in /branches/frame_order_testing: ./ generic_fns/	test_suite/unit_tests/_generic_fns/ -->
<!--X-From-R13: rqjneqNaze&#45;erynk.pbz -->
<!--X-Date: Mon, 17 Dec 2012 15:01:27 +0100 -->
<!--X-Message-Id: E1TkbG3&#45;0007uF&#45;5w@subversion.gna.org -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>r18152 - in /branches/frame_order_testing: ./ generic_fns/	test_suite/unit_tests/_generic_fns/ -- December 17, 2012 - 15:01</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />r18152 - in /branches/frame_order_testing: ./ generic_fns/	test_suite/unit_tests/_generic_fns/</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00086" class="tabs">Index by Date</a> | <a href="threads.html#00086" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00085.html">Date Prev</a>] [<a href="msg00087.html">Date Next</a>] [<a href="msg00085.html">Thread Prev</a>] [<a href="msg00087.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: relax-commits@xxxxxxx</li>
<li class="menuitem">
<em>Date</em>: Mon, 17 Dec 2012 14:01:27 -0000</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00086.html">E1TkbG3-0007uF-5w@subversion.gna.org</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>edward</strong> on December 17, 2012 - 15:01:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Author: bugman
Date: Mon Dec 17 15:01:26 2012
New Revision: 18152

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=18152&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=18152&amp;view=rev</a>
Log:
Merged revisions 18149-18151 via svnmerge from 
svn+ssh://bugman@xxxxxxxxxxx/svn/relax/trunk

........
  r18149 | bugman | 2012-12-17 12:57:18 +0100 (Mon, 17 Dec 2012) | 3 lines
  
  Created 4 unit tests to demonstrate the failure of the selection object 
with spin IDs.
........
  r18150 | bugman | 2012-12-17 14:35:23 +0100 (Mon, 17 Dec 2012) | 3 lines
  
  The molecule, residue and spin selection object now works with spin IDs.
........
  r18151 | bugman | 2012-12-17 14:41:02 +0100 (Mon, 17 Dec 2012) | 3 lines
  
  Docstring consistency editing for all parts of the generic_fns.mol_res_spin 
module.
........

Modified:
    branches/frame_order_testing/   (props changed)
    branches/frame_order_testing/generic_fns/mol_res_spin.py
    
branches/frame_order_testing/test_suite/unit_tests/_generic_fns/test_mol_res_spin.py

Propchange: branches/frame_order_testing/
------------------------------------------------------------------------------
--- svnmerge-integrated (original)
+++ svnmerge-integrated Mon Dec 17 15:01:26 2012
@@ -1,1 +1,1 @@
-/trunk:1-18147
+/trunk:1-18151

Modified: branches/frame_order_testing/generic_fns/mol_res_spin.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/frame_order_testing/generic_fns/mol_res_spin.py?rev=18152&amp;r1=18151&amp;r2=18152&amp;view=diff">http://svn.gna.org/viewcvs/relax/branches/frame_order_testing/generic_fns/mol_res_spin.py?rev=18152&amp;r1=18151&amp;r2=18152&amp;view=diff</a>
==============================================================================
--- branches/frame_order_testing/generic_fns/mol_res_spin.py (original)
+++ branches/frame_order_testing/generic_fns/mol_res_spin.py Mon Dec 17 
15:01:26 2012
@@ -27,10 +27,8 @@
     - Functions for parsing or generating spin identification strings.
     - The mol-res-spin selection object (derived from the Selection class).
     - Generator functions for looping over molecules, residues, or spins.
-    - Functions for returning MoleculeContainer, ResidueContainer, and 
SpinContainer objects or
-    information about these.
-    - Functions for copying, creating, deleting, displaying, naming, and 
numbering
-    MoleculeContainer, ResidueContainer, and SpinContainer objects in the 
relax data store.
+    - Functions for returning MoleculeContainer, ResidueContainer, and 
SpinContainer objects or information about these.
+    - Functions for copying, creating, deleting, displaying, naming, and 
numbering MoleculeContainer, ResidueContainer, and SpinContainer objects in 
the relax data store.
     - Functions for counting spins or testing their existence.
 &quot;&quot;&quot;
 
@@ -69,8 +67,7 @@
 class Selection(object):
     &quot;&quot;&quot;An object containing mol-res-spin selections.
 
-    A Selection object represents either a set of selected molecules, 
residues and spins, or the
-    union or intersection of two other Selection objects.
+    A Selection object represents either a set of selected molecules, 
residues and spins, or the union or intersection of two other Selection 
objects.
     &quot;&quot;&quot;
 
     def __init__(self, select_string):
@@ -119,9 +116,7 @@
     def __contains__(self, obj):
         &quot;&quot;&quot;Replacement function for determining if an object matches the 
selection.
 
-        @param obj:     The data object.  This can be a MoleculeContainer, 
ResidueContainer, or
-                        SpinContainer instance or a type of these instances. 
 If a tuple, only one
-                        type of object can be in the tuple.
+        @param obj:     The data object.  This can be a MoleculeContainer, 
ResidueContainer, or SpinContainer instance or a type of these instances.  If 
a tuple, only one type of object can be in the tuple.
         @type obj:      instance or type of instances.
         @return:        The answer of whether the object matches the 
selection.
         @rtype:         bool
@@ -147,9 +142,7 @@
     def __contains_mol_res_spin_containers(self, obj):
         &quot;&quot;&quot;Are the MoleculeContainer, ResidueContainer, and/or SpinContainer 
in the selection.
 
-        @param obj:     The data object.  This can be a MoleculeContainer, 
ResidueContainer, or
-                        SpinContainer instance or a type of these instances. 
 If a tuple, only one
-                        type of object can be in the tuple.
+        @param obj:     The data object.  This can be a MoleculeContainer, 
ResidueContainer, or SpinContainer instance or a type of these instances.  If 
a tuple, only one type of object can be in the tuple.
         @type obj:      instance or type of instances.
         @return:        The answer of whether the objects are found within 
the selection object.
         @rtype:         bool
@@ -265,19 +258,20 @@
 
         @param spin_id: The spin identification string.
         @type spin_id:  str
-        @return:        The answer of whether the molecule, residue, and/or 
spin corresponding to
-                        the spin_id string found within the selection object.
+        @return:        The answer of whether the molecule, residue, and/or 
spin corresponding to the spin_id string found within the selection object.
         @rtype:         bool
         &quot;&quot;&quot;
 
+        # No ID string.
+        if spin_id == '':
+            warn(RelaxWarning(&quot;The spin ID string '' is empty.&quot;))
+            return False
+
         # Parse the spin_id string.
-        try:
-            mol_token, res_token, spin_token = tokenise(spin_id)
-            molecules = parse_token(mol_token)
-            residues = parse_token(res_token)
-            spins = parse_token(spin_token)
-        except RelaxError:
-            warn(RelaxWarning(&quot;The spin identification string &quot; + 
repr(spin_id) + &quot; is too complex for the selection object.&quot;))
+        mol_name, res_num, res_name, spin_num, spin_name = 
spin_id_to_data_list(spin_id)
+
+        # Check if the spin is in the selection object.
+        return self.contains_spin(spin_num=spin_num, spin_name=spin_name, 
res_num=res_num, res_name=res_name, mol=mol_name)
 
 
     def contains_mol(self, mol=None):
@@ -285,8 +279,7 @@
 
         @keyword mol:   The name of the molecule.
         @type mol:      str or None
-        @return:        The answer of whether the molecule is contained 
withing the selection
-                        object.
+        @return:        The answer of whether the molecule is contained 
withing the selection object.
         @rtype:         bool
         &quot;&quot;&quot;
 
@@ -319,8 +312,7 @@
         @type res_name:     str or None
         @keyword mol:       The molecule name.
         @type mol:          str or None
-        @return:            The answer of whether the molecule is contained 
withing the selection
-                            object.
+        @return:            The answer of whether the molecule is contained 
withing the selection object.
         @rtype:             bool
         &quot;&quot;&quot;
 
@@ -363,8 +355,7 @@
         @type res_name:     str or None
         @keyword mol:       The molecule name.
         @type mol:          str or None
-        @return:            The answer of whether the spin is contained 
withing the selection
-                            object.
+        @return:            The answer of whether the spin is contained 
withing the selection object.
         @rtype:             bool
         &quot;&quot;&quot;
 
@@ -618,13 +609,12 @@
 
     For copying to be successful, the mol_from identification string must 
match an existent molecule.
 
-    @param pipe_from:   The data pipe to copy the molecule data from.  This 
defaults to the current
-                        data pipe.
+
+    @param pipe_from:   The data pipe to copy the molecule data from.  This 
defaults to the current data pipe.
     @type pipe_from:    str
     @param mol_from:    The molecule identification string for the structure 
to copy the data from.
     @type mol_from:     str
-    @param pipe_to:     The data pipe to copy the molecule data to.  This 
defaults to the current
-                        data pipe.
+    @param pipe_to:     The data pipe to copy the molecule data to.  This 
defaults to the current data pipe.
     @type pipe_to:      str
     @param mol_to:      The molecule identification string for the structure 
to copy the data to.
     @type mol_to:       str
@@ -693,16 +683,13 @@
 def copy_residue(pipe_from=None, res_from=None, pipe_to=None, res_to=None):
     &quot;&quot;&quot;Copy the contents of the residue structure from one residue to a new 
residue.
 
-    For copying to be successful, the res_from identification string must 
match an existent residue.
-    The new residue number must be unique.
-
-    @param pipe_from:   The data pipe to copy the residue from.  This 
defaults to the current data
-                        pipe.
+    For copying to be successful, the res_from identification string must 
match an existent residue. The new residue number must be unique.
+
+    @param pipe_from:   The data pipe to copy the residue from.  This 
defaults to the current data pipe.
     @type pipe_from:    str
     @param res_from:    The residue identification string for the structure 
to copy the data from.
     @type res_from:     str
-    @param pipe_to:     The data pipe to copy the residue to.  This defaults 
to the current data
-                        pipe.
+    @param pipe_to:     The data pipe to copy the residue to.  This defaults 
to the current data pipe.
     @type pipe_to:      str
     @param res_to:      The residue identification string for the structure 
to copy the data to.
     @type res_to:       str
@@ -774,16 +761,14 @@
 def copy_spin(pipe_from=None, spin_from=None, pipe_to=None, spin_to=None):
     &quot;&quot;&quot;Copy the contents of the spin structure from one spin to a new spin.
 
-    For copying to be successful, the spin_from identification string must 
match an existent spin.
-    The new spin number must be unique.
-
-    @param pipe_from:   The data pipe to copy the spin from.  This defaults 
to the current data
-                        pipe.
+    For copying to be successful, the spin_from identification string must 
match an existent spin. The new spin number must be unique.
+
+
+    @param pipe_from:   The data pipe to copy the spin from.  This defaults 
to the current data pipe.
     @type pipe_from:    str
     @param spin_from:   The spin identification string for the structure to 
copy the data from.
     @type spin_from:    str
-    @param pipe_to:     The data pipe to copy the spin to.  This defaults to 
the current data
-                        pipe.
+    @param pipe_to:     The data pipe to copy the spin to.  This defaults to 
the current data pipe.
     @type pipe_to:      str
     @param spin_to:     The spin identification string for the structure to 
copy the data to.
     @type spin_to:      str
@@ -926,8 +911,7 @@
     @type selection:        str
     @keyword pipe:          The data pipe containing the spin.  Defaults to 
the current data pipe.
     @type pipe:             str
-    @keyword skip_desel:    A flag which if true will cause deselected spins 
to be skipped in the
-                            count.
+    @keyword skip_desel:    A flag which if true will cause deselected spins 
to be skipped in the count.
     @type skip_desel:       bool
     @return:                The number of non-empty spins.
     @rtype:                 int
@@ -1265,8 +1249,7 @@
 
     @param global_index:        The global spin index, spanning the molecule 
and residue containers.
     @type global_index:         int
-    @param pipe:                The data pipe containing the spin.  Defaults 
to the current data
-                                pipe.
+    @param pipe:                The data pipe containing the spin.  Defaults 
to the current data pipe.
     @type pipe:                 str
     @return:                    The corresponding molecule, residue, and 
spin indices.
     @rtype:                     tuple of int
@@ -1545,8 +1528,7 @@
     @type selection:        str
     @keyword pipe:          The data pipe containing the spin.  Defaults to 
the current data pipe.
     @type pipe:             str
-    @keyword global_index:  A flag which if True will cause the global index 
to be returned.  If
-                            False, then the molecule, residue, and spin 
indices will be returned.
+    @keyword global_index:  A flag which if True will cause the global index 
to be returned.  If False, then the molecule, residue, and spin indices will 
be returned.
     @type global_index:     bool
     @return:                The global spin index or the molecule, residue, 
and spin indices.
     @rtype:                 int or tuple of 3 int
@@ -2367,13 +2349,10 @@
 def parse_token(token, verbosity=False):
     &quot;&quot;&quot;Parse the token string and return a list of identifying numbers and 
names.
 
-    Firstly the token is split by the ',' character into its individual 
elements and all whitespace
-    stripped from the elements.  Numbers are converted to integers, names 
are left as strings, and
-    ranges are converted into the full list of integers.
-
-    @param token:       The identification string, the elements of which are 
separated by commas.
-                        Each element can be either a single number, a range 
of numbers (two numbers
-                        separated by '-'), or a name.
+    Firstly the token is split by the ',' character into its individual 
elements and all whitespace stripped from the elements.  Numbers are 
converted to integers, names are left as strings, and ranges are converted 
into the full list of integers.
+
+
+    @param token:       The identification string, the elements of which are 
separated by commas. Each element can be either a single number, a range of 
numbers (two numbers separated by '-'), or a name.
     @type token:        str
     @keyword verbosity: A flag which if True will cause a number of 
printouts to be activated.
     @type verbosity:    bool
@@ -2666,6 +2645,7 @@
     &quot;&quot;&quot;Function for returning the spin data container of the given selection.
 
     If more than one selection is given, then the boolean AND operation will 
be used to pull out the spin.
+
 
     @keyword selection: The spin selection identifier.
     @type selection:    str
@@ -2751,16 +2731,12 @@
 
     @param global_index:        The global spin index, spanning the molecule 
and residue containers.
     @type global_index:         int
-    @param pipe:                The data pipe containing the spin.  Defaults 
to the current data
-                                pipe.
+    @param pipe:                The data pipe containing the spin.  Defaults 
to the current data pipe.
     @type pipe:                 str
-    @keyword return_spin_id:    A flag which if True will cause both the 
spin container and spin
-                                identification string to be returned.
+    @keyword return_spin_id:    A flag which if True will cause both the 
spin container and spin identification string to be returned.
     @type return_spin_id:       bool
-    @return:                    The spin specific data container 
(additionally the spin
-                                identification string if return_spin_id is 
set).
-    @rtype:                     instance of the SpinContainer class (or 
tuple of SpinContainer and
-                                str)
+    @return:                    The spin specific data container 
(additionally the spin identification string if return_spin_id is set).
+    @rtype:                     instance of the SpinContainer class (or 
tuple of SpinContainer and str)
     &quot;&quot;&quot;
 
     # The data pipe.
@@ -3275,8 +3251,7 @@
 def spin_in_list(spin_list, mol_name_col=None, res_num_col=None, 
res_name_col=None, spin_num_col=None, spin_name_col=None, mol_name=None, 
res_num=None, res_name=None, spin_num=None, spin_name=None):
     &quot;&quot;&quot;Function for determining if the spin is located within the list of 
spins.
 
-    @param spin_list:       The list of spins.  The first dimension 
corresponds to different spins,
-                            the second corresponds to the spin information 
columns.
+    @param spin_list:       The list of spins.  The first dimension 
corresponds to different spins, the second corresponds to the spin 
information columns.
     @type spin_list:        list of lists of str
     @keyword mol_name_col:  The column containing the molecule name 
information.
     @type mol_name_col:     int or None
@@ -3429,13 +3404,12 @@
 def tokenise(selection):
     &quot;&quot;&quot;Split the input selection string returning the mol_token, res_token, 
and spin_token strings.
 
-    The mol_token is identified as the text from the '#' to either the ':' 
or '@' characters or the
-    end of the string.
-
-    The res_token is identified as the text from the ':' to either the '@' 
character or the end of
-    the string.
+    The mol_token is identified as the text from the '#' to either the ':' 
or '@' characters or the end of the string.
+
+    The res_token is identified as the text from the ':' to either the '@' 
character or the end of the string.
 
     The spin_token is identified as the text from the '@' to the end of the 
string.
+
 
     @param selection:   The selection identifier.
     @type selection:    str

Modified: 
branches/frame_order_testing/test_suite/unit_tests/_generic_fns/test_mol_res_spin.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/frame_order_testing/test_suite/unit_tests/_generic_fns/test_mol_res_spin.py?rev=18152&amp;r1=18151&amp;r2=18152&amp;view=diff">http://svn.gna.org/viewcvs/relax/branches/frame_order_testing/test_suite/unit_tests/_generic_fns/test_mol_res_spin.py?rev=18152&amp;r1=18151&amp;r2=18152&amp;view=diff</a>
==============================================================================
--- 
branches/frame_order_testing/test_suite/unit_tests/_generic_fns/test_mol_res_spin.py
 (original)
+++ 
branches/frame_order_testing/test_suite/unit_tests/_generic_fns/test_mol_res_spin.py
 Mon Dec 17 15:01:26 2012
@@ -455,6 +455,46 @@
         self.assertEqual(obj.spins, [])
 
 
+    def test_Selection_range_contains_resid(self):
+        &quot;&quot;&quot;The Selection object &quot;:1-70&quot; contains the res ':1'.&quot;&quot;&quot;
+
+        # The Selection object.
+        obj = mol_res_spin.Selection(&quot;:1-70&quot;)
+
+        # Check that the residue ID is in the selection.
+        self.assert_(':1' in obj)
+
+
+    def test_Selection_range_contains_resid2(self):
+        &quot;&quot;&quot;The Selection object &quot;:1-70&quot; does not contain the res ':71'.&quot;&quot;&quot;
+
+        # The Selection object.
+        obj = mol_res_spin.Selection(&quot;:1-70&quot;)
+
+        # Check that the residue ID is in the selection.
+        self.assert_(':71' not in obj)
+
+
+    def test_Selection_range_contains_spinid(self):
+        &quot;&quot;&quot;The Selection object &quot;:1-70&quot; contains the spin ':1@N'.&quot;&quot;&quot;
+
+        # The Selection object.
+        obj = mol_res_spin.Selection(&quot;:1-70&quot;)
+
+        # Check that the residue ID is in the selection.
+        self.assert_(':1@N' in obj)
+
+
+    def test_Selection_range_contains_spinid2(self):
+        &quot;&quot;&quot;The Selection object &quot;:1-70&quot; does not contain the spin ':71@C'.&quot;&quot;&quot;
+
+        # The Selection object.
+        obj = mol_res_spin.Selection(&quot;:1-70&quot;)
+
+        # Check that the residue ID is in the selection.
+        self.assert_(':71@C' not in obj)
+
+
     def test_count_spins(self):
         &quot;&quot;&quot;Test that the number of spins can be properly counted.
 



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Mon Dec 17 19:00:02 2012</div>  
</body>
</html>
