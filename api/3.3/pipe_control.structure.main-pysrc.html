<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>pipe_control.structure.main</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
  <!--Google analytics JS-->
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30096326-1']);
    _gaq.push(['_setDomainName', 'nmr-relax.com']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://www.nmr-relax.com">relax</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="pipe_control-module.html">Package&nbsp;pipe_control</a> ::
        <a href="pipe_control.structure-module.html">Package&nbsp;structure</a> ::
        Module&nbsp;main
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="pipe_control.structure.main-pysrc.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<h1 class="epydoc">Source Code for <a href="pipe_control.structure.main-module.html">Module pipe_control.structure.main</a></h1>
<pre class="py-src">
<a name="L1"></a><tt class="py-lineno">   1</tt>  <tt class="py-line"><tt class="py-comment">###############################################################################</tt> </tt>
<a name="L2"></a><tt class="py-lineno">   2</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L3"></a><tt class="py-lineno">   3</tt>  <tt class="py-line"><tt class="py-comment"># Copyright (C) 2003-2015 Edward d'Auvergne                                   #</tt> </tt>
<a name="L4"></a><tt class="py-lineno">   4</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L5"></a><tt class="py-lineno">   5</tt>  <tt class="py-line"><tt class="py-comment"># This file is part of the program relax (http://www.nmr-relax.com).          #</tt> </tt>
<a name="L6"></a><tt class="py-lineno">   6</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L7"></a><tt class="py-lineno">   7</tt>  <tt class="py-line"><tt class="py-comment"># This program is free software: you can redistribute it and/or modify        #</tt> </tt>
<a name="L8"></a><tt class="py-lineno">   8</tt>  <tt class="py-line"><tt class="py-comment"># it under the terms of the GNU General Public License as published by        #</tt> </tt>
<a name="L9"></a><tt class="py-lineno">   9</tt>  <tt class="py-line"><tt class="py-comment"># the Free Software Foundation, either version 3 of the License, or           #</tt> </tt>
<a name="L10"></a><tt class="py-lineno">  10</tt>  <tt class="py-line"><tt class="py-comment"># (at your option) any later version.                                         #</tt> </tt>
<a name="L11"></a><tt class="py-lineno">  11</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L12"></a><tt class="py-lineno">  12</tt>  <tt class="py-line"><tt class="py-comment"># This program is distributed in the hope that it will be useful,             #</tt> </tt>
<a name="L13"></a><tt class="py-lineno">  13</tt>  <tt class="py-line"><tt class="py-comment"># but WITHOUT ANY WARRANTY; without even the implied warranty of              #</tt> </tt>
<a name="L14"></a><tt class="py-lineno">  14</tt>  <tt class="py-line"><tt class="py-comment"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the               #</tt> </tt>
<a name="L15"></a><tt class="py-lineno">  15</tt>  <tt class="py-line"><tt class="py-comment"># GNU General Public License for more details.                                #</tt> </tt>
<a name="L16"></a><tt class="py-lineno">  16</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L17"></a><tt class="py-lineno">  17</tt>  <tt class="py-line"><tt class="py-comment"># You should have received a copy of the GNU General Public License           #</tt> </tt>
<a name="L18"></a><tt class="py-lineno">  18</tt>  <tt class="py-line"><tt class="py-comment"># along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.       #</tt> </tt>
<a name="L19"></a><tt class="py-lineno">  19</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L20"></a><tt class="py-lineno">  20</tt>  <tt class="py-line"><tt class="py-comment">###############################################################################</tt> </tt>
<a name="L21"></a><tt class="py-lineno">  21</tt>  <tt class="py-line"> </tt>
<a name="L22"></a><tt class="py-lineno">  22</tt>  <tt class="py-line"><tt class="py-comment"># Python module imports.</tt> </tt>
<a name="L23"></a><tt class="py-lineno">  23</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-0" class="py-name" targets="Package minfx=minfx-module.html"><a title="minfx" class="py-name" href="#" onclick="return doclink('link-0', 'minfx', 'link-0');">minfx</a></tt><tt class="py-op">.</tt><tt id="link-1" class="py-name" targets="Module minfx.generic=minfx.generic-module.html,Module test_suite.system_tests.generic=test_suite.system_tests.generic-module.html"><a title="minfx.generic
test_suite.system_tests.generic" class="py-name" href="#" onclick="return doclink('link-1', 'generic', 'link-1');">generic</a></tt> <tt class="py-keyword">import</tt> <tt id="link-2" class="py-name" targets="Function minfx.generic.generic_minimise()=minfx.generic-module.html#generic_minimise"><a title="minfx.generic.generic_minimise" class="py-name" href="#" onclick="return doclink('link-2', 'generic_minimise', 'link-2');">generic_minimise</a></tt> </tt>
<a name="L24"></a><tt class="py-lineno">  24</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">numpy</tt> <tt class="py-keyword">import</tt> <tt class="py-name">array</tt><tt class="py-op">,</tt> <tt class="py-name">average</tt><tt class="py-op">,</tt> <tt class="py-name">dot</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">,</tt> <tt id="link-3" class="py-name" targets="Method lib.structure.internal.object.Internal.mean()=lib.structure.internal.object.Internal-class.html#mean"><a title="lib.structure.internal.object.Internal.mean" class="py-name" href="#" onclick="return doclink('link-3', 'mean', 'link-3');">mean</a></tt><tt class="py-op">,</tt> <tt id="link-4" class="py-name" targets="Function lib.statistics.std()=lib.statistics-module.html#std"><a title="lib.statistics.std" class="py-name" href="#" onclick="return doclink('link-4', 'std', 'link-4');">std</a></tt><tt class="py-op">,</tt> <tt class="py-name">zeros</tt> </tt>
<a name="L25"></a><tt class="py-lineno">  25</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">numpy</tt><tt class="py-op">.</tt><tt class="py-name">linalg</tt> <tt class="py-keyword">import</tt> <tt id="link-5" class="py-name" targets="Function lib.compat.norm()=lib.compat-module.html#norm"><a title="lib.compat.norm" class="py-name" href="#" onclick="return doclink('link-5', 'norm', 'link-5');">norm</a></tt> </tt>
<a name="L26"></a><tt class="py-lineno">  26</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">os</tt> <tt class="py-keyword">import</tt> <tt class="py-name">F_OK</tt><tt class="py-op">,</tt> <tt class="py-name">access</tt><tt class="py-op">,</tt> <tt class="py-name">getcwd</tt> </tt>
<a name="L27"></a><tt class="py-lineno">  27</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">re</tt> <tt class="py-keyword">import</tt> <tt id="link-6" class="py-name" targets="Function lib.regex.search()=lib.regex-module.html#search"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-6', 'search', 'link-6');">search</a></tt> </tt>
<a name="L28"></a><tt class="py-lineno">  28</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">sys</tt> </tt>
<a name="L29"></a><tt class="py-lineno">  29</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-7" class="py-name" targets="Module lib.warnings=lib.warnings-module.html"><a title="lib.warnings" class="py-name" href="#" onclick="return doclink('link-7', 'warnings', 'link-7');">warnings</a></tt> <tt class="py-keyword">import</tt> <tt class="py-name">warn</tt> </tt>
<a name="L30"></a><tt class="py-lineno">  30</tt>  <tt class="py-line"> </tt>
<a name="L31"></a><tt class="py-lineno">  31</tt>  <tt class="py-line"><tt class="py-comment"># relax module imports.</tt> </tt>
<a name="L32"></a><tt class="py-lineno">  32</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-8" class="py-name" targets="Package data_store=data_store-module.html"><a title="data_store" class="py-name" href="#" onclick="return doclink('link-8', 'data_store', 'link-8');">data_store</a></tt> <tt class="py-keyword">import</tt> <tt id="link-9" class="py-name" targets="Class data_store.Relax_data_store=data_store.Relax_data_store-class.html"><a title="data_store.Relax_data_store" class="py-name" href="#" onclick="return doclink('link-9', 'Relax_data_store', 'link-9');">Relax_data_store</a></tt><tt class="py-op">;</tt> <tt id="link-10" class="py-name" targets="Variable auto_analyses.frame_order.ds=auto_analyses.frame_order-module.html#ds,Variable gui.analyses.auto_model_free.ds=gui.analyses.auto_model_free-module.html#ds,Variable gui.analyses.auto_noe.ds=gui.analyses.auto_noe-module.html#ds,Variable gui.analyses.auto_relax_disp.ds=gui.analyses.auto_relax_disp-module.html#ds,Variable gui.analyses.auto_rx_base.ds=gui.analyses.auto_rx_base-module.html#ds,Variable gui.analyses.ds=gui.analyses-module.html#ds,Variable gui.components.free_file_format.ds=gui.components.free_file_format-module.html#ds,Variable gui.components.grid.ds=gui.components.grid-module.html#ds,Variable gui.pipe_editor.ds=gui.pipe_editor-module.html#ds,Variable gui.relax_gui.ds=gui.relax_gui-module.html#ds,Variable gui.results_viewer.ds=gui.results_viewer-module.html#ds,Variable gui.wizards.wiz_objects.ds=gui.wizards.wiz_objects-module.html#ds,Variable pipe_control.bmrb.ds=pipe_control.bmrb-module.html#ds,Variable pipe_control.pipes.ds=pipe_control.pipes-module.html#ds,Variable pipe_control.relax_data.ds=pipe_control.relax_data-module.html#ds,Variable pipe_control.reset.ds=pipe_control.reset-module.html#ds,Variable pipe_control.results.ds=pipe_control.results-module.html#ds,Variable pipe_control.state.ds=pipe_control.state-module.html#ds,Variable pipe_control.structure.main.ds=pipe_control.structure.main-module.html#ds,Variable specific_analyses.api.ds=specific_analyses.api-module.html#ds,Variable test_suite.gui_tests.base_classes.ds=test_suite.gui_tests.base_classes-module.html#ds,Variable test_suite.gui_tests.bmrb.ds=test_suite.gui_tests.bmrb-module.html#ds,Variable test_suite.gui_tests.bruker.ds=test_suite.gui_tests.bruker-module.html#ds,Variable test_suite.gui_tests.model_free.ds=test_suite.gui_tests.model_free-module.html#ds,Variable test_suite.gui_tests.noe.ds=test_suite.gui_tests.noe-module.html#ds,Variable test_suite.gui_tests.relax_disp.ds=test_suite.gui_tests.relax_disp-module.html#ds,Variable test_suite.gui_tests.rx.ds=test_suite.gui_tests.rx-module.html#ds,Variable test_suite.gui_tests.state.ds=test_suite.gui_tests.state-module.html#ds,Variable test_suite.system_tests.align_tensor.ds=test_suite.system_tests.align_tensor-module.html#ds,Variable test_suite.system_tests.angles.ds=test_suite.system_tests.angles-module.html#ds,Variable test_suite.system_tests.base_classes.ds=test_suite.system_tests.base_classes-module.html#ds,Variable test_suite.system_tests.bmrb.ds=test_suite.system_tests.bmrb-module.html#ds,Variable test_suite.system_tests.bruker.ds=test_suite.system_tests.bruker-module.html#ds,Variable test_suite.system_tests.consistency_tests.ds=test_suite.system_tests.consistency_tests-module.html#ds,Variable test_suite.system_tests.dasha.ds=test_suite.system_tests.dasha-module.html#ds,Variable test_suite.system_tests.diffusion_tensor.ds=test_suite.system_tests.diffusion_tensor-module.html#ds,Variable test_suite.system_tests.frame_order.ds=test_suite.system_tests.frame_order-module.html#ds,Variable test_suite.system_tests.generic.ds=test_suite.system_tests.generic-module.html#ds,Variable test_suite.system_tests.interatomic.ds=test_suite.system_tests.interatomic-module.html#ds,Variable test_suite.system_tests.jw_mapping.ds=test_suite.system_tests.jw_mapping-module.html#ds,Variable test_suite.system_tests.load_spins.ds=test_suite.system_tests.load_spins-module.html#ds,Variable test_suite.system_tests.model_elimination.ds=test_suite.system_tests.model_elimination-module.html#ds,Variable test_suite.system_tests.model_free.ds=test_suite.system_tests.model_free-module.html#ds,Variable test_suite.system_tests.model_selection.ds=test_suite.system_tests.model_selection-module.html#ds,Variable test_suite.system_tests.mol_res_spin.ds=test_suite.system_tests.mol_res_spin-module.html#ds,Variable test_suite.system_tests.n_state_model.ds=test_suite.system_tests.n_state_model-module.html#ds,Variable test_suite.system_tests.noe.ds=test_suite.system_tests.noe-module.html#ds,Variable test_suite.system_tests.noe_restraints.ds=test_suite.system_tests.noe_restraints-module.html#ds,Variable test_suite.system_tests.palmer.ds=test_suite.system_tests.palmer-module.html#ds,Variable test_suite.system_tests.pcs.ds=test_suite.system_tests.pcs-module.html#ds,Variable test_suite.system_tests.peak_lists.ds=test_suite.system_tests.peak_lists-module.html#ds,Variable test_suite.system_tests.pipes.ds=test_suite.system_tests.pipes-module.html#ds,Variable test_suite.system_tests.rdc.ds=test_suite.system_tests.rdc-module.html#ds,Variable test_suite.system_tests.relax_disp.ds=test_suite.system_tests.relax_disp-module.html#ds,Variable test_suite.system_tests.relax_fit.ds=test_suite.system_tests.relax_fit-module.html#ds,Variable test_suite.system_tests.results.ds=test_suite.system_tests.results-module.html#ds,Variable test_suite.system_tests.sequence.ds=test_suite.system_tests.sequence-module.html#ds,Variable test_suite.system_tests.spectrum.ds=test_suite.system_tests.spectrum-module.html#ds,Variable test_suite.system_tests.state.ds=test_suite.system_tests.state-module.html#ds,Variable test_suite.system_tests.structure.ds=test_suite.system_tests.structure-module.html#ds,Variable test_suite.system_tests.unit_vectors.ds=test_suite.system_tests.unit_vectors-module.html#ds,Variable test_suite.system_tests.value.ds=test_suite.system_tests.value-module.html#ds,Variable test_suite.unit_tests._data_store.test___init__.ds=test_suite.unit_tests._data_store.test___init__-module.html#ds,Variable test_suite.unit_tests._pipe_control._structure.test_internal.ds=test_suite.unit_tests._pipe_control._structure.test_internal-module.html#ds,Variable test_suite.unit_tests._pipe_control.test_mol_res_spin.ds=test_suite.unit_tests._pipe_control.test_mol_res_spin-module.html#ds,Variable test_suite.unit_tests._pipe_control.test_pipes.ds=test_suite.unit_tests._pipe_control.test_pipes-module.html#ds,Variable test_suite.unit_tests._pipe_control.test_selection.ds=test_suite.unit_tests._pipe_control.test_selection-module.html#ds,Variable test_suite.unit_tests._specific_analyses._model_free.test_api.ds=test_suite.unit_tests._specific_analyses._model_free.test_api-module.html#ds,Variable test_suite.unit_tests._specific_analyses._relax_disp.test_data.ds=test_suite.unit_tests._specific_analyses._relax_disp.test_data-module.html#ds,Variable test_suite.unit_tests.align_tensor_testing_base.ds=test_suite.unit_tests.align_tensor_testing_base-module.html#ds,Variable test_suite.unit_tests.base_classes.ds=test_suite.unit_tests.base_classes-module.html#ds,Variable test_suite.unit_tests.diffusion_tensor_testing_base.ds=test_suite.unit_tests.diffusion_tensor_testing_base-module.html#ds,Variable test_suite.unit_tests.minimisation_testing_base.ds=test_suite.unit_tests.minimisation_testing_base-module.html#ds,Variable test_suite.unit_tests.model_free_testing_base.ds=test_suite.unit_tests.model_free_testing_base-module.html#ds,Variable test_suite.unit_tests.molecule_testing_base.ds=test_suite.unit_tests.molecule_testing_base-module.html#ds,Variable test_suite.unit_tests.n_state_model_testing_base.ds=test_suite.unit_tests.n_state_model_testing_base-module.html#ds,Variable test_suite.unit_tests.relax_data_testing_base.ds=test_suite.unit_tests.relax_data_testing_base-module.html#ds,Variable test_suite.unit_tests.residue_testing_base.ds=test_suite.unit_tests.residue_testing_base-module.html#ds,Variable test_suite.unit_tests.sequence_testing_base.ds=test_suite.unit_tests.sequence_testing_base-module.html#ds,Variable test_suite.unit_tests.spin_testing_base.ds=test_suite.unit_tests.spin_testing_base-module.html#ds,Variable test_suite.unit_tests.state_testing_base.ds=test_suite.unit_tests.state_testing_base-module.html#ds,Variable test_suite.unit_tests.structure_testing_base.ds=test_suite.unit_tests.structure_testing_base-module.html#ds,Variable test_suite.unit_tests.value_testing_base.ds=test_suite.unit_tests.value_testing_base-module.html#ds"><a title="auto_analyses.frame_order.ds
gui.analyses.auto_model_free.ds
gui.analyses.auto_noe.ds
gui.analyses.auto_relax_disp.ds
gui.analyses.auto_rx_base.ds
gui.analyses.ds
gui.components.free_file_format.ds
gui.components.grid.ds
gui.pipe_editor.ds
gui.relax_gui.ds
gui.results_viewer.ds
gui.wizards.wiz_objects.ds
pipe_control.bmrb.ds
pipe_control.pipes.ds
pipe_control.relax_data.ds
pipe_control.reset.ds
pipe_control.results.ds
pipe_control.state.ds
pipe_control.structure.main.ds
specific_analyses.api.ds
test_suite.gui_tests.base_classes.ds
test_suite.gui_tests.bmrb.ds
test_suite.gui_tests.bruker.ds
test_suite.gui_tests.model_free.ds
test_suite.gui_tests.noe.ds
test_suite.gui_tests.relax_disp.ds
test_suite.gui_tests.rx.ds
test_suite.gui_tests.state.ds
test_suite.system_tests.align_tensor.ds
test_suite.system_tests.angles.ds
test_suite.system_tests.base_classes.ds
test_suite.system_tests.bmrb.ds
test_suite.system_tests.bruker.ds
test_suite.system_tests.consistency_tests.ds
test_suite.system_tests.dasha.ds
test_suite.system_tests.diffusion_tensor.ds
test_suite.system_tests.frame_order.ds
test_suite.system_tests.generic.ds
test_suite.system_tests.interatomic.ds
test_suite.system_tests.jw_mapping.ds
test_suite.system_tests.load_spins.ds
test_suite.system_tests.model_elimination.ds
test_suite.system_tests.model_free.ds
test_suite.system_tests.model_selection.ds
test_suite.system_tests.mol_res_spin.ds
test_suite.system_tests.n_state_model.ds
test_suite.system_tests.noe.ds
test_suite.system_tests.noe_restraints.ds
test_suite.system_tests.palmer.ds
test_suite.system_tests.pcs.ds
test_suite.system_tests.peak_lists.ds
test_suite.system_tests.pipes.ds
test_suite.system_tests.rdc.ds
test_suite.system_tests.relax_disp.ds
test_suite.system_tests.relax_fit.ds
test_suite.system_tests.results.ds
test_suite.system_tests.sequence.ds
test_suite.system_tests.spectrum.ds
test_suite.system_tests.state.ds
test_suite.system_tests.structure.ds
test_suite.system_tests.unit_vectors.ds
test_suite.system_tests.value.ds
test_suite.unit_tests._data_store.test___init__.ds
test_suite.unit_tests._pipe_control._structure.test_internal.ds
test_suite.unit_tests._pipe_control.test_mol_res_spin.ds
test_suite.unit_tests._pipe_control.test_pipes.ds
test_suite.unit_tests._pipe_control.test_selection.ds
test_suite.unit_tests._specific_analyses._model_free.test_api.ds
test_suite.unit_tests._specific_analyses._relax_disp.test_data.ds
test_suite.unit_tests.align_tensor_testing_base.ds
test_suite.unit_tests.base_classes.ds
test_suite.unit_tests.diffusion_tensor_testing_base.ds
test_suite.unit_tests.minimisation_testing_base.ds
test_suite.unit_tests.model_free_testing_base.ds
test_suite.unit_tests.molecule_testing_base.ds
test_suite.unit_tests.n_state_model_testing_base.ds
test_suite.unit_tests.relax_data_testing_base.ds
test_suite.unit_tests.residue_testing_base.ds
test_suite.unit_tests.sequence_testing_base.ds
test_suite.unit_tests.spin_testing_base.ds
test_suite.unit_tests.state_testing_base.ds
test_suite.unit_tests.structure_testing_base.ds
test_suite.unit_tests.value_testing_base.ds" class="py-name" href="#" onclick="return doclink('link-10', 'ds', 'link-10');">ds</a></tt> <tt class="py-op">=</tt> <tt id="link-11" class="py-name"><a title="data_store.Relax_data_store" class="py-name" href="#" onclick="return doclink('link-11', 'Relax_data_store', 'link-9');">Relax_data_store</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L33"></a><tt class="py-lineno">  33</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-12" class="py-name"><a title="data_store" class="py-name" href="#" onclick="return doclink('link-12', 'data_store', 'link-8');">data_store</a></tt><tt class="py-op">.</tt><tt id="link-13" class="py-name" targets="Module data_store.seq_align=data_store.seq_align-module.html"><a title="data_store.seq_align" class="py-name" href="#" onclick="return doclink('link-13', 'seq_align', 'link-13');">seq_align</a></tt> <tt class="py-keyword">import</tt> <tt id="link-14" class="py-name" targets="Class data_store.seq_align.Sequence_alignments=data_store.seq_align.Sequence_alignments-class.html"><a title="data_store.seq_align.Sequence_alignments" class="py-name" href="#" onclick="return doclink('link-14', 'Sequence_alignments', 'link-14');">Sequence_alignments</a></tt> </tt>
<a name="L34"></a><tt class="py-lineno">  34</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-15" class="py-name" targets="Package lib=lib-module.html"><a title="lib" class="py-name" href="#" onclick="return doclink('link-15', 'lib', 'link-15');">lib</a></tt><tt class="py-op">.</tt><tt id="link-16" class="py-name" targets="Module lib.check_types=lib.check_types-module.html"><a title="lib.check_types" class="py-name" href="#" onclick="return doclink('link-16', 'check_types', 'link-16');">check_types</a></tt> <tt class="py-keyword">import</tt> <tt id="link-17" class="py-name" targets="Function lib.arg_check.is_float()=lib.arg_check-module.html#is_float,Function lib.check_types.is_float()=lib.check_types-module.html#is_float"><a title="lib.arg_check.is_float
lib.check_types.is_float" class="py-name" href="#" onclick="return doclink('link-17', 'is_float', 'link-17');">is_float</a></tt> </tt>
<a name="L35"></a><tt class="py-lineno">  35</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-18" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-18', 'lib', 'link-15');">lib</a></tt><tt class="py-op">.</tt><tt id="link-19" class="py-name" targets="Module gui.errors=gui.errors-module.html,Module lib.errors=lib.errors-module.html,Module minfx.errors=minfx.errors-module.html"><a title="gui.errors
lib.errors
minfx.errors" class="py-name" href="#" onclick="return doclink('link-19', 'errors', 'link-19');">errors</a></tt> <tt class="py-keyword">import</tt> <tt id="link-20" class="py-name" targets="Class lib.errors.RelaxError=lib.errors.RelaxError-class.html"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-20', 'RelaxError', 'link-20');">RelaxError</a></tt><tt class="py-op">,</tt> <tt id="link-21" class="py-name" targets="Class lib.errors.RelaxFileError=lib.errors.RelaxFileError-class.html"><a title="lib.errors.RelaxFileError" class="py-name" href="#" onclick="return doclink('link-21', 'RelaxFileError', 'link-21');">RelaxFileError</a></tt> </tt>
<a name="L36"></a><tt class="py-lineno">  36</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-22" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-22', 'lib', 'link-15');">lib</a></tt><tt class="py-op">.</tt><tt id="link-23" class="py-name" targets="Package lib.geometry=lib.geometry-module.html"><a title="lib.geometry" class="py-name" href="#" onclick="return doclink('link-23', 'geometry', 'link-23');">geometry</a></tt><tt class="py-op">.</tt><tt id="link-24" class="py-name" targets="Module lib.geometry.vectors=lib.geometry.vectors-module.html,Function pipe_control.structure.main.vectors()=pipe_control.structure.main-module.html#vectors"><a title="lib.geometry.vectors
pipe_control.structure.main.vectors" class="py-name" href="#" onclick="return doclink('link-24', 'vectors', 'link-24');">vectors</a></tt> <tt class="py-keyword">import</tt> <tt id="link-25" class="py-name" targets="Function lib.geometry.vectors.vector_angle_atan2()=lib.geometry.vectors-module.html#vector_angle_atan2"><a title="lib.geometry.vectors.vector_angle_atan2" class="py-name" href="#" onclick="return doclink('link-25', 'vector_angle_atan2', 'link-25');">vector_angle_atan2</a></tt> </tt>
<a name="L37"></a><tt class="py-lineno">  37</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-26" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-26', 'lib', 'link-15');">lib</a></tt><tt class="py-op">.</tt><tt id="link-27" class="py-name" targets="Module lib.io=lib.io-module.html"><a title="lib.io" class="py-name" href="#" onclick="return doclink('link-27', 'io', 'link-27');">io</a></tt> <tt class="py-keyword">import</tt> <tt id="link-28" class="py-name" targets="Function lib.io.get_file_path()=lib.io-module.html#get_file_path"><a title="lib.io.get_file_path" class="py-name" href="#" onclick="return doclink('link-28', 'get_file_path', 'link-28');">get_file_path</a></tt><tt class="py-op">,</tt> <tt id="link-29" class="py-name" targets="Function lib.io.open_write_file()=lib.io-module.html#open_write_file"><a title="lib.io.open_write_file" class="py-name" href="#" onclick="return doclink('link-29', 'open_write_file', 'link-29');">open_write_file</a></tt><tt class="py-op">,</tt> <tt id="link-30" class="py-name" targets="Function lib.io.write_data()=lib.io-module.html#write_data,Function pipe_control.value.write_data()=pipe_control.value-module.html#write_data"><a title="lib.io.write_data
pipe_control.value.write_data" class="py-name" href="#" onclick="return doclink('link-30', 'write_data', 'link-30');">write_data</a></tt> </tt>
<a name="L38"></a><tt class="py-lineno">  38</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-31" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-31', 'lib', 'link-15');">lib</a></tt><tt class="py-op">.</tt><tt id="link-32" class="py-name" targets="Package lib.plotting=lib.plotting-module.html,Module pipe_control.plotting=pipe_control.plotting-module.html"><a title="lib.plotting
pipe_control.plotting" class="py-name" href="#" onclick="return doclink('link-32', 'plotting', 'link-32');">plotting</a></tt><tt class="py-op">.</tt><tt id="link-33" class="py-name" targets="Module lib.plotting.api=lib.plotting.api-module.html,Module specific_analyses.api=specific_analyses.api-module.html,Module specific_analyses.consistency_tests.api=specific_analyses.consistency_tests.api-module.html,Module specific_analyses.frame_order.api=specific_analyses.frame_order.api-module.html,Module specific_analyses.jw_mapping.api=specific_analyses.jw_mapping.api-module.html,Module specific_analyses.model_free.api=specific_analyses.model_free.api-module.html,Module specific_analyses.n_state_model.api=specific_analyses.n_state_model.api-module.html,Module specific_analyses.noe.api=specific_analyses.noe.api-module.html,Module specific_analyses.relax_disp.api=specific_analyses.relax_disp.api-module.html,Module specific_analyses.relax_fit.api=specific_analyses.relax_fit.api-module.html"><a title="lib.plotting.api
specific_analyses.api
specific_analyses.consistency_tests.api
specific_analyses.frame_order.api
specific_analyses.jw_mapping.api
specific_analyses.model_free.api
specific_analyses.n_state_model.api
specific_analyses.noe.api
specific_analyses.relax_disp.api
specific_analyses.relax_fit.api" class="py-name" href="#" onclick="return doclink('link-33', 'api', 'link-33');">api</a></tt> <tt class="py-keyword">import</tt> <tt id="link-34" class="py-name" targets="Function lib.plotting.api.correlation_matrix()=lib.plotting.api-module.html#correlation_matrix,Function lib.plotting.gnuplot.correlation_matrix()=lib.plotting.gnuplot-module.html#correlation_matrix,Function lib.plotting.text.correlation_matrix()=lib.plotting.text-module.html#correlation_matrix"><a title="lib.plotting.api.correlation_matrix
lib.plotting.gnuplot.correlation_matrix
lib.plotting.text.correlation_matrix" class="py-name" href="#" onclick="return doclink('link-34', 'correlation_matrix', 'link-34');">correlation_matrix</a></tt> </tt>
<a name="L39"></a><tt class="py-lineno">  39</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-35" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-35', 'lib', 'link-15');">lib</a></tt><tt class="py-op">.</tt><tt id="link-36" class="py-name" targets="Module lib.selection=lib.selection-module.html,Method lib.structure.internal.object.Internal.selection()=lib.structure.internal.object.Internal-class.html#selection,Module lib.structure.internal.selection=lib.structure.internal.selection-module.html,Module pipe_control.selection=pipe_control.selection-module.html,Module test_suite.system_tests.selection=test_suite.system_tests.selection-module.html"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-36', 'selection', 'link-36');">selection</a></tt> <tt class="py-keyword">import</tt> <tt id="link-37" class="py-name" targets="Function lib.selection.tokenise()=lib.selection-module.html#tokenise"><a title="lib.selection.tokenise" class="py-name" href="#" onclick="return doclink('link-37', 'tokenise', 'link-37');">tokenise</a></tt> </tt>
<a name="L40"></a><tt class="py-lineno">  40</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-38" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-38', 'lib', 'link-15');">lib</a></tt><tt class="py-op">.</tt><tt id="link-39" class="py-name" targets="Module gui.input_elements.sequence=gui.input_elements.sequence-module.html,Module lib.sequence=lib.sequence-module.html,Module pipe_control.sequence=pipe_control.sequence-module.html,Module test_suite.system_tests.sequence=test_suite.system_tests.sequence-module.html,Module user_functions.sequence=user_functions.sequence-module.html"><a title="gui.input_elements.sequence
lib.sequence
pipe_control.sequence
test_suite.system_tests.sequence
user_functions.sequence" class="py-name" href="#" onclick="return doclink('link-39', 'sequence', 'link-39');">sequence</a></tt> <tt class="py-keyword">import</tt> <tt id="link-40" class="py-name" targets="Function lib.sequence.write_spin_data()=lib.sequence-module.html#write_spin_data"><a title="lib.sequence.write_spin_data" class="py-name" href="#" onclick="return doclink('link-40', 'write_spin_data', 'link-40');">write_spin_data</a></tt> </tt>
<a name="L41"></a><tt class="py-lineno">  41</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-41" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-41', 'lib', 'link-15');">lib</a></tt><tt class="py-op">.</tt><tt id="link-42" class="py-name" targets="Package lib.sequence_alignment=lib.sequence_alignment-module.html,Function pipe_control.structure.main.sequence_alignment()=pipe_control.structure.main-module.html#sequence_alignment"><a title="lib.sequence_alignment
pipe_control.structure.main.sequence_alignment" class="py-name" href="#" onclick="return doclink('link-42', 'sequence_alignment', 'link-42');">sequence_alignment</a></tt><tt class="py-op">.</tt><tt id="link-43" class="py-name" targets="Module lib.sequence_alignment.msa=lib.sequence_alignment.msa-module.html"><a title="lib.sequence_alignment.msa" class="py-name" href="#" onclick="return doclink('link-43', 'msa', 'link-43');">msa</a></tt> <tt class="py-keyword">import</tt> <tt id="link-44" class="py-name" targets="Function lib.sequence_alignment.msa.msa_general()=lib.sequence_alignment.msa-module.html#msa_general"><a title="lib.sequence_alignment.msa.msa_general" class="py-name" href="#" onclick="return doclink('link-44', 'msa_general', 'link-44');">msa_general</a></tt><tt class="py-op">,</tt> <tt id="link-45" class="py-name" targets="Function lib.sequence_alignment.msa.msa_residue_numbers()=lib.sequence_alignment.msa-module.html#msa_residue_numbers"><a title="lib.sequence_alignment.msa.msa_residue_numbers" class="py-name" href="#" onclick="return doclink('link-45', 'msa_residue_numbers', 'link-45');">msa_residue_numbers</a></tt><tt class="py-op">,</tt> <tt id="link-46" class="py-name" targets="Function lib.sequence_alignment.msa.msa_residue_skipping()=lib.sequence_alignment.msa-module.html#msa_residue_skipping"><a title="lib.sequence_alignment.msa.msa_residue_skipping" class="py-name" href="#" onclick="return doclink('link-46', 'msa_residue_skipping', 'link-46');">msa_residue_skipping</a></tt> </tt>
<a name="L42"></a><tt class="py-lineno">  42</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-47" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-47', 'lib', 'link-15');">lib</a></tt><tt class="py-op">.</tt><tt id="link-48" class="py-name" targets="Package bmrblib.structure=bmrblib.structure-module.html,Package lib.structure=lib.structure-module.html,Package pipe_control.structure=pipe_control.structure-module.html,Module test_suite.system_tests.structure=test_suite.system_tests.structure-module.html,Module user_functions.structure=user_functions.structure-module.html"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-48', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-49" class="py-name" targets="Package lib.structure.internal=lib.structure.internal-module.html"><a title="lib.structure.internal" class="py-name" href="#" onclick="return doclink('link-49', 'internal', 'link-49');">internal</a></tt><tt class="py-op">.</tt><tt id="link-50" class="py-name" targets="Module lib.structure.internal.coordinates=lib.structure.internal.coordinates-module.html"><a title="lib.structure.internal.coordinates" class="py-name" href="#" onclick="return doclink('link-50', 'coordinates', 'link-50');">coordinates</a></tt> <tt class="py-keyword">import</tt> <tt id="link-51" class="py-name" targets="Function lib.structure.internal.coordinates.assemble_atomic_coordinates()=lib.structure.internal.coordinates-module.html#assemble_atomic_coordinates"><a title="lib.structure.internal.coordinates.assemble_atomic_coordinates" class="py-name" href="#" onclick="return doclink('link-51', 'assemble_atomic_coordinates', 'link-51');">assemble_atomic_coordinates</a></tt><tt class="py-op">,</tt> <tt id="link-52" class="py-name" targets="Function lib.structure.internal.coordinates.assemble_coord_array()=lib.structure.internal.coordinates-module.html#assemble_coord_array"><a title="lib.structure.internal.coordinates.assemble_coord_array" class="py-name" href="#" onclick="return doclink('link-52', 'assemble_coord_array', 'link-52');">assemble_coord_array</a></tt><tt class="py-op">,</tt> <tt id="link-53" class="py-name" targets="Function lib.structure.internal.coordinates.loop_coord_structures()=lib.structure.internal.coordinates-module.html#loop_coord_structures"><a title="lib.structure.internal.coordinates.loop_coord_structures" class="py-name" href="#" onclick="return doclink('link-53', 'loop_coord_structures', 'link-53');">loop_coord_structures</a></tt> </tt>
<a name="L43"></a><tt class="py-lineno">  43</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-54" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-54', 'lib', 'link-15');">lib</a></tt><tt class="py-op">.</tt><tt id="link-55" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-55', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-56" class="py-name"><a title="lib.structure.internal" class="py-name" href="#" onclick="return doclink('link-56', 'internal', 'link-49');">internal</a></tt><tt class="py-op">.</tt><tt id="link-57" class="py-name" targets="Module lib.structure.internal.displacements=lib.structure.internal.displacements-module.html"><a title="lib.structure.internal.displacements" class="py-name" href="#" onclick="return doclink('link-57', 'displacements', 'link-57');">displacements</a></tt> <tt class="py-keyword">import</tt> <tt id="link-58" class="py-name" targets="Class lib.structure.internal.displacements.Displacements=lib.structure.internal.displacements.Displacements-class.html"><a title="lib.structure.internal.displacements.Displacements" class="py-name" href="#" onclick="return doclink('link-58', 'Displacements', 'link-58');">Displacements</a></tt> </tt>
<a name="L44"></a><tt class="py-lineno">  44</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-59" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-59', 'lib', 'link-15');">lib</a></tt><tt class="py-op">.</tt><tt id="link-60" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-60', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-61" class="py-name"><a title="lib.structure.internal" class="py-name" href="#" onclick="return doclink('link-61', 'internal', 'link-49');">internal</a></tt><tt class="py-op">.</tt><tt id="link-62" class="py-name" targets="Module lib.structure.internal.object=lib.structure.internal.object-module.html"><a title="lib.structure.internal.object" class="py-name" href="#" onclick="return doclink('link-62', 'object', 'link-62');">object</a></tt> <tt class="py-keyword">import</tt> <tt id="link-63" class="py-name" targets="Class lib.structure.internal.object.Internal=lib.structure.internal.object.Internal-class.html"><a title="lib.structure.internal.object.Internal" class="py-name" href="#" onclick="return doclink('link-63', 'Internal', 'link-63');">Internal</a></tt> </tt>
<a name="L45"></a><tt class="py-lineno">  45</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-64" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-64', 'lib', 'link-15');">lib</a></tt><tt class="py-op">.</tt><tt id="link-65" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-65', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-66" class="py-name" targets="Package lib.structure.represent=lib.structure.represent-module.html"><a title="lib.structure.represent" class="py-name" href="#" onclick="return doclink('link-66', 'represent', 'link-66');">represent</a></tt><tt class="py-op">.</tt><tt id="link-67" class="py-name" targets="Module lib.structure.represent.diffusion_tensor=lib.structure.represent.diffusion_tensor-module.html,Function lib.structure.represent.diffusion_tensor.diffusion_tensor()=lib.structure.represent.diffusion_tensor-module.html#diffusion_tensor,Module pipe_control.diffusion_tensor=pipe_control.diffusion_tensor-module.html,Module test_suite.system_tests.diffusion_tensor=test_suite.system_tests.diffusion_tensor-module.html,Module user_functions.diffusion_tensor=user_functions.diffusion_tensor-module.html"><a title="lib.structure.represent.diffusion_tensor
lib.structure.represent.diffusion_tensor.diffusion_tensor
pipe_control.diffusion_tensor
test_suite.system_tests.diffusion_tensor
user_functions.diffusion_tensor" class="py-name" href="#" onclick="return doclink('link-67', 'diffusion_tensor', 'link-67');">diffusion_tensor</a></tt> <tt class="py-keyword">import</tt> <tt id="link-68" class="py-name"><a title="lib.structure.represent.diffusion_tensor
lib.structure.represent.diffusion_tensor.diffusion_tensor
pipe_control.diffusion_tensor
test_suite.system_tests.diffusion_tensor
user_functions.diffusion_tensor" class="py-name" href="#" onclick="return doclink('link-68', 'diffusion_tensor', 'link-67');">diffusion_tensor</a></tt> </tt>
<a name="L46"></a><tt class="py-lineno">  46</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-69" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-69', 'lib', 'link-15');">lib</a></tt><tt class="py-op">.</tt><tt id="link-70" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-70', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-71" class="py-name" targets="Module lib.statistics=lib.statistics-module.html,Module lib.structure.statistics=lib.structure.statistics-module.html,Module pipe_control.statistics=pipe_control.statistics-module.html,Module user_functions.statistics=user_functions.statistics-module.html"><a title="lib.statistics
lib.structure.statistics
pipe_control.statistics
user_functions.statistics" class="py-name" href="#" onclick="return doclink('link-71', 'statistics', 'link-71');">statistics</a></tt> <tt class="py-keyword">import</tt> <tt id="link-72" class="py-name" targets="Function lib.structure.statistics.atomic_rmsd()=lib.structure.statistics-module.html#atomic_rmsd"><a title="lib.structure.statistics.atomic_rmsd" class="py-name" href="#" onclick="return doclink('link-72', 'atomic_rmsd', 'link-72');">atomic_rmsd</a></tt> </tt>
<a name="L47"></a><tt class="py-lineno">  47</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-73" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-73', 'lib', 'link-15');">lib</a></tt><tt class="py-op">.</tt><tt id="link-74" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-74', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-75" class="py-name" targets="Method auto_analyses.stereochem_analysis.Stereochem_analysis.superimpose()=auto_analyses.stereochem_analysis.Stereochem_analysis-class.html#superimpose,Module lib.structure.superimpose=lib.structure.superimpose-module.html,Function pipe_control.structure.main.superimpose()=pipe_control.structure.main-module.html#superimpose"><a title="auto_analyses.stereochem_analysis.Stereochem_analysis.superimpose
lib.structure.superimpose
pipe_control.structure.main.superimpose" class="py-name" href="#" onclick="return doclink('link-75', 'superimpose', 'link-75');">superimpose</a></tt> <tt class="py-keyword">import</tt> <tt id="link-76" class="py-name" targets="Function lib.structure.superimpose.fit_to_first()=lib.structure.superimpose-module.html#fit_to_first"><a title="lib.structure.superimpose.fit_to_first" class="py-name" href="#" onclick="return doclink('link-76', 'fit_to_first', 'link-76');">fit_to_first</a></tt><tt class="py-op">,</tt> <tt id="link-77" class="py-name" targets="Function lib.structure.superimpose.fit_to_mean()=lib.structure.superimpose-module.html#fit_to_mean"><a title="lib.structure.superimpose.fit_to_mean" class="py-name" href="#" onclick="return doclink('link-77', 'fit_to_mean', 'link-77');">fit_to_mean</a></tt> </tt>
<a name="L48"></a><tt class="py-lineno">  48</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-78" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-78', 'lib', 'link-15');">lib</a></tt><tt class="py-op">.</tt><tt id="link-79" class="py-name"><a title="lib.warnings" class="py-name" href="#" onclick="return doclink('link-79', 'warnings', 'link-7');">warnings</a></tt> <tt class="py-keyword">import</tt> <tt id="link-80" class="py-name" targets="Class lib.warnings.RelaxWarning=lib.warnings.RelaxWarning-class.html"><a title="lib.warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-80', 'RelaxWarning', 'link-80');">RelaxWarning</a></tt><tt class="py-op">,</tt> <tt id="link-81" class="py-name" targets="Class lib.warnings.RelaxNoPDBFileWarning=lib.warnings.RelaxNoPDBFileWarning-class.html"><a title="lib.warnings.RelaxNoPDBFileWarning" class="py-name" href="#" onclick="return doclink('link-81', 'RelaxNoPDBFileWarning', 'link-81');">RelaxNoPDBFileWarning</a></tt><tt class="py-op">,</tt> <tt id="link-82" class="py-name" targets="Class lib.warnings.RelaxZeroVectorWarning=lib.warnings.RelaxZeroVectorWarning-class.html"><a title="lib.warnings.RelaxZeroVectorWarning" class="py-name" href="#" onclick="return doclink('link-82', 'RelaxZeroVectorWarning', 'link-82');">RelaxZeroVectorWarning</a></tt> </tt>
<a name="L49"></a><tt class="py-lineno">  49</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-83" class="py-name" targets="Package pipe_control=pipe_control-module.html"><a title="pipe_control" class="py-name" href="#" onclick="return doclink('link-83', 'pipe_control', 'link-83');">pipe_control</a></tt> <tt class="py-keyword">import</tt> <tt id="link-84" class="py-name" targets="Module pipe_control.molmol=pipe_control.molmol-module.html,Module specific_analyses.model_free.molmol=specific_analyses.model_free.molmol-module.html,Module user_functions.molmol=user_functions.molmol-module.html"><a title="pipe_control.molmol
specific_analyses.model_free.molmol
user_functions.molmol" class="py-name" href="#" onclick="return doclink('link-84', 'molmol', 'link-84');">molmol</a></tt><tt class="py-op">,</tt> <tt id="link-85" class="py-name" targets="Module pipe_control.pipes=pipe_control.pipes-module.html,Module test_suite.gui_tests.pipes=test_suite.gui_tests.pipes-module.html,Module test_suite.system_tests.pipes=test_suite.system_tests.pipes-module.html"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-85', 'pipes', 'link-85');">pipes</a></tt> </tt>
<a name="L50"></a><tt class="py-lineno">  50</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-86" class="py-name"><a title="pipe_control" class="py-name" href="#" onclick="return doclink('link-86', 'pipe_control', 'link-83');">pipe_control</a></tt><tt class="py-op">.</tt><tt id="link-87" class="py-name" targets="Module data_store.interatomic=data_store.interatomic-module.html,Module pipe_control.interatomic=pipe_control.interatomic-module.html,Module test_suite.gui_tests.interatomic=test_suite.gui_tests.interatomic-module.html,Module test_suite.system_tests.interatomic=test_suite.system_tests.interatomic-module.html"><a title="data_store.interatomic
pipe_control.interatomic
test_suite.gui_tests.interatomic
test_suite.system_tests.interatomic" class="py-name" href="#" onclick="return doclink('link-87', 'interatomic', 'link-87');">interatomic</a></tt> <tt class="py-keyword">import</tt> <tt id="link-88" class="py-name" targets="Function pipe_control.interatomic.interatomic_loop()=pipe_control.interatomic-module.html#interatomic_loop"><a title="pipe_control.interatomic.interatomic_loop" class="py-name" href="#" onclick="return doclink('link-88', 'interatomic_loop', 'link-88');">interatomic_loop</a></tt> </tt>
<a name="L51"></a><tt class="py-lineno">  51</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-89" class="py-name"><a title="pipe_control" class="py-name" href="#" onclick="return doclink('link-89', 'pipe_control', 'link-83');">pipe_control</a></tt><tt class="py-op">.</tt><tt id="link-90" class="py-name" targets="Module data_store.mol_res_spin=data_store.mol_res_spin-module.html,Module pipe_control.mol_res_spin=pipe_control.mol_res_spin-module.html,Module test_suite.system_tests.mol_res_spin=test_suite.system_tests.mol_res_spin-module.html"><a title="data_store.mol_res_spin
pipe_control.mol_res_spin
test_suite.system_tests.mol_res_spin" class="py-name" href="#" onclick="return doclink('link-90', 'mol_res_spin', 'link-90');">mol_res_spin</a></tt> <tt class="py-keyword">import</tt> <tt id="link-91" class="py-name" targets="Function pipe_control.mol_res_spin.check_mol_res_spin_data()=pipe_control.mol_res_spin-module.html#check_mol_res_spin_data"><a title="pipe_control.mol_res_spin.check_mol_res_spin_data" class="py-name" href="#" onclick="return doclink('link-91', 'check_mol_res_spin_data', 'link-91');">check_mol_res_spin_data</a></tt><tt class="py-op">,</tt> <tt id="link-92" class="py-name" targets="Function pipe_control.mol_res_spin.create_spin()=pipe_control.mol_res_spin-module.html#create_spin"><a title="pipe_control.mol_res_spin.create_spin" class="py-name" href="#" onclick="return doclink('link-92', 'create_spin', 'link-92');">create_spin</a></tt><tt class="py-op">,</tt> <tt id="link-93" class="py-name" targets="Function pipe_control.mol_res_spin.generate_spin_id_unique()=pipe_control.mol_res_spin-module.html#generate_spin_id_unique"><a title="pipe_control.mol_res_spin.generate_spin_id_unique" class="py-name" href="#" onclick="return doclink('link-93', 'generate_spin_id_unique', 'link-93');">generate_spin_id_unique</a></tt><tt class="py-op">,</tt> <tt id="link-94" class="py-name" targets="Function pipe_control.mol_res_spin.linear_ave()=pipe_control.mol_res_spin-module.html#linear_ave"><a title="pipe_control.mol_res_spin.linear_ave" class="py-name" href="#" onclick="return doclink('link-94', 'linear_ave', 'link-94');">linear_ave</a></tt><tt class="py-op">,</tt> <tt id="link-95" class="py-name" targets="Function pipe_control.mol_res_spin.return_spin()=pipe_control.mol_res_spin-module.html#return_spin"><a title="pipe_control.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-95', 'return_spin', 'link-95');">return_spin</a></tt><tt class="py-op">,</tt> <tt id="link-96" class="py-name" targets="Function pipe_control.mol_res_spin.spin_loop()=pipe_control.mol_res_spin-module.html#spin_loop"><a title="pipe_control.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-96', 'spin_loop', 'link-96');">spin_loop</a></tt> </tt>
<a name="L52"></a><tt class="py-lineno">  52</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-97" class="py-name"><a title="pipe_control" class="py-name" href="#" onclick="return doclink('link-97', 'pipe_control', 'link-83');">pipe_control</a></tt><tt class="py-op">.</tt><tt id="link-98" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-98', 'pipes', 'link-85');">pipes</a></tt> <tt class="py-keyword">import</tt> <tt id="link-99" class="py-name" targets="Function pipe_control.pipes.cdp_name()=pipe_control.pipes-module.html#cdp_name"><a title="pipe_control.pipes.cdp_name" class="py-name" href="#" onclick="return doclink('link-99', 'cdp_name', 'link-99');">cdp_name</a></tt><tt class="py-op">,</tt> <tt id="link-100" class="py-name" targets="Variable pipe_control.pipes.check_pipe=pipe_control.pipes-module.html#check_pipe"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-100', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">,</tt> <tt id="link-101" class="py-name" targets="Function pipe_control.pipes.get_pipe()=pipe_control.pipes-module.html#get_pipe"><a title="pipe_control.pipes.get_pipe" class="py-name" href="#" onclick="return doclink('link-101', 'get_pipe', 'link-101');">get_pipe</a></tt> </tt>
<a name="L53"></a><tt class="py-lineno">  53</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-102" class="py-name"><a title="pipe_control" class="py-name" href="#" onclick="return doclink('link-102', 'pipe_control', 'link-83');">pipe_control</a></tt><tt class="py-op">.</tt><tt id="link-103" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-103', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-104" class="py-name" targets="Module lib.checks=lib.checks-module.html,Module pipe_control.structure.checks=pipe_control.structure.checks-module.html,Module specific_analyses.frame_order.checks=specific_analyses.frame_order.checks-module.html,Module specific_analyses.relax_disp.checks=specific_analyses.relax_disp.checks-module.html,Module specific_analyses.relax_fit.checks=specific_analyses.relax_fit.checks-module.html"><a title="lib.checks
pipe_control.structure.checks
specific_analyses.frame_order.checks
specific_analyses.relax_disp.checks
specific_analyses.relax_fit.checks" class="py-name" href="#" onclick="return doclink('link-104', 'checks', 'link-104');">checks</a></tt> <tt class="py-keyword">import</tt> <tt id="link-105" class="py-name" targets="Variable pipe_control.structure.checks.check_structure=pipe_control.structure.checks-module.html#check_structure"><a title="pipe_control.structure.checks.check_structure" class="py-name" href="#" onclick="return doclink('link-105', 'check_structure', 'link-105');">check_structure</a></tt> </tt>
<a name="L54"></a><tt class="py-lineno">  54</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-106" class="py-name"><a title="pipe_control" class="py-name" href="#" onclick="return doclink('link-106', 'pipe_control', 'link-83');">pipe_control</a></tt><tt class="py-op">.</tt><tt id="link-107" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-107', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-108" class="py-name" targets="Module lib.structure.mass=lib.structure.mass-module.html,Module pipe_control.structure.mass=pipe_control.structure.mass-module.html"><a title="lib.structure.mass
pipe_control.structure.mass" class="py-name" href="#" onclick="return doclink('link-108', 'mass', 'link-108');">mass</a></tt> <tt class="py-keyword">import</tt> <tt id="link-109" class="py-name" targets="Function pipe_control.structure.mass.pipe_centre_of_mass()=pipe_control.structure.mass-module.html#pipe_centre_of_mass"><a title="pipe_control.structure.mass.pipe_centre_of_mass" class="py-name" href="#" onclick="return doclink('link-109', 'pipe_centre_of_mass', 'link-109');">pipe_centre_of_mass</a></tt> </tt>
<a name="L55"></a><tt class="py-lineno">  55</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-110" class="py-name" targets="Variable auto_analyses.dauvergne_protocol.status=auto_analyses.dauvergne_protocol-module.html#status,Variable auto_analyses.frame_order.status=auto_analyses.frame_order-module.html#status,Variable auto_analyses.noe.status=auto_analyses.noe-module.html#status,Variable auto_analyses.relax_disp.status=auto_analyses.relax_disp-module.html#status,Variable auto_analyses.relax_disp_repeat_cpmg.status=auto_analyses.relax_disp_repeat_cpmg-module.html#status,Variable auto_analyses.relax_fit.status=auto_analyses.relax_fit-module.html#status,Variable auto_analyses.stereochem_analysis.status=auto_analyses.stereochem_analysis-module.html#status,Variable data_store.status=data_store-module.html#status,Variable gui.about.status=gui.about-module.html#status,Variable gui.analyses.auto_model_free.status=gui.analyses.auto_model_free-module.html#status,Variable gui.analyses.auto_noe.status=gui.analyses.auto_noe-module.html#status,Variable gui.analyses.auto_relax_disp.status=gui.analyses.auto_relax_disp-module.html#status,Variable gui.analyses.auto_rx_base.status=gui.analyses.auto_rx_base-module.html#status,Variable gui.analyses.elements.model_list.status=gui.analyses.elements.model_list-module.html#status,Variable gui.analyses.execute.status=gui.analyses.execute-module.html#status,Variable gui.analyses.results_analysis.status=gui.analyses.results_analysis-module.html#status,Variable gui.analyses.status=gui.analyses-module.html#status,Variable gui.components.base_list.status=gui.components.base_list-module.html#status,Variable gui.components.free_file_format.status=gui.components.free_file_format-module.html#status,Variable gui.components.grid.status=gui.components.grid-module.html#status,Variable gui.components.molecule.status=gui.components.molecule-module.html#status,Variable gui.components.relax_data.status=gui.components.relax_data-module.html#status,Variable gui.components.relax_data_meta.status=gui.components.relax_data_meta-module.html#status,Variable gui.components.spectrum.status=gui.components.spectrum-module.html#status,Variable gui.controller.status=gui.controller-module.html#status,Variable gui.errors.status=gui.errors-module.html#status,Variable gui.export_bmrb.status=gui.export_bmrb-module.html#status,Variable gui.filedialog.status=gui.filedialog-module.html#status,Variable gui.fonts.status=gui.fonts-module.html#status,Variable gui.icons.status=gui.icons-module.html#status,Variable gui.input_elements.bool.status=gui.input_elements.bool-module.html#status,Variable gui.input_elements.dir.status=gui.input_elements.dir-module.html#status,Variable gui.input_elements.file.status=gui.input_elements.file-module.html#status,Variable gui.input_elements.sequence.status=gui.input_elements.sequence-module.html#status,Variable gui.input_elements.sequence_2D.status=gui.input_elements.sequence_2D-module.html#status,Variable gui.interpreter.status=gui.interpreter-module.html#status,Variable gui.menu.status=gui.menu-module.html#status,Variable gui.message.status=gui.message-module.html#status,Variable gui.misc.status=gui.misc-module.html#status,Variable gui.pipe_editor.status=gui.pipe_editor-module.html#status,Variable gui.relax_gui.status=gui.relax_gui-module.html#status,Variable gui.relax_prompt.status=gui.relax_prompt-module.html#status,Variable gui.results_viewer.status=gui.results_viewer-module.html#status,Variable gui.spin_viewer.frame.status=gui.spin_viewer.frame-module.html#status,Variable gui.spin_viewer.tree.status=gui.spin_viewer.tree-module.html#status,Variable gui.status=gui-module.html#status,Variable gui.string_conv.status=gui.string_conv-module.html#status,Variable gui.uf_objects.status=gui.uf_objects-module.html#status,Variable gui.wizards.peak_intensity.status=gui.wizards.peak_intensity-module.html#status,Variable gui.wizards.wiz_objects.status=gui.wizards.wiz_objects-module.html#status,Variable info.Bieri11.status=info.Bieri11-class.html#status,Variable info.Clore90.status=info.Clore90-class.html#status,Variable info.Delaglio95.status=info.Delaglio95-class.html#status,Variable info.GoddardKneller.status=info.GoddardKneller-class.html#status,Variable info.LipariSzabo82a.status=info.LipariSzabo82a-class.html#status,Variable info.LipariSzabo82b.status=info.LipariSzabo82b-class.html#status,Variable info.Ref.status=info.Ref-class.html#status,Variable info.dAuvergne06.status=info.dAuvergne06-class.html#status,Variable info.dAuvergneGooley03.status=info.dAuvergneGooley03-class.html#status,Variable info.dAuvergneGooley06.status=info.dAuvergneGooley06-class.html#status,Variable info.dAuvergneGooley07.status=info.dAuvergneGooley07-class.html#status,Variable info.dAuvergneGooley08a.status=info.dAuvergneGooley08a-class.html#status,Variable info.dAuvergneGooley08b.status=info.dAuvergneGooley08b-class.html#status,Variable info.status=info-module.html#status,Variable pipe_control.bmrb.status=pipe_control.bmrb-module.html#status,Variable pipe_control.grace.status=pipe_control.grace-module.html#status,Variable pipe_control.minimise.status=pipe_control.minimise-module.html#status,Variable pipe_control.mol_res_spin.status=pipe_control.mol_res_spin-module.html#status,Variable pipe_control.molmol.status=pipe_control.molmol-module.html#status,Variable pipe_control.pipes.status=pipe_control.pipes-module.html#status,Variable pipe_control.pymol_control.status=pipe_control.pymol_control-module.html#status,Variable pipe_control.result_files.status=pipe_control.result_files-module.html#status,Variable pipe_control.script.status=pipe_control.script-module.html#status,Variable pipe_control.state.status=pipe_control.state-module.html#status,Variable pipe_control.structure.geometric.status=pipe_control.structure.geometric-module.html#status,Variable pipe_control.structure.main.status=pipe_control.structure.main-module.html#status,Variable pipe_control.value.status=pipe_control.value-module.html#status,Variable prompt.command.status=prompt.command-module.html#status,Variable prompt.help.status=prompt.help-module.html#status,Variable prompt.interpreter.status=prompt.interpreter-module.html#status,Variable prompt.uf_docstring.status=prompt.uf_docstring-module.html#status,Variable prompt.uf_objects.status=prompt.uf_objects-module.html#status,Variable relax.status=relax-module.html#status,Variable scons.manuals.status=scons.manuals-module.html#status,Variable setup.status=setup-module.html#status,Module status=status-module.html,Variable test_suite.gui_tests.base_classes.status=test_suite.gui_tests.base_classes-module.html#status,Variable test_suite.gui_tests.bruker.status=test_suite.gui_tests.bruker-module.html#status,Variable test_suite.gui_tests.frame_order.status=test_suite.gui_tests.frame_order-module.html#status,Variable test_suite.gui_tests.general.status=test_suite.gui_tests.general-module.html#status,Variable test_suite.gui_tests.model_free.status=test_suite.gui_tests.model_free-module.html#status,Variable test_suite.gui_tests.n_state_model.status=test_suite.gui_tests.n_state_model-module.html#status,Variable test_suite.gui_tests.noe.status=test_suite.gui_tests.noe-module.html#status,Variable test_suite.gui_tests.relax_disp.status=test_suite.gui_tests.relax_disp-module.html#status,Variable test_suite.gui_tests.rx.status=test_suite.gui_tests.rx-module.html#status,Variable test_suite.gui_tests.state.status=test_suite.gui_tests.state-module.html#status,Variable test_suite.gui_tests.test_user_functions.status=test_suite.gui_tests.test_user_functions-module.html#status,Variable test_suite.relax_test_loader.status=test_suite.relax_test_loader-module.html#status,Variable test_suite.relax_test_runner.status=test_suite.relax_test_runner-module.html#status,Variable test_suite.system_tests.angles.status=test_suite.system_tests.angles-module.html#status,Variable test_suite.system_tests.bmrb.status=test_suite.system_tests.bmrb-module.html#status,Variable test_suite.system_tests.bruker.status=test_suite.system_tests.bruker-module.html#status,Variable test_suite.system_tests.chemical_shift.status=test_suite.system_tests.chemical_shift-module.html#status,Variable test_suite.system_tests.consistency_tests.status=test_suite.system_tests.consistency_tests-module.html#status,Variable test_suite.system_tests.dasha.status=test_suite.system_tests.dasha-module.html#status,Variable test_suite.system_tests.diffusion_tensor.status=test_suite.system_tests.diffusion_tensor-module.html#status,Variable test_suite.system_tests.frame_order.status=test_suite.system_tests.frame_order-module.html#status,Variable test_suite.system_tests.generic.status=test_suite.system_tests.generic-module.html#status,Variable test_suite.system_tests.grace.status=test_suite.system_tests.grace-module.html#status,Variable test_suite.system_tests.interatomic.status=test_suite.system_tests.interatomic-module.html#status,Variable test_suite.system_tests.jw_mapping.status=test_suite.system_tests.jw_mapping-module.html#status,Variable test_suite.system_tests.load_spins.status=test_suite.system_tests.load_spins-module.html#status,Variable test_suite.system_tests.model_elimination.status=test_suite.system_tests.model_elimination-module.html#status,Variable test_suite.system_tests.model_free.status=test_suite.system_tests.model_free-module.html#status,Variable test_suite.system_tests.model_selection.status=test_suite.system_tests.model_selection-module.html#status,Variable test_suite.system_tests.mol_res_spin.status=test_suite.system_tests.mol_res_spin-module.html#status,Variable test_suite.system_tests.n_state_model.status=test_suite.system_tests.n_state_model-module.html#status,Variable test_suite.system_tests.noe.status=test_suite.system_tests.noe-module.html#status,Variable test_suite.system_tests.noe_restraints.status=test_suite.system_tests.noe_restraints-module.html#status,Variable test_suite.system_tests.palmer.status=test_suite.system_tests.palmer-module.html#status,Variable test_suite.system_tests.pcs.status=test_suite.system_tests.pcs-module.html#status,Variable test_suite.system_tests.peak_lists.status=test_suite.system_tests.peak_lists-module.html#status,Variable test_suite.system_tests.pipes.status=test_suite.system_tests.pipes-module.html#status,Variable test_suite.system_tests.rdc.status=test_suite.system_tests.rdc-module.html#status,Variable test_suite.system_tests.relax_data.status=test_suite.system_tests.relax_data-module.html#status,Variable test_suite.system_tests.relax_disp.status=test_suite.system_tests.relax_disp-module.html#status,Variable test_suite.system_tests.relax_fit.status=test_suite.system_tests.relax_fit-module.html#status,Variable test_suite.system_tests.results.status=test_suite.system_tests.results-module.html#status,Variable test_suite.system_tests.sequence.status=test_suite.system_tests.sequence-module.html#status,Variable test_suite.system_tests.spectrum.status=test_suite.system_tests.spectrum-module.html#status,Variable test_suite.system_tests.state.status=test_suite.system_tests.state-module.html#status,Variable test_suite.system_tests.structure.status=test_suite.system_tests.structure-module.html#status,Variable test_suite.system_tests.unit_vectors.status=test_suite.system_tests.unit_vectors-module.html#status,Variable test_suite.test_suite_runner.status=test_suite.test_suite_runner-module.html#status,Variable test_suite.unit_tests._lib._dispersion.test_matrix_exponential.status=test_suite.unit_tests._lib._dispersion.test_matrix_exponential-module.html#status,Variable test_suite.unit_tests._lib._frame_order.test_matrix_ops.status=test_suite.unit_tests._lib._frame_order.test_matrix_ops-module.html#status,Variable test_suite.unit_tests._pipe_control._structure.test_internal.status=test_suite.unit_tests._pipe_control._structure.test_internal-module.html#status,Variable test_suite.unit_tests._specific_analyses._model_free.test_api.status=test_suite.unit_tests._specific_analyses._model_free.test_api-module.html#status,Variable test_suite.unit_tests._specific_analyses._relax_disp.test_checks.status=test_suite.unit_tests._specific_analyses._relax_disp.test_checks-module.html#status,Variable test_suite.unit_tests._specific_analyses._relax_disp.test_data.status=test_suite.unit_tests._specific_analyses._relax_disp.test_data-module.html#status,Variable test_suite.unit_tests._target_functions.test_relax_fit.status=test_suite.unit_tests._target_functions.test_relax_fit-module.html#status,Variable test_suite.unit_tests.package_checking.status=test_suite.unit_tests.package_checking-module.html#status,Variable test_suite.unit_tests.relax_data_testing_base.status=test_suite.unit_tests.relax_data_testing_base-module.html#status,Variable test_suite.unit_tests.sequence_testing_base.status=test_suite.unit_tests.sequence_testing_base-module.html#status,Variable test_suite.unit_tests.state_testing_base.status=test_suite.unit_tests.state_testing_base-module.html#status,Variable test_suite.verification_tests.library.status=test_suite.verification_tests.library-module.html#status,Variable test_suite.verification_tests.status_object.status=test_suite.verification_tests.status_object-module.html#status,Variable version.status=version-module.html#status"><a title="auto_analyses.dauvergne_protocol.status
auto_analyses.frame_order.status
auto_analyses.noe.status
auto_analyses.relax_disp.status
auto_analyses.relax_disp_repeat_cpmg.status
auto_analyses.relax_fit.status
auto_analyses.stereochem_analysis.status
data_store.status
gui.about.status
gui.analyses.auto_model_free.status
gui.analyses.auto_noe.status
gui.analyses.auto_relax_disp.status
gui.analyses.auto_rx_base.status
gui.analyses.elements.model_list.status
gui.analyses.execute.status
gui.analyses.results_analysis.status
gui.analyses.status
gui.components.base_list.status
gui.components.free_file_format.status
gui.components.grid.status
gui.components.molecule.status
gui.components.relax_data.status
gui.components.relax_data_meta.status
gui.components.spectrum.status
gui.controller.status
gui.errors.status
gui.export_bmrb.status
gui.filedialog.status
gui.fonts.status
gui.icons.status
gui.input_elements.bool.status
gui.input_elements.dir.status
gui.input_elements.file.status
gui.input_elements.sequence.status
gui.input_elements.sequence_2D.status
gui.interpreter.status
gui.menu.status
gui.message.status
gui.misc.status
gui.pipe_editor.status
gui.relax_gui.status
gui.relax_prompt.status
gui.results_viewer.status
gui.spin_viewer.frame.status
gui.spin_viewer.tree.status
gui.status
gui.string_conv.status
gui.uf_objects.status
gui.wizards.peak_intensity.status
gui.wizards.wiz_objects.status
info.Bieri11.status
info.Clore90.status
info.Delaglio95.status
info.GoddardKneller.status
info.LipariSzabo82a.status
info.LipariSzabo82b.status
info.Ref.status
info.dAuvergne06.status
info.dAuvergneGooley03.status
info.dAuvergneGooley06.status
info.dAuvergneGooley07.status
info.dAuvergneGooley08a.status
info.dAuvergneGooley08b.status
info.status
pipe_control.bmrb.status
pipe_control.grace.status
pipe_control.minimise.status
pipe_control.mol_res_spin.status
pipe_control.molmol.status
pipe_control.pipes.status
pipe_control.pymol_control.status
pipe_control.result_files.status
pipe_control.script.status
pipe_control.state.status
pipe_control.structure.geometric.status
pipe_control.structure.main.status
pipe_control.value.status
prompt.command.status
prompt.help.status
prompt.interpreter.status
prompt.uf_docstring.status
prompt.uf_objects.status
relax.status
scons.manuals.status
setup.status
status
test_suite.gui_tests.base_classes.status
test_suite.gui_tests.bruker.status
test_suite.gui_tests.frame_order.status
test_suite.gui_tests.general.status
test_suite.gui_tests.model_free.status
test_suite.gui_tests.n_state_model.status
test_suite.gui_tests.noe.status
test_suite.gui_tests.relax_disp.status
test_suite.gui_tests.rx.status
test_suite.gui_tests.state.status
test_suite.gui_tests.test_user_functions.status
test_suite.relax_test_loader.status
test_suite.relax_test_runner.status
test_suite.system_tests.angles.status
test_suite.system_tests.bmrb.status
test_suite.system_tests.bruker.status
test_suite.system_tests.chemical_shift.status
test_suite.system_tests.consistency_tests.status
test_suite.system_tests.dasha.status
test_suite.system_tests.diffusion_tensor.status
test_suite.system_tests.frame_order.status
test_suite.system_tests.generic.status
test_suite.system_tests.grace.status
test_suite.system_tests.interatomic.status
test_suite.system_tests.jw_mapping.status
test_suite.system_tests.load_spins.status
test_suite.system_tests.model_elimination.status
test_suite.system_tests.model_free.status
test_suite.system_tests.model_selection.status
test_suite.system_tests.mol_res_spin.status
test_suite.system_tests.n_state_model.status
test_suite.system_tests.noe.status
test_suite.system_tests.noe_restraints.status
test_suite.system_tests.palmer.status
test_suite.system_tests.pcs.status
test_suite.system_tests.peak_lists.status
test_suite.system_tests.pipes.status
test_suite.system_tests.rdc.status
test_suite.system_tests.relax_data.status
test_suite.system_tests.relax_disp.status
test_suite.system_tests.relax_fit.status
test_suite.system_tests.results.status
test_suite.system_tests.sequence.status
test_suite.system_tests.spectrum.status
test_suite.system_tests.state.status
test_suite.system_tests.structure.status
test_suite.system_tests.unit_vectors.status
test_suite.test_suite_runner.status
test_suite.unit_tests._lib._dispersion.test_matrix_exponential.status
test_suite.unit_tests._lib._frame_order.test_matrix_ops.status
test_suite.unit_tests._pipe_control._structure.test_internal.status
test_suite.unit_tests._specific_analyses._model_free.test_api.status
test_suite.unit_tests._specific_analyses._relax_disp.test_checks.status
test_suite.unit_tests._specific_analyses._relax_disp.test_data.status
test_suite.unit_tests._target_functions.test_relax_fit.status
test_suite.unit_tests.package_checking.status
test_suite.unit_tests.relax_data_testing_base.status
test_suite.unit_tests.sequence_testing_base.status
test_suite.unit_tests.state_testing_base.status
test_suite.verification_tests.library.status
test_suite.verification_tests.status_object.status
version.status" class="py-name" href="#" onclick="return doclink('link-110', 'status', 'link-110');">status</a></tt> <tt class="py-keyword">import</tt> <tt id="link-111" class="py-name" targets="Class status.Status=status.Status-class.html"><a title="status.Status" class="py-name" href="#" onclick="return doclink('link-111', 'Status', 'link-111');">Status</a></tt><tt class="py-op">;</tt> <tt id="link-112" class="py-name"><a title="auto_analyses.dauvergne_protocol.status
auto_analyses.frame_order.status
auto_analyses.noe.status
auto_analyses.relax_disp.status
auto_analyses.relax_disp_repeat_cpmg.status
auto_analyses.relax_fit.status
auto_analyses.stereochem_analysis.status
data_store.status
gui.about.status
gui.analyses.auto_model_free.status
gui.analyses.auto_noe.status
gui.analyses.auto_relax_disp.status
gui.analyses.auto_rx_base.status
gui.analyses.elements.model_list.status
gui.analyses.execute.status
gui.analyses.results_analysis.status
gui.analyses.status
gui.components.base_list.status
gui.components.free_file_format.status
gui.components.grid.status
gui.components.molecule.status
gui.components.relax_data.status
gui.components.relax_data_meta.status
gui.components.spectrum.status
gui.controller.status
gui.errors.status
gui.export_bmrb.status
gui.filedialog.status
gui.fonts.status
gui.icons.status
gui.input_elements.bool.status
gui.input_elements.dir.status
gui.input_elements.file.status
gui.input_elements.sequence.status
gui.input_elements.sequence_2D.status
gui.interpreter.status
gui.menu.status
gui.message.status
gui.misc.status
gui.pipe_editor.status
gui.relax_gui.status
gui.relax_prompt.status
gui.results_viewer.status
gui.spin_viewer.frame.status
gui.spin_viewer.tree.status
gui.status
gui.string_conv.status
gui.uf_objects.status
gui.wizards.peak_intensity.status
gui.wizards.wiz_objects.status
info.Bieri11.status
info.Clore90.status
info.Delaglio95.status
info.GoddardKneller.status
info.LipariSzabo82a.status
info.LipariSzabo82b.status
info.Ref.status
info.dAuvergne06.status
info.dAuvergneGooley03.status
info.dAuvergneGooley06.status
info.dAuvergneGooley07.status
info.dAuvergneGooley08a.status
info.dAuvergneGooley08b.status
info.status
pipe_control.bmrb.status
pipe_control.grace.status
pipe_control.minimise.status
pipe_control.mol_res_spin.status
pipe_control.molmol.status
pipe_control.pipes.status
pipe_control.pymol_control.status
pipe_control.result_files.status
pipe_control.script.status
pipe_control.state.status
pipe_control.structure.geometric.status
pipe_control.structure.main.status
pipe_control.value.status
prompt.command.status
prompt.help.status
prompt.interpreter.status
prompt.uf_docstring.status
prompt.uf_objects.status
relax.status
scons.manuals.status
setup.status
status
test_suite.gui_tests.base_classes.status
test_suite.gui_tests.bruker.status
test_suite.gui_tests.frame_order.status
test_suite.gui_tests.general.status
test_suite.gui_tests.model_free.status
test_suite.gui_tests.n_state_model.status
test_suite.gui_tests.noe.status
test_suite.gui_tests.relax_disp.status
test_suite.gui_tests.rx.status
test_suite.gui_tests.state.status
test_suite.gui_tests.test_user_functions.status
test_suite.relax_test_loader.status
test_suite.relax_test_runner.status
test_suite.system_tests.angles.status
test_suite.system_tests.bmrb.status
test_suite.system_tests.bruker.status
test_suite.system_tests.chemical_shift.status
test_suite.system_tests.consistency_tests.status
test_suite.system_tests.dasha.status
test_suite.system_tests.diffusion_tensor.status
test_suite.system_tests.frame_order.status
test_suite.system_tests.generic.status
test_suite.system_tests.grace.status
test_suite.system_tests.interatomic.status
test_suite.system_tests.jw_mapping.status
test_suite.system_tests.load_spins.status
test_suite.system_tests.model_elimination.status
test_suite.system_tests.model_free.status
test_suite.system_tests.model_selection.status
test_suite.system_tests.mol_res_spin.status
test_suite.system_tests.n_state_model.status
test_suite.system_tests.noe.status
test_suite.system_tests.noe_restraints.status
test_suite.system_tests.palmer.status
test_suite.system_tests.pcs.status
test_suite.system_tests.peak_lists.status
test_suite.system_tests.pipes.status
test_suite.system_tests.rdc.status
test_suite.system_tests.relax_data.status
test_suite.system_tests.relax_disp.status
test_suite.system_tests.relax_fit.status
test_suite.system_tests.results.status
test_suite.system_tests.sequence.status
test_suite.system_tests.spectrum.status
test_suite.system_tests.state.status
test_suite.system_tests.structure.status
test_suite.system_tests.unit_vectors.status
test_suite.test_suite_runner.status
test_suite.unit_tests._lib._dispersion.test_matrix_exponential.status
test_suite.unit_tests._lib._frame_order.test_matrix_ops.status
test_suite.unit_tests._pipe_control._structure.test_internal.status
test_suite.unit_tests._specific_analyses._model_free.test_api.status
test_suite.unit_tests._specific_analyses._relax_disp.test_checks.status
test_suite.unit_tests._specific_analyses._relax_disp.test_data.status
test_suite.unit_tests._target_functions.test_relax_fit.status
test_suite.unit_tests.package_checking.status
test_suite.unit_tests.relax_data_testing_base.status
test_suite.unit_tests.sequence_testing_base.status
test_suite.unit_tests.state_testing_base.status
test_suite.verification_tests.library.status
test_suite.verification_tests.status_object.status
version.status" class="py-name" href="#" onclick="return doclink('link-112', 'status', 'link-110');">status</a></tt> <tt class="py-op">=</tt> <tt id="link-113" class="py-name"><a title="status.Status" class="py-name" href="#" onclick="return doclink('link-113', 'Status', 'link-111');">Status</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L56"></a><tt class="py-lineno">  56</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-114" class="py-name" targets="Package target_functions=target_functions-module.html"><a title="target_functions" class="py-name" href="#" onclick="return doclink('link-114', 'target_functions', 'link-114');">target_functions</a></tt><tt class="py-op">.</tt><tt id="link-115" class="py-name" targets="Module target_functions.ens_pivot_finder=target_functions.ens_pivot_finder-module.html"><a title="target_functions.ens_pivot_finder" class="py-name" href="#" onclick="return doclink('link-115', 'ens_pivot_finder', 'link-115');">ens_pivot_finder</a></tt> <tt class="py-keyword">import</tt> <tt id="link-116" class="py-name" targets="Class target_functions.ens_pivot_finder.Pivot_finder=target_functions.ens_pivot_finder.Pivot_finder-class.html"><a title="target_functions.ens_pivot_finder.Pivot_finder" class="py-name" href="#" onclick="return doclink('link-116', 'Pivot_finder', 'link-116');">Pivot_finder</a></tt> </tt>
<a name="L57"></a><tt class="py-lineno">  57</tt>  <tt class="py-line"> </tt>
<a name="L58"></a><tt class="py-lineno">  58</tt>  <tt class="py-line"> </tt>
<a name="add_atom"></a><div id="add_atom-def"><a name="L59"></a><tt class="py-lineno">  59</tt> <a class="py-toggle" href="#" id="add_atom-toggle" onclick="return toggle('add_atom');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#add_atom">add_atom</a><tt class="py-op">(</tt><tt class="py-param">mol_name</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">atom_name</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">res_name</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">res_num</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">pos</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-param">element</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">atom_num</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">chain_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">segment_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">pdb_record</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="add_atom-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="add_atom-expanded"><a name="L60"></a><tt class="py-lineno">  60</tt>  <tt class="py-line">    <tt class="py-docstring">"""Add a new atom to the structural data object.</tt> </tt>
<a name="L61"></a><tt class="py-lineno">  61</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L62"></a><tt class="py-lineno">  62</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword mol_name:      The name of the molecule.</tt> </tt>
<a name="L63"></a><tt class="py-lineno">  63</tt>  <tt class="py-line"><tt class="py-docstring">    @type mol_name:         str</tt> </tt>
<a name="L64"></a><tt class="py-lineno">  64</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_name:     The atom name, e.g. 'H1'.</tt> </tt>
<a name="L65"></a><tt class="py-lineno">  65</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_name:        str or None</tt> </tt>
<a name="L66"></a><tt class="py-lineno">  66</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword res_name:      The residue name.</tt> </tt>
<a name="L67"></a><tt class="py-lineno">  67</tt>  <tt class="py-line"><tt class="py-docstring">    @type res_name:         str or None</tt> </tt>
<a name="L68"></a><tt class="py-lineno">  68</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword res_num:       The residue number.</tt> </tt>
<a name="L69"></a><tt class="py-lineno">  69</tt>  <tt class="py-line"><tt class="py-docstring">    @type res_num:          int or None</tt> </tt>
<a name="L70"></a><tt class="py-lineno">  70</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pos:           The position vector of coordinates.  If a rank-2 array is supplied, the length of the first dimension must match the number of models.</tt> </tt>
<a name="L71"></a><tt class="py-lineno">  71</tt>  <tt class="py-line"><tt class="py-docstring">    @type pos:              rank-1 or rank-2 array or list of float</tt> </tt>
<a name="L72"></a><tt class="py-lineno">  72</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword element:       The element symbol.</tt> </tt>
<a name="L73"></a><tt class="py-lineno">  73</tt>  <tt class="py-line"><tt class="py-docstring">    @type element:          str or None</tt> </tt>
<a name="L74"></a><tt class="py-lineno">  74</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_num:      The atom number.</tt> </tt>
<a name="L75"></a><tt class="py-lineno">  75</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_num:         int or None</tt> </tt>
<a name="L76"></a><tt class="py-lineno">  76</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword chain_id:      The chain identifier.</tt> </tt>
<a name="L77"></a><tt class="py-lineno">  77</tt>  <tt class="py-line"><tt class="py-docstring">    @type chain_id:         str or None</tt> </tt>
<a name="L78"></a><tt class="py-lineno">  78</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword segment_id:    The segment identifier.</tt> </tt>
<a name="L79"></a><tt class="py-lineno">  79</tt>  <tt class="py-line"><tt class="py-docstring">    @type segment_id:       str or None</tt> </tt>
<a name="L80"></a><tt class="py-lineno">  80</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pdb_record:    The optional PDB record name, e.g. 'ATOM' or 'HETATM'.</tt> </tt>
<a name="L81"></a><tt class="py-lineno">  81</tt>  <tt class="py-line"><tt class="py-docstring">    @type pdb_record:       str or None</tt> </tt>
<a name="L82"></a><tt class="py-lineno">  82</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L83"></a><tt class="py-lineno">  83</tt>  <tt class="py-line"> </tt>
<a name="L84"></a><tt class="py-lineno">  84</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L85"></a><tt class="py-lineno">  85</tt>  <tt class="py-line">    <tt id="link-117" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-117', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L86"></a><tt class="py-lineno">  86</tt>  <tt class="py-line"> </tt>
<a name="L87"></a><tt class="py-lineno">  87</tt>  <tt class="py-line">    <tt class="py-comment"># Place the structural object into the relax data store if needed.</tt> </tt>
<a name="L88"></a><tt class="py-lineno">  88</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L89"></a><tt class="py-lineno">  89</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-118" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-118', 'structure', 'link-48');">structure</a></tt> <tt class="py-op">=</tt> <tt id="link-119" class="py-name"><a title="lib.structure.internal.object.Internal" class="py-name" href="#" onclick="return doclink('link-119', 'Internal', 'link-63');">Internal</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L90"></a><tt class="py-lineno">  90</tt>  <tt class="py-line"> </tt>
<a name="L91"></a><tt class="py-lineno">  91</tt>  <tt class="py-line">    <tt class="py-comment"># Add the atoms.</tt> </tt>
<a name="L92"></a><tt class="py-lineno">  92</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-120" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-120', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-121" class="py-name" targets="Method lib.structure.internal.object.Internal.add_atom()=lib.structure.internal.object.Internal-class.html#add_atom,Method lib.structure.internal.selection.Internal_selection.add_atom()=lib.structure.internal.selection.Internal_selection-class.html#add_atom,Function pipe_control.structure.main.add_atom()=pipe_control.structure.main-module.html#add_atom"><a title="lib.structure.internal.object.Internal.add_atom
lib.structure.internal.selection.Internal_selection.add_atom
pipe_control.structure.main.add_atom" class="py-name" href="#" onclick="return doclink('link-121', 'add_atom', 'link-121');">add_atom</a></tt><tt class="py-op">(</tt><tt class="py-name">mol_name</tt><tt class="py-op">=</tt><tt class="py-name">mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt class="py-name">atom_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">res_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt><tt class="py-op">=</tt><tt class="py-name">pos</tt><tt class="py-op">,</tt> <tt id="link-122" class="py-name" targets="Variable lib.periodic_table.element=lib.periodic_table-module.html#element"><a title="lib.periodic_table.element" class="py-name" href="#" onclick="return doclink('link-122', 'element', 'link-122');">element</a></tt><tt class="py-op">=</tt><tt id="link-123" class="py-name"><a title="lib.periodic_table.element" class="py-name" href="#" onclick="return doclink('link-123', 'element', 'link-122');">element</a></tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">,</tt> <tt class="py-name">chain_id</tt><tt class="py-op">=</tt><tt class="py-name">chain_id</tt><tt class="py-op">,</tt> <tt class="py-name">segment_id</tt><tt class="py-op">=</tt><tt class="py-name">segment_id</tt><tt class="py-op">,</tt> <tt class="py-name">pdb_record</tt><tt class="py-op">=</tt><tt class="py-name">pdb_record</tt><tt class="py-op">,</tt> <tt class="py-name">sort</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
</div><a name="L93"></a><tt class="py-lineno">  93</tt>  <tt class="py-line"> </tt>
<a name="L94"></a><tt class="py-lineno">  94</tt>  <tt class="py-line"> </tt>
<a name="add_model"></a><div id="add_model-def"><a name="L95"></a><tt class="py-lineno">  95</tt> <a class="py-toggle" href="#" id="add_model-toggle" onclick="return toggle('add_model');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#add_model">add_model</a><tt class="py-op">(</tt><tt class="py-param">model_num</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="add_model-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="add_model-expanded"><a name="L96"></a><tt class="py-lineno">  96</tt>  <tt class="py-line">    <tt class="py-docstring">"""Add a new model to the empty structural data object."""</tt> </tt>
<a name="L97"></a><tt class="py-lineno">  97</tt>  <tt class="py-line"> </tt>
<a name="L98"></a><tt class="py-lineno">  98</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L99"></a><tt class="py-lineno">  99</tt>  <tt class="py-line">    <tt id="link-124" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-124', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L100"></a><tt class="py-lineno"> 100</tt>  <tt class="py-line"> </tt>
<a name="L101"></a><tt class="py-lineno"> 101</tt>  <tt class="py-line">    <tt class="py-comment"># Place the structural object into the relax data store if needed.</tt> </tt>
<a name="L102"></a><tt class="py-lineno"> 102</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L103"></a><tt class="py-lineno"> 103</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-125" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-125', 'structure', 'link-48');">structure</a></tt> <tt class="py-op">=</tt> <tt id="link-126" class="py-name"><a title="lib.structure.internal.object.Internal" class="py-name" href="#" onclick="return doclink('link-126', 'Internal', 'link-63');">Internal</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L104"></a><tt class="py-lineno"> 104</tt>  <tt class="py-line"> </tt>
<a name="L105"></a><tt class="py-lineno"> 105</tt>  <tt class="py-line">    <tt class="py-comment"># Check the structural object is empty.</tt> </tt>
<a name="L106"></a><tt class="py-lineno"> 106</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-127" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-127', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-128" class="py-name" targets="Method lib.structure.internal.object.Internal.num_molecules()=lib.structure.internal.object.Internal-class.html#num_molecules"><a title="lib.structure.internal.object.Internal.num_molecules" class="py-name" href="#" onclick="return doclink('link-128', 'num_molecules', 'link-128');">num_molecules</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-op">!=</tt> <tt class="py-number">0</tt><tt class="py-op">:</tt> </tt>
<a name="L107"></a><tt class="py-lineno"> 107</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-129" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-129', 'RelaxError', 'link-20');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The internal structural object is not empty."</tt><tt class="py-op">)</tt> </tt>
<a name="L108"></a><tt class="py-lineno"> 108</tt>  <tt class="py-line"> </tt>
<a name="L109"></a><tt class="py-lineno"> 109</tt>  <tt class="py-line">    <tt class="py-comment"># Add a model.</tt> </tt>
<a name="L110"></a><tt class="py-lineno"> 110</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-130" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-130', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt class="py-name">structural_data</tt><tt class="py-op">.</tt><tt id="link-131" class="py-name" targets="Method data_store.align_tensor.AlignTensorList.add_item()=data_store.align_tensor.AlignTensorList-class.html#add_item,Method data_store.interatomic.InteratomList.add_item()=data_store.interatomic.InteratomList-class.html#add_item,Method data_store.mol_res_spin.MoleculeList.add_item()=data_store.mol_res_spin.MoleculeList-class.html#add_item,Method data_store.mol_res_spin.ResidueList.add_item()=data_store.mol_res_spin.ResidueList-class.html#add_item,Method data_store.mol_res_spin.SpinList.add_item()=data_store.mol_res_spin.SpinList-class.html#add_item,Method lib.structure.internal.models.ModelList.add_item()=lib.structure.internal.models.ModelList-class.html#add_item,Method lib.structure.internal.molecules.MolList.add_item()=lib.structure.internal.molecules.MolList-class.html#add_item"><a title="data_store.align_tensor.AlignTensorList.add_item
data_store.interatomic.InteratomList.add_item
data_store.mol_res_spin.MoleculeList.add_item
data_store.mol_res_spin.ResidueList.add_item
data_store.mol_res_spin.SpinList.add_item
lib.structure.internal.models.ModelList.add_item
lib.structure.internal.molecules.MolList.add_item" class="py-name" href="#" onclick="return doclink('link-131', 'add_item', 'link-131');">add_item</a></tt><tt class="py-op">(</tt><tt class="py-name">model_num</tt><tt class="py-op">=</tt><tt class="py-name">model_num</tt><tt class="py-op">)</tt> </tt>
<a name="L111"></a><tt class="py-lineno"> 111</tt>  <tt class="py-line">    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Created the empty model number %s."</tt> <tt class="py-op">%</tt> <tt class="py-name">model_num</tt><tt class="py-op">)</tt> </tt>
</div><a name="L112"></a><tt class="py-lineno"> 112</tt>  <tt class="py-line"> </tt>
<a name="L113"></a><tt class="py-lineno"> 113</tt>  <tt class="py-line"> </tt>
<a name="assemble_structural_coordinates"></a><div id="assemble_structural_coordinates-def"><a name="L114"></a><tt class="py-lineno"> 114</tt> <a class="py-toggle" href="#" id="assemble_structural_coordinates-toggle" onclick="return toggle('assemble_structural_coordinates');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#assemble_structural_coordinates">assemble_structural_coordinates</a><tt class="py-op">(</tt><tt class="py-param">pipes</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">models</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">molecules</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="assemble_structural_coordinates-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="assemble_structural_coordinates-expanded"><a name="L115"></a><tt class="py-lineno"> 115</tt>  <tt class="py-line">    <tt class="py-docstring">"""Assemble the common atomic coordinates taking sequence alignments into account.</tt> </tt>
<a name="L116"></a><tt class="py-lineno"> 116</tt>  <tt class="py-line"><tt class="py-docstring"> </tt> </tt>
<a name="L117"></a><tt class="py-lineno"> 117</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pipes:     The data pipes to assemble the coordinates from.</tt> </tt>
<a name="L118"></a><tt class="py-lineno"> 118</tt>  <tt class="py-line"><tt class="py-docstring">    @type pipes:        None or list of str</tt> </tt>
<a name="L119"></a><tt class="py-lineno"> 119</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword models:    The list of models for each data pipe.  The number of elements must match the pipes argument.  If set to None, then all models will be used.</tt> </tt>
<a name="L120"></a><tt class="py-lineno"> 120</tt>  <tt class="py-line"><tt class="py-docstring">    @type models:       None or list of lists of int</tt> </tt>
<a name="L121"></a><tt class="py-lineno"> 121</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword molecules: The list of molecules for each data pipe.  The number of elements must match the pipes argument.</tt> </tt>
<a name="L122"></a><tt class="py-lineno"> 122</tt>  <tt class="py-line"><tt class="py-docstring">    @type molecules:    None or list of lists of str</tt> </tt>
<a name="L123"></a><tt class="py-lineno"> 123</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_id:   The molecule, residue, and atom identifier string.  This matches the spin ID string format.</tt> </tt>
<a name="L124"></a><tt class="py-lineno"> 124</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_id:      str or None</tt> </tt>
<a name="L125"></a><tt class="py-lineno"> 125</tt>  <tt class="py-line"><tt class="py-docstring">    @return:            The array of atomic coordinates (first dimension is the model and/or molecule, the second are the atoms, and the third are the coordinates); a list of unique IDs for each structural object, model, and molecule; the common list of molecule names; the common list of residue names; the common list of residue numbers; the common list of atom names; the common list of element names.</tt> </tt>
<a name="L126"></a><tt class="py-lineno"> 126</tt>  <tt class="py-line"><tt class="py-docstring">    @rtype:             numpy rank-3 float64 array, list of str, list of str, list of str, list of int, list of str, list of str</tt> </tt>
<a name="L127"></a><tt class="py-lineno"> 127</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L128"></a><tt class="py-lineno"> 128</tt>  <tt class="py-line"> </tt>
<a name="L129"></a><tt class="py-lineno"> 129</tt>  <tt class="py-line">    <tt class="py-comment"># Assemble the structural objects.</tt> </tt>
<a name="L130"></a><tt class="py-lineno"> 130</tt>  <tt class="py-line">    <tt id="link-132" class="py-name" targets="Module lib.spectrum.objects=lib.spectrum.objects-module.html,Module user_functions.objects=user_functions.objects-module.html"><a title="lib.spectrum.objects
user_functions.objects" class="py-name" href="#" onclick="return doclink('link-132', 'objects', 'link-132');">objects</a></tt><tt class="py-op">,</tt> <tt class="py-name">object_names</tt><tt class="py-op">,</tt> <tt id="link-133" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-133', 'pipes', 'link-85');">pipes</a></tt> <tt class="py-op">=</tt> <tt id="link-134" class="py-name" targets="Function pipe_control.structure.main.assemble_structural_objects()=pipe_control.structure.main-module.html#assemble_structural_objects"><a title="pipe_control.structure.main.assemble_structural_objects" class="py-name" href="#" onclick="return doclink('link-134', 'assemble_structural_objects', 'link-134');">assemble_structural_objects</a></tt><tt class="py-op">(</tt><tt id="link-135" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-135', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">=</tt><tt id="link-136" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-136', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">,</tt> <tt id="link-137" class="py-name" targets="Variable gui.analyses.auto_model_free.Local_tm_list.models=gui.analyses.auto_model_free.Local_tm_list-class.html#models,Variable gui.analyses.auto_model_free.Mf_list.models=gui.analyses.auto_model_free.Mf_list-class.html#models,Variable gui.analyses.auto_relax_disp.Disp_model_list.models=gui.analyses.auto_relax_disp.Disp_model_list-class.html#models,Variable gui.analyses.elements.model_list.Model_list.models=gui.analyses.elements.model_list.Model_list-class.html#models,Module lib.structure.internal.models=lib.structure.internal.models-module.html"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-137', 'models', 'link-137');">models</a></tt><tt class="py-op">=</tt><tt id="link-138" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-138', 'models', 'link-137');">models</a></tt><tt class="py-op">,</tt> <tt id="link-139" class="py-name" targets="Module lib.structure.internal.molecules=lib.structure.internal.molecules-module.html"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-139', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">=</tt><tt id="link-140" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-140', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">)</tt> </tt>
<a name="L131"></a><tt class="py-lineno"> 131</tt>  <tt class="py-line"> </tt>
<a name="L132"></a><tt class="py-lineno"> 132</tt>  <tt class="py-line">    <tt class="py-comment"># Assemble the atomic coordinates of all molecules.</tt> </tt>
<a name="L133"></a><tt class="py-lineno"> 133</tt>  <tt class="py-line">    <tt class="py-name">ids</tt><tt class="py-op">,</tt> <tt class="py-name">object_id_list</tt><tt class="py-op">,</tt> <tt id="link-141" class="py-name" targets="Module gui.analyses.elements.model_list=gui.analyses.elements.model_list-module.html,Method lib.structure.internal.object.Internal.model_list()=lib.structure.internal.object.Internal-class.html#model_list"><a title="gui.analyses.elements.model_list
lib.structure.internal.object.Internal.model_list" class="py-name" href="#" onclick="return doclink('link-141', 'model_list', 'link-141');">model_list</a></tt><tt class="py-op">,</tt> <tt class="py-name">molecule_list</tt><tt class="py-op">,</tt> <tt class="py-name">atom_pos</tt><tt class="py-op">,</tt> <tt class="py-name">mol_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_nums</tt><tt class="py-op">,</tt> <tt class="py-name">atom_names</tt><tt class="py-op">,</tt> <tt id="link-142" class="py-name" targets="Package gui.analyses.elements=gui.analyses.elements-module.html"><a title="gui.analyses.elements" class="py-name" href="#" onclick="return doclink('link-142', 'elements', 'link-142');">elements</a></tt><tt class="py-op">,</tt> <tt id="link-143" class="py-name" targets="Method lib.structure.internal.object.Internal.one_letter_codes()=lib.structure.internal.object.Internal-class.html#one_letter_codes"><a title="lib.structure.internal.object.Internal.one_letter_codes" class="py-name" href="#" onclick="return doclink('link-143', 'one_letter_codes', 'link-143');">one_letter_codes</a></tt><tt class="py-op">,</tt> <tt class="py-name">num_mols</tt> <tt class="py-op">=</tt> <tt id="link-144" class="py-name"><a title="lib.structure.internal.coordinates.assemble_atomic_coordinates" class="py-name" href="#" onclick="return doclink('link-144', 'assemble_atomic_coordinates', 'link-51');">assemble_atomic_coordinates</a></tt><tt class="py-op">(</tt><tt id="link-145" class="py-name"><a title="lib.spectrum.objects
user_functions.objects" class="py-name" href="#" onclick="return doclink('link-145', 'objects', 'link-132');">objects</a></tt><tt class="py-op">=</tt><tt id="link-146" class="py-name"><a title="lib.spectrum.objects
user_functions.objects" class="py-name" href="#" onclick="return doclink('link-146', 'objects', 'link-132');">objects</a></tt><tt class="py-op">,</tt> <tt class="py-name">object_names</tt><tt class="py-op">=</tt><tt class="py-name">object_names</tt><tt class="py-op">,</tt> <tt id="link-147" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-147', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">=</tt><tt id="link-148" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-148', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">,</tt> <tt id="link-149" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-149', 'models', 'link-137');">models</a></tt><tt class="py-op">=</tt><tt id="link-150" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-150', 'models', 'link-137');">models</a></tt><tt class="py-op">,</tt> <tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">atom_id</tt><tt class="py-op">)</tt> </tt>
<a name="L134"></a><tt class="py-lineno"> 134</tt>  <tt class="py-line"> </tt>
<a name="L135"></a><tt class="py-lineno"> 135</tt>  <tt class="py-line">    <tt class="py-comment"># No data.</tt> </tt>
<a name="L136"></a><tt class="py-lineno"> 136</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">mol_names</tt> <tt class="py-op">==</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L137"></a><tt class="py-lineno"> 137</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">atom_id</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L138"></a><tt class="py-lineno"> 138</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-151" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-151', 'RelaxError', 'link-20');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"No structural data matching the atom ID string '%s' can be found."</tt> <tt class="py-op">%</tt> <tt class="py-name">atom_id</tt><tt class="py-op">)</tt> </tt>
<a name="L139"></a><tt class="py-lineno"> 139</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L140"></a><tt class="py-lineno"> 140</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-152" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-152', 'RelaxError', 'link-20');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"No structural data can be found."</tt><tt class="py-op">)</tt> </tt>
<a name="L141"></a><tt class="py-lineno"> 141</tt>  <tt class="py-line"> </tt>
<a name="L142"></a><tt class="py-lineno"> 142</tt>  <tt class="py-line">    <tt class="py-comment"># Are all molecules the same?</tt> </tt>
<a name="L143"></a><tt class="py-lineno"> 143</tt>  <tt class="py-line">    <tt class="py-name">same_mol</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L144"></a><tt class="py-lineno"> 144</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">mol</tt> <tt class="py-keyword">in</tt> <tt class="py-name">molecule_list</tt><tt class="py-op">:</tt> </tt>
<a name="L145"></a><tt class="py-lineno"> 145</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">mol</tt> <tt class="py-op">!=</tt> <tt class="py-name">molecule_list</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L146"></a><tt class="py-lineno"> 146</tt>  <tt class="py-line">            <tt class="py-name">same_mol</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L147"></a><tt class="py-lineno"> 147</tt>  <tt class="py-line"> </tt>
<a name="L148"></a><tt class="py-lineno"> 148</tt>  <tt class="py-line">    <tt class="py-comment"># Handle sequence alignments - retrieve the alignment.</tt> </tt>
<a name="L149"></a><tt class="py-lineno"> 149</tt>  <tt class="py-line">    <tt class="py-name">align</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L150"></a><tt class="py-lineno"> 150</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-153" class="py-name"><a title="auto_analyses.frame_order.ds
gui.analyses.auto_model_free.ds
gui.analyses.auto_noe.ds
gui.analyses.auto_relax_disp.ds
gui.analyses.auto_rx_base.ds
gui.analyses.ds
gui.components.free_file_format.ds
gui.components.grid.ds
gui.pipe_editor.ds
gui.relax_gui.ds
gui.results_viewer.ds
gui.wizards.wiz_objects.ds
pipe_control.bmrb.ds
pipe_control.pipes.ds
pipe_control.relax_data.ds
pipe_control.reset.ds
pipe_control.results.ds
pipe_control.state.ds
pipe_control.structure.main.ds
specific_analyses.api.ds
test_suite.gui_tests.base_classes.ds
test_suite.gui_tests.bmrb.ds
test_suite.gui_tests.bruker.ds
test_suite.gui_tests.model_free.ds
test_suite.gui_tests.noe.ds
test_suite.gui_tests.relax_disp.ds
test_suite.gui_tests.rx.ds
test_suite.gui_tests.state.ds
test_suite.system_tests.align_tensor.ds
test_suite.system_tests.angles.ds
test_suite.system_tests.base_classes.ds
test_suite.system_tests.bmrb.ds
test_suite.system_tests.bruker.ds
test_suite.system_tests.consistency_tests.ds
test_suite.system_tests.dasha.ds
test_suite.system_tests.diffusion_tensor.ds
test_suite.system_tests.frame_order.ds
test_suite.system_tests.generic.ds
test_suite.system_tests.interatomic.ds
test_suite.system_tests.jw_mapping.ds
test_suite.system_tests.load_spins.ds
test_suite.system_tests.model_elimination.ds
test_suite.system_tests.model_free.ds
test_suite.system_tests.model_selection.ds
test_suite.system_tests.mol_res_spin.ds
test_suite.system_tests.n_state_model.ds
test_suite.system_tests.noe.ds
test_suite.system_tests.noe_restraints.ds
test_suite.system_tests.palmer.ds
test_suite.system_tests.pcs.ds
test_suite.system_tests.peak_lists.ds
test_suite.system_tests.pipes.ds
test_suite.system_tests.rdc.ds
test_suite.system_tests.relax_disp.ds
test_suite.system_tests.relax_fit.ds
test_suite.system_tests.results.ds
test_suite.system_tests.sequence.ds
test_suite.system_tests.spectrum.ds
test_suite.system_tests.state.ds
test_suite.system_tests.structure.ds
test_suite.system_tests.unit_vectors.ds
test_suite.system_tests.value.ds
test_suite.unit_tests._data_store.test___init__.ds
test_suite.unit_tests._pipe_control._structure.test_internal.ds
test_suite.unit_tests._pipe_control.test_mol_res_spin.ds
test_suite.unit_tests._pipe_control.test_pipes.ds
test_suite.unit_tests._pipe_control.test_selection.ds
test_suite.unit_tests._specific_analyses._model_free.test_api.ds
test_suite.unit_tests._specific_analyses._relax_disp.test_data.ds
test_suite.unit_tests.align_tensor_testing_base.ds
test_suite.unit_tests.base_classes.ds
test_suite.unit_tests.diffusion_tensor_testing_base.ds
test_suite.unit_tests.minimisation_testing_base.ds
test_suite.unit_tests.model_free_testing_base.ds
test_suite.unit_tests.molecule_testing_base.ds
test_suite.unit_tests.n_state_model_testing_base.ds
test_suite.unit_tests.relax_data_testing_base.ds
test_suite.unit_tests.residue_testing_base.ds
test_suite.unit_tests.sequence_testing_base.ds
test_suite.unit_tests.spin_testing_base.ds
test_suite.unit_tests.state_testing_base.ds
test_suite.unit_tests.structure_testing_base.ds
test_suite.unit_tests.value_testing_base.ds" class="py-name" href="#" onclick="return doclink('link-153', 'ds', 'link-10');">ds</a></tt><tt class="py-op">,</tt> <tt class="py-string">'sequence_alignments'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L151"></a><tt class="py-lineno"> 151</tt>  <tt class="py-line">        <tt class="py-name">align</tt> <tt class="py-op">=</tt> <tt id="link-154" class="py-name"><a title="auto_analyses.frame_order.ds
gui.analyses.auto_model_free.ds
gui.analyses.auto_noe.ds
gui.analyses.auto_relax_disp.ds
gui.analyses.auto_rx_base.ds
gui.analyses.ds
gui.components.free_file_format.ds
gui.components.grid.ds
gui.pipe_editor.ds
gui.relax_gui.ds
gui.results_viewer.ds
gui.wizards.wiz_objects.ds
pipe_control.bmrb.ds
pipe_control.pipes.ds
pipe_control.relax_data.ds
pipe_control.reset.ds
pipe_control.results.ds
pipe_control.state.ds
pipe_control.structure.main.ds
specific_analyses.api.ds
test_suite.gui_tests.base_classes.ds
test_suite.gui_tests.bmrb.ds
test_suite.gui_tests.bruker.ds
test_suite.gui_tests.model_free.ds
test_suite.gui_tests.noe.ds
test_suite.gui_tests.relax_disp.ds
test_suite.gui_tests.rx.ds
test_suite.gui_tests.state.ds
test_suite.system_tests.align_tensor.ds
test_suite.system_tests.angles.ds
test_suite.system_tests.base_classes.ds
test_suite.system_tests.bmrb.ds
test_suite.system_tests.bruker.ds
test_suite.system_tests.consistency_tests.ds
test_suite.system_tests.dasha.ds
test_suite.system_tests.diffusion_tensor.ds
test_suite.system_tests.frame_order.ds
test_suite.system_tests.generic.ds
test_suite.system_tests.interatomic.ds
test_suite.system_tests.jw_mapping.ds
test_suite.system_tests.load_spins.ds
test_suite.system_tests.model_elimination.ds
test_suite.system_tests.model_free.ds
test_suite.system_tests.model_selection.ds
test_suite.system_tests.mol_res_spin.ds
test_suite.system_tests.n_state_model.ds
test_suite.system_tests.noe.ds
test_suite.system_tests.noe_restraints.ds
test_suite.system_tests.palmer.ds
test_suite.system_tests.pcs.ds
test_suite.system_tests.peak_lists.ds
test_suite.system_tests.pipes.ds
test_suite.system_tests.rdc.ds
test_suite.system_tests.relax_disp.ds
test_suite.system_tests.relax_fit.ds
test_suite.system_tests.results.ds
test_suite.system_tests.sequence.ds
test_suite.system_tests.spectrum.ds
test_suite.system_tests.state.ds
test_suite.system_tests.structure.ds
test_suite.system_tests.unit_vectors.ds
test_suite.system_tests.value.ds
test_suite.unit_tests._data_store.test___init__.ds
test_suite.unit_tests._pipe_control._structure.test_internal.ds
test_suite.unit_tests._pipe_control.test_mol_res_spin.ds
test_suite.unit_tests._pipe_control.test_pipes.ds
test_suite.unit_tests._pipe_control.test_selection.ds
test_suite.unit_tests._specific_analyses._model_free.test_api.ds
test_suite.unit_tests._specific_analyses._relax_disp.test_data.ds
test_suite.unit_tests.align_tensor_testing_base.ds
test_suite.unit_tests.base_classes.ds
test_suite.unit_tests.diffusion_tensor_testing_base.ds
test_suite.unit_tests.minimisation_testing_base.ds
test_suite.unit_tests.model_free_testing_base.ds
test_suite.unit_tests.molecule_testing_base.ds
test_suite.unit_tests.n_state_model_testing_base.ds
test_suite.unit_tests.relax_data_testing_base.ds
test_suite.unit_tests.residue_testing_base.ds
test_suite.unit_tests.sequence_testing_base.ds
test_suite.unit_tests.spin_testing_base.ds
test_suite.unit_tests.state_testing_base.ds
test_suite.unit_tests.structure_testing_base.ds
test_suite.unit_tests.value_testing_base.ds" class="py-name" href="#" onclick="return doclink('link-154', 'ds', 'link-10');">ds</a></tt><tt class="py-op">.</tt><tt class="py-name">sequence_alignments</tt><tt class="py-op">.</tt><tt id="link-155" class="py-name" targets="Method data_store.seq_align.Sequence_alignments.find_alignment()=data_store.seq_align.Sequence_alignments-class.html#find_alignment"><a title="data_store.seq_align.Sequence_alignments.find_alignment" class="py-name" href="#" onclick="return doclink('link-155', 'find_alignment', 'link-155');">find_alignment</a></tt><tt class="py-op">(</tt><tt class="py-name">object_ids</tt><tt class="py-op">=</tt><tt class="py-name">object_id_list</tt><tt class="py-op">,</tt> <tt id="link-156" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-156', 'models', 'link-137');">models</a></tt><tt class="py-op">=</tt><tt id="link-157" class="py-name"><a title="gui.analyses.elements.model_list
lib.structure.internal.object.Internal.model_list" class="py-name" href="#" onclick="return doclink('link-157', 'model_list', 'link-141');">model_list</a></tt><tt class="py-op">,</tt> <tt id="link-158" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-158', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">=</tt><tt class="py-name">molecule_list</tt><tt class="py-op">,</tt> <tt class="py-name">sequences</tt><tt class="py-op">=</tt><tt id="link-159" class="py-name"><a title="lib.structure.internal.object.Internal.one_letter_codes" class="py-name" href="#" onclick="return doclink('link-159', 'one_letter_codes', 'link-143');">one_letter_codes</a></tt><tt class="py-op">)</tt> </tt>
<a name="L152"></a><tt class="py-lineno"> 152</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">align</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L153"></a><tt class="py-lineno"> 153</tt>  <tt class="py-line">        <tt class="py-comment"># Printout.</tt> </tt>
<a name="L154"></a><tt class="py-lineno"> 154</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\nSequence alignment found - common atoms will be determined based on this MSA:"</tt><tt class="py-op">)</tt> </tt>
<a name="L155"></a><tt class="py-lineno"> 155</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-160" class="py-name" targets="Variable user_functions.molecule.i=user_functions.molecule-module.html#i"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-160', 'i', 'link-160');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">align</tt><tt class="py-op">.</tt><tt class="py-name">object_ids</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L156"></a><tt class="py-lineno"> 156</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-name">align</tt><tt class="py-op">.</tt><tt class="py-name">strings</tt><tt class="py-op">[</tt><tt id="link-161" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-161', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L157"></a><tt class="py-lineno"> 157</tt>  <tt class="py-line"> </tt>
<a name="L158"></a><tt class="py-lineno"> 158</tt>  <tt class="py-line">        <tt class="py-comment"># Alias the required data structures.</tt> </tt>
<a name="L159"></a><tt class="py-lineno"> 159</tt>  <tt class="py-line">        <tt class="py-name">strings</tt> <tt class="py-op">=</tt> <tt class="py-name">align</tt><tt class="py-op">.</tt><tt class="py-name">strings</tt> </tt>
<a name="L160"></a><tt class="py-lineno"> 160</tt>  <tt class="py-line">        <tt class="py-name">gaps</tt> <tt class="py-op">=</tt> <tt class="py-name">align</tt><tt class="py-op">.</tt><tt class="py-name">gaps</tt> </tt>
<a name="L161"></a><tt class="py-lineno"> 161</tt>  <tt class="py-line"> </tt>
<a name="L162"></a><tt class="py-lineno"> 162</tt>  <tt class="py-line">    <tt class="py-comment"># Handle sequence alignments - no alignment required.</tt> </tt>
<a name="L163"></a><tt class="py-lineno"> 163</tt>  <tt class="py-line">    <tt class="py-keyword">elif</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-162" class="py-name"><a title="lib.spectrum.objects
user_functions.objects" class="py-name" href="#" onclick="return doclink('link-162', 'objects', 'link-132');">objects</a></tt><tt class="py-op">)</tt> <tt class="py-op">==</tt> <tt class="py-number">1</tt> <tt class="py-keyword">and</tt> <tt class="py-name">same_mol</tt><tt class="py-op">:</tt> </tt>
<a name="L164"></a><tt class="py-lineno"> 164</tt>  <tt class="py-line">        <tt class="py-comment"># Printout.</tt> </tt>
<a name="L165"></a><tt class="py-lineno"> 165</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\nSequence alignment disabled as only models with identical molecule, residue and atomic sequences are being superimposed."</tt><tt class="py-op">)</tt> </tt>
<a name="L166"></a><tt class="py-lineno"> 166</tt>  <tt class="py-line"> </tt>
<a name="L167"></a><tt class="py-lineno"> 167</tt>  <tt class="py-line">        <tt class="py-comment"># Set the one letter codes to be the alignment strings.</tt> </tt>
<a name="L168"></a><tt class="py-lineno"> 168</tt>  <tt class="py-line">        <tt class="py-name">strings</tt> <tt class="py-op">=</tt> <tt id="link-163" class="py-name"><a title="lib.structure.internal.object.Internal.one_letter_codes" class="py-name" href="#" onclick="return doclink('link-163', 'one_letter_codes', 'link-143');">one_letter_codes</a></tt> </tt>
<a name="L169"></a><tt class="py-lineno"> 169</tt>  <tt class="py-line"> </tt>
<a name="L170"></a><tt class="py-lineno"> 170</tt>  <tt class="py-line">        <tt class="py-comment"># Create an empty gap data structure.</tt> </tt>
<a name="L171"></a><tt class="py-lineno"> 171</tt>  <tt class="py-line">        <tt class="py-name">gaps</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L172"></a><tt class="py-lineno"> 172</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">mol_index</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">num_mols</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L173"></a><tt class="py-lineno"> 173</tt>  <tt class="py-line">            <tt class="py-name">gaps</tt><tt class="py-op">.</tt><tt id="link-164" class="py-name" targets="Method data_store.diff_tensor.DiffTensorSimList.append()=data_store.diff_tensor.DiffTensorSimList-class.html#append"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-164', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L174"></a><tt class="py-lineno"> 174</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-165" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-165', 'i', 'link-160');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-166" class="py-name"><a title="lib.structure.internal.object.Internal.one_letter_codes" class="py-name" href="#" onclick="return doclink('link-166', 'one_letter_codes', 'link-143');">one_letter_codes</a></tt><tt class="py-op">[</tt><tt class="py-name">mol_index</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L175"></a><tt class="py-lineno"> 175</tt>  <tt class="py-line">                <tt class="py-name">gaps</tt><tt class="py-op">[</tt><tt class="py-name">mol_index</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-167" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-167', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-number">0</tt><tt class="py-op">)</tt> </tt>
<a name="L176"></a><tt class="py-lineno"> 176</tt>  <tt class="py-line"> </tt>
<a name="L177"></a><tt class="py-lineno"> 177</tt>  <tt class="py-line">    <tt class="py-comment"># Handle sequence alignments - fall back alignment based on residue numbering.</tt> </tt>
<a name="L178"></a><tt class="py-lineno"> 178</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L179"></a><tt class="py-lineno"> 179</tt>  <tt class="py-line">        <tt class="py-comment"># Printout.</tt> </tt>
<a name="L180"></a><tt class="py-lineno"> 180</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\nSequence alignment cannot be found - falling back to a residue number based alignment."</tt><tt class="py-op">)</tt> </tt>
<a name="L181"></a><tt class="py-lineno"> 181</tt>  <tt class="py-line"> </tt>
<a name="L182"></a><tt class="py-lineno"> 182</tt>  <tt class="py-line">        <tt class="py-comment"># Convert the residue number data structure.</tt> </tt>
<a name="L183"></a><tt class="py-lineno"> 183</tt>  <tt class="py-line">        <tt class="py-name">res_num_list</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L184"></a><tt class="py-lineno"> 184</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">mol_index</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">num_mols</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L185"></a><tt class="py-lineno"> 185</tt>  <tt class="py-line">            <tt class="py-name">res_num_list</tt><tt class="py-op">.</tt><tt id="link-168" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-168', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L186"></a><tt class="py-lineno"> 186</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-169" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-169', 'i', 'link-160');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-170" class="py-name"><a title="lib.structure.internal.object.Internal.one_letter_codes" class="py-name" href="#" onclick="return doclink('link-170', 'one_letter_codes', 'link-143');">one_letter_codes</a></tt><tt class="py-op">[</tt><tt class="py-name">mol_index</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L187"></a><tt class="py-lineno"> 187</tt>  <tt class="py-line">                <tt class="py-name">key</tt> <tt class="py-op">=</tt> <tt id="link-171" class="py-name" targets="Module lib.list=lib.list-module.html"><a title="lib.list" class="py-name" href="#" onclick="return doclink('link-171', 'list', 'link-171');">list</a></tt><tt class="py-op">(</tt><tt class="py-name">res_nums</tt><tt class="py-op">[</tt><tt class="py-name">mol_index</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt id="link-172" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-172', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">keys</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L188"></a><tt class="py-lineno"> 188</tt>  <tt class="py-line">                <tt class="py-name">res_num_list</tt><tt class="py-op">[</tt><tt class="py-name">mol_index</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-173" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-173', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">res_nums</tt><tt class="py-op">[</tt><tt class="py-name">mol_index</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt id="link-174" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-174', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-name">key</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L189"></a><tt class="py-lineno"> 189</tt>  <tt class="py-line"> </tt>
<a name="L190"></a><tt class="py-lineno"> 190</tt>  <tt class="py-line">        <tt class="py-comment"># Sequence alignment.</tt> </tt>
<a name="L191"></a><tt class="py-lineno"> 191</tt>  <tt class="py-line">        <tt class="py-name">strings</tt><tt class="py-op">,</tt> <tt class="py-name">gaps</tt> <tt class="py-op">=</tt> <tt id="link-175" class="py-name"><a title="lib.sequence_alignment.msa.msa_residue_numbers" class="py-name" href="#" onclick="return doclink('link-175', 'msa_residue_numbers', 'link-45');">msa_residue_numbers</a></tt><tt class="py-op">(</tt><tt id="link-176" class="py-name"><a title="lib.structure.internal.object.Internal.one_letter_codes" class="py-name" href="#" onclick="return doclink('link-176', 'one_letter_codes', 'link-143');">one_letter_codes</a></tt><tt class="py-op">,</tt> <tt class="py-name">residue_numbers</tt><tt class="py-op">=</tt><tt class="py-name">res_num_list</tt><tt class="py-op">)</tt> </tt>
<a name="L192"></a><tt class="py-lineno"> 192</tt>  <tt class="py-line"> </tt>
<a name="L193"></a><tt class="py-lineno"> 193</tt>  <tt class="py-line">    <tt class="py-comment"># Create the residue skipping data structure. </tt> </tt>
<a name="L194"></a><tt class="py-lineno"> 194</tt>  <tt class="py-line">    <tt class="py-name">skip</tt> <tt class="py-op">=</tt> <tt id="link-177" class="py-name"><a title="lib.sequence_alignment.msa.msa_residue_skipping" class="py-name" href="#" onclick="return doclink('link-177', 'msa_residue_skipping', 'link-46');">msa_residue_skipping</a></tt><tt class="py-op">(</tt><tt class="py-name">strings</tt><tt class="py-op">=</tt><tt class="py-name">strings</tt><tt class="py-op">,</tt> <tt class="py-name">gaps</tt><tt class="py-op">=</tt><tt class="py-name">gaps</tt><tt class="py-op">)</tt> </tt>
<a name="L195"></a><tt class="py-lineno"> 195</tt>  <tt class="py-line"> </tt>
<a name="L196"></a><tt class="py-lineno"> 196</tt>  <tt class="py-line">    <tt class="py-comment"># Assemble and return the atomic coordinates and common atom information.</tt> </tt>
<a name="L197"></a><tt class="py-lineno"> 197</tt>  <tt class="py-line">    <tt class="py-name">coord</tt><tt class="py-op">,</tt> <tt class="py-name">mol_name_common</tt><tt class="py-op">,</tt> <tt class="py-name">res_name_common</tt><tt class="py-op">,</tt> <tt class="py-name">res_num_common</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name_common</tt><tt class="py-op">,</tt> <tt class="py-name">element_common</tt> <tt class="py-op">=</tt> <tt id="link-178" class="py-name"><a title="lib.structure.internal.coordinates.assemble_coord_array" class="py-name" href="#" onclick="return doclink('link-178', 'assemble_coord_array', 'link-52');">assemble_coord_array</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_pos</tt><tt class="py-op">=</tt><tt class="py-name">atom_pos</tt><tt class="py-op">,</tt> <tt class="py-name">mol_names</tt><tt class="py-op">=</tt><tt class="py-name">mol_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_names</tt><tt class="py-op">=</tt><tt class="py-name">res_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_nums</tt><tt class="py-op">=</tt><tt class="py-name">res_nums</tt><tt class="py-op">,</tt> <tt class="py-name">atom_names</tt><tt class="py-op">=</tt><tt class="py-name">atom_names</tt><tt class="py-op">,</tt> <tt id="link-179" class="py-name"><a title="gui.analyses.elements" class="py-name" href="#" onclick="return doclink('link-179', 'elements', 'link-142');">elements</a></tt><tt class="py-op">=</tt><tt id="link-180" class="py-name"><a title="gui.analyses.elements" class="py-name" href="#" onclick="return doclink('link-180', 'elements', 'link-142');">elements</a></tt><tt class="py-op">,</tt> <tt class="py-name">sequences</tt><tt class="py-op">=</tt><tt id="link-181" class="py-name"><a title="lib.structure.internal.object.Internal.one_letter_codes" class="py-name" href="#" onclick="return doclink('link-181', 'one_letter_codes', 'link-143');">one_letter_codes</a></tt><tt class="py-op">,</tt> <tt class="py-name">skip</tt><tt class="py-op">=</tt><tt class="py-name">skip</tt><tt class="py-op">)</tt> </tt>
<a name="L198"></a><tt class="py-lineno"> 198</tt>  <tt class="py-line">    <tt class="py-keyword">return</tt> <tt class="py-name">coord</tt><tt class="py-op">,</tt> <tt class="py-name">ids</tt><tt class="py-op">,</tt> <tt class="py-name">mol_name_common</tt><tt class="py-op">,</tt> <tt class="py-name">res_name_common</tt><tt class="py-op">,</tt> <tt class="py-name">res_num_common</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name_common</tt><tt class="py-op">,</tt> <tt class="py-name">element_common</tt> </tt>
</div><a name="L199"></a><tt class="py-lineno"> 199</tt>  <tt class="py-line"> </tt>
<a name="L200"></a><tt class="py-lineno"> 200</tt>  <tt class="py-line"> </tt>
<a name="assemble_structural_objects"></a><div id="assemble_structural_objects-def"><a name="L201"></a><tt class="py-lineno"> 201</tt> <a class="py-toggle" href="#" id="assemble_structural_objects-toggle" onclick="return toggle('assemble_structural_objects');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#assemble_structural_objects">assemble_structural_objects</a><tt class="py-op">(</tt><tt class="py-param">pipes</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">models</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">molecules</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="assemble_structural_objects-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="assemble_structural_objects-expanded"><a name="L202"></a><tt class="py-lineno"> 202</tt>  <tt class="py-line">    <tt class="py-docstring">"""Assemble the atomic coordinates.</tt> </tt>
<a name="L203"></a><tt class="py-lineno"> 203</tt>  <tt class="py-line"><tt class="py-docstring"> </tt> </tt>
<a name="L204"></a><tt class="py-lineno"> 204</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pipes:                     The data pipes to assemble the coordinates from.</tt> </tt>
<a name="L205"></a><tt class="py-lineno"> 205</tt>  <tt class="py-line"><tt class="py-docstring">    @type pipes:                        None or list of str</tt> </tt>
<a name="L206"></a><tt class="py-lineno"> 206</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword models:                    The list of models for each data pipe.  The number of elements must match the pipes argument.  If set to None, then all models will be used.</tt> </tt>
<a name="L207"></a><tt class="py-lineno"> 207</tt>  <tt class="py-line"><tt class="py-docstring">    @type models:                       None or list of lists of int</tt> </tt>
<a name="L208"></a><tt class="py-lineno"> 208</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword molecules:                 The list of molecules for each data pipe.  The number of elements must match the pipes argument.</tt> </tt>
<a name="L209"></a><tt class="py-lineno"> 209</tt>  <tt class="py-line"><tt class="py-docstring">    @type molecules:                    None or list of lists of str</tt> </tt>
<a name="L210"></a><tt class="py-lineno"> 210</tt>  <tt class="py-line"><tt class="py-docstring">    @return:                            The structural objects, structural object names, and data pipes list.</tt> </tt>
<a name="L211"></a><tt class="py-lineno"> 211</tt>  <tt class="py-line"><tt class="py-docstring">    @rtype:                             list of lib.structure.internal.object.Internal instances, list of str, list of str</tt> </tt>
<a name="L212"></a><tt class="py-lineno"> 212</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L213"></a><tt class="py-lineno"> 213</tt>  <tt class="py-line"> </tt>
<a name="L214"></a><tt class="py-lineno"> 214</tt>  <tt class="py-line">    <tt class="py-comment"># The data pipes to use.</tt> </tt>
<a name="L215"></a><tt class="py-lineno"> 215</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-182" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-182', 'pipes', 'link-85');">pipes</a></tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L216"></a><tt class="py-lineno"> 216</tt>  <tt class="py-line">        <tt id="link-183" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-183', 'pipes', 'link-85');">pipes</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt id="link-184" class="py-name"><a title="pipe_control.pipes.cdp_name" class="py-name" href="#" onclick="return doclink('link-184', 'cdp_name', 'link-99');">cdp_name</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">]</tt> </tt>
<a name="L217"></a><tt class="py-lineno"> 217</tt>  <tt class="py-line">    <tt class="py-name">num_pipes</tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-185" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-185', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">)</tt> </tt>
<a name="L218"></a><tt class="py-lineno"> 218</tt>  <tt class="py-line"> </tt>
<a name="L219"></a><tt class="py-lineno"> 219</tt>  <tt class="py-line">    <tt class="py-comment"># Checks.</tt> </tt>
<a name="L220"></a><tt class="py-lineno"> 220</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-186" class="py-name" targets="Module user_functions.pipe=user_functions.pipe-module.html"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-186', 'pipe', 'link-186');">pipe</a></tt> <tt class="py-keyword">in</tt> <tt id="link-187" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-187', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">:</tt> </tt>
<a name="L221"></a><tt class="py-lineno"> 221</tt>  <tt class="py-line">        <tt id="link-188" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-188', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">(</tt><tt id="link-189" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-189', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">)</tt> </tt>
<a name="L222"></a><tt class="py-lineno"> 222</tt>  <tt class="py-line"> </tt>
<a name="L223"></a><tt class="py-lineno"> 223</tt>  <tt class="py-line">    <tt class="py-comment"># Check the models and molecules arguments.</tt> </tt>
<a name="L224"></a><tt class="py-lineno"> 224</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-190" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-190', 'models', 'link-137');">models</a></tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L225"></a><tt class="py-lineno"> 225</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-191" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-191', 'models', 'link-137');">models</a></tt><tt class="py-op">)</tt> <tt class="py-op">!=</tt> <tt class="py-name">num_pipes</tt><tt class="py-op">:</tt> </tt>
<a name="L226"></a><tt class="py-lineno"> 226</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-192" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-192', 'RelaxError', 'link-20');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The %i elements of the models argument does not match the %i data pipes."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-193" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-193', 'models', 'link-137');">models</a></tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">num_pipes</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L227"></a><tt class="py-lineno"> 227</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-194" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-194', 'molecules', 'link-139');">molecules</a></tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L228"></a><tt class="py-lineno"> 228</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-195" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-195', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">)</tt> <tt class="py-op">!=</tt> <tt class="py-name">num_pipes</tt><tt class="py-op">:</tt> </tt>
<a name="L229"></a><tt class="py-lineno"> 229</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-196" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-196', 'RelaxError', 'link-20');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The %i elements of the molecules argument does not match the %i data pipes."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-197" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-197', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">num_pipes</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L230"></a><tt class="py-lineno"> 230</tt>  <tt class="py-line"> </tt>
<a name="L231"></a><tt class="py-lineno"> 231</tt>  <tt class="py-line">    <tt class="py-comment"># Assemble the structural objects.</tt> </tt>
<a name="L232"></a><tt class="py-lineno"> 232</tt>  <tt class="py-line">    <tt id="link-198" class="py-name"><a title="lib.spectrum.objects
user_functions.objects" class="py-name" href="#" onclick="return doclink('link-198', 'objects', 'link-132');">objects</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L233"></a><tt class="py-lineno"> 233</tt>  <tt class="py-line">    <tt class="py-name">object_names</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L234"></a><tt class="py-lineno"> 234</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">pipe_index</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-199" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-199', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L235"></a><tt class="py-lineno"> 235</tt>  <tt class="py-line">        <tt class="py-name">dp</tt> <tt class="py-op">=</tt> <tt id="link-200" class="py-name"><a title="pipe_control.pipes.get_pipe" class="py-name" href="#" onclick="return doclink('link-200', 'get_pipe', 'link-101');">get_pipe</a></tt><tt class="py-op">(</tt><tt id="link-201" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-201', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">[</tt><tt class="py-name">pipe_index</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L236"></a><tt class="py-lineno"> 236</tt>  <tt class="py-line">        <tt id="link-202" class="py-name"><a title="lib.spectrum.objects
user_functions.objects" class="py-name" href="#" onclick="return doclink('link-202', 'objects', 'link-132');">objects</a></tt><tt class="py-op">.</tt><tt id="link-203" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-203', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">dp</tt><tt class="py-op">.</tt><tt id="link-204" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-204', 'structure', 'link-48');">structure</a></tt><tt class="py-op">)</tt> </tt>
<a name="L237"></a><tt class="py-lineno"> 237</tt>  <tt class="py-line">        <tt class="py-name">object_names</tt><tt class="py-op">.</tt><tt id="link-205" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-205', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt id="link-206" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-206', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">[</tt><tt class="py-name">pipe_index</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L238"></a><tt class="py-lineno"> 238</tt>  <tt class="py-line"> </tt>
<a name="L239"></a><tt class="py-lineno"> 239</tt>  <tt class="py-line">    <tt class="py-comment"># Return the structural objects, object names, and the new pipes list.</tt> </tt>
<a name="L240"></a><tt class="py-lineno"> 240</tt>  <tt class="py-line">    <tt class="py-keyword">return</tt> <tt id="link-207" class="py-name"><a title="lib.spectrum.objects
user_functions.objects" class="py-name" href="#" onclick="return doclink('link-207', 'objects', 'link-132');">objects</a></tt><tt class="py-op">,</tt> <tt class="py-name">object_names</tt><tt class="py-op">,</tt> <tt id="link-208" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-208', 'pipes', 'link-85');">pipes</a></tt> </tt>
</div><a name="L241"></a><tt class="py-lineno"> 241</tt>  <tt class="py-line"> </tt>
<a name="L242"></a><tt class="py-lineno"> 242</tt>  <tt class="py-line"> </tt>
<a name="atomic_fluctuations"></a><div id="atomic_fluctuations-def"><a name="L243"></a><tt class="py-lineno"> 243</tt> <a class="py-toggle" href="#" id="atomic_fluctuations-toggle" onclick="return toggle('atomic_fluctuations');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#atomic_fluctuations">atomic_fluctuations</a><tt class="py-op">(</tt><tt class="py-param">pipes</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">models</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">molecules</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">measure</tt><tt class="py-op">=</tt><tt class="py-string">'distance'</tt><tt class="py-op">,</tt> <tt class="py-param">file</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">format</tt><tt class="py-op">=</tt><tt class="py-string">'text'</tt><tt class="py-op">,</tt> <tt class="py-param">dir</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">force</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="atomic_fluctuations-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="atomic_fluctuations-expanded"><a name="L244"></a><tt class="py-lineno"> 244</tt>  <tt class="py-line">    <tt class="py-docstring">"""Write out a correlation matrix of pairwise interatomic distance fluctuations between different structures.</tt> </tt>
<a name="L245"></a><tt class="py-lineno"> 245</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L246"></a><tt class="py-lineno"> 246</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pipes:     The data pipes to generate the interatomic distance fluctuation correlation matrix for.</tt> </tt>
<a name="L247"></a><tt class="py-lineno"> 247</tt>  <tt class="py-line"><tt class="py-docstring">    @type pipes:        None or list of str</tt> </tt>
<a name="L248"></a><tt class="py-lineno"> 248</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword models:    The list of models to generate the interatomic distance fluctuation correlation matrix for.  The number of elements must match the pipes argument.  If set to None, then all models will be used.</tt> </tt>
<a name="L249"></a><tt class="py-lineno"> 249</tt>  <tt class="py-line"><tt class="py-docstring">    @type models:       None or list of lists of int</tt> </tt>
<a name="L250"></a><tt class="py-lineno"> 250</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword molecules: The list of molecules to generate the interatomic distance fluctuation correlation matrix for.  The number of elements must match the pipes argument.</tt> </tt>
<a name="L251"></a><tt class="py-lineno"> 251</tt>  <tt class="py-line"><tt class="py-docstring">    @type molecules:    None or list of lists of str</tt> </tt>
<a name="L252"></a><tt class="py-lineno"> 252</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_id:   The atom identification string of the coordinates of interest.  This matches the spin ID string format.</tt> </tt>
<a name="L253"></a><tt class="py-lineno"> 253</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_id:      str or None</tt> </tt>
<a name="L254"></a><tt class="py-lineno"> 254</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword measure:   The type of fluctuation to measure.  This can be either 'distance' or 'angle'.</tt> </tt>
<a name="L255"></a><tt class="py-lineno"> 255</tt>  <tt class="py-line"><tt class="py-docstring">    @type measure:      str</tt> </tt>
<a name="L256"></a><tt class="py-lineno"> 256</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword file:      The name of the file to write.</tt> </tt>
<a name="L257"></a><tt class="py-lineno"> 257</tt>  <tt class="py-line"><tt class="py-docstring">    @type file:         str</tt> </tt>
<a name="L258"></a><tt class="py-lineno"> 258</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword format:    The output format.  This can be set to "text" for text file output, or "gnuplot" for creating a gnuplot script.</tt> </tt>
<a name="L259"></a><tt class="py-lineno"> 259</tt>  <tt class="py-line"><tt class="py-docstring">    @type format:       str</tt> </tt>
<a name="L260"></a><tt class="py-lineno"> 260</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword dir:       The directory where the file will be placed.  If set to None, then the file will be placed in the current directory.</tt> </tt>
<a name="L261"></a><tt class="py-lineno"> 261</tt>  <tt class="py-line"><tt class="py-docstring">    @type dir:          str or None</tt> </tt>
<a name="L262"></a><tt class="py-lineno"> 262</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword force:     The force flag which if True will cause the file to be overwritten.</tt> </tt>
<a name="L263"></a><tt class="py-lineno"> 263</tt>  <tt class="py-line"><tt class="py-docstring">    @type force:        bool</tt> </tt>
<a name="L264"></a><tt class="py-lineno"> 264</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L265"></a><tt class="py-lineno"> 265</tt>  <tt class="py-line"> </tt>
<a name="L266"></a><tt class="py-lineno"> 266</tt>  <tt class="py-line">    <tt class="py-comment"># Checks.</tt> </tt>
<a name="L267"></a><tt class="py-lineno"> 267</tt>  <tt class="py-line">    <tt id="link-209" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-209', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L268"></a><tt class="py-lineno"> 268</tt>  <tt class="py-line">    <tt id="link-210" class="py-name"><a title="pipe_control.structure.checks.check_structure" class="py-name" href="#" onclick="return doclink('link-210', 'check_structure', 'link-105');">check_structure</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L269"></a><tt class="py-lineno"> 269</tt>  <tt class="py-line">    <tt class="py-name">allowed_measures</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-string">'distance'</tt><tt class="py-op">,</tt> <tt class="py-string">'angle'</tt><tt class="py-op">,</tt> <tt class="py-string">'parallax shift'</tt><tt class="py-op">]</tt> </tt>
<a name="L270"></a><tt class="py-lineno"> 270</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">measure</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt class="py-name">allowed_measures</tt><tt class="py-op">:</tt> </tt>
<a name="L271"></a><tt class="py-lineno"> 271</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-211" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-211', 'RelaxError', 'link-20');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The measure '%s' must be one of %s."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-name">measure</tt><tt class="py-op">,</tt> <tt class="py-name">allowed_measures</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L272"></a><tt class="py-lineno"> 272</tt>  <tt class="py-line"> </tt>
<a name="L273"></a><tt class="py-lineno"> 273</tt>  <tt class="py-line">    <tt class="py-comment"># Assemble the structural coordinates.</tt> </tt>
<a name="L274"></a><tt class="py-lineno"> 274</tt>  <tt class="py-line">    <tt class="py-name">coord</tt><tt class="py-op">,</tt> <tt class="py-name">ids</tt><tt class="py-op">,</tt> <tt class="py-name">mol_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_nums</tt><tt class="py-op">,</tt> <tt class="py-name">atom_names</tt><tt class="py-op">,</tt> <tt id="link-212" class="py-name"><a title="gui.analyses.elements" class="py-name" href="#" onclick="return doclink('link-212', 'elements', 'link-142');">elements</a></tt> <tt class="py-op">=</tt> <tt id="link-213" class="py-name" targets="Function pipe_control.structure.main.assemble_structural_coordinates()=pipe_control.structure.main-module.html#assemble_structural_coordinates"><a title="pipe_control.structure.main.assemble_structural_coordinates" class="py-name" href="#" onclick="return doclink('link-213', 'assemble_structural_coordinates', 'link-213');">assemble_structural_coordinates</a></tt><tt class="py-op">(</tt><tt id="link-214" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-214', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">=</tt><tt id="link-215" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-215', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">,</tt> <tt id="link-216" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-216', 'models', 'link-137');">models</a></tt><tt class="py-op">=</tt><tt id="link-217" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-217', 'models', 'link-137');">models</a></tt><tt class="py-op">,</tt> <tt id="link-218" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-218', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">=</tt><tt id="link-219" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-219', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">,</tt> <tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">atom_id</tt><tt class="py-op">)</tt> </tt>
<a name="L275"></a><tt class="py-lineno"> 275</tt>  <tt class="py-line"> </tt>
<a name="L276"></a><tt class="py-lineno"> 276</tt>  <tt class="py-line">    <tt class="py-comment"># The number of dimensions.</tt> </tt>
<a name="L277"></a><tt class="py-lineno"> 277</tt>  <tt class="py-line">    <tt class="py-name">n</tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">atom_names</tt><tt class="py-op">)</tt> </tt>
<a name="L278"></a><tt class="py-lineno"> 278</tt>  <tt class="py-line">    <tt class="py-name">m</tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">coord</tt><tt class="py-op">)</tt> </tt>
<a name="L279"></a><tt class="py-lineno"> 279</tt>  <tt class="py-line"> </tt>
<a name="L280"></a><tt class="py-lineno"> 280</tt>  <tt class="py-line">    <tt class="py-comment"># Check that more than one structure is present.</tt> </tt>
<a name="L281"></a><tt class="py-lineno"> 281</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">m</tt> <tt class="py-op">&gt;</tt> <tt class="py-number">1</tt><tt class="py-op">:</tt> </tt>
<a name="L282"></a><tt class="py-lineno"> 282</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-220" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-220', 'RelaxError', 'link-20');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Two or more structures are required."</tt><tt class="py-op">)</tt> </tt>
<a name="L283"></a><tt class="py-lineno"> 283</tt>  <tt class="py-line"> </tt>
<a name="L284"></a><tt class="py-lineno"> 284</tt>  <tt class="py-line">    <tt class="py-comment"># The labels as spin ID strings.</tt> </tt>
<a name="L285"></a><tt class="py-lineno"> 285</tt>  <tt class="py-line">    <tt class="py-name">labels</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L286"></a><tt class="py-lineno"> 286</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-221" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-221', 'i', 'link-160');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">n</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L287"></a><tt class="py-lineno"> 287</tt>  <tt class="py-line">        <tt class="py-name">labels</tt><tt class="py-op">.</tt><tt id="link-222" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-222', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt id="link-223" class="py-name"><a title="pipe_control.mol_res_spin.generate_spin_id_unique" class="py-name" href="#" onclick="return doclink('link-223', 'generate_spin_id_unique', 'link-93');">generate_spin_id_unique</a></tt><tt class="py-op">(</tt><tt class="py-name">mol_name</tt><tt class="py-op">=</tt><tt class="py-name">mol_names</tt><tt class="py-op">[</tt><tt id="link-224" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-224', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_nums</tt><tt class="py-op">[</tt><tt id="link-225" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-225', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">res_names</tt><tt class="py-op">[</tt><tt id="link-226" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-226', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">spin_name</tt><tt class="py-op">=</tt><tt class="py-name">atom_names</tt><tt class="py-op">[</tt><tt id="link-227" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-227', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L288"></a><tt class="py-lineno"> 288</tt>  <tt class="py-line"> </tt>
<a name="L289"></a><tt class="py-lineno"> 289</tt>  <tt class="py-line">    <tt class="py-comment"># Initialise the SD matrix and other structures.</tt> </tt>
<a name="L290"></a><tt class="py-lineno"> 290</tt>  <tt class="py-line">    <tt class="py-name">matrix</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-name">n</tt><tt class="py-op">,</tt> <tt class="py-name">n</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L291"></a><tt class="py-lineno"> 291</tt>  <tt class="py-line">    <tt class="py-name">dist</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">m</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L292"></a><tt class="py-lineno"> 292</tt>  <tt class="py-line">    <tt id="link-228" class="py-name"><a title="lib.geometry.vectors
pipe_control.structure.main.vectors" class="py-name" href="#" onclick="return doclink('link-228', 'vectors', 'link-24');">vectors</a></tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-name">m</tt><tt class="py-op">,</tt> <tt class="py-number">3</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L293"></a><tt class="py-lineno"> 293</tt>  <tt class="py-line">    <tt class="py-name">parallax_vectors</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-name">m</tt><tt class="py-op">,</tt> <tt class="py-number">3</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L294"></a><tt class="py-lineno"> 294</tt>  <tt class="py-line">    <tt id="link-229" class="py-name" targets="Module lib.geometry.angles=lib.geometry.angles-module.html,Module lib.structure.angles=lib.structure.angles-module.html,Module pipe_control.angles=pipe_control.angles-module.html,Module test_suite.system_tests.angles=test_suite.system_tests.angles-module.html,Module user_functions.angles=user_functions.angles-module.html"><a title="lib.geometry.angles
lib.structure.angles
pipe_control.angles
test_suite.system_tests.angles
user_functions.angles" class="py-name" href="#" onclick="return doclink('link-229', 'angles', 'link-229');">angles</a></tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">m</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L295"></a><tt class="py-lineno"> 295</tt>  <tt class="py-line"> </tt>
<a name="L296"></a><tt class="py-lineno"> 296</tt>  <tt class="py-line">    <tt class="py-comment"># Generate the pairwise distance SD matrix.</tt> </tt>
<a name="L297"></a><tt class="py-lineno"> 297</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">measure</tt> <tt class="py-op">==</tt> <tt class="py-string">'distance'</tt><tt class="py-op">:</tt> </tt>
<a name="L298"></a><tt class="py-lineno"> 298</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-230" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-230', 'i', 'link-160');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">n</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L299"></a><tt class="py-lineno"> 299</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">j</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">n</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L300"></a><tt class="py-lineno"> 300</tt>  <tt class="py-line">                <tt class="py-comment"># Only calculate the upper triangle to avoid duplicate calculations.</tt> </tt>
<a name="L301"></a><tt class="py-lineno"> 301</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">j</tt> <tt class="py-op">&gt;</tt> <tt id="link-231" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-231', 'i', 'link-160');">i</a></tt><tt class="py-op">:</tt> </tt>
<a name="L302"></a><tt class="py-lineno"> 302</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L303"></a><tt class="py-lineno"> 303</tt>  <tt class="py-line"> </tt>
<a name="L304"></a><tt class="py-lineno"> 304</tt>  <tt class="py-line">                <tt class="py-comment"># The interatomic distances between each structure.</tt> </tt>
<a name="L305"></a><tt class="py-lineno"> 305</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">k</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">m</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L306"></a><tt class="py-lineno"> 306</tt>  <tt class="py-line">                    <tt class="py-name">dist</tt><tt class="py-op">[</tt><tt class="py-name">k</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-232" class="py-name"><a title="lib.compat.norm" class="py-name" href="#" onclick="return doclink('link-232', 'norm', 'link-5');">norm</a></tt><tt class="py-op">(</tt><tt class="py-name">coord</tt><tt class="py-op">[</tt><tt class="py-name">k</tt><tt class="py-op">,</tt> <tt id="link-233" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-233', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">-</tt> <tt class="py-name">coord</tt><tt class="py-op">[</tt><tt class="py-name">k</tt><tt class="py-op">,</tt> <tt class="py-name">j</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L307"></a><tt class="py-lineno"> 307</tt>  <tt class="py-line"> </tt>
<a name="L308"></a><tt class="py-lineno"> 308</tt>  <tt class="py-line">                <tt class="py-comment"># Calculate and store the corrected sample standard deviation.</tt> </tt>
<a name="L309"></a><tt class="py-lineno"> 309</tt>  <tt class="py-line">                <tt class="py-name">matrix</tt><tt class="py-op">[</tt><tt id="link-234" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-234', 'i', 'link-160');">i</a></tt><tt class="py-op">,</tt> <tt class="py-name">j</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">matrix</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">,</tt> <tt id="link-235" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-235', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-236" class="py-name"><a title="lib.statistics.std" class="py-name" href="#" onclick="return doclink('link-236', 'std', 'link-4');">std</a></tt><tt class="py-op">(</tt><tt class="py-name">dist</tt><tt class="py-op">,</tt> <tt class="py-name">ddof</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L310"></a><tt class="py-lineno"> 310</tt>  <tt class="py-line"> </tt>
<a name="L311"></a><tt class="py-lineno"> 311</tt>  <tt class="py-line">    <tt class="py-comment"># Generate the pairwise angle SD matrix.</tt> </tt>
<a name="L312"></a><tt class="py-lineno"> 312</tt>  <tt class="py-line">    <tt class="py-keyword">elif</tt> <tt class="py-name">measure</tt> <tt class="py-op">==</tt> <tt class="py-string">'angle'</tt><tt class="py-op">:</tt> </tt>
<a name="L313"></a><tt class="py-lineno"> 313</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the atom pairs.</tt> </tt>
<a name="L314"></a><tt class="py-lineno"> 314</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-237" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-237', 'i', 'link-160');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">n</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L315"></a><tt class="py-lineno"> 315</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">j</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">n</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L316"></a><tt class="py-lineno"> 316</tt>  <tt class="py-line">                <tt class="py-comment"># Only calculate the upper triangle to avoid duplicate calculations.</tt> </tt>
<a name="L317"></a><tt class="py-lineno"> 317</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">j</tt> <tt class="py-op">&gt;</tt> <tt id="link-238" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-238', 'i', 'link-160');">i</a></tt><tt class="py-op">:</tt> </tt>
<a name="L318"></a><tt class="py-lineno"> 318</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L319"></a><tt class="py-lineno"> 319</tt>  <tt class="py-line"> </tt>
<a name="L320"></a><tt class="py-lineno"> 320</tt>  <tt class="py-line">                <tt class="py-comment"># The interatomic vectors between each structure.</tt> </tt>
<a name="L321"></a><tt class="py-lineno"> 321</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">k</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">m</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L322"></a><tt class="py-lineno"> 322</tt>  <tt class="py-line">                    <tt id="link-239" class="py-name"><a title="lib.geometry.vectors
pipe_control.structure.main.vectors" class="py-name" href="#" onclick="return doclink('link-239', 'vectors', 'link-24');">vectors</a></tt><tt class="py-op">[</tt><tt class="py-name">k</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">coord</tt><tt class="py-op">[</tt><tt class="py-name">k</tt><tt class="py-op">,</tt> <tt id="link-240" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-240', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">-</tt> <tt class="py-name">coord</tt><tt class="py-op">[</tt><tt class="py-name">k</tt><tt class="py-op">,</tt> <tt class="py-name">j</tt><tt class="py-op">]</tt> </tt>
<a name="L323"></a><tt class="py-lineno"> 323</tt>  <tt class="py-line"> </tt>
<a name="L324"></a><tt class="py-lineno"> 324</tt>  <tt class="py-line">                <tt class="py-comment"># The average vector.</tt> </tt>
<a name="L325"></a><tt class="py-lineno"> 325</tt>  <tt class="py-line">                <tt class="py-name">ave_vect</tt> <tt class="py-op">=</tt> <tt class="py-name">average</tt><tt class="py-op">(</tt><tt id="link-241" class="py-name"><a title="lib.geometry.vectors
pipe_control.structure.main.vectors" class="py-name" href="#" onclick="return doclink('link-241', 'vectors', 'link-24');">vectors</a></tt><tt class="py-op">,</tt> <tt class="py-name">axis</tt><tt class="py-op">=</tt><tt class="py-number">0</tt><tt class="py-op">)</tt> </tt>
<a name="L326"></a><tt class="py-lineno"> 326</tt>  <tt class="py-line"> </tt>
<a name="L327"></a><tt class="py-lineno"> 327</tt>  <tt class="py-line">                <tt class="py-comment"># The intervector angles.</tt> </tt>
<a name="L328"></a><tt class="py-lineno"> 328</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">k</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">m</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L329"></a><tt class="py-lineno"> 329</tt>  <tt class="py-line">                    <tt id="link-242" class="py-name"><a title="lib.geometry.angles
lib.structure.angles
pipe_control.angles
test_suite.system_tests.angles
user_functions.angles" class="py-name" href="#" onclick="return doclink('link-242', 'angles', 'link-229');">angles</a></tt><tt class="py-op">[</tt><tt class="py-name">k</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-243" class="py-name"><a title="lib.geometry.vectors.vector_angle_atan2" class="py-name" href="#" onclick="return doclink('link-243', 'vector_angle_atan2', 'link-25');">vector_angle_atan2</a></tt><tt class="py-op">(</tt><tt class="py-name">ave_vect</tt><tt class="py-op">,</tt> <tt id="link-244" class="py-name"><a title="lib.geometry.vectors
pipe_control.structure.main.vectors" class="py-name" href="#" onclick="return doclink('link-244', 'vectors', 'link-24');">vectors</a></tt><tt class="py-op">[</tt><tt class="py-name">k</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L330"></a><tt class="py-lineno"> 330</tt>  <tt class="py-line"> </tt>
<a name="L331"></a><tt class="py-lineno"> 331</tt>  <tt class="py-line">                <tt class="py-comment"># Calculate and store the corrected sample standard deviation.</tt> </tt>
<a name="L332"></a><tt class="py-lineno"> 332</tt>  <tt class="py-line">                <tt class="py-name">matrix</tt><tt class="py-op">[</tt><tt id="link-245" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-245', 'i', 'link-160');">i</a></tt><tt class="py-op">,</tt> <tt class="py-name">j</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">matrix</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">,</tt> <tt id="link-246" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-246', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-247" class="py-name"><a title="lib.statistics.std" class="py-name" href="#" onclick="return doclink('link-247', 'std', 'link-4');">std</a></tt><tt class="py-op">(</tt><tt id="link-248" class="py-name"><a title="lib.geometry.angles
lib.structure.angles
pipe_control.angles
test_suite.system_tests.angles
user_functions.angles" class="py-name" href="#" onclick="return doclink('link-248', 'angles', 'link-229');">angles</a></tt><tt class="py-op">,</tt> <tt class="py-name">ddof</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L333"></a><tt class="py-lineno"> 333</tt>  <tt class="py-line"> </tt>
<a name="L334"></a><tt class="py-lineno"> 334</tt>  <tt class="py-line">    <tt class="py-comment"># Generate the pairwise parallax shift SD matrix.</tt> </tt>
<a name="L335"></a><tt class="py-lineno"> 335</tt>  <tt class="py-line">    <tt class="py-keyword">elif</tt> <tt class="py-name">measure</tt> <tt class="py-op">==</tt> <tt class="py-string">'parallax shift'</tt><tt class="py-op">:</tt> </tt>
<a name="L336"></a><tt class="py-lineno"> 336</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the atom pairs.</tt> </tt>
<a name="L337"></a><tt class="py-lineno"> 337</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-249" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-249', 'i', 'link-160');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">n</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L338"></a><tt class="py-lineno"> 338</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">j</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">n</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L339"></a><tt class="py-lineno"> 339</tt>  <tt class="py-line">                <tt class="py-comment"># Only calculate the upper triangle to avoid duplicate calculations.</tt> </tt>
<a name="L340"></a><tt class="py-lineno"> 340</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">j</tt> <tt class="py-op">&gt;</tt> <tt id="link-250" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-250', 'i', 'link-160');">i</a></tt><tt class="py-op">:</tt> </tt>
<a name="L341"></a><tt class="py-lineno"> 341</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L342"></a><tt class="py-lineno"> 342</tt>  <tt class="py-line"> </tt>
<a name="L343"></a><tt class="py-lineno"> 343</tt>  <tt class="py-line">                <tt class="py-comment"># The interatomic vectors between each structure.</tt> </tt>
<a name="L344"></a><tt class="py-lineno"> 344</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">k</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">m</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L345"></a><tt class="py-lineno"> 345</tt>  <tt class="py-line">                    <tt id="link-251" class="py-name"><a title="lib.geometry.vectors
pipe_control.structure.main.vectors" class="py-name" href="#" onclick="return doclink('link-251', 'vectors', 'link-24');">vectors</a></tt><tt class="py-op">[</tt><tt class="py-name">k</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">coord</tt><tt class="py-op">[</tt><tt class="py-name">k</tt><tt class="py-op">,</tt> <tt id="link-252" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-252', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">-</tt> <tt class="py-name">coord</tt><tt class="py-op">[</tt><tt class="py-name">k</tt><tt class="py-op">,</tt> <tt class="py-name">j</tt><tt class="py-op">]</tt> </tt>
<a name="L346"></a><tt class="py-lineno"> 346</tt>  <tt class="py-line"> </tt>
<a name="L347"></a><tt class="py-lineno"> 347</tt>  <tt class="py-line">                <tt class="py-comment"># The average vector.</tt> </tt>
<a name="L348"></a><tt class="py-lineno"> 348</tt>  <tt class="py-line">                <tt class="py-name">ave_vect</tt> <tt class="py-op">=</tt> <tt class="py-name">average</tt><tt class="py-op">(</tt><tt id="link-253" class="py-name"><a title="lib.geometry.vectors
pipe_control.structure.main.vectors" class="py-name" href="#" onclick="return doclink('link-253', 'vectors', 'link-24');">vectors</a></tt><tt class="py-op">,</tt> <tt class="py-name">axis</tt><tt class="py-op">=</tt><tt class="py-number">0</tt><tt class="py-op">)</tt> </tt>
<a name="L349"></a><tt class="py-lineno"> 349</tt>  <tt class="py-line"> </tt>
<a name="L350"></a><tt class="py-lineno"> 350</tt>  <tt class="py-line">                <tt class="py-comment"># Catch the zero vector.</tt> </tt>
<a name="L351"></a><tt class="py-lineno"> 351</tt>  <tt class="py-line">                <tt class="py-name">length</tt> <tt class="py-op">=</tt> <tt id="link-254" class="py-name"><a title="lib.compat.norm" class="py-name" href="#" onclick="return doclink('link-254', 'norm', 'link-5');">norm</a></tt><tt class="py-op">(</tt><tt class="py-name">ave_vect</tt><tt class="py-op">)</tt> </tt>
<a name="L352"></a><tt class="py-lineno"> 352</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">length</tt> <tt class="py-op">==</tt> <tt class="py-number">0.0</tt><tt class="py-op">:</tt> </tt>
<a name="L353"></a><tt class="py-lineno"> 353</tt>  <tt class="py-line">                    <tt class="py-name">matrix</tt><tt class="py-op">[</tt><tt id="link-255" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-255', 'i', 'link-160');">i</a></tt><tt class="py-op">,</tt> <tt class="py-name">j</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">matrix</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">,</tt> <tt id="link-256" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-256', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-number">0.0</tt> </tt>
<a name="L354"></a><tt class="py-lineno"> 354</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L355"></a><tt class="py-lineno"> 355</tt>  <tt class="py-line"> </tt>
<a name="L356"></a><tt class="py-lineno"> 356</tt>  <tt class="py-line">                <tt class="py-comment"># The unit average vector.</tt> </tt>
<a name="L357"></a><tt class="py-lineno"> 357</tt>  <tt class="py-line">                <tt class="py-name">unit</tt> <tt class="py-op">=</tt> <tt class="py-name">ave_vect</tt> <tt class="py-op">/</tt> <tt class="py-name">length</tt> </tt>
<a name="L358"></a><tt class="py-lineno"> 358</tt>  <tt class="py-line"> </tt>
<a name="L359"></a><tt class="py-lineno"> 359</tt>  <tt class="py-line">                <tt class="py-comment"># The parallax shift.</tt> </tt>
<a name="L360"></a><tt class="py-lineno"> 360</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">k</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">m</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L361"></a><tt class="py-lineno"> 361</tt>  <tt class="py-line">                    <tt class="py-comment"># The projection onto the average vector.</tt> </tt>
<a name="L362"></a><tt class="py-lineno"> 362</tt>  <tt class="py-line">                    <tt class="py-name">proj</tt> <tt class="py-op">=</tt> <tt class="py-name">dot</tt><tt class="py-op">(</tt><tt id="link-257" class="py-name"><a title="lib.geometry.vectors
pipe_control.structure.main.vectors" class="py-name" href="#" onclick="return doclink('link-257', 'vectors', 'link-24');">vectors</a></tt><tt class="py-op">[</tt><tt class="py-name">k</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">unit</tt><tt class="py-op">)</tt> <tt class="py-op">*</tt> <tt class="py-name">unit</tt> </tt>
<a name="L363"></a><tt class="py-lineno"> 363</tt>  <tt class="py-line"> </tt>
<a name="L364"></a><tt class="py-lineno"> 364</tt>  <tt class="py-line">                    <tt class="py-comment"># The distance shift.</tt> </tt>
<a name="L365"></a><tt class="py-lineno"> 365</tt>  <tt class="py-line">                    <tt class="py-name">dist</tt><tt class="py-op">[</tt><tt class="py-name">k</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-258" class="py-name"><a title="lib.compat.norm" class="py-name" href="#" onclick="return doclink('link-258', 'norm', 'link-5');">norm</a></tt><tt class="py-op">(</tt><tt id="link-259" class="py-name"><a title="lib.geometry.vectors
pipe_control.structure.main.vectors" class="py-name" href="#" onclick="return doclink('link-259', 'vectors', 'link-24');">vectors</a></tt><tt class="py-op">[</tt><tt class="py-name">k</tt><tt class="py-op">]</tt> <tt class="py-op">-</tt> <tt class="py-name">proj</tt><tt class="py-op">)</tt> </tt>
<a name="L366"></a><tt class="py-lineno"> 366</tt>  <tt class="py-line"> </tt>
<a name="L367"></a><tt class="py-lineno"> 367</tt>  <tt class="py-line">                <tt class="py-comment"># Calculate and store the corrected sample standard deviation.</tt> </tt>
<a name="L368"></a><tt class="py-lineno"> 368</tt>  <tt class="py-line">                <tt class="py-name">matrix</tt><tt class="py-op">[</tt><tt id="link-260" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-260', 'i', 'link-160');">i</a></tt><tt class="py-op">,</tt> <tt class="py-name">j</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">matrix</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">,</tt> <tt id="link-261" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-261', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-262" class="py-name"><a title="lib.statistics.std" class="py-name" href="#" onclick="return doclink('link-262', 'std', 'link-4');">std</a></tt><tt class="py-op">(</tt><tt class="py-name">dist</tt><tt class="py-op">,</tt> <tt class="py-name">ddof</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L369"></a><tt class="py-lineno"> 369</tt>  <tt class="py-line"> </tt>
<a name="L370"></a><tt class="py-lineno"> 370</tt>  <tt class="py-line">    <tt class="py-comment"># Call the plotting API.</tt> </tt>
<a name="L371"></a><tt class="py-lineno"> 371</tt>  <tt class="py-line">    <tt id="link-263" class="py-name"><a title="lib.plotting.api.correlation_matrix
lib.plotting.gnuplot.correlation_matrix
lib.plotting.text.correlation_matrix" class="py-name" href="#" onclick="return doclink('link-263', 'correlation_matrix', 'link-34');">correlation_matrix</a></tt><tt class="py-op">(</tt><tt id="link-264" class="py-name" targets="Module lib.frame_order.format=lib.frame_order.format-module.html,Function lib.warnings.format()=lib.warnings-module.html#format"><a title="lib.frame_order.format
lib.warnings.format" class="py-name" href="#" onclick="return doclink('link-264', 'format', 'link-264');">format</a></tt><tt class="py-op">=</tt><tt id="link-265" class="py-name"><a title="lib.frame_order.format
lib.warnings.format" class="py-name" href="#" onclick="return doclink('link-265', 'format', 'link-264');">format</a></tt><tt class="py-op">,</tt> <tt class="py-name">matrix</tt><tt class="py-op">=</tt><tt class="py-name">matrix</tt><tt class="py-op">,</tt> <tt class="py-name">labels</tt><tt class="py-op">=</tt><tt class="py-name">labels</tt><tt class="py-op">,</tt> <tt id="link-266" class="py-name" targets="Variable dep_check.file=dep_check-module.html#file,Module gui.input_elements.file=gui.input_elements.file-module.html"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-266', 'file', 'link-266');">file</a></tt><tt class="py-op">=</tt><tt id="link-267" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-267', 'file', 'link-266');">file</a></tt><tt class="py-op">,</tt> <tt id="link-268" class="py-name" targets="Module gui.input_elements.dir=gui.input_elements.dir-module.html"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-268', 'dir', 'link-268');">dir</a></tt><tt class="py-op">=</tt><tt id="link-269" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-269', 'dir', 'link-268');">dir</a></tt><tt class="py-op">,</tt> <tt class="py-name">force</tt><tt class="py-op">=</tt><tt class="py-name">force</tt><tt class="py-op">)</tt> </tt>
</div><a name="L372"></a><tt class="py-lineno"> 372</tt>  <tt class="py-line"> </tt>
<a name="L373"></a><tt class="py-lineno"> 373</tt>  <tt class="py-line"> </tt>
<a name="average_structure"></a><div id="average_structure-def"><a name="L374"></a><tt class="py-lineno"> 374</tt> <a class="py-toggle" href="#" id="average_structure-toggle" onclick="return toggle('average_structure');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#average_structure">average_structure</a><tt class="py-op">(</tt><tt class="py-param">pipes</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">models</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">molecules</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">set_mol_name</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">set_model_num</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="average_structure-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="average_structure-expanded"><a name="L375"></a><tt class="py-lineno"> 375</tt>  <tt class="py-line">    <tt class="py-docstring">"""Calculate a mean structure.</tt> </tt>
<a name="L376"></a><tt class="py-lineno"> 376</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L377"></a><tt class="py-lineno"> 377</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pipes:         The data pipes containing structures to average.</tt> </tt>
<a name="L378"></a><tt class="py-lineno"> 378</tt>  <tt class="py-line"><tt class="py-docstring">    @type pipes:            None or list of str</tt> </tt>
<a name="L379"></a><tt class="py-lineno"> 379</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword models:        The list of models for each data pipe.  The number of elements must match the pipes argument.  If set to None, then all models will be used.</tt> </tt>
<a name="L380"></a><tt class="py-lineno"> 380</tt>  <tt class="py-line"><tt class="py-docstring">    @type models:           None or list of lists of int</tt> </tt>
<a name="L381"></a><tt class="py-lineno"> 381</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword molecules:     The list of molecules for each data pipe.  The number of elements must match the pipes argument.</tt> </tt>
<a name="L382"></a><tt class="py-lineno"> 382</tt>  <tt class="py-line"><tt class="py-docstring">    @type molecules:        None or list of lists of str</tt> </tt>
<a name="L383"></a><tt class="py-lineno"> 383</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_id:       The molecule, residue, and atom identifier string.  This matches the spin ID string format.</tt> </tt>
<a name="L384"></a><tt class="py-lineno"> 384</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_id:          str or None</tt> </tt>
<a name="L385"></a><tt class="py-lineno"> 385</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword set_mol_name:  The molecule name for the averaged molecule.</tt> </tt>
<a name="L386"></a><tt class="py-lineno"> 386</tt>  <tt class="py-line"><tt class="py-docstring">    @type set_mol_name:     None or str</tt> </tt>
<a name="L387"></a><tt class="py-lineno"> 387</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword set_model_num: The model number for the averaged molecule.</tt> </tt>
<a name="L388"></a><tt class="py-lineno"> 388</tt>  <tt class="py-line"><tt class="py-docstring">    @type set_model_num:    None or int</tt> </tt>
<a name="L389"></a><tt class="py-lineno"> 389</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L390"></a><tt class="py-lineno"> 390</tt>  <tt class="py-line"> </tt>
<a name="L391"></a><tt class="py-lineno"> 391</tt>  <tt class="py-line">    <tt class="py-comment"># Checks.</tt> </tt>
<a name="L392"></a><tt class="py-lineno"> 392</tt>  <tt class="py-line">    <tt id="link-270" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-270', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L393"></a><tt class="py-lineno"> 393</tt>  <tt class="py-line"> </tt>
<a name="L394"></a><tt class="py-lineno"> 394</tt>  <tt class="py-line">    <tt class="py-comment"># Assemble the structural coordinates.</tt> </tt>
<a name="L395"></a><tt class="py-lineno"> 395</tt>  <tt class="py-line">    <tt class="py-name">coord</tt><tt class="py-op">,</tt> <tt class="py-name">ids</tt><tt class="py-op">,</tt> <tt class="py-name">mol_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_nums</tt><tt class="py-op">,</tt> <tt class="py-name">atom_names</tt><tt class="py-op">,</tt> <tt id="link-271" class="py-name"><a title="gui.analyses.elements" class="py-name" href="#" onclick="return doclink('link-271', 'elements', 'link-142');">elements</a></tt> <tt class="py-op">=</tt> <tt id="link-272" class="py-name"><a title="pipe_control.structure.main.assemble_structural_coordinates" class="py-name" href="#" onclick="return doclink('link-272', 'assemble_structural_coordinates', 'link-213');">assemble_structural_coordinates</a></tt><tt class="py-op">(</tt><tt id="link-273" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-273', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">=</tt><tt id="link-274" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-274', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">,</tt> <tt id="link-275" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-275', 'models', 'link-137');">models</a></tt><tt class="py-op">=</tt><tt id="link-276" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-276', 'models', 'link-137');">models</a></tt><tt class="py-op">,</tt> <tt id="link-277" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-277', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">=</tt><tt id="link-278" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-278', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">,</tt> <tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">atom_id</tt><tt class="py-op">)</tt> </tt>
<a name="L396"></a><tt class="py-lineno"> 396</tt>  <tt class="py-line"> </tt>
<a name="L397"></a><tt class="py-lineno"> 397</tt>  <tt class="py-line">    <tt class="py-comment"># Calculate the mean structure.</tt> </tt>
<a name="L398"></a><tt class="py-lineno"> 398</tt>  <tt class="py-line">    <tt class="py-name">struct</tt> <tt class="py-op">=</tt> <tt id="link-279" class="py-name"><a title="lib.structure.internal.object.Internal.mean" class="py-name" href="#" onclick="return doclink('link-279', 'mean', 'link-3');">mean</a></tt><tt class="py-op">(</tt><tt class="py-name">coord</tt><tt class="py-op">,</tt> <tt class="py-name">axis</tt><tt class="py-op">=</tt><tt class="py-number">0</tt><tt class="py-op">)</tt> </tt>
<a name="L399"></a><tt class="py-lineno"> 399</tt>  <tt class="py-line"> </tt>
<a name="L400"></a><tt class="py-lineno"> 400</tt>  <tt class="py-line">    <tt class="py-comment"># Place the structural object into the relax data store if needed.</tt> </tt>
<a name="L401"></a><tt class="py-lineno"> 401</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L402"></a><tt class="py-lineno"> 402</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-280" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-280', 'structure', 'link-48');">structure</a></tt> <tt class="py-op">=</tt> <tt id="link-281" class="py-name"><a title="lib.structure.internal.object.Internal" class="py-name" href="#" onclick="return doclink('link-281', 'Internal', 'link-63');">Internal</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L403"></a><tt class="py-lineno"> 403</tt>  <tt class="py-line"> </tt>
<a name="L404"></a><tt class="py-lineno"> 404</tt>  <tt class="py-line">    <tt class="py-comment"># Store the data.</tt> </tt>
<a name="L405"></a><tt class="py-lineno"> 405</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-282" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-282', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-283" class="py-name" targets="Method lib.structure.internal.object.Internal.add_coordinates()=lib.structure.internal.object.Internal-class.html#add_coordinates"><a title="lib.structure.internal.object.Internal.add_coordinates" class="py-name" href="#" onclick="return doclink('link-283', 'add_coordinates', 'link-283');">add_coordinates</a></tt><tt class="py-op">(</tt><tt class="py-name">coord</tt><tt class="py-op">=</tt><tt class="py-name">struct</tt><tt class="py-op">,</tt> <tt class="py-name">mol_names</tt><tt class="py-op">=</tt><tt class="py-name">mol_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_names</tt><tt class="py-op">=</tt><tt class="py-name">res_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_nums</tt><tt class="py-op">=</tt><tt class="py-name">res_nums</tt><tt class="py-op">,</tt> <tt class="py-name">atom_names</tt><tt class="py-op">=</tt><tt class="py-name">atom_names</tt><tt class="py-op">,</tt> <tt id="link-284" class="py-name"><a title="gui.analyses.elements" class="py-name" href="#" onclick="return doclink('link-284', 'elements', 'link-142');">elements</a></tt><tt class="py-op">=</tt><tt id="link-285" class="py-name"><a title="gui.analyses.elements" class="py-name" href="#" onclick="return doclink('link-285', 'elements', 'link-142');">elements</a></tt><tt class="py-op">,</tt> <tt class="py-name">set_mol_name</tt><tt class="py-op">=</tt><tt class="py-name">set_mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">set_model_num</tt><tt class="py-op">=</tt><tt class="py-name">set_model_num</tt><tt class="py-op">)</tt> </tt>
</div><a name="L406"></a><tt class="py-lineno"> 406</tt>  <tt class="py-line"> </tt>
<a name="L407"></a><tt class="py-lineno"> 407</tt>  <tt class="py-line"> </tt>
<a name="connect_atom"></a><div id="connect_atom-def"><a name="L408"></a><tt class="py-lineno"> 408</tt> <a class="py-toggle" href="#" id="connect_atom-toggle" onclick="return toggle('connect_atom');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#connect_atom">connect_atom</a><tt class="py-op">(</tt><tt class="py-param">index1</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">index2</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="connect_atom-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="connect_atom-expanded"><a name="L409"></a><tt class="py-lineno"> 409</tt>  <tt class="py-line">    <tt class="py-docstring">"""Connect two atoms.</tt> </tt>
<a name="L410"></a><tt class="py-lineno"> 410</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L411"></a><tt class="py-lineno"> 411</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword index1:    The global index of the first atom.</tt> </tt>
<a name="L412"></a><tt class="py-lineno"> 412</tt>  <tt class="py-line"><tt class="py-docstring">    @type index1:       str</tt> </tt>
<a name="L413"></a><tt class="py-lineno"> 413</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword index2:    The global index of the first atom.</tt> </tt>
<a name="L414"></a><tt class="py-lineno"> 414</tt>  <tt class="py-line"><tt class="py-docstring">    @type index2:       str</tt> </tt>
<a name="L415"></a><tt class="py-lineno"> 415</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L416"></a><tt class="py-lineno"> 416</tt>  <tt class="py-line"> </tt>
<a name="L417"></a><tt class="py-lineno"> 417</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L418"></a><tt class="py-lineno"> 418</tt>  <tt class="py-line">    <tt id="link-286" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-286', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L419"></a><tt class="py-lineno"> 419</tt>  <tt class="py-line"> </tt>
<a name="L420"></a><tt class="py-lineno"> 420</tt>  <tt class="py-line">    <tt class="py-comment"># Place the structural object into the relax data store if needed.</tt> </tt>
<a name="L421"></a><tt class="py-lineno"> 421</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L422"></a><tt class="py-lineno"> 422</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-287" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-287', 'structure', 'link-48');">structure</a></tt> <tt class="py-op">=</tt> <tt id="link-288" class="py-name"><a title="lib.structure.internal.object.Internal" class="py-name" href="#" onclick="return doclink('link-288', 'Internal', 'link-63');">Internal</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L423"></a><tt class="py-lineno"> 423</tt>  <tt class="py-line"> </tt>
<a name="L424"></a><tt class="py-lineno"> 424</tt>  <tt class="py-line">    <tt class="py-comment"># Add the atoms.</tt> </tt>
<a name="L425"></a><tt class="py-lineno"> 425</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-289" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-289', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-290" class="py-name" targets="Method lib.structure.internal.object.Internal.connect_atom()=lib.structure.internal.object.Internal-class.html#connect_atom,Function pipe_control.structure.main.connect_atom()=pipe_control.structure.main-module.html#connect_atom"><a title="lib.structure.internal.object.Internal.connect_atom
pipe_control.structure.main.connect_atom" class="py-name" href="#" onclick="return doclink('link-290', 'connect_atom', 'link-290');">connect_atom</a></tt><tt class="py-op">(</tt><tt class="py-name">index1</tt><tt class="py-op">=</tt><tt class="py-name">index1</tt><tt class="py-op">,</tt> <tt class="py-name">index2</tt><tt class="py-op">=</tt><tt class="py-name">index2</tt><tt class="py-op">)</tt> </tt>
</div><a name="L426"></a><tt class="py-lineno"> 426</tt>  <tt class="py-line"> </tt>
<a name="L427"></a><tt class="py-lineno"> 427</tt>  <tt class="py-line"> </tt>
<a name="com"></a><div id="com-def"><a name="L428"></a><tt class="py-lineno"> 428</tt> <a class="py-toggle" href="#" id="com-toggle" onclick="return toggle('com');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#com">com</a><tt class="py-op">(</tt><tt class="py-param">model</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="com-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="com-expanded"><a name="L429"></a><tt class="py-lineno"> 429</tt>  <tt class="py-line">    <tt class="py-docstring">"""Calculate the centre of mass (CoM) of all structures.</tt> </tt>
<a name="L430"></a><tt class="py-lineno"> 430</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L431"></a><tt class="py-lineno"> 431</tt>  <tt class="py-line"><tt class="py-docstring">    The value will be stored in the current data pipe 'com' variable.</tt> </tt>
<a name="L432"></a><tt class="py-lineno"> 432</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L433"></a><tt class="py-lineno"> 433</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L434"></a><tt class="py-lineno"> 434</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword model:     Only use a specific model.</tt> </tt>
<a name="L435"></a><tt class="py-lineno"> 435</tt>  <tt class="py-line"><tt class="py-docstring">    @type model:        int or None</tt> </tt>
<a name="L436"></a><tt class="py-lineno"> 436</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_id:   The molecule, residue, and atom identifier string.  This matches the spin ID string format.  If not given, then all structural data will be used for calculating the CoM.</tt> </tt>
<a name="L437"></a><tt class="py-lineno"> 437</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_id:      str or None</tt> </tt>
<a name="L438"></a><tt class="py-lineno"> 438</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L439"></a><tt class="py-lineno"> 439</tt>  <tt class="py-line"> </tt>
<a name="L440"></a><tt class="py-lineno"> 440</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L441"></a><tt class="py-lineno"> 441</tt>  <tt class="py-line">    <tt id="link-291" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-291', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L442"></a><tt class="py-lineno"> 442</tt>  <tt class="py-line"> </tt>
<a name="L443"></a><tt class="py-lineno"> 443</tt>  <tt class="py-line">    <tt class="py-comment"># Calculate and store the centre of mass.</tt> </tt>
<a name="L444"></a><tt class="py-lineno"> 444</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-292" class="py-name" targets="Function pipe_control.structure.main.com()=pipe_control.structure.main-module.html#com"><a title="pipe_control.structure.main.com" class="py-name" href="#" onclick="return doclink('link-292', 'com', 'link-292');">com</a></tt> <tt class="py-op">=</tt> <tt id="link-293" class="py-name"><a title="pipe_control.structure.mass.pipe_centre_of_mass" class="py-name" href="#" onclick="return doclink('link-293', 'pipe_centre_of_mass', 'link-109');">pipe_centre_of_mass</a></tt><tt class="py-op">(</tt><tt id="link-294" class="py-name" targets="Function lib.structure.pdb_read.model()=lib.structure.pdb_read-module.html#model,Function lib.structure.pdb_write.model()=lib.structure.pdb_write-module.html#model,Module specific_analyses.model_free.model=specific_analyses.model_free.model-module.html,Module specific_analyses.relax_disp.model=specific_analyses.relax_disp.model-module.html"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-294', 'model', 'link-294');">model</a></tt><tt class="py-op">=</tt><tt id="link-295" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-295', 'model', 'link-294');">model</a></tt><tt class="py-op">,</tt> <tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">atom_id</tt><tt class="py-op">)</tt> </tt>
</div><a name="L445"></a><tt class="py-lineno"> 445</tt>  <tt class="py-line"> </tt>
<a name="L446"></a><tt class="py-lineno"> 446</tt>  <tt class="py-line"> </tt>
<a name="create_diff_tensor_pdb"></a><div id="create_diff_tensor_pdb-def"><a name="L447"></a><tt class="py-lineno"> 447</tt> <a class="py-toggle" href="#" id="create_diff_tensor_pdb-toggle" onclick="return toggle('create_diff_tensor_pdb');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#create_diff_tensor_pdb">create_diff_tensor_pdb</a><tt class="py-op">(</tt><tt class="py-param">scale</tt><tt class="py-op">=</tt><tt class="py-number">1.8e-6</tt><tt class="py-op">,</tt> <tt class="py-param">file</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">dir</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">force</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="create_diff_tensor_pdb-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="create_diff_tensor_pdb-expanded"><a name="L448"></a><tt class="py-lineno"> 448</tt>  <tt class="py-line">    <tt class="py-docstring">"""Create the PDB representation of the diffusion tensor.</tt> </tt>
<a name="L449"></a><tt class="py-lineno"> 449</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L450"></a><tt class="py-lineno"> 450</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword scale: The scaling factor for the diffusion tensor.</tt> </tt>
<a name="L451"></a><tt class="py-lineno"> 451</tt>  <tt class="py-line"><tt class="py-docstring">    @type scale:    float</tt> </tt>
<a name="L452"></a><tt class="py-lineno"> 452</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword file:  The name of the PDB file to create.</tt> </tt>
<a name="L453"></a><tt class="py-lineno"> 453</tt>  <tt class="py-line"><tt class="py-docstring">    @type file:     str</tt> </tt>
<a name="L454"></a><tt class="py-lineno"> 454</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword dir:   The name of the directory to place the PDB file into.</tt> </tt>
<a name="L455"></a><tt class="py-lineno"> 455</tt>  <tt class="py-line"><tt class="py-docstring">    @type dir:      str</tt> </tt>
<a name="L456"></a><tt class="py-lineno"> 456</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword force: Flag which if set to True will overwrite any pre-existing file.</tt> </tt>
<a name="L457"></a><tt class="py-lineno"> 457</tt>  <tt class="py-line"><tt class="py-docstring">    @type force:    bool</tt> </tt>
<a name="L458"></a><tt class="py-lineno"> 458</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L459"></a><tt class="py-lineno"> 459</tt>  <tt class="py-line"> </tt>
<a name="L460"></a><tt class="py-lineno"> 460</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L461"></a><tt class="py-lineno"> 461</tt>  <tt class="py-line">    <tt id="link-296" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-296', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L462"></a><tt class="py-lineno"> 462</tt>  <tt class="py-line"> </tt>
<a name="L463"></a><tt class="py-lineno"> 463</tt>  <tt class="py-line">    <tt class="py-comment"># Calculate the centre of mass.</tt> </tt>
<a name="L464"></a><tt class="py-lineno"> 464</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-297" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-297', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-298" class="py-name" targets="Method gui.interpreter.Interpreter.empty()=gui.interpreter.Interpreter-class.html#empty,Method gui.interpreter.Interpreter_thread.empty()=gui.interpreter.Interpreter_thread-class.html#empty,Method lib.structure.internal.object.Internal.empty()=lib.structure.internal.object.Internal-class.html#empty"><a title="gui.interpreter.Interpreter.empty
gui.interpreter.Interpreter_thread.empty
lib.structure.internal.object.Internal.empty" class="py-name" href="#" onclick="return doclink('link-298', 'empty', 'link-298');">empty</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L465"></a><tt class="py-lineno"> 465</tt>  <tt class="py-line">        <tt id="link-299" class="py-name"><a title="pipe_control.structure.main.com" class="py-name" href="#" onclick="return doclink('link-299', 'com', 'link-292');">com</a></tt> <tt class="py-op">=</tt> <tt id="link-300" class="py-name"><a title="pipe_control.structure.mass.pipe_centre_of_mass" class="py-name" href="#" onclick="return doclink('link-300', 'pipe_centre_of_mass', 'link-109');">pipe_centre_of_mass</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L466"></a><tt class="py-lineno"> 466</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L467"></a><tt class="py-lineno"> 467</tt>  <tt class="py-line">        <tt id="link-301" class="py-name"><a title="pipe_control.structure.main.com" class="py-name" href="#" onclick="return doclink('link-301', 'com', 'link-292');">com</a></tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-number">3</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L468"></a><tt class="py-lineno"> 468</tt>  <tt class="py-line"> </tt>
<a name="L469"></a><tt class="py-lineno"> 469</tt>  <tt class="py-line">    <tt class="py-comment"># Create the structural object.</tt> </tt>
<a name="L470"></a><tt class="py-lineno"> 470</tt>  <tt class="py-line">    <tt id="link-302" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-302', 'structure', 'link-48');">structure</a></tt> <tt class="py-op">=</tt> <tt id="link-303" class="py-name"><a title="lib.structure.internal.object.Internal" class="py-name" href="#" onclick="return doclink('link-303', 'Internal', 'link-63');">Internal</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L471"></a><tt class="py-lineno"> 471</tt>  <tt class="py-line"> </tt>
<a name="L472"></a><tt class="py-lineno"> 472</tt>  <tt class="py-line">    <tt class="py-comment"># Create an array of data pipes to loop over (hybrid support).</tt> </tt>
<a name="L473"></a><tt class="py-lineno"> 473</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pipe_type</tt> <tt class="py-op">==</tt> <tt class="py-string">'hybrid'</tt><tt class="py-op">:</tt> </tt>
<a name="L474"></a><tt class="py-lineno"> 474</tt>  <tt class="py-line">        <tt class="py-name">pipe_list</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">hybrid_pipes</tt> </tt>
<a name="L475"></a><tt class="py-lineno"> 475</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L476"></a><tt class="py-lineno"> 476</tt>  <tt class="py-line">        <tt class="py-name">pipe_list</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt id="link-304" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-304', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-305" class="py-name"><a title="pipe_control.pipes.cdp_name" class="py-name" href="#" onclick="return doclink('link-305', 'cdp_name', 'link-99');">cdp_name</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">]</tt> </tt>
<a name="L477"></a><tt class="py-lineno"> 477</tt>  <tt class="py-line"> </tt>
<a name="L478"></a><tt class="py-lineno"> 478</tt>  <tt class="py-line">    <tt class="py-comment"># The molecule names.</tt> </tt>
<a name="L479"></a><tt class="py-lineno"> 479</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pipe_type</tt> <tt class="py-op">==</tt> <tt class="py-string">'hybrid'</tt><tt class="py-op">:</tt> </tt>
<a name="L480"></a><tt class="py-lineno"> 480</tt>  <tt class="py-line">        <tt class="py-name">mol_names</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L481"></a><tt class="py-lineno"> 481</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-306" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-306', 'pipe', 'link-186');">pipe</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">pipe_list</tt><tt class="py-op">:</tt> </tt>
<a name="L482"></a><tt class="py-lineno"> 482</tt>  <tt class="py-line">            <tt class="py-name">mol_names</tt><tt class="py-op">.</tt><tt id="link-307" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-307', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-string">'diff_tensor_'</tt> <tt class="py-op">%</tt> <tt id="link-308" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-308', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">)</tt> </tt>
<a name="L483"></a><tt class="py-lineno"> 483</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L484"></a><tt class="py-lineno"> 484</tt>  <tt class="py-line">        <tt class="py-name">mol_names</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-string">'diff_tensor'</tt><tt class="py-op">]</tt> </tt>
<a name="L485"></a><tt class="py-lineno"> 485</tt>  <tt class="py-line"> </tt>
<a name="L486"></a><tt class="py-lineno"> 486</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over the pipes.</tt> </tt>
<a name="L487"></a><tt class="py-lineno"> 487</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">pipe_index</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">pipe_list</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L488"></a><tt class="py-lineno"> 488</tt>  <tt class="py-line">        <tt class="py-comment"># Get the pipe container.</tt> </tt>
<a name="L489"></a><tt class="py-lineno"> 489</tt>  <tt class="py-line">        <tt id="link-309" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-309', 'pipe', 'link-186');">pipe</a></tt> <tt class="py-op">=</tt> <tt id="link-310" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-310', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-311" class="py-name"><a title="pipe_control.pipes.get_pipe" class="py-name" href="#" onclick="return doclink('link-311', 'get_pipe', 'link-101');">get_pipe</a></tt><tt class="py-op">(</tt><tt class="py-name">pipe_list</tt><tt class="py-op">[</tt><tt class="py-name">pipe_index</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L490"></a><tt class="py-lineno"> 490</tt>  <tt class="py-line"> </tt>
<a name="L491"></a><tt class="py-lineno"> 491</tt>  <tt class="py-line">        <tt class="py-comment"># Test if the diffusion tensor data is loaded.</tt> </tt>
<a name="L492"></a><tt class="py-lineno"> 492</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-312" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-312', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">,</tt> <tt class="py-string">'diff_tensor'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L493"></a><tt class="py-lineno"> 493</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-313" class="py-name" targets="Class lib.errors.RelaxNoTensorError=lib.errors.RelaxNoTensorError-class.html"><a title="lib.errors.RelaxNoTensorError" class="py-name" href="#" onclick="return doclink('link-313', 'RelaxNoTensorError', 'link-313');">RelaxNoTensorError</a></tt><tt class="py-op">(</tt><tt class="py-string">'diffusion'</tt><tt class="py-op">)</tt> </tt>
<a name="L494"></a><tt class="py-lineno"> 494</tt>  <tt class="py-line"> </tt>
<a name="L495"></a><tt class="py-lineno"> 495</tt>  <tt class="py-line">        <tt class="py-comment"># Add a new structure.</tt> </tt>
<a name="L496"></a><tt class="py-lineno"> 496</tt>  <tt class="py-line">        <tt id="link-314" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-314', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-315" class="py-name" targets="Method lib.structure.internal.object.Internal.add_molecule()=lib.structure.internal.object.Internal-class.html#add_molecule"><a title="lib.structure.internal.object.Internal.add_molecule" class="py-name" href="#" onclick="return doclink('link-315', 'add_molecule', 'link-315');">add_molecule</a></tt><tt class="py-op">(</tt><tt id="link-316" class="py-name" targets="Variable bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name=bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe-class.html#name,Variable bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name=bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1-class.html#name,Variable bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name=bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name=bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name=bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name=bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name=bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1-class.html#name,Variable pipe_control.pipes.name=pipe_control.pipes-module.html#name,Variable user_functions.pipe.name=user_functions.pipe-module.html#name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-316', 'name', 'link-316');">name</a></tt><tt class="py-op">=</tt><tt class="py-name">mol_names</tt><tt class="py-op">[</tt><tt class="py-name">pipe_index</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L497"></a><tt class="py-lineno"> 497</tt>  <tt class="py-line"> </tt>
<a name="L498"></a><tt class="py-lineno"> 498</tt>  <tt class="py-line">        <tt class="py-comment"># Alias the single molecule from the single model.</tt> </tt>
<a name="L499"></a><tt class="py-lineno"> 499</tt>  <tt class="py-line">        <tt class="py-name">mol</tt> <tt class="py-op">=</tt> <tt id="link-317" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-317', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-318" class="py-name" targets="Method lib.structure.internal.object.Internal.get_molecule()=lib.structure.internal.object.Internal-class.html#get_molecule"><a title="lib.structure.internal.object.Internal.get_molecule" class="py-name" href="#" onclick="return doclink('link-318', 'get_molecule', 'link-318');">get_molecule</a></tt><tt class="py-op">(</tt><tt class="py-name">mol_names</tt><tt class="py-op">[</tt><tt class="py-name">pipe_index</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L500"></a><tt class="py-lineno"> 500</tt>  <tt class="py-line"> </tt>
<a name="L501"></a><tt class="py-lineno"> 501</tt>  <tt class="py-line">        <tt class="py-comment"># The diffusion tensor type.</tt> </tt>
<a name="L502"></a><tt class="py-lineno"> 502</tt>  <tt class="py-line">        <tt class="py-name">diff_type</tt> <tt class="py-op">=</tt> <tt id="link-319" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-319', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-320" class="py-name" targets="Module data_store.diff_tensor=data_store.diff_tensor-module.html"><a title="data_store.diff_tensor" class="py-name" href="#" onclick="return doclink('link-320', 'diff_tensor', 'link-320');">diff_tensor</a></tt><tt class="py-op">.</tt><tt id="link-321" class="py-name" targets="Variable info.Bieri11.type=info.Bieri11-class.html#type,Variable info.Clore90.type=info.Clore90-class.html#type,Variable info.Delaglio95.type=info.Delaglio95-class.html#type,Variable info.GoddardKneller.type=info.GoddardKneller-class.html#type,Variable info.LipariSzabo82a.type=info.LipariSzabo82a-class.html#type,Variable info.LipariSzabo82b.type=info.LipariSzabo82b-class.html#type,Variable info.Ref.type=info.Ref-class.html#type,Variable info.dAuvergne06.type=info.dAuvergne06-class.html#type,Variable info.dAuvergneGooley03.type=info.dAuvergneGooley03-class.html#type,Variable info.dAuvergneGooley06.type=info.dAuvergneGooley06-class.html#type,Variable info.dAuvergneGooley07.type=info.dAuvergneGooley07-class.html#type,Variable info.dAuvergneGooley08a.type=info.dAuvergneGooley08a-class.html#type,Variable info.dAuvergneGooley08b.type=info.dAuvergneGooley08b-class.html#type,Function pipe_control.relax_data.type()=pipe_control.relax_data-module.html#type,Method specific_analyses.parameter_object.Param_list.type()=specific_analyses.parameter_object.Param_list-class.html#type"><a title="info.Bieri11.type
info.Clore90.type
info.Delaglio95.type
info.GoddardKneller.type
info.LipariSzabo82a.type
info.LipariSzabo82b.type
info.Ref.type
info.dAuvergne06.type
info.dAuvergneGooley03.type
info.dAuvergneGooley06.type
info.dAuvergneGooley07.type
info.dAuvergneGooley08a.type
info.dAuvergneGooley08b.type
pipe_control.relax_data.type
specific_analyses.parameter_object.Param_list.type" class="py-name" href="#" onclick="return doclink('link-321', 'type', 'link-321');">type</a></tt> </tt>
<a name="L503"></a><tt class="py-lineno"> 503</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">diff_type</tt> <tt class="py-op">==</tt> <tt class="py-string">'spheroid'</tt><tt class="py-op">:</tt> </tt>
<a name="L504"></a><tt class="py-lineno"> 504</tt>  <tt class="py-line">            <tt class="py-name">diff_type</tt> <tt class="py-op">=</tt> <tt id="link-322" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-322', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-323" class="py-name"><a title="data_store.diff_tensor" class="py-name" href="#" onclick="return doclink('link-323', 'diff_tensor', 'link-320');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">spheroid_type</tt> </tt>
<a name="L505"></a><tt class="py-lineno"> 505</tt>  <tt class="py-line"> </tt>
<a name="L506"></a><tt class="py-lineno"> 506</tt>  <tt class="py-line">        <tt class="py-comment"># Simulation info.</tt> </tt>
<a name="L507"></a><tt class="py-lineno"> 507</tt>  <tt class="py-line">        <tt class="py-name">sim_num</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L508"></a><tt class="py-lineno"> 508</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-324" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-324', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-325" class="py-name"><a title="data_store.diff_tensor" class="py-name" href="#" onclick="return doclink('link-325', 'diff_tensor', 'link-320');">diff_tensor</a></tt><tt class="py-op">,</tt> <tt class="py-string">'tm_sim'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L509"></a><tt class="py-lineno"> 509</tt>  <tt class="py-line">            <tt class="py-comment"># The number.</tt> </tt>
<a name="L510"></a><tt class="py-lineno"> 510</tt>  <tt class="py-line">            <tt class="py-name">sim_num</tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-326" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-326', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-327" class="py-name"><a title="data_store.diff_tensor" class="py-name" href="#" onclick="return doclink('link-327', 'diff_tensor', 'link-320');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">tm_sim</tt><tt class="py-op">)</tt> </tt>
<a name="L511"></a><tt class="py-lineno"> 511</tt>  <tt class="py-line"> </tt>
<a name="L512"></a><tt class="py-lineno"> 512</tt>  <tt class="py-line">        <tt class="py-comment"># Tensor axes.</tt> </tt>
<a name="L513"></a><tt class="py-lineno"> 513</tt>  <tt class="py-line">        <tt class="py-name">axes</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L514"></a><tt class="py-lineno"> 514</tt>  <tt class="py-line">        <tt class="py-name">sim_axes</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L515"></a><tt class="py-lineno"> 515</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">diff_type</tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt class="py-string">'oblate'</tt><tt class="py-op">,</tt> <tt class="py-string">'prolate'</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L516"></a><tt class="py-lineno"> 516</tt>  <tt class="py-line">            <tt class="py-name">axes</tt><tt class="py-op">.</tt><tt id="link-328" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-328', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt id="link-329" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-329', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-330" class="py-name"><a title="data_store.diff_tensor" class="py-name" href="#" onclick="return doclink('link-330', 'diff_tensor', 'link-320');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dpar</tt> <tt class="py-op">*</tt> <tt id="link-331" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-331', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-332" class="py-name"><a title="data_store.diff_tensor" class="py-name" href="#" onclick="return doclink('link-332', 'diff_tensor', 'link-320');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dpar_unit</tt><tt class="py-op">)</tt> </tt>
<a name="L517"></a><tt class="py-lineno"> 517</tt>  <tt class="py-line">            <tt class="py-name">sim_axes</tt><tt class="py-op">.</tt><tt id="link-333" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-333', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L518"></a><tt class="py-lineno"> 518</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">sim_num</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L519"></a><tt class="py-lineno"> 519</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt id="link-334" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-334', 'i', 'link-160');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">sim_num</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L520"></a><tt class="py-lineno"> 520</tt>  <tt class="py-line">                    <tt class="py-name">sim_axes</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-335" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-335', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt id="link-336" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-336', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-337" class="py-name"><a title="data_store.diff_tensor" class="py-name" href="#" onclick="return doclink('link-337', 'diff_tensor', 'link-320');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dpar_sim</tt><tt class="py-op">[</tt><tt id="link-338" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-338', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">*</tt> <tt id="link-339" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-339', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-340" class="py-name"><a title="data_store.diff_tensor" class="py-name" href="#" onclick="return doclink('link-340', 'diff_tensor', 'link-320');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dpar_unit_sim</tt><tt class="py-op">[</tt><tt id="link-341" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-341', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L521"></a><tt class="py-lineno"> 521</tt>  <tt class="py-line"> </tt>
<a name="L522"></a><tt class="py-lineno"> 522</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">diff_type</tt> <tt class="py-op">==</tt> <tt class="py-string">'ellipsoid'</tt><tt class="py-op">:</tt> </tt>
<a name="L523"></a><tt class="py-lineno"> 523</tt>  <tt class="py-line">            <tt class="py-name">axes</tt><tt class="py-op">.</tt><tt id="link-342" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-342', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt id="link-343" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-343', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-344" class="py-name"><a title="data_store.diff_tensor" class="py-name" href="#" onclick="return doclink('link-344', 'diff_tensor', 'link-320');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dx</tt> <tt class="py-op">*</tt> <tt id="link-345" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-345', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-346" class="py-name"><a title="data_store.diff_tensor" class="py-name" href="#" onclick="return doclink('link-346', 'diff_tensor', 'link-320');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dx_unit</tt><tt class="py-op">)</tt> </tt>
<a name="L524"></a><tt class="py-lineno"> 524</tt>  <tt class="py-line">            <tt class="py-name">axes</tt><tt class="py-op">.</tt><tt id="link-347" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-347', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt id="link-348" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-348', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-349" class="py-name"><a title="data_store.diff_tensor" class="py-name" href="#" onclick="return doclink('link-349', 'diff_tensor', 'link-320');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dy</tt> <tt class="py-op">*</tt> <tt id="link-350" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-350', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-351" class="py-name"><a title="data_store.diff_tensor" class="py-name" href="#" onclick="return doclink('link-351', 'diff_tensor', 'link-320');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dy_unit</tt><tt class="py-op">)</tt> </tt>
<a name="L525"></a><tt class="py-lineno"> 525</tt>  <tt class="py-line">            <tt class="py-name">axes</tt><tt class="py-op">.</tt><tt id="link-352" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-352', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt id="link-353" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-353', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-354" class="py-name"><a title="data_store.diff_tensor" class="py-name" href="#" onclick="return doclink('link-354', 'diff_tensor', 'link-320');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dz</tt> <tt class="py-op">*</tt> <tt id="link-355" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-355', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-356" class="py-name"><a title="data_store.diff_tensor" class="py-name" href="#" onclick="return doclink('link-356', 'diff_tensor', 'link-320');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dz_unit</tt><tt class="py-op">)</tt> </tt>
<a name="L526"></a><tt class="py-lineno"> 526</tt>  <tt class="py-line">            <tt class="py-name">sim_axes</tt><tt class="py-op">.</tt><tt id="link-357" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-357', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L527"></a><tt class="py-lineno"> 527</tt>  <tt class="py-line">            <tt class="py-name">sim_axes</tt><tt class="py-op">.</tt><tt id="link-358" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-358', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L528"></a><tt class="py-lineno"> 528</tt>  <tt class="py-line">            <tt class="py-name">sim_axes</tt><tt class="py-op">.</tt><tt id="link-359" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-359', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L529"></a><tt class="py-lineno"> 529</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">sim_num</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L530"></a><tt class="py-lineno"> 530</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt id="link-360" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-360', 'i', 'link-160');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">sim_num</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L531"></a><tt class="py-lineno"> 531</tt>  <tt class="py-line">                    <tt class="py-name">sim_axes</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-361" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-361', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt id="link-362" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-362', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-363" class="py-name"><a title="data_store.diff_tensor" class="py-name" href="#" onclick="return doclink('link-363', 'diff_tensor', 'link-320');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dx_sim</tt><tt class="py-op">[</tt><tt id="link-364" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-364', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">*</tt> <tt id="link-365" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-365', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-366" class="py-name"><a title="data_store.diff_tensor" class="py-name" href="#" onclick="return doclink('link-366', 'diff_tensor', 'link-320');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dx_unit_sim</tt><tt class="py-op">[</tt><tt id="link-367" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-367', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L532"></a><tt class="py-lineno"> 532</tt>  <tt class="py-line">                    <tt class="py-name">sim_axes</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-368" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-368', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt id="link-369" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-369', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-370" class="py-name"><a title="data_store.diff_tensor" class="py-name" href="#" onclick="return doclink('link-370', 'diff_tensor', 'link-320');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dy_sim</tt><tt class="py-op">[</tt><tt id="link-371" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-371', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">*</tt> <tt id="link-372" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-372', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-373" class="py-name"><a title="data_store.diff_tensor" class="py-name" href="#" onclick="return doclink('link-373', 'diff_tensor', 'link-320');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dy_unit_sim</tt><tt class="py-op">[</tt><tt id="link-374" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-374', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L533"></a><tt class="py-lineno"> 533</tt>  <tt class="py-line">                    <tt class="py-name">sim_axes</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-375" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-375', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt id="link-376" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-376', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-377" class="py-name"><a title="data_store.diff_tensor" class="py-name" href="#" onclick="return doclink('link-377', 'diff_tensor', 'link-320');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dz_sim</tt><tt class="py-op">[</tt><tt id="link-378" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-378', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">*</tt> <tt id="link-379" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-379', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-380" class="py-name"><a title="data_store.diff_tensor" class="py-name" href="#" onclick="return doclink('link-380', 'diff_tensor', 'link-320');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Dz_unit_sim</tt><tt class="py-op">[</tt><tt id="link-381" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-381', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L534"></a><tt class="py-lineno"> 534</tt>  <tt class="py-line"> </tt>
<a name="L535"></a><tt class="py-lineno"> 535</tt>  <tt class="py-line">        <tt class="py-comment"># Create the object.</tt> </tt>
<a name="L536"></a><tt class="py-lineno"> 536</tt>  <tt class="py-line">        <tt id="link-382" class="py-name"><a title="lib.structure.represent.diffusion_tensor
lib.structure.represent.diffusion_tensor.diffusion_tensor
pipe_control.diffusion_tensor
test_suite.system_tests.diffusion_tensor
user_functions.diffusion_tensor" class="py-name" href="#" onclick="return doclink('link-382', 'diffusion_tensor', 'link-67');">diffusion_tensor</a></tt><tt class="py-op">(</tt><tt class="py-name">mol</tt><tt class="py-op">=</tt><tt class="py-name">mol</tt><tt class="py-op">,</tt> <tt id="link-383" class="py-name" targets="Module bmrblib.structure.tensor=bmrblib.structure.tensor-module.html"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-383', 'tensor', 'link-383');">tensor</a></tt><tt class="py-op">=</tt><tt id="link-384" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-384', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-385" class="py-name"><a title="data_store.diff_tensor" class="py-name" href="#" onclick="return doclink('link-385', 'diff_tensor', 'link-320');">diff_tensor</a></tt><tt class="py-op">.</tt><tt id="link-386" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-386', 'tensor', 'link-383');">tensor</a></tt><tt class="py-op">,</tt> <tt class="py-name">tensor_diag</tt><tt class="py-op">=</tt><tt id="link-387" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-387', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-388" class="py-name"><a title="data_store.diff_tensor" class="py-name" href="#" onclick="return doclink('link-388', 'diff_tensor', 'link-320');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">tensor_diag</tt><tt class="py-op">,</tt> <tt class="py-name">diff_type</tt><tt class="py-op">=</tt><tt class="py-name">diff_type</tt><tt class="py-op">,</tt> <tt class="py-name">rotation</tt><tt class="py-op">=</tt><tt id="link-389" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-389', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">.</tt><tt id="link-390" class="py-name"><a title="data_store.diff_tensor" class="py-name" href="#" onclick="return doclink('link-390', 'diff_tensor', 'link-320');">diff_tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">rotation</tt><tt class="py-op">,</tt> <tt class="py-name">axes</tt><tt class="py-op">=</tt><tt class="py-name">axes</tt><tt class="py-op">,</tt> <tt class="py-name">sim_axes</tt><tt class="py-op">=</tt><tt class="py-name">sim_axes</tt><tt class="py-op">,</tt> <tt id="link-391" class="py-name"><a title="pipe_control.structure.main.com" class="py-name" href="#" onclick="return doclink('link-391', 'com', 'link-292');">com</a></tt><tt class="py-op">=</tt><tt id="link-392" class="py-name"><a title="pipe_control.structure.main.com" class="py-name" href="#" onclick="return doclink('link-392', 'com', 'link-292');">com</a></tt><tt class="py-op">,</tt> <tt id="link-393" class="py-name" targets="Function pipe_control.value.scale()=pipe_control.value-module.html#scale"><a title="pipe_control.value.scale" class="py-name" href="#" onclick="return doclink('link-393', 'scale', 'link-393');">scale</a></tt><tt class="py-op">=</tt><tt id="link-394" class="py-name"><a title="pipe_control.value.scale" class="py-name" href="#" onclick="return doclink('link-394', 'scale', 'link-393');">scale</a></tt><tt class="py-op">)</tt> </tt>
<a name="L537"></a><tt class="py-lineno"> 537</tt>  <tt class="py-line"> </tt>
<a name="L538"></a><tt class="py-lineno"> 538</tt>  <tt class="py-line"> </tt>
<a name="L539"></a><tt class="py-lineno"> 539</tt>  <tt class="py-line">    <tt class="py-comment"># Create the PDB file.</tt> </tt>
<a name="L540"></a><tt class="py-lineno"> 540</tt>  <tt class="py-line">    <tt class="py-comment">######################</tt> </tt>
<a name="L541"></a><tt class="py-lineno"> 541</tt>  <tt class="py-line"> </tt>
<a name="L542"></a><tt class="py-lineno"> 542</tt>  <tt class="py-line">    <tt class="py-comment"># Print out.</tt> </tt>
<a name="L543"></a><tt class="py-lineno"> 543</tt>  <tt class="py-line">    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\nGenerating the PDB file."</tt><tt class="py-op">)</tt> </tt>
<a name="L544"></a><tt class="py-lineno"> 544</tt>  <tt class="py-line"> </tt>
<a name="L545"></a><tt class="py-lineno"> 545</tt>  <tt class="py-line">    <tt class="py-comment"># Create the PDB file.</tt> </tt>
<a name="L546"></a><tt class="py-lineno"> 546</tt>  <tt class="py-line">    <tt class="py-name">tensor_pdb_file</tt> <tt class="py-op">=</tt> <tt id="link-395" class="py-name"><a title="lib.io.open_write_file" class="py-name" href="#" onclick="return doclink('link-395', 'open_write_file', 'link-29');">open_write_file</a></tt><tt class="py-op">(</tt><tt id="link-396" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-396', 'file', 'link-266');">file</a></tt><tt class="py-op">,</tt> <tt id="link-397" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-397', 'dir', 'link-268');">dir</a></tt><tt class="py-op">,</tt> <tt class="py-name">force</tt><tt class="py-op">=</tt><tt class="py-name">force</tt><tt class="py-op">)</tt> </tt>
<a name="L547"></a><tt class="py-lineno"> 547</tt>  <tt class="py-line">    <tt id="link-398" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-398', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-399" class="py-name" targets="Method lib.structure.internal.object.Internal.write_pdb()=lib.structure.internal.object.Internal-class.html#write_pdb,Function pipe_control.structure.main.write_pdb()=pipe_control.structure.main-module.html#write_pdb"><a title="lib.structure.internal.object.Internal.write_pdb
pipe_control.structure.main.write_pdb" class="py-name" href="#" onclick="return doclink('link-399', 'write_pdb', 'link-399');">write_pdb</a></tt><tt class="py-op">(</tt><tt class="py-name">tensor_pdb_file</tt><tt class="py-op">)</tt> </tt>
<a name="L548"></a><tt class="py-lineno"> 548</tt>  <tt class="py-line">    <tt class="py-name">tensor_pdb_file</tt><tt class="py-op">.</tt><tt id="link-400" class="py-name" targets="Method gui.input_elements.file.Selector_file_window.close()=gui.input_elements.file.Selector_file_window-class.html#close,Method gui.input_elements.sequence.Sequence_window.close()=gui.input_elements.sequence.Sequence_window-class.html#close,Method lib.io.DummyFileObject.close()=lib.io.DummyFileObject-class.html#close"><a title="gui.input_elements.file.Selector_file_window.close
gui.input_elements.sequence.Sequence_window.close
lib.io.DummyFileObject.close" class="py-name" href="#" onclick="return doclink('link-400', 'close', 'link-400');">close</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L549"></a><tt class="py-lineno"> 549</tt>  <tt class="py-line"> </tt>
<a name="L550"></a><tt class="py-lineno"> 550</tt>  <tt class="py-line">    <tt class="py-comment"># Add the file to the results file list.</tt> </tt>
<a name="L551"></a><tt class="py-lineno"> 551</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'result_files'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L552"></a><tt class="py-lineno"> 552</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-401" class="py-name" targets="Module pipe_control.result_files=pipe_control.result_files-module.html"><a title="pipe_control.result_files" class="py-name" href="#" onclick="return doclink('link-401', 'result_files', 'link-401');">result_files</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L553"></a><tt class="py-lineno"> 553</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-402" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-402', 'dir', 'link-268');">dir</a></tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L554"></a><tt class="py-lineno"> 554</tt>  <tt class="py-line">        <tt id="link-403" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-403', 'dir', 'link-268');">dir</a></tt> <tt class="py-op">=</tt> <tt class="py-name">getcwd</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L555"></a><tt class="py-lineno"> 555</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-404" class="py-name"><a title="pipe_control.result_files" class="py-name" href="#" onclick="return doclink('link-404', 'result_files', 'link-401');">result_files</a></tt><tt class="py-op">.</tt><tt id="link-405" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-405', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-string">'diff_tensor_pdb'</tt><tt class="py-op">,</tt> <tt class="py-string">'Diffusion tensor PDB'</tt><tt class="py-op">,</tt> <tt id="link-406" class="py-name"><a title="lib.io.get_file_path" class="py-name" href="#" onclick="return doclink('link-406', 'get_file_path', 'link-28');">get_file_path</a></tt><tt class="py-op">(</tt><tt id="link-407" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-407', 'file', 'link-266');">file</a></tt><tt class="py-op">,</tt> <tt id="link-408" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-408', 'dir', 'link-268');">dir</a></tt><tt class="py-op">)</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L556"></a><tt class="py-lineno"> 556</tt>  <tt class="py-line">    <tt id="link-409" class="py-name"><a title="auto_analyses.dauvergne_protocol.status
auto_analyses.frame_order.status
auto_analyses.noe.status
auto_analyses.relax_disp.status
auto_analyses.relax_disp_repeat_cpmg.status
auto_analyses.relax_fit.status
auto_analyses.stereochem_analysis.status
data_store.status
gui.about.status
gui.analyses.auto_model_free.status
gui.analyses.auto_noe.status
gui.analyses.auto_relax_disp.status
gui.analyses.auto_rx_base.status
gui.analyses.elements.model_list.status
gui.analyses.execute.status
gui.analyses.results_analysis.status
gui.analyses.status
gui.components.base_list.status
gui.components.free_file_format.status
gui.components.grid.status
gui.components.molecule.status
gui.components.relax_data.status
gui.components.relax_data_meta.status
gui.components.spectrum.status
gui.controller.status
gui.errors.status
gui.export_bmrb.status
gui.filedialog.status
gui.fonts.status
gui.icons.status
gui.input_elements.bool.status
gui.input_elements.dir.status
gui.input_elements.file.status
gui.input_elements.sequence.status
gui.input_elements.sequence_2D.status
gui.interpreter.status
gui.menu.status
gui.message.status
gui.misc.status
gui.pipe_editor.status
gui.relax_gui.status
gui.relax_prompt.status
gui.results_viewer.status
gui.spin_viewer.frame.status
gui.spin_viewer.tree.status
gui.status
gui.string_conv.status
gui.uf_objects.status
gui.wizards.peak_intensity.status
gui.wizards.wiz_objects.status
info.Bieri11.status
info.Clore90.status
info.Delaglio95.status
info.GoddardKneller.status
info.LipariSzabo82a.status
info.LipariSzabo82b.status
info.Ref.status
info.dAuvergne06.status
info.dAuvergneGooley03.status
info.dAuvergneGooley06.status
info.dAuvergneGooley07.status
info.dAuvergneGooley08a.status
info.dAuvergneGooley08b.status
info.status
pipe_control.bmrb.status
pipe_control.grace.status
pipe_control.minimise.status
pipe_control.mol_res_spin.status
pipe_control.molmol.status
pipe_control.pipes.status
pipe_control.pymol_control.status
pipe_control.result_files.status
pipe_control.script.status
pipe_control.state.status
pipe_control.structure.geometric.status
pipe_control.structure.main.status
pipe_control.value.status
prompt.command.status
prompt.help.status
prompt.interpreter.status
prompt.uf_docstring.status
prompt.uf_objects.status
relax.status
scons.manuals.status
setup.status
status
test_suite.gui_tests.base_classes.status
test_suite.gui_tests.bruker.status
test_suite.gui_tests.frame_order.status
test_suite.gui_tests.general.status
test_suite.gui_tests.model_free.status
test_suite.gui_tests.n_state_model.status
test_suite.gui_tests.noe.status
test_suite.gui_tests.relax_disp.status
test_suite.gui_tests.rx.status
test_suite.gui_tests.state.status
test_suite.gui_tests.test_user_functions.status
test_suite.relax_test_loader.status
test_suite.relax_test_runner.status
test_suite.system_tests.angles.status
test_suite.system_tests.bmrb.status
test_suite.system_tests.bruker.status
test_suite.system_tests.chemical_shift.status
test_suite.system_tests.consistency_tests.status
test_suite.system_tests.dasha.status
test_suite.system_tests.diffusion_tensor.status
test_suite.system_tests.frame_order.status
test_suite.system_tests.generic.status
test_suite.system_tests.grace.status
test_suite.system_tests.interatomic.status
test_suite.system_tests.jw_mapping.status
test_suite.system_tests.load_spins.status
test_suite.system_tests.model_elimination.status
test_suite.system_tests.model_free.status
test_suite.system_tests.model_selection.status
test_suite.system_tests.mol_res_spin.status
test_suite.system_tests.n_state_model.status
test_suite.system_tests.noe.status
test_suite.system_tests.noe_restraints.status
test_suite.system_tests.palmer.status
test_suite.system_tests.pcs.status
test_suite.system_tests.peak_lists.status
test_suite.system_tests.pipes.status
test_suite.system_tests.rdc.status
test_suite.system_tests.relax_data.status
test_suite.system_tests.relax_disp.status
test_suite.system_tests.relax_fit.status
test_suite.system_tests.results.status
test_suite.system_tests.sequence.status
test_suite.system_tests.spectrum.status
test_suite.system_tests.state.status
test_suite.system_tests.structure.status
test_suite.system_tests.unit_vectors.status
test_suite.test_suite_runner.status
test_suite.unit_tests._lib._dispersion.test_matrix_exponential.status
test_suite.unit_tests._lib._frame_order.test_matrix_ops.status
test_suite.unit_tests._pipe_control._structure.test_internal.status
test_suite.unit_tests._specific_analyses._model_free.test_api.status
test_suite.unit_tests._specific_analyses._relax_disp.test_checks.status
test_suite.unit_tests._specific_analyses._relax_disp.test_data.status
test_suite.unit_tests._target_functions.test_relax_fit.status
test_suite.unit_tests.package_checking.status
test_suite.unit_tests.relax_data_testing_base.status
test_suite.unit_tests.sequence_testing_base.status
test_suite.unit_tests.state_testing_base.status
test_suite.verification_tests.library.status
test_suite.verification_tests.status_object.status
version.status" class="py-name" href="#" onclick="return doclink('link-409', 'status', 'link-110');">status</a></tt><tt class="py-op">.</tt><tt class="py-name">observers</tt><tt class="py-op">.</tt><tt class="py-name">result_file</tt><tt class="py-op">.</tt><tt id="link-410" class="py-name" targets="Method status.Observer.notify()=status.Observer-class.html#notify"><a title="status.Observer.notify" class="py-name" href="#" onclick="return doclink('link-410', 'notify', 'link-410');">notify</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
</div><a name="L557"></a><tt class="py-lineno"> 557</tt>  <tt class="py-line"> </tt>
<a name="L558"></a><tt class="py-lineno"> 558</tt>  <tt class="py-line"> </tt>
<a name="delete"></a><div id="delete-def"><a name="L559"></a><tt class="py-lineno"> 559</tt> <a class="py-toggle" href="#" id="delete-toggle" onclick="return toggle('delete');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#delete">delete</a><tt class="py-op">(</tt><tt class="py-param">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">model</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">verbosity</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-param">spin_info</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="delete-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="delete-expanded"><a name="L560"></a><tt class="py-lineno"> 560</tt>  <tt class="py-line">    <tt class="py-docstring">"""Delete structural data.</tt> </tt>
<a name="L561"></a><tt class="py-lineno"> 561</tt>  <tt class="py-line"><tt class="py-docstring">    </tt> </tt>
<a name="L562"></a><tt class="py-lineno"> 562</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_id:   The molecule, residue, and atom identifier string.  This matches the spin ID string format.  If not given, then all structural data will be deleted.</tt> </tt>
<a name="L563"></a><tt class="py-lineno"> 563</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_id:      str or None</tt> </tt>
<a name="L564"></a><tt class="py-lineno"> 564</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword model:     Individual structural models from a loaded ensemble can be deleted by specifying the model number.</tt> </tt>
<a name="L565"></a><tt class="py-lineno"> 565</tt>  <tt class="py-line"><tt class="py-docstring">    @type model:        None or int</tt> </tt>
<a name="L566"></a><tt class="py-lineno"> 566</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword verbosity: The amount of information to print to screen.  Zero corresponds to minimal output while higher values increase the amount of output.  The default value is 1.</tt> </tt>
<a name="L567"></a><tt class="py-lineno"> 567</tt>  <tt class="py-line"><tt class="py-docstring">    @type verbosity:    int</tt> </tt>
<a name="L568"></a><tt class="py-lineno"> 568</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword spin_info: A flag which if True will cause all structural information in the spin containers and interatomic data containers to be deleted as well.  If False, then only the 3D structural data will be deleted.</tt> </tt>
<a name="L569"></a><tt class="py-lineno"> 569</tt>  <tt class="py-line"><tt class="py-docstring">    @type spin_info:    bool</tt> </tt>
<a name="L570"></a><tt class="py-lineno"> 570</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L571"></a><tt class="py-lineno"> 571</tt>  <tt class="py-line"> </tt>
<a name="L572"></a><tt class="py-lineno"> 572</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L573"></a><tt class="py-lineno"> 573</tt>  <tt class="py-line">    <tt id="link-411" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-411', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L574"></a><tt class="py-lineno"> 574</tt>  <tt class="py-line"> </tt>
<a name="L575"></a><tt class="py-lineno"> 575</tt>  <tt class="py-line">    <tt class="py-comment"># Run the object method.</tt> </tt>
<a name="L576"></a><tt class="py-lineno"> 576</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L577"></a><tt class="py-lineno"> 577</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-412" class="py-name" targets="Variable bmrblib.pystarlib.Text.verbosity=bmrblib.pystarlib.Text-module.html#verbosity,Variable bmrblib.pystarlib.verbosity=bmrblib.pystarlib-module.html#verbosity,Variable multi.multi_processor_base.verbosity=multi.multi_processor_base-module.html#verbosity,Variable multi.processor.verbosity=multi.processor-module.html#verbosity"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-412', 'verbosity', 'link-412');">verbosity</a></tt><tt class="py-op">:</tt> </tt>
<a name="L578"></a><tt class="py-lineno"> 578</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Deleting structural data from the current pipe."</tt><tt class="py-op">)</tt> </tt>
<a name="L579"></a><tt class="py-lineno"> 579</tt>  <tt class="py-line">        <tt id="link-413" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-413', 'selection', 'link-36');">selection</a></tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L580"></a><tt class="py-lineno"> 580</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">atom_id</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L581"></a><tt class="py-lineno"> 581</tt>  <tt class="py-line">            <tt id="link-414" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-414', 'selection', 'link-36');">selection</a></tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-415" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-415', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-416" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-416', 'selection', 'link-36');">selection</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">atom_id</tt><tt class="py-op">)</tt> </tt>
<a name="L582"></a><tt class="py-lineno"> 582</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-417" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-417', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-418" class="py-name" targets="Method gui.analyses.auto_model_free.Auto_model_free.delete()=gui.analyses.auto_model_free.Auto_model_free-class.html#delete,Method gui.analyses.auto_noe.Auto_noe.delete()=gui.analyses.auto_noe.Auto_noe-class.html#delete,Method gui.analyses.auto_relax_disp.Auto_relax_disp.delete()=gui.analyses.auto_relax_disp.Auto_relax_disp-class.html#delete,Method gui.analyses.auto_rx_base.Auto_rx.delete()=gui.analyses.auto_rx_base.Auto_rx-class.html#delete,Method gui.components.base_list.Base_list.delete()=gui.components.base_list.Base_list-class.html#delete,Method gui.input_elements.file.Selector_file_window.delete()=gui.input_elements.file.Selector_file_window-class.html#delete,Method gui.input_elements.sequence.Sequence_window.delete()=gui.input_elements.sequence.Sequence_window-class.html#delete,Function lib.io.delete()=lib.io-module.html#delete,Method lib.structure.internal.object.Internal.delete()=lib.structure.internal.object.Internal-class.html#delete,Function pipe_control.align_tensor.delete()=pipe_control.align_tensor-module.html#delete,Function pipe_control.diffusion_tensor.delete()=pipe_control.diffusion_tensor-module.html#delete,Function pipe_control.j_coupling.delete()=pipe_control.j_coupling-module.html#delete,Function pipe_control.pcs.delete()=pipe_control.pcs-module.html#delete,Function pipe_control.pipes.delete()=pipe_control.pipes-module.html#delete,Function pipe_control.rdc.delete()=pipe_control.rdc-module.html#delete,Function pipe_control.relax_data.delete()=pipe_control.relax_data-module.html#delete,Function pipe_control.spectrum.delete()=pipe_control.spectrum-module.html#delete,Function pipe_control.structure.main.delete()=pipe_control.structure.main-module.html#delete,Function specific_analyses.model_free.uf.delete()=specific_analyses.model_free.uf-module.html#delete"><a title="gui.analyses.auto_model_free.Auto_model_free.delete
gui.analyses.auto_noe.Auto_noe.delete
gui.analyses.auto_relax_disp.Auto_relax_disp.delete
gui.analyses.auto_rx_base.Auto_rx.delete
gui.components.base_list.Base_list.delete
gui.input_elements.file.Selector_file_window.delete
gui.input_elements.sequence.Sequence_window.delete
lib.io.delete
lib.structure.internal.object.Internal.delete
pipe_control.align_tensor.delete
pipe_control.diffusion_tensor.delete
pipe_control.j_coupling.delete
pipe_control.pcs.delete
pipe_control.pipes.delete
pipe_control.rdc.delete
pipe_control.relax_data.delete
pipe_control.spectrum.delete
pipe_control.structure.main.delete
specific_analyses.model_free.uf.delete" class="py-name" href="#" onclick="return doclink('link-418', 'delete', 'link-418');">delete</a></tt><tt class="py-op">(</tt><tt id="link-419" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-419', 'model', 'link-294');">model</a></tt><tt class="py-op">=</tt><tt id="link-420" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-420', 'model', 'link-294');">model</a></tt><tt class="py-op">,</tt> <tt id="link-421" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-421', 'selection', 'link-36');">selection</a></tt><tt class="py-op">=</tt><tt id="link-422" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-422', 'selection', 'link-36');">selection</a></tt><tt class="py-op">,</tt> <tt id="link-423" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-423', 'verbosity', 'link-412');">verbosity</a></tt><tt class="py-op">=</tt><tt id="link-424" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-424', 'verbosity', 'link-412');">verbosity</a></tt><tt class="py-op">)</tt> </tt>
<a name="L583"></a><tt class="py-lineno"> 583</tt>  <tt class="py-line">    <tt class="py-keyword">elif</tt> <tt id="link-425" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-425', 'verbosity', 'link-412');">verbosity</a></tt><tt class="py-op">:</tt> </tt>
<a name="L584"></a><tt class="py-lineno"> 584</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"No structures are present."</tt><tt class="py-op">)</tt> </tt>
<a name="L585"></a><tt class="py-lineno"> 585</tt>  <tt class="py-line"> </tt>
<a name="L586"></a><tt class="py-lineno"> 586</tt>  <tt class="py-line">    <tt class="py-comment"># Skip the rest.</tt> </tt>
<a name="L587"></a><tt class="py-lineno"> 587</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">spin_info</tt><tt class="py-op">:</tt> </tt>
<a name="L588"></a><tt class="py-lineno"> 588</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> </tt>
<a name="L589"></a><tt class="py-lineno"> 589</tt>  <tt class="py-line"> </tt>
<a name="L590"></a><tt class="py-lineno"> 590</tt>  <tt class="py-line">    <tt class="py-comment"># Then remove any spin specific structural info.</tt> </tt>
<a name="L591"></a><tt class="py-lineno"> 591</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-426" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-426', 'verbosity', 'link-412');">verbosity</a></tt><tt class="py-op">:</tt> </tt>
<a name="L592"></a><tt class="py-lineno"> 592</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Deleting all spin specific structural info."</tt><tt class="py-op">)</tt> </tt>
<a name="L593"></a><tt class="py-lineno"> 593</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-427" class="py-name" targets="Module test_suite.unit_tests._pipe_control.spin=test_suite.unit_tests._pipe_control.spin-module.html,Module user_functions.spin=user_functions.spin-module.html"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-427', 'spin', 'link-427');">spin</a></tt> <tt class="py-keyword">in</tt> <tt id="link-428" class="py-name"><a title="pipe_control.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-428', 'spin_loop', 'link-96');">spin_loop</a></tt><tt class="py-op">(</tt><tt id="link-429" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-429', 'selection', 'link-36');">selection</a></tt><tt class="py-op">=</tt><tt class="py-name">atom_id</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L594"></a><tt class="py-lineno"> 594</tt>  <tt class="py-line">        <tt class="py-comment"># Delete positional information.</tt> </tt>
<a name="L595"></a><tt class="py-lineno"> 595</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-430" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-430', 'spin', 'link-427');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pos'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L596"></a><tt class="py-lineno"> 596</tt>  <tt class="py-line">            <tt class="py-keyword">del</tt> <tt id="link-431" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-431', 'spin', 'link-427');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pos</tt> </tt>
<a name="L597"></a><tt class="py-lineno"> 597</tt>  <tt class="py-line"> </tt>
<a name="L598"></a><tt class="py-lineno"> 598</tt>  <tt class="py-line">    <tt class="py-comment"># Then remove any interatomic vector structural info.</tt> </tt>
<a name="L599"></a><tt class="py-lineno"> 599</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-432" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-432', 'verbosity', 'link-412');">verbosity</a></tt><tt class="py-op">:</tt> </tt>
<a name="L600"></a><tt class="py-lineno"> 600</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Deleting all interatomic vectors."</tt><tt class="py-op">)</tt> </tt>
<a name="L601"></a><tt class="py-lineno"> 601</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-433" class="py-name" targets="Module user_functions.interatom=user_functions.interatom-module.html"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-433', 'interatom', 'link-433');">interatom</a></tt> <tt class="py-keyword">in</tt> <tt id="link-434" class="py-name"><a title="pipe_control.interatomic.interatomic_loop" class="py-name" href="#" onclick="return doclink('link-434', 'interatomic_loop', 'link-88');">interatomic_loop</a></tt><tt class="py-op">(</tt><tt class="py-name">selection1</tt><tt class="py-op">=</tt><tt class="py-name">atom_id</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L602"></a><tt class="py-lineno"> 602</tt>  <tt class="py-line">        <tt class="py-comment"># Delete bond vectors.</tt> </tt>
<a name="L603"></a><tt class="py-lineno"> 603</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-435" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-435', 'interatom', 'link-433');">interatom</a></tt><tt class="py-op">,</tt> <tt class="py-string">'vector'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L604"></a><tt class="py-lineno"> 604</tt>  <tt class="py-line">            <tt class="py-keyword">del</tt> <tt id="link-436" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-436', 'interatom', 'link-433');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">vector</tt> </tt>
</div><a name="L605"></a><tt class="py-lineno"> 605</tt>  <tt class="py-line"> </tt>
<a name="L606"></a><tt class="py-lineno"> 606</tt>  <tt class="py-line"> </tt>
<a name="displacement"></a><div id="displacement-def"><a name="L607"></a><tt class="py-lineno"> 607</tt> <a class="py-toggle" href="#" id="displacement-toggle" onclick="return toggle('displacement');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#displacement">displacement</a><tt class="py-op">(</tt><tt class="py-param">pipes</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">models</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">molecules</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">centroid</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="displacement-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="displacement-expanded"><a name="L608"></a><tt class="py-lineno"> 608</tt>  <tt class="py-line">    <tt class="py-docstring">"""Calculate the rotational and translational displacement between structures or models.</tt> </tt>
<a name="L609"></a><tt class="py-lineno"> 609</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L610"></a><tt class="py-lineno"> 610</tt>  <tt class="py-line"><tt class="py-docstring">    All results will be placed into the current data pipe cdp.structure.displacements data structure.</tt> </tt>
<a name="L611"></a><tt class="py-lineno"> 611</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L612"></a><tt class="py-lineno"> 612</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L613"></a><tt class="py-lineno"> 613</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pipes:     The data pipes to determine the displacements for.</tt> </tt>
<a name="L614"></a><tt class="py-lineno"> 614</tt>  <tt class="py-line"><tt class="py-docstring">    @type pipes:        None or list of str</tt> </tt>
<a name="L615"></a><tt class="py-lineno"> 615</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword models:    The list of models to determine the displacements for.  The number of elements must match the pipes argument.  If set to None, then all models will be used.</tt> </tt>
<a name="L616"></a><tt class="py-lineno"> 616</tt>  <tt class="py-line"><tt class="py-docstring">    @type models:       None or list of lists of int</tt> </tt>
<a name="L617"></a><tt class="py-lineno"> 617</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword molecules: The list of molecules to determine the displacements for.  The number of elements must match the pipes argument.</tt> </tt>
<a name="L618"></a><tt class="py-lineno"> 618</tt>  <tt class="py-line"><tt class="py-docstring">    @type molecules:    None or list of lists of str</tt> </tt>
<a name="L619"></a><tt class="py-lineno"> 619</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_id:   The atom identification string of the coordinates of interest.  This matches the spin ID string format.</tt> </tt>
<a name="L620"></a><tt class="py-lineno"> 620</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_id:      str or None</tt> </tt>
<a name="L621"></a><tt class="py-lineno"> 621</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword centroid:  An alternative position of the centroid, used for studying pivoted systems.</tt> </tt>
<a name="L622"></a><tt class="py-lineno"> 622</tt>  <tt class="py-line"><tt class="py-docstring">    @type centroid:     list of float or numpy rank-1, 3D array</tt> </tt>
<a name="L623"></a><tt class="py-lineno"> 623</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L624"></a><tt class="py-lineno"> 624</tt>  <tt class="py-line"> </tt>
<a name="L625"></a><tt class="py-lineno"> 625</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L626"></a><tt class="py-lineno"> 626</tt>  <tt class="py-line">    <tt id="link-437" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-437', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L627"></a><tt class="py-lineno"> 627</tt>  <tt class="py-line"> </tt>
<a name="L628"></a><tt class="py-lineno"> 628</tt>  <tt class="py-line">    <tt class="py-comment"># Assemble the structural coordinates.</tt> </tt>
<a name="L629"></a><tt class="py-lineno"> 629</tt>  <tt class="py-line">    <tt class="py-name">coord</tt><tt class="py-op">,</tt> <tt class="py-name">ids</tt><tt class="py-op">,</tt> <tt class="py-name">mol_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_nums</tt><tt class="py-op">,</tt> <tt class="py-name">atom_names</tt><tt class="py-op">,</tt> <tt id="link-438" class="py-name"><a title="gui.analyses.elements" class="py-name" href="#" onclick="return doclink('link-438', 'elements', 'link-142');">elements</a></tt> <tt class="py-op">=</tt> <tt id="link-439" class="py-name"><a title="pipe_control.structure.main.assemble_structural_coordinates" class="py-name" href="#" onclick="return doclink('link-439', 'assemble_structural_coordinates', 'link-213');">assemble_structural_coordinates</a></tt><tt class="py-op">(</tt><tt id="link-440" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-440', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">=</tt><tt id="link-441" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-441', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">,</tt> <tt id="link-442" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-442', 'models', 'link-137');">models</a></tt><tt class="py-op">=</tt><tt id="link-443" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-443', 'models', 'link-137');">models</a></tt><tt class="py-op">,</tt> <tt id="link-444" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-444', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">=</tt><tt id="link-445" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-445', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">,</tt> <tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">atom_id</tt><tt class="py-op">)</tt> </tt>
<a name="L630"></a><tt class="py-lineno"> 630</tt>  <tt class="py-line"> </tt>
<a name="L631"></a><tt class="py-lineno"> 631</tt>  <tt class="py-line">    <tt class="py-comment"># Initialise the data structure.</tt> </tt>
<a name="L632"></a><tt class="py-lineno"> 632</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-446" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-446', 'structure', 'link-48');">structure</a></tt><tt class="py-op">,</tt> <tt class="py-string">'displacments'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L633"></a><tt class="py-lineno"> 633</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-447" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-447', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-448" class="py-name"><a title="lib.structure.internal.displacements" class="py-name" href="#" onclick="return doclink('link-448', 'displacements', 'link-57');">displacements</a></tt> <tt class="py-op">=</tt> <tt id="link-449" class="py-name"><a title="lib.structure.internal.displacements.Displacements" class="py-name" href="#" onclick="return doclink('link-449', 'Displacements', 'link-58');">Displacements</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L634"></a><tt class="py-lineno"> 634</tt>  <tt class="py-line"> </tt>
<a name="L635"></a><tt class="py-lineno"> 635</tt>  <tt class="py-line">    <tt class="py-comment"># Double loop over all structures, sending the data to the base container for the calculations.</tt> </tt>
<a name="L636"></a><tt class="py-lineno"> 636</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-450" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-450', 'i', 'link-160');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">ids</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L637"></a><tt class="py-lineno"> 637</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">j</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">ids</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L638"></a><tt class="py-lineno"> 638</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-451" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-451', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-452" class="py-name"><a title="lib.structure.internal.displacements" class="py-name" href="#" onclick="return doclink('link-452', 'displacements', 'link-57');">displacements</a></tt><tt class="py-op">.</tt><tt id="link-453" class="py-name" targets="Method lib.structure.internal.displacements.Displacements._calculate()=lib.structure.internal.displacements.Displacements-class.html#_calculate"><a title="lib.structure.internal.displacements.Displacements._calculate" class="py-name" href="#" onclick="return doclink('link-453', '_calculate', 'link-453');">_calculate</a></tt><tt class="py-op">(</tt><tt class="py-name">id_from</tt><tt class="py-op">=</tt><tt class="py-name">ids</tt><tt class="py-op">[</tt><tt id="link-454" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-454', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">id_to</tt><tt class="py-op">=</tt><tt class="py-name">ids</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">coord_from</tt><tt class="py-op">=</tt><tt class="py-name">coord</tt><tt class="py-op">[</tt><tt id="link-455" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-455', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">coord_to</tt><tt class="py-op">=</tt><tt class="py-name">coord</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">centroid</tt><tt class="py-op">=</tt><tt class="py-name">centroid</tt><tt class="py-op">)</tt> </tt>
</div><a name="L639"></a><tt class="py-lineno"> 639</tt>  <tt class="py-line"> </tt>
<a name="L640"></a><tt class="py-lineno"> 640</tt>  <tt class="py-line"> </tt>
<a name="find_pivot"></a><div id="find_pivot-def"><a name="L641"></a><tt class="py-lineno"> 641</tt> <a class="py-toggle" href="#" id="find_pivot-toggle" onclick="return toggle('find_pivot');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#find_pivot">find_pivot</a><tt class="py-op">(</tt><tt class="py-param">pipes</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">models</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">molecules</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">init_pos</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">func_tol</tt><tt class="py-op">=</tt><tt class="py-number">1e-5</tt><tt class="py-op">,</tt> <tt class="py-param">box_limit</tt><tt class="py-op">=</tt><tt class="py-number">200</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="find_pivot-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="find_pivot-expanded"><a name="L642"></a><tt class="py-lineno"> 642</tt>  <tt class="py-line">    <tt class="py-docstring">"""Find the pivoted motion of a set of structural models or structures.</tt> </tt>
<a name="L643"></a><tt class="py-lineno"> 643</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L644"></a><tt class="py-lineno"> 644</tt>  <tt class="py-line"><tt class="py-docstring">    The pivot will be placed into the current data pipe cdp.structure.pivot data structure.</tt> </tt>
<a name="L645"></a><tt class="py-lineno"> 645</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L646"></a><tt class="py-lineno"> 646</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L647"></a><tt class="py-lineno"> 647</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pipes:     The data pipes to use in the motional pivot algorithm.</tt> </tt>
<a name="L648"></a><tt class="py-lineno"> 648</tt>  <tt class="py-line"><tt class="py-docstring">    @type pipes:        None or list of str</tt> </tt>
<a name="L649"></a><tt class="py-lineno"> 649</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword models:    The list of models to use.  The number of elements must match the pipes argument.  If set to None, then all models will be used.</tt> </tt>
<a name="L650"></a><tt class="py-lineno"> 650</tt>  <tt class="py-line"><tt class="py-docstring">    @type models:       None or list of lists of int</tt> </tt>
<a name="L651"></a><tt class="py-lineno"> 651</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword molecules: The list of molecules to find the pivoted motion for.  The number of elements must match the pipes argument.</tt> </tt>
<a name="L652"></a><tt class="py-lineno"> 652</tt>  <tt class="py-line"><tt class="py-docstring">    @type molecules:    None or list of lists of str</tt> </tt>
<a name="L653"></a><tt class="py-lineno"> 653</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_id:   The molecule, residue, and atom identifier string.  This matches the spin ID string format.</tt> </tt>
<a name="L654"></a><tt class="py-lineno"> 654</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_id:      str or None</tt> </tt>
<a name="L655"></a><tt class="py-lineno"> 655</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword init_pos:  The starting pivot position for the pivot point optimisation.</tt> </tt>
<a name="L656"></a><tt class="py-lineno"> 656</tt>  <tt class="py-line"><tt class="py-docstring">    @type init_pos:     list of float or numpy rank-1, 3D array</tt> </tt>
<a name="L657"></a><tt class="py-lineno"> 657</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword func_tol:  The function tolerance which, when reached, terminates optimisation.  Setting this to None turns of the check.</tt> </tt>
<a name="L658"></a><tt class="py-lineno"> 658</tt>  <tt class="py-line"><tt class="py-docstring">    @type func_tol:     None or float</tt> </tt>
<a name="L659"></a><tt class="py-lineno"> 659</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword box_limit: The simplex optimisation used in this function is constrained withing a box of +/- x Angstrom containing the pivot point using the logarithmic barrier function.  This argument is the value of x.</tt> </tt>
<a name="L660"></a><tt class="py-lineno"> 660</tt>  <tt class="py-line"><tt class="py-docstring">    @type box_limit:    int</tt> </tt>
<a name="L661"></a><tt class="py-lineno"> 661</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L662"></a><tt class="py-lineno"> 662</tt>  <tt class="py-line"> </tt>
<a name="L663"></a><tt class="py-lineno"> 663</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L664"></a><tt class="py-lineno"> 664</tt>  <tt class="py-line">    <tt id="link-456" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-456', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L665"></a><tt class="py-lineno"> 665</tt>  <tt class="py-line"> </tt>
<a name="L666"></a><tt class="py-lineno"> 666</tt>  <tt class="py-line">    <tt class="py-comment"># Initialised the starting position if needed.</tt> </tt>
<a name="L667"></a><tt class="py-lineno"> 667</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">init_pos</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L668"></a><tt class="py-lineno"> 668</tt>  <tt class="py-line">        <tt class="py-name">init_pos</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-number">3</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L669"></a><tt class="py-lineno"> 669</tt>  <tt class="py-line">    <tt class="py-name">init_pos</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">init_pos</tt><tt class="py-op">)</tt> </tt>
<a name="L670"></a><tt class="py-lineno"> 670</tt>  <tt class="py-line"> </tt>
<a name="L671"></a><tt class="py-lineno"> 671</tt>  <tt class="py-line">    <tt class="py-comment"># Assemble the structural coordinates.</tt> </tt>
<a name="L672"></a><tt class="py-lineno"> 672</tt>  <tt class="py-line">    <tt class="py-name">coord</tt><tt class="py-op">,</tt> <tt class="py-name">ids</tt><tt class="py-op">,</tt> <tt class="py-name">mol_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_nums</tt><tt class="py-op">,</tt> <tt class="py-name">atom_names</tt><tt class="py-op">,</tt> <tt id="link-457" class="py-name"><a title="gui.analyses.elements" class="py-name" href="#" onclick="return doclink('link-457', 'elements', 'link-142');">elements</a></tt> <tt class="py-op">=</tt> <tt id="link-458" class="py-name"><a title="pipe_control.structure.main.assemble_structural_coordinates" class="py-name" href="#" onclick="return doclink('link-458', 'assemble_structural_coordinates', 'link-213');">assemble_structural_coordinates</a></tt><tt class="py-op">(</tt><tt id="link-459" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-459', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">=</tt><tt id="link-460" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-460', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">,</tt> <tt id="link-461" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-461', 'models', 'link-137');">models</a></tt><tt class="py-op">=</tt><tt id="link-462" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-462', 'models', 'link-137');">models</a></tt><tt class="py-op">,</tt> <tt id="link-463" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-463', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">=</tt><tt id="link-464" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-464', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">,</tt> <tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">atom_id</tt><tt class="py-op">)</tt> </tt>
<a name="L673"></a><tt class="py-lineno"> 673</tt>  <tt class="py-line"> </tt>
<a name="L674"></a><tt class="py-lineno"> 674</tt>  <tt class="py-line">    <tt class="py-comment"># Linear constraints for the pivot position (between -1000 and 1000 Angstrom).</tt> </tt>
<a name="L675"></a><tt class="py-lineno"> 675</tt>  <tt class="py-line">    <tt class="py-name">A</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-number">6</tt><tt class="py-op">,</tt> <tt class="py-number">3</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L676"></a><tt class="py-lineno"> 676</tt>  <tt class="py-line">    <tt class="py-name">b</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-number">6</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L677"></a><tt class="py-lineno"> 677</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-465" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-465', 'i', 'link-160');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-number">3</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L678"></a><tt class="py-lineno"> 678</tt>  <tt class="py-line">        <tt class="py-name">A</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">*</tt><tt id="link-466" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-466', 'i', 'link-160');">i</a></tt><tt class="py-op">,</tt> <tt id="link-467" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-467', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-number">1</tt> </tt>
<a name="L679"></a><tt class="py-lineno"> 679</tt>  <tt class="py-line">        <tt class="py-name">A</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">*</tt><tt id="link-468" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-468', 'i', 'link-160');">i</a></tt><tt class="py-op">+</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt id="link-469" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-469', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-op">-</tt><tt class="py-number">1</tt> </tt>
<a name="L680"></a><tt class="py-lineno"> 680</tt>  <tt class="py-line">        <tt class="py-name">b</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">*</tt><tt id="link-470" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-470', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-op">-</tt><tt class="py-name">box_limit</tt> </tt>
<a name="L681"></a><tt class="py-lineno"> 681</tt>  <tt class="py-line">        <tt class="py-name">b</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">*</tt><tt id="link-471" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-471', 'i', 'link-160');">i</a></tt><tt class="py-op">+</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-op">-</tt><tt class="py-name">box_limit</tt> </tt>
<a name="L682"></a><tt class="py-lineno"> 682</tt>  <tt class="py-line"> </tt>
<a name="L683"></a><tt class="py-lineno"> 683</tt>  <tt class="py-line">    <tt class="py-comment"># The target function.</tt> </tt>
<a name="L684"></a><tt class="py-lineno"> 684</tt>  <tt class="py-line">    <tt class="py-name">finder</tt> <tt class="py-op">=</tt> <tt id="link-472" class="py-name"><a title="target_functions.ens_pivot_finder.Pivot_finder" class="py-name" href="#" onclick="return doclink('link-472', 'Pivot_finder', 'link-116');">Pivot_finder</a></tt><tt class="py-op">(</tt><tt id="link-473" class="py-name"><a title="lib.list" class="py-name" href="#" onclick="return doclink('link-473', 'list', 'link-171');">list</a></tt><tt class="py-op">(</tt><tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">coord</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">coord</tt><tt class="py-op">)</tt> </tt>
<a name="L685"></a><tt class="py-lineno"> 685</tt>  <tt class="py-line">    <tt id="link-474" class="py-name" targets="Module pipe_control.results=pipe_control.results-module.html,Module test_suite.system_tests.results=test_suite.system_tests.results-module.html,Module user_functions.results=user_functions.results-module.html"><a title="pipe_control.results
test_suite.system_tests.results
user_functions.results" class="py-name" href="#" onclick="return doclink('link-474', 'results', 'link-474');">results</a></tt> <tt class="py-op">=</tt> <tt id="link-475" class="py-name"><a title="minfx.generic.generic_minimise" class="py-name" href="#" onclick="return doclink('link-475', 'generic_minimise', 'link-2');">generic_minimise</a></tt><tt class="py-op">(</tt><tt id="link-476" class="py-name" targets="Method minfx.constraint_linear.Constraint_linear.func()=minfx.constraint_linear.Constraint_linear-class.html#func,Method target_functions.consistency_tests.Consistency.func()=target_functions.consistency_tests.Consistency-class.html#func,Method target_functions.ens_pivot_finder.Pivot_finder.func()=target_functions.ens_pivot_finder.Pivot_finder-class.html#func,Method target_functions.jw_mapping.Mapping.func()=target_functions.jw_mapping.Mapping-class.html#func"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func" class="py-name" href="#" onclick="return doclink('link-476', 'func', 'link-476');">func</a></tt><tt class="py-op">=</tt><tt class="py-name">finder</tt><tt class="py-op">.</tt><tt id="link-477" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func" class="py-name" href="#" onclick="return doclink('link-477', 'func', 'link-476');">func</a></tt><tt class="py-op">,</tt> <tt class="py-name">x0</tt><tt class="py-op">=</tt><tt class="py-name">init_pos</tt><tt class="py-op">,</tt> <tt class="py-name">min_algor</tt><tt class="py-op">=</tt><tt class="py-string">'Log barrier'</tt><tt class="py-op">,</tt> <tt class="py-name">min_options</tt><tt class="py-op">=</tt><tt class="py-op">(</tt><tt class="py-string">'simplex'</tt><tt class="py-op">,</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">A</tt><tt class="py-op">=</tt><tt class="py-name">A</tt><tt class="py-op">,</tt> <tt class="py-name">b</tt><tt class="py-op">=</tt><tt class="py-name">b</tt><tt class="py-op">,</tt> <tt class="py-name">func_tol</tt><tt class="py-op">=</tt><tt class="py-name">func_tol</tt><tt class="py-op">,</tt> <tt class="py-name">print_flag</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L686"></a><tt class="py-lineno"> 686</tt>  <tt class="py-line"> </tt>
<a name="L687"></a><tt class="py-lineno"> 687</tt>  <tt class="py-line">    <tt class="py-comment"># No result.</tt> </tt>
<a name="L688"></a><tt class="py-lineno"> 688</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-478" class="py-name"><a title="pipe_control.results
test_suite.system_tests.results
user_functions.results" class="py-name" href="#" onclick="return doclink('link-478', 'results', 'link-474');">results</a></tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L689"></a><tt class="py-lineno"> 689</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> </tt>
<a name="L690"></a><tt class="py-lineno"> 690</tt>  <tt class="py-line"> </tt>
<a name="L691"></a><tt class="py-lineno"> 691</tt>  <tt class="py-line">    <tt class="py-comment"># Store the data.</tt> </tt>
<a name="L692"></a><tt class="py-lineno"> 692</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-479" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-479', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-480" class="py-name" targets="Function specific_analyses.frame_order.uf.pivot()=specific_analyses.frame_order.uf-module.html#pivot"><a title="specific_analyses.frame_order.uf.pivot" class="py-name" href="#" onclick="return doclink('link-480', 'pivot', 'link-480');">pivot</a></tt> <tt class="py-op">=</tt> <tt id="link-481" class="py-name"><a title="pipe_control.results
test_suite.system_tests.results
user_functions.results" class="py-name" href="#" onclick="return doclink('link-481', 'results', 'link-474');">results</a></tt> </tt>
<a name="L693"></a><tt class="py-lineno"> 693</tt>  <tt class="py-line"> </tt>
<a name="L694"></a><tt class="py-lineno"> 694</tt>  <tt class="py-line">    <tt class="py-comment"># Print out.</tt> </tt>
<a name="L695"></a><tt class="py-lineno"> 695</tt>  <tt class="py-line">    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Motional pivot found at:  %s"</tt> <tt class="py-op">%</tt> <tt id="link-482" class="py-name"><a title="pipe_control.results
test_suite.system_tests.results
user_functions.results" class="py-name" href="#" onclick="return doclink('link-482', 'results', 'link-474');">results</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L696"></a><tt class="py-lineno"> 696</tt>  <tt class="py-line"> </tt>
<a name="L697"></a><tt class="py-lineno"> 697</tt>  <tt class="py-line"> </tt>
<a name="get_pos"></a><div id="get_pos-def"><a name="L698"></a><tt class="py-lineno"> 698</tt> <a class="py-toggle" href="#" id="get_pos-toggle" onclick="return toggle('get_pos');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#get_pos">get_pos</a><tt class="py-op">(</tt><tt class="py-param">spin_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">str_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">ave_pos</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="get_pos-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="get_pos-expanded"><a name="L699"></a><tt class="py-lineno"> 699</tt>  <tt class="py-line">    <tt class="py-docstring">"""Load the spins from the structural object into the relax data store.</tt> </tt>
<a name="L700"></a><tt class="py-lineno"> 700</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L701"></a><tt class="py-lineno"> 701</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword spin_id:           The molecule, residue, and spin identifier string.</tt> </tt>
<a name="L702"></a><tt class="py-lineno"> 702</tt>  <tt class="py-line"><tt class="py-docstring">    @type spin_id:              str</tt> </tt>
<a name="L703"></a><tt class="py-lineno"> 703</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword str_id:            The structure identifier.  This can be the file name, model number, or structure number.</tt> </tt>
<a name="L704"></a><tt class="py-lineno"> 704</tt>  <tt class="py-line"><tt class="py-docstring">    @type str_id:               int or str</tt> </tt>
<a name="L705"></a><tt class="py-lineno"> 705</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword ave_pos:           A flag specifying if the average atom position or the atom position from all loaded structures is loaded into the SpinContainer.</tt> </tt>
<a name="L706"></a><tt class="py-lineno"> 706</tt>  <tt class="py-line"><tt class="py-docstring">    @type ave_pos:              bool</tt> </tt>
<a name="L707"></a><tt class="py-lineno"> 707</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L708"></a><tt class="py-lineno"> 708</tt>  <tt class="py-line"> </tt>
<a name="L709"></a><tt class="py-lineno"> 709</tt>  <tt class="py-line">    <tt class="py-comment"># Checks.</tt> </tt>
<a name="L710"></a><tt class="py-lineno"> 710</tt>  <tt class="py-line">    <tt id="link-483" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-483', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L711"></a><tt class="py-lineno"> 711</tt>  <tt class="py-line">    <tt id="link-484" class="py-name"><a title="pipe_control.structure.checks.check_structure" class="py-name" href="#" onclick="return doclink('link-484', 'check_structure', 'link-105');">check_structure</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L712"></a><tt class="py-lineno"> 712</tt>  <tt class="py-line"> </tt>
<a name="L713"></a><tt class="py-lineno"> 713</tt>  <tt class="py-line">    <tt class="py-comment"># The selection object.</tt> </tt>
<a name="L714"></a><tt class="py-lineno"> 714</tt>  <tt class="py-line">    <tt id="link-485" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-485', 'selection', 'link-36');">selection</a></tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-486" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-486', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-487" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-487', 'selection', 'link-36');">selection</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt id="link-488" class="py-name" targets="Module gui.input_elements.spin_id=gui.input_elements.spin_id-module.html"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-488', 'spin_id', 'link-488');">spin_id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L715"></a><tt class="py-lineno"> 715</tt>  <tt class="py-line"> </tt>
<a name="L716"></a><tt class="py-lineno"> 716</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over all atoms of the spin_id selection.</tt> </tt>
<a name="L717"></a><tt class="py-lineno"> 717</tt>  <tt class="py-line">    <tt id="link-489" class="py-name" targets="Module specific_analyses.frame_order.data=specific_analyses.frame_order.data-module.html,Module specific_analyses.model_free.data=specific_analyses.model_free.data-module.html,Module specific_analyses.n_state_model.data=specific_analyses.n_state_model.data-module.html,Module specific_analyses.relax_disp.data=specific_analyses.relax_disp.data-module.html,Module user_functions.data=user_functions.data-module.html"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-489', 'data', 'link-489');">data</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L718"></a><tt class="py-lineno"> 718</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">,</tt> <tt id="link-490" class="py-name"><a title="lib.periodic_table.element" class="py-name" href="#" onclick="return doclink('link-490', 'element', 'link-122');">element</a></tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-491" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-491', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-492" class="py-name" targets="Method lib.structure.internal.object.Internal.atom_loop()=lib.structure.internal.object.Internal-class.html#atom_loop"><a title="lib.structure.internal.object.Internal.atom_loop" class="py-name" href="#" onclick="return doclink('link-492', 'atom_loop', 'link-492');">atom_loop</a></tt><tt class="py-op">(</tt><tt id="link-493" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-493', 'selection', 'link-36');">selection</a></tt><tt class="py-op">=</tt><tt id="link-494" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-494', 'selection', 'link-36');">selection</a></tt><tt class="py-op">,</tt> <tt class="py-name">str_id</tt><tt class="py-op">=</tt><tt class="py-name">str_id</tt><tt class="py-op">,</tt> <tt class="py-name">mol_name_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">res_num_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">res_name_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">element_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">pos_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">ave</tt><tt class="py-op">=</tt><tt class="py-name">ave_pos</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L719"></a><tt class="py-lineno"> 719</tt>  <tt class="py-line">        <tt class="py-comment"># Remove the '+' regular expression character from the mol, res, and spin names!</tt> </tt>
<a name="L720"></a><tt class="py-lineno"> 720</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">mol_name</tt> <tt class="py-keyword">and</tt> <tt id="link-495" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-495', 'search', 'link-6');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'\+'</tt><tt class="py-op">,</tt> <tt class="py-name">mol_name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L721"></a><tt class="py-lineno"> 721</tt>  <tt class="py-line">            <tt class="py-name">mol_name</tt> <tt class="py-op">=</tt> <tt class="py-name">mol_name</tt><tt class="py-op">.</tt><tt class="py-name">replace</tt><tt class="py-op">(</tt><tt class="py-string">'+'</tt><tt class="py-op">,</tt> <tt class="py-string">''</tt><tt class="py-op">)</tt> </tt>
<a name="L722"></a><tt class="py-lineno"> 722</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">res_name</tt> <tt class="py-keyword">and</tt> <tt id="link-496" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-496', 'search', 'link-6');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'\+'</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L723"></a><tt class="py-lineno"> 723</tt>  <tt class="py-line">            <tt class="py-name">res_name</tt> <tt class="py-op">=</tt> <tt class="py-name">res_name</tt><tt class="py-op">.</tt><tt class="py-name">replace</tt><tt class="py-op">(</tt><tt class="py-string">'+'</tt><tt class="py-op">,</tt> <tt class="py-string">''</tt><tt class="py-op">)</tt> </tt>
<a name="L724"></a><tt class="py-lineno"> 724</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">atom_name</tt> <tt class="py-keyword">and</tt> <tt id="link-497" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-497', 'search', 'link-6');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'\+'</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L725"></a><tt class="py-lineno"> 725</tt>  <tt class="py-line">            <tt class="py-name">atom_name</tt> <tt class="py-op">=</tt> <tt class="py-name">atom_name</tt><tt class="py-op">.</tt><tt class="py-name">replace</tt><tt class="py-op">(</tt><tt class="py-string">'+'</tt><tt class="py-op">,</tt> <tt class="py-string">''</tt><tt class="py-op">)</tt> </tt>
<a name="L726"></a><tt class="py-lineno"> 726</tt>  <tt class="py-line"> </tt>
<a name="L727"></a><tt class="py-lineno"> 727</tt>  <tt class="py-line">        <tt class="py-comment"># The spin identification string.</tt> </tt>
<a name="L728"></a><tt class="py-lineno"> 728</tt>  <tt class="py-line">        <tt class="py-name">id</tt> <tt class="py-op">=</tt> <tt id="link-498" class="py-name"><a title="pipe_control.mol_res_spin.generate_spin_id_unique" class="py-name" href="#" onclick="return doclink('link-498', 'generate_spin_id_unique', 'link-93');">generate_spin_id_unique</a></tt><tt class="py-op">(</tt><tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">spin_num</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">,</tt> <tt class="py-name">spin_name</tt><tt class="py-op">=</tt><tt class="py-name">atom_name</tt><tt class="py-op">)</tt> </tt>
<a name="L729"></a><tt class="py-lineno"> 729</tt>  <tt class="py-line"> </tt>
<a name="L730"></a><tt class="py-lineno"> 730</tt>  <tt class="py-line">        <tt class="py-comment"># Get the spin container.</tt> </tt>
<a name="L731"></a><tt class="py-lineno"> 731</tt>  <tt class="py-line">        <tt class="py-name">spin_cont</tt> <tt class="py-op">=</tt> <tt id="link-499" class="py-name"><a title="pipe_control.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-499', 'return_spin', 'link-95');">return_spin</a></tt><tt class="py-op">(</tt><tt class="py-name">id</tt><tt class="py-op">)</tt> </tt>
<a name="L732"></a><tt class="py-lineno"> 732</tt>  <tt class="py-line"> </tt>
<a name="L733"></a><tt class="py-lineno"> 733</tt>  <tt class="py-line">        <tt class="py-comment"># Skip the spin if it doesn't exist.</tt> </tt>
<a name="L734"></a><tt class="py-lineno"> 734</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">spin_cont</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L735"></a><tt class="py-lineno"> 735</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L736"></a><tt class="py-lineno"> 736</tt>  <tt class="py-line"> </tt>
<a name="L737"></a><tt class="py-lineno"> 737</tt>  <tt class="py-line">        <tt class="py-comment"># Add the position vector to the spin container.</tt> </tt>
<a name="L738"></a><tt class="py-lineno"> 738</tt>  <tt class="py-line">        <tt class="py-name">spin_cont</tt><tt class="py-op">.</tt><tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt class="py-name">pos</tt> </tt>
<a name="L739"></a><tt class="py-lineno"> 739</tt>  <tt class="py-line"> </tt>
<a name="L740"></a><tt class="py-lineno"> 740</tt>  <tt class="py-line">        <tt class="py-comment"># Store the data for a printout at the end.</tt> </tt>
<a name="L741"></a><tt class="py-lineno"> 741</tt>  <tt class="py-line">        <tt id="link-500" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-500', 'data', 'link-489');">data</a></tt><tt class="py-op">.</tt><tt id="link-501" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-501', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-name">id</tt><tt class="py-op">,</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">pos</tt><tt class="py-op">)</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L742"></a><tt class="py-lineno"> 742</tt>  <tt class="py-line"> </tt>
<a name="L743"></a><tt class="py-lineno"> 743</tt>  <tt class="py-line">    <tt class="py-comment"># No positions found.</tt> </tt>
<a name="L744"></a><tt class="py-lineno"> 744</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-502" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-502', 'data', 'link-489');">data</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L745"></a><tt class="py-lineno"> 745</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-503" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-503', 'RelaxError', 'link-20');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"No positional information matching the spin ID '%s' could be found."</tt> <tt class="py-op">%</tt> <tt id="link-504" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-504', 'spin_id', 'link-488');">spin_id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L746"></a><tt class="py-lineno"> 746</tt>  <tt class="py-line"> </tt>
<a name="L747"></a><tt class="py-lineno"> 747</tt>  <tt class="py-line">    <tt class="py-comment"># Update pseudo-atoms.</tt> </tt>
<a name="L748"></a><tt class="py-lineno"> 748</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-505" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-505', 'spin', 'link-427');">spin</a></tt> <tt class="py-keyword">in</tt> <tt id="link-506" class="py-name"><a title="pipe_control.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-506', 'spin_loop', 'link-96');">spin_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L749"></a><tt class="py-lineno"> 749</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-507" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-507', 'spin', 'link-427');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'members'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L750"></a><tt class="py-lineno"> 750</tt>  <tt class="py-line">            <tt class="py-comment"># Get the spin positions.</tt> </tt>
<a name="L751"></a><tt class="py-lineno"> 751</tt>  <tt class="py-line">            <tt class="py-name">positions</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L752"></a><tt class="py-lineno"> 752</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-508" class="py-name" targets="Function lib.structure.pdb_read.atom()=lib.structure.pdb_read-module.html#atom,Function lib.structure.pdb_write.atom()=lib.structure.pdb_write-module.html#atom"><a title="lib.structure.pdb_read.atom
lib.structure.pdb_write.atom" class="py-name" href="#" onclick="return doclink('link-508', 'atom', 'link-508');">atom</a></tt> <tt class="py-keyword">in</tt> <tt id="link-509" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-509', 'spin', 'link-427');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">members</tt><tt class="py-op">:</tt> </tt>
<a name="L753"></a><tt class="py-lineno"> 753</tt>  <tt class="py-line">                <tt class="py-comment"># Get the spin container.</tt> </tt>
<a name="L754"></a><tt class="py-lineno"> 754</tt>  <tt class="py-line">                <tt class="py-name">subspin</tt> <tt class="py-op">=</tt> <tt id="link-510" class="py-name"><a title="pipe_control.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-510', 'return_spin', 'link-95');">return_spin</a></tt><tt class="py-op">(</tt><tt id="link-511" class="py-name"><a title="lib.structure.pdb_read.atom
lib.structure.pdb_write.atom" class="py-name" href="#" onclick="return doclink('link-511', 'atom', 'link-508');">atom</a></tt><tt class="py-op">)</tt> </tt>
<a name="L755"></a><tt class="py-lineno"> 755</tt>  <tt class="py-line"> </tt>
<a name="L756"></a><tt class="py-lineno"> 756</tt>  <tt class="py-line">                <tt class="py-comment"># Test that the spin exists.</tt> </tt>
<a name="L757"></a><tt class="py-lineno"> 757</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">subspin</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L758"></a><tt class="py-lineno"> 758</tt>  <tt class="py-line">                    <tt class="py-keyword">raise</tt> <tt id="link-512" class="py-name" targets="Class lib.errors.RelaxNoSpinError=lib.errors.RelaxNoSpinError-class.html"><a title="lib.errors.RelaxNoSpinError" class="py-name" href="#" onclick="return doclink('link-512', 'RelaxNoSpinError', 'link-512');">RelaxNoSpinError</a></tt><tt class="py-op">(</tt><tt id="link-513" class="py-name"><a title="lib.structure.pdb_read.atom
lib.structure.pdb_write.atom" class="py-name" href="#" onclick="return doclink('link-513', 'atom', 'link-508');">atom</a></tt><tt class="py-op">)</tt> </tt>
<a name="L759"></a><tt class="py-lineno"> 759</tt>  <tt class="py-line"> </tt>
<a name="L760"></a><tt class="py-lineno"> 760</tt>  <tt class="py-line">                <tt class="py-comment"># Test the position.</tt> </tt>
<a name="L761"></a><tt class="py-lineno"> 761</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">subspin</tt><tt class="py-op">,</tt> <tt class="py-string">'pos'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-name">subspin</tt><tt class="py-op">.</tt><tt class="py-name">pos</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">subspin</tt><tt class="py-op">.</tt><tt class="py-name">pos</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L762"></a><tt class="py-lineno"> 762</tt>  <tt class="py-line">                    <tt class="py-keyword">raise</tt> <tt id="link-514" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-514', 'RelaxError', 'link-20');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Positional information is not available for the atom '%s'."</tt> <tt class="py-op">%</tt> <tt id="link-515" class="py-name"><a title="lib.structure.pdb_read.atom
lib.structure.pdb_write.atom" class="py-name" href="#" onclick="return doclink('link-515', 'atom', 'link-508');">atom</a></tt><tt class="py-op">)</tt> </tt>
<a name="L763"></a><tt class="py-lineno"> 763</tt>  <tt class="py-line"> </tt>
<a name="L764"></a><tt class="py-lineno"> 764</tt>  <tt class="py-line">                <tt class="py-comment"># Alias the position.</tt> </tt>
<a name="L765"></a><tt class="py-lineno"> 765</tt>  <tt class="py-line">                <tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt class="py-name">subspin</tt><tt class="py-op">.</tt><tt class="py-name">pos</tt> </tt>
<a name="L766"></a><tt class="py-lineno"> 766</tt>  <tt class="py-line"> </tt>
<a name="L767"></a><tt class="py-lineno"> 767</tt>  <tt class="py-line">                <tt class="py-comment"># Convert to a list of lists if not already.</tt> </tt>
<a name="L768"></a><tt class="py-lineno"> 768</tt>  <tt class="py-line">                <tt id="link-516" class="py-name" targets="Method auto_analyses.dauvergne_protocol.dAuvergne_protocol.multi_model()=auto_analyses.dauvergne_protocol.dAuvergne_protocol-class.html#multi_model"><a title="auto_analyses.dauvergne_protocol.dAuvergne_protocol.multi_model" class="py-name" href="#" onclick="return doclink('link-516', 'multi_model', 'link-516');">multi_model</a></tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L769"></a><tt class="py-lineno"> 769</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt id="link-517" class="py-name"><a title="info.Bieri11.type
info.Clore90.type
info.Delaglio95.type
info.GoddardKneller.type
info.LipariSzabo82a.type
info.LipariSzabo82b.type
info.Ref.type
info.dAuvergne06.type
info.dAuvergneGooley03.type
info.dAuvergneGooley06.type
info.dAuvergneGooley07.type
info.dAuvergneGooley08a.type
info.dAuvergneGooley08b.type
pipe_control.relax_data.type
specific_analyses.parameter_object.Param_list.type" class="py-name" href="#" onclick="return doclink('link-517', 'type', 'link-321');">type</a></tt><tt class="py-op">(</tt><tt class="py-name">pos</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt id="link-518" class="py-name" targets="Module lib.float=lib.float-module.html"><a title="lib.float" class="py-name" href="#" onclick="return doclink('link-518', 'float', 'link-518');">float</a></tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L770"></a><tt class="py-lineno"> 770</tt>  <tt class="py-line">                    <tt id="link-519" class="py-name"><a title="auto_analyses.dauvergne_protocol.dAuvergne_protocol.multi_model" class="py-name" href="#" onclick="return doclink('link-519', 'multi_model', 'link-516');">multi_model</a></tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L771"></a><tt class="py-lineno"> 771</tt>  <tt class="py-line">                    <tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-name">pos</tt><tt class="py-op">]</tt> </tt>
<a name="L772"></a><tt class="py-lineno"> 772</tt>  <tt class="py-line"> </tt>
<a name="L773"></a><tt class="py-lineno"> 773</tt>  <tt class="py-line">                <tt class="py-comment"># Store the position.</tt> </tt>
<a name="L774"></a><tt class="py-lineno"> 774</tt>  <tt class="py-line">                <tt class="py-name">positions</tt><tt class="py-op">.</tt><tt id="link-520" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-520', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L775"></a><tt class="py-lineno"> 775</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt id="link-521" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-521', 'i', 'link-160');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">pos</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L776"></a><tt class="py-lineno"> 776</tt>  <tt class="py-line">                    <tt class="py-name">positions</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-522" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-522', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">pos</tt><tt class="py-op">[</tt><tt id="link-523" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-523', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">tolist</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L777"></a><tt class="py-lineno"> 777</tt>  <tt class="py-line"> </tt>
<a name="L778"></a><tt class="py-lineno"> 778</tt>  <tt class="py-line">            <tt class="py-comment"># The averaging.</tt> </tt>
<a name="L779"></a><tt class="py-lineno"> 779</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-524" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-524', 'spin', 'link-427');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">averaging</tt> <tt class="py-op">==</tt> <tt class="py-string">'linear'</tt><tt class="py-op">:</tt> </tt>
<a name="L780"></a><tt class="py-lineno"> 780</tt>  <tt class="py-line">                <tt class="py-comment"># Average pos.</tt> </tt>
<a name="L781"></a><tt class="py-lineno"> 781</tt>  <tt class="py-line">                <tt class="py-name">ave</tt> <tt class="py-op">=</tt> <tt id="link-525" class="py-name"><a title="pipe_control.mol_res_spin.linear_ave" class="py-name" href="#" onclick="return doclink('link-525', 'linear_ave', 'link-94');">linear_ave</a></tt><tt class="py-op">(</tt><tt class="py-name">positions</tt><tt class="py-op">)</tt> </tt>
<a name="L782"></a><tt class="py-lineno"> 782</tt>  <tt class="py-line"> </tt>
<a name="L783"></a><tt class="py-lineno"> 783</tt>  <tt class="py-line">                <tt class="py-comment"># Convert to the correct structure.</tt> </tt>
<a name="L784"></a><tt class="py-lineno"> 784</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt id="link-526" class="py-name"><a title="auto_analyses.dauvergne_protocol.dAuvergne_protocol.multi_model" class="py-name" href="#" onclick="return doclink('link-526', 'multi_model', 'link-516');">multi_model</a></tt><tt class="py-op">:</tt> </tt>
<a name="L785"></a><tt class="py-lineno"> 785</tt>  <tt class="py-line">                    <tt id="link-527" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-527', 'spin', 'link-427');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt class="py-name">ave</tt> </tt>
<a name="L786"></a><tt class="py-lineno"> 786</tt>  <tt class="py-line">                <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L787"></a><tt class="py-lineno"> 787</tt>  <tt class="py-line">                    <tt id="link-528" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-528', 'spin', 'link-427');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt class="py-name">ave</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L788"></a><tt class="py-lineno"> 788</tt>  <tt class="py-line"> </tt>
<a name="L789"></a><tt class="py-lineno"> 789</tt>  <tt class="py-line">    <tt class="py-comment"># Print out.</tt> </tt>
<a name="L790"></a><tt class="py-lineno"> 790</tt>  <tt class="py-line">    <tt id="link-529" class="py-name"><a title="lib.io.write_data
pipe_control.value.write_data" class="py-name" href="#" onclick="return doclink('link-529', 'write_data', 'link-30');">write_data</a></tt><tt class="py-op">(</tt><tt class="py-name">out</tt><tt class="py-op">=</tt><tt class="py-name">sys</tt><tt class="py-op">.</tt><tt class="py-name">stdout</tt><tt class="py-op">,</tt> <tt class="py-name">headings</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt class="py-string">"Spin_ID"</tt><tt class="py-op">,</tt> <tt class="py-string">"Position"</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt id="link-530" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-530', 'data', 'link-489');">data</a></tt><tt class="py-op">=</tt><tt id="link-531" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-531', 'data', 'link-489');">data</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L791"></a><tt class="py-lineno"> 791</tt>  <tt class="py-line"> </tt>
<a name="L792"></a><tt class="py-lineno"> 792</tt>  <tt class="py-line"> </tt>
<a name="load_spins"></a><div id="load_spins-def"><a name="L793"></a><tt class="py-lineno"> 793</tt> <a class="py-toggle" href="#" id="load_spins-toggle" onclick="return toggle('load_spins');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#load_spins">load_spins</a><tt class="py-op">(</tt><tt class="py-param">spin_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">str_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">from_mols</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">mol_name_target</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">ave_pos</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="load_spins-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="load_spins-expanded"><a name="L794"></a><tt class="py-lineno"> 794</tt>  <tt class="py-line">    <tt class="py-docstring">"""Load the spins from the structural object into the relax data store.</tt> </tt>
<a name="L795"></a><tt class="py-lineno"> 795</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L796"></a><tt class="py-lineno"> 796</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword spin_id:           The molecule, residue, and spin identifier string.</tt> </tt>
<a name="L797"></a><tt class="py-lineno"> 797</tt>  <tt class="py-line"><tt class="py-docstring">    @type spin_id:              str</tt> </tt>
<a name="L798"></a><tt class="py-lineno"> 798</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword str_id:            The structure identifier.  This can be the file name, model number, or structure number.</tt> </tt>
<a name="L799"></a><tt class="py-lineno"> 799</tt>  <tt class="py-line"><tt class="py-docstring">    @type str_id:               int or str</tt> </tt>
<a name="L800"></a><tt class="py-lineno"> 800</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword from_mols:         The list of similar, but not necessarily identical molecules to load spin information from.</tt> </tt>
<a name="L801"></a><tt class="py-lineno"> 801</tt>  <tt class="py-line"><tt class="py-docstring">    @type from_mols:            list of str or None</tt> </tt>
<a name="L802"></a><tt class="py-lineno"> 802</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword mol_name_target:   The name of target molecule container, overriding the name of the loaded structures</tt> </tt>
<a name="L803"></a><tt class="py-lineno"> 803</tt>  <tt class="py-line"><tt class="py-docstring">    @type mol_name_target:      str or None</tt> </tt>
<a name="L804"></a><tt class="py-lineno"> 804</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword ave_pos:           A flag specifying if the average atom position or the atom position from all loaded structures is loaded into the SpinContainer.</tt> </tt>
<a name="L805"></a><tt class="py-lineno"> 805</tt>  <tt class="py-line"><tt class="py-docstring">    @type ave_pos:              bool</tt> </tt>
<a name="L806"></a><tt class="py-lineno"> 806</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L807"></a><tt class="py-lineno"> 807</tt>  <tt class="py-line"> </tt>
<a name="L808"></a><tt class="py-lineno"> 808</tt>  <tt class="py-line">    <tt class="py-comment"># The multi-molecule case.</tt> </tt>
<a name="L809"></a><tt class="py-lineno"> 809</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">from_mols</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L810"></a><tt class="py-lineno"> 810</tt>  <tt class="py-line">        <tt id="link-532" class="py-name" targets="Function pipe_control.structure.main.load_spins_multi_mol()=pipe_control.structure.main-module.html#load_spins_multi_mol"><a title="pipe_control.structure.main.load_spins_multi_mol" class="py-name" href="#" onclick="return doclink('link-532', 'load_spins_multi_mol', 'link-532');">load_spins_multi_mol</a></tt><tt class="py-op">(</tt><tt id="link-533" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-533', 'spin_id', 'link-488');">spin_id</a></tt><tt class="py-op">=</tt><tt id="link-534" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-534', 'spin_id', 'link-488');">spin_id</a></tt><tt class="py-op">,</tt> <tt class="py-name">str_id</tt><tt class="py-op">=</tt><tt class="py-name">str_id</tt><tt class="py-op">,</tt> <tt class="py-name">from_mols</tt><tt class="py-op">=</tt><tt class="py-name">from_mols</tt><tt class="py-op">,</tt> <tt class="py-name">mol_name_target</tt><tt class="py-op">=</tt><tt class="py-name">mol_name_target</tt><tt class="py-op">,</tt> <tt class="py-name">ave_pos</tt><tt class="py-op">=</tt><tt class="py-name">ave_pos</tt><tt class="py-op">)</tt> </tt>
<a name="L811"></a><tt class="py-lineno"> 811</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> </tt>
<a name="L812"></a><tt class="py-lineno"> 812</tt>  <tt class="py-line"> </tt>
<a name="L813"></a><tt class="py-lineno"> 813</tt>  <tt class="py-line">    <tt class="py-comment"># Checks.</tt> </tt>
<a name="L814"></a><tt class="py-lineno"> 814</tt>  <tt class="py-line">    <tt id="link-535" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-535', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L815"></a><tt class="py-lineno"> 815</tt>  <tt class="py-line">    <tt id="link-536" class="py-name"><a title="pipe_control.structure.checks.check_structure" class="py-name" href="#" onclick="return doclink('link-536', 'check_structure', 'link-105');">check_structure</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L816"></a><tt class="py-lineno"> 816</tt>  <tt class="py-line"> </tt>
<a name="L817"></a><tt class="py-lineno"> 817</tt>  <tt class="py-line">    <tt class="py-comment"># Print out.</tt> </tt>
<a name="L818"></a><tt class="py-lineno"> 818</tt>  <tt class="py-line">    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Adding the following spins to the relax data store.\n"</tt><tt class="py-op">)</tt> </tt>
<a name="L819"></a><tt class="py-lineno"> 819</tt>  <tt class="py-line"> </tt>
<a name="L820"></a><tt class="py-lineno"> 820</tt>  <tt class="py-line">    <tt class="py-comment"># Init the data for printing out.</tt> </tt>
<a name="L821"></a><tt class="py-lineno"> 821</tt>  <tt class="py-line">    <tt class="py-name">mol_names</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L822"></a><tt class="py-lineno"> 822</tt>  <tt class="py-line">    <tt class="py-name">res_nums</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L823"></a><tt class="py-lineno"> 823</tt>  <tt class="py-line">    <tt class="py-name">res_names</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L824"></a><tt class="py-lineno"> 824</tt>  <tt class="py-line">    <tt class="py-name">spin_nums</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L825"></a><tt class="py-lineno"> 825</tt>  <tt class="py-line">    <tt class="py-name">spin_names</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L826"></a><tt class="py-lineno"> 826</tt>  <tt class="py-line"> </tt>
<a name="L827"></a><tt class="py-lineno"> 827</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over all atoms of the spin_id selection.</tt> </tt>
<a name="L828"></a><tt class="py-lineno"> 828</tt>  <tt class="py-line">    <tt id="link-537" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-537', 'selection', 'link-36');">selection</a></tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-538" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-538', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-539" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-539', 'selection', 'link-36');">selection</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt id="link-540" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-540', 'spin_id', 'link-488');">spin_id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L829"></a><tt class="py-lineno"> 829</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">,</tt> <tt id="link-541" class="py-name"><a title="lib.periodic_table.element" class="py-name" href="#" onclick="return doclink('link-541', 'element', 'link-122');">element</a></tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-542" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-542', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-543" class="py-name"><a title="lib.structure.internal.object.Internal.atom_loop" class="py-name" href="#" onclick="return doclink('link-543', 'atom_loop', 'link-492');">atom_loop</a></tt><tt class="py-op">(</tt><tt id="link-544" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-544', 'selection', 'link-36');">selection</a></tt><tt class="py-op">=</tt><tt id="link-545" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-545', 'selection', 'link-36');">selection</a></tt><tt class="py-op">,</tt> <tt class="py-name">str_id</tt><tt class="py-op">=</tt><tt class="py-name">str_id</tt><tt class="py-op">,</tt> <tt class="py-name">mol_name_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">res_num_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">res_name_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">element_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">pos_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">ave</tt><tt class="py-op">=</tt><tt class="py-name">ave_pos</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L830"></a><tt class="py-lineno"> 830</tt>  <tt class="py-line">        <tt class="py-comment"># Override the molecule name.</tt> </tt>
<a name="L831"></a><tt class="py-lineno"> 831</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">mol_name_target</tt><tt class="py-op">:</tt> </tt>
<a name="L832"></a><tt class="py-lineno"> 832</tt>  <tt class="py-line">            <tt class="py-name">mol_name</tt> <tt class="py-op">=</tt> <tt class="py-name">mol_name_target</tt> </tt>
<a name="L833"></a><tt class="py-lineno"> 833</tt>  <tt class="py-line"> </tt>
<a name="L834"></a><tt class="py-lineno"> 834</tt>  <tt class="py-line">        <tt class="py-comment"># Remove the '+' regular expression character from the mol, res, and spin names!</tt> </tt>
<a name="L835"></a><tt class="py-lineno"> 835</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">mol_name</tt> <tt class="py-keyword">and</tt> <tt id="link-546" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-546', 'search', 'link-6');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'\+'</tt><tt class="py-op">,</tt> <tt class="py-name">mol_name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L836"></a><tt class="py-lineno"> 836</tt>  <tt class="py-line">            <tt class="py-name">mol_name</tt> <tt class="py-op">=</tt> <tt class="py-name">mol_name</tt><tt class="py-op">.</tt><tt class="py-name">replace</tt><tt class="py-op">(</tt><tt class="py-string">'+'</tt><tt class="py-op">,</tt> <tt class="py-string">''</tt><tt class="py-op">)</tt> </tt>
<a name="L837"></a><tt class="py-lineno"> 837</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">res_name</tt> <tt class="py-keyword">and</tt> <tt id="link-547" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-547', 'search', 'link-6');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'\+'</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L838"></a><tt class="py-lineno"> 838</tt>  <tt class="py-line">            <tt class="py-name">res_name</tt> <tt class="py-op">=</tt> <tt class="py-name">res_name</tt><tt class="py-op">.</tt><tt class="py-name">replace</tt><tt class="py-op">(</tt><tt class="py-string">'+'</tt><tt class="py-op">,</tt> <tt class="py-string">''</tt><tt class="py-op">)</tt> </tt>
<a name="L839"></a><tt class="py-lineno"> 839</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">atom_name</tt> <tt class="py-keyword">and</tt> <tt id="link-548" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-548', 'search', 'link-6');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'\+'</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L840"></a><tt class="py-lineno"> 840</tt>  <tt class="py-line">            <tt class="py-name">atom_name</tt> <tt class="py-op">=</tt> <tt class="py-name">atom_name</tt><tt class="py-op">.</tt><tt class="py-name">replace</tt><tt class="py-op">(</tt><tt class="py-string">'+'</tt><tt class="py-op">,</tt> <tt class="py-string">''</tt><tt class="py-op">)</tt> </tt>
<a name="L841"></a><tt class="py-lineno"> 841</tt>  <tt class="py-line"> </tt>
<a name="L842"></a><tt class="py-lineno"> 842</tt>  <tt class="py-line">        <tt class="py-comment"># Generate a spin ID for the current atom.</tt> </tt>
<a name="L843"></a><tt class="py-lineno"> 843</tt>  <tt class="py-line">        <tt class="py-name">id</tt> <tt class="py-op">=</tt> <tt id="link-549" class="py-name"><a title="pipe_control.mol_res_spin.generate_spin_id_unique" class="py-name" href="#" onclick="return doclink('link-549', 'generate_spin_id_unique', 'link-93');">generate_spin_id_unique</a></tt><tt class="py-op">(</tt><tt class="py-name">mol_name</tt><tt class="py-op">=</tt><tt class="py-name">mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">res_name</tt><tt class="py-op">,</tt> <tt class="py-name">spin_num</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">,</tt> <tt class="py-name">spin_name</tt><tt class="py-op">=</tt><tt class="py-name">atom_name</tt><tt class="py-op">)</tt> </tt>
<a name="L844"></a><tt class="py-lineno"> 844</tt>  <tt class="py-line"> </tt>
<a name="L845"></a><tt class="py-lineno"> 845</tt>  <tt class="py-line">        <tt class="py-comment"># Create the spin.</tt> </tt>
<a name="L846"></a><tt class="py-lineno"> 846</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L847"></a><tt class="py-lineno"> 847</tt>  <tt class="py-line">            <tt class="py-name">spin_cont</tt> <tt class="py-op">=</tt> <tt id="link-550" class="py-name"><a title="pipe_control.mol_res_spin.create_spin" class="py-name" href="#" onclick="return doclink('link-550', 'create_spin', 'link-92');">create_spin</a></tt><tt class="py-op">(</tt><tt class="py-name">mol_name</tt><tt class="py-op">=</tt><tt class="py-name">mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">res_name</tt><tt class="py-op">,</tt> <tt class="py-name">spin_num</tt><tt class="py-op">=</tt><tt class="py-name">atom_num</tt><tt class="py-op">,</tt> <tt class="py-name">spin_name</tt><tt class="py-op">=</tt><tt class="py-name">atom_name</tt><tt class="py-op">)</tt> </tt>
<a name="L848"></a><tt class="py-lineno"> 848</tt>  <tt class="py-line"> </tt>
<a name="L849"></a><tt class="py-lineno"> 849</tt>  <tt class="py-line">        <tt class="py-comment"># Otherwise, get the spin container.</tt> </tt>
<a name="L850"></a><tt class="py-lineno"> 850</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt id="link-551" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-551', 'RelaxError', 'link-20');">RelaxError</a></tt><tt class="py-op">:</tt> </tt>
<a name="L851"></a><tt class="py-lineno"> 851</tt>  <tt class="py-line">            <tt class="py-name">spin_cont</tt> <tt class="py-op">=</tt> <tt id="link-552" class="py-name"><a title="pipe_control.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-552', 'return_spin', 'link-95');">return_spin</a></tt><tt class="py-op">(</tt><tt class="py-name">id</tt><tt class="py-op">)</tt> </tt>
<a name="L852"></a><tt class="py-lineno"> 852</tt>  <tt class="py-line"> </tt>
<a name="L853"></a><tt class="py-lineno"> 853</tt>  <tt class="py-line">        <tt class="py-comment"># Append all the spin ID info for printing later.</tt> </tt>
<a name="L854"></a><tt class="py-lineno"> 854</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">mol_name_target</tt><tt class="py-op">:</tt> </tt>
<a name="L855"></a><tt class="py-lineno"> 855</tt>  <tt class="py-line">            <tt class="py-name">mol_names</tt><tt class="py-op">.</tt><tt id="link-553" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-553', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">mol_name_target</tt><tt class="py-op">)</tt> </tt>
<a name="L856"></a><tt class="py-lineno"> 856</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L857"></a><tt class="py-lineno"> 857</tt>  <tt class="py-line">            <tt class="py-name">mol_names</tt><tt class="py-op">.</tt><tt id="link-554" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-554', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">mol_name</tt><tt class="py-op">)</tt> </tt>
<a name="L858"></a><tt class="py-lineno"> 858</tt>  <tt class="py-line">        <tt class="py-name">res_nums</tt><tt class="py-op">.</tt><tt id="link-555" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-555', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">res_num</tt><tt class="py-op">)</tt> </tt>
<a name="L859"></a><tt class="py-lineno"> 859</tt>  <tt class="py-line">        <tt class="py-name">res_names</tt><tt class="py-op">.</tt><tt id="link-556" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-556', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">res_name</tt><tt class="py-op">)</tt> </tt>
<a name="L860"></a><tt class="py-lineno"> 860</tt>  <tt class="py-line">        <tt class="py-name">spin_nums</tt><tt class="py-op">.</tt><tt id="link-557" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-557', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_num</tt><tt class="py-op">)</tt> </tt>
<a name="L861"></a><tt class="py-lineno"> 861</tt>  <tt class="py-line">        <tt class="py-name">spin_names</tt><tt class="py-op">.</tt><tt id="link-558" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-558', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_name</tt><tt class="py-op">)</tt> </tt>
<a name="L862"></a><tt class="py-lineno"> 862</tt>  <tt class="py-line"> </tt>
<a name="L863"></a><tt class="py-lineno"> 863</tt>  <tt class="py-line">        <tt class="py-comment"># Position vector.</tt> </tt>
<a name="L864"></a><tt class="py-lineno"> 864</tt>  <tt class="py-line">        <tt class="py-name">spin_cont</tt><tt class="py-op">.</tt><tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt class="py-name">pos</tt> </tt>
<a name="L865"></a><tt class="py-lineno"> 865</tt>  <tt class="py-line"> </tt>
<a name="L866"></a><tt class="py-lineno"> 866</tt>  <tt class="py-line">        <tt class="py-comment"># Add the element.</tt> </tt>
<a name="L867"></a><tt class="py-lineno"> 867</tt>  <tt class="py-line">        <tt class="py-name">spin_cont</tt><tt class="py-op">.</tt><tt id="link-559" class="py-name"><a title="lib.periodic_table.element" class="py-name" href="#" onclick="return doclink('link-559', 'element', 'link-122');">element</a></tt> <tt class="py-op">=</tt> <tt id="link-560" class="py-name"><a title="lib.periodic_table.element" class="py-name" href="#" onclick="return doclink('link-560', 'element', 'link-122');">element</a></tt> </tt>
<a name="L868"></a><tt class="py-lineno"> 868</tt>  <tt class="py-line"> </tt>
<a name="L869"></a><tt class="py-lineno"> 869</tt>  <tt class="py-line">    <tt class="py-comment"># Catch no data.</tt> </tt>
<a name="L870"></a><tt class="py-lineno"> 870</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">mol_names</tt><tt class="py-op">)</tt> <tt class="py-op">==</tt> <tt class="py-number">0</tt><tt class="py-op">:</tt> </tt>
<a name="L871"></a><tt class="py-lineno"> 871</tt>  <tt class="py-line">        <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-561" class="py-name"><a title="lib.warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-561', 'RelaxWarning', 'link-80');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"No spins matching the '%s' ID string could be found."</tt> <tt class="py-op">%</tt> <tt id="link-562" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-562', 'spin_id', 'link-488');">spin_id</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L872"></a><tt class="py-lineno"> 872</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> </tt>
<a name="L873"></a><tt class="py-lineno"> 873</tt>  <tt class="py-line"> </tt>
<a name="L874"></a><tt class="py-lineno"> 874</tt>  <tt class="py-line">    <tt class="py-comment"># Print out.</tt> </tt>
<a name="L875"></a><tt class="py-lineno"> 875</tt>  <tt class="py-line">    <tt id="link-563" class="py-name"><a title="lib.sequence.write_spin_data" class="py-name" href="#" onclick="return doclink('link-563', 'write_spin_data', 'link-40');">write_spin_data</a></tt><tt class="py-op">(</tt><tt id="link-564" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-564', 'file', 'link-266');">file</a></tt><tt class="py-op">=</tt><tt class="py-name">sys</tt><tt class="py-op">.</tt><tt class="py-name">stdout</tt><tt class="py-op">,</tt> <tt class="py-name">mol_names</tt><tt class="py-op">=</tt><tt class="py-name">mol_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_nums</tt><tt class="py-op">=</tt><tt class="py-name">res_nums</tt><tt class="py-op">,</tt> <tt class="py-name">res_names</tt><tt class="py-op">=</tt><tt class="py-name">res_names</tt><tt class="py-op">,</tt> <tt class="py-name">spin_nums</tt><tt class="py-op">=</tt><tt class="py-name">spin_nums</tt><tt class="py-op">,</tt> <tt class="py-name">spin_names</tt><tt class="py-op">=</tt><tt class="py-name">spin_names</tt><tt class="py-op">)</tt> </tt>
<a name="L876"></a><tt class="py-lineno"> 876</tt>  <tt class="py-line"> </tt>
<a name="L877"></a><tt class="py-lineno"> 877</tt>  <tt class="py-line">    <tt class="py-comment"># Set the number of states for use in the specific analyses.</tt> </tt>
<a name="L878"></a><tt class="py-lineno"> 878</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">N</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-565" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-565', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-566" class="py-name" targets="Method lib.structure.internal.object.Internal.num_models()=lib.structure.internal.object.Internal-class.html#num_models"><a title="lib.structure.internal.object.Internal.num_models" class="py-name" href="#" onclick="return doclink('link-566', 'num_models', 'link-566');">num_models</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
</div><a name="L879"></a><tt class="py-lineno"> 879</tt>  <tt class="py-line"> </tt>
<a name="L880"></a><tt class="py-lineno"> 880</tt>  <tt class="py-line"> </tt>
<a name="load_spins_multi_mol"></a><div id="load_spins_multi_mol-def"><a name="L881"></a><tt class="py-lineno"> 881</tt> <a class="py-toggle" href="#" id="load_spins_multi_mol-toggle" onclick="return toggle('load_spins_multi_mol');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#load_spins_multi_mol">load_spins_multi_mol</a><tt class="py-op">(</tt><tt class="py-param">spin_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">str_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">from_mols</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">mol_name_target</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">ave_pos</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="load_spins_multi_mol-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="load_spins_multi_mol-expanded"><a name="L882"></a><tt class="py-lineno"> 882</tt>  <tt class="py-line">    <tt class="py-docstring">"""Load the spins from the structural object into the relax data store.</tt> </tt>
<a name="L883"></a><tt class="py-lineno"> 883</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L884"></a><tt class="py-lineno"> 884</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword spin_id:           The molecule, residue, and spin identifier string.</tt> </tt>
<a name="L885"></a><tt class="py-lineno"> 885</tt>  <tt class="py-line"><tt class="py-docstring">    @type spin_id:              str</tt> </tt>
<a name="L886"></a><tt class="py-lineno"> 886</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword str_id:            The structure identifier.  This can be the file name, model number, or structure number.</tt> </tt>
<a name="L887"></a><tt class="py-lineno"> 887</tt>  <tt class="py-line"><tt class="py-docstring">    @type str_id:               int or str</tt> </tt>
<a name="L888"></a><tt class="py-lineno"> 888</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword from_mols:         The list of similar, but not necessarily identical molecules to load spin information from.</tt> </tt>
<a name="L889"></a><tt class="py-lineno"> 889</tt>  <tt class="py-line"><tt class="py-docstring">    @type from_mols:            list of str or None</tt> </tt>
<a name="L890"></a><tt class="py-lineno"> 890</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword mol_name_target:   The name of target molecule container, overriding the name of the loaded structures</tt> </tt>
<a name="L891"></a><tt class="py-lineno"> 891</tt>  <tt class="py-line"><tt class="py-docstring">    @type mol_name_target:      str or None</tt> </tt>
<a name="L892"></a><tt class="py-lineno"> 892</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword ave_pos:           A flag specifying if the average atom position or the atom position from all loaded structures is loaded into the SpinContainer.</tt> </tt>
<a name="L893"></a><tt class="py-lineno"> 893</tt>  <tt class="py-line"><tt class="py-docstring">    @type ave_pos:              bool</tt> </tt>
<a name="L894"></a><tt class="py-lineno"> 894</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L895"></a><tt class="py-lineno"> 895</tt>  <tt class="py-line"> </tt>
<a name="L896"></a><tt class="py-lineno"> 896</tt>  <tt class="py-line">    <tt class="py-comment"># Checks.</tt> </tt>
<a name="L897"></a><tt class="py-lineno"> 897</tt>  <tt class="py-line">    <tt id="link-567" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-567', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L898"></a><tt class="py-lineno"> 898</tt>  <tt class="py-line">    <tt id="link-568" class="py-name"><a title="pipe_control.structure.checks.check_structure" class="py-name" href="#" onclick="return doclink('link-568', 'check_structure', 'link-105');">check_structure</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L899"></a><tt class="py-lineno"> 899</tt>  <tt class="py-line"> </tt>
<a name="L900"></a><tt class="py-lineno"> 900</tt>  <tt class="py-line">    <tt class="py-comment"># The target molecule name must be supplied.</tt> </tt>
<a name="L901"></a><tt class="py-lineno"> 901</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">mol_name_target</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L902"></a><tt class="py-lineno"> 902</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-569" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-569', 'RelaxError', 'link-20');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The target molecule name must be supplied when specifying multiple molecules to load spins from."</tt><tt class="py-op">)</tt> </tt>
<a name="L903"></a><tt class="py-lineno"> 903</tt>  <tt class="py-line"> </tt>
<a name="L904"></a><tt class="py-lineno"> 904</tt>  <tt class="py-line">    <tt class="py-comment"># Disallow multiple structural models.</tt> </tt>
<a name="L905"></a><tt class="py-lineno"> 905</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-570" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-570', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-571" class="py-name"><a title="lib.structure.internal.object.Internal.num_models" class="py-name" href="#" onclick="return doclink('link-571', 'num_models', 'link-566');">num_models</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-op">!=</tt> <tt class="py-number">1</tt><tt class="py-op">:</tt> </tt>
<a name="L906"></a><tt class="py-lineno"> 906</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-572" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-572', 'RelaxError', 'link-20');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Only a single structural model is allowed when specifying multiple molecules to load spins from."</tt><tt class="py-op">)</tt> </tt>
<a name="L907"></a><tt class="py-lineno"> 907</tt>  <tt class="py-line"> </tt>
<a name="L908"></a><tt class="py-lineno"> 908</tt>  <tt class="py-line">    <tt class="py-comment"># Split up the selection string.</tt> </tt>
<a name="L909"></a><tt class="py-lineno"> 909</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-573" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-573', 'spin_id', 'link-488');">spin_id</a></tt><tt class="py-op">:</tt> </tt>
<a name="L910"></a><tt class="py-lineno"> 910</tt>  <tt class="py-line">        <tt class="py-name">mol_token</tt><tt class="py-op">,</tt> <tt class="py-name">res_token</tt><tt class="py-op">,</tt> <tt class="py-name">spin_token</tt> <tt class="py-op">=</tt> <tt id="link-574" class="py-name"><a title="lib.selection.tokenise" class="py-name" href="#" onclick="return doclink('link-574', 'tokenise', 'link-37');">tokenise</a></tt><tt class="py-op">(</tt><tt id="link-575" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-575', 'spin_id', 'link-488');">spin_id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L911"></a><tt class="py-lineno"> 911</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">mol_token</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L912"></a><tt class="py-lineno"> 912</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-576" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-576', 'RelaxError', 'link-20');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The spin ID string cannot contain molecular information when specifying multiple molecules to load spins from."</tt><tt class="py-op">)</tt> </tt>
<a name="L913"></a><tt class="py-lineno"> 913</tt>  <tt class="py-line"> </tt>
<a name="L914"></a><tt class="py-lineno"> 914</tt>  <tt class="py-line">    <tt class="py-comment"># Print out.</tt> </tt>
<a name="L915"></a><tt class="py-lineno"> 915</tt>  <tt class="py-line">    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Adding the following spins to the relax data store.\n"</tt><tt class="py-op">)</tt> </tt>
<a name="L916"></a><tt class="py-lineno"> 916</tt>  <tt class="py-line"> </tt>
<a name="L917"></a><tt class="py-lineno"> 917</tt>  <tt class="py-line">    <tt class="py-comment"># Initialise the data structures.</tt> </tt>
<a name="L918"></a><tt class="py-lineno"> 918</tt>  <tt class="py-line">    <tt class="py-name">ids</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L919"></a><tt class="py-lineno"> 919</tt>  <tt class="py-line">    <tt class="py-name">res_nums</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L920"></a><tt class="py-lineno"> 920</tt>  <tt class="py-line">    <tt class="py-name">res_names</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L921"></a><tt class="py-lineno"> 921</tt>  <tt class="py-line">    <tt class="py-name">spin_names</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L922"></a><tt class="py-lineno"> 922</tt>  <tt class="py-line">    <tt class="py-name">positions</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L923"></a><tt class="py-lineno"> 923</tt>  <tt class="py-line">    <tt id="link-577" class="py-name"><a title="gui.analyses.elements" class="py-name" href="#" onclick="return doclink('link-577', 'elements', 'link-142');">elements</a></tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L924"></a><tt class="py-lineno"> 924</tt>  <tt class="py-line"> </tt>
<a name="L925"></a><tt class="py-lineno"> 925</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over all target molecules.</tt> </tt>
<a name="L926"></a><tt class="py-lineno"> 926</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">mol_name</tt> <tt class="py-keyword">in</tt> <tt class="py-name">from_mols</tt><tt class="py-op">:</tt> </tt>
<a name="L927"></a><tt class="py-lineno"> 927</tt>  <tt class="py-line">        <tt class="py-comment"># Add the molecule name as a key for the positions structure, and initialise as a dictionary for the spin IDs.</tt> </tt>
<a name="L928"></a><tt class="py-lineno"> 928</tt>  <tt class="py-line">        <tt class="py-name">positions</tt><tt class="py-op">[</tt><tt class="py-name">mol_name</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L929"></a><tt class="py-lineno"> 929</tt>  <tt class="py-line"> </tt>
<a name="L930"></a><tt class="py-lineno"> 930</tt>  <tt class="py-line">        <tt class="py-comment"># Create a new spin ID with the molecule name.</tt> </tt>
<a name="L931"></a><tt class="py-lineno"> 931</tt>  <tt class="py-line">        <tt class="py-name">new_id</tt> <tt class="py-op">=</tt> <tt class="py-string">'#'</tt> <tt class="py-op">+</tt> <tt class="py-name">mol_name</tt> </tt>
<a name="L932"></a><tt class="py-lineno"> 932</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-578" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-578', 'spin_id', 'link-488');">spin_id</a></tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L933"></a><tt class="py-lineno"> 933</tt>  <tt class="py-line">            <tt class="py-name">new_id</tt> <tt class="py-op">+=</tt> <tt id="link-579" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-579', 'spin_id', 'link-488');">spin_id</a></tt> </tt>
<a name="L934"></a><tt class="py-lineno"> 934</tt>  <tt class="py-line"> </tt>
<a name="L935"></a><tt class="py-lineno"> 935</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over all atoms of the new spin ID selection.</tt> </tt>
<a name="L936"></a><tt class="py-lineno"> 936</tt>  <tt class="py-line">        <tt id="link-580" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-580', 'selection', 'link-36');">selection</a></tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-581" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-581', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-582" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-582', 'selection', 'link-36');">selection</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">new_id</tt><tt class="py-op">)</tt> </tt>
<a name="L937"></a><tt class="py-lineno"> 937</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">,</tt> <tt id="link-583" class="py-name"><a title="lib.periodic_table.element" class="py-name" href="#" onclick="return doclink('link-583', 'element', 'link-122');">element</a></tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-584" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-584', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-585" class="py-name"><a title="lib.structure.internal.object.Internal.atom_loop" class="py-name" href="#" onclick="return doclink('link-585', 'atom_loop', 'link-492');">atom_loop</a></tt><tt class="py-op">(</tt><tt id="link-586" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-586', 'selection', 'link-36');">selection</a></tt><tt class="py-op">=</tt><tt id="link-587" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-587', 'selection', 'link-36');">selection</a></tt><tt class="py-op">,</tt> <tt class="py-name">str_id</tt><tt class="py-op">=</tt><tt class="py-name">str_id</tt><tt class="py-op">,</tt> <tt class="py-name">res_num_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">res_name_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">element_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">pos_flag</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">ave</tt><tt class="py-op">=</tt><tt class="py-name">ave_pos</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L938"></a><tt class="py-lineno"> 938</tt>  <tt class="py-line">            <tt class="py-comment"># Remove the '+' regular expression character from the res and atom names.</tt> </tt>
<a name="L939"></a><tt class="py-lineno"> 939</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">res_name</tt> <tt class="py-keyword">and</tt> <tt id="link-588" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-588', 'search', 'link-6');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'\+'</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L940"></a><tt class="py-lineno"> 940</tt>  <tt class="py-line">                <tt class="py-name">res_name</tt> <tt class="py-op">=</tt> <tt class="py-name">res_name</tt><tt class="py-op">.</tt><tt class="py-name">replace</tt><tt class="py-op">(</tt><tt class="py-string">'+'</tt><tt class="py-op">,</tt> <tt class="py-string">''</tt><tt class="py-op">)</tt> </tt>
<a name="L941"></a><tt class="py-lineno"> 941</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">atom_name</tt> <tt class="py-keyword">and</tt> <tt id="link-589" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-589', 'search', 'link-6');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'\+'</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L942"></a><tt class="py-lineno"> 942</tt>  <tt class="py-line">                <tt class="py-name">atom_name</tt> <tt class="py-op">=</tt> <tt class="py-name">atom_name</tt><tt class="py-op">.</tt><tt class="py-name">replace</tt><tt class="py-op">(</tt><tt class="py-string">'+'</tt><tt class="py-op">,</tt> <tt class="py-string">''</tt><tt class="py-op">)</tt> </tt>
<a name="L943"></a><tt class="py-lineno"> 943</tt>  <tt class="py-line"> </tt>
<a name="L944"></a><tt class="py-lineno"> 944</tt>  <tt class="py-line">            <tt class="py-comment"># Generate a spin ID for the current atom.</tt> </tt>
<a name="L945"></a><tt class="py-lineno"> 945</tt>  <tt class="py-line">            <tt class="py-name">id</tt> <tt class="py-op">=</tt> <tt id="link-590" class="py-name"><a title="pipe_control.mol_res_spin.generate_spin_id_unique" class="py-name" href="#" onclick="return doclink('link-590', 'generate_spin_id_unique', 'link-93');">generate_spin_id_unique</a></tt><tt class="py-op">(</tt><tt class="py-name">mol_name</tt><tt class="py-op">=</tt><tt class="py-name">mol_name_target</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">res_name</tt><tt class="py-op">,</tt> <tt class="py-name">spin_name</tt><tt class="py-op">=</tt><tt class="py-name">atom_name</tt><tt class="py-op">)</tt> </tt>
<a name="L946"></a><tt class="py-lineno"> 946</tt>  <tt class="py-line"> </tt>
<a name="L947"></a><tt class="py-lineno"> 947</tt>  <tt class="py-line">            <tt class="py-comment"># Store the position info in all cases, collapsing list of lists into single lists when needed.</tt> </tt>
<a name="L948"></a><tt class="py-lineno"> 948</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-591" class="py-name"><a title="lib.arg_check.is_float
lib.check_types.is_float" class="py-name" href="#" onclick="return doclink('link-591', 'is_float', 'link-17');">is_float</a></tt><tt class="py-op">(</tt><tt class="py-name">pos</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L949"></a><tt class="py-lineno"> 949</tt>  <tt class="py-line">                <tt class="py-name">positions</tt><tt class="py-op">[</tt><tt class="py-name">mol_name</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-name">id</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">pos</tt> </tt>
<a name="L950"></a><tt class="py-lineno"> 950</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L951"></a><tt class="py-lineno"> 951</tt>  <tt class="py-line">                <tt class="py-name">positions</tt><tt class="py-op">[</tt><tt class="py-name">mol_name</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-name">id</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">pos</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L952"></a><tt class="py-lineno"> 952</tt>  <tt class="py-line"> </tt>
<a name="L953"></a><tt class="py-lineno"> 953</tt>  <tt class="py-line">            <tt class="py-comment"># Not a new ID.</tt> </tt>
<a name="L954"></a><tt class="py-lineno"> 954</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">id</tt> <tt class="py-keyword">in</tt> <tt class="py-name">ids</tt><tt class="py-op">:</tt> </tt>
<a name="L955"></a><tt class="py-lineno"> 955</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L956"></a><tt class="py-lineno"> 956</tt>  <tt class="py-line"> </tt>
<a name="L957"></a><tt class="py-lineno"> 957</tt>  <tt class="py-line">            <tt class="py-comment"># Store the ID, residue, spin, element and position info.</tt> </tt>
<a name="L958"></a><tt class="py-lineno"> 958</tt>  <tt class="py-line">            <tt class="py-name">ids</tt><tt class="py-op">.</tt><tt id="link-592" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-592', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">id</tt><tt class="py-op">)</tt> </tt>
<a name="L959"></a><tt class="py-lineno"> 959</tt>  <tt class="py-line">            <tt class="py-name">res_nums</tt><tt class="py-op">[</tt><tt class="py-name">id</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">res_num</tt> </tt>
<a name="L960"></a><tt class="py-lineno"> 960</tt>  <tt class="py-line">            <tt class="py-name">res_names</tt><tt class="py-op">[</tt><tt class="py-name">id</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">res_name</tt> </tt>
<a name="L961"></a><tt class="py-lineno"> 961</tt>  <tt class="py-line">            <tt class="py-name">spin_names</tt><tt class="py-op">[</tt><tt class="py-name">id</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">atom_name</tt> </tt>
<a name="L962"></a><tt class="py-lineno"> 962</tt>  <tt class="py-line">            <tt id="link-593" class="py-name"><a title="gui.analyses.elements" class="py-name" href="#" onclick="return doclink('link-593', 'elements', 'link-142');">elements</a></tt><tt class="py-op">[</tt><tt class="py-name">id</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-594" class="py-name"><a title="lib.periodic_table.element" class="py-name" href="#" onclick="return doclink('link-594', 'element', 'link-122');">element</a></tt> </tt>
<a name="L963"></a><tt class="py-lineno"> 963</tt>  <tt class="py-line"> </tt>
<a name="L964"></a><tt class="py-lineno"> 964</tt>  <tt class="py-line">    <tt class="py-comment"># Catch no data.</tt> </tt>
<a name="L965"></a><tt class="py-lineno"> 965</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">ids</tt><tt class="py-op">)</tt> <tt class="py-op">==</tt> <tt class="py-number">0</tt><tt class="py-op">:</tt> </tt>
<a name="L966"></a><tt class="py-lineno"> 966</tt>  <tt class="py-line">        <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-595" class="py-name"><a title="lib.warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-595', 'RelaxWarning', 'link-80');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"No spins matching the '%s' ID string could be found."</tt> <tt class="py-op">%</tt> <tt id="link-596" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-596', 'spin_id', 'link-488');">spin_id</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L967"></a><tt class="py-lineno"> 967</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> </tt>
<a name="L968"></a><tt class="py-lineno"> 968</tt>  <tt class="py-line"> </tt>
<a name="L969"></a><tt class="py-lineno"> 969</tt>  <tt class="py-line">    <tt class="py-comment"># Create the spin containers.</tt> </tt>
<a name="L970"></a><tt class="py-lineno"> 970</tt>  <tt class="py-line">    <tt class="py-name">mol_names2</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L971"></a><tt class="py-lineno"> 971</tt>  <tt class="py-line">    <tt class="py-name">res_nums2</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L972"></a><tt class="py-lineno"> 972</tt>  <tt class="py-line">    <tt class="py-name">res_names2</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L973"></a><tt class="py-lineno"> 973</tt>  <tt class="py-line">    <tt class="py-name">spin_names2</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L974"></a><tt class="py-lineno"> 974</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">id</tt> <tt class="py-keyword">in</tt> <tt class="py-name">ids</tt><tt class="py-op">:</tt> </tt>
<a name="L975"></a><tt class="py-lineno"> 975</tt>  <tt class="py-line">        <tt class="py-comment"># Fetch the spin.</tt> </tt>
<a name="L976"></a><tt class="py-lineno"> 976</tt>  <tt class="py-line">        <tt class="py-name">spin_cont</tt> <tt class="py-op">=</tt> <tt id="link-597" class="py-name"><a title="pipe_control.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-597', 'return_spin', 'link-95');">return_spin</a></tt><tt class="py-op">(</tt><tt class="py-name">id</tt><tt class="py-op">)</tt> </tt>
<a name="L977"></a><tt class="py-lineno"> 977</tt>  <tt class="py-line"> </tt>
<a name="L978"></a><tt class="py-lineno"> 978</tt>  <tt class="py-line">        <tt class="py-comment"># Create the spin if it does not exist.</tt> </tt>
<a name="L979"></a><tt class="py-lineno"> 979</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">spin_cont</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L980"></a><tt class="py-lineno"> 980</tt>  <tt class="py-line">            <tt class="py-name">spin_cont</tt> <tt class="py-op">=</tt> <tt id="link-598" class="py-name"><a title="pipe_control.mol_res_spin.create_spin" class="py-name" href="#" onclick="return doclink('link-598', 'create_spin', 'link-92');">create_spin</a></tt><tt class="py-op">(</tt><tt class="py-name">mol_name</tt><tt class="py-op">=</tt><tt class="py-name">mol_name_target</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_nums</tt><tt class="py-op">[</tt><tt class="py-name">id</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">res_names</tt><tt class="py-op">[</tt><tt class="py-name">id</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">spin_name</tt><tt class="py-op">=</tt><tt class="py-name">spin_names</tt><tt class="py-op">[</tt><tt class="py-name">id</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L981"></a><tt class="py-lineno"> 981</tt>  <tt class="py-line"> </tt>
<a name="L982"></a><tt class="py-lineno"> 982</tt>  <tt class="py-line">        <tt class="py-comment"># Position vector.</tt> </tt>
<a name="L983"></a><tt class="py-lineno"> 983</tt>  <tt class="py-line">        <tt class="py-name">spin_cont</tt><tt class="py-op">.</tt><tt class="py-name">pos</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L984"></a><tt class="py-lineno"> 984</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">mol_name</tt> <tt class="py-keyword">in</tt> <tt class="py-name">from_mols</tt><tt class="py-op">:</tt> </tt>
<a name="L985"></a><tt class="py-lineno"> 985</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">id</tt> <tt class="py-keyword">in</tt> <tt class="py-name">positions</tt><tt class="py-op">[</tt><tt class="py-name">mol_name</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L986"></a><tt class="py-lineno"> 986</tt>  <tt class="py-line">                <tt class="py-name">spin_cont</tt><tt class="py-op">.</tt><tt class="py-name">pos</tt><tt class="py-op">.</tt><tt id="link-599" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-599', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">positions</tt><tt class="py-op">[</tt><tt class="py-name">mol_name</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-name">id</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L987"></a><tt class="py-lineno"> 987</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L988"></a><tt class="py-lineno"> 988</tt>  <tt class="py-line">                <tt class="py-name">spin_cont</tt><tt class="py-op">.</tt><tt class="py-name">pos</tt><tt class="py-op">.</tt><tt id="link-600" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-600', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">None</tt><tt class="py-op">)</tt> </tt>
<a name="L989"></a><tt class="py-lineno"> 989</tt>  <tt class="py-line"> </tt>
<a name="L990"></a><tt class="py-lineno"> 990</tt>  <tt class="py-line">        <tt class="py-comment"># Add the element.</tt> </tt>
<a name="L991"></a><tt class="py-lineno"> 991</tt>  <tt class="py-line">        <tt class="py-name">spin_cont</tt><tt class="py-op">.</tt><tt id="link-601" class="py-name"><a title="lib.periodic_table.element" class="py-name" href="#" onclick="return doclink('link-601', 'element', 'link-122');">element</a></tt> <tt class="py-op">=</tt> <tt id="link-602" class="py-name"><a title="gui.analyses.elements" class="py-name" href="#" onclick="return doclink('link-602', 'elements', 'link-142');">elements</a></tt><tt class="py-op">[</tt><tt class="py-name">id</tt><tt class="py-op">]</tt> </tt>
<a name="L992"></a><tt class="py-lineno"> 992</tt>  <tt class="py-line"> </tt>
<a name="L993"></a><tt class="py-lineno"> 993</tt>  <tt class="py-line">        <tt class="py-comment"># Update the structures for the printout.</tt> </tt>
<a name="L994"></a><tt class="py-lineno"> 994</tt>  <tt class="py-line">        <tt class="py-name">mol_names2</tt><tt class="py-op">.</tt><tt id="link-603" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-603', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">mol_name_target</tt><tt class="py-op">)</tt> </tt>
<a name="L995"></a><tt class="py-lineno"> 995</tt>  <tt class="py-line">        <tt class="py-name">res_nums2</tt><tt class="py-op">.</tt><tt id="link-604" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-604', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">res_nums</tt><tt class="py-op">[</tt><tt class="py-name">id</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L996"></a><tt class="py-lineno"> 996</tt>  <tt class="py-line">        <tt class="py-name">res_names2</tt><tt class="py-op">.</tt><tt id="link-605" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-605', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">res_names</tt><tt class="py-op">[</tt><tt class="py-name">id</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L997"></a><tt class="py-lineno"> 997</tt>  <tt class="py-line">        <tt class="py-name">spin_names2</tt><tt class="py-op">.</tt><tt id="link-606" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-606', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">spin_names</tt><tt class="py-op">[</tt><tt class="py-name">id</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L998"></a><tt class="py-lineno"> 998</tt>  <tt class="py-line"> </tt>
<a name="L999"></a><tt class="py-lineno"> 999</tt>  <tt class="py-line">    <tt class="py-comment"># Print out.</tt> </tt>
<a name="L1000"></a><tt class="py-lineno">1000</tt>  <tt class="py-line">    <tt id="link-607" class="py-name"><a title="lib.sequence.write_spin_data" class="py-name" href="#" onclick="return doclink('link-607', 'write_spin_data', 'link-40');">write_spin_data</a></tt><tt class="py-op">(</tt><tt id="link-608" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-608', 'file', 'link-266');">file</a></tt><tt class="py-op">=</tt><tt class="py-name">sys</tt><tt class="py-op">.</tt><tt class="py-name">stdout</tt><tt class="py-op">,</tt> <tt class="py-name">mol_names</tt><tt class="py-op">=</tt><tt class="py-name">mol_names2</tt><tt class="py-op">,</tt> <tt class="py-name">res_nums</tt><tt class="py-op">=</tt><tt class="py-name">res_nums2</tt><tt class="py-op">,</tt> <tt class="py-name">res_names</tt><tt class="py-op">=</tt><tt class="py-name">res_names2</tt><tt class="py-op">,</tt> <tt class="py-name">spin_names</tt><tt class="py-op">=</tt><tt class="py-name">spin_names2</tt><tt class="py-op">)</tt> </tt>
<a name="L1001"></a><tt class="py-lineno">1001</tt>  <tt class="py-line"> </tt>
<a name="L1002"></a><tt class="py-lineno">1002</tt>  <tt class="py-line">    <tt class="py-comment"># Set the number of states for use in the specific analyses.</tt> </tt>
<a name="L1003"></a><tt class="py-lineno">1003</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">N</tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">from_mols</tt><tt class="py-op">)</tt> </tt>
</div><a name="L1004"></a><tt class="py-lineno">1004</tt>  <tt class="py-line"> </tt>
<a name="L1005"></a><tt class="py-lineno">1005</tt>  <tt class="py-line"> </tt>
<a name="read_gaussian"></a><div id="read_gaussian-def"><a name="L1006"></a><tt class="py-lineno">1006</tt> <a class="py-toggle" href="#" id="read_gaussian-toggle" onclick="return toggle('read_gaussian');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#read_gaussian">read_gaussian</a><tt class="py-op">(</tt><tt class="py-param">file</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">dir</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">set_mol_name</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">set_model_num</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">verbosity</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-param">fail</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="read_gaussian-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="read_gaussian-expanded"><a name="L1007"></a><tt class="py-lineno">1007</tt>  <tt class="py-line">    <tt class="py-docstring">"""Read structures from a Gaussian log file.</tt> </tt>
<a name="L1008"></a><tt class="py-lineno">1008</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1009"></a><tt class="py-lineno">1009</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1010"></a><tt class="py-lineno">1010</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword file:          The name of the Gaussian log file to read.</tt> </tt>
<a name="L1011"></a><tt class="py-lineno">1011</tt>  <tt class="py-line"><tt class="py-docstring">    @type file:             str</tt> </tt>
<a name="L1012"></a><tt class="py-lineno">1012</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword dir:           The directory where the Gaussian log file is located.  If set to None, then the file will be searched for in the current directory.</tt> </tt>
<a name="L1013"></a><tt class="py-lineno">1013</tt>  <tt class="py-line"><tt class="py-docstring">    @type dir:              str or None</tt> </tt>
<a name="L1014"></a><tt class="py-lineno">1014</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword set_mol_name:  Set the names of the molecules which are loaded.  If set to None, then the molecules will be automatically labelled based on the file name or other information.</tt> </tt>
<a name="L1015"></a><tt class="py-lineno">1015</tt>  <tt class="py-line"><tt class="py-docstring">    @type set_mol_name:     None, str, or list of str</tt> </tt>
<a name="L1016"></a><tt class="py-lineno">1016</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword set_model_num: Set the model number of the loaded molecule.</tt> </tt>
<a name="L1017"></a><tt class="py-lineno">1017</tt>  <tt class="py-line"><tt class="py-docstring">    @type set_model_num:    None, int, or list of int</tt> </tt>
<a name="L1018"></a><tt class="py-lineno">1018</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword fail:          A flag which, if True, will cause a RelaxError to be raised if the Gaussian log  file does not exist.  If False, then a RelaxWarning will be trown instead.</tt> </tt>
<a name="L1019"></a><tt class="py-lineno">1019</tt>  <tt class="py-line"><tt class="py-docstring">    @type fail:             bool</tt> </tt>
<a name="L1020"></a><tt class="py-lineno">1020</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword verbosity:     The amount of information to print to screen.  Zero corresponds to minimal output while higher values increase the amount of output.  The default value is 1.</tt> </tt>
<a name="L1021"></a><tt class="py-lineno">1021</tt>  <tt class="py-line"><tt class="py-docstring">    @type verbosity:        int</tt> </tt>
<a name="L1022"></a><tt class="py-lineno">1022</tt>  <tt class="py-line"><tt class="py-docstring">    @raise RelaxFileError:  If the fail flag is set, then a RelaxError is raised if the Gaussian log file does not exist.</tt> </tt>
<a name="L1023"></a><tt class="py-lineno">1023</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L1024"></a><tt class="py-lineno">1024</tt>  <tt class="py-line"> </tt>
<a name="L1025"></a><tt class="py-lineno">1025</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L1026"></a><tt class="py-lineno">1026</tt>  <tt class="py-line">    <tt id="link-609" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-609', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1027"></a><tt class="py-lineno">1027</tt>  <tt class="py-line"> </tt>
<a name="L1028"></a><tt class="py-lineno">1028</tt>  <tt class="py-line">    <tt class="py-comment"># The file path.</tt> </tt>
<a name="L1029"></a><tt class="py-lineno">1029</tt>  <tt class="py-line">    <tt class="py-name">file_path</tt> <tt class="py-op">=</tt> <tt id="link-610" class="py-name"><a title="lib.io.get_file_path" class="py-name" href="#" onclick="return doclink('link-610', 'get_file_path', 'link-28');">get_file_path</a></tt><tt class="py-op">(</tt><tt id="link-611" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-611', 'file', 'link-266');">file</a></tt><tt class="py-op">,</tt> <tt id="link-612" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-612', 'dir', 'link-268');">dir</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1030"></a><tt class="py-lineno">1030</tt>  <tt class="py-line"> </tt>
<a name="L1031"></a><tt class="py-lineno">1031</tt>  <tt class="py-line">    <tt class="py-comment"># Try adding '.log' to the end of the file path, if the file can't be found.</tt> </tt>
<a name="L1032"></a><tt class="py-lineno">1032</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">access</tt><tt class="py-op">(</tt><tt class="py-name">file_path</tt><tt class="py-op">,</tt> <tt class="py-name">F_OK</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1033"></a><tt class="py-lineno">1033</tt>  <tt class="py-line">        <tt class="py-name">file_path_orig</tt> <tt class="py-op">=</tt> <tt class="py-name">file_path</tt> </tt>
<a name="L1034"></a><tt class="py-lineno">1034</tt>  <tt class="py-line">        <tt class="py-name">file_path</tt> <tt class="py-op">=</tt> <tt class="py-name">file_path</tt> <tt class="py-op">+</tt> <tt class="py-string">'.log'</tt> </tt>
<a name="L1035"></a><tt class="py-lineno">1035</tt>  <tt class="py-line"> </tt>
<a name="L1036"></a><tt class="py-lineno">1036</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the file exists.</tt> </tt>
<a name="L1037"></a><tt class="py-lineno">1037</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">access</tt><tt class="py-op">(</tt><tt class="py-name">file_path</tt><tt class="py-op">,</tt> <tt class="py-name">F_OK</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1038"></a><tt class="py-lineno">1038</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">fail</tt><tt class="py-op">:</tt> </tt>
<a name="L1039"></a><tt class="py-lineno">1039</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-613" class="py-name"><a title="lib.errors.RelaxFileError" class="py-name" href="#" onclick="return doclink('link-613', 'RelaxFileError', 'link-21');">RelaxFileError</a></tt><tt class="py-op">(</tt><tt class="py-string">'Gaussian log'</tt><tt class="py-op">,</tt> <tt class="py-name">file_path_orig</tt><tt class="py-op">)</tt> </tt>
<a name="L1040"></a><tt class="py-lineno">1040</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1041"></a><tt class="py-lineno">1041</tt>  <tt class="py-line">            <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-614" class="py-name"><a title="lib.warnings.RelaxNoPDBFileWarning" class="py-name" href="#" onclick="return doclink('link-614', 'RelaxNoPDBFileWarning', 'link-81');">RelaxNoPDBFileWarning</a></tt><tt class="py-op">(</tt><tt class="py-name">file_path</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1042"></a><tt class="py-lineno">1042</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
<a name="L1043"></a><tt class="py-lineno">1043</tt>  <tt class="py-line"> </tt>
<a name="L1044"></a><tt class="py-lineno">1044</tt>  <tt class="py-line">    <tt class="py-comment"># Place the  structural object into the relax data store.</tt> </tt>
<a name="L1045"></a><tt class="py-lineno">1045</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1046"></a><tt class="py-lineno">1046</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-615" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-615', 'structure', 'link-48');">structure</a></tt> <tt class="py-op">=</tt> <tt id="link-616" class="py-name"><a title="lib.structure.internal.object.Internal" class="py-name" href="#" onclick="return doclink('link-616', 'Internal', 'link-63');">Internal</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1047"></a><tt class="py-lineno">1047</tt>  <tt class="py-line"> </tt>
<a name="L1048"></a><tt class="py-lineno">1048</tt>  <tt class="py-line">    <tt class="py-comment"># Load the structures.</tt> </tt>
<a name="L1049"></a><tt class="py-lineno">1049</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-617" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-617', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-618" class="py-name" targets="Method lib.structure.internal.object.Internal.load_gaussian()=lib.structure.internal.object.Internal-class.html#load_gaussian"><a title="lib.structure.internal.object.Internal.load_gaussian" class="py-name" href="#" onclick="return doclink('link-618', 'load_gaussian', 'link-618');">load_gaussian</a></tt><tt class="py-op">(</tt><tt class="py-name">file_path</tt><tt class="py-op">,</tt> <tt class="py-name">set_mol_name</tt><tt class="py-op">=</tt><tt class="py-name">set_mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">set_model_num</tt><tt class="py-op">=</tt><tt class="py-name">set_model_num</tt><tt class="py-op">,</tt> <tt id="link-619" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-619', 'verbosity', 'link-412');">verbosity</a></tt><tt class="py-op">=</tt><tt id="link-620" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-620', 'verbosity', 'link-412');">verbosity</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L1050"></a><tt class="py-lineno">1050</tt>  <tt class="py-line"> </tt>
<a name="L1051"></a><tt class="py-lineno">1051</tt>  <tt class="py-line"> </tt>
<a name="read_pdb"></a><div id="read_pdb-def"><a name="L1052"></a><tt class="py-lineno">1052</tt> <a class="py-toggle" href="#" id="read_pdb-toggle" onclick="return toggle('read_pdb');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#read_pdb">read_pdb</a><tt class="py-op">(</tt><tt class="py-param">file</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">dir</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">read_mol</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">set_mol_name</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">read_model</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">set_model_num</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">alt_loc</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">verbosity</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-param">merge</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">,</tt> <tt class="py-param">fail</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="read_pdb-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="read_pdb-expanded"><a name="L1053"></a><tt class="py-lineno">1053</tt>  <tt class="py-line">    <tt class="py-docstring">"""The PDB loading function.</tt> </tt>
<a name="L1054"></a><tt class="py-lineno">1054</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1055"></a><tt class="py-lineno">1055</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword file:          The name of the PDB file to read.</tt> </tt>
<a name="L1056"></a><tt class="py-lineno">1056</tt>  <tt class="py-line"><tt class="py-docstring">    @type file:             str</tt> </tt>
<a name="L1057"></a><tt class="py-lineno">1057</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword dir:           The directory where the PDB file is located.  If set to None, then the file will be searched for in the current directory.</tt> </tt>
<a name="L1058"></a><tt class="py-lineno">1058</tt>  <tt class="py-line"><tt class="py-docstring">    @type dir:              str or None</tt> </tt>
<a name="L1059"></a><tt class="py-lineno">1059</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword read_mol:      The molecule(s) to read from the file, independent of model.  The molecules are numbered consecutively from 1.  If set to None, then all molecules will be loaded.</tt> </tt>
<a name="L1060"></a><tt class="py-lineno">1060</tt>  <tt class="py-line"><tt class="py-docstring">    @type read_mol:         None, int, or list of int</tt> </tt>
<a name="L1061"></a><tt class="py-lineno">1061</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword set_mol_name:  Set the names of the molecules which are loaded.  If set to None, then the molecules will be automatically labelled based on the file name or other information.</tt> </tt>
<a name="L1062"></a><tt class="py-lineno">1062</tt>  <tt class="py-line"><tt class="py-docstring">    @type set_mol_name:     None, str, or list of str</tt> </tt>
<a name="L1063"></a><tt class="py-lineno">1063</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword read_model:    The PDB model to extract from the file.  If set to None, then all models will be loaded.</tt> </tt>
<a name="L1064"></a><tt class="py-lineno">1064</tt>  <tt class="py-line"><tt class="py-docstring">    @type read_model:       None, int, or list of int</tt> </tt>
<a name="L1065"></a><tt class="py-lineno">1065</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword set_model_num: Set the model number of the loaded molecule.  If set to None, then the PDB model numbers will be preserved, if they exist.</tt> </tt>
<a name="L1066"></a><tt class="py-lineno">1066</tt>  <tt class="py-line"><tt class="py-docstring">    @type set_model_num:    None, int, or list of int</tt> </tt>
<a name="L1067"></a><tt class="py-lineno">1067</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword alt_loc:       The PDB ATOM record 'Alternate location indicator' field value to select which coordinates to use.</tt> </tt>
<a name="L1068"></a><tt class="py-lineno">1068</tt>  <tt class="py-line"><tt class="py-docstring">    @type alt_loc:          str or None</tt> </tt>
<a name="L1069"></a><tt class="py-lineno">1069</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword verbosity:     The amount of information to print to screen.  Zero corresponds to minimal output while higher values increase the amount of output.  The default value is 1.</tt> </tt>
<a name="L1070"></a><tt class="py-lineno">1070</tt>  <tt class="py-line"><tt class="py-docstring">    @type verbosity:        int</tt> </tt>
<a name="L1071"></a><tt class="py-lineno">1071</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword merge:         A flag which if set to True will try to merge the PDB structure into the currently loaded structures.</tt> </tt>
<a name="L1072"></a><tt class="py-lineno">1072</tt>  <tt class="py-line"><tt class="py-docstring">    @type merge:            bool</tt> </tt>
<a name="L1073"></a><tt class="py-lineno">1073</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword fail:          A flag which, if True, will cause a RelaxError to be raised if the PDB file does not exist.  If False, then a RelaxWarning will be trown instead.</tt> </tt>
<a name="L1074"></a><tt class="py-lineno">1074</tt>  <tt class="py-line"><tt class="py-docstring">    @type fail:             bool</tt> </tt>
<a name="L1075"></a><tt class="py-lineno">1075</tt>  <tt class="py-line"><tt class="py-docstring">    @raise RelaxFileError:  If the fail flag is set, then a RelaxError is raised if the PDB file does not exist.</tt> </tt>
<a name="L1076"></a><tt class="py-lineno">1076</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L1077"></a><tt class="py-lineno">1077</tt>  <tt class="py-line"> </tt>
<a name="L1078"></a><tt class="py-lineno">1078</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L1079"></a><tt class="py-lineno">1079</tt>  <tt class="py-line">    <tt id="link-621" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-621', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1080"></a><tt class="py-lineno">1080</tt>  <tt class="py-line"> </tt>
<a name="L1081"></a><tt class="py-lineno">1081</tt>  <tt class="py-line">    <tt class="py-comment"># The file path.</tt> </tt>
<a name="L1082"></a><tt class="py-lineno">1082</tt>  <tt class="py-line">    <tt class="py-name">file_path</tt> <tt class="py-op">=</tt> <tt id="link-622" class="py-name"><a title="lib.io.get_file_path" class="py-name" href="#" onclick="return doclink('link-622', 'get_file_path', 'link-28');">get_file_path</a></tt><tt class="py-op">(</tt><tt id="link-623" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-623', 'file', 'link-266');">file</a></tt><tt class="py-op">,</tt> <tt id="link-624" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-624', 'dir', 'link-268');">dir</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1083"></a><tt class="py-lineno">1083</tt>  <tt class="py-line"> </tt>
<a name="L1084"></a><tt class="py-lineno">1084</tt>  <tt class="py-line">    <tt class="py-comment"># Try adding file extensions to the end of the file path, if the file can't be found.</tt> </tt>
<a name="L1085"></a><tt class="py-lineno">1085</tt>  <tt class="py-line">    <tt class="py-name">file_path_orig</tt> <tt class="py-op">=</tt> <tt class="py-name">file_path</tt> </tt>
<a name="L1086"></a><tt class="py-lineno">1086</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">access</tt><tt class="py-op">(</tt><tt class="py-name">file_path</tt><tt class="py-op">,</tt> <tt class="py-name">F_OK</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1087"></a><tt class="py-lineno">1087</tt>  <tt class="py-line">        <tt class="py-comment"># List of possible extensions.</tt> </tt>
<a name="L1088"></a><tt class="py-lineno">1088</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-625" class="py-name" targets="Variable bmrblib.nmr_star_dict.NMR_STAR.ext=bmrblib.nmr_star_dict.NMR_STAR-class.html#ext"><a title="bmrblib.nmr_star_dict.NMR_STAR.ext" class="py-name" href="#" onclick="return doclink('link-625', 'ext', 'link-625');">ext</a></tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt class="py-string">'.pdb'</tt><tt class="py-op">,</tt> <tt class="py-string">'.gz'</tt><tt class="py-op">,</tt> <tt class="py-string">'.pdb.gz'</tt><tt class="py-op">,</tt> <tt class="py-string">'.bz2'</tt><tt class="py-op">,</tt> <tt class="py-string">'.pdb.bz2'</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L1089"></a><tt class="py-lineno">1089</tt>  <tt class="py-line">            <tt class="py-comment"># Add the extension if the file can be found.</tt> </tt>
<a name="L1090"></a><tt class="py-lineno">1090</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">access</tt><tt class="py-op">(</tt><tt class="py-name">file_path</tt><tt class="py-op">+</tt><tt id="link-626" class="py-name"><a title="bmrblib.nmr_star_dict.NMR_STAR.ext" class="py-name" href="#" onclick="return doclink('link-626', 'ext', 'link-625');">ext</a></tt><tt class="py-op">,</tt> <tt class="py-name">F_OK</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1091"></a><tt class="py-lineno">1091</tt>  <tt class="py-line">                <tt class="py-name">file_path</tt> <tt class="py-op">=</tt> <tt class="py-name">file_path</tt> <tt class="py-op">+</tt> <tt id="link-627" class="py-name"><a title="bmrblib.nmr_star_dict.NMR_STAR.ext" class="py-name" href="#" onclick="return doclink('link-627', 'ext', 'link-625');">ext</a></tt> </tt>
<a name="L1092"></a><tt class="py-lineno">1092</tt>  <tt class="py-line"> </tt>
<a name="L1093"></a><tt class="py-lineno">1093</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the file exists.</tt> </tt>
<a name="L1094"></a><tt class="py-lineno">1094</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">access</tt><tt class="py-op">(</tt><tt class="py-name">file_path</tt><tt class="py-op">,</tt> <tt class="py-name">F_OK</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1095"></a><tt class="py-lineno">1095</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">fail</tt><tt class="py-op">:</tt> </tt>
<a name="L1096"></a><tt class="py-lineno">1096</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-628" class="py-name"><a title="lib.errors.RelaxFileError" class="py-name" href="#" onclick="return doclink('link-628', 'RelaxFileError', 'link-21');">RelaxFileError</a></tt><tt class="py-op">(</tt><tt class="py-string">'PDB'</tt><tt class="py-op">,</tt> <tt class="py-name">file_path_orig</tt><tt class="py-op">)</tt> </tt>
<a name="L1097"></a><tt class="py-lineno">1097</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1098"></a><tt class="py-lineno">1098</tt>  <tt class="py-line">            <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-629" class="py-name"><a title="lib.warnings.RelaxNoPDBFileWarning" class="py-name" href="#" onclick="return doclink('link-629', 'RelaxNoPDBFileWarning', 'link-81');">RelaxNoPDBFileWarning</a></tt><tt class="py-op">(</tt><tt class="py-name">file_path</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1099"></a><tt class="py-lineno">1099</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
<a name="L1100"></a><tt class="py-lineno">1100</tt>  <tt class="py-line"> </tt>
<a name="L1101"></a><tt class="py-lineno">1101</tt>  <tt class="py-line">    <tt class="py-comment"># Place the internal structural object into the relax data store.</tt> </tt>
<a name="L1102"></a><tt class="py-lineno">1102</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1103"></a><tt class="py-lineno">1103</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-630" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-630', 'structure', 'link-48');">structure</a></tt> <tt class="py-op">=</tt> <tt id="link-631" class="py-name"><a title="lib.structure.internal.object.Internal" class="py-name" href="#" onclick="return doclink('link-631', 'Internal', 'link-63');">Internal</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1104"></a><tt class="py-lineno">1104</tt>  <tt class="py-line"> </tt>
<a name="L1105"></a><tt class="py-lineno">1105</tt>  <tt class="py-line">    <tt class="py-comment"># Load the structures.</tt> </tt>
<a name="L1106"></a><tt class="py-lineno">1106</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-632" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-632', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-633" class="py-name" targets="Method lib.structure.internal.object.Internal.load_pdb()=lib.structure.internal.object.Internal-class.html#load_pdb"><a title="lib.structure.internal.object.Internal.load_pdb" class="py-name" href="#" onclick="return doclink('link-633', 'load_pdb', 'link-633');">load_pdb</a></tt><tt class="py-op">(</tt><tt class="py-name">file_path</tt><tt class="py-op">,</tt> <tt class="py-name">read_mol</tt><tt class="py-op">=</tt><tt class="py-name">read_mol</tt><tt class="py-op">,</tt> <tt class="py-name">set_mol_name</tt><tt class="py-op">=</tt><tt class="py-name">set_mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">read_model</tt><tt class="py-op">=</tt><tt class="py-name">read_model</tt><tt class="py-op">,</tt> <tt class="py-name">set_model_num</tt><tt class="py-op">=</tt><tt class="py-name">set_model_num</tt><tt class="py-op">,</tt> <tt class="py-name">alt_loc</tt><tt class="py-op">=</tt><tt class="py-name">alt_loc</tt><tt class="py-op">,</tt> <tt id="link-634" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-634', 'verbosity', 'link-412');">verbosity</a></tt><tt class="py-op">=</tt><tt id="link-635" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-635', 'verbosity', 'link-412');">verbosity</a></tt><tt class="py-op">,</tt> <tt id="link-636" class="py-name" targets="Method lib.structure.internal.molecules.MolContainer.merge()=lib.structure.internal.molecules.MolContainer-class.html#merge"><a title="lib.structure.internal.molecules.MolContainer.merge" class="py-name" href="#" onclick="return doclink('link-636', 'merge', 'link-636');">merge</a></tt><tt class="py-op">=</tt><tt id="link-637" class="py-name"><a title="lib.structure.internal.molecules.MolContainer.merge" class="py-name" href="#" onclick="return doclink('link-637', 'merge', 'link-636');">merge</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1107"></a><tt class="py-lineno">1107</tt>  <tt class="py-line"> </tt>
<a name="L1108"></a><tt class="py-lineno">1108</tt>  <tt class="py-line">    <tt class="py-comment"># Load into Molmol (if running).</tt> </tt>
<a name="L1109"></a><tt class="py-lineno">1109</tt>  <tt class="py-line">    <tt id="link-638" class="py-name"><a title="pipe_control.molmol
specific_analyses.model_free.molmol
user_functions.molmol" class="py-name" href="#" onclick="return doclink('link-638', 'molmol', 'link-84');">molmol</a></tt><tt class="py-op">.</tt><tt id="link-639" class="py-name" targets="Variable pipe_control.molmol.molmol_obj=pipe_control.molmol-module.html#molmol_obj"><a title="pipe_control.molmol.molmol_obj" class="py-name" href="#" onclick="return doclink('link-639', 'molmol_obj', 'link-639');">molmol_obj</a></tt><tt class="py-op">.</tt><tt id="link-640" class="py-name" targets="Method pipe_control.molmol.Molmol.open_pdb()=pipe_control.molmol.Molmol-class.html#open_pdb,Method pipe_control.pymol_control.Pymol.open_pdb()=pipe_control.pymol_control.Pymol-class.html#open_pdb"><a title="pipe_control.molmol.Molmol.open_pdb
pipe_control.pymol_control.Pymol.open_pdb" class="py-name" href="#" onclick="return doclink('link-640', 'open_pdb', 'link-640');">open_pdb</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
</div><a name="L1110"></a><tt class="py-lineno">1110</tt>  <tt class="py-line"> </tt>
<a name="L1111"></a><tt class="py-lineno">1111</tt>  <tt class="py-line"> </tt>
<a name="read_xyz"></a><div id="read_xyz-def"><a name="L1112"></a><tt class="py-lineno">1112</tt> <a class="py-toggle" href="#" id="read_xyz-toggle" onclick="return toggle('read_xyz');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#read_xyz">read_xyz</a><tt class="py-op">(</tt><tt class="py-param">file</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">dir</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">read_mol</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">set_mol_name</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">read_model</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">set_model_num</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">verbosity</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-param">fail</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="read_xyz-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="read_xyz-expanded"><a name="L1113"></a><tt class="py-lineno">1113</tt>  <tt class="py-line">    <tt class="py-docstring">"""The XYZ loading function.</tt> </tt>
<a name="L1114"></a><tt class="py-lineno">1114</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1115"></a><tt class="py-lineno">1115</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1116"></a><tt class="py-lineno">1116</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword file:          The name of the XYZ file to read.</tt> </tt>
<a name="L1117"></a><tt class="py-lineno">1117</tt>  <tt class="py-line"><tt class="py-docstring">    @type file:             str</tt> </tt>
<a name="L1118"></a><tt class="py-lineno">1118</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword dir:           The directory where the XYZ file is located.  If set to None, then the</tt> </tt>
<a name="L1119"></a><tt class="py-lineno">1119</tt>  <tt class="py-line"><tt class="py-docstring">                            file will be searched for in the current directory.</tt> </tt>
<a name="L1120"></a><tt class="py-lineno">1120</tt>  <tt class="py-line"><tt class="py-docstring">    @type dir:              str or None</tt> </tt>
<a name="L1121"></a><tt class="py-lineno">1121</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword read_mol:      The molecule(s) to read from the file, independent of model.</tt> </tt>
<a name="L1122"></a><tt class="py-lineno">1122</tt>  <tt class="py-line"><tt class="py-docstring">                            If set to None, then all molecules will be loaded.</tt> </tt>
<a name="L1123"></a><tt class="py-lineno">1123</tt>  <tt class="py-line"><tt class="py-docstring">    @type read_mol:         None, int, or list of int</tt> </tt>
<a name="L1124"></a><tt class="py-lineno">1124</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword set_mol_name:  Set the names of the molecules which are loaded.  If set to None, then</tt> </tt>
<a name="L1125"></a><tt class="py-lineno">1125</tt>  <tt class="py-line"><tt class="py-docstring">                            the molecules will be automatically labelled based on the file name or</tt> </tt>
<a name="L1126"></a><tt class="py-lineno">1126</tt>  <tt class="py-line"><tt class="py-docstring">                            other information.</tt> </tt>
<a name="L1127"></a><tt class="py-lineno">1127</tt>  <tt class="py-line"><tt class="py-docstring">    @type set_mol_name:     None, str, or list of str</tt> </tt>
<a name="L1128"></a><tt class="py-lineno">1128</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword read_model:    The XYZ model to extract from the file.  If set to None, then all models</tt> </tt>
<a name="L1129"></a><tt class="py-lineno">1129</tt>  <tt class="py-line"><tt class="py-docstring">                            will be loaded.</tt> </tt>
<a name="L1130"></a><tt class="py-lineno">1130</tt>  <tt class="py-line"><tt class="py-docstring">    @type read_model:       None, int, or list of int</tt> </tt>
<a name="L1131"></a><tt class="py-lineno">1131</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword set_model_num: Set the model number of the loaded molecule.  If set to None, then the</tt> </tt>
<a name="L1132"></a><tt class="py-lineno">1132</tt>  <tt class="py-line"><tt class="py-docstring">                            XYZ model numbers will be preserved, if they exist.</tt> </tt>
<a name="L1133"></a><tt class="py-lineno">1133</tt>  <tt class="py-line"><tt class="py-docstring">    @type set_model_num:    None, int, or list of int</tt> </tt>
<a name="L1134"></a><tt class="py-lineno">1134</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword fail:          A flag which, if True, will cause a RelaxError to be raised if the XYZ </tt> </tt>
<a name="L1135"></a><tt class="py-lineno">1135</tt>  <tt class="py-line"><tt class="py-docstring">                            file does not exist.  If False, then a RelaxWarning will be trown</tt> </tt>
<a name="L1136"></a><tt class="py-lineno">1136</tt>  <tt class="py-line"><tt class="py-docstring">                            instead.</tt> </tt>
<a name="L1137"></a><tt class="py-lineno">1137</tt>  <tt class="py-line"><tt class="py-docstring">    @type fail:             bool</tt> </tt>
<a name="L1138"></a><tt class="py-lineno">1138</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword verbosity:     The amount of information to print to screen.  Zero corresponds to</tt> </tt>
<a name="L1139"></a><tt class="py-lineno">1139</tt>  <tt class="py-line"><tt class="py-docstring">                            minimal output while higher values increase the amount of output.  The</tt> </tt>
<a name="L1140"></a><tt class="py-lineno">1140</tt>  <tt class="py-line"><tt class="py-docstring">                            default value is 1.</tt> </tt>
<a name="L1141"></a><tt class="py-lineno">1141</tt>  <tt class="py-line"><tt class="py-docstring">    @type verbosity:        int</tt> </tt>
<a name="L1142"></a><tt class="py-lineno">1142</tt>  <tt class="py-line"><tt class="py-docstring">    @raise RelaxFileError:  If the fail flag is set, then a RelaxError is raised if the XYZ file</tt> </tt>
<a name="L1143"></a><tt class="py-lineno">1143</tt>  <tt class="py-line"><tt class="py-docstring">                            does not exist.</tt> </tt>
<a name="L1144"></a><tt class="py-lineno">1144</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L1145"></a><tt class="py-lineno">1145</tt>  <tt class="py-line"> </tt>
<a name="L1146"></a><tt class="py-lineno">1146</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L1147"></a><tt class="py-lineno">1147</tt>  <tt class="py-line">    <tt id="link-641" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-641', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1148"></a><tt class="py-lineno">1148</tt>  <tt class="py-line"> </tt>
<a name="L1149"></a><tt class="py-lineno">1149</tt>  <tt class="py-line">    <tt class="py-comment"># The file path.</tt> </tt>
<a name="L1150"></a><tt class="py-lineno">1150</tt>  <tt class="py-line">    <tt class="py-name">file_path</tt> <tt class="py-op">=</tt> <tt id="link-642" class="py-name"><a title="lib.io.get_file_path" class="py-name" href="#" onclick="return doclink('link-642', 'get_file_path', 'link-28');">get_file_path</a></tt><tt class="py-op">(</tt><tt id="link-643" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-643', 'file', 'link-266');">file</a></tt><tt class="py-op">,</tt> <tt id="link-644" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-644', 'dir', 'link-268');">dir</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1151"></a><tt class="py-lineno">1151</tt>  <tt class="py-line"> </tt>
<a name="L1152"></a><tt class="py-lineno">1152</tt>  <tt class="py-line">    <tt class="py-comment"># Try adding '.xyz' to the end of the file path, if the file can't be found.</tt> </tt>
<a name="L1153"></a><tt class="py-lineno">1153</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">access</tt><tt class="py-op">(</tt><tt class="py-name">file_path</tt><tt class="py-op">,</tt> <tt class="py-name">F_OK</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1154"></a><tt class="py-lineno">1154</tt>  <tt class="py-line">        <tt class="py-name">file_path_orig</tt> <tt class="py-op">=</tt> <tt class="py-name">file_path</tt> </tt>
<a name="L1155"></a><tt class="py-lineno">1155</tt>  <tt class="py-line">        <tt class="py-name">file_path</tt> <tt class="py-op">=</tt> <tt class="py-name">file_path</tt> <tt class="py-op">+</tt> <tt class="py-string">'.xyz'</tt> </tt>
<a name="L1156"></a><tt class="py-lineno">1156</tt>  <tt class="py-line"> </tt>
<a name="L1157"></a><tt class="py-lineno">1157</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the file exists.</tt> </tt>
<a name="L1158"></a><tt class="py-lineno">1158</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">access</tt><tt class="py-op">(</tt><tt class="py-name">file_path</tt><tt class="py-op">,</tt> <tt class="py-name">F_OK</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1159"></a><tt class="py-lineno">1159</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">fail</tt><tt class="py-op">:</tt> </tt>
<a name="L1160"></a><tt class="py-lineno">1160</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-645" class="py-name"><a title="lib.errors.RelaxFileError" class="py-name" href="#" onclick="return doclink('link-645', 'RelaxFileError', 'link-21');">RelaxFileError</a></tt><tt class="py-op">(</tt><tt class="py-string">'XYZ'</tt><tt class="py-op">,</tt> <tt class="py-name">file_path_orig</tt><tt class="py-op">)</tt> </tt>
<a name="L1161"></a><tt class="py-lineno">1161</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1162"></a><tt class="py-lineno">1162</tt>  <tt class="py-line">            <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-646" class="py-name"><a title="lib.warnings.RelaxNoPDBFileWarning" class="py-name" href="#" onclick="return doclink('link-646', 'RelaxNoPDBFileWarning', 'link-81');">RelaxNoPDBFileWarning</a></tt><tt class="py-op">(</tt><tt class="py-name">file_path</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1163"></a><tt class="py-lineno">1163</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
<a name="L1164"></a><tt class="py-lineno">1164</tt>  <tt class="py-line"> </tt>
<a name="L1165"></a><tt class="py-lineno">1165</tt>  <tt class="py-line">    <tt class="py-comment"># Place the  structural object into the relax data store.</tt> </tt>
<a name="L1166"></a><tt class="py-lineno">1166</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1167"></a><tt class="py-lineno">1167</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-647" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-647', 'structure', 'link-48');">structure</a></tt> <tt class="py-op">=</tt> <tt id="link-648" class="py-name"><a title="lib.structure.internal.object.Internal" class="py-name" href="#" onclick="return doclink('link-648', 'Internal', 'link-63');">Internal</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1168"></a><tt class="py-lineno">1168</tt>  <tt class="py-line"> </tt>
<a name="L1169"></a><tt class="py-lineno">1169</tt>  <tt class="py-line">    <tt class="py-comment"># Load the structures.</tt> </tt>
<a name="L1170"></a><tt class="py-lineno">1170</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-649" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-649', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-650" class="py-name" targets="Method lib.structure.internal.object.Internal.load_xyz()=lib.structure.internal.object.Internal-class.html#load_xyz"><a title="lib.structure.internal.object.Internal.load_xyz" class="py-name" href="#" onclick="return doclink('link-650', 'load_xyz', 'link-650');">load_xyz</a></tt><tt class="py-op">(</tt><tt class="py-name">file_path</tt><tt class="py-op">,</tt> <tt class="py-name">read_mol</tt><tt class="py-op">=</tt><tt class="py-name">read_mol</tt><tt class="py-op">,</tt> <tt class="py-name">set_mol_name</tt><tt class="py-op">=</tt><tt class="py-name">set_mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">read_model</tt><tt class="py-op">=</tt><tt class="py-name">read_model</tt><tt class="py-op">,</tt> <tt class="py-name">set_model_num</tt><tt class="py-op">=</tt><tt class="py-name">set_model_num</tt><tt class="py-op">,</tt> <tt id="link-651" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-651', 'verbosity', 'link-412');">verbosity</a></tt><tt class="py-op">=</tt><tt id="link-652" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-652', 'verbosity', 'link-412');">verbosity</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L1171"></a><tt class="py-lineno">1171</tt>  <tt class="py-line"> </tt>
<a name="L1172"></a><tt class="py-lineno">1172</tt>  <tt class="py-line"> </tt>
<a name="rmsd"></a><div id="rmsd-def"><a name="L1173"></a><tt class="py-lineno">1173</tt> <a class="py-toggle" href="#" id="rmsd-toggle" onclick="return toggle('rmsd');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#rmsd">rmsd</a><tt class="py-op">(</tt><tt class="py-param">pipes</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">models</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">molecules</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="rmsd-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="rmsd-expanded"><a name="L1174"></a><tt class="py-lineno">1174</tt>  <tt class="py-line">    <tt class="py-docstring">"""Calculate the RMSD between the loaded models.</tt> </tt>
<a name="L1175"></a><tt class="py-lineno">1175</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1176"></a><tt class="py-lineno">1176</tt>  <tt class="py-line"><tt class="py-docstring">    The RMSD value will be placed into the current data pipe cdp.structure.rmsd data structure.</tt> </tt>
<a name="L1177"></a><tt class="py-lineno">1177</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1178"></a><tt class="py-lineno">1178</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1179"></a><tt class="py-lineno">1179</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pipes:     The data pipes to determine the RMSD for.</tt> </tt>
<a name="L1180"></a><tt class="py-lineno">1180</tt>  <tt class="py-line"><tt class="py-docstring">    @type pipes:        None or list of str</tt> </tt>
<a name="L1181"></a><tt class="py-lineno">1181</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword models:    The list of models to determine the RMSD for.  The number of elements must match the pipes argument.  If set to None, then all models will be used.</tt> </tt>
<a name="L1182"></a><tt class="py-lineno">1182</tt>  <tt class="py-line"><tt class="py-docstring">    @type models:       None or list of lists of int</tt> </tt>
<a name="L1183"></a><tt class="py-lineno">1183</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword molecules: The list of molecules to determine the RMSD for.  The number of elements must match the pipes argument.</tt> </tt>
<a name="L1184"></a><tt class="py-lineno">1184</tt>  <tt class="py-line"><tt class="py-docstring">    @type molecules:    None or list of lists of str</tt> </tt>
<a name="L1185"></a><tt class="py-lineno">1185</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_id:   The atom identification string of the coordinates of interest.  This matches the spin ID string format.</tt> </tt>
<a name="L1186"></a><tt class="py-lineno">1186</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_id:      str or None</tt> </tt>
<a name="L1187"></a><tt class="py-lineno">1187</tt>  <tt class="py-line"><tt class="py-docstring">    @return:            The RMSD value.</tt> </tt>
<a name="L1188"></a><tt class="py-lineno">1188</tt>  <tt class="py-line"><tt class="py-docstring">    @rtype:             float</tt> </tt>
<a name="L1189"></a><tt class="py-lineno">1189</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L1190"></a><tt class="py-lineno">1190</tt>  <tt class="py-line"> </tt>
<a name="L1191"></a><tt class="py-lineno">1191</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L1192"></a><tt class="py-lineno">1192</tt>  <tt class="py-line">    <tt id="link-653" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-653', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1193"></a><tt class="py-lineno">1193</tt>  <tt class="py-line"> </tt>
<a name="L1194"></a><tt class="py-lineno">1194</tt>  <tt class="py-line">    <tt class="py-comment"># Assemble the structural coordinates.</tt> </tt>
<a name="L1195"></a><tt class="py-lineno">1195</tt>  <tt class="py-line">    <tt class="py-name">coord</tt><tt class="py-op">,</tt> <tt class="py-name">ids</tt><tt class="py-op">,</tt> <tt class="py-name">mol_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_nums</tt><tt class="py-op">,</tt> <tt class="py-name">atom_names</tt><tt class="py-op">,</tt> <tt id="link-654" class="py-name"><a title="gui.analyses.elements" class="py-name" href="#" onclick="return doclink('link-654', 'elements', 'link-142');">elements</a></tt> <tt class="py-op">=</tt> <tt id="link-655" class="py-name"><a title="pipe_control.structure.main.assemble_structural_coordinates" class="py-name" href="#" onclick="return doclink('link-655', 'assemble_structural_coordinates', 'link-213');">assemble_structural_coordinates</a></tt><tt class="py-op">(</tt><tt id="link-656" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-656', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">=</tt><tt id="link-657" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-657', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">,</tt> <tt id="link-658" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-658', 'models', 'link-137');">models</a></tt><tt class="py-op">=</tt><tt id="link-659" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-659', 'models', 'link-137');">models</a></tt><tt class="py-op">,</tt> <tt id="link-660" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-660', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">=</tt><tt id="link-661" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-661', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">,</tt> <tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">atom_id</tt><tt class="py-op">)</tt> </tt>
<a name="L1196"></a><tt class="py-lineno">1196</tt>  <tt class="py-line"> </tt>
<a name="L1197"></a><tt class="py-lineno">1197</tt>  <tt class="py-line">    <tt class="py-comment"># Calculate the RMSD.</tt> </tt>
<a name="L1198"></a><tt class="py-lineno">1198</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-662" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-662', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-663" class="py-name" targets="Function pipe_control.structure.main.rmsd()=pipe_control.structure.main-module.html#rmsd"><a title="pipe_control.structure.main.rmsd" class="py-name" href="#" onclick="return doclink('link-663', 'rmsd', 'link-663');">rmsd</a></tt> <tt class="py-op">=</tt> <tt id="link-664" class="py-name"><a title="lib.structure.statistics.atomic_rmsd" class="py-name" href="#" onclick="return doclink('link-664', 'atomic_rmsd', 'link-72');">atomic_rmsd</a></tt><tt class="py-op">(</tt><tt class="py-name">coord</tt><tt class="py-op">,</tt> <tt id="link-665" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-665', 'verbosity', 'link-412');">verbosity</a></tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L1199"></a><tt class="py-lineno">1199</tt>  <tt class="py-line"> </tt>
<a name="L1200"></a><tt class="py-lineno">1200</tt>  <tt class="py-line">    <tt class="py-comment"># Return the RMSD.</tt> </tt>
<a name="L1201"></a><tt class="py-lineno">1201</tt>  <tt class="py-line">    <tt class="py-keyword">return</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-666" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-666', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-667" class="py-name"><a title="pipe_control.structure.main.rmsd" class="py-name" href="#" onclick="return doclink('link-667', 'rmsd', 'link-663');">rmsd</a></tt> </tt>
</div><a name="L1202"></a><tt class="py-lineno">1202</tt>  <tt class="py-line"> </tt>
<a name="L1203"></a><tt class="py-lineno">1203</tt>  <tt class="py-line"> </tt>
<a name="rotate"></a><div id="rotate-def"><a name="L1204"></a><tt class="py-lineno">1204</tt> <a class="py-toggle" href="#" id="rotate-toggle" onclick="return toggle('rotate');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#rotate">rotate</a><tt class="py-op">(</tt><tt class="py-param">R</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">origin</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">model</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">pipe_name</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="rotate-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="rotate-expanded"><a name="L1205"></a><tt class="py-lineno">1205</tt>  <tt class="py-line">    <tt class="py-docstring">"""Rotate the structural data about the origin by the specified forwards rotation.</tt> </tt>
<a name="L1206"></a><tt class="py-lineno">1206</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1207"></a><tt class="py-lineno">1207</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword R:         The forwards rotation matrix.</tt> </tt>
<a name="L1208"></a><tt class="py-lineno">1208</tt>  <tt class="py-line"><tt class="py-docstring">    @type R:            numpy 3D, rank-2 array or a 3x3 list of floats</tt> </tt>
<a name="L1209"></a><tt class="py-lineno">1209</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword origin:    The origin of the rotation.  If not supplied, the origin will be set to [0, 0, 0].</tt> </tt>
<a name="L1210"></a><tt class="py-lineno">1210</tt>  <tt class="py-line"><tt class="py-docstring">    @type origin:       numpy 3D, rank-1 array or list of len 3 or None</tt> </tt>
<a name="L1211"></a><tt class="py-lineno">1211</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword model:     The model to rotate.  If None, all models will be rotated.</tt> </tt>
<a name="L1212"></a><tt class="py-lineno">1212</tt>  <tt class="py-line"><tt class="py-docstring">    @type model:        int</tt> </tt>
<a name="L1213"></a><tt class="py-lineno">1213</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_id:   The molecule, residue, and atom identifier string.  Only atoms matching this selection will be used.</tt> </tt>
<a name="L1214"></a><tt class="py-lineno">1214</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_id:      str or None</tt> </tt>
<a name="L1215"></a><tt class="py-lineno">1215</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pipe_name: The name of the data pipe containing the structures to translate.  This defaults to the current data pipe.</tt> </tt>
<a name="L1216"></a><tt class="py-lineno">1216</tt>  <tt class="py-line"><tt class="py-docstring">    @type pipe_name:    None or str</tt> </tt>
<a name="L1217"></a><tt class="py-lineno">1217</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L1218"></a><tt class="py-lineno">1218</tt>  <tt class="py-line"> </tt>
<a name="L1219"></a><tt class="py-lineno">1219</tt>  <tt class="py-line">    <tt class="py-comment"># Defaults.</tt> </tt>
<a name="L1220"></a><tt class="py-lineno">1220</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">pipe_name</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L1221"></a><tt class="py-lineno">1221</tt>  <tt class="py-line">        <tt class="py-name">pipe_name</tt> <tt class="py-op">=</tt> <tt id="link-668" class="py-name"><a title="pipe_control.pipes.cdp_name" class="py-name" href="#" onclick="return doclink('link-668', 'cdp_name', 'link-99');">cdp_name</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1222"></a><tt class="py-lineno">1222</tt>  <tt class="py-line"> </tt>
<a name="L1223"></a><tt class="py-lineno">1223</tt>  <tt class="py-line">    <tt class="py-comment"># Checks.</tt> </tt>
<a name="L1224"></a><tt class="py-lineno">1224</tt>  <tt class="py-line">    <tt id="link-669" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-669', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">(</tt><tt class="py-name">pipe_name</tt><tt class="py-op">)</tt> </tt>
<a name="L1225"></a><tt class="py-lineno">1225</tt>  <tt class="py-line">    <tt id="link-670" class="py-name"><a title="pipe_control.structure.checks.check_structure" class="py-name" href="#" onclick="return doclink('link-670', 'check_structure', 'link-105');">check_structure</a></tt><tt class="py-op">(</tt><tt class="py-name">pipe_name</tt><tt class="py-op">)</tt> </tt>
<a name="L1226"></a><tt class="py-lineno">1226</tt>  <tt class="py-line"> </tt>
<a name="L1227"></a><tt class="py-lineno">1227</tt>  <tt class="py-line">    <tt class="py-comment"># Get the data pipe.</tt> </tt>
<a name="L1228"></a><tt class="py-lineno">1228</tt>  <tt class="py-line">    <tt class="py-name">dp</tt> <tt class="py-op">=</tt> <tt id="link-671" class="py-name"><a title="pipe_control.pipes.get_pipe" class="py-name" href="#" onclick="return doclink('link-671', 'get_pipe', 'link-101');">get_pipe</a></tt><tt class="py-op">(</tt><tt class="py-name">pipe_name</tt><tt class="py-op">)</tt> </tt>
<a name="L1229"></a><tt class="py-lineno">1229</tt>  <tt class="py-line"> </tt>
<a name="L1230"></a><tt class="py-lineno">1230</tt>  <tt class="py-line">    <tt class="py-comment"># Set the origin if not supplied.</tt> </tt>
<a name="L1231"></a><tt class="py-lineno">1231</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">origin</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L1232"></a><tt class="py-lineno">1232</tt>  <tt class="py-line">        <tt class="py-name">origin</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L1233"></a><tt class="py-lineno">1233</tt>  <tt class="py-line"> </tt>
<a name="L1234"></a><tt class="py-lineno">1234</tt>  <tt class="py-line">    <tt class="py-comment"># Convert the args to numpy float data structures.</tt> </tt>
<a name="L1235"></a><tt class="py-lineno">1235</tt>  <tt class="py-line">    <tt id="link-672" class="py-name" targets="Variable lib.frame_order.rotor_axis.R=lib.frame_order.rotor_axis-module.html#R,Variable test_suite.unit_tests._lib._geometry.test_rotations.R=test_suite.unit_tests._lib._geometry.test_rotations-module.html#R"><a title="lib.frame_order.rotor_axis.R
test_suite.unit_tests._lib._geometry.test_rotations.R" class="py-name" href="#" onclick="return doclink('link-672', 'R', 'link-672');">R</a></tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt id="link-673" class="py-name"><a title="lib.frame_order.rotor_axis.R
test_suite.unit_tests._lib._geometry.test_rotations.R" class="py-name" href="#" onclick="return doclink('link-673', 'R', 'link-672');">R</a></tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L1236"></a><tt class="py-lineno">1236</tt>  <tt class="py-line">    <tt class="py-name">origin</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">origin</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L1237"></a><tt class="py-lineno">1237</tt>  <tt class="py-line"> </tt>
<a name="L1238"></a><tt class="py-lineno">1238</tt>  <tt class="py-line">    <tt class="py-comment"># Call the specific code.</tt> </tt>
<a name="L1239"></a><tt class="py-lineno">1239</tt>  <tt class="py-line">    <tt id="link-674" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-674', 'selection', 'link-36');">selection</a></tt> <tt class="py-op">=</tt> <tt class="py-name">dp</tt><tt class="py-op">.</tt><tt id="link-675" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-675', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-676" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-676', 'selection', 'link-36');">selection</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">atom_id</tt><tt class="py-op">)</tt> </tt>
<a name="L1240"></a><tt class="py-lineno">1240</tt>  <tt class="py-line">    <tt class="py-name">dp</tt><tt class="py-op">.</tt><tt id="link-677" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-677', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-678" class="py-name" targets="Method lib.structure.internal.object.Internal.rotate()=lib.structure.internal.object.Internal-class.html#rotate,Function pipe_control.structure.main.rotate()=pipe_control.structure.main-module.html#rotate"><a title="lib.structure.internal.object.Internal.rotate
pipe_control.structure.main.rotate" class="py-name" href="#" onclick="return doclink('link-678', 'rotate', 'link-678');">rotate</a></tt><tt class="py-op">(</tt><tt id="link-679" class="py-name"><a title="lib.frame_order.rotor_axis.R
test_suite.unit_tests._lib._geometry.test_rotations.R" class="py-name" href="#" onclick="return doclink('link-679', 'R', 'link-672');">R</a></tt><tt class="py-op">=</tt><tt id="link-680" class="py-name"><a title="lib.frame_order.rotor_axis.R
test_suite.unit_tests._lib._geometry.test_rotations.R" class="py-name" href="#" onclick="return doclink('link-680', 'R', 'link-672');">R</a></tt><tt class="py-op">,</tt> <tt class="py-name">origin</tt><tt class="py-op">=</tt><tt class="py-name">origin</tt><tt class="py-op">,</tt> <tt id="link-681" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-681', 'model', 'link-294');">model</a></tt><tt class="py-op">=</tt><tt id="link-682" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-682', 'model', 'link-294');">model</a></tt><tt class="py-op">,</tt> <tt id="link-683" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-683', 'selection', 'link-36');">selection</a></tt><tt class="py-op">=</tt><tt id="link-684" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-684', 'selection', 'link-36');">selection</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1241"></a><tt class="py-lineno">1241</tt>  <tt class="py-line"> </tt>
<a name="L1242"></a><tt class="py-lineno">1242</tt>  <tt class="py-line">    <tt class="py-comment"># Final printout.</tt> </tt>
<a name="L1243"></a><tt class="py-lineno">1243</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-685" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-685', 'model', 'link-294');">model</a></tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L1244"></a><tt class="py-lineno">1244</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Rotated %i atoms of model %i."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt id="link-686" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-686', 'selection', 'link-36');">selection</a></tt><tt class="py-op">.</tt><tt id="link-687" class="py-name" targets="Method lib.structure.internal.selection.Internal_selection.count_atoms()=lib.structure.internal.selection.Internal_selection-class.html#count_atoms"><a title="lib.structure.internal.selection.Internal_selection.count_atoms" class="py-name" href="#" onclick="return doclink('link-687', 'count_atoms', 'link-687');">count_atoms</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt id="link-688" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-688', 'model', 'link-294');">model</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1245"></a><tt class="py-lineno">1245</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1246"></a><tt class="py-lineno">1246</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Rotated %i atoms."</tt> <tt class="py-op">%</tt> <tt id="link-689" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-689', 'selection', 'link-36');">selection</a></tt><tt class="py-op">.</tt><tt id="link-690" class="py-name"><a title="lib.structure.internal.selection.Internal_selection.count_atoms" class="py-name" href="#" onclick="return doclink('link-690', 'count_atoms', 'link-687');">count_atoms</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
</div><a name="L1247"></a><tt class="py-lineno">1247</tt>  <tt class="py-line"> </tt>
<a name="L1248"></a><tt class="py-lineno">1248</tt>  <tt class="py-line"> </tt>
<a name="sequence_alignment"></a><div id="sequence_alignment-def"><a name="L1249"></a><tt class="py-lineno">1249</tt> <a class="py-toggle" href="#" id="sequence_alignment-toggle" onclick="return toggle('sequence_alignment');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#sequence_alignment">sequence_alignment</a><tt class="py-op">(</tt><tt class="py-param">pipes</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">models</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">molecules</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">msa_algorithm</tt><tt class="py-op">=</tt><tt class="py-string">'Central Star'</tt><tt class="py-op">,</tt> <tt class="py-param">pairwise_algorithm</tt><tt class="py-op">=</tt><tt class="py-string">'NW70'</tt><tt class="py-op">,</tt> <tt class="py-param">matrix</tt><tt class="py-op">=</tt><tt class="py-string">'BLOSUM62'</tt><tt class="py-op">,</tt> <tt class="py-param">gap_open_penalty</tt><tt class="py-op">=</tt><tt class="py-number">1.0</tt><tt class="py-op">,</tt> <tt class="py-param">gap_extend_penalty</tt><tt class="py-op">=</tt><tt class="py-number">1.0</tt><tt class="py-op">,</tt> <tt class="py-param">end_gap_open_penalty</tt><tt class="py-op">=</tt><tt class="py-number">0.0</tt><tt class="py-op">,</tt> <tt class="py-param">end_gap_extend_penalty</tt><tt class="py-op">=</tt><tt class="py-number">0.0</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="sequence_alignment-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="sequence_alignment-expanded"><a name="L1250"></a><tt class="py-lineno">1250</tt>  <tt class="py-line">    <tt class="py-docstring">"""Superimpose a set of related, but not identical structures.</tt> </tt>
<a name="L1251"></a><tt class="py-lineno">1251</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1252"></a><tt class="py-lineno">1252</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pipes:                     The data pipes to include in the alignment and superimposition.</tt> </tt>
<a name="L1253"></a><tt class="py-lineno">1253</tt>  <tt class="py-line"><tt class="py-docstring">    @type pipes:                        None or list of str</tt> </tt>
<a name="L1254"></a><tt class="py-lineno">1254</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword models:                    The list of models to for each data pipe superimpose.  The number of elements must match the pipes argument.  If set to None, then all models will be used.</tt> </tt>
<a name="L1255"></a><tt class="py-lineno">1255</tt>  <tt class="py-line"><tt class="py-docstring">    @type models:                       list of lists of int or None</tt> </tt>
<a name="L1256"></a><tt class="py-lineno">1256</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword molecules:                 The molecule names to include in the alignment and superimposition.  The number of elements must match the pipes argument.</tt> </tt>
<a name="L1257"></a><tt class="py-lineno">1257</tt>  <tt class="py-line"><tt class="py-docstring">    @type molecules:                    None or list of str</tt> </tt>
<a name="L1258"></a><tt class="py-lineno">1258</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword msa_algorithm:             The multiple sequence alignment (MSA) algorithm to use.</tt> </tt>
<a name="L1259"></a><tt class="py-lineno">1259</tt>  <tt class="py-line"><tt class="py-docstring">    @type msa_algorithm:                str</tt> </tt>
<a name="L1260"></a><tt class="py-lineno">1260</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pairwise_algorithm:        The pairwise sequence alignment algorithm to use.</tt> </tt>
<a name="L1261"></a><tt class="py-lineno">1261</tt>  <tt class="py-line"><tt class="py-docstring">    @type pairwise_algorithm:           str</tt> </tt>
<a name="L1262"></a><tt class="py-lineno">1262</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword matrix:                    The substitution matrix to use.</tt> </tt>
<a name="L1263"></a><tt class="py-lineno">1263</tt>  <tt class="py-line"><tt class="py-docstring">    @type matrix:                       str</tt> </tt>
<a name="L1264"></a><tt class="py-lineno">1264</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword gap_open_penalty:          The penalty for introducing gaps, as a positive number.</tt> </tt>
<a name="L1265"></a><tt class="py-lineno">1265</tt>  <tt class="py-line"><tt class="py-docstring">    @type gap_open_penalty:             float</tt> </tt>
<a name="L1266"></a><tt class="py-lineno">1266</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword gap_extend_penalty:        The penalty for extending a gap, as a positive number.</tt> </tt>
<a name="L1267"></a><tt class="py-lineno">1267</tt>  <tt class="py-line"><tt class="py-docstring">    @type gap_extend_penalty:           float</tt> </tt>
<a name="L1268"></a><tt class="py-lineno">1268</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword end_gap_open_penalty:      The optional penalty for opening a gap at the end of a sequence.</tt> </tt>
<a name="L1269"></a><tt class="py-lineno">1269</tt>  <tt class="py-line"><tt class="py-docstring">    @type end_gap_open_penalty:         float</tt> </tt>
<a name="L1270"></a><tt class="py-lineno">1270</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword end_gap_extend_penalty:    The optional penalty for extending a gap at the end of a sequence.</tt> </tt>
<a name="L1271"></a><tt class="py-lineno">1271</tt>  <tt class="py-line"><tt class="py-docstring">    @type end_gap_extend_penalty:       float</tt> </tt>
<a name="L1272"></a><tt class="py-lineno">1272</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L1273"></a><tt class="py-lineno">1273</tt>  <tt class="py-line"> </tt>
<a name="L1274"></a><tt class="py-lineno">1274</tt>  <tt class="py-line">    <tt class="py-comment"># Assemble the structural objects.</tt> </tt>
<a name="L1275"></a><tt class="py-lineno">1275</tt>  <tt class="py-line">    <tt id="link-691" class="py-name"><a title="lib.spectrum.objects
user_functions.objects" class="py-name" href="#" onclick="return doclink('link-691', 'objects', 'link-132');">objects</a></tt><tt class="py-op">,</tt> <tt class="py-name">object_names</tt><tt class="py-op">,</tt> <tt id="link-692" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-692', 'pipes', 'link-85');">pipes</a></tt> <tt class="py-op">=</tt> <tt id="link-693" class="py-name"><a title="pipe_control.structure.main.assemble_structural_objects" class="py-name" href="#" onclick="return doclink('link-693', 'assemble_structural_objects', 'link-134');">assemble_structural_objects</a></tt><tt class="py-op">(</tt><tt id="link-694" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-694', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">=</tt><tt id="link-695" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-695', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">,</tt> <tt id="link-696" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-696', 'models', 'link-137');">models</a></tt><tt class="py-op">=</tt><tt id="link-697" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-697', 'models', 'link-137');">models</a></tt><tt class="py-op">,</tt> <tt id="link-698" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-698', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">=</tt><tt id="link-699" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-699', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1276"></a><tt class="py-lineno">1276</tt>  <tt class="py-line"> </tt>
<a name="L1277"></a><tt class="py-lineno">1277</tt>  <tt class="py-line">    <tt class="py-comment"># Assemble the atomic coordinates of all molecules.</tt> </tt>
<a name="L1278"></a><tt class="py-lineno">1278</tt>  <tt class="py-line">    <tt class="py-name">ids</tt><tt class="py-op">,</tt> <tt class="py-name">object_id_list</tt><tt class="py-op">,</tt> <tt id="link-700" class="py-name"><a title="gui.analyses.elements.model_list
lib.structure.internal.object.Internal.model_list" class="py-name" href="#" onclick="return doclink('link-700', 'model_list', 'link-141');">model_list</a></tt><tt class="py-op">,</tt> <tt class="py-name">molecule_list</tt><tt class="py-op">,</tt> <tt class="py-name">atom_pos</tt><tt class="py-op">,</tt> <tt class="py-name">mol_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_nums</tt><tt class="py-op">,</tt> <tt class="py-name">atom_names</tt><tt class="py-op">,</tt> <tt id="link-701" class="py-name"><a title="gui.analyses.elements" class="py-name" href="#" onclick="return doclink('link-701', 'elements', 'link-142');">elements</a></tt><tt class="py-op">,</tt> <tt id="link-702" class="py-name"><a title="lib.structure.internal.object.Internal.one_letter_codes" class="py-name" href="#" onclick="return doclink('link-702', 'one_letter_codes', 'link-143');">one_letter_codes</a></tt><tt class="py-op">,</tt> <tt class="py-name">num_mols</tt> <tt class="py-op">=</tt> <tt id="link-703" class="py-name"><a title="lib.structure.internal.coordinates.assemble_atomic_coordinates" class="py-name" href="#" onclick="return doclink('link-703', 'assemble_atomic_coordinates', 'link-51');">assemble_atomic_coordinates</a></tt><tt class="py-op">(</tt><tt id="link-704" class="py-name"><a title="lib.spectrum.objects
user_functions.objects" class="py-name" href="#" onclick="return doclink('link-704', 'objects', 'link-132');">objects</a></tt><tt class="py-op">=</tt><tt id="link-705" class="py-name"><a title="lib.spectrum.objects
user_functions.objects" class="py-name" href="#" onclick="return doclink('link-705', 'objects', 'link-132');">objects</a></tt><tt class="py-op">,</tt> <tt class="py-name">object_names</tt><tt class="py-op">=</tt><tt class="py-name">object_names</tt><tt class="py-op">,</tt> <tt id="link-706" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-706', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">=</tt><tt id="link-707" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-707', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">,</tt> <tt id="link-708" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-708', 'models', 'link-137');">models</a></tt><tt class="py-op">=</tt><tt id="link-709" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-709', 'models', 'link-137');">models</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1279"></a><tt class="py-lineno">1279</tt>  <tt class="py-line"> </tt>
<a name="L1280"></a><tt class="py-lineno">1280</tt>  <tt class="py-line">    <tt class="py-comment"># Convert the residue number data structure.</tt> </tt>
<a name="L1281"></a><tt class="py-lineno">1281</tt>  <tt class="py-line">    <tt class="py-name">res_num_list</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L1282"></a><tt class="py-lineno">1282</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">mol_index</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">num_mols</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1283"></a><tt class="py-lineno">1283</tt>  <tt class="py-line">        <tt class="py-name">res_num_list</tt><tt class="py-op">.</tt><tt id="link-710" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-710', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1284"></a><tt class="py-lineno">1284</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-711" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-711', 'i', 'link-160');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-712" class="py-name"><a title="lib.structure.internal.object.Internal.one_letter_codes" class="py-name" href="#" onclick="return doclink('link-712', 'one_letter_codes', 'link-143');">one_letter_codes</a></tt><tt class="py-op">[</tt><tt class="py-name">mol_index</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1285"></a><tt class="py-lineno">1285</tt>  <tt class="py-line">            <tt class="py-name">key</tt> <tt class="py-op">=</tt> <tt id="link-713" class="py-name"><a title="lib.list" class="py-name" href="#" onclick="return doclink('link-713', 'list', 'link-171');">list</a></tt><tt class="py-op">(</tt><tt class="py-name">res_nums</tt><tt class="py-op">[</tt><tt class="py-name">mol_index</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt id="link-714" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-714', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">keys</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L1286"></a><tt class="py-lineno">1286</tt>  <tt class="py-line">            <tt class="py-name">res_num_list</tt><tt class="py-op">[</tt><tt class="py-name">mol_index</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-715" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-715', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">res_nums</tt><tt class="py-op">[</tt><tt class="py-name">mol_index</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt id="link-716" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-716', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-name">key</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1287"></a><tt class="py-lineno">1287</tt>  <tt class="py-line"> </tt>
<a name="L1288"></a><tt class="py-lineno">1288</tt>  <tt class="py-line">    <tt class="py-comment"># MSA.</tt> </tt>
<a name="L1289"></a><tt class="py-lineno">1289</tt>  <tt class="py-line">    <tt class="py-name">strings</tt><tt class="py-op">,</tt> <tt class="py-name">gaps</tt> <tt class="py-op">=</tt> <tt id="link-717" class="py-name"><a title="lib.sequence_alignment.msa.msa_general" class="py-name" href="#" onclick="return doclink('link-717', 'msa_general', 'link-44');">msa_general</a></tt><tt class="py-op">(</tt><tt id="link-718" class="py-name"><a title="lib.structure.internal.object.Internal.one_letter_codes" class="py-name" href="#" onclick="return doclink('link-718', 'one_letter_codes', 'link-143');">one_letter_codes</a></tt><tt class="py-op">,</tt> <tt class="py-name">residue_numbers</tt><tt class="py-op">=</tt><tt class="py-name">res_num_list</tt><tt class="py-op">,</tt> <tt class="py-name">msa_algorithm</tt><tt class="py-op">=</tt><tt class="py-name">msa_algorithm</tt><tt class="py-op">,</tt> <tt class="py-name">pairwise_algorithm</tt><tt class="py-op">=</tt><tt class="py-name">pairwise_algorithm</tt><tt class="py-op">,</tt> <tt class="py-name">matrix</tt><tt class="py-op">=</tt><tt class="py-name">matrix</tt><tt class="py-op">,</tt> <tt class="py-name">gap_open_penalty</tt><tt class="py-op">=</tt><tt class="py-name">gap_open_penalty</tt><tt class="py-op">,</tt> <tt class="py-name">gap_extend_penalty</tt><tt class="py-op">=</tt><tt class="py-name">gap_extend_penalty</tt><tt class="py-op">,</tt> <tt class="py-name">end_gap_open_penalty</tt><tt class="py-op">=</tt><tt class="py-name">end_gap_open_penalty</tt><tt class="py-op">,</tt> <tt class="py-name">end_gap_extend_penalty</tt><tt class="py-op">=</tt><tt class="py-name">end_gap_extend_penalty</tt><tt class="py-op">)</tt> </tt>
<a name="L1290"></a><tt class="py-lineno">1290</tt>  <tt class="py-line"> </tt>
<a name="L1291"></a><tt class="py-lineno">1291</tt>  <tt class="py-line">    <tt class="py-comment"># Set up the data store object.</tt> </tt>
<a name="L1292"></a><tt class="py-lineno">1292</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-719" class="py-name"><a title="auto_analyses.frame_order.ds
gui.analyses.auto_model_free.ds
gui.analyses.auto_noe.ds
gui.analyses.auto_relax_disp.ds
gui.analyses.auto_rx_base.ds
gui.analyses.ds
gui.components.free_file_format.ds
gui.components.grid.ds
gui.pipe_editor.ds
gui.relax_gui.ds
gui.results_viewer.ds
gui.wizards.wiz_objects.ds
pipe_control.bmrb.ds
pipe_control.pipes.ds
pipe_control.relax_data.ds
pipe_control.reset.ds
pipe_control.results.ds
pipe_control.state.ds
pipe_control.structure.main.ds
specific_analyses.api.ds
test_suite.gui_tests.base_classes.ds
test_suite.gui_tests.bmrb.ds
test_suite.gui_tests.bruker.ds
test_suite.gui_tests.model_free.ds
test_suite.gui_tests.noe.ds
test_suite.gui_tests.relax_disp.ds
test_suite.gui_tests.rx.ds
test_suite.gui_tests.state.ds
test_suite.system_tests.align_tensor.ds
test_suite.system_tests.angles.ds
test_suite.system_tests.base_classes.ds
test_suite.system_tests.bmrb.ds
test_suite.system_tests.bruker.ds
test_suite.system_tests.consistency_tests.ds
test_suite.system_tests.dasha.ds
test_suite.system_tests.diffusion_tensor.ds
test_suite.system_tests.frame_order.ds
test_suite.system_tests.generic.ds
test_suite.system_tests.interatomic.ds
test_suite.system_tests.jw_mapping.ds
test_suite.system_tests.load_spins.ds
test_suite.system_tests.model_elimination.ds
test_suite.system_tests.model_free.ds
test_suite.system_tests.model_selection.ds
test_suite.system_tests.mol_res_spin.ds
test_suite.system_tests.n_state_model.ds
test_suite.system_tests.noe.ds
test_suite.system_tests.noe_restraints.ds
test_suite.system_tests.palmer.ds
test_suite.system_tests.pcs.ds
test_suite.system_tests.peak_lists.ds
test_suite.system_tests.pipes.ds
test_suite.system_tests.rdc.ds
test_suite.system_tests.relax_disp.ds
test_suite.system_tests.relax_fit.ds
test_suite.system_tests.results.ds
test_suite.system_tests.sequence.ds
test_suite.system_tests.spectrum.ds
test_suite.system_tests.state.ds
test_suite.system_tests.structure.ds
test_suite.system_tests.unit_vectors.ds
test_suite.system_tests.value.ds
test_suite.unit_tests._data_store.test___init__.ds
test_suite.unit_tests._pipe_control._structure.test_internal.ds
test_suite.unit_tests._pipe_control.test_mol_res_spin.ds
test_suite.unit_tests._pipe_control.test_pipes.ds
test_suite.unit_tests._pipe_control.test_selection.ds
test_suite.unit_tests._specific_analyses._model_free.test_api.ds
test_suite.unit_tests._specific_analyses._relax_disp.test_data.ds
test_suite.unit_tests.align_tensor_testing_base.ds
test_suite.unit_tests.base_classes.ds
test_suite.unit_tests.diffusion_tensor_testing_base.ds
test_suite.unit_tests.minimisation_testing_base.ds
test_suite.unit_tests.model_free_testing_base.ds
test_suite.unit_tests.molecule_testing_base.ds
test_suite.unit_tests.n_state_model_testing_base.ds
test_suite.unit_tests.relax_data_testing_base.ds
test_suite.unit_tests.residue_testing_base.ds
test_suite.unit_tests.sequence_testing_base.ds
test_suite.unit_tests.spin_testing_base.ds
test_suite.unit_tests.state_testing_base.ds
test_suite.unit_tests.structure_testing_base.ds
test_suite.unit_tests.value_testing_base.ds" class="py-name" href="#" onclick="return doclink('link-719', 'ds', 'link-10');">ds</a></tt><tt class="py-op">,</tt> <tt class="py-string">'sequence_alignments'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1293"></a><tt class="py-lineno">1293</tt>  <tt class="py-line">        <tt id="link-720" class="py-name"><a title="auto_analyses.frame_order.ds
gui.analyses.auto_model_free.ds
gui.analyses.auto_noe.ds
gui.analyses.auto_relax_disp.ds
gui.analyses.auto_rx_base.ds
gui.analyses.ds
gui.components.free_file_format.ds
gui.components.grid.ds
gui.pipe_editor.ds
gui.relax_gui.ds
gui.results_viewer.ds
gui.wizards.wiz_objects.ds
pipe_control.bmrb.ds
pipe_control.pipes.ds
pipe_control.relax_data.ds
pipe_control.reset.ds
pipe_control.results.ds
pipe_control.state.ds
pipe_control.structure.main.ds
specific_analyses.api.ds
test_suite.gui_tests.base_classes.ds
test_suite.gui_tests.bmrb.ds
test_suite.gui_tests.bruker.ds
test_suite.gui_tests.model_free.ds
test_suite.gui_tests.noe.ds
test_suite.gui_tests.relax_disp.ds
test_suite.gui_tests.rx.ds
test_suite.gui_tests.state.ds
test_suite.system_tests.align_tensor.ds
test_suite.system_tests.angles.ds
test_suite.system_tests.base_classes.ds
test_suite.system_tests.bmrb.ds
test_suite.system_tests.bruker.ds
test_suite.system_tests.consistency_tests.ds
test_suite.system_tests.dasha.ds
test_suite.system_tests.diffusion_tensor.ds
test_suite.system_tests.frame_order.ds
test_suite.system_tests.generic.ds
test_suite.system_tests.interatomic.ds
test_suite.system_tests.jw_mapping.ds
test_suite.system_tests.load_spins.ds
test_suite.system_tests.model_elimination.ds
test_suite.system_tests.model_free.ds
test_suite.system_tests.model_selection.ds
test_suite.system_tests.mol_res_spin.ds
test_suite.system_tests.n_state_model.ds
test_suite.system_tests.noe.ds
test_suite.system_tests.noe_restraints.ds
test_suite.system_tests.palmer.ds
test_suite.system_tests.pcs.ds
test_suite.system_tests.peak_lists.ds
test_suite.system_tests.pipes.ds
test_suite.system_tests.rdc.ds
test_suite.system_tests.relax_disp.ds
test_suite.system_tests.relax_fit.ds
test_suite.system_tests.results.ds
test_suite.system_tests.sequence.ds
test_suite.system_tests.spectrum.ds
test_suite.system_tests.state.ds
test_suite.system_tests.structure.ds
test_suite.system_tests.unit_vectors.ds
test_suite.system_tests.value.ds
test_suite.unit_tests._data_store.test___init__.ds
test_suite.unit_tests._pipe_control._structure.test_internal.ds
test_suite.unit_tests._pipe_control.test_mol_res_spin.ds
test_suite.unit_tests._pipe_control.test_pipes.ds
test_suite.unit_tests._pipe_control.test_selection.ds
test_suite.unit_tests._specific_analyses._model_free.test_api.ds
test_suite.unit_tests._specific_analyses._relax_disp.test_data.ds
test_suite.unit_tests.align_tensor_testing_base.ds
test_suite.unit_tests.base_classes.ds
test_suite.unit_tests.diffusion_tensor_testing_base.ds
test_suite.unit_tests.minimisation_testing_base.ds
test_suite.unit_tests.model_free_testing_base.ds
test_suite.unit_tests.molecule_testing_base.ds
test_suite.unit_tests.n_state_model_testing_base.ds
test_suite.unit_tests.relax_data_testing_base.ds
test_suite.unit_tests.residue_testing_base.ds
test_suite.unit_tests.sequence_testing_base.ds
test_suite.unit_tests.spin_testing_base.ds
test_suite.unit_tests.state_testing_base.ds
test_suite.unit_tests.structure_testing_base.ds
test_suite.unit_tests.value_testing_base.ds" class="py-name" href="#" onclick="return doclink('link-720', 'ds', 'link-10');">ds</a></tt><tt class="py-op">.</tt><tt class="py-name">sequence_alignments</tt> <tt class="py-op">=</tt> <tt id="link-721" class="py-name"><a title="data_store.seq_align.Sequence_alignments" class="py-name" href="#" onclick="return doclink('link-721', 'Sequence_alignments', 'link-14');">Sequence_alignments</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1294"></a><tt class="py-lineno">1294</tt>  <tt class="py-line"> </tt>
<a name="L1295"></a><tt class="py-lineno">1295</tt>  <tt class="py-line">    <tt class="py-comment"># Set some unused arguments to None for storage.</tt> </tt>
<a name="L1296"></a><tt class="py-lineno">1296</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">msa_algorithm</tt> <tt class="py-op">==</tt> <tt class="py-string">'residue number'</tt><tt class="py-op">:</tt> </tt>
<a name="L1297"></a><tt class="py-lineno">1297</tt>  <tt class="py-line">        <tt class="py-name">pairwise_algorithm</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L1298"></a><tt class="py-lineno">1298</tt>  <tt class="py-line">        <tt class="py-name">matrix</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L1299"></a><tt class="py-lineno">1299</tt>  <tt class="py-line">        <tt class="py-name">gap_open_penalty</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L1300"></a><tt class="py-lineno">1300</tt>  <tt class="py-line">        <tt class="py-name">gap_extend_penalty</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L1301"></a><tt class="py-lineno">1301</tt>  <tt class="py-line">        <tt class="py-name">end_gap_open_penalty</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L1302"></a><tt class="py-lineno">1302</tt>  <tt class="py-line">        <tt class="py-name">end_gap_extend_penalty</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L1303"></a><tt class="py-lineno">1303</tt>  <tt class="py-line"> </tt>
<a name="L1304"></a><tt class="py-lineno">1304</tt>  <tt class="py-line">    <tt class="py-comment"># Store the alignment.</tt> </tt>
<a name="L1305"></a><tt class="py-lineno">1305</tt>  <tt class="py-line">    <tt id="link-722" class="py-name"><a title="auto_analyses.frame_order.ds
gui.analyses.auto_model_free.ds
gui.analyses.auto_noe.ds
gui.analyses.auto_relax_disp.ds
gui.analyses.auto_rx_base.ds
gui.analyses.ds
gui.components.free_file_format.ds
gui.components.grid.ds
gui.pipe_editor.ds
gui.relax_gui.ds
gui.results_viewer.ds
gui.wizards.wiz_objects.ds
pipe_control.bmrb.ds
pipe_control.pipes.ds
pipe_control.relax_data.ds
pipe_control.reset.ds
pipe_control.results.ds
pipe_control.state.ds
pipe_control.structure.main.ds
specific_analyses.api.ds
test_suite.gui_tests.base_classes.ds
test_suite.gui_tests.bmrb.ds
test_suite.gui_tests.bruker.ds
test_suite.gui_tests.model_free.ds
test_suite.gui_tests.noe.ds
test_suite.gui_tests.relax_disp.ds
test_suite.gui_tests.rx.ds
test_suite.gui_tests.state.ds
test_suite.system_tests.align_tensor.ds
test_suite.system_tests.angles.ds
test_suite.system_tests.base_classes.ds
test_suite.system_tests.bmrb.ds
test_suite.system_tests.bruker.ds
test_suite.system_tests.consistency_tests.ds
test_suite.system_tests.dasha.ds
test_suite.system_tests.diffusion_tensor.ds
test_suite.system_tests.frame_order.ds
test_suite.system_tests.generic.ds
test_suite.system_tests.interatomic.ds
test_suite.system_tests.jw_mapping.ds
test_suite.system_tests.load_spins.ds
test_suite.system_tests.model_elimination.ds
test_suite.system_tests.model_free.ds
test_suite.system_tests.model_selection.ds
test_suite.system_tests.mol_res_spin.ds
test_suite.system_tests.n_state_model.ds
test_suite.system_tests.noe.ds
test_suite.system_tests.noe_restraints.ds
test_suite.system_tests.palmer.ds
test_suite.system_tests.pcs.ds
test_suite.system_tests.peak_lists.ds
test_suite.system_tests.pipes.ds
test_suite.system_tests.rdc.ds
test_suite.system_tests.relax_disp.ds
test_suite.system_tests.relax_fit.ds
test_suite.system_tests.results.ds
test_suite.system_tests.sequence.ds
test_suite.system_tests.spectrum.ds
test_suite.system_tests.state.ds
test_suite.system_tests.structure.ds
test_suite.system_tests.unit_vectors.ds
test_suite.system_tests.value.ds
test_suite.unit_tests._data_store.test___init__.ds
test_suite.unit_tests._pipe_control._structure.test_internal.ds
test_suite.unit_tests._pipe_control.test_mol_res_spin.ds
test_suite.unit_tests._pipe_control.test_pipes.ds
test_suite.unit_tests._pipe_control.test_selection.ds
test_suite.unit_tests._specific_analyses._model_free.test_api.ds
test_suite.unit_tests._specific_analyses._relax_disp.test_data.ds
test_suite.unit_tests.align_tensor_testing_base.ds
test_suite.unit_tests.base_classes.ds
test_suite.unit_tests.diffusion_tensor_testing_base.ds
test_suite.unit_tests.minimisation_testing_base.ds
test_suite.unit_tests.model_free_testing_base.ds
test_suite.unit_tests.molecule_testing_base.ds
test_suite.unit_tests.n_state_model_testing_base.ds
test_suite.unit_tests.relax_data_testing_base.ds
test_suite.unit_tests.residue_testing_base.ds
test_suite.unit_tests.sequence_testing_base.ds
test_suite.unit_tests.spin_testing_base.ds
test_suite.unit_tests.state_testing_base.ds
test_suite.unit_tests.structure_testing_base.ds
test_suite.unit_tests.value_testing_base.ds" class="py-name" href="#" onclick="return doclink('link-722', 'ds', 'link-10');">ds</a></tt><tt class="py-op">.</tt><tt class="py-name">sequence_alignments</tt><tt class="py-op">.</tt><tt id="link-723" class="py-name" targets="Method bmrblib.base_classes.BaseSaveframe.add()=bmrblib.base_classes.BaseSaveframe-class.html#add,Method bmrblib.base_classes.MissingSaveframe.add()=bmrblib.base_classes.MissingSaveframe-class.html#add,Method bmrblib.base_classes.TagTranslationTable.add()=bmrblib.base_classes.TagTranslationTable-class.html#add,Method bmrblib.kinetics.relaxation.Relaxation_v2_1.add()=bmrblib.kinetics.relaxation.Relaxation_v2_1-class.html#add,Method bmrblib.kinetics.relaxation.Relaxation_v3_1.add()=bmrblib.kinetics.relaxation.Relaxation_v3_1-class.html#add,Method data_store.Relax_data_store.add()=data_store.Relax_data_store-class.html#add,Method data_store.gui.Analyses.add()=data_store.gui.Analyses-class.html#add,Method data_store.seq_align.Sequence_alignments.add()=data_store.seq_align.Sequence_alignments-class.html#add,Method lib.spectrum.objects.Peak_list.add()=lib.spectrum.objects.Peak_list-class.html#add,Method multi.slave_commands.Slave_storage_command.add()=multi.slave_commands.Slave_storage_command-class.html#add"><a title="bmrblib.base_classes.BaseSaveframe.add
bmrblib.base_classes.MissingSaveframe.add
bmrblib.base_classes.TagTranslationTable.add
bmrblib.kinetics.relaxation.Relaxation_v2_1.add
bmrblib.kinetics.relaxation.Relaxation_v3_1.add
data_store.Relax_data_store.add
data_store.gui.Analyses.add
data_store.seq_align.Sequence_alignments.add
lib.spectrum.objects.Peak_list.add
multi.slave_commands.Slave_storage_command.add" class="py-name" href="#" onclick="return doclink('link-723', 'add', 'link-723');">add</a></tt><tt class="py-op">(</tt><tt class="py-name">object_ids</tt><tt class="py-op">=</tt><tt class="py-name">object_id_list</tt><tt class="py-op">,</tt> <tt id="link-724" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-724', 'models', 'link-137');">models</a></tt><tt class="py-op">=</tt><tt id="link-725" class="py-name"><a title="gui.analyses.elements.model_list
lib.structure.internal.object.Internal.model_list" class="py-name" href="#" onclick="return doclink('link-725', 'model_list', 'link-141');">model_list</a></tt><tt class="py-op">,</tt> <tt id="link-726" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-726', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">=</tt><tt class="py-name">molecule_list</tt><tt class="py-op">,</tt> <tt class="py-name">sequences</tt><tt class="py-op">=</tt><tt id="link-727" class="py-name"><a title="lib.structure.internal.object.Internal.one_letter_codes" class="py-name" href="#" onclick="return doclink('link-727', 'one_letter_codes', 'link-143');">one_letter_codes</a></tt><tt class="py-op">,</tt> <tt class="py-name">strings</tt><tt class="py-op">=</tt><tt class="py-name">strings</tt><tt class="py-op">,</tt> <tt class="py-name">gaps</tt><tt class="py-op">=</tt><tt class="py-name">gaps</tt><tt class="py-op">,</tt> <tt class="py-name">msa_algorithm</tt><tt class="py-op">=</tt><tt class="py-name">msa_algorithm</tt><tt class="py-op">,</tt> <tt class="py-name">pairwise_algorithm</tt><tt class="py-op">=</tt><tt class="py-name">pairwise_algorithm</tt><tt class="py-op">,</tt> <tt class="py-name">matrix</tt><tt class="py-op">=</tt><tt class="py-name">matrix</tt><tt class="py-op">,</tt> <tt class="py-name">gap_open_penalty</tt><tt class="py-op">=</tt><tt class="py-name">gap_open_penalty</tt><tt class="py-op">,</tt> <tt class="py-name">gap_extend_penalty</tt><tt class="py-op">=</tt><tt class="py-name">gap_extend_penalty</tt><tt class="py-op">,</tt> <tt class="py-name">end_gap_open_penalty</tt><tt class="py-op">=</tt><tt class="py-name">end_gap_open_penalty</tt><tt class="py-op">,</tt> <tt class="py-name">end_gap_extend_penalty</tt><tt class="py-op">=</tt><tt class="py-name">end_gap_extend_penalty</tt><tt class="py-op">)</tt> </tt>
</div><a name="L1306"></a><tt class="py-lineno">1306</tt>  <tt class="py-line"> </tt>
<a name="L1307"></a><tt class="py-lineno">1307</tt>  <tt class="py-line"> </tt>
<a name="set_vector"></a><div id="set_vector-def"><a name="L1308"></a><tt class="py-lineno">1308</tt> <a class="py-toggle" href="#" id="set_vector-toggle" onclick="return toggle('set_vector');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#set_vector">set_vector</a><tt class="py-op">(</tt><tt class="py-param">spin</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">xh_vect</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="set_vector-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="set_vector-expanded"><a name="L1309"></a><tt class="py-lineno">1309</tt>  <tt class="py-line">    <tt class="py-docstring">"""Place the XH unit vector into the spin container object.</tt> </tt>
<a name="L1310"></a><tt class="py-lineno">1310</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1311"></a><tt class="py-lineno">1311</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword spin:      The spin container object.</tt> </tt>
<a name="L1312"></a><tt class="py-lineno">1312</tt>  <tt class="py-line"><tt class="py-docstring">    @type spin:         SpinContainer instance</tt> </tt>
<a name="L1313"></a><tt class="py-lineno">1313</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword xh_vect:   The unit vector parallel to the XH bond.</tt> </tt>
<a name="L1314"></a><tt class="py-lineno">1314</tt>  <tt class="py-line"><tt class="py-docstring">    @type xh_vect:      array of len 3</tt> </tt>
<a name="L1315"></a><tt class="py-lineno">1315</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L1316"></a><tt class="py-lineno">1316</tt>  <tt class="py-line"> </tt>
<a name="L1317"></a><tt class="py-lineno">1317</tt>  <tt class="py-line">    <tt class="py-comment"># Place the XH unit vector into the container.</tt> </tt>
<a name="L1318"></a><tt class="py-lineno">1318</tt>  <tt class="py-line">    <tt id="link-728" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-728', 'spin', 'link-427');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">xh_vect</tt> <tt class="py-op">=</tt> <tt class="py-name">xh_vect</tt> </tt>
</div><a name="L1319"></a><tt class="py-lineno">1319</tt>  <tt class="py-line"> </tt>
<a name="L1320"></a><tt class="py-lineno">1320</tt>  <tt class="py-line"> </tt>
<a name="structure_loop"></a><div id="structure_loop-def"><a name="L1321"></a><tt class="py-lineno">1321</tt> <a class="py-toggle" href="#" id="structure_loop-toggle" onclick="return toggle('structure_loop');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#structure_loop">structure_loop</a><tt class="py-op">(</tt><tt class="py-param">pipes</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">molecules</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">models</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="structure_loop-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="structure_loop-expanded"><a name="L1322"></a><tt class="py-lineno">1322</tt>  <tt class="py-line">    <tt class="py-docstring">"""Generator function for looping over all internal structural objects, models and molecules.</tt> </tt>
<a name="L1323"></a><tt class="py-lineno">1323</tt>  <tt class="py-line"><tt class="py-docstring"> </tt> </tt>
<a name="L1324"></a><tt class="py-lineno">1324</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pipes:         The data pipes to loop over.</tt> </tt>
<a name="L1325"></a><tt class="py-lineno">1325</tt>  <tt class="py-line"><tt class="py-docstring">    @type pipes:            None or list of str</tt> </tt>
<a name="L1326"></a><tt class="py-lineno">1326</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword models:        The list of models for each data pipe.  The number of elements must match the pipes argument.  If set to None, then all models will be used.</tt> </tt>
<a name="L1327"></a><tt class="py-lineno">1327</tt>  <tt class="py-line"><tt class="py-docstring">    @type models:           None or list of lists of int</tt> </tt>
<a name="L1328"></a><tt class="py-lineno">1328</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword molecules:     The list of molecules for each data pipe.  The number of elements must match the pipes argument.</tt> </tt>
<a name="L1329"></a><tt class="py-lineno">1329</tt>  <tt class="py-line"><tt class="py-docstring">    @type molecules:        None or list of lists of str</tt> </tt>
<a name="L1330"></a><tt class="py-lineno">1330</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_id:       The molecule, residue, and atom identifier string of the coordinates of interest.  This matches the spin ID string format.</tt> </tt>
<a name="L1331"></a><tt class="py-lineno">1331</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_id:          None or str</tt> </tt>
<a name="L1332"></a><tt class="py-lineno">1332</tt>  <tt class="py-line"><tt class="py-docstring">    @return:                The data pipe index, model number, and molecule name.</tt> </tt>
<a name="L1333"></a><tt class="py-lineno">1333</tt>  <tt class="py-line"><tt class="py-docstring">    @rtype:                 int, int or None, str</tt> </tt>
<a name="L1334"></a><tt class="py-lineno">1334</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L1335"></a><tt class="py-lineno">1335</tt>  <tt class="py-line"> </tt>
<a name="L1336"></a><tt class="py-lineno">1336</tt>  <tt class="py-line">    <tt class="py-comment"># The data pipes to use.</tt> </tt>
<a name="L1337"></a><tt class="py-lineno">1337</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-729" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-729', 'pipes', 'link-85');">pipes</a></tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L1338"></a><tt class="py-lineno">1338</tt>  <tt class="py-line">        <tt id="link-730" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-730', 'pipes', 'link-85');">pipes</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt id="link-731" class="py-name"><a title="pipe_control.pipes.cdp_name" class="py-name" href="#" onclick="return doclink('link-731', 'cdp_name', 'link-99');">cdp_name</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">]</tt> </tt>
<a name="L1339"></a><tt class="py-lineno">1339</tt>  <tt class="py-line">    <tt class="py-name">num_pipes</tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-732" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-732', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1340"></a><tt class="py-lineno">1340</tt>  <tt class="py-line"> </tt>
<a name="L1341"></a><tt class="py-lineno">1341</tt>  <tt class="py-line">    <tt class="py-comment"># Checks.</tt> </tt>
<a name="L1342"></a><tt class="py-lineno">1342</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-733" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-733', 'pipe', 'link-186');">pipe</a></tt> <tt class="py-keyword">in</tt> <tt id="link-734" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-734', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1343"></a><tt class="py-lineno">1343</tt>  <tt class="py-line">        <tt id="link-735" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-735', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">(</tt><tt id="link-736" class="py-name"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-736', 'pipe', 'link-186');">pipe</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1344"></a><tt class="py-lineno">1344</tt>  <tt class="py-line"> </tt>
<a name="L1345"></a><tt class="py-lineno">1345</tt>  <tt class="py-line">    <tt class="py-comment"># Check the models and molecules arguments.</tt> </tt>
<a name="L1346"></a><tt class="py-lineno">1346</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-737" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-737', 'models', 'link-137');">models</a></tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L1347"></a><tt class="py-lineno">1347</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-738" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-738', 'models', 'link-137');">models</a></tt><tt class="py-op">)</tt> <tt class="py-op">!=</tt> <tt class="py-name">num_pipes</tt><tt class="py-op">:</tt> </tt>
<a name="L1348"></a><tt class="py-lineno">1348</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-739" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-739', 'RelaxError', 'link-20');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The %i elements of the models argument does not match the %i data pipes."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-740" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-740', 'models', 'link-137');">models</a></tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">num_pipes</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1349"></a><tt class="py-lineno">1349</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-741" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-741', 'molecules', 'link-139');">molecules</a></tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L1350"></a><tt class="py-lineno">1350</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-742" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-742', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">)</tt> <tt class="py-op">!=</tt> <tt class="py-name">num_pipes</tt><tt class="py-op">:</tt> </tt>
<a name="L1351"></a><tt class="py-lineno">1351</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-743" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-743', 'RelaxError', 'link-20');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The %i elements of the molecules argument does not match the %i data pipes."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-744" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-744', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">num_pipes</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1352"></a><tt class="py-lineno">1352</tt>  <tt class="py-line"> </tt>
<a name="L1353"></a><tt class="py-lineno">1353</tt>  <tt class="py-line">    <tt class="py-comment"># Assemble the structural objects.</tt> </tt>
<a name="L1354"></a><tt class="py-lineno">1354</tt>  <tt class="py-line">    <tt id="link-745" class="py-name"><a title="lib.spectrum.objects
user_functions.objects" class="py-name" href="#" onclick="return doclink('link-745', 'objects', 'link-132');">objects</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L1355"></a><tt class="py-lineno">1355</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">pipe_index</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-746" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-746', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1356"></a><tt class="py-lineno">1356</tt>  <tt class="py-line">        <tt class="py-name">dp</tt> <tt class="py-op">=</tt> <tt id="link-747" class="py-name"><a title="pipe_control.pipes.get_pipe" class="py-name" href="#" onclick="return doclink('link-747', 'get_pipe', 'link-101');">get_pipe</a></tt><tt class="py-op">(</tt><tt id="link-748" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-748', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">[</tt><tt class="py-name">pipe_index</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1357"></a><tt class="py-lineno">1357</tt>  <tt class="py-line">        <tt id="link-749" class="py-name"><a title="lib.spectrum.objects
user_functions.objects" class="py-name" href="#" onclick="return doclink('link-749', 'objects', 'link-132');">objects</a></tt><tt class="py-op">.</tt><tt id="link-750" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-750', 'append', 'link-164');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">dp</tt><tt class="py-op">.</tt><tt id="link-751" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-751', 'structure', 'link-48');">structure</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1358"></a><tt class="py-lineno">1358</tt>  <tt class="py-line"> </tt>
<a name="L1359"></a><tt class="py-lineno">1359</tt>  <tt class="py-line">    <tt class="py-comment"># Call the library method to do all of the work.</tt> </tt>
<a name="L1360"></a><tt class="py-lineno">1360</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">pipe_index</tt><tt class="py-op">,</tt> <tt class="py-name">model_num</tt><tt class="py-op">,</tt> <tt class="py-name">mol_name</tt> <tt class="py-keyword">in</tt> <tt id="link-752" class="py-name"><a title="lib.structure.internal.coordinates.loop_coord_structures" class="py-name" href="#" onclick="return doclink('link-752', 'loop_coord_structures', 'link-53');">loop_coord_structures</a></tt><tt class="py-op">(</tt><tt id="link-753" class="py-name"><a title="lib.spectrum.objects
user_functions.objects" class="py-name" href="#" onclick="return doclink('link-753', 'objects', 'link-132');">objects</a></tt><tt class="py-op">=</tt><tt id="link-754" class="py-name"><a title="lib.spectrum.objects
user_functions.objects" class="py-name" href="#" onclick="return doclink('link-754', 'objects', 'link-132');">objects</a></tt><tt class="py-op">,</tt> <tt id="link-755" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-755', 'models', 'link-137');">models</a></tt><tt class="py-op">=</tt><tt id="link-756" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-756', 'models', 'link-137');">models</a></tt><tt class="py-op">,</tt> <tt id="link-757" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-757', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">=</tt><tt id="link-758" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-758', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">,</tt> <tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">atom_id</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1361"></a><tt class="py-lineno">1361</tt>  <tt class="py-line">        <tt class="py-keyword">yield</tt> <tt class="py-name">pipe_index</tt><tt class="py-op">,</tt> <tt class="py-name">model_num</tt><tt class="py-op">,</tt> <tt class="py-name">mol_name</tt> </tt>
</div><a name="L1362"></a><tt class="py-lineno">1362</tt>  <tt class="py-line"> </tt>
<a name="L1363"></a><tt class="py-lineno">1363</tt>  <tt class="py-line"> </tt>
<a name="superimpose"></a><div id="superimpose-def"><a name="L1364"></a><tt class="py-lineno">1364</tt> <a class="py-toggle" href="#" id="superimpose-toggle" onclick="return toggle('superimpose');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#superimpose">superimpose</a><tt class="py-op">(</tt><tt class="py-param">pipes</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">models</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">molecules</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">displace_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">method</tt><tt class="py-op">=</tt><tt class="py-string">'fit to mean'</tt><tt class="py-op">,</tt> <tt class="py-param">centre_type</tt><tt class="py-op">=</tt><tt class="py-string">"centroid"</tt><tt class="py-op">,</tt> <tt class="py-param">centroid</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="superimpose-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="superimpose-expanded"><a name="L1365"></a><tt class="py-lineno">1365</tt>  <tt class="py-line">    <tt class="py-docstring">"""Superimpose a set of structures.</tt> </tt>
<a name="L1366"></a><tt class="py-lineno">1366</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1367"></a><tt class="py-lineno">1367</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pipes:         The data pipes to include in the alignment and superimposition.</tt> </tt>
<a name="L1368"></a><tt class="py-lineno">1368</tt>  <tt class="py-line"><tt class="py-docstring">    @type pipes:            None or list of str</tt> </tt>
<a name="L1369"></a><tt class="py-lineno">1369</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword models:        The list of models to for each data pipe superimpose.  The number of elements must match the pipes argument.  If set to None, then all models will be used.</tt> </tt>
<a name="L1370"></a><tt class="py-lineno">1370</tt>  <tt class="py-line"><tt class="py-docstring">    @type models:           list of lists of int or None</tt> </tt>
<a name="L1371"></a><tt class="py-lineno">1371</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword molecules:     The molecule names to include in the alignment and superimposition.  The number of elements must match the pipes argument.</tt> </tt>
<a name="L1372"></a><tt class="py-lineno">1372</tt>  <tt class="py-line"><tt class="py-docstring">    @type molecules:        None or list of str</tt> </tt>
<a name="L1373"></a><tt class="py-lineno">1373</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_id:       The molecule, residue, and atom identifier string.  This matches the spin ID string format.</tt> </tt>
<a name="L1374"></a><tt class="py-lineno">1374</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_id:          str or None</tt> </tt>
<a name="L1375"></a><tt class="py-lineno">1375</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword displace_id:   The atom ID string for restricting the displacement to a subset of all atoms.  If not set, then all atoms will be translated and rotated.  This can be a list of atom IDs with each element corresponding to one of the structures.</tt> </tt>
<a name="L1376"></a><tt class="py-lineno">1376</tt>  <tt class="py-line"><tt class="py-docstring">    @type displace_id:      None, str, or list of str</tt> </tt>
<a name="L1377"></a><tt class="py-lineno">1377</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword method:        The superimposition method.  It must be one of 'fit to mean' or 'fit to first'.</tt> </tt>
<a name="L1378"></a><tt class="py-lineno">1378</tt>  <tt class="py-line"><tt class="py-docstring">    @type method:           str</tt> </tt>
<a name="L1379"></a><tt class="py-lineno">1379</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword centre_type:   The type of centre to superimpose over.  This can either be the standard centroid superimposition or the CoM could be used instead.</tt> </tt>
<a name="L1380"></a><tt class="py-lineno">1380</tt>  <tt class="py-line"><tt class="py-docstring">    @type centre_type:      str</tt> </tt>
<a name="L1381"></a><tt class="py-lineno">1381</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword centroid:      An alternative position of the centroid to allow for different superpositions, for example of pivot point motions.</tt> </tt>
<a name="L1382"></a><tt class="py-lineno">1382</tt>  <tt class="py-line"><tt class="py-docstring">    @type centroid:         list of float or numpy rank-1, 3D array</tt> </tt>
<a name="L1383"></a><tt class="py-lineno">1383</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L1384"></a><tt class="py-lineno">1384</tt>  <tt class="py-line"> </tt>
<a name="L1385"></a><tt class="py-lineno">1385</tt>  <tt class="py-line">    <tt class="py-comment"># Check the method.</tt> </tt>
<a name="L1386"></a><tt class="py-lineno">1386</tt>  <tt class="py-line">    <tt class="py-name">allowed</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-string">'fit to mean'</tt><tt class="py-op">,</tt> <tt class="py-string">'fit to first'</tt><tt class="py-op">]</tt> </tt>
<a name="L1387"></a><tt class="py-lineno">1387</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-759" class="py-name" targets="Module bmrblib.experimental_details.method=bmrblib.experimental_details.method-module.html"><a title="bmrblib.experimental_details.method" class="py-name" href="#" onclick="return doclink('link-759', 'method', 'link-759');">method</a></tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt class="py-name">allowed</tt><tt class="py-op">:</tt> </tt>
<a name="L1388"></a><tt class="py-lineno">1388</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-760" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-760', 'RelaxError', 'link-20');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The superimposition method '%s' is unknown.  It must be one of %s."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt id="link-761" class="py-name"><a title="bmrblib.experimental_details.method" class="py-name" href="#" onclick="return doclink('link-761', 'method', 'link-759');">method</a></tt><tt class="py-op">,</tt> <tt class="py-name">allowed</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1389"></a><tt class="py-lineno">1389</tt>  <tt class="py-line"> </tt>
<a name="L1390"></a><tt class="py-lineno">1390</tt>  <tt class="py-line">    <tt class="py-comment"># Check the type.</tt> </tt>
<a name="L1391"></a><tt class="py-lineno">1391</tt>  <tt class="py-line">    <tt class="py-name">allowed</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-string">'centroid'</tt><tt class="py-op">,</tt> <tt class="py-string">'CoM'</tt><tt class="py-op">]</tt> </tt>
<a name="L1392"></a><tt class="py-lineno">1392</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">centre_type</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt class="py-name">allowed</tt><tt class="py-op">:</tt> </tt>
<a name="L1393"></a><tt class="py-lineno">1393</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-762" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-762', 'RelaxError', 'link-20');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The superimposition centre type '%s' is unknown.  It must be one of %s."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-name">centre_type</tt><tt class="py-op">,</tt> <tt class="py-name">allowed</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1394"></a><tt class="py-lineno">1394</tt>  <tt class="py-line"> </tt>
<a name="L1395"></a><tt class="py-lineno">1395</tt>  <tt class="py-line">    <tt class="py-comment"># The data pipes to use.</tt> </tt>
<a name="L1396"></a><tt class="py-lineno">1396</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-763" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-763', 'pipes', 'link-85');">pipes</a></tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L1397"></a><tt class="py-lineno">1397</tt>  <tt class="py-line">        <tt id="link-764" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-764', 'pipes', 'link-85');">pipes</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt id="link-765" class="py-name"><a title="pipe_control.pipes.cdp_name" class="py-name" href="#" onclick="return doclink('link-765', 'cdp_name', 'link-99');">cdp_name</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">]</tt> </tt>
<a name="L1398"></a><tt class="py-lineno">1398</tt>  <tt class="py-line"> </tt>
<a name="L1399"></a><tt class="py-lineno">1399</tt>  <tt class="py-line">    <tt class="py-comment"># Assemble the structural coordinates.</tt> </tt>
<a name="L1400"></a><tt class="py-lineno">1400</tt>  <tt class="py-line">    <tt class="py-name">coord</tt><tt class="py-op">,</tt> <tt class="py-name">ids</tt><tt class="py-op">,</tt> <tt class="py-name">mol_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_nums</tt><tt class="py-op">,</tt> <tt class="py-name">atom_names</tt><tt class="py-op">,</tt> <tt id="link-766" class="py-name"><a title="gui.analyses.elements" class="py-name" href="#" onclick="return doclink('link-766', 'elements', 'link-142');">elements</a></tt> <tt class="py-op">=</tt> <tt id="link-767" class="py-name"><a title="pipe_control.structure.main.assemble_structural_coordinates" class="py-name" href="#" onclick="return doclink('link-767', 'assemble_structural_coordinates', 'link-213');">assemble_structural_coordinates</a></tt><tt class="py-op">(</tt><tt id="link-768" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-768', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">=</tt><tt id="link-769" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-769', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">,</tt> <tt id="link-770" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-770', 'models', 'link-137');">models</a></tt><tt class="py-op">=</tt><tt id="link-771" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-771', 'models', 'link-137');">models</a></tt><tt class="py-op">,</tt> <tt id="link-772" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-772', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">=</tt><tt id="link-773" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-773', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">,</tt> <tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">atom_id</tt><tt class="py-op">)</tt> </tt>
<a name="L1401"></a><tt class="py-lineno">1401</tt>  <tt class="py-line"> </tt>
<a name="L1402"></a><tt class="py-lineno">1402</tt>  <tt class="py-line">    <tt class="py-comment"># Catch missing data.</tt> </tt>
<a name="L1403"></a><tt class="py-lineno">1403</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">coord</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> <tt class="py-op">==</tt> <tt class="py-number">0</tt><tt class="py-op">:</tt> </tt>
<a name="L1404"></a><tt class="py-lineno">1404</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-774" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-774', 'RelaxError', 'link-20');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"No common atoms could be found between the structures."</tt><tt class="py-op">)</tt> </tt>
<a name="L1405"></a><tt class="py-lineno">1405</tt>  <tt class="py-line"> </tt>
<a name="L1406"></a><tt class="py-lineno">1406</tt>  <tt class="py-line">    <tt class="py-comment"># The different algorithms.</tt> </tt>
<a name="L1407"></a><tt class="py-lineno">1407</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-775" class="py-name"><a title="bmrblib.experimental_details.method" class="py-name" href="#" onclick="return doclink('link-775', 'method', 'link-759');">method</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'fit to mean'</tt><tt class="py-op">:</tt> </tt>
<a name="L1408"></a><tt class="py-lineno">1408</tt>  <tt class="py-line">        <tt class="py-name">T</tt><tt class="py-op">,</tt> <tt id="link-776" class="py-name"><a title="lib.frame_order.rotor_axis.R
test_suite.unit_tests._lib._geometry.test_rotations.R" class="py-name" href="#" onclick="return doclink('link-776', 'R', 'link-672');">R</a></tt><tt class="py-op">,</tt> <tt id="link-777" class="py-name"><a title="specific_analyses.frame_order.uf.pivot" class="py-name" href="#" onclick="return doclink('link-777', 'pivot', 'link-480');">pivot</a></tt> <tt class="py-op">=</tt> <tt id="link-778" class="py-name"><a title="lib.structure.superimpose.fit_to_mean" class="py-name" href="#" onclick="return doclink('link-778', 'fit_to_mean', 'link-77');">fit_to_mean</a></tt><tt class="py-op">(</tt><tt id="link-779" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-779', 'models', 'link-137');">models</a></tt><tt class="py-op">=</tt><tt id="link-780" class="py-name"><a title="lib.list" class="py-name" href="#" onclick="return doclink('link-780', 'list', 'link-171');">list</a></tt><tt class="py-op">(</tt><tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">ids</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">coord</tt><tt class="py-op">=</tt><tt class="py-name">coord</tt><tt class="py-op">,</tt> <tt class="py-name">centre_type</tt><tt class="py-op">=</tt><tt class="py-name">centre_type</tt><tt class="py-op">,</tt> <tt id="link-781" class="py-name"><a title="gui.analyses.elements" class="py-name" href="#" onclick="return doclink('link-781', 'elements', 'link-142');">elements</a></tt><tt class="py-op">=</tt><tt id="link-782" class="py-name"><a title="gui.analyses.elements" class="py-name" href="#" onclick="return doclink('link-782', 'elements', 'link-142');">elements</a></tt><tt class="py-op">,</tt> <tt class="py-name">centroid</tt><tt class="py-op">=</tt><tt class="py-name">centroid</tt><tt class="py-op">)</tt> </tt>
<a name="L1409"></a><tt class="py-lineno">1409</tt>  <tt class="py-line">    <tt class="py-keyword">elif</tt> <tt id="link-783" class="py-name"><a title="bmrblib.experimental_details.method" class="py-name" href="#" onclick="return doclink('link-783', 'method', 'link-759');">method</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'fit to first'</tt><tt class="py-op">:</tt> </tt>
<a name="L1410"></a><tt class="py-lineno">1410</tt>  <tt class="py-line">        <tt class="py-name">T</tt><tt class="py-op">,</tt> <tt id="link-784" class="py-name"><a title="lib.frame_order.rotor_axis.R
test_suite.unit_tests._lib._geometry.test_rotations.R" class="py-name" href="#" onclick="return doclink('link-784', 'R', 'link-672');">R</a></tt><tt class="py-op">,</tt> <tt id="link-785" class="py-name"><a title="specific_analyses.frame_order.uf.pivot" class="py-name" href="#" onclick="return doclink('link-785', 'pivot', 'link-480');">pivot</a></tt> <tt class="py-op">=</tt> <tt id="link-786" class="py-name"><a title="lib.structure.superimpose.fit_to_first" class="py-name" href="#" onclick="return doclink('link-786', 'fit_to_first', 'link-76');">fit_to_first</a></tt><tt class="py-op">(</tt><tt id="link-787" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-787', 'models', 'link-137');">models</a></tt><tt class="py-op">=</tt><tt id="link-788" class="py-name"><a title="lib.list" class="py-name" href="#" onclick="return doclink('link-788', 'list', 'link-171');">list</a></tt><tt class="py-op">(</tt><tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">ids</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">coord</tt><tt class="py-op">=</tt><tt class="py-name">coord</tt><tt class="py-op">,</tt> <tt class="py-name">centre_type</tt><tt class="py-op">=</tt><tt class="py-name">centre_type</tt><tt class="py-op">,</tt> <tt id="link-789" class="py-name"><a title="gui.analyses.elements" class="py-name" href="#" onclick="return doclink('link-789', 'elements', 'link-142');">elements</a></tt><tt class="py-op">=</tt><tt id="link-790" class="py-name"><a title="gui.analyses.elements" class="py-name" href="#" onclick="return doclink('link-790', 'elements', 'link-142');">elements</a></tt><tt class="py-op">,</tt> <tt class="py-name">centroid</tt><tt class="py-op">=</tt><tt class="py-name">centroid</tt><tt class="py-op">)</tt> </tt>
<a name="L1411"></a><tt class="py-lineno">1411</tt>  <tt class="py-line"> </tt>
<a name="L1412"></a><tt class="py-lineno">1412</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over all pipes, models, and molecules.</tt> </tt>
<a name="L1413"></a><tt class="py-lineno">1413</tt>  <tt class="py-line">    <tt id="link-791" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-791', 'i', 'link-160');">i</a></tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L1414"></a><tt class="py-lineno">1414</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">pipe_index</tt><tt class="py-op">,</tt> <tt class="py-name">model_num</tt><tt class="py-op">,</tt> <tt class="py-name">mol_name</tt> <tt class="py-keyword">in</tt> <tt id="link-792" class="py-name" targets="Function pipe_control.structure.main.structure_loop()=pipe_control.structure.main-module.html#structure_loop"><a title="pipe_control.structure.main.structure_loop" class="py-name" href="#" onclick="return doclink('link-792', 'structure_loop', 'link-792');">structure_loop</a></tt><tt class="py-op">(</tt><tt id="link-793" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-793', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">=</tt><tt id="link-794" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-794', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">,</tt> <tt id="link-795" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-795', 'models', 'link-137');">models</a></tt><tt class="py-op">=</tt><tt id="link-796" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-796', 'models', 'link-137');">models</a></tt><tt class="py-op">,</tt> <tt id="link-797" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-797', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">=</tt><tt id="link-798" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-798', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">,</tt> <tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">atom_id</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1415"></a><tt class="py-lineno">1415</tt>  <tt class="py-line">        <tt class="py-comment"># The current displacement ID.</tt> </tt>
<a name="L1416"></a><tt class="py-lineno">1416</tt>  <tt class="py-line">        <tt class="py-name">curr_displace_id</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L1417"></a><tt class="py-lineno">1417</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">isinstance</tt><tt class="py-op">(</tt><tt class="py-name">displace_id</tt><tt class="py-op">,</tt> <tt class="py-name">str</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1418"></a><tt class="py-lineno">1418</tt>  <tt class="py-line">            <tt class="py-name">curr_displace_id</tt> <tt class="py-op">=</tt> <tt class="py-name">displace_id</tt> </tt>
<a name="L1419"></a><tt class="py-lineno">1419</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">isinstance</tt><tt class="py-op">(</tt><tt class="py-name">displace_id</tt><tt class="py-op">,</tt> <tt id="link-799" class="py-name"><a title="lib.list" class="py-name" href="#" onclick="return doclink('link-799', 'list', 'link-171');">list</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1420"></a><tt class="py-lineno">1420</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">displace_id</tt><tt class="py-op">)</tt> <tt class="py-op">&lt;=</tt> <tt id="link-800" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-800', 'i', 'link-160');">i</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1421"></a><tt class="py-lineno">1421</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-801" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-801', 'RelaxError', 'link-20');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Not enough displacement ID strings have been provided."</tt><tt class="py-op">)</tt> </tt>
<a name="L1422"></a><tt class="py-lineno">1422</tt>  <tt class="py-line">            <tt class="py-name">curr_displace_id</tt> <tt class="py-op">=</tt> <tt class="py-name">displace_id</tt><tt class="py-op">[</tt><tt id="link-802" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-802', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt> </tt>
<a name="L1423"></a><tt class="py-lineno">1423</tt>  <tt class="py-line"> </tt>
<a name="L1424"></a><tt class="py-lineno">1424</tt>  <tt class="py-line">        <tt class="py-comment"># Add the molecule name to the displacement ID if required.</tt> </tt>
<a name="L1425"></a><tt class="py-lineno">1425</tt>  <tt class="py-line">        <tt class="py-name">id</tt> <tt class="py-op">=</tt> <tt class="py-name">curr_displace_id</tt> </tt>
<a name="L1426"></a><tt class="py-lineno">1426</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">id</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt> <tt class="py-keyword">or</tt> <tt class="py-op">(</tt><tt class="py-name">mol_name</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt id="link-803" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-803', 'search', 'link-6');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'#'</tt><tt class="py-op">,</tt> <tt class="py-name">id</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1427"></a><tt class="py-lineno">1427</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">curr_displace_id</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L1428"></a><tt class="py-lineno">1428</tt>  <tt class="py-line">                <tt class="py-name">id</tt> <tt class="py-op">=</tt> <tt class="py-string">'#%s'</tt> <tt class="py-op">%</tt> <tt class="py-name">mol_name</tt> </tt>
<a name="L1429"></a><tt class="py-lineno">1429</tt>  <tt class="py-line">            <tt class="py-keyword">elif</tt> <tt id="link-804" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-804', 'search', 'link-6');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'#'</tt><tt class="py-op">,</tt> <tt class="py-name">curr_displace_id</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1430"></a><tt class="py-lineno">1430</tt>  <tt class="py-line">                <tt class="py-name">id</tt> <tt class="py-op">=</tt> <tt class="py-name">curr_displace_id</tt> </tt>
<a name="L1431"></a><tt class="py-lineno">1431</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1432"></a><tt class="py-lineno">1432</tt>  <tt class="py-line">                <tt class="py-name">id</tt> <tt class="py-op">=</tt> <tt class="py-string">'#%s%s'</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-name">mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">curr_displace_id</tt><tt class="py-op">)</tt> </tt>
<a name="L1433"></a><tt class="py-lineno">1433</tt>  <tt class="py-line"> </tt>
<a name="L1434"></a><tt class="py-lineno">1434</tt>  <tt class="py-line">        <tt class="py-comment"># Translate the molecule first (the rotational pivot is defined in the first model).</tt> </tt>
<a name="L1435"></a><tt class="py-lineno">1435</tt>  <tt class="py-line">        <tt id="link-805" class="py-name" targets="Function bmrblib.misc.translate()=bmrblib.misc-module.html#translate,Method lib.structure.internal.object.Internal.translate()=lib.structure.internal.object.Internal-class.html#translate,Function pipe_control.structure.main.translate()=pipe_control.structure.main-module.html#translate"><a title="bmrblib.misc.translate
lib.structure.internal.object.Internal.translate
pipe_control.structure.main.translate" class="py-name" href="#" onclick="return doclink('link-805', 'translate', 'link-805');">translate</a></tt><tt class="py-op">(</tt><tt class="py-name">T</tt><tt class="py-op">=</tt><tt class="py-name">T</tt><tt class="py-op">[</tt><tt id="link-806" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-806', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt id="link-807" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-807', 'model', 'link-294');">model</a></tt><tt class="py-op">=</tt><tt class="py-name">model_num</tt><tt class="py-op">,</tt> <tt class="py-name">pipe_name</tt><tt class="py-op">=</tt><tt id="link-808" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-808', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">[</tt><tt class="py-name">pipe_index</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">id</tt><tt class="py-op">)</tt> </tt>
<a name="L1436"></a><tt class="py-lineno">1436</tt>  <tt class="py-line"> </tt>
<a name="L1437"></a><tt class="py-lineno">1437</tt>  <tt class="py-line">        <tt class="py-comment"># Rotate the molecule.</tt> </tt>
<a name="L1438"></a><tt class="py-lineno">1438</tt>  <tt class="py-line">        <tt id="link-809" class="py-name"><a title="lib.structure.internal.object.Internal.rotate
pipe_control.structure.main.rotate" class="py-name" href="#" onclick="return doclink('link-809', 'rotate', 'link-678');">rotate</a></tt><tt class="py-op">(</tt><tt id="link-810" class="py-name"><a title="lib.frame_order.rotor_axis.R
test_suite.unit_tests._lib._geometry.test_rotations.R" class="py-name" href="#" onclick="return doclink('link-810', 'R', 'link-672');">R</a></tt><tt class="py-op">=</tt><tt id="link-811" class="py-name"><a title="lib.frame_order.rotor_axis.R
test_suite.unit_tests._lib._geometry.test_rotations.R" class="py-name" href="#" onclick="return doclink('link-811', 'R', 'link-672');">R</a></tt><tt class="py-op">[</tt><tt id="link-812" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-812', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">origin</tt><tt class="py-op">=</tt><tt id="link-813" class="py-name"><a title="specific_analyses.frame_order.uf.pivot" class="py-name" href="#" onclick="return doclink('link-813', 'pivot', 'link-480');">pivot</a></tt><tt class="py-op">[</tt><tt id="link-814" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-814', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt id="link-815" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-815', 'model', 'link-294');">model</a></tt><tt class="py-op">=</tt><tt class="py-name">model_num</tt><tt class="py-op">,</tt> <tt class="py-name">pipe_name</tt><tt class="py-op">=</tt><tt id="link-816" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-816', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">[</tt><tt class="py-name">pipe_index</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">id</tt><tt class="py-op">)</tt> </tt>
<a name="L1439"></a><tt class="py-lineno">1439</tt>  <tt class="py-line"> </tt>
<a name="L1440"></a><tt class="py-lineno">1440</tt>  <tt class="py-line">        <tt class="py-comment"># Increment the index.</tt> </tt>
<a name="L1441"></a><tt class="py-lineno">1441</tt>  <tt class="py-line">        <tt id="link-817" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-817', 'i', 'link-160');">i</a></tt> <tt class="py-op">+=</tt> <tt class="py-number">1</tt> </tt>
</div><a name="L1442"></a><tt class="py-lineno">1442</tt>  <tt class="py-line"> </tt>
<a name="L1443"></a><tt class="py-lineno">1443</tt>  <tt class="py-line"> </tt>
<a name="translate"></a><div id="translate-def"><a name="L1444"></a><tt class="py-lineno">1444</tt> <a class="py-toggle" href="#" id="translate-toggle" onclick="return toggle('translate');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#translate">translate</a><tt class="py-op">(</tt><tt class="py-param">T</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">model</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">pipe_name</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="translate-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="translate-expanded"><a name="L1445"></a><tt class="py-lineno">1445</tt>  <tt class="py-line">    <tt class="py-docstring">"""Shift the structural data by the specified translation vector.</tt> </tt>
<a name="L1446"></a><tt class="py-lineno">1446</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1447"></a><tt class="py-lineno">1447</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword T:         The translation vector.</tt> </tt>
<a name="L1448"></a><tt class="py-lineno">1448</tt>  <tt class="py-line"><tt class="py-docstring">    @type T:            numpy rank-1, 3D array or list of float</tt> </tt>
<a name="L1449"></a><tt class="py-lineno">1449</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword model:     The model to translate.  If None, all models will be rotated.</tt> </tt>
<a name="L1450"></a><tt class="py-lineno">1450</tt>  <tt class="py-line"><tt class="py-docstring">    @type model:        int or None</tt> </tt>
<a name="L1451"></a><tt class="py-lineno">1451</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_id:   The molecule, residue, and atom identifier string.  Only atoms matching this selection will be used.</tt> </tt>
<a name="L1452"></a><tt class="py-lineno">1452</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_id:      str or None</tt> </tt>
<a name="L1453"></a><tt class="py-lineno">1453</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pipe_name: The name of the data pipe containing the structures to translate.  This defaults to the current data pipe.</tt> </tt>
<a name="L1454"></a><tt class="py-lineno">1454</tt>  <tt class="py-line"><tt class="py-docstring">    @type pipe_name:    None or str</tt> </tt>
<a name="L1455"></a><tt class="py-lineno">1455</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L1456"></a><tt class="py-lineno">1456</tt>  <tt class="py-line"> </tt>
<a name="L1457"></a><tt class="py-lineno">1457</tt>  <tt class="py-line">    <tt class="py-comment"># Defaults.</tt> </tt>
<a name="L1458"></a><tt class="py-lineno">1458</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">pipe_name</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L1459"></a><tt class="py-lineno">1459</tt>  <tt class="py-line">        <tt class="py-name">pipe_name</tt> <tt class="py-op">=</tt> <tt id="link-818" class="py-name"><a title="pipe_control.pipes.cdp_name" class="py-name" href="#" onclick="return doclink('link-818', 'cdp_name', 'link-99');">cdp_name</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1460"></a><tt class="py-lineno">1460</tt>  <tt class="py-line"> </tt>
<a name="L1461"></a><tt class="py-lineno">1461</tt>  <tt class="py-line">    <tt class="py-comment"># Checks.</tt> </tt>
<a name="L1462"></a><tt class="py-lineno">1462</tt>  <tt class="py-line">    <tt id="link-819" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-819', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">(</tt><tt class="py-name">pipe_name</tt><tt class="py-op">)</tt> </tt>
<a name="L1463"></a><tt class="py-lineno">1463</tt>  <tt class="py-line">    <tt id="link-820" class="py-name"><a title="pipe_control.structure.checks.check_structure" class="py-name" href="#" onclick="return doclink('link-820', 'check_structure', 'link-105');">check_structure</a></tt><tt class="py-op">(</tt><tt class="py-name">pipe_name</tt><tt class="py-op">)</tt> </tt>
<a name="L1464"></a><tt class="py-lineno">1464</tt>  <tt class="py-line"> </tt>
<a name="L1465"></a><tt class="py-lineno">1465</tt>  <tt class="py-line">    <tt class="py-comment"># Get the data pipe.</tt> </tt>
<a name="L1466"></a><tt class="py-lineno">1466</tt>  <tt class="py-line">    <tt class="py-name">dp</tt> <tt class="py-op">=</tt> <tt id="link-821" class="py-name"><a title="pipe_control.pipes.get_pipe" class="py-name" href="#" onclick="return doclink('link-821', 'get_pipe', 'link-101');">get_pipe</a></tt><tt class="py-op">(</tt><tt class="py-name">pipe_name</tt><tt class="py-op">)</tt> </tt>
<a name="L1467"></a><tt class="py-lineno">1467</tt>  <tt class="py-line"> </tt>
<a name="L1468"></a><tt class="py-lineno">1468</tt>  <tt class="py-line">    <tt class="py-comment"># Convert the args to numpy float data structures.</tt> </tt>
<a name="L1469"></a><tt class="py-lineno">1469</tt>  <tt class="py-line">    <tt class="py-name">T</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">T</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L1470"></a><tt class="py-lineno">1470</tt>  <tt class="py-line"> </tt>
<a name="L1471"></a><tt class="py-lineno">1471</tt>  <tt class="py-line">    <tt class="py-comment"># Call the specific code.</tt> </tt>
<a name="L1472"></a><tt class="py-lineno">1472</tt>  <tt class="py-line">    <tt id="link-822" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-822', 'selection', 'link-36');">selection</a></tt> <tt class="py-op">=</tt> <tt class="py-name">dp</tt><tt class="py-op">.</tt><tt id="link-823" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-823', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-824" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-824', 'selection', 'link-36');">selection</a></tt><tt class="py-op">(</tt><tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">atom_id</tt><tt class="py-op">)</tt> </tt>
<a name="L1473"></a><tt class="py-lineno">1473</tt>  <tt class="py-line">    <tt class="py-name">dp</tt><tt class="py-op">.</tt><tt id="link-825" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-825', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-826" class="py-name"><a title="bmrblib.misc.translate
lib.structure.internal.object.Internal.translate
pipe_control.structure.main.translate" class="py-name" href="#" onclick="return doclink('link-826', 'translate', 'link-805');">translate</a></tt><tt class="py-op">(</tt><tt class="py-name">T</tt><tt class="py-op">=</tt><tt class="py-name">T</tt><tt class="py-op">,</tt> <tt id="link-827" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-827', 'model', 'link-294');">model</a></tt><tt class="py-op">=</tt><tt id="link-828" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-828', 'model', 'link-294');">model</a></tt><tt class="py-op">,</tt> <tt id="link-829" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-829', 'selection', 'link-36');">selection</a></tt><tt class="py-op">=</tt><tt id="link-830" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-830', 'selection', 'link-36');">selection</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1474"></a><tt class="py-lineno">1474</tt>  <tt class="py-line"> </tt>
<a name="L1475"></a><tt class="py-lineno">1475</tt>  <tt class="py-line">    <tt class="py-comment"># Final printout.</tt> </tt>
<a name="L1476"></a><tt class="py-lineno">1476</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-831" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-831', 'model', 'link-294');">model</a></tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L1477"></a><tt class="py-lineno">1477</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Translated %i atoms of model %i."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt id="link-832" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-832', 'selection', 'link-36');">selection</a></tt><tt class="py-op">.</tt><tt id="link-833" class="py-name"><a title="lib.structure.internal.selection.Internal_selection.count_atoms" class="py-name" href="#" onclick="return doclink('link-833', 'count_atoms', 'link-687');">count_atoms</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt id="link-834" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-834', 'model', 'link-294');">model</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1478"></a><tt class="py-lineno">1478</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1479"></a><tt class="py-lineno">1479</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Translated %i atoms."</tt> <tt class="py-op">%</tt> <tt id="link-835" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-835', 'selection', 'link-36');">selection</a></tt><tt class="py-op">.</tt><tt id="link-836" class="py-name"><a title="lib.structure.internal.selection.Internal_selection.count_atoms" class="py-name" href="#" onclick="return doclink('link-836', 'count_atoms', 'link-687');">count_atoms</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
</div><a name="L1480"></a><tt class="py-lineno">1480</tt>  <tt class="py-line"> </tt>
<a name="L1481"></a><tt class="py-lineno">1481</tt>  <tt class="py-line"> </tt>
<a name="vectors"></a><div id="vectors-def"><a name="L1482"></a><tt class="py-lineno">1482</tt> <a class="py-toggle" href="#" id="vectors-toggle" onclick="return toggle('vectors');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#vectors">vectors</a><tt class="py-op">(</tt><tt class="py-param">spin_id1</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">spin_id2</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">model</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">verbosity</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-param">ave</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-param">unit</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="vectors-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="vectors-expanded"><a name="L1483"></a><tt class="py-lineno">1483</tt>  <tt class="py-line">    <tt class="py-docstring">"""Extract the bond vectors from the loaded structures and store them in the spin container.</tt> </tt>
<a name="L1484"></a><tt class="py-lineno">1484</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1485"></a><tt class="py-lineno">1485</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword spin_id1:      The spin identifier string of the first spin of the pair.</tt> </tt>
<a name="L1486"></a><tt class="py-lineno">1486</tt>  <tt class="py-line"><tt class="py-docstring">    @type spin_id1:         str</tt> </tt>
<a name="L1487"></a><tt class="py-lineno">1487</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword spin_id2:      The spin identifier string of the second spin of the pair.</tt> </tt>
<a name="L1488"></a><tt class="py-lineno">1488</tt>  <tt class="py-line"><tt class="py-docstring">    @type spin_id2:         str</tt> </tt>
<a name="L1489"></a><tt class="py-lineno">1489</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword model:         The model to extract the vector from.  If None, all vectors will be extracted.</tt> </tt>
<a name="L1490"></a><tt class="py-lineno">1490</tt>  <tt class="py-line"><tt class="py-docstring">    @type model:            str</tt> </tt>
<a name="L1491"></a><tt class="py-lineno">1491</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword verbosity:     The higher the value, the more information is printed to screen.</tt> </tt>
<a name="L1492"></a><tt class="py-lineno">1492</tt>  <tt class="py-line"><tt class="py-docstring">    @type verbosity:        int</tt> </tt>
<a name="L1493"></a><tt class="py-lineno">1493</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword ave:           A flag which if True will cause the average of all vectors to be extracted.</tt> </tt>
<a name="L1494"></a><tt class="py-lineno">1494</tt>  <tt class="py-line"><tt class="py-docstring">    @type ave:              bool</tt> </tt>
<a name="L1495"></a><tt class="py-lineno">1495</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword unit:          A flag which if True will cause the function to calculate the unit vectors.</tt> </tt>
<a name="L1496"></a><tt class="py-lineno">1496</tt>  <tt class="py-line"><tt class="py-docstring">    @type unit:             bool</tt> </tt>
<a name="L1497"></a><tt class="py-lineno">1497</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L1498"></a><tt class="py-lineno">1498</tt>  <tt class="py-line"> </tt>
<a name="L1499"></a><tt class="py-lineno">1499</tt>  <tt class="py-line">    <tt class="py-comment"># Checks.</tt> </tt>
<a name="L1500"></a><tt class="py-lineno">1500</tt>  <tt class="py-line">    <tt id="link-837" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-837', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1501"></a><tt class="py-lineno">1501</tt>  <tt class="py-line">    <tt id="link-838" class="py-name"><a title="pipe_control.structure.checks.check_structure" class="py-name" href="#" onclick="return doclink('link-838', 'check_structure', 'link-105');">check_structure</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1502"></a><tt class="py-lineno">1502</tt>  <tt class="py-line">    <tt id="link-839" class="py-name"><a title="pipe_control.mol_res_spin.check_mol_res_spin_data" class="py-name" href="#" onclick="return doclink('link-839', 'check_mol_res_spin_data', 'link-91');">check_mol_res_spin_data</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1503"></a><tt class="py-lineno">1503</tt>  <tt class="py-line"> </tt>
<a name="L1504"></a><tt class="py-lineno">1504</tt>  <tt class="py-line">    <tt class="py-comment"># Print out.</tt> </tt>
<a name="L1505"></a><tt class="py-lineno">1505</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-840" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-840', 'verbosity', 'link-412');">verbosity</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1506"></a><tt class="py-lineno">1506</tt>  <tt class="py-line">        <tt class="py-comment"># Number of models.</tt> </tt>
<a name="L1507"></a><tt class="py-lineno">1507</tt>  <tt class="py-line">        <tt id="link-841" class="py-name"><a title="lib.structure.internal.object.Internal.num_models" class="py-name" href="#" onclick="return doclink('link-841', 'num_models', 'link-566');">num_models</a></tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-842" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-842', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-843" class="py-name"><a title="lib.structure.internal.object.Internal.num_models" class="py-name" href="#" onclick="return doclink('link-843', 'num_models', 'link-566');">num_models</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1508"></a><tt class="py-lineno">1508</tt>  <tt class="py-line"> </tt>
<a name="L1509"></a><tt class="py-lineno">1509</tt>  <tt class="py-line">        <tt class="py-comment"># Multiple models loaded.</tt> </tt>
<a name="L1510"></a><tt class="py-lineno">1510</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-844" class="py-name"><a title="lib.structure.internal.object.Internal.num_models" class="py-name" href="#" onclick="return doclink('link-844', 'num_models', 'link-566');">num_models</a></tt> <tt class="py-op">&gt;</tt> <tt class="py-number">1</tt><tt class="py-op">:</tt> </tt>
<a name="L1511"></a><tt class="py-lineno">1511</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-845" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-845', 'model', 'link-294');">model</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1512"></a><tt class="py-lineno">1512</tt>  <tt class="py-line">                <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Extracting vectors for model '%s'."</tt> <tt class="py-op">%</tt> <tt id="link-846" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-846', 'model', 'link-294');">model</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1513"></a><tt class="py-lineno">1513</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1514"></a><tt class="py-lineno">1514</tt>  <tt class="py-line">                <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Extracting vectors for all %s models."</tt> <tt class="py-op">%</tt> <tt id="link-847" class="py-name"><a title="lib.structure.internal.object.Internal.num_models" class="py-name" href="#" onclick="return doclink('link-847', 'num_models', 'link-566');">num_models</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1515"></a><tt class="py-lineno">1515</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">ave</tt><tt class="py-op">:</tt> </tt>
<a name="L1516"></a><tt class="py-lineno">1516</tt>  <tt class="py-line">                    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Averaging all vectors."</tt><tt class="py-op">)</tt> </tt>
<a name="L1517"></a><tt class="py-lineno">1517</tt>  <tt class="py-line"> </tt>
<a name="L1518"></a><tt class="py-lineno">1518</tt>  <tt class="py-line">        <tt class="py-comment"># Single model loaded.</tt> </tt>
<a name="L1519"></a><tt class="py-lineno">1519</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1520"></a><tt class="py-lineno">1520</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Extracting vectors from the single model."</tt><tt class="py-op">)</tt> </tt>
<a name="L1521"></a><tt class="py-lineno">1521</tt>  <tt class="py-line"> </tt>
<a name="L1522"></a><tt class="py-lineno">1522</tt>  <tt class="py-line">        <tt class="py-comment"># Unit vectors.</tt> </tt>
<a name="L1523"></a><tt class="py-lineno">1523</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">unit</tt><tt class="py-op">:</tt> </tt>
<a name="L1524"></a><tt class="py-lineno">1524</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Calculating the unit vectors."</tt><tt class="py-op">)</tt> </tt>
<a name="L1525"></a><tt class="py-lineno">1525</tt>  <tt class="py-line"> </tt>
<a name="L1526"></a><tt class="py-lineno">1526</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over the spins.</tt> </tt>
<a name="L1527"></a><tt class="py-lineno">1527</tt>  <tt class="py-line">    <tt class="py-name">no_vectors</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L1528"></a><tt class="py-lineno">1528</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-848" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-848', 'spin', 'link-427');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt> <tt class="py-keyword">in</tt> <tt id="link-849" class="py-name"><a title="pipe_control.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-849', 'spin_loop', 'link-96');">spin_loop</a></tt><tt class="py-op">(</tt><tt id="link-850" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-850', 'selection', 'link-36');">selection</a></tt><tt class="py-op">=</tt><tt id="link-851" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-851', 'spin_id', 'link-488');">spin_id</a></tt><tt class="py-op">,</tt> <tt class="py-name">full_info</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1529"></a><tt class="py-lineno">1529</tt>  <tt class="py-line">        <tt class="py-comment"># Skip deselected spins.</tt> </tt>
<a name="L1530"></a><tt class="py-lineno">1530</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-852" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-852', 'spin', 'link-427');">spin</a></tt><tt class="py-op">.</tt><tt id="link-853" class="py-name" targets="Function pipe_control.model_selection.select()=pipe_control.model_selection-module.html#select,Module user_functions.select=user_functions.select-module.html"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-853', 'select', 'link-853');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1531"></a><tt class="py-lineno">1531</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L1532"></a><tt class="py-lineno">1532</tt>  <tt class="py-line"> </tt>
<a name="L1533"></a><tt class="py-lineno">1533</tt>  <tt class="py-line">        <tt class="py-comment"># The spin identification string.  The residue name and spin num is not included to allow molecules with point mutations to be used as different models.</tt> </tt>
<a name="L1534"></a><tt class="py-lineno">1534</tt>  <tt class="py-line">        <tt class="py-name">id</tt> <tt class="py-op">=</tt> <tt id="link-854" class="py-name"><a title="pipe_control.mol_res_spin.generate_spin_id_unique" class="py-name" href="#" onclick="return doclink('link-854', 'generate_spin_id_unique', 'link-93');">generate_spin_id_unique</a></tt><tt class="py-op">(</tt><tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">spin_name</tt><tt class="py-op">=</tt><tt id="link-855" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-855', 'spin', 'link-427');">spin</a></tt><tt class="py-op">.</tt><tt id="link-856" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-856', 'name', 'link-316');">name</a></tt><tt class="py-op">,</tt> <tt class="py-name">spin_num</tt><tt class="py-op">=</tt><tt id="link-857" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-857', 'spin', 'link-427');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">num</tt><tt class="py-op">)</tt> </tt>
<a name="L1535"></a><tt class="py-lineno">1535</tt>  <tt class="py-line"> </tt>
<a name="L1536"></a><tt class="py-lineno">1536</tt>  <tt class="py-line">        <tt class="py-comment"># Test that the spin number or name are set (one or both are essential for the identification of the atom).</tt> </tt>
<a name="L1537"></a><tt class="py-lineno">1537</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-858" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-858', 'spin', 'link-427');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">num</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt> <tt class="py-keyword">and</tt> <tt id="link-859" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-859', 'spin', 'link-427');">spin</a></tt><tt class="py-op">.</tt><tt id="link-860" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-860', 'name', 'link-316');">name</a></tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L1538"></a><tt class="py-lineno">1538</tt>  <tt class="py-line">            <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-861" class="py-name"><a title="lib.warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-861', 'RelaxWarning', 'link-80');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"Either the spin number or name must be set for the spin "</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">id</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">" to identify the corresponding atom in the molecule."</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1539"></a><tt class="py-lineno">1539</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L1540"></a><tt class="py-lineno">1540</tt>  <tt class="py-line"> </tt>
<a name="L1541"></a><tt class="py-lineno">1541</tt>  <tt class="py-line">        <tt class="py-comment"># The bond vector already exists.</tt> </tt>
<a name="L1542"></a><tt class="py-lineno">1542</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-862" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-862', 'spin', 'link-427');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'vector'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1543"></a><tt class="py-lineno">1543</tt>  <tt class="py-line">            <tt class="py-name">obj</tt> <tt class="py-op">=</tt> <tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt id="link-863" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-863', 'spin', 'link-427');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'vector'</tt><tt class="py-op">)</tt> </tt>
<a name="L1544"></a><tt class="py-lineno">1544</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">obj</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L1545"></a><tt class="py-lineno">1545</tt>  <tt class="py-line">                <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-864" class="py-name"><a title="lib.warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-864', 'RelaxWarning', 'link-80');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"The bond vector for the spin "</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">id</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">" already exists."</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1546"></a><tt class="py-lineno">1546</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L1547"></a><tt class="py-lineno">1547</tt>  <tt class="py-line"> </tt>
<a name="L1548"></a><tt class="py-lineno">1548</tt>  <tt class="py-line">        <tt class="py-comment"># Get the bond info.</tt> </tt>
<a name="L1549"></a><tt class="py-lineno">1549</tt>  <tt class="py-line">        <tt id="link-865" class="py-name" targets="Method lib.structure.internal.object.Internal.bond_vectors()=lib.structure.internal.object.Internal-class.html#bond_vectors"><a title="lib.structure.internal.object.Internal.bond_vectors" class="py-name" href="#" onclick="return doclink('link-865', 'bond_vectors', 'link-865');">bond_vectors</a></tt><tt class="py-op">,</tt> <tt class="py-name">attached_name</tt><tt class="py-op">,</tt> <tt id="link-866" class="py-name"><a title="lib.warnings" class="py-name" href="#" onclick="return doclink('link-866', 'warnings', 'link-7');">warnings</a></tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-867" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-867', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-868" class="py-name"><a title="lib.structure.internal.object.Internal.bond_vectors" class="py-name" href="#" onclick="return doclink('link-868', 'bond_vectors', 'link-865');">bond_vectors</a></tt><tt class="py-op">(</tt><tt class="py-name">attached_atom</tt><tt class="py-op">=</tt><tt class="py-name">attached</tt><tt class="py-op">,</tt> <tt class="py-name">model_num</tt><tt class="py-op">=</tt><tt id="link-869" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-869', 'model', 'link-294');">model</a></tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">spin_name</tt><tt class="py-op">=</tt><tt id="link-870" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-870', 'spin', 'link-427');">spin</a></tt><tt class="py-op">.</tt><tt id="link-871" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-871', 'name', 'link-316');">name</a></tt><tt class="py-op">,</tt> <tt class="py-name">spin_num</tt><tt class="py-op">=</tt><tt id="link-872" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-872', 'spin', 'link-427');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">num</tt><tt class="py-op">,</tt> <tt class="py-name">return_name</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">return_warnings</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L1550"></a><tt class="py-lineno">1550</tt>  <tt class="py-line">        <tt class="py-name">id2</tt> <tt class="py-op">=</tt> <tt id="link-873" class="py-name"><a title="pipe_control.mol_res_spin.generate_spin_id_unique" class="py-name" href="#" onclick="return doclink('link-873', 'generate_spin_id_unique', 'link-93');">generate_spin_id_unique</a></tt><tt class="py-op">(</tt><tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">spin_name</tt><tt class="py-op">=</tt><tt id="link-874" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-874', 'spin', 'link-427');">spin</a></tt><tt class="py-op">.</tt><tt id="link-875" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-875', 'name', 'link-316');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1551"></a><tt class="py-lineno">1551</tt>  <tt class="py-line"> </tt>
<a name="L1552"></a><tt class="py-lineno">1552</tt>  <tt class="py-line">        <tt class="py-comment"># No attached atom.</tt> </tt>
<a name="L1553"></a><tt class="py-lineno">1553</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-876" class="py-name"><a title="lib.structure.internal.object.Internal.bond_vectors" class="py-name" href="#" onclick="return doclink('link-876', 'bond_vectors', 'link-865');">bond_vectors</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1554"></a><tt class="py-lineno">1554</tt>  <tt class="py-line">            <tt class="py-comment"># Warning messages.</tt> </tt>
<a name="L1555"></a><tt class="py-lineno">1555</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-877" class="py-name"><a title="lib.warnings" class="py-name" href="#" onclick="return doclink('link-877', 'warnings', 'link-7');">warnings</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1556"></a><tt class="py-lineno">1556</tt>  <tt class="py-line">                <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-878" class="py-name"><a title="lib.warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-878', 'RelaxWarning', 'link-80');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt id="link-879" class="py-name"><a title="lib.warnings" class="py-name" href="#" onclick="return doclink('link-879', 'warnings', 'link-7');">warnings</a></tt> <tt class="py-op">+</tt> <tt class="py-string">" (atom ID "</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">id</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">")."</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1557"></a><tt class="py-lineno">1557</tt>  <tt class="py-line"> </tt>
<a name="L1558"></a><tt class="py-lineno">1558</tt>  <tt class="py-line">            <tt class="py-comment"># Skip the spin.</tt> </tt>
<a name="L1559"></a><tt class="py-lineno">1559</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L1560"></a><tt class="py-lineno">1560</tt>  <tt class="py-line"> </tt>
<a name="L1561"></a><tt class="py-lineno">1561</tt>  <tt class="py-line">        <tt class="py-comment"># Set the attached atom name.</tt> </tt>
<a name="L1562"></a><tt class="py-lineno">1562</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-880" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-880', 'spin', 'link-427');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'attached_atom'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1563"></a><tt class="py-lineno">1563</tt>  <tt class="py-line">            <tt id="link-881" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-881', 'spin', 'link-427');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">attached_atom</tt> <tt class="py-op">=</tt> <tt class="py-name">attached_name</tt> </tt>
<a name="L1564"></a><tt class="py-lineno">1564</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt id="link-882" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-882', 'spin', 'link-427');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">attached_atom</tt> <tt class="py-op">!=</tt> <tt class="py-name">attached_name</tt><tt class="py-op">:</tt> </tt>
<a name="L1565"></a><tt class="py-lineno">1565</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-883" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-883', 'RelaxError', 'link-20');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The "</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt id="link-884" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-884', 'spin', 'link-427');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">attached_atom</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">" atom already attached to the spin does not match the attached atom "</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">attached_name</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">"."</tt><tt class="py-op">)</tt> </tt>
<a name="L1566"></a><tt class="py-lineno">1566</tt>  <tt class="py-line"> </tt>
<a name="L1567"></a><tt class="py-lineno">1567</tt>  <tt class="py-line">        <tt class="py-comment"># Initialise the average vector.</tt> </tt>
<a name="L1568"></a><tt class="py-lineno">1568</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">ave</tt><tt class="py-op">:</tt> </tt>
<a name="L1569"></a><tt class="py-lineno">1569</tt>  <tt class="py-line">            <tt class="py-name">ave_vector</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-number">3</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L1570"></a><tt class="py-lineno">1570</tt>  <tt class="py-line"> </tt>
<a name="L1571"></a><tt class="py-lineno">1571</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the individual vectors.</tt> </tt>
<a name="L1572"></a><tt class="py-lineno">1572</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-885" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-885', 'i', 'link-160');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-886" class="py-name"><a title="lib.structure.internal.object.Internal.bond_vectors" class="py-name" href="#" onclick="return doclink('link-886', 'bond_vectors', 'link-865');">bond_vectors</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1573"></a><tt class="py-lineno">1573</tt>  <tt class="py-line">            <tt class="py-comment"># Unit vector.</tt> </tt>
<a name="L1574"></a><tt class="py-lineno">1574</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">unit</tt><tt class="py-op">:</tt> </tt>
<a name="L1575"></a><tt class="py-lineno">1575</tt>  <tt class="py-line">                <tt class="py-comment"># Normalisation factor.</tt> </tt>
<a name="L1576"></a><tt class="py-lineno">1576</tt>  <tt class="py-line">                <tt class="py-name">norm_factor</tt> <tt class="py-op">=</tt> <tt id="link-887" class="py-name"><a title="lib.compat.norm" class="py-name" href="#" onclick="return doclink('link-887', 'norm', 'link-5');">norm</a></tt><tt class="py-op">(</tt><tt id="link-888" class="py-name"><a title="lib.structure.internal.object.Internal.bond_vectors" class="py-name" href="#" onclick="return doclink('link-888', 'bond_vectors', 'link-865');">bond_vectors</a></tt><tt class="py-op">[</tt><tt id="link-889" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-889', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1577"></a><tt class="py-lineno">1577</tt>  <tt class="py-line"> </tt>
<a name="L1578"></a><tt class="py-lineno">1578</tt>  <tt class="py-line">                <tt class="py-comment"># Test for zero length.</tt> </tt>
<a name="L1579"></a><tt class="py-lineno">1579</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">norm_factor</tt> <tt class="py-op">==</tt> <tt class="py-number">0.0</tt><tt class="py-op">:</tt> </tt>
<a name="L1580"></a><tt class="py-lineno">1580</tt>  <tt class="py-line">                    <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-890" class="py-name"><a title="lib.warnings.RelaxZeroVectorWarning" class="py-name" href="#" onclick="return doclink('link-890', 'RelaxZeroVectorWarning', 'link-82');">RelaxZeroVectorWarning</a></tt><tt class="py-op">(</tt><tt class="py-name">spin_id1</tt><tt class="py-op">=</tt><tt class="py-name">id</tt><tt class="py-op">,</tt> <tt class="py-name">spin_id2</tt><tt class="py-op">=</tt><tt class="py-name">id2</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1581"></a><tt class="py-lineno">1581</tt>  <tt class="py-line"> </tt>
<a name="L1582"></a><tt class="py-lineno">1582</tt>  <tt class="py-line">                <tt class="py-comment"># Calculate the normalised vector.</tt> </tt>
<a name="L1583"></a><tt class="py-lineno">1583</tt>  <tt class="py-line">                <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1584"></a><tt class="py-lineno">1584</tt>  <tt class="py-line">                    <tt id="link-891" class="py-name"><a title="lib.structure.internal.object.Internal.bond_vectors" class="py-name" href="#" onclick="return doclink('link-891', 'bond_vectors', 'link-865');">bond_vectors</a></tt><tt class="py-op">[</tt><tt id="link-892" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-892', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-893" class="py-name"><a title="lib.structure.internal.object.Internal.bond_vectors" class="py-name" href="#" onclick="return doclink('link-893', 'bond_vectors', 'link-865');">bond_vectors</a></tt><tt class="py-op">[</tt><tt id="link-894" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-894', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">/</tt> <tt class="py-name">norm_factor</tt> </tt>
<a name="L1585"></a><tt class="py-lineno">1585</tt>  <tt class="py-line"> </tt>
<a name="L1586"></a><tt class="py-lineno">1586</tt>  <tt class="py-line">            <tt class="py-comment"># Sum the vectors.</tt> </tt>
<a name="L1587"></a><tt class="py-lineno">1587</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">ave</tt><tt class="py-op">:</tt> </tt>
<a name="L1588"></a><tt class="py-lineno">1588</tt>  <tt class="py-line">                <tt class="py-name">ave_vector</tt> <tt class="py-op">=</tt> <tt class="py-name">ave_vector</tt> <tt class="py-op">+</tt> <tt id="link-895" class="py-name"><a title="lib.structure.internal.object.Internal.bond_vectors" class="py-name" href="#" onclick="return doclink('link-895', 'bond_vectors', 'link-865');">bond_vectors</a></tt><tt class="py-op">[</tt><tt id="link-896" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-896', 'i', 'link-160');">i</a></tt><tt class="py-op">]</tt> </tt>
<a name="L1589"></a><tt class="py-lineno">1589</tt>  <tt class="py-line"> </tt>
<a name="L1590"></a><tt class="py-lineno">1590</tt>  <tt class="py-line">        <tt class="py-comment"># Average.</tt> </tt>
<a name="L1591"></a><tt class="py-lineno">1591</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">ave</tt><tt class="py-op">:</tt> </tt>
<a name="L1592"></a><tt class="py-lineno">1592</tt>  <tt class="py-line">            <tt class="py-name">vector</tt> <tt class="py-op">=</tt> <tt class="py-name">ave_vector</tt> <tt class="py-op">/</tt> <tt id="link-897" class="py-name"><a title="lib.float" class="py-name" href="#" onclick="return doclink('link-897', 'float', 'link-518');">float</a></tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-898" class="py-name"><a title="lib.structure.internal.object.Internal.bond_vectors" class="py-name" href="#" onclick="return doclink('link-898', 'bond_vectors', 'link-865');">bond_vectors</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1593"></a><tt class="py-lineno">1593</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1594"></a><tt class="py-lineno">1594</tt>  <tt class="py-line">            <tt class="py-name">vector</tt> <tt class="py-op">=</tt> <tt id="link-899" class="py-name"><a title="lib.structure.internal.object.Internal.bond_vectors" class="py-name" href="#" onclick="return doclink('link-899', 'bond_vectors', 'link-865');">bond_vectors</a></tt> </tt>
<a name="L1595"></a><tt class="py-lineno">1595</tt>  <tt class="py-line"> </tt>
<a name="L1596"></a><tt class="py-lineno">1596</tt>  <tt class="py-line">        <tt class="py-comment"># Convert to a single vector if needed.</tt> </tt>
<a name="L1597"></a><tt class="py-lineno">1597</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">vector</tt><tt class="py-op">)</tt> <tt class="py-op">==</tt> <tt class="py-number">1</tt><tt class="py-op">:</tt> </tt>
<a name="L1598"></a><tt class="py-lineno">1598</tt>  <tt class="py-line">            <tt class="py-name">vector</tt> <tt class="py-op">=</tt> <tt class="py-name">vector</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L1599"></a><tt class="py-lineno">1599</tt>  <tt class="py-line"> </tt>
<a name="L1600"></a><tt class="py-lineno">1600</tt>  <tt class="py-line">        <tt class="py-comment"># Set the vector.</tt> </tt>
<a name="L1601"></a><tt class="py-lineno">1601</tt>  <tt class="py-line">        <tt class="py-name">setattr</tt><tt class="py-op">(</tt><tt id="link-900" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-900', 'spin', 'link-427');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'vector'</tt><tt class="py-op">,</tt> <tt class="py-name">vector</tt><tt class="py-op">)</tt> </tt>
<a name="L1602"></a><tt class="py-lineno">1602</tt>  <tt class="py-line"> </tt>
<a name="L1603"></a><tt class="py-lineno">1603</tt>  <tt class="py-line">        <tt class="py-comment"># We have a vector!</tt> </tt>
<a name="L1604"></a><tt class="py-lineno">1604</tt>  <tt class="py-line">        <tt class="py-name">no_vectors</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L1605"></a><tt class="py-lineno">1605</tt>  <tt class="py-line"> </tt>
<a name="L1606"></a><tt class="py-lineno">1606</tt>  <tt class="py-line">        <tt class="py-comment"># Print out of modified spins.</tt> </tt>
<a name="L1607"></a><tt class="py-lineno">1607</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-901" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-901', 'verbosity', 'link-412');">verbosity</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1608"></a><tt class="py-lineno">1608</tt>  <tt class="py-line">            <tt class="py-comment"># The number of vectors.</tt> </tt>
<a name="L1609"></a><tt class="py-lineno">1609</tt>  <tt class="py-line">            <tt class="py-name">num</tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-902" class="py-name"><a title="lib.structure.internal.object.Internal.bond_vectors" class="py-name" href="#" onclick="return doclink('link-902', 'bond_vectors', 'link-865');">bond_vectors</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1610"></a><tt class="py-lineno">1610</tt>  <tt class="py-line">            <tt class="py-name">plural</tt> <tt class="py-op">=</tt> <tt class="py-string">'s'</tt> </tt>
<a name="L1611"></a><tt class="py-lineno">1611</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">num</tt> <tt class="py-op">==</tt> <tt class="py-number">1</tt><tt class="py-op">:</tt> </tt>
<a name="L1612"></a><tt class="py-lineno">1612</tt>  <tt class="py-line">                <tt class="py-name">plural</tt> <tt class="py-op">=</tt> <tt class="py-string">''</tt> </tt>
<a name="L1613"></a><tt class="py-lineno">1613</tt>  <tt class="py-line"> </tt>
<a name="L1614"></a><tt class="py-lineno">1614</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-903" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-903', 'spin', 'link-427');">spin</a></tt><tt class="py-op">.</tt><tt id="link-904" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-904', 'name', 'link-316');">name</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1615"></a><tt class="py-lineno">1615</tt>  <tt class="py-line">                <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Extracted %s %s-%s vector%s for the spin '%s'."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-name">num</tt><tt class="py-op">,</tt> <tt id="link-905" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-905', 'spin', 'link-427');">spin</a></tt><tt class="py-op">.</tt><tt id="link-906" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-906', 'name', 'link-316');">name</a></tt><tt class="py-op">,</tt> <tt class="py-name">attached_name</tt><tt class="py-op">,</tt> <tt class="py-name">plural</tt><tt class="py-op">,</tt> <tt class="py-name">id</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1616"></a><tt class="py-lineno">1616</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1617"></a><tt class="py-lineno">1617</tt>  <tt class="py-line">                <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Extracted %s %s-%s vector%s for the spin '%s'."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-name">num</tt><tt class="py-op">,</tt> <tt id="link-907" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-907', 'spin', 'link-427');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">num</tt><tt class="py-op">,</tt> <tt class="py-name">attached_name</tt><tt class="py-op">,</tt> <tt class="py-name">plural</tt><tt class="py-op">,</tt> <tt class="py-name">id</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1618"></a><tt class="py-lineno">1618</tt>  <tt class="py-line"> </tt>
<a name="L1619"></a><tt class="py-lineno">1619</tt>  <tt class="py-line">    <tt class="py-comment"># Right, catch the problem of missing vectors to prevent massive user confusion!</tt> </tt>
<a name="L1620"></a><tt class="py-lineno">1620</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">no_vectors</tt><tt class="py-op">:</tt> </tt>
<a name="L1621"></a><tt class="py-lineno">1621</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-908" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-908', 'RelaxError', 'link-20');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"No vectors could be extracted."</tt><tt class="py-op">)</tt> </tt>
</div><a name="L1622"></a><tt class="py-lineno">1622</tt>  <tt class="py-line"> </tt>
<a name="L1623"></a><tt class="py-lineno">1623</tt>  <tt class="py-line"> </tt>
<a name="web_of_motion"></a><div id="web_of_motion-def"><a name="L1624"></a><tt class="py-lineno">1624</tt> <a class="py-toggle" href="#" id="web_of_motion-toggle" onclick="return toggle('web_of_motion');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#web_of_motion">web_of_motion</a><tt class="py-op">(</tt><tt class="py-param">pipes</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">models</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">molecules</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">file</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">dir</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">force</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="web_of_motion-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="web_of_motion-expanded"><a name="L1625"></a><tt class="py-lineno">1625</tt>  <tt class="py-line">    <tt class="py-docstring">"""Create a PDB representation of the motion between a set of models.</tt> </tt>
<a name="L1626"></a><tt class="py-lineno">1626</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1627"></a><tt class="py-lineno">1627</tt>  <tt class="py-line"><tt class="py-docstring">    This will create a PDB file containing the atoms of all models, with identical atoms links using CONECT records.  This function only supports the internal structural object.</tt> </tt>
<a name="L1628"></a><tt class="py-lineno">1628</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1629"></a><tt class="py-lineno">1629</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1630"></a><tt class="py-lineno">1630</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword pipes:     The data pipes to generate the web between.</tt> </tt>
<a name="L1631"></a><tt class="py-lineno">1631</tt>  <tt class="py-line"><tt class="py-docstring">    @type pipes:        None or list of str</tt> </tt>
<a name="L1632"></a><tt class="py-lineno">1632</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword models:    The list of models to generate the web between.  The number of elements must match the pipes argument.  If set to None, then all models will be used.</tt> </tt>
<a name="L1633"></a><tt class="py-lineno">1633</tt>  <tt class="py-line"><tt class="py-docstring">    @type models:       None or list of lists of int</tt> </tt>
<a name="L1634"></a><tt class="py-lineno">1634</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword molecules: The list of molecules to generate the web between.  The number of elements must match the pipes argument.</tt> </tt>
<a name="L1635"></a><tt class="py-lineno">1635</tt>  <tt class="py-line"><tt class="py-docstring">    @type molecules:    None or list of lists of str</tt> </tt>
<a name="L1636"></a><tt class="py-lineno">1636</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword atom_id:   The atom identification string of the coordinates of interest.  This matches the spin ID string format.</tt> </tt>
<a name="L1637"></a><tt class="py-lineno">1637</tt>  <tt class="py-line"><tt class="py-docstring">    @type atom_id:      str or None</tt> </tt>
<a name="L1638"></a><tt class="py-lineno">1638</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword file:      The name of the PDB file to write.</tt> </tt>
<a name="L1639"></a><tt class="py-lineno">1639</tt>  <tt class="py-line"><tt class="py-docstring">    @type file:         str</tt> </tt>
<a name="L1640"></a><tt class="py-lineno">1640</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword dir:       The directory where the PDB file will be placed.  If set to None, then the file will be placed in the current directory.</tt> </tt>
<a name="L1641"></a><tt class="py-lineno">1641</tt>  <tt class="py-line"><tt class="py-docstring">    @type dir:          str or None</tt> </tt>
<a name="L1642"></a><tt class="py-lineno">1642</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword force:     The force flag which if True will cause the file to be overwritten.</tt> </tt>
<a name="L1643"></a><tt class="py-lineno">1643</tt>  <tt class="py-line"><tt class="py-docstring">    @type force:        bool</tt> </tt>
<a name="L1644"></a><tt class="py-lineno">1644</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L1645"></a><tt class="py-lineno">1645</tt>  <tt class="py-line"> </tt>
<a name="L1646"></a><tt class="py-lineno">1646</tt>  <tt class="py-line">    <tt class="py-comment"># Checks.</tt> </tt>
<a name="L1647"></a><tt class="py-lineno">1647</tt>  <tt class="py-line">    <tt id="link-909" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-909', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1648"></a><tt class="py-lineno">1648</tt>  <tt class="py-line">    <tt id="link-910" class="py-name"><a title="pipe_control.structure.checks.check_structure" class="py-name" href="#" onclick="return doclink('link-910', 'check_structure', 'link-105');">check_structure</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1649"></a><tt class="py-lineno">1649</tt>  <tt class="py-line"> </tt>
<a name="L1650"></a><tt class="py-lineno">1650</tt>  <tt class="py-line">    <tt class="py-comment"># Assemble the structural coordinates.</tt> </tt>
<a name="L1651"></a><tt class="py-lineno">1651</tt>  <tt class="py-line">    <tt class="py-name">coord</tt><tt class="py-op">,</tt> <tt class="py-name">ids</tt><tt class="py-op">,</tt> <tt class="py-name">mol_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_names</tt><tt class="py-op">,</tt> <tt class="py-name">res_nums</tt><tt class="py-op">,</tt> <tt class="py-name">atom_names</tt><tt class="py-op">,</tt> <tt id="link-911" class="py-name"><a title="gui.analyses.elements" class="py-name" href="#" onclick="return doclink('link-911', 'elements', 'link-142');">elements</a></tt> <tt class="py-op">=</tt> <tt id="link-912" class="py-name"><a title="pipe_control.structure.main.assemble_structural_coordinates" class="py-name" href="#" onclick="return doclink('link-912', 'assemble_structural_coordinates', 'link-213');">assemble_structural_coordinates</a></tt><tt class="py-op">(</tt><tt id="link-913" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-913', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">=</tt><tt id="link-914" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-914', 'pipes', 'link-85');">pipes</a></tt><tt class="py-op">,</tt> <tt id="link-915" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-915', 'models', 'link-137');">models</a></tt><tt class="py-op">=</tt><tt id="link-916" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.models
gui.analyses.auto_model_free.Mf_list.models
gui.analyses.auto_relax_disp.Disp_model_list.models
gui.analyses.elements.model_list.Model_list.models
lib.structure.internal.models" class="py-name" href="#" onclick="return doclink('link-916', 'models', 'link-137');">models</a></tt><tt class="py-op">,</tt> <tt id="link-917" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-917', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">=</tt><tt id="link-918" class="py-name"><a title="lib.structure.internal.molecules" class="py-name" href="#" onclick="return doclink('link-918', 'molecules', 'link-139');">molecules</a></tt><tt class="py-op">,</tt> <tt class="py-name">atom_id</tt><tt class="py-op">=</tt><tt class="py-name">atom_id</tt><tt class="py-op">)</tt> </tt>
<a name="L1652"></a><tt class="py-lineno">1652</tt>  <tt class="py-line"> </tt>
<a name="L1653"></a><tt class="py-lineno">1653</tt>  <tt class="py-line">    <tt class="py-comment"># Check that more than one structure is present.</tt> </tt>
<a name="L1654"></a><tt class="py-lineno">1654</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">coord</tt><tt class="py-op">)</tt> <tt class="py-op">&gt;</tt> <tt class="py-number">1</tt><tt class="py-op">:</tt> </tt>
<a name="L1655"></a><tt class="py-lineno">1655</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-919" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-919', 'RelaxError', 'link-20');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Two or more structures are required."</tt><tt class="py-op">)</tt> </tt>
<a name="L1656"></a><tt class="py-lineno">1656</tt>  <tt class="py-line"> </tt>
<a name="L1657"></a><tt class="py-lineno">1657</tt>  <tt class="py-line">    <tt class="py-comment"># Initialise the structural object.</tt> </tt>
<a name="L1658"></a><tt class="py-lineno">1658</tt>  <tt class="py-line">    <tt class="py-name">web</tt> <tt class="py-op">=</tt> <tt id="link-920" class="py-name"><a title="lib.structure.internal.object.Internal" class="py-name" href="#" onclick="return doclink('link-920', 'Internal', 'link-63');">Internal</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1659"></a><tt class="py-lineno">1659</tt>  <tt class="py-line"> </tt>
<a name="L1660"></a><tt class="py-lineno">1660</tt>  <tt class="py-line">    <tt class="py-comment"># Loop over the atoms.</tt> </tt>
<a name="L1661"></a><tt class="py-lineno">1661</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">atom_index</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">atom_names</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1662"></a><tt class="py-lineno">1662</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the structures.</tt> </tt>
<a name="L1663"></a><tt class="py-lineno">1663</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">struct_index</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">ids</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1664"></a><tt class="py-lineno">1664</tt>  <tt class="py-line">            <tt class="py-comment"># Add the atom.</tt> </tt>
<a name="L1665"></a><tt class="py-lineno">1665</tt>  <tt class="py-line">            <tt class="py-name">web</tt><tt class="py-op">.</tt><tt id="link-921" class="py-name"><a title="lib.structure.internal.object.Internal.add_atom
lib.structure.internal.selection.Internal_selection.add_atom
pipe_control.structure.main.add_atom" class="py-name" href="#" onclick="return doclink('link-921', 'add_atom', 'link-121');">add_atom</a></tt><tt class="py-op">(</tt><tt class="py-name">mol_name</tt><tt class="py-op">=</tt><tt class="py-name">mol_names</tt><tt class="py-op">[</tt><tt class="py-name">atom_index</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt class="py-name">atom_names</tt><tt class="py-op">[</tt><tt class="py-name">atom_index</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-name">res_names</tt><tt class="py-op">[</tt><tt class="py-name">atom_index</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-name">res_nums</tt><tt class="py-op">[</tt><tt class="py-name">atom_index</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt><tt class="py-op">=</tt><tt class="py-name">coord</tt><tt class="py-op">[</tt><tt class="py-name">struct_index</tt><tt class="py-op">,</tt> <tt class="py-name">atom_index</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt id="link-922" class="py-name"><a title="lib.periodic_table.element" class="py-name" href="#" onclick="return doclink('link-922', 'element', 'link-122');">element</a></tt><tt class="py-op">=</tt><tt id="link-923" class="py-name"><a title="gui.analyses.elements" class="py-name" href="#" onclick="return doclink('link-923', 'elements', 'link-142');">elements</a></tt><tt class="py-op">[</tt><tt class="py-name">atom_index</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">sort</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt> </tt>
<a name="L1666"></a><tt class="py-lineno">1666</tt>  <tt class="py-line"> </tt>
<a name="L1667"></a><tt class="py-lineno">1667</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the structures again, this time twice.</tt> </tt>
<a name="L1668"></a><tt class="py-lineno">1668</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">k</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">ids</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1669"></a><tt class="py-lineno">1669</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">l</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">ids</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1670"></a><tt class="py-lineno">1670</tt>  <tt class="py-line">                <tt class="py-comment"># Skip identical atoms.</tt> </tt>
<a name="L1671"></a><tt class="py-lineno">1671</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">k</tt> <tt class="py-op">==</tt> <tt class="py-name">l</tt><tt class="py-op">:</tt> </tt>
<a name="L1672"></a><tt class="py-lineno">1672</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L1673"></a><tt class="py-lineno">1673</tt>  <tt class="py-line"> </tt>
<a name="L1674"></a><tt class="py-lineno">1674</tt>  <tt class="py-line">                <tt class="py-comment"># The atom index.</tt> </tt>
<a name="L1675"></a><tt class="py-lineno">1675</tt>  <tt class="py-line">                <tt class="py-name">index1</tt> <tt class="py-op">=</tt> <tt class="py-name">atom_index</tt><tt class="py-op">*</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">ids</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-name">k</tt> </tt>
<a name="L1676"></a><tt class="py-lineno">1676</tt>  <tt class="py-line">                <tt class="py-name">index2</tt> <tt class="py-op">=</tt> <tt class="py-name">atom_index</tt><tt class="py-op">*</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">ids</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-name">l</tt> </tt>
<a name="L1677"></a><tt class="py-lineno">1677</tt>  <tt class="py-line"> </tt>
<a name="L1678"></a><tt class="py-lineno">1678</tt>  <tt class="py-line">                <tt class="py-comment"># Connect to the previous atoms.</tt> </tt>
<a name="L1679"></a><tt class="py-lineno">1679</tt>  <tt class="py-line">                <tt class="py-name">web</tt><tt class="py-op">.</tt><tt id="link-924" class="py-name"><a title="lib.structure.internal.object.Internal.connect_atom
pipe_control.structure.main.connect_atom" class="py-name" href="#" onclick="return doclink('link-924', 'connect_atom', 'link-290');">connect_atom</a></tt><tt class="py-op">(</tt><tt class="py-name">mol_name</tt><tt class="py-op">=</tt><tt class="py-name">mol_names</tt><tt class="py-op">[</tt><tt class="py-name">atom_index</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">index1</tt><tt class="py-op">=</tt><tt class="py-name">index1</tt><tt class="py-op">,</tt> <tt class="py-name">index2</tt><tt class="py-op">=</tt><tt class="py-name">index2</tt><tt class="py-op">)</tt> </tt>
<a name="L1680"></a><tt class="py-lineno">1680</tt>  <tt class="py-line"> </tt>
<a name="L1681"></a><tt class="py-lineno">1681</tt>  <tt class="py-line">    <tt class="py-comment"># Append the PDB extension if needed.</tt> </tt>
<a name="L1682"></a><tt class="py-lineno">1682</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">isinstance</tt><tt class="py-op">(</tt><tt id="link-925" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-925', 'file', 'link-266');">file</a></tt><tt class="py-op">,</tt> <tt class="py-name">str</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1683"></a><tt class="py-lineno">1683</tt>  <tt class="py-line">        <tt class="py-comment"># The file path.</tt> </tt>
<a name="L1684"></a><tt class="py-lineno">1684</tt>  <tt class="py-line">        <tt id="link-926" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-926', 'file', 'link-266');">file</a></tt> <tt class="py-op">=</tt> <tt id="link-927" class="py-name"><a title="lib.io.get_file_path" class="py-name" href="#" onclick="return doclink('link-927', 'get_file_path', 'link-28');">get_file_path</a></tt><tt class="py-op">(</tt><tt id="link-928" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-928', 'file', 'link-266');">file</a></tt><tt class="py-op">,</tt> <tt id="link-929" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-929', 'dir', 'link-268');">dir</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1685"></a><tt class="py-lineno">1685</tt>  <tt class="py-line"> </tt>
<a name="L1686"></a><tt class="py-lineno">1686</tt>  <tt class="py-line">        <tt class="py-comment"># Add '.pdb' to the end of the file path if it isn't there yet.</tt> </tt>
<a name="L1687"></a><tt class="py-lineno">1687</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-930" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-930', 'search', 'link-6');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">".pdb$"</tt><tt class="py-op">,</tt> <tt id="link-931" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-931', 'file', 'link-266');">file</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1688"></a><tt class="py-lineno">1688</tt>  <tt class="py-line">            <tt id="link-932" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-932', 'file', 'link-266');">file</a></tt> <tt class="py-op">+=</tt> <tt class="py-string">'.pdb'</tt> </tt>
<a name="L1689"></a><tt class="py-lineno">1689</tt>  <tt class="py-line"> </tt>
<a name="L1690"></a><tt class="py-lineno">1690</tt>  <tt class="py-line">    <tt class="py-comment"># Open the file for writing.</tt> </tt>
<a name="L1691"></a><tt class="py-lineno">1691</tt>  <tt class="py-line">    <tt id="link-933" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-933', 'file', 'link-266');">file</a></tt> <tt class="py-op">=</tt> <tt id="link-934" class="py-name"><a title="lib.io.open_write_file" class="py-name" href="#" onclick="return doclink('link-934', 'open_write_file', 'link-29');">open_write_file</a></tt><tt class="py-op">(</tt><tt id="link-935" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-935', 'file', 'link-266');">file</a></tt><tt class="py-op">,</tt> <tt class="py-name">force</tt><tt class="py-op">=</tt><tt class="py-name">force</tt><tt class="py-op">)</tt> </tt>
<a name="L1692"></a><tt class="py-lineno">1692</tt>  <tt class="py-line"> </tt>
<a name="L1693"></a><tt class="py-lineno">1693</tt>  <tt class="py-line">    <tt class="py-comment"># Write the structure.</tt> </tt>
<a name="L1694"></a><tt class="py-lineno">1694</tt>  <tt class="py-line">    <tt class="py-name">web</tt><tt class="py-op">.</tt><tt id="link-936" class="py-name"><a title="lib.structure.internal.object.Internal.write_pdb
pipe_control.structure.main.write_pdb" class="py-name" href="#" onclick="return doclink('link-936', 'write_pdb', 'link-399');">write_pdb</a></tt><tt class="py-op">(</tt><tt id="link-937" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-937', 'file', 'link-266');">file</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L1695"></a><tt class="py-lineno">1695</tt>  <tt class="py-line"> </tt>
<a name="L1696"></a><tt class="py-lineno">1696</tt>  <tt class="py-line"> </tt>
<a name="write_pdb"></a><div id="write_pdb-def"><a name="L1697"></a><tt class="py-lineno">1697</tt> <a class="py-toggle" href="#" id="write_pdb-toggle" onclick="return toggle('write_pdb');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="pipe_control.structure.main-module.html#write_pdb">write_pdb</a><tt class="py-op">(</tt><tt class="py-param">file</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">dir</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">model_num</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">compress_type</tt><tt class="py-op">=</tt><tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-param">force</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="write_pdb-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="write_pdb-expanded"><a name="L1698"></a><tt class="py-lineno">1698</tt>  <tt class="py-line">    <tt class="py-docstring">"""The PDB writing function.</tt> </tt>
<a name="L1699"></a><tt class="py-lineno">1699</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1700"></a><tt class="py-lineno">1700</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword file:          The name of the PDB file to write.  This can also be a file instance.</tt> </tt>
<a name="L1701"></a><tt class="py-lineno">1701</tt>  <tt class="py-line"><tt class="py-docstring">    @type file:             str or file instance</tt> </tt>
<a name="L1702"></a><tt class="py-lineno">1702</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword dir:           The directory where the PDB file will be placed.  If set to None, then the file will be placed in the current directory.</tt> </tt>
<a name="L1703"></a><tt class="py-lineno">1703</tt>  <tt class="py-line"><tt class="py-docstring">    @type dir:              str or None</tt> </tt>
<a name="L1704"></a><tt class="py-lineno">1704</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword model_num:     The model to place into the PDB file.  If not supplied, then all models will be placed into the file.</tt> </tt>
<a name="L1705"></a><tt class="py-lineno">1705</tt>  <tt class="py-line"><tt class="py-docstring">    @type model_num:        None or int</tt> </tt>
<a name="L1706"></a><tt class="py-lineno">1706</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword compress_type: The compression type.  The integer values correspond to the compression type: 0, no compression; 1, Bzip2 compression; 2, Gzip compression.</tt> </tt>
<a name="L1707"></a><tt class="py-lineno">1707</tt>  <tt class="py-line"><tt class="py-docstring">    @type compress_type:    int</tt> </tt>
<a name="L1708"></a><tt class="py-lineno">1708</tt>  <tt class="py-line"><tt class="py-docstring">    @keyword force:         The force flag which if True will cause the file to be overwritten.</tt> </tt>
<a name="L1709"></a><tt class="py-lineno">1709</tt>  <tt class="py-line"><tt class="py-docstring">    @type force:            bool</tt> </tt>
<a name="L1710"></a><tt class="py-lineno">1710</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L1711"></a><tt class="py-lineno">1711</tt>  <tt class="py-line"> </tt>
<a name="L1712"></a><tt class="py-lineno">1712</tt>  <tt class="py-line">    <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L1713"></a><tt class="py-lineno">1713</tt>  <tt class="py-line">    <tt id="link-938" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-938', 'check_pipe', 'link-100');">check_pipe</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1714"></a><tt class="py-lineno">1714</tt>  <tt class="py-line"> </tt>
<a name="L1715"></a><tt class="py-lineno">1715</tt>  <tt class="py-line">    <tt class="py-comment"># Check if the structural object exists.</tt> </tt>
<a name="L1716"></a><tt class="py-lineno">1716</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1717"></a><tt class="py-lineno">1717</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-939" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-939', 'RelaxError', 'link-20');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"No structural data is present in the current data pipe."</tt><tt class="py-op">)</tt> </tt>
<a name="L1718"></a><tt class="py-lineno">1718</tt>  <tt class="py-line"> </tt>
<a name="L1719"></a><tt class="py-lineno">1719</tt>  <tt class="py-line">    <tt class="py-comment"># Path handling.</tt> </tt>
<a name="L1720"></a><tt class="py-lineno">1720</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">isinstance</tt><tt class="py-op">(</tt><tt id="link-940" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-940', 'file', 'link-266');">file</a></tt><tt class="py-op">,</tt> <tt class="py-name">str</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1721"></a><tt class="py-lineno">1721</tt>  <tt class="py-line">        <tt class="py-comment"># The file path.</tt> </tt>
<a name="L1722"></a><tt class="py-lineno">1722</tt>  <tt class="py-line">        <tt id="link-941" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-941', 'file', 'link-266');">file</a></tt> <tt class="py-op">=</tt> <tt id="link-942" class="py-name"><a title="lib.io.get_file_path" class="py-name" href="#" onclick="return doclink('link-942', 'get_file_path', 'link-28');">get_file_path</a></tt><tt class="py-op">(</tt><tt id="link-943" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-943', 'file', 'link-266');">file</a></tt><tt class="py-op">,</tt> <tt id="link-944" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-944', 'dir', 'link-268');">dir</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1723"></a><tt class="py-lineno">1723</tt>  <tt class="py-line"> </tt>
<a name="L1724"></a><tt class="py-lineno">1724</tt>  <tt class="py-line">        <tt class="py-comment"># Add '.pdb' to the end of the file path if it isn't there yet.</tt> </tt>
<a name="L1725"></a><tt class="py-lineno">1725</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-945" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-945', 'search', 'link-6');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">".pdb$"</tt><tt class="py-op">,</tt> <tt id="link-946" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-946', 'file', 'link-266');">file</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1726"></a><tt class="py-lineno">1726</tt>  <tt class="py-line">            <tt id="link-947" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-947', 'file', 'link-266');">file</a></tt> <tt class="py-op">=</tt> <tt id="link-948" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-948', 'file', 'link-266');">file</a></tt> <tt class="py-op">+</tt> <tt class="py-string">'.pdb'</tt> </tt>
<a name="L1727"></a><tt class="py-lineno">1727</tt>  <tt class="py-line"> </tt>
<a name="L1728"></a><tt class="py-lineno">1728</tt>  <tt class="py-line">    <tt class="py-comment"># Open the file for writing.</tt> </tt>
<a name="L1729"></a><tt class="py-lineno">1729</tt>  <tt class="py-line">    <tt id="link-949" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-949', 'file', 'link-266');">file</a></tt> <tt class="py-op">=</tt> <tt id="link-950" class="py-name"><a title="lib.io.open_write_file" class="py-name" href="#" onclick="return doclink('link-950', 'open_write_file', 'link-29');">open_write_file</a></tt><tt class="py-op">(</tt><tt id="link-951" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-951', 'file', 'link-266');">file</a></tt><tt class="py-op">,</tt> <tt class="py-name">compress_type</tt><tt class="py-op">=</tt><tt class="py-name">compress_type</tt><tt class="py-op">,</tt> <tt class="py-name">force</tt><tt class="py-op">=</tt><tt class="py-name">force</tt><tt class="py-op">)</tt> </tt>
<a name="L1730"></a><tt class="py-lineno">1730</tt>  <tt class="py-line"> </tt>
<a name="L1731"></a><tt class="py-lineno">1731</tt>  <tt class="py-line">    <tt class="py-comment"># Write the structures.</tt> </tt>
<a name="L1732"></a><tt class="py-lineno">1732</tt>  <tt class="py-line">    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-952" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-952', 'structure', 'link-48');">structure</a></tt><tt class="py-op">.</tt><tt id="link-953" class="py-name"><a title="lib.structure.internal.object.Internal.write_pdb
pipe_control.structure.main.write_pdb" class="py-name" href="#" onclick="return doclink('link-953', 'write_pdb', 'link-399');">write_pdb</a></tt><tt class="py-op">(</tt><tt id="link-954" class="py-name"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-954', 'file', 'link-266');">file</a></tt><tt class="py-op">,</tt> <tt class="py-name">model_num</tt><tt class="py-op">=</tt><tt class="py-name">model_num</tt><tt class="py-op">)</tt> </tt>
</div><a name="L1733"></a><tt class="py-lineno">1733</tt>  <tt class="py-line"> </tt><script type="text/javascript">
<!--
expandto(location.href);
// -->
</script>
</pre>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://www.nmr-relax.com">relax</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Thu Apr  2 10:37:05 2015
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
