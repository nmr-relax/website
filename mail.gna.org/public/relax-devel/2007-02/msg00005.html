<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: r3033 &#45; /1.3/test_suite/unit_tests/unit_test_runner.py -->
<!--X-From-R13: "Unel E. Fubzcfba" <tnelgNozo.yrrqf.np.hx> -->
<!--X-Date: Tue, 20 Feb 2007 14:48:25 +0100 -->
<!--X-Message-Id: 45DAFBFA.2080905@bmb.leeds.ac.uk -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: E1HJRp5&#45;0002y9&#45;CP@subversion.gna.org -->
<!--X-Reference: 7f080ed10702200524q712fb97vc2915f52e4709477@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: r3033 - /1.3/test_suite/unit_tests/unit_test_runner.py -- February 20, 2007 - 14:48</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: r3033 - /1.3/test_suite/unit_tests/unit_test_runner.py</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00005" class="tabs">Index by Date</a> | <a href="threads.html#00005" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00004.html">Date Prev</a>] [<a href="msg00006.html">Date Next</a>] [<a href="msg00004.html">Thread Prev</a>] [<a href="msg00007.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Edward d'Auvergne &lt;edward.dauvergne@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Tue, 20 Feb 2007 13:47:38 +0000</li>
<li class="menuitem">
<em>Cc</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00005.html">45DAFBFA.2080905@bmb.leeds.ac.uk</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;E1HJRp5-0002y9-CP@subversion.gna.org&gt;	&lt;<a href="msg00004.html">7f080ed10702200524q712fb97vc2915f52e4709477@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>User-agent</em>: Mozilla Thunderbird 1.0 (X11/20041206)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Gary S. Thompson</strong> on February 20, 2007 - 14:48:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Edward d'Auvergne wrote:</pre><br>
<blockquote class="blockquote"><pre style="margin: 0em;">Gary,</pre><br>
<tt>You probably noticed that I've modified your code to return the status<br>
of the unit tests.  This was a quick change that I made so that the<br>
--test-suite command line argument functions correctly in the 1.3.0<br>
release.  Do you think this will this cause any problems, especially<br>
for stand along operation?  
</tt></blockquote><pre style="margin: 0em;"><br></pre><br>
<tt>I can't see that it will. At the moment you need to wrap it in a try 
except wich is messy and is just a flaw in the feature set ;-)</tt><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">Also, do you know how we could get
individual unit tests to run 'out of the box', i.e. you don't need to
manually set any paths?
</pre></blockquote><tt><br>Is this inside relax or is stand alone on the command line? If it is the 
latter that was what I was looking at this morning. You just make 
unit_test_runner.py executable and give it the name of directory with 
some unit tests in it or give it the name of a python source file with a 
single unit test in it... However, as you can see i am having problems 
with the __builtins__ namespace 
<a  href="http://www.nmr-relax.com/mail.gna.org/public/relax-devel/2007-02/msg00003.html">https://mail.gna.org/public/relax-devel/2007-02/msg00003.html</a></tt><br>
<br>
<tt><br>The other thing to say here is that the use of global variables in a 
threaded version of relax could be annoying vearing on  to the dangerous 
so we do need to head towards some form of thread local storage fopr 
'pseudo globals'...</tt><br>
<br>
<pre style="margin: 0em;">regards
gary</pre><br>
<blockquote class="blockquote"><pre style="margin: 0em;"><br>Cheers,</pre><br>
<pre style="margin: 0em;">Edward</pre><br>
<pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">On 2/20/07, garyt@xxxxxxxxxxxxxxx &lt;garyt@xxxxxxxxxxxxxxx&gt; wrote:</pre><br>
<blockquote class="blockquote"><pre style="margin: 0em;">Author: varioustoxins
Date: Tue Feb 20 11:02:10 2007
New Revision: 3033</pre><br>
<pre style="margin: 0em;">URL: <a  href="http://svn.gna.org/viewcvs/relax?rev=3033&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=3033&amp;view=rev</a>
Log:
changes to allow command line unit tests to run</pre><br>
<pre style="margin: 0em;">Modified:
    1.3/test_suite/unit_tests/unit_test_runner.py</pre><br>
<tt>Modified: 1.3/test_suite/unit_tests/unit_test_runner.py<br>
URL: 
<a  href="http://svn.gna.org/viewcvs/relax/1.3/test_suite/unit_tests/unit_test_runner.py?rev=3033&amp;r1=3032&amp;r2=3033&amp;view=diff">http://svn.gna.org/viewcvs/relax/1.3/test_suite/unit_tests/unit_test_runner.py?rev=3033&amp;r1=3032&amp;r2=3033&amp;view=diff</a> </tt><br>
<br>
<tt>============================================================================== </tt><br>
<br>
<tt>--- 1.3/test_suite/unit_tests/unit_test_runner.py (original)<br>
+++ 1.3/test_suite/unit_tests/unit_test_runner.py Tue Feb 20 11:02:10 
2007<br>
@@ -475,23 +475,35 @@<br>
             print 'unit test directory:', unit_test_directory<br>
             print 'module paths:       ', module_path<br>
             print<br>
+<br>
         # add UnitTestDirectory to python path<br>
         backup_python_path = sys.path[:]<br>
-        sys.path.insert(1,unit_test_directory)<br>
-        sys.path.insert(1,system_directory)<br>
-<br>
+        #sys.path.insert(1,unit_test_directory)<br>
+<br>
+        # add SystemDirectory to python path<br>
+        sys.path.pop(0)<br>
+        sys.path.insert(0,system_directory)<br>
+<br>
+<br>
+        print sys.path</tt><br>
<br>
<pre style="margin: 0em;">         #iterate and load unit tests from module path
         finder = Test_finder(unit_test_directory)
         finder.scan_paths()
         if runner == None:
             runner = unittest.TextTestRunner()
-        # add SystemDirectory to python path
+
+
+
+
         # iterate and load files to be tested</pre><br>
<pre style="margin: 0em;">         # Run the unit tests and catch the TestResult object.
         results = runner.run(finder.suite)</pre><br>
<pre style="margin: 0em;">+        # restore sys  path
+        sys.path=backup_python_path
+
         # Return the result of all the tests.
         return results.wasSuccessful()</pre><br>
<pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">_______________________________________________
relax (<a  href="http://nmr-relax.com">http://nmr-relax.com</a>)</pre><br>
<pre style="margin: 0em;">This is the relax-commits mailing list
relax-commits@xxxxxxx</pre><br>
<pre style="margin: 0em;">To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  href="http://www.nmr-relax.com/mail.gna.org/listinfo/relax-commits">https://mail.gna.org/listinfo/relax-commits</a></pre><br>
</blockquote><pre style="margin: 0em;"><br>.</pre><br>
</blockquote><pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">--
-------------------------------------------------------------------
Dr Gary Thompson
Astbury Centre for Structural Molecular Biology,
University of Leeds, Astbury Building,
Leeds, LS2 9JT, West-Yorkshire, UK             Tel. +44-113-3433024
email: garyt@xxxxxxxxxxxxxxx                   Fax  +44-113-2331407
-------------------------------------------------------------------</pre><br>
<pre style="margin: 0em;"><br></pre><br>
<br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00007" href="msg00007.html">Re: r3033 - /1.3/test_suite/unit_tests/unit_test_runner.py</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00004" href="msg00004.html">Re: r3033 - /1.3/test_suite/unit_tests/unit_test_runner.py</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Tue Feb 20 15:40:28 2007</div>  
</body>
</html>
