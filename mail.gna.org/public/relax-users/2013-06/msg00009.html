<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: Custom Peak intensity reading -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Thu, 06 Jun 2013 16:52:07 +0200 -->
<!--X-Message-Id: CAED9pY9N66ydqJj1gaCV=haHgEb5K+_0o0CgA3iFY_4n&#45;kEAJA@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: CA+CBx2OPzU6gGWwDAdTJav2OgM9HmLXGmTaMrnnwR75TPECxvg@mail.gmail.com -->
<!--X-Reference: CAED9pY&#45;5MnF0WHpvSTqC_&#45;HgoXT8dTKLiqEZGsoq6bK2v+EEzQ@mail.gmail.com -->
<!--X-Reference: CAED9pY&#45;B8REWuf7S8dGr2DwH_8ned9ya7&#45;QjJPcL3WdMg1pU9A@mail.gmail.com -->
<!--X-Reference: CA+CBx2Mxt+wUAiLWA_zo_Z2XRcVf5XPWh5rsaVPt&#45;oj+ALyyKg@mail.gmail.com -->
<!--X-Reference: CA+CBx2OUyw56iie1W45ngmk7TwZjcfK5QL&#45;zA_PWv3DG96_69g@mail.gmail.com -->
<!--X-Reference: CAED9pY91jJGX=Ynt+Go7NYzhpzt6C_ZFNEaAD8km3XWsUouY2g@mail.gmail.com -->
<!--X-Reference: CAED9pY&#45;p88Whwo5rzKx75ugD4oTXC8vsbqzAOJ1r56CjokQUbQ@mail.gmail.com -->
<!--X-Reference: CA+CBx2NzvADfUV4aY8gwEqRnPD4QR7bzja9ZsQPYHEUmV=_9YA@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Custom Peak intensity reading -- June 06, 2013 - 16:52</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Custom Peak intensity reading</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00009" class="tabs">Index by Date</a> | <a href="threads.html#00009" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00008.html">Date Prev</a>] [<a href="msg00010.html">Date Next</a>] [<a href="msg00008.html">Thread Prev</a>] [<a href="msg00010.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Thu, 6 Jun 2013 16:51:36 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-users@xxxxxxx&quot; &lt;relax-users@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113;	h=mime-version:sender:in-reply-to:references:date	:x-google-sender-auth:message-id:subject:from:to:cc:content-type	:content-transfer-encoding;	bh=8rRPdmHM3GziIJTNpVYVoMpdGWl19o/oXYwj4AzVSQ8=;	b=zHlR2E3XZ3PCIPO6bPaTJwk5EvWzPp/Y/YuSUOSZskZDDxpCrkVidTouKFT0ZPwblq	X/iALD/n/pxiys6s50CQa0RDYbWqsoXD6O1+in43gnaZ0WHDnBUGTU9WHmv9AZn+eSm5	c97qh4AplOKI/LOWtVA4+06D1Gw80jxqvu0FpsVwRZ0C6lASwajwWQsRvWy7LGrh3ZD2	GRMDH5F4wxY9b8Y+Nxmm7IMb8fgbHGLk6qg4ZCNwwNbM6uzS6qzDsz3WeOEbfMz5GKBG	+sV5sxKWVZ0ZbRvipd9gLU71CDGx9Irj3n/42+DDFNLocJBTR4xAJ2N912LUB6hb99Tv	ukMQ==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00009.html">CAED9pY9N66ydqJj1gaCV=haHgEb5K+_0o0CgA3iFY_4n-kEAJA@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;CA+CBx2OPzU6gGWwDAdTJav2OgM9HmLXGmTaMrnnwR75TPECxvg@xxxxxxxxxxxxxx&gt;	&lt;CAED9pY-5MnF0WHpvSTqC_-HgoXT8dTKLiqEZGsoq6bK2v+EEzQ@xxxxxxxxxxxxxx&gt;	&lt;CAED9pY-B8REWuf7S8dGr2DwH_8ned9ya7-QjJPcL3WdMg1pU9A@xxxxxxxxxxxxxx&gt;	&lt;CA+CBx2Mxt+wUAiLWA_zo_Z2XRcVf5XPWh5rsaVPt-oj+ALyyKg@xxxxxxxxxxxxxx&gt;	&lt;CA+CBx2OUyw56iie1W45ngmk7TwZjcfK5QL-zA_PWv3DG96_69g@xxxxxxxxxxxxxx&gt;	&lt;CAED9pY91jJGX=Ynt+Go7NYzhpzt6C_ZFNEaAD8km3XWsUouY2g@xxxxxxxxxxxxxx&gt;	&lt;CAED9pY-p88Whwo5rzKx75ugD4oTXC8vsbqzAOJ1r56CjokQUbQ@xxxxxxxxxxxxxx&gt;	&lt;CA+CBx2NzvADfUV4aY8gwEqRnPD4QR7bzja9ZsQPYHEUmV=_9YA@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on June 06, 2013 - 16:52:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">This is part of the bug and is the same reason you saw an error in the
GUI.  If you look at the file user_functions/spectrum.py in the relax
trunk source code and go to line 236 (for the current revision
r19893), you should be able to see the issue.

Regards,

Edward


On 6 June 2013 16:44, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">In the relax prompt, this can produce the error:

---------------------
pipe.create(pipe_name='origin rx', pipe_type='relax_disp', bundle='rx')
relax_disp.exp_type(exp_type='cpmg fixed')

sequence.read(file='/sbinlab2/tlinnet/Desktop/test.seq',
dir=None, spin_id_col=None, mol_name_col=1, res_num_col=2,
res_name_col=3, spin_num_col=4, spin_name_col=5, sep=None,
spin_id=None)

spectrum.read_intensities(file='/sbinlab2/tlinnet/Desktop/test.seq',
dir=None, spectrum_id=(2,0), heteronuc='N', proton='HN',
int_method='height', int_col=(6, 7), spin_id_col=None, mol_name_col=1,
res_num_col=2, res_name_col=3, spin_num_col=4, spin_name_col=5,
sep=None, spin_id=None, ncproc=None)

  File &quot;&lt;input&gt;&quot;, line 3, in &lt;module&gt;
  File &quot;/sbinlab2/software/NMR-relax/relax_disp/prompt/uf_objects.py&quot;,
line 200, in __call__
    lib.arg_check.is_str(value, desc_short, can_be_none=can_be_none)
  File &quot;/sbinlab2/software/NMR-relax/relax_disp/lib/arg_check.py&quot;,
line 862, in is_str
    raise RelaxStrError(name, arg)
RelaxStrError:  [31mRelaxError: The spectrum ID string argument '(2,
0)' must be a string. [0m
-----------------------------------------





2013/6/6 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">On a different note, if you notice anywhere in relax's execution where
the messages are not informative enough, are misleading, or where
additional messages would be useful, these can all be reported as
bugs.  Anything in relax that causes confusion should be considered a
bug which should be fixed.

Regards,

Edward



On 6 June 2013 15:26, Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Oh, right, I see the problem.  This user function currently only has
partial support for simultaneously loading all spectral data at once.
The current way to do this is to change the spectrum ID and intensity
column one-by-one while clicking on 'Apply' as you go.  But I have
partly designed this user function to handle this situation, according
to the user function documentation:

&quot;Generic intensity file:  This is a generic format which can be
created by scripting to support non-supported peak lists.  It should
contain in the first few columns enough information to identify the
spin.  This can include columns for the molecule name, residue number,
residue name, spin number, and spin name.  Alternatively a spin ID
string column can be used. The peak intensities can be placed in
another column specified by the integration column number.
Intensities from multiple spectra can be placed into different
columns, and these can then be specified simultaneously by setting the
integration column value to a list of columns.  This list must be
matched by setting the spectrum ID to a list of the same length...&quot;

Could you submit a bug report for this, attaching any files required
to replicate the bug?  It would be useful to give a link to the Gmane
archive as well (going to
<a  rel="nofollow" href="http://dir.gmane.org/gmane.science.nmr.relax.user">http://dir.gmane.org/gmane.science.nmr.relax.user</a> -&gt; clicking on
&quot;using frames and threads&quot; -&gt; finding message -&gt; clicking on &quot;&lt;&lt;&lt;
[thread] &gt;&gt;&gt;&quot; down the botton -&gt; and copying the link).  I could then
turn the instructions into a relax script, and incorporate both the
script and data files into the test suite directories and create a
system test to catch the bug.  Or, if you wish, as a learning exercise
for becoming a relax developer you could give this a go yourself after
creating the report.  This would all go into the relax trunk, and then
be ported to the relax_disp branch using svnmerge.py.

Cheers,

Edward



On 6 June 2013 15:04, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">I think it is because that:
spectrum_id='(2,6)'

is translated to a string.

Could it be corrected, so it does similar as:
int_col=(6, 7)

Best
Troels Emtekær Linnet


2013/6/6 Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxx&gt;:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

No, not any luck.
And, this time I am not renaming.

Where can I find the longer error message?
---------
Add spectra
Click &quot;Add&quot;

The file name = test.seq
The Spectrum ID string: 2,0
The Intensity column: 6,7
----------------
protein 10 L 10 N 3.377659e+05 6.362446e+05
protein 6 V 6 N 1.697771e+06 3.015788e+06
protein 63 Y 63 N 8.673898e+05 1.726064e+06
protein 4 Y 4 N 2.339480e+06 4.039142e+06
protein 67 M 67 N 2.574062e+06 4.313824e+06
protein 5 E 5 N 1.609356e+06 2.927111e+06
protein 65 V 65 N 2.179341e+06 4.067343e+06
protein 38 E 38 N 1.563795e+06 2.921316e+06
protein 7 N 7 N 1.535896e+06 3.005234e+06
protein 75 L 75 N 3.578841e+06 6.352595e+06
------------------------

----------
relax&gt; relax_disp.exp_type(exp_type='cpmg fixed')
The fixed relaxation time period CPMG-type experiments.

relax&gt; 
sequence.read(file='/sbinlab2/tlinnet/Desktop/ikn_20130510_S6wt_N15cpmgEX_nyproc.fid/CPMG_CPMG_0/relax_disp/test.seq',
dir=None, spin_id_col=None, mol_name_col=1, res_num_col=2,
res_name_col=3, spin_num_col=4, spin_name_col=5, sep=None,
spin_id=None)
Opening the file
'/sbinlab2/tlinnet/Desktop/ikn_20130510_S6wt_N15cpmgEX_nyproc.fid/CPMG_CPMG_0/relax_disp/test.seq'
for reading.
# mol_name    res_num    res_name    spin_num    spin_name
protein       10         L           10          N
protein       6          V           6           N
protein       63         Y           63          N
protein       4          Y           4           N
protein       67         M           67          N
protein       5          E           5           N
protein       65         V           65          N
protein       38         E           38          N
protein       7          N           7           N
protein       75         L           75          N

relax&gt; 
spectrum.read_intensities(file='/sbinlab2/tlinnet/Desktop/ikn_20130510_N15cpmgEX_nyproc.fid/CPMG_CPMG_0/relax_disp/test.seq',
dir=None, spectrum_id='2,0', heteronuc='N', proton='HN',
int_method='height', int_col=(6, 7), spin_id_col=None, mol_name_col=1,
res_num_col=2, res_name_col=3, spin_num_col=4, spin_name_col=5,
sep=None, spin_id=None, ncproc=None)
Opening the file
'/sbinlab2/tlinnet/Desktop/ikn_20130510_N15cpmgEX_nyproc.fid/CPMG_CPMG_0/relax_disp/test.seq'
for reading.
Generic formatted data file.

RelaxWarning: The sequence data in the line ['protein', '10', 'L',
'10', 'N', '3.377659e+05', '6.362446e+05'] is invalid, the data is
missing.
RelaxWarning: The sequence data in the line ['protein', '6', 'V', '6',
'N', '1.697771e+06', '3.015788e+06'] is invalid, the data is missing.
RelaxWarning: The sequence data in the line ['protein', '63', 'Y',
'63', 'N', '8.673898e+05', '1.726064e+06'] is invalid, the data is
missing.
RelaxWarning: The sequence data in the line ['protein', '4', 'Y', '4',
'N', '2.339480e+06', '4.039142e+06'] is invalid, the data is missing.
RelaxWarning: The sequence data in the line ['protein', '67', 'M',
'67', 'N', '2.574062e+06', '4.313824e+06'] is invalid, the data is
missing.
RelaxWarning: The sequence data in the line ['protein', '5', 'E', '5',
'N', '1.609356e+06', '2.927111e+06'] is invalid, the data is missing.
RelaxWarning: The sequence data in the line ['protein', '65', 'V',
'65', 'N', '2.179341e+06', '4.067343e+06'] is invalid, the data is
missing.
RelaxWarning: The sequence data in the line ['protein', '38', 'E',
'38', 'N', '1.563795e+06', '2.921316e+06'] is invalid, the data is
missing.
RelaxWarning: The sequence data in the line ['protein', '7', 'N', '7',
'N', '1.535896e+06', '3.005234e+06'] is invalid, the data is missing.
RelaxWarning: The sequence data in the line ['protein', '75', 'L',
'75', 'N', '3.578841e+06', '6.352595e+06'] is invalid, the data is
missing.
RelaxError: No corresponding data could be found within the file.

-------------------------------

Troels Emtekær Linnet


2013/6/6 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

Have you had any luck finding the problem?  I would guess that this
doesn't work as the protein was renamed to something different to that
of the data file, hence you would see messages such as:

relax&gt; spectrum.read_intensities(file='test.seq', dir=None,
spectrum_id=None, heteronuc='N', proton='HN', int_method='height',
int_col=6, spin_id_col=None, mol_name_col=1, res_num_col=2,
res_name_col=3, spin_num_col=4, spin_name_col=5, int_col=6, sep=None,
spin_id=None, ncproc=None)
Opening the file '/data/edau/relax/branches/relax_disp/test.seq' for 
reading.
Generic formatted data file.

RelaxWarning: Cannot find the spin #protein:10@N within the sequence.
RelaxWarning: Cannot find the spin #protein:6@N within the sequence.
RelaxWarning: Cannot find the spin #protein:63@N within the sequence.
RelaxWarning: Cannot find the spin #protein:4@N within the sequence.
RelaxWarning: Cannot find the spin #protein:67@N within the sequence.
RelaxWarning: Cannot find the spin #protein:5@N within the sequence.
RelaxWarning: Cannot find the spin #protein:65@N within the sequence.
RelaxWarning: Cannot find the spin #protein:38@N within the sequence.
RelaxWarning: Cannot find the spin #protein:7@N within the sequence.
RelaxWarning: Cannot find the spin #protein:75@N within the sequence.
RelaxError: No data could be loaded from the peak list

I tried this by copying the data in your post to a file and following
the instructions.  This is normal as the molecule with the name
'protein' no longer exists in the relax data store.  Or did you see
something different?  The RelaxError text you wrote about is slightly
different.

Regards,

Edward


On 4 June 2013 15:10, Edward d'Auvergne &lt;edward.dauvergne@xxxxxxxxx&gt; 
wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">I have to admit, the error message should be made more informative!
However that error statement (line 668 of lib/io.py) cannot be reached
without relax giving many warnings.  The only possibility of reaching
the error without warnings is if the file is empty.  Do you see
warnings which could indicate the problem?  If not, I would suggest
creating a bug report for the problem and attaching a minimal set of
files to be able to reproduce the issue.  It would be best if the
files are truncated to 1-2 spins (and maybe randomised if the data is
to be kept secret).  If it really is a bug, then these files could be
be added to the test suite and turned into a system or GUI test to
catch the problem.

Cheers,

Edward


On 4 June 2013 14:37, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi.

I have made a custom intensity peak/model file, for easy import in 
relax.
The form is:

protein 10 L 10 N 3.377659e+05 6.362446e+05
protein 6 V 6 N 1.697771e+06 3.015788e+06
protein 63 Y 63 N 8.673898e+05 1.726064e+06
protein 4 Y 4 N 2.339480e+06 4.039142e+06
protein 67 M 67 N 2.574062e+06 4.313824e+06
protein 5 E 5 N 1.609356e+06 2.927111e+06
protein 65 V 65 N 2.179341e+06 4.067343e+06
protein 38 E 38 N 1.563795e+06 2.921316e+06
protein 7 N 7 N 1.535896e+06 3.005234e+06
protein 75 L 75 N 3.578841e+06 6.352595e+06

This goes fine for model import, with standard settings.

Start new analysis
Relaxation dispersion analysis
Relaxation dispersion experiment type selection
CPMG, fixed time
Data pipe set up
The starting data pipe for the analysis = origin - relax_disp (Mon 
Jun
3 17:08:30 2013)
The data pipe bundle = relax_disp (Mon Jun 3 17:08:30 2013)

Click: Spin editor
Click: Load spins
Make a test file: test.seq

Click: From a file containing sequence data
The file name = test.seq
The spin ID string = Leave empty
Free format
Molecule name column (mol_name_col) = 1
Residue number column (res_num_col) = 2
Residue name column (res_name_col) = 3
Spin number column (spin_num_col) = 4
Spin name column (spin_name_col) = 5
You can then rename molecule by, right click &quot;Molecule: protein&quot;,
&quot;Name the molecule&quot;, Set &quot;The new molecule name&quot; to for example
&quot;Test&quot;. Apply, then OK.

Add spectra
Click &quot;Add&quot;

The file name = test.seq
The Spectrum ID string: 2,0
The Intensity column: 6,7
rest is default

Error:
No corresponding data could be found within the file.

I can import single wise.

best
Troels


Troels Emtekær Linnet

_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-users mailing list
relax-users@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-users">https://mail.gna.org/listinfo/relax-users</a>
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00001" href="msg00001.html">Custom Peak intensity reading</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00002" href="msg00002.html">Re: Custom Peak intensity reading</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00003" href="msg00003.html">Re: Custom Peak intensity reading</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00004" href="msg00004.html">Re: Custom Peak intensity reading</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00005" href="msg00005.html">Re: Custom Peak intensity reading</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00006" href="msg00006.html">Re: Custom Peak intensity reading</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00007" href="msg00007.html">Re: Custom Peak intensity reading</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00008" href="msg00008.html">Re: Custom Peak intensity reading</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu Jun 06 19:00:07 2013</div>  
</body>
</html>
