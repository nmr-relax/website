<!-- MHonArc v2.6.18 -->
<!--X-Subject: r26677 &#45; /branches/frame_order_cleanup/specific_analyses/frame_order/geometric.py -->
<!--X-From-R13: rqjneqNaze&#45;erynk.pbz -->
<!--X-Date: Fri, 21 Nov 2014 09:08:44 +0100 -->
<!--X-Message-Id: E1XrjGm&#45;0002AE&#45;Ho@subversion.gna.org -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>r26677 - /branches/frame_order_cleanup/specific_analyses/frame_order/geometric.py -- November 21, 2014 - 09:08</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />r26677 - /branches/frame_order_cleanup/specific_analyses/frame_order/geometric.py</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00281" class="tabs">Index by Date</a> | <a href="threads.html#00281" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00280.html">Date Prev</a>] [<a href="msg00282.html">Date Next</a>] [<a href="msg00280.html">Thread Prev</a>] [<a href="msg00282.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: relax-commits@xxxxxxx</li>
<li class="menuitem">
<em>Date</em>: Fri, 21 Nov 2014 08:08:44 -0000</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00281.html">E1XrjGm-0002AE-Ho@subversion.gna.org</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>edward</strong> on November 21, 2014 - 09:08:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Author: bugman
Date: Fri Nov 21 09:08:44 2014
New Revision: 26677

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=26677&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=26677&amp;view=rev</a>
Log:
Size fix for the rotor representation from the frame_order.pdb_model user 
function.

The size problem was detected via the Frame_order.test_pdb_model_rotor system 
test.  The rotors in
the PDB representation were all fixed in size, and ignored the 'size' 
argument of the
frame_order.pdb_model user function.  The size argument is now passed into 
the add_rotors() function
of the specific_analyses.frame_order.geometric and passed on to the rotor() 
function of the
lib.structure.represent.rotor module.


Modified:
    branches/frame_order_cleanup/specific_analyses/frame_order/geometric.py

Modified: 
branches/frame_order_cleanup/specific_analyses/frame_order/geometric.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/frame_order_cleanup/specific_analyses/frame_order/geometric.py?rev=26677&amp;r1=26676&amp;r2=26677&amp;view=diff">http://svn.gna.org/viewcvs/relax/branches/frame_order_cleanup/specific_analyses/frame_order/geometric.py?rev=26677&amp;r1=26676&amp;r2=26677&amp;view=diff</a>
==============================================================================
--- branches/frame_order_cleanup/specific_analyses/frame_order/geometric.py   
  (original)
+++ branches/frame_order_cleanup/specific_analyses/frame_order/geometric.py   
  Fri Nov 21 09:08:44 2014
@@ -350,13 +350,15 @@
         mol.atom_add(atom_name=atom_name, res_name='TLE', res_num=1, 
pos=pos, element='Ti', pdb_record='HETATM')
 
 
-def add_rotors(structure=None, representation=None, sims=False):
+def add_rotors(structure=None, representation=None, size=None, sims=False):
     &quot;&quot;&quot;Add all rotor objects for the current frame order model to the 
structural object.
 
     @keyword structure:         The internal structural object to add the 
rotor objects to.
     @type structure:            lib.structure.internal.object.Internal 
instance
     @keyword representation:    The representation to create.  If this is 
set to None, the rotor will be dumbbell shaped with propellers at both ends.  
If set to 'A' or 'B', only half of the rotor will be shown.
     @type representation:       None or str
+    @keyword size:              The size of the geometric object in 
Angstroms.
+    @type size:                 float
     @keyword sims:              A flag which if True will add the Monte 
Carlo simulation rotors to the structural object.  There must be one model 
for each Monte Carlo simulation already present in the structural object.
     @type sims:                 bool
     &quot;&quot;&quot;
@@ -416,11 +418,11 @@
             axes = generate_axis_system(sim_index=sim_indices[i])
             axis.append(axes[:, 2])
 
-            # The size of the rotor, taking the 30 Angstrom cone 
representation into account.
+            # The size of the rotor (Angstrom), taking the cone 
representation into account by adding 5 Angstrom.
             if cdp.model in [MODEL_ROTOR, MODEL_FREE_ROTOR]:
-                span.append(20e-10)
-            else:
-                span.append(35e-10)
+                span.append(size)
+            else:
+                span.append(size + 5.0)
 
             # Stagger the propeller blades.
             if cdp.model in MODEL_LIST_FREE_ROTORS:
@@ -461,9 +463,9 @@
             axis.append(frame[:, 0])
             axis.append(frame[:, 1])
 
-            # The rotor size.
-            span.append(20e-10)
-            span.append(20e-10)
+            # The rotor size (Angstrom).
+            span.append(size)
+            span.append(size)
 
             # Stagger the propeller blades.
             staggered.append(True)
@@ -487,7 +489,7 @@
 
     # Add each rotor to the structure as a new molecule.
     for i in range(len(axis)):
-        rotor(structure=structure, rotor_angle=rotor_angle[i], axis=dot(T, 
axis[i]), axis_pt=pivot[i], label=label[i], centre=com[i], span=span[i], 
blade_length=5e-10, model_num=models[i], staggered=staggered[i], 
half_rotor=half_rotor)
+        rotor(structure=structure, rotor_angle=rotor_angle[i], axis=dot(T, 
axis[i]), axis_pt=pivot[i], label=label[i], centre=com[i], span=span[i]/1e10, 
blade_length=5e-10, model_num=models[i], staggered=staggered[i], 
half_rotor=half_rotor)
 
 
 def average_position(structure=None, models=None, sim=None):
@@ -705,7 +707,7 @@
         add_pivots(structure=structures[i], sims=sims[i])
 
         # Add all rotor objects.
-        add_rotors(structure=structures[i], 
representation=representation[i], sims=sims[i])
+        add_rotors(structure=structures[i], 
representation=representation[i], size=size, sims=sims[i])
 
         # Add the axis systems.
         add_axes(structure=structures[i], representation=representation[i], 
size=size, sims=sims[i])



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Fri Nov 21 10:00:02 2014</div>  
</body>
</html>
