<!-- MHonArc v2.6.16 -->
<!--X-Subject: r10779 &#45; /1.3/generic_fns/grace.py -->
<!--X-From-R13: rqjneqNaze&#45;erynk.pbz -->
<!--X-Date: Fri, 19 Feb 2010 15:52:28 +0100 -->
<!--X-Message-Id: E1NiUDU&#45;0000hw&#45;Lz@subversion.gna.org -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>r10779 - /1.3/generic_fns/grace.py -- February 19, 2010 - 15:52</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />r10779 - /1.3/generic_fns/grace.py</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00175" class="tabs">Index by Date</a> | <a href="threads.html#00175" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00174.html">Date Prev</a>] [<a href="msg00176.html">Date Next</a>] [<a href="msg00174.html">Thread Prev</a>] [<a href="msg00176.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: relax-commits@xxxxxxx</li>
<li class="menuitem">
<em>Date</em>: Fri, 19 Feb 2010 14:52:28 -0000</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00175.html">E1NiUDU-0000hw-Lz@subversion.gna.org</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>edward</strong> on February 19, 2010 - 15:52:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Author: bugman
Date: Fri Feb 19 15:52:28 2010
New Revision: 10779

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=10779&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=10779&amp;view=rev</a>
Log:
Changed the format of the data arg to write_xy_data().

This is a huge simplification and makes the function more usable for any type 
of data thrown at it.
The structure is now expected to be a 4D list/array corresponding to Gx, Sx, 
data point, data point
info.


Modified:
    1.3/generic_fns/grace.py

Modified: 1.3/generic_fns/grace.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/1.3/generic_fns/grace.py?rev=10779&amp;r1=10778&amp;r2=10779&amp;view=diff">http://svn.gna.org/viewcvs/relax/1.3/generic_fns/grace.py?rev=10779&amp;r1=10778&amp;r2=10779&amp;view=diff</a>
==============================================================================
--- 1.3/generic_fns/grace.py (original)
+++ 1.3/generic_fns/grace.py Fri Feb 19 15:52:28 2010
@@ -329,13 +329,14 @@
     file.close()
 
 
-def write_xy_data(data, file=None, sets=1, graph_type=None, norm=False):
+def write_xy_data(data, file=None, graph_type=None, norm=False):
     &quot;&quot;&quot;Write the data into the Grace xy-scatter plot.
 
-    @param data:            The graph numerical data.
-    @type data:             list of lists of float
-    @keyword sets:          The number of data sets in the graph G0.
-    @type sets:             int
+    The numerical data should be supplied as a 4 dimensional list or array 
object.  The first dimension corresponds to the graphs, Gx.  The second 
corresponds the sets of each graph, Sx.  The third corresponds to the data 
series (i.e. each data point).  The forth is a list of the information about 
each point, it is a list where the first element is the x value, the second 
is the y value, the third is the optional dx or dy error (either dx or dy 
dependent upon the graph_type arg), and the forth is the optional dy error 
when graph_type is xydxdy (the third position is then dx).
+
+
+    @param data:            The 4D structure of numerical data to graph (see 
docstring).
+    @type data:             list of lists of lists of float
     @keyword file:          The file object to write the data to.
     @type file:             file object
     @keyword graph_type:    The graph type which can be one of xy, xydy, 
xydx, or xydxdy.
@@ -344,55 +345,49 @@
     @type norm:             bool
     &quot;&quot;&quot;
 
-    # Single data set.
-    if sets == 1:
-        data = [data]
-
-    # Loop over the data sets.
-    for i in range(sets):
-        # Multi data set (graph 0, set i).
-        file.write(&quot;@target G0.S&quot; + repr(i) + &quot;\n&quot;)
-        file.write(&quot;@type &quot; + graph_type + &quot;\n&quot;)
-
-        # Normalisation.
-        norm_fact = 1.0
-        if norm:
-            norm_fact = data[i][-2][0]
-
-        # Loop over the data of the set.
-        for j in xrange(len(data[i][-4])):
-            # Graph type xy.
-            if graph_type == 'xy':
-                # Write the data.
-                file.write(&quot;%-30s%-30s\n&quot; % (data[i][-4][j], 
data[i][-2][j]/norm_fact))
-
-            # Graph type xydy.
-            elif graph_type == 'xydy':
-                # Catch y-axis errors of None.
-                y_error = data[i][-1][j]
-                if y_error == None:
-                    y_error = 0.0
-
-                # Write the data.
-                file.write(&quot;%-30s%-30s%-30s\n&quot; % (data[i][-4][j], 
data[i][-2][j]/norm_fact, y_error/norm_fact))
-
-            # Graph type xydxdy.
-            elif graph_type == 'xydxdy':
-                # Catch x-axis errors of None.
-                x_error = data[i][-3][j]
-                if x_error == None:
-                    x_error = 0.0
-
-                # Catch y-axis errors of None.
-                y_error = data[i][-1][j]
-                if y_error == None:
-                    y_error = 0.0
-
-                # Write the data.
-                file.write(&quot;%-30s%-30s%-30s%-30s\n&quot; % (data[i][-4][j], 
data[i][-2][j]/norm_fact, x_error, y_error/norm_fact))
-
-        # End of the data set i.
-        file.write(&quot;&amp;\n&quot;)
+    # Loop over the graphs.
+    for gi in range(len(data)):
+        # Loop over the data sets of the graph.
+        for si in range(len(data[gi])):
+            # The target and type.
+            file.write(&quot;@target G%s.S%s\n&quot; % (gi, si))
+            file.write(&quot;@type %s\n&quot; % graph_type)
+    
+            # Normalisation (to the first data point y value!).
+            norm_fact = 1.0
+            if norm:
+                norm_fact = data[gi][si][0][1]
+    
+            # Loop over the data points.
+            for point in data[gi][si]:
+                # X and Y data.
+                file.write(&quot;%-30s %-30s&quot; % (point[0], point[1]/norm_fact))
+
+                # The dx and dy errors.
+                if graph_type in ['xydx', 'xydy']:
+                    # Catch x or y-axis errors of None.
+                    error = point[2]
+                    if error == None:
+                        error = 0.0
+    
+                    # Write the error.
+                    file.write(&quot; %-30s&quot; % (error/norm_fact))
+    
+                # The dy errors of xydxdy.
+                if graph_type == 'xydxdy':
+                    # Catch y-axis errors of None.
+                    error = point[3]
+                    if error == None:
+                        error = 0.0
+    
+                    # Write the error.
+                    file.write(&quot; %-30s&quot; % (error/norm_fact))
+    
+                # End the point.
+                file.write(&quot;\n&quot;)
+
+            # End of the data set i.
+            file.write(&quot;&amp;\n&quot;)
 
 
 def write_xy_header(file=None, sets=1, set_names=None, data_type=[None, 
None], seq_type=[None, None], axis_labels=[None, None], axis_min=[None, 
None], axis_max=[None, None], norm=False):



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Fri Feb 19 17:20:01 2010</div>  
</body>
</html>
