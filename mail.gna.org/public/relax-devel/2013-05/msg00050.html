<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: Relaxation dispersion comparison: The LM63 model results from	relax, NESSY and CPMGFit. -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Wed, 29 May 2013 15:54:36 +0200 -->
<!--X-Message-Id: CAED9pY_s_Xf9uaYK2NcVOE2LPG=0nCEKC+iYd=mufGXh0C58rQ@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: CAED9pY8arkGQV6jeQM0aXUiQ1ry=hJT1k76hZ20sZPZTC0PaRA@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Relaxation dispersion comparison: The LM63 model results from	relax, NESSY and CPMGFit. -- May 29, 2013 - 15:54</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Relaxation dispersion comparison: The LM63 model results from	relax, NESSY and CPMGFit.</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00050" class="tabs">Index by Date</a> | <a href="threads.html#00050" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00049.html">Date Prev</a>] [<a href="msg00051.html">Date Next</a>] [<a href="msg00049.html">Thread Prev</a>] [<a href="msg00051.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;,	Troels Emtek√¶r Linnet &lt;tlinnet@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Wed, 29 May 2013 15:54:05 +0200</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113;	h=mime-version:sender:in-reply-to:references:date	:x-google-sender-auth:message-id:subject:from:to:content-type;	bh=sAgGVuBUPax9tIFEhdb0z/ypNSra5WSSchtrJ0FjXv8=;	b=CRCyz8XppkXgA/u4A7z/pNaz9Aoe9itXNQAAbA88U9sL/8NI7J3LN/y9WWeq/1nwDE	iMRU7XVl2KuVakS6dqkz3qOlYvfdsAvUH33AIELOShqCfdqct670k4sI29J4wg5oERLM	bl2HRav2e9TgZfQ6Qhr1YA9jjlVGsxdY1YogDjaUdfgPxlvjmy4AwEVeioIY02hTn+tF	zZ45J8RsIJ2iu0uQWd0Y1NicvgTM9usQMvT1lrF1pw630v/Jf/jnzKRVlTbvb+RNEzOx	AZDniJwXkmqweOLLbz4Ln9cP6H/IE0K9+lV6ot2lAVSROrsCJl6Iuh8OKoJi0oFAFZAn	3IWA==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00050.html">CAED9pY_s_Xf9uaYK2NcVOE2LPG=0nCEKC+iYd=mufGXh0C58rQ@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;CAED9pY8arkGQV6jeQM0aXUiQ1ry=hJT1k76hZ20sZPZTC0PaRA@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on May 29, 2013 - 15:54:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi again,

Please ignore the comment about the constraints algorithm not being
implemented ;)  The relax_disp branch now uses the log barrier
algorithm 
(<a  rel="nofollow" href="http://en.wikipedia.org/wiki/Barrier_function#logarithmic_barrier_function">http://en.wikipedia.org/wiki/Barrier_function#logarithmic_barrier_function</a>)
to constrain the parameters without gradient target functions.  This
was a very simple and quick fix.

Regards,

Edward




On 29 May 2013 12:01, Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

Troels, you might be interested in the following comparison.  The
reviving Sebastien Morin's relaxation dispersion branch in relax is
now complete.  The relax_disp branch can now correctly optimise one of
the dispersion models, that of Luz and Meiboom 1963 for 2-site fast
exchange for CPMG-type experiments.  This does not implement the
gradients or Hessians yet, and parameter constraints are still to be
added.  But nevertheless relax can find the correct parameter values.
This should be a good test of the dispersion code in relax as the
addition of other models - such as that for R1rho data, more
complicated models for CPMG-type data, and numerical integration of
the Bloch-McConnell equations - should be trivial after that
(requiring only 20-50 lines of new code, not counting comments and
docstrings).

Through relax user functions, I can now generate the input for CPMGFit
and NESSY.  These are the relax_disp.cpmgfit_input and
relax_disp.nessy_input user functions.  We can now also execute
CPMGFit within relax using relax_disp.cpmgfit_execute.  This can be
completed later, but the idea is to follow the concept of model-free
user functions:

dasha.create
dasha.execute
dasha.extract
palmer.create
palmer.execute
palmer.extract

These are for the Dasha and Modelfree4 programs respectively.
Implementing the 3 user functions for creating input files, executing
the program in-line, and extracting the results from the program's
output will allow relax to use external programs as optimisation
engines.  This is useful for comparing the results from different
programs and really eliminating all bugs from the dispersion field.

Back to the comparison, I have used Flemming Hansen's 500 and 800 MHz
CPMG data from:

Hansen, Vallurupalli &amp; Kay, 2008, JPhysChemB, 112: 5898-5904.

which he donated to Seb to be added to relax (located in
test_suite/shared_data/dispersion/Hansen/).  Looking at a single
randomly chosen residue (number 70), I see different results from the
3 programs:

Param       relax       NESSY       CPMGFit
R2 (500)        6.806       7.639       6.866
R2 (800)        6.679       7.387       6.866
phi         1.259e-13       0.259   1.226e-13
phi (500)   31464.605   26292.031   30644.496
phi (800)   80549.390   67307.598   78449.180
kex          4763.249    3906.180      4.683
tau         4.199e-05   5.120e-05       0.427
chi2          106.393     156.446     106.471

tau = 2/kex (I think that CPMGFit works with ms units).

Obviously NESSY is not doing so well (likely due to using the horribly
buggy scipy optimisation code) and relax and CPMGFit find the same
result for this model.  The slight difference between relax and
CPMGFit is that it looks like CPMGFit assumes the same R2 value for
all static fields - which I think would be a little strange,
especially if fast internal motions are also present for that spin
system.

Therefore I believe that this relax branch is in a state to accept
code for the other models.  The backends for the
relax_disp.cpmgfit_input and relax_disp.nessy_input could be also
modified to handle these new models to allow for rigorous comparisons
and debugging.  The dispersion infrastructure should no longer have
any large changes, so feel free to start playing.

Regards,

Edward
</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00049" href="msg00049.html">Relaxation dispersion comparison: The LM63 model results from relax, 	NESSY and CPMGFit.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu May 30 15:20:09 2013</div>  
</body>
</html>
