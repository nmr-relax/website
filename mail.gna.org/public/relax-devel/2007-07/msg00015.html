<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: Consistency tests -->
<!--X-From-R13: Eéonfgvra [beva <fronfgvra.zbeva.1Nhyniny.pn> -->
<!--X-Date: Mon, 09 Jul 2007 20:06:13 +0200 -->
<!--X-Message-Id: 20070709140537.sksgcw8k44sscows@agora.ulaval.ca -->
<!--X-Content-Type: multipart/mixed -->
<!--X-Reference: 4672D803.4060009@ulaval.ca -->
<!--X-Reference: 7f080ed10706240949n1b42f06egd424e932d46db48f@mail.gmail.com -->
<!--X-Reference: 46814D2C.1020606@ulaval.ca -->
<!--X-Reference: 7f080ed10707090347m69be69b0w67fa204563dfc17b@mail.gmail.com -->
<!--X-Reference: 7f080ed10707090355x2c39cd01u4e4939dc1b40f77e@mail.gmail.com -->
<!--X-Reference: 46924763.2040703@ulaval.ca -->
<!--X-Reference: 7f080ed10707090825vbe84e84h26080e777b107cb1@mail.gmail.com -->
<!--X-Reference: 469255EB.4070600@ulaval.ca -->
<!--X-Reference: 7f080ed10707090934k6912141ev45423a51bb96ff3a@mail.gmail.com -->
<!--X-Reference: 20070709133145.w0k44cckock8o8w0@agora.ulaval.ca -->
<!--X-Derived: binnhL18fZYpp.bin -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Consistency tests -- July 09, 2007 - 20:06</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Consistency tests</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00015" class="tabs">Index by Date</a> | <a href="threads.html#00015" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00014.html">Date Prev</a>] [<a href="msg00016.html">Date Next</a>] [<a href="msg00014.html">Thread Prev</a>] [<a href="msg00027.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Sébastien Morin &lt;sebastien.morin.1@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Mon,  9 Jul 2007 14:05:37 -0400</li>
<li class="menuitem">
<em>Cc</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00015.html">20070709140537.sksgcw8k44sscows@agora.ulaval.ca</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;4672D803.4060009@xxxxxxxxx&gt;	&lt;7f080ed10706240949n1b42f06egd424e932d46db48f@xxxxxxxxxxxxxx&gt;	&lt;46814D2C.1020606@xxxxxxxxx&gt;	&lt;7f080ed10707090347m69be69b0w67fa204563dfc17b@xxxxxxxxxxxxxx&gt;	&lt;7f080ed10707090355x2c39cd01u4e4939dc1b40f77e@xxxxxxxxxxxxxx&gt;	&lt;46924763.2040703@xxxxxxxxx&gt;	&lt;7f080ed10707090825vbe84e84h26080e777b107cb1@xxxxxxxxxxxxxx&gt;	&lt;469255EB.4070600@xxxxxxxxx&gt;	&lt;7f080ed10707090934k6912141ev45423a51bb96ff3a@xxxxxxxxxxxxxx&gt;	&lt;20070709133145.w0k44cckock8o8w0@xxxxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>User-agent</em>: Internet Messaging Program (IMP) 4.0-cvs</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Sébastien Morin</strong> on July 09, 2007 - 20:06:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi again !

I added lines for plotting using grace in the sample script. Since this sample
script was inspired by the jw_mapping sample script, I also submit a patch for
this file (adding lines for plotting, changing the number of Monte Carlo
simulations from 5000 to 500 and changing the sequence file from noe.500.out 
to
noe.600.out for more consistency)...

Ciao !


Sébastien :)




Selon Sébastien Morin &lt;sebastien.morin.1@xxxxxxxxx&gt;, 09.07.2007:

</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Ed

Tell me if this works better. I'm now using the mail server directly from 
the
internet GUI... (not with Thuderbird).

If this does not work neither, maybe we could try with the task...

Ciao !


Sébastien


Selon Edward d'Auvergne &lt;edward.dauvergne@xxxxxxxxx&gt;, 09.07.2007:

</pre><blockquote class="blockquote"><pre style="margin: 0em;">I've tried cutting an pasting the patch but I get the following:

edau@klymene:/media/usbdisk/relax/branches/consistency_tests_1.2&gt;
patch -p0 &lt; patch
patching file prompt/consistency_tests.py
Hunk #2 FAILED at 26.
Hunk #3 FAILED at 40.
Hunk #4 FAILED at 49.
Hunk #5 FAILED at 74.
4 out of 5 hunks FAILED -- saving rejects to file
prompt/consistency_tests.py.rej
edau@klymene:/media/usbdisk/relax/branches/consistency_tests_1.2&gt;

I don't know why, but thunderbird is destroying the attachment.  The
failed 'hunks' are the wrapped lines.  Maybe there is a way to prevent
thunderbird from doing this.  Otherwise using another email client (or
webmail) may work.  I could also create a task for this consistency
test work and these could be attached to the task.  It's best that,
for the record, the files are located within the permanent relax
infrastructure.

Cheers,

Edward




On 7/9/07, Sebastien Morin &lt;sebastien.morin.1@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi again !

Here is again the first patch for the file 
'prompt/consistency_tests.py'.

I modified the header for the copyrights.

Also, the former patches were not copied-pasted, but attached using
Thunderbird after their creation using a command like 'svn diff &gt; patch'
under Linux. When I send those kinds of files as attachment, I usually
see them as text in the e-mail, but also as an attachment that can be
save. Tell me if it is okay and if it is still a problem, I'll put them
on my lab's website...

Cheers


Séb :)



Edward d'Auvergne wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

Just add some text such as 'Copyright (C) 2007 Sebastien Morin
&lt;sebastien.morin.1 at ulaval.ca&gt;' underneath the already existent
copyright text.  The can be changed later, for example I can give you
a ???@nmr-relax.com email address which is an alias for any other
email address (once voted in as a relax developer).  Could you add
this and then resend the patches?  Ta.  If they are attached rather
than cut and paste that would be much easier for applying the patches
(as email wraps lines).  Also, maybe responding to your original posts
will allow the patches to be more easily tracked in the mailing list
<a  rel="nofollow" href="/mail.gna.org/public/relax-devel/">https://mail.gna.org/public/relax-devel/</a>.

Cheers,

Edward


On 7/9/07, Sebastien Morin &lt;sebastien.morin.1@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi !

I'm about to create the patches to merge the consistency tests code
</pre></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">into
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">the 1.2 branch.

However, I have one question. How do I treat the copyrights ? Do I
</pre></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">leave
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">the original author from which I copied the code and then modified it
</pre></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">or
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">do I had my name to the code headers..?

Thanks !


Sébastien  :)




Edward d'Auvergne wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Oh, I've committed your patch at

</pre></blockquote><pre style="margin: 0em;">

</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">

</pre></blockquote><pre style="margin: 0em;">

</pre></blockquote><pre style="margin: 0em;"><a  rel="nofollow" href="http://maple.rsvs.ulaval.ca/mediawiki/index.php/Patch_consistency_tests_2007-06-26">http://maple.rsvs.ulaval.ca/mediawiki/index.php/Patch_consistency_tests_2007-06-26</a>
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">

</pre><blockquote class="blockquote"><pre style="margin: 0em;">

as revision r3324, applying it to the 1.2 branch.  I've carefully
checked the code and none of the changes are detrimental or could
affect the stability of the stable 1.2 relax codebase.  Note 
however
that the code in the branch will not run as the consistency_test.py
files are still identical copies of the jw_mapping.py files.

Cheers,

Edward


On 7/9/07, Edward d'Auvergne &lt;edward.dauvergne@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

I've now created two branches within the relax repository for you
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">to
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">play with.  The first is a copy of the 1.2 line and is located at
svn.gna.org/svn/relax/branches/consistency_tests_1.2/.  The second
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">is
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">a copy of the 1.3 line and is located at
svn.gna.org/svn/relax/branches/consistency_tests_1.3/.  I've
</pre></blockquote></blockquote><pre style="margin: 0em;">initially
</pre><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">used 'svn cp' to create the 5 consistency_tests.py files as
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">described
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">in <a  rel="nofollow" href="/mail.gna.org/public/relax-devel/2007-07/msg00001.html">https://mail.gna.org/public/relax-devel/2007-07/msg00001.html</a>
(Message-id:
&lt;7f080ed10707090251ve1c4a8fl7f8618843e5c9459@xxxxxxxxxxxxxx&gt;).
 Would you be able to create patches for these files (in the 1.2
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">line
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">first, no need to worry about the 1.3 line yet), and then post the
individual patches as text file attachments to the mailing list?
Thanks.  I will then be able to commit these patches individually,
checking them in fine detail.

Things to note in creating the patches from the code at
<a  rel="nofollow" href="http://maple.rsvs.ulaval.ca/mediawiki/index.php/Relax_development">http://maple.rsvs.ulaval.ca/mediawiki/index.php/Relax_development</a>
include the copyright preservation, a number of integers in
'maths_fns/consistency_tests.py' which should be floating point
numbers (just add '.0' to the end of the number), the addition of
Grace plots as an output in the
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">'sample_scripts/consistency_tests.py'
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">script to be able to create a picture similar to that on your 
relax
development site, maybe only allowing 'Tc' and 'tc' in the
return_data_name() function and not 'TC', and 'degrees' instead of
'degree' in the return_units() function.

One bug includes:

             setattr(self.relax.data.res[self.run][index], 'csa',
float(value[0]))
             setattr(self.relax.data.res[self.run][index], 'r',
float(value[1]))
+            setattr(self.relax.data.res[self.run][index],
'orientation', float(value[1]))
+            setattr(self.relax.data.res[self.run][index], 'tc',
float(value[1]))

value[1] has been used twice.  I have a feeling there is another
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">bug
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">somewhere where an index has been repeated a few times when it
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">should
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">be different indices, but I can't find it at the moment.  The
individual patches should help.  Finally, I have a feeling that
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">there
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">is unused code which can be deleted as it is a relic from the copy
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">of
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">the J(w) mapping code and is not needed.  For the 1.3 line code I
would recommend that identical functions are shifted into files
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">such
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">as 'specific_fns/base_class.py', but for the 1.2 line code I would
prefer the duplication as this means that the current stable code
</pre></blockquote></blockquote><pre style="margin: 0em;">base
</pre><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">remains stable.

Cheers,

Edward



On 6/26/07, Sebastien Morin &lt;sebastien.morin.1@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

I started working on implementing the consistency tests last 
week
</pre></blockquote><pre style="margin: 0em;">before
</pre><blockquote class="blockquote"><pre style="margin: 0em;">the last post was made and, hence, I worked on repository line
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">1.2
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">(revision 3303).

I implemented the consistency tests as a new type of run ('ct')
</pre></blockquote><pre style="margin: 0em;">similar
</pre><blockquote class="blockquote"><pre style="margin: 0em;">to the one for Jw mapping.

The calculations are made for J(0), F_eta and F_R2 separately
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">for each
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">magnetic field (one at a time). The output results file is
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">similar to
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">the one for Jw mapping. The user then needs to plot them and
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">look for
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">consistency with its own criteria (calculation correlation
coefficients,  mean ratios and standard deviations, etc).

Please look at the followinr URL for a listing of the
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">modifications to
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">old files and also necessary new files.

<a  rel="nofollow" href="http://maple.rsvs.ulaval.ca/mediawiki/index.php/Relax_development">http://maple.rsvs.ulaval.ca/mediawiki/index.php/Relax_development</a>

The file 'sample_scripts/consistency_tests.py' should be useful
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">to
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">understand how the new procedure works.

Even if this was done on repository line 1.2, I think it is
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">quite fine
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">since nothing was deleted but only things added (maybe too much,
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">as I
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">reproduced the Jw mapping approach, maybe too much as I added
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">lines in
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">the codes for grace, molmol, etc, maybe too much also since some
</pre></blockquote><pre style="margin: 0em;">code is
</pre><blockquote class="blockquote"><pre style="margin: 0em;">duplicated from the Jw mapping code). The test-suite still works
perfectly and, so, I think it could be fine to add the tests to
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">the
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">1.2
</pre><blockquote class="blockquote"><pre style="margin: 0em;">line as well... However, if necessary, I could implement the
</pre></blockquote><pre style="margin: 0em;">consistency
</pre><blockquote class="blockquote"><pre style="margin: 0em;">testing procedure on line 1.3, following your comments as I am
</pre></blockquote><pre style="margin: 0em;">quite new
</pre><blockquote class="blockquote"><pre style="margin: 0em;">to Python and maybe made things somehow not perfectly...

Please tell me what you think about this.

Cheers,


Sébastien  :)



Edward d'Auvergne wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

I have previously talked about data set consistency.  For
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">example
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">see
</pre><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">the post at
</pre></blockquote></blockquote><pre style="margin: 0em;"><a  rel="nofollow" href="/mail.gna.org/public/relax-users/2007-06/msg00001.html">https://mail.gna.org/public/relax-users/2007-06/msg00001.html</a>
</pre><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">in which a few reasons for inconsistencies have been
</pre></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">explained.  I
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">have, from experience, noticed that small changes in protein
concentration can change the collected relaxation rates
</pre></blockquote></blockquote><pre style="margin: 0em;">significantly
</pre><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">- most likely because of packing interactions.  All samples
</pre></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">should
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">essentially be identical in all respects for the relaxation
</pre></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">rates to
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">be compared.  And the temperate should always be fine tuned
</pre></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">between
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">experiments and spectrometers using methanol (and always
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">checked
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">later
</pre><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">on if there is a large time between collecting the same
</pre></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">experiment).
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">

Therefore these tests would be quite useful.  Data consistency
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">is
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">essential for the model-free results to be correct (as well as
</pre></blockquote></blockquote><pre style="margin: 0em;">reduced
</pre><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">spectral density mapping, SRLS, etc.) as this affects both the
optimisation and model selection and can result in artificial
</pre></blockquote></blockquote><pre style="margin: 0em;">motions
</pre><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">appearing.  However I don't know how these test would
</pre></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">currently fit
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">within relax.  Maybe a new type of analysis should be created
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">for
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">this
</pre><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">(see the pipe.create() user function in the 1.3 line or the
run.create() user function in the 1.2 line).  These ideas
</pre></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">should all
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">go into the 1.3 line (via a branch) as the 1.2 line is stable
</pre></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">and no
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">new major features will be added to this code.  What are the
</pre></blockquote></blockquote><pre style="margin: 0em;">ideas you
</pre><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">have been playing with?

Cheers,

Edward


On 6/15/07, Sebastien Morin &lt;sebastien.morin.1@xxxxxxxxx&gt;
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">wrote:
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">Hi everyone

During the last months, I was astonished to realize that some
</pre></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">spin
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">relaxation data I had acquired at different fields were not
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">consistent
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">between each other. The way I realized that was by seeing
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">discrepancy
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">between J(0) values calculated with those different datasets.

I looked a little bit in the litterature and found some
</pre></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">interesting
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">consistency tests in a paper by Fushman (Fushman et al., 
JACS,
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">1998,
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">120:10947-10952).

This paper present 2 consistency tests to compare datasets
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">from
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">different magnetic fields / samples / time / etc.

I think it would be interesting to implement those simple
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">tests
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">in relax
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">so the user can, before trying to fit their data, know the
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">quality of
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">those... Regrettably, very few people look at the consistency
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">of
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">their
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">datasets before analysis...

The underlying principle is the same as when looking at
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">consistency for
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">J(0). Thus, I think that those two tests and a J(0) test
</pre></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">should be
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">implemented altogether...

I'll try to work a bit on this. Mimicking the code for
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">spectral
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">density
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">should be a good starting point.

Am I right ?
Do you see any value in those tests ?

Cheers


Sébastien  :)


_______________________________________________
relax (<a  rel="nofollow" href="http://nmr-relax.com">http://nmr-relax.com</a>)

This is the relax-devel mailing list
relax-devel@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="/mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a>

</pre></blockquote><pre style="margin: 0em;">

</pre></blockquote><pre style="margin: 0em;">

--
         ______________________________________
     _______________________________________________
    |                                               |
   || Sebastien Morin                               ||
  ||| Etudiant au PhD en biochimie                  |||
 |||| Laboratoire de resonance magnetique nucleaire ||||
||||| Dr Stephane Gagne                             |||||
 |||| CREFSIP (Universite Laval, Quebec, CANADA)    ||||
  ||| 1-418-656-2131 #4530                          |||
   ||                                               ||
    |_______________________________________________|
         ______________________________________



</pre></blockquote><pre style="margin: 0em;">

</pre></blockquote><pre style="margin: 0em;">

</pre></blockquote><pre style="margin: 0em;">

--
         ______________________________________
     _______________________________________________
    |                                               |
   || Sebastien Morin                               ||
  ||| Etudiant au PhD en biochimie                  |||
 |||| Laboratoire de resonance magnetique nucleaire ||||
||||| Dr Stephane Gagne                             |||||
 |||| CREFSIP (Universite Laval, Quebec, CANADA)    ||||
  ||| 1-418-656-2131 #4530                          |||
   ||                                               ||
    |_______________________________________________|
         ______________________________________



</pre></blockquote><pre style="margin: 0em;">

</pre></blockquote><pre style="margin: 0em;">

--
         ______________________________________
     _______________________________________________
    |                                               |
   || Sebastien Morin                               ||
  ||| Etudiant au PhD en biochimie                  |||
 |||| Laboratoire de resonance magnetique nucleaire ||||
||||| Dr Stephane Gagne                             |||||
 |||| CREFSIP (Universite Laval, Quebec, CANADA)    ||||
  ||| 1-418-656-2131 #4530                          |||
   ||                                               ||
    |_______________________________________________|
         ______________________________________


Index: prompt/consistency_tests.py
===================================================================
--- prompt/consistency_tests.py (revision 3324)
+++ prompt/consistency_tests.py (working copy)
@@ -1,6 +1,7 @@

</pre></blockquote><pre style="margin: 0em;">

</pre></blockquote><pre style="margin: 0em;">

</pre></blockquote><pre style="margin: 0em;">###############################################################################
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;"> #
</pre></blockquote><pre style="margin: 0em;">   #
</pre><blockquote class="blockquote"><pre style="margin: 0em;"> # Copyright (C) 2004-2005 Edward d'Auvergne
</pre></blockquote><pre style="margin: 0em;">   #
</pre><blockquote class="blockquote"><pre style="margin: 0em;">+# Copyright (C) 2007 Sebastien Morin &lt;sebastien.morin.1 at ulaval.ca&gt;
 #
</pre></blockquote><pre style="margin: 0em;">   #
</pre><blockquote class="blockquote"><pre style="margin: 0em;"> # This file is part of the program relax.
</pre></blockquote><pre style="margin: 0em;">   #
</pre><blockquote class="blockquote"><pre style="margin: 0em;"> #
</pre></blockquote><pre style="margin: 0em;">   #
</pre><blockquote class="blockquote"><pre style="margin: 0em;">@@ -25,11 +26,11 @@
 import help


-class Jw_mapping:
+class Consistency_tests:
     def __init__(self, relax):
         # Help.
         self.__relax_help__ = \
-        &quot;&quot;&quot;Class containing functions specific to reduced spectral
</pre></blockquote></blockquote><pre style="margin: 0em;">density
</pre><blockquote class="blockquote"><pre style="margin: 0em;">mapping.&quot;&quot;&quot;
</pre><blockquote class="blockquote"><pre style="margin: 0em;">+        &quot;&quot;&quot;Class containing functions specific to consistency tests for
</pre></blockquote><pre style="margin: 0em;">datasets from different fields.&quot;&quot;&quot;
</pre><blockquote class="blockquote"><pre style="margin: 0em;">

         # Add the generic help string.
         self.__relax_help__ = self.__relax_help__ + &quot;\n&quot; +
</pre></blockquote><pre style="margin: 0em;">help.relax_class_help
</pre><blockquote class="blockquote"><pre style="margin: 0em;">@@ -39,7 +40,7 @@


     def set_frq(self, run=None, frq=None):
-        &quot;&quot;&quot;Function for selecting which relaxation data to use in the
</pre></blockquote></blockquote><pre style="margin: 0em;">J(w)
</pre><blockquote class="blockquote"><pre style="margin: 0em;">mapping.
</pre><blockquote class="blockquote"><pre style="margin: 0em;">+        &quot;&quot;&quot;Function for selecting which relaxation data to use in the
</pre></blockquote><pre style="margin: 0em;">consistency tests.
</pre><blockquote class="blockquote"><pre style="margin: 0em;">

         Keyword Arguments
         ~~~~~~~~~~~~~~~~~
@@ -48,24 +49,23 @@

         frq:  The spectrometer frequency in Hz.

-
         Description
         ~~~~~~~~~~~

-        This function will select the relaxation data to use in the
</pre></blockquote><pre style="margin: 0em;">reduced spectral density mapping
</pre><blockquote class="blockquote"><pre style="margin: 0em;">-        corresponding to the given frequency.
+        This function will select the relaxation data to use in the
</pre></blockquote><pre style="margin: 0em;">consistency tests
</pre><blockquote class="blockquote"><pre style="margin: 0em;">+        corresponding to the given frequencies.


         Examples
         ~~~~~~~~

-        relax&gt; jw_mapping.set_frq('jw', 600.0 * 1e6)
-        relax&gt; jw_mapping.set_frq(run='jw', frq=600.0 * 1e6)
+        relax&gt; consistency_tests.set_frq('test', 600.0 * 1e6)
+        relax&gt; consistency_tests.set_frq(run='test', frq=600.0 * 1e6)
         &quot;&quot;&quot;

         # Function intro text.
         if self.__relax__.interpreter.intro:
-            text = sys.ps3 + &quot;jw_mapping.set_frq(&quot;
+            text = sys.ps3 + &quot;consistency_tests.set_frq(&quot;
             text = text + &quot;run=&quot; + `run`
             text = text + &quot;, frq=&quot; + `frq` + &quot;)&quot;
             print text
@@ -74,9 +74,9 @@
         if type(run) != str:
             raise RelaxStrError, ('run', run)

-        # The frq argument.
+        # The frq arguments.
         if type(frq) != float:
             raise RelaxStrError, ('frq', frq)

         # Execute the functional code.
-        self.__relax__.specific.jw_mapping.set_frq(run=run, frq=frq)
+        self.__relax__.specific.consistency_tests.set_frq(run=run,
</pre></blockquote><pre style="margin: 0em;">frq=frq)
</pre><blockquote class="blockquote"><pre style="margin: 0em;">


</pre></blockquote><pre style="margin: 0em;">

</pre></blockquote></blockquote><p><strong>Attachment:
<a href="binnhL18fZYpp.bin" ><tt>patch_sample_scripts_consistency_tests</tt></a></strong><br>
<em>Description:</em> Binary data</p>
<pre style="margin: 0em;">Index: sample_scripts/jw_mapping.py
===================================================================
--- sample_scripts/jw_mapping.py        (revision 3324)
+++ sample_scripts/jw_mapping.py        (working copy)
@@ -8,7 +8,7 @@
 nuclei('N')
 
 # Load the sequence.
-sequence.read(name, 'noe.500.out')
+sequence.read(name, 'noe.600.out')
 
 # Load the relaxation data.
 relax_data.read(name, 'R1', '600', 600.0 * 1e6, 'r1.600.out')
@@ -26,11 +26,21 @@
 calc(name)
 
 # Monte Carlo simulations.
-monte_carlo.setup(name, number=5000)
+monte_carlo.setup(name, number=500)
 monte_carlo.create_data(name)
 calc(name)
 monte_carlo.error_analysis(name)
 
+# Create grace files.
+grace.write(name, y_data_type='j0', file='j0.agr', force=1)
+grace.write(name, y_data_type='jwx', file='jwx.agr', force=1)
+grace.write(name, y_data_type='jwh', file='jwh.agr', force=1)
+
+# View the grace files.
+grace.view(file='j0.agr')
+grace.view(file='jwx.agr')
+grace.view(file='jwh.agr')
+
 # Finish.
 results.write(run=name, file='results', force=1)
 state.save('save', force=1)
</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00027" href="msg00027.html">Re: Consistency tests</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00002" href="msg00002.html">Re: Consistency tests</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00003" href="msg00003.html">Re: Consistency tests</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00004" href="msg00004.html">Re: Consistency tests</a></strong>
<ul><li><em>From:</em> Sebastien Morin</li></ul></li>
<li><strong><a name="00008" href="msg00008.html">Re: Consistency tests</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00009" href="msg00009.html">Re: Consistency tests</a></strong>
<ul><li><em>From:</em> Sebastien Morin</li></ul></li>
<li><strong><a name="00013" href="msg00013.html">Re: Consistency tests</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00014" href="msg00014.html">Re: Consistency tests</a></strong>
<ul><li><em>From:</em> Sébastien Morin</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Mon Jul 09 23:00:35 2007</div>  
</body>
</html>
