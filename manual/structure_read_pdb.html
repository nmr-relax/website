<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.1//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>structure.read_pdb</TITLE>
<META NAME="description" CONTENT="structure.read_pdb">
<META NAME="keywords" CONTENT="relax">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">

  <!--Google analytics JS-->
  <script type="text/javascript">
  
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30096326-1']);
    _gaq.push(['_setDomainName', 'nmr-relax.com']);
    _gaq.push(['_trackPageview']);
  
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  
  </script>

<LINK REL="STYLESHEET" HREF="relax.css">

<LINK REL="next" HREF="structure_read_xyz.html">
<LINK REL="previous" HREF="structure_read_gaussian.html">
<LINK REL="up" HREF="The_list_of_functions.html">
<LINK REL="next" HREF="structure_read_xyz.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html22592"
  HREF="structure_read_xyz.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Next" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html22586"
  HREF="The_list_of_functions.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Up" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html22580"
  HREF="structure_read_gaussian.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Previous" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html22588"
  HREF="Contents.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Contents" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html22590"
  HREF="Index.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Index" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html1"
  HREF="http://download.gna.org/relax/manual/relax.pdf"><IMG
 ALIGN="BOTTOM" BORDER="0" SRC="http://www.nmr-relax.com/images/pdf_icon_nav.png"
 ALT="pdf_icon_nav.png"></A><A NAME="tex2html2"
  HREF="http://www.nmr-relax.com"><IMG
 ALIGN="BOTTOM" BORDER="0" SRC="http://www.nmr-relax.com/images/relax_logo_nav.png"
 ALT="relax_logo_nav.png"></A>
<BR>
<B> Next:</B> <A NAME="tex2html22593"
  HREF="structure_read_xyz.html">structure.read_xyz</A>
<B> Up:</B> <A NAME="tex2html22587"
  HREF="The_list_of_functions.html">The list of functions</A>
<B> Previous:</B> <A NAME="tex2html22581"
  HREF="structure_read_gaussian.html">structure.read_gaussian</A>
 &nbsp; <B>  <A NAME="tex2html22589"
  HREF="Contents.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html22591"
  HREF="Index.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><A NAME="tex2html22594"
  HREF="structure_read_pdb.html#SECTION0812248100000000000000">Synopsis</A>
<LI><A NAME="tex2html22595"
  HREF="structure_read_pdb.html#SECTION0812248200000000000000">Defaults</A>
<LI><A NAME="tex2html22596"
  HREF="structure_read_pdb.html#SECTION0812248300000000000000">Keyword arguments</A>
<LI><A NAME="tex2html22597"
  HREF="structure_read_pdb.html#SECTION0812248400000000000000">Description</A>
<LI><A NAME="tex2html22598"
  HREF="structure_read_pdb.html#SECTION0812248500000000000000">Prompt examples</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H2><A NAME="SECTION0812248000000000000000"></A> <A NAME="uf:_structure.read_pdb"></A>
<BR>
structure.read_pdb
</H2>
<IMG
  WIDTH="128" HEIGHT="128" ALIGN="BOTTOM" BORDER="0"
 SRC="./structure.png"
 ALT="Image structure"> <IMG
  WIDTH="128" HEIGHT="128" ALIGN="BOTTOM" BORDER="0"
 SRC="./document-open.png"
 ALT="Image document-open">

<P>

<H3><A NAME="SECTION0812248100000000000000">
Synopsis</A>
</H3>

<P>
Reading<A NAME="49214"></A> structures from PDB<A NAME="49215"></A> files.

<P>

<H3><A NAME="SECTION0812248200000000000000">
Defaults</A>
</H3>

<P>
<DIV ALIGN="LEFT">
<SPAN  CLASS="textsf"><SPAN  CLASS="textbf">structure.read_pdb</SPAN>(file=None, dir=None, read_mol=None, set_mol_name=None, read_model=None, set_model_num=None, alt_loc=None, verbosity=1, merge=False)</SPAN>

</DIV>

<P>

<H3><A NAME="SECTION0812248300000000000000">
Keyword arguments</A>
</H3>

<P>
 <SPAN  CLASS="textsf">file:</SPAN>  The name of the PDB<A NAME="49223"></A> file.

<P>
 <SPAN  CLASS="textsf">dir:</SPAN>  The directory where the file is located.

<P>
 <SPAN  CLASS="textsf">read_mol:</SPAN>  If set, only the given molecule(s)<A NAME="49228"></A> will be read.<A NAME="49229"></A>  The molecules<A NAME="49230"></A> are numbered consecutively from 1.  If unset, then all molecules<A NAME="49231"></A> will be loaded.  By providing a list of numbers such as [1, 2], multiple molecules<A NAME="49232"></A> will be read.<A NAME="49233"></A>

<P>
 <SPAN  CLASS="textsf">set_mol_name:</SPAN>  Set the names of the read<A NAME="49236"></A> molecules.<A NAME="49237"></A>  If unset, then the molecules<A NAME="49238"></A> will be automatically labelled based on the file name or other information.  This can either be a single name or a list of names.

<P>
 <SPAN  CLASS="textsf">read_model:</SPAN>  If set, only the given model number(s) from the PDB<A NAME="49241"></A> file will be read.<A NAME="49242"></A>  Otherwise all models will be read.<A NAME="49243"></A>  This can be a single number or list of numbers.

<P>
 <SPAN  CLASS="textsf">set_model_num:</SPAN>  Set the model numbers of the loaded molecules.<A NAME="49246"></A>  If unset, then the PDB<A NAME="49247"></A> model numbers will be preserved if they exist.  This can be a single number or list of numbers.

<P>
 <SPAN  CLASS="textsf">alt_loc:</SPAN>  The PDB<A NAME="49250"></A> ATOM record `<TT>Alternate location indicator</TT>' field value.

<P>
 <SPAN  CLASS="textsf">verbosity:</SPAN>  The amount of information to print out.  Set to zero to silence the user function, or one to see all messages.

<P>
 <SPAN  CLASS="textsf">merge:</SPAN>  A flag which if set to True will try to merge the PDB<A NAME="49256"></A> structure into the currently loaded structures.

<P>

<H3><A NAME="SECTION0812248400000000000000">
Description</A>
</H3>

<P>
The reading<A NAME="49258"></A> of PDB<A NAME="49259"></A> files into relax is quite a flexible procedure allowing for both models, defined as an ensemble of the same molecule<A NAME="49260"></A> but with different atomic positions, and different molecules<A NAME="49261"></A> within the same model.  One of more molecules<A NAME="49262"></A> can exist in one or more models.  The flexibility allows PDB<A NAME="49263"></A> models to be converted into different molecules<A NAME="49264"></A> and different PDB<A NAME="49265"></A> files loaded as the same molecule<A NAME="49266"></A> but as different models.

<P>
In a PDB<A NAME="49267"></A> file, the models are specified by the MODEL PDB<A NAME="49268"></A> record.  All the supported PDB<A NAME="49269"></A> readers<A NAME="49270"></A> in relax recognise this.  The internal reader<A NAME="49271"></A> defines molecules<A NAME="49272"></A> using the TER PDB<A NAME="49273"></A> record.  In both cases, the molecules<A NAME="49274"></A> will be numbered consecutively from 1.

<P>
Setting the molecule<A NAME="49275"></A> name allows the molecule<A NAME="49276"></A> within the PDB<A NAME="49277"></A> (within one model) to have a custom name.  If not set, then the molecules<A NAME="49278"></A> will be named after the file name, with the molecule<A NAME="49279"></A> number appended if more than one exists.

<P>
Note that relax will complain if it cannot work out what to do.

<P>
This is able to handle uncompressed,<A NAME="49280"></A> bzip2<A NAME="49281"></A> compressed files, or gzip<A NAME="49282"></A> compressed files automatically.  The full file name including extension can be supplied, however, if the file cannot be found, this function will search for the file name with `<TT>.bz2</TT>' appended followed by the file name with `<TT>.gz</TT>' appended.

<P>
If a PDB<A NAME="49285"></A> file contains alternative atomic locations, then the alternate location indicator must be specified to allow one of the multiple coordinate sets to be selected.

<P>

<H3><A NAME="SECTION0812248500000000000000">
Prompt examples</A>
</H3>

<P>
To load all structures from the PDB<A NAME="49287"></A> file `<TT>test.pdb</TT>' in the directory `<TT>Ëœ/pdb</TT>', including all models and all molecules,<A NAME="49290"></A> type one of:

<P>
<PRE>[numbers=none]
relax&gt; structure.read_pdb('test.pdb', '~/pdb')
</PRE>

<P>
<PRE>[numbers=none]
relax&gt; structure.read_pdb(file='test.pdb', dir='pdb')
</PRE>

<P>
To load the 10<!-- MATH
 $^{\mathrm{th}}$
 -->
<SPAN CLASS="MATH"><SUP>th</SUP></SPAN> model from the file `<TT>test.pdb</TT>' and naming it `<TT>CaM</TT>', use one of:

<P>
<PRE>[numbers=none]
relax&gt; structure.read_pdb('test.pdb', read_model=10, set_mol_name='CaM')
</PRE>

<P>
<PRE>[numbers=none]
relax&gt; structure.read_pdb(file='test.pdb', read_model=10, set_mol_name='CaM')
</PRE>

<P>
To load models 1 and 5 from the file `<TT>test.pdb</TT>' as two different structures of the same model, type one of:

<P>
<PRE>[numbers=none]
relax&gt; structure.read_pdb('test.pdb', read_model=[1, 5], set_model_num=[1, 1])
</PRE>

<P>
<PRE>[numbers=none]
relax&gt; structure.read_pdb('test.pdb', set_mol_name=['CaM_1', 'CaM_2'], read_model=[1, 5], set_model_num=[1, 1])
</PRE>

<P>
To load the files `<TT>lactose_MCMM4_S1_1.pdb</TT>', `<TT>lactose_MCMM4_S1_2.pdb</TT>', `<TT>lactose_MCMM4_S1_3.pdb</TT>' and `<TT>lactose_MCMM4_S1_4.pdb</TT>' as models, type the following sequence<A NAME="49311"></A> of commands:

<P>
<PRE>[numbers=none]
relax&gt; structure.read_pdb('lactose_MCMM4_S1_1.pdb', set_mol_name='lactose_MCMM4_S1', set_model_num=1)
</PRE>

<P>
<PRE>[numbers=none]
relax&gt; structure.read_pdb('lactose_MCMM4_S1_2.pdb', set_mol_name='lactose_MCMM4_S1', set_model_num=2)
</PRE>

<P>
<PRE>[numbers=none]
relax&gt; structure.read_pdb('lactose_MCMM4_S1_3.pdb', set_mol_name='lactose_MCMM4_S1', set_model_num=3)
</PRE>

<P>
<PRE>[numbers=none]
relax&gt; structure.read_pdb('lactose_MCMM4_S1_4.pdb', set_mol_name='lactose_MCMM4_S1', set_model_num=4)
</PRE>

<P>

<BR>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html22592"
  HREF="structure_read_xyz.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Next" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html22586"
  HREF="The_list_of_functions.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Up" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html22580"
  HREF="structure_read_gaussian.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Previous" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html22588"
  HREF="Contents.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Contents" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html22590"
  HREF="Index.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Index" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html1"
  HREF="http://download.gna.org/relax/manual/relax.pdf"><IMG
 ALIGN="BOTTOM" BORDER="0" SRC="http://www.nmr-relax.com/images/pdf_icon_nav.png"
 ALT="pdf_icon_nav.png"></A><A NAME="tex2html2"
  HREF="http://www.nmr-relax.com"><IMG
 ALIGN="BOTTOM" BORDER="0" SRC="http://www.nmr-relax.com/images/relax_logo_nav.png"
 ALT="relax_logo_nav.png"></A>
<BR>
<B> Next:</B> <A NAME="tex2html22593"
  HREF="structure_read_xyz.html">structure.read_xyz</A>
<B> Up:</B> <A NAME="tex2html22587"
  HREF="The_list_of_functions.html">The list of functions</A>
<B> Previous:</B> <A NAME="tex2html22581"
  HREF="structure_read_gaussian.html">structure.read_gaussian</A>
 &nbsp; <B>  <A NAME="tex2html22589"
  HREF="Contents.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html22591"
  HREF="Index.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
The <a href="http://www.nmr-relax.com">relax</a> <a href="http://www.nmr-relax.com/manual/">user manual</a> (<a href="http://download.gna.org/relax/manual/relax.pdf">PDF</a>), created 2015-12-15.
</ADDRESS>
</BODY>
</HTML>
