<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.1//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>structure.sequence_alignment</TITLE>
<META NAME="description" CONTENT="structure.sequence_alignment">
<META NAME="keywords" CONTENT="relax">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">

  <!--Google analytics JS-->
  <script type="text/javascript">
  
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30096326-1']);
    _gaq.push(['_setDomainName', 'nmr-relax.com']);
    _gaq.push(['_trackPageview']);
  
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  
  </script>

<LINK REL="STYLESHEET" HREF="relax.css">

<LINK REL="next" HREF="structure_superimpose.html">
<LINK REL="previous" HREF="structure_rotate.html">
<LINK REL="up" HREF="The_list_of_functions.html">
<LINK REL="next" HREF="structure_superimpose.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html22739"
  HREF="structure_superimpose.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Next" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html22733"
  HREF="The_list_of_functions.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Up" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html22727"
  HREF="structure_rotate.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Previous" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html22735"
  HREF="Contents.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Contents" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html22737"
  HREF="Index.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Index" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html1"
  HREF="http://download.gna.org/relax/manual/relax.pdf"><IMG
 ALIGN="BOTTOM" BORDER="0" SRC="http://www.nmr-relax.com/images/pdf_icon_nav.png"
 ALT="pdf_icon_nav.png"></A><A NAME="tex2html2"
  HREF="http://www.nmr-relax.com"><IMG
 ALIGN="BOTTOM" BORDER="0" SRC="http://www.nmr-relax.com/images/relax_logo_nav.png"
 ALT="relax_logo_nav.png"></A>
<BR>
<B> Next:</B> <A NAME="tex2html22740"
  HREF="structure_superimpose.html">structure.superimpose</A>
<B> Up:</B> <A NAME="tex2html22734"
  HREF="The_list_of_functions.html">The list of functions</A>
<B> Previous:</B> <A NAME="tex2html22728"
  HREF="structure_rotate.html">structure.rotate</A>
 &nbsp; <B>  <A NAME="tex2html22736"
  HREF="Contents.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html22738"
  HREF="Index.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><A NAME="tex2html22741"
  HREF="structure_sequence_alignment.html#SECTION0812253100000000000000">Synopsis</A>
<LI><A NAME="tex2html22742"
  HREF="structure_sequence_alignment.html#SECTION0812253200000000000000">Defaults</A>
<LI><A NAME="tex2html22743"
  HREF="structure_sequence_alignment.html#SECTION0812253300000000000000">Keyword arguments</A>
<LI><A NAME="tex2html22744"
  HREF="structure_sequence_alignment.html#SECTION0812253400000000000000">Description</A>
<LI><A NAME="tex2html22745"
  HREF="structure_sequence_alignment.html#SECTION0812253500000000000000">Prompt examples</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H2><A NAME="SECTION0812253000000000000000"></A> <A NAME="uf:_structure.sequence_alignment"></A>
<BR>
structure.sequence_alignment
</H2>
<IMG
  WIDTH="128" HEIGHT="128" ALIGN="BOTTOM" BORDER="0"
 SRC="./structure.png"
 ALT="Image structure"> 

<P>

<H3><A NAME="SECTION0812253100000000000000">
Synopsis</A>
</H3>

<P>
Multiple sequence<A NAME="49503"></A> alignment (MSA) of structural data.

<P>

<H3><A NAME="SECTION0812253200000000000000">
Defaults</A>
</H3>

<P>
<DIV ALIGN="LEFT">
<SPAN  CLASS="textsf"><SPAN  CLASS="textbf">structure.sequence_alignment</SPAN>(pipes=None, models=None, molecules=None, msa_algorithm=`Central Star', pairwise_algorithm=None, matrix=None, gap_open_penalty=10.0, gap_extend_penalty=1.0, end_gap_open_penalty=0.0, end_gap_extend_penalty=0.0)</SPAN>

</DIV>

<P>

<H3><A NAME="SECTION0812253300000000000000">
Keyword arguments</A>
</H3>

<P>
 <SPAN  CLASS="textsf">pipes:</SPAN>  The data pipes to use in the sequence<A NAME="49511"></A> alignment.

<P>
 <SPAN  CLASS="textsf">models:</SPAN>  The list of models for each data pipe to use in the sequence<A NAME="49514"></A> alignment.  The number of elements must match the pipes argument.  If no models are given, then all will be used.

<P>
 <SPAN  CLASS="textsf">molecules:</SPAN>  The list of molecules<A NAME="49517"></A> for each data pipe to use in the sequence<A NAME="49518"></A> alignment.  This allows differently named molecules<A NAME="49519"></A> in the same or different data pipes to be superimposed.  The number of elements must match the pipes argument.  If no molecules<A NAME="49520"></A> are given, then all will be used.

<P>
 <SPAN  CLASS="textsf">msa_algorithm:</SPAN>  The multiple sequence<A NAME="49523"></A> alignment (MSA) algorithm used to align all the primary sequence<A NAME="49524"></A> of all structures of interest.

<P>
 <SPAN  CLASS="textsf">pairwise_algorithm:</SPAN>  The pairwise alignment algorithm to align each pair of sequences.<A NAME="49527"></A>

<P>
 <SPAN  CLASS="textsf">matrix:</SPAN>  The substitution matrix to use in the pairwise sequence<A NAME="49530"></A> alignment algorithm.

<P>
 <SPAN  CLASS="textsf">gap_open_penalty:</SPAN>  The penalty for introducing gaps, as a positive number.

<P>
 <SPAN  CLASS="textsf">gap_extend_penalty:</SPAN>  The penalty for extending a gap, as a positive number.

<P>
 <SPAN  CLASS="textsf">end_gap_open_penalty:</SPAN>  The optional penalty for opening a gap at the end of a sequence.<A NAME="49537"></A>

<P>
 <SPAN  CLASS="textsf">end_gap_extend_penalty:</SPAN>  The optional penalty for extending a gap at the end of a sequence.<A NAME="49540"></A>

<P>

<H3><A NAME="SECTION0812253400000000000000">
Description</A>
</H3>

<P>
To find the atoms in common between different molecules,<A NAME="49542"></A> a MSA of the primary sequence<A NAME="49543"></A> of the molecules<A NAME="49544"></A> is required.  This sequence<A NAME="49545"></A> alignment will then subsequently be used by any other user function which operates on multiple molecules.<A NAME="49546"></A>  The following MSA algorithms can be selected:

<P>
<DL>
<DT><STRONG>`<TT>Central Star</TT>' -</STRONG></DT>
<DD>This is a heuristic, progressive alignment method using pairwise alignments to construct a MSA.  It consists of four major steps - pairwise alignment between all sequence<A NAME="49549"></A> pairs, finding the central sequence,<A NAME="49550"></A> iteratively aligning the sequences<A NAME="49551"></A> to the gapped central sequence,<A NAME="49552"></A> and introducing gaps in previous alignments during the iterative alignment.
  
</DD>
<DT><STRONG>`<TT>residue number</TT>' -</STRONG></DT>
<DD>This will simply align the molecules<A NAME="49554"></A> based on residue number.
</DD>
</DL>

<P>
For the MSA algorithms which require pairwise alignments, the following subalgorithms can be used:

<P>
<DL>
<DT><STRONG>`<TT>NW70</TT>' -</STRONG></DT>
<DD>The Needleman-Wunsch alignment algorithm.  This has been modified to use the logic of the EMBOSS software for handling gap opening and extension penalties, as well as end penalties.
</DD>
</DL>

<P>
For the MSAs or pairwise alignments which require a substitution matrix, one of the following can be used:

<P>
<DL>
<DT><STRONG>`<TT>BLOSUM62</TT>' -</STRONG></DT>
<DD>The BLOcks SUbstitution Matrix for proteins with a cluster percentage <SPAN CLASS="MATH">â‰¥</SPAN> 62%.
  
</DD>
<DT><STRONG>`<TT>PAM250</TT>' -</STRONG></DT>
<DD>The point accepted mutation matrix for proteins with <SPAN CLASS="MATH"><I>n</I></SPAN> = 250 evolutionary distance.
  
</DD>
<DT><STRONG>`<TT>NUC 4.4</TT>' -</STRONG></DT>
<DD>The nucleotide 4.4 matrix for DNA/RNA.
</DD>
</DL>

<P>
Support for multiple structures is provided by the data pipes, model numbers and molecule<A NAME="49564"></A> names arguments.  Each data pipe, model and molecule<A NAME="49565"></A> combination will be treated as a separate structure.  As only atomic coordinates with the same residue name and number and atom name will be assembled, structures with slightly different atomic structures can be compared.  If the list of models is not supplied, then all models of all data pipes will be used.  If the optional molecules<A NAME="49566"></A> list is supplied, each molecule<A NAME="49567"></A> in the list will be considered as a separate structure for comparison between each other.

<P>

<H3><A NAME="SECTION0812253500000000000000">
Prompt examples</A>
</H3>

<P>
To superimpose the structures in the `<TT>A</TT>' data pipe onto the structures of the `<TT>B</TT>' data pipe using backbone heavy atoms, type:

<P>
<PRE>[numbers=none]
relax&gt; structure.sequence_alignment(pipes=['B', 'A'], atom_id='@N,C,CA,O')
</PRE>

<P>

<BR>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html22739"
  HREF="structure_superimpose.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Next" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html22733"
  HREF="The_list_of_functions.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Up" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html22727"
  HREF="structure_rotate.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Previous" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html22735"
  HREF="Contents.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Contents" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html22737"
  HREF="Index.html">
<IMG WIDTH="48" HEIGHT="48" TITLE="Index" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html1"
  HREF="http://download.gna.org/relax/manual/relax.pdf"><IMG
 ALIGN="BOTTOM" BORDER="0" SRC="http://www.nmr-relax.com/images/pdf_icon_nav.png"
 ALT="pdf_icon_nav.png"></A><A NAME="tex2html2"
  HREF="http://www.nmr-relax.com"><IMG
 ALIGN="BOTTOM" BORDER="0" SRC="http://www.nmr-relax.com/images/relax_logo_nav.png"
 ALT="relax_logo_nav.png"></A>
<BR>
<B> Next:</B> <A NAME="tex2html22740"
  HREF="structure_superimpose.html">structure.superimpose</A>
<B> Up:</B> <A NAME="tex2html22734"
  HREF="The_list_of_functions.html">The list of functions</A>
<B> Previous:</B> <A NAME="tex2html22728"
  HREF="structure_rotate.html">structure.rotate</A>
 &nbsp; <B>  <A NAME="tex2html22736"
  HREF="Contents.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html22738"
  HREF="Index.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
The <a href="http://www.nmr-relax.com">relax</a> <a href="http://www.nmr-relax.com/manual/">user manual</a> (<a href="http://download.gna.org/relax/manual/relax.pdf">PDF</a>), created 2016-10-28.
</ADDRESS>
</BODY>
</HTML>
