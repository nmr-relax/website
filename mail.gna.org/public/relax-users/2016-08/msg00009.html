<!-- MHonArc v2.6.19+ -->
<!--X-Subject: Re: How many rounds are acceptable? -->
<!--X-From-R13: Xbunaarf Rvrgfpuervg &#60;qvrgfpuervgNtznvy.pbz> -->
<!--X-Date: Tue, 09 Aug 2016 11:15:45 +0200 -->
<!--X-Message-Id: CAMT2NTtBQgyotQ4YJ3aLVm+dyR4v9ByfWRt7T5L=+BZZHLRMMw@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: A38C8B1D&#45;09CB&#45;41F7&#45;A4A4&#45;E3178BD28159@gmail.com -->
<!--X-Reference: CA+CBx2P_QsZrzz+E6YCm=aCmqGVSYBpZH2KK=7A8HgMigaz58Q@mail.gmail.com -->
<!--X-Reference: CAMT2NTtgo24yfyjnmczeuD7QYO73GF0VwoDVWYCWKiKJ148VpQ@mail.gmail.com -->
<!--X-Reference: CAED9pY&#45;pnbZ8G6ksJgR4dHRFwvmCKX84Hvb5nLx+UxFk1bXBcQ@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: How many rounds are acceptable? -- August 09, 2016 - 11:15</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: How many rounds are acceptable?</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00009" class="tabs">Index by Date</a> | <a href="threads.html#00009" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00008.html">Date Prev</a>] [<a href="msg00010.html">Date Next</a>] [<a href="msg00003.html">Thread Prev</a>] [<a href="msg00010.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Edward d'Auvergne&quot; &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Tue, 9 Aug 2016 11:15:16 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-users@xxxxxxx&quot; &lt;relax-users@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113; h=mime-version:in-reply-to:references:from:date:message-id:subject:to :cc; bh=nxBdhcJiH5iUsAHhaiCuS7gQLlW2ys4rpRaZFG5PZYY=; b=A6+XLAbYrS+ACvawfJJ0bsCTkcDnWnMTVLuY3mDYMydVLW6LX2Bx1FdSX5Ur3UG5Gu yFUzHE7VOgS8R9HV5Az9gmavUhCVAIeQvoXGlntUFVLAigalCsVsFX3RuvUscYRLXlBN X/CYQweVetbAx9P2z94KcB67F5dulFFq3QGNMJBtaqmpKRd8xxPqXWYqY7h64EwCFLhj JJnF7LEMPmmsPhJICO0GT6CuHqTGV+ySGoRgHcnAn296SQKGW6cRzPYCUQ+o6JS1spx6 YaHgaXADALfvtM1BOWo3coNYDqy/GtOxy1nSY697UtEpzpJnZUHPpN8U0h8u3zVTupvm PFlQ==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;CAMT2NTtBQgyotQ4YJ3aLVm+dyR4v9ByfWRt7T5L=+BZZHLRMMw@mail.gmail.com&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;<a href="msg00000.html">A38C8B1D-09CB-41F7-A4A4-E3178BD28159@gmail.com</a>&gt; &lt;CA+CBx2P_QsZrzz+E6YCm=aCmqGVSYBpZH2KK=7A8HgMigaz58Q@mail.gmail.com&gt; &lt;<a href="msg00002.html">CAMT2NTtgo24yfyjnmczeuD7QYO73GF0VwoDVWYCWKiKJ148VpQ@mail.gmail.com</a>&gt; &lt;<a href="msg00003.html">CAED9pY-pnbZ8G6ksJgR4dHRFwvmCKX84Hvb5nLx+UxFk1bXBcQ@mail.gmail.com</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Johannes Dietschreit</strong> on August 09, 2016 - 11:15:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hello Edward,

I understand that the strict convergence criteria are neccessary. When I
set the max_iter parameter to just 30, I get very similar results as to
when I reduce the opt_tol. I guess the model is just not converged.

You were quite right, the negative te values are very close to zero, their
error is many orders of magnitude larger than their own value. The avergae
hetNOE values is around 0.7. The measurements were taken at 600 and 700
MHz. I haven't taken them myself, my work concerns the theoretical side of
things. The protein is not a membrane protein, it is in solution and the
exact molecule given in the crystal structure I used as input for relax was
measured (no tag or similar). The local spectrometer does unfortunately not
allow for fancy temperature control methods.

I feel relatively certain that the set up was in general correct. I tried
both your python script and the GUI. The results I reported were taken from
the txt-files in the final folder. As for the results of the previous runs.
I am not sure how to access them or to read them. They are all zipped xml
files where I cannot find a clear results section. Is there a certain
program/command I should use?

I wanted to use your visualization script xh_vector_dist.py, but I am not
sure whoch file should be the  input for
'select.read(file=pardir+sep+'rates.txt', change_all=True, res_num_col=2)'
I visualized the tensor.pdb which is printed in the final directory. It is
huge compared to the protein. It has the shape of a eight of a spheroid.

Maybe just a simple question regarding the input. The R1 and R2 input files
contained values in Hz (not radian). Is that correct?


Regards,

Johannes




2016-08-08 16:49 GMT+02:00 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:

</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Johannes,

Sorry for the late response.  I've been quite busy in the last two
months.  Please see below:


On 8 August 2016 at 13:25, Johannes Dietschreit &lt;dietschreit@xxxxxxxxx&gt;
wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

thank you so much for your quick and long response. I did not change the
hard coded value, I decided to leave that one alone, but I followed the
example of the test_suite and set the convergence criterion to 1e-7. This
seems still strict, but now the calculation converges and final results
</pre></blockquote><pre style="margin: 0em;">are
</pre><blockquote class="blockquote"><pre style="margin: 0em;">written.
</pre></blockquote><pre style="margin: 0em;">

The &quot;strict&quot; values are quite important for making sure there are no
strange results.  You'll see that in:

    d'Auvergne, E. J. and Gooley, P. R. (2008). Optimisation of NMR
dynamic models I. Minimisation algorithms and their performance within
the model-free and Brownian rotational diffusion spaces. J. Biomol.
NMR, 40(2), 107-119. (<a  rel="nofollow" href="http://dx.doi.org/10.1007/s10858-007-9214-2">http://dx.doi.org/10.1007/s10858-007-9214-2</a>)

Reading this paper is essential for understanding these cut-off
values, and why these high precision values are important.  However if
there is a problem with the input data, then you will see problems.
In your example, I am not sure why this is not stopping after 30
iterations.  If you have a look at the automated protocol:

    <a  rel="nofollow" href="/api/4.0/auto_analyses.dauvergne_">http://www.nmr-relax.com/api/4.0/auto_analyses.dauvergne_</a>
protocol-module.html
    <a  rel="nofollow" href="/api/4.0/auto_analyses.dauvergne_">http://www.nmr-relax.com/api/4.0/auto_analyses.dauvergne_</a>
protocol.dAuvergne_protocol-class.html

you will see the max_iter parameter.  Ok, I see that this is set to 30
in the GUI, but it is not set in the sample script.  If you require
more than 30 iterations of the global protocol (
<a  rel="nofollow" href="/manual/Model_free_analysis_in_reverse.html">http://www.nmr-relax.com/manual/Model_free_analysis_in_reverse.html</a> ),
then this is an indication that the input data is problematic.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">My question now regards the results in the folder &quot;final&quot;. My analysis
</pre></blockquote><pre style="margin: 0em;">was
</pre><blockquote class="blockquote"><pre style="margin: 0em;">performed regarding the classical model free ansatz but I allowed for all
possible diffusion models. The protein I am dealing with is rather stiff,
it contains a beta barrel and some flexible loops. However, all residues
have a S^2 value of about 0.03. I expected the residues in the barrel to
have much larger values.
</pre></blockquote><pre style="margin: 0em;">

These values indicate a severe problem with the input data.  What is
your average HetNOE value?  At which field strengths did you measure?


</pre><blockquote class="blockquote"><pre style="margin: 0em;">Also the t_e values are somewhat spurious. Most of them are unphisically
small (~e-24 seconds), I had expected values in the range of ten to
</pre></blockquote><pre style="margin: 0em;">hundred
</pre><blockquote class="blockquote"><pre style="margin: 0em;">pico seconds. And there are a few t_e values with a negative sign. How is
that possible?
</pre></blockquote><pre style="margin: 0em;">

These should disappear through model selection.  If te ~ 0, then the
simpler model without te will be selected, as these models should have
converged to the same result.  Unless of course there is a major
failure of the whole analysis.  For the te values with negative
values, what are there values?  The lower quality cut-off values will
allow for very small minus te values.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">Is this a common error? Have I just made a mistake regarding the input? I
attached my dauvergne_protocol.py file and some input data.
</pre></blockquote><pre style="margin: 0em;">

Note that you cannot attach files when posting to a public mailing
list.  This is to avoid major strain on the infrastructure.  For
sharing files, please create a support request and attach the files
there ( <a  rel="nofollow" href="http://gna.org/support/?func=additem&amp;group=relax">http://gna.org/support/?func=additem&amp;group=relax</a> ).  Be
careful though, as this is public and anyone will be able to access
your data.  From the ridiculously large number of iterations of the
global algorithm and the non-physical S2 and te values, I can only
guess that there is a major problem with the input data.  This could
either be due to how the analysis was set up, or how the data was
measured.  Looking at
<a  rel="nofollow" href="/manual/Temperature_control_and_calibration.html">http://www.nmr-relax.com/manual/Temperature_control_and_calibration.html</a>
, how did you perform temperature calibration and temperature control?
 Do you see any warnings at the start of your log files?  When running
relax, it is extremely important to check every warning at the start
to make sure that the results are reasonable.

Also, if you look at the local tm model results, are the S2 and te
values similar to the final results?  Or similar to the spherical
diffusion model?

Also note that for a rigid beta barrel with flexible loops that the
backbone NH bond vector distribution will not be isotropic.  I suggest
running the sample_scripts/xh_vector_dist.py script and visualising
the results.  This is the script I created for Figure 4 in:

    d'Auvergne, E. J. and Gooley, P. R. (2008). Optimisation of NMR
dynamic models II. A new methodology for the dual optimisation of the
model-free parameters and the Brownian rotational diffusion tensor. J.
Biomol. NMR, 40(2), 121-133.
(<a  rel="nofollow" href="http://dx.doi.org/10.1007/s10858-007-9213-3">http://dx.doi.org/10.1007/s10858-007-9213-3</a>)

Also, are you in a membrane system?  If so, then you actually have two
diffusion tensors.  The protein will spin inside the micelle/bicelle,
and then the whole system will have an independent global ellipsoidal
or spheroidal diffusion.  I am unaware of anyone to date who has
derived the equations for such a system.  Nevertheless, the strange
results you see are unlikely to be due to this modelling deficiency.

Regards,

Edward

</pre></blockquote><pre style="margin: 0em;">

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00010" href="msg00010.html">Re: How many rounds are acceptable?</a></strong>
<ul><li><em>From:</em> Johannes Dietschreit</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00000" href="msg00000.html">How many rounds are acceptable?</a></strong>
<ul><li><em>From:</em> Johannes Dietschreit</li></ul></li>
<li><strong><a name="00001" href="msg00001.html">Re: How many rounds are acceptable?</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00002" href="msg00002.html">Re: How many rounds are acceptable?</a></strong>
<ul><li><em>From:</em> Johannes Dietschreit</li></ul></li>
<li><strong><a name="00003" href="msg00003.html">Re: How many rounds are acceptable?</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Wed Aug 10 16:40:02 2016</div>  
</body>
</html>
