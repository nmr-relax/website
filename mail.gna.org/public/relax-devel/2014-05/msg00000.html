<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [sr #3154] Implementation of Baldwin (2014) B14 model &#45; 2&#45;site exact solution model for all time scales -->
<!--X-From-R13: Oaqerj Pnyqjva &#60;naqerj.onyqjvaNpurz.bk.np.hx> -->
<!--X-Date: Wed, 30 Apr 2014 12:14:21 +0200 -->
<!--X-Message-Id: 5360CCC8.3050309@chem.ox.ac.uk -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20140429&#45;222552.sv20529.12099@gna.org -->
<!--X-Reference: 20140429&#45;222920.sv20529.65319@gna.org -->
<!--X-Reference: 20140429&#45;223825.sv20529.27067@gna.org -->
<!--X-Reference: CA+CBx2N5ti2&#45;+cs4TPViYxqnEpjH3432hydxCicgOcdLb01cEw@mail.gmail.com -->
<!--X-Reference: CAED9pY9josZukT1kOeax=U02GsHL5FMpuaQ9JqTTT+Gx5Ah&#45;eQ@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales -- April 30, 2014 - 12:14</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00000" class="tabs">Index by Date</a> | <a href="threads.html#00000" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[Date Prev] [<a href="msg00001.html">Date Next</a>] [Thread Prev] [<a href="msg00010.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Wed, 30 Apr 2014 11:13:28 +0100</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00000.html">5360CCC8.3050309@chem.ox.ac.uk</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;20140429-222552.sv20529.12099@gna.org&gt;	&lt;20140429-222920.sv20529.65319@gna.org&gt;	&lt;20140429-223825.sv20529.27067@gna.org&gt;	&lt;CA+CBx2N5ti2-+cs4TPViYxqnEpjH3432hydxCicgOcdLb01cEw@mail.gmail.com&gt; &lt;CAED9pY9josZukT1kOeax=U02GsHL5FMpuaQ9JqTTT+Gx5Ah-eQ@mail.gmail.com&gt;</li>
<li class="menuitem">
<em>User-agent</em>: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:24.0) Gecko/20100101 Thunderbird/24.5.0</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Andrew Baldwin</strong> on April 30, 2014 - 12:14:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Hi Edward,

The origin of the code was my fat head.

</pre><tt>One thing relevent: the cofactors i've called F0 and F2 turned out the 
</tt><tt>same as used by Carver and Richards. In my hands at least, there is a 
</tt><tt>faster way of computing them using trig functions rather than 
</tt><tt>square-roots-of-square-roots (see my code for details). Also, i'd make 
</tt><tt>triple sure that the definitions you've used for e.g tau_c match mine. 
</tt><tt>There are at least three conventions I know of in the literature. In my 
</tt><tt>code, a CPMG cycle is tau/180/tau/tau/180/tau. That'll be the same as 
</tt><tt>Flemming and Dimitri use. There's a typo in Carver Richard's paper that 
</tt><tt>has propagated nastily throughout the literature. I can send my 
</tt><tt>implementation of CR that I used for direct comparison with my result 
</tt><tt>and the numerical result if that helps keep your headaches down.
</tt><pre style="margin: 0em;">

</pre><tt>You guys are free to use my code (I don't mind the gnu license) or of 
</tt><tt>course implement from scratch as needed.
</tt><pre style="margin: 0em;">

</pre><tt>I'd like to note again though that anyone using this formula to fit 
</tt><tt>data, though exact in the case of 2site exchange/inphase magnetisation, 
</tt><tt>evaluated at double floating point precision should not be doing so! 
</tt><tt>Neglecting scalar coupling/off resonance/spin flips/the details of the 
</tt><tt>specific pulse sequence used will lead to avoidable foobars. I do see 
</tt><tt>value in this, as described in the paper, as being a feeder for initial 
</tt><tt>conditions for a more fancy implemenation. But beyond that, 'tis a bad 
</tt><tt>idea. Ideally this should appear in big red letters in your (very nice!) 
</tt><tt>gui when used.
</tt><pre style="margin: 0em;">

Best,

Andy.





On 30/04/2014 10:58, Edward d'Auvergne wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">
Hi Troels and Andy,

It would be great to incorporate this model into relax.  I was
wondering what the origin and history of the code in the Baldwin.py
script was though?

Looking at the code and equations (<a  rel="nofollow" href="http://wiki.nmr-relax.com/B14">http://wiki.nmr-relax.com/B14</a>), I'm
wondering if it would be easier for you Troels to simply copy the
lib/dispersion/cr72.py relax file to lib/dispersion/b14.py and then
modify it to implement the new equations.  You could use the
Baldwin.py script as inspiration, but I think it would be harder to
convert the 20 or so lines of interest in this script into the correct
format for relax than to simply convert the CR72 (Carver and Richards)
ones.  If you started with Baldwin.py, the code will anyway change
significantly when you make speed ups anyway - by shifting certain
calculations higher up in the nested looping over the experiment
types, magnetic field strengths, and offsets, by removing all int to
float type conversions that occur in the script (due integer values
being used in a number of places), and by minimising replicated
mathematical operations (g1**2, g2**2, g3**2, g4**2,
(g1**2.0+g2**2.0)**(1/4.0), etc. are all duplicated).  However the
script and the output file it creates would serve as a perfect basis
for a system test - you have numbers to test against.

If this route is taken, then a copyright licensing agreement is not
needed (such as at
<a  rel="nofollow" href="http://article.gmane.org/gmane.science.nmr.relax.devel/4279">http://article.gmane.org/gmane.science.nmr.relax.devel/4279</a>,
<a  rel="nofollow" href="http://article.gmane.org/gmane.science.nmr.relax.devel/4276">http://article.gmane.org/gmane.science.nmr.relax.devel/4276</a>,
<a  rel="nofollow" href="http://article.gmane.org/gmane.science.nmr.relax.devel/4271">http://article.gmane.org/gmane.science.nmr.relax.devel/4271</a>,
<a  rel="nofollow" href="http://article.gmane.org/gmane.science.nmr.relax.devel/4138">http://article.gmane.org/gmane.science.nmr.relax.devel/4138</a>, and
<a  rel="nofollow" href="http://article.gmane.org/gmane.science.nmr.relax.devel/4157">http://article.gmane.org/gmane.science.nmr.relax.devel/4157</a>).  However
if you Andy make such a statement to the relax mailing list, then we
could save the script as is (well with a GPL3+ copyright statement
added with your name) into the relax test suite data directories and
use it to create synthetic data.  This would then be used to test our
implementation.  Troels will also then be able to copy and paste
certain parts of the script for the implementation as well.

Cheers,

Edward


On 30 April 2014 00:51, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">
Dear Andrew Baldwin.

Thank you for the submission of your code to me.

For relax to be able to legally incorporate the code, a copyright
licence from all authors is required (as well as which years the code
was developed, for the copyright notice).
relax is an open source software project which relies on the GPLv3+ licence
(the GNU General Public Licence).

You can see an example of the copyright notice at the top of this file:

<a  rel="nofollow" href="http://svn.gna.org/viewcvs/*checkout*/relax/branches/relax_disp/lib/dispersion/ns_2site_expanded.py?revision=20464&amp;content-type=text%2Fplain&amp;pathrev=20478">http://svn.gna.org/viewcvs/*checkout*/relax/branches/relax_disp/lib/dispersion/ns_2site_expanded.py?revision=20464&amp;content-type=text%2Fplain&amp;pathrev=20478</a>

I would like to have your permission to use the code I have submitted
to the tracker.
It requires a statement to one of the relax public mailing
lists, such as this one, similar to:

&quot;I agree to licence my contributions to the code in the file
<a  rel="nofollow" href="https://gna.org/support/download.php?file_id=20615">https://gna.org/support/download.php?file_id=20615</a> attached to
<a  rel="nofollow" href="https://gna.org/support/index.php?3154">https://gna.org/support/index.php?3154</a> under the GNU General Public Licence,
version three or higher.  My copyright covers the years 2013-2014.&quot;

For reference, the GPL licence is explained in
detail at <a  rel="nofollow" href="http://www.gnu.org/licenses/gpl.html">http://www.gnu.org/licenses/gpl.html</a>.

The copyright licence allows the code to be used in relax for ever -
the GPL licence to the
code in relax can never be revoked.
But you own the copyright to your code - it is not a copyright transfer.
So you are free license your code as you wish in the future, or to do
as you like with it.
But you cannot re-license the code that is located within relax or revoke the
licence.
This is the standard protection for open source projects.

If you are happy with this, then please respond to this message with
text similar to the above statement (it can be copied and modified).

This will allow the code to remain in relax.
It also allows other relax developers to expand on the code.
I will then add your names with the dates to the copyright notices in
the relevant files in relax.

You are also free to give suggestions as to how you should be
acknowledged in the relax user manual (temporarily at
<a  rel="nofollow" href="http://download.gna.org/relax/manual/relax.pdf">http://download.gna.org/relax/manual/relax.pdf</a>).

Best
Troels E. Linnet

2014-04-30 0:38 GMT+02:00 Troels E. Linnet &lt;NO-REPLY.INVALID-ADDRESS@xxxxxxx&gt;:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">
Follow-up Comment #2, sr #3154 (project relax):

Here is the attached code, which forms the basis.

(file #20615)
     _______________________________________________________

Additional Item Attachment:

File name: Baldwin.py                     Size:3 KB


     _______________________________________________________

Reply to this item at:

   &lt;<a  rel="nofollow" href="http://gna.org/support/?3154">http://gna.org/support/?3154</a>&gt;

_______________________________________________
   Message sent via/by Gna!
   <a  rel="nofollow" href="http://gna.org/">http://gna.org/</a>

</pre></blockquote><pre style="margin: 0em;">
_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-devel mailing list
relax-devel@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="http://www.nmr-relax.com/mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a>
</pre></blockquote></blockquote><pre style="margin: 0em;">



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Mon May 19 16:20:14 2014</div>  
</body>
</html>
