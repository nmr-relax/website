<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [Fwd: Re: r3194 &#45; in /1.3: relax test_suite/runner.py	test_suite/unit_tests/unit_test_runner.py] -->
<!--X-From-R13: "Unel E. Fubzcfba" <tnelgNozo.yrrqf.np.hx> -->
<!--X-Date: Thu, 15 Mar 2007 18:38:10 +0100 -->
<!--X-Message-Id: 45F98450.7000905@bmb.leeds.ac.uk -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 45F95733.3090906@bmb.leeds.ac.uk -->
<!--X-Reference: 7f080ed10703150733i2c1401a4l44aaebeaf60dce71@mail.gmail.com -->
<!--X-Reference: 45F9669C.3070207@bmb.leeds.ac.uk -->
<!--X-Reference: 7f080ed10703150948q71c01982u6fb4dcb9d3f34c57@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [Fwd: Re: r3194 - in /1.3: relax test_suite/runner.py	test_suite/unit_tests/unit_test_runner.py] -- March 15, 2007 - 18:38</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: [Fwd: Re: r3194 - in /1.3: relax test_suite/runner.py	test_suite/unit_tests/unit_test_runner.py]</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00071" class="tabs">Index by Date</a> | <a href="threads.html#00071" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00070.html">Date Prev</a>] [<a href="msg00072.html">Date Next</a>] [<a href="msg00069.html">Thread Prev</a>] [<a href="msg00072.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Edward d'Auvergne &lt;edward.dauvergne@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Thu, 15 Mar 2007 17:37:20 +0000</li>
<li class="menuitem">
<em>Cc</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00071.html">45F98450.7000905@bmb.leeds.ac.uk</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;<a href="msg00061.html">45F95733.3090906@bmb.leeds.ac.uk</a>&gt;	&lt;<a href="msg00064.html">7f080ed10703150733i2c1401a4l44aaebeaf60dce71@mail.gmail.com</a>&gt;	&lt;<a href="msg00067.html">45F9669C.3070207@bmb.leeds.ac.uk</a>&gt;	&lt;<a href="msg00069.html">7f080ed10703150948q71c01982u6fb4dcb9d3f34c57@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>User-agent</em>: Mozilla Thunderbird 1.0 (X11/20041206)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Gary S. Thompson</strong> on March 15, 2007 - 18:38:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Edward d'Auvergne wrote:</pre><br>
<blockquote class="blockquote"><pre style="margin: 0em;">On 3/16/07, Gary S. Thompson &lt;garyt@xxxxxxxxxxxxxxx&gt; wrote:</pre><br>
<blockquote class="blockquote"><pre style="margin: 0em;">Edward d'Auvergne wrote:</pre><br>
<pre style="margin: 0em;">&gt;&gt; On 3/15/07, Gary S. Thompson &lt;garyt@xxxxxxxxxxxxxxx&gt; wrote:
&gt;&gt; &gt; Edward d'Auvergne wrote:
&gt;&gt; &gt;
&gt;&gt; &gt; &gt; Hi,
&gt;&gt; &gt; &gt;
&gt;&gt; &gt; &gt; Thank you very much for your efforts.  The unit test framework is
&gt;&gt; &gt; &gt; running very smoothly.  There are two features or points which I
&gt;&gt; could
&gt;&gt; &gt; &gt; handle if you would like.  The first is the addition of cross
&gt;&gt; platform
&gt;&gt; &gt; &gt; compatibility with paths, directory separators, etc.  This I
&gt;&gt; should be
&gt;&gt; &gt; &gt; able to fix up quickly.
&gt;&gt; &gt;
&gt;&gt; &gt; I will try a run on my windows box at home at some point
&gt;
&gt;
&gt; I can make the modifications if you like.  After reading
&gt; <a  href="http://docs.python.org/lib/os-path.html">http://docs.python.org/lib/os-path.html</a> I noticed that even the
&gt; current directory '.' is not a constant, in Mac OS 9 it is actually
&gt; the colon ':'!</pre><br>
<pre style="margin: 0em;"> go ahead an i will have a look at the diffs and see if I cans
seeanything else
</pre></blockquote><pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">I'll get to it tomorrow.</pre><br>
<br>
<blockquote class="blockquote"><tt>(nb is there a side by side diff untility for svn?)
</tt></blockquote><pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">Not that I'm aware of.  There may be a tool to convert the universal
diff to other diff formats.  Alternatively the webcvs frontend to the
svn repository will give you something similar to side-by-side diff
and it is colour coded as well.</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">regards
gary</pre><br>
<pre style="margin: 0em;">n.b. there is at least one place where '.' is used as an implicit
constant and not put into a path
n.b. it might be a good idea if the unix syntax always works if possible
because that allows cross platform compatability. note support for unix
pathes is a part of the python paradigm
</pre></blockquote><pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">If '.' is translated into the value of 'os.curdir', then this could be
supported.  Ideally a function to determine if the supplied path is
'posix', 'nt', 'os2', 'mac', 'ce' or 'riscos' could be created.  It's
return value would be the path in the format recognised by the
executing operating system.</pre><br>
<pre style="margin: 0em;">Alternatively the ad hoc user of Unit_test_runner can supply a non
platform independent string and it should just operate fine on their
system (Python by default operates this way).  A script the user
creates in this way would not be cross platform compatible.  relax
however would use 'os.curdir', 'os.pardir', and 'os.sep' and
internally will be platform independent.</pre><br>
<pre style="margin: 0em;"><br></pre><br>
<blockquote class="blockquote"><pre style="margin: 0em;">cf
*normpath*(     path)</pre><br>
<pre style="margin: 0em;">    Normalize a pathname. This collapses redundant separators and
    up-level references so that |A//B|, |A/./B| and |A/foo/../B| all
    become |A/B|. It does not normalize the case (use normcase() for
    that). On Windows, it converts forward slashes to backward slashes.
    It should be understood that this may change the meaning of the path
    if it contains symbolic links!
as an example
</pre></blockquote><pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">Does this convert any OS path format to the current OS?  Do you know
if it converts 'posix' paths to the format of the executing operating
system (rather than just converting to Windows directory separators
when required)?  If so, this would be the best solution.</pre><br>
<br>
<blockquote class="blockquote"><tt>&gt; I've already done a lot of this portability stuff in<br>
&gt; the rest of relax so I can quickly go through and make all necessary<br>
&gt; changes.<br>
&gt;<br>
&gt;<br>
&gt;&gt; &gt; &gt; The second may take a small redesign of the<br>
&gt;&gt; &gt; &gt; code for searching for unit tests.  At the moment there appears<br>
&gt;&gt; to be<br>
&gt;&gt; &gt; &gt; no technique for running unit tests for functions or class 
methods<br>
&gt;&gt; &gt; &gt; located within the relax '__init__.py' files.  For example in the<br>
&gt;&gt; &gt; &gt; current revision of the 1.3 line (r3199), there is the file<br>
&gt;&gt; &gt; &gt; 'test_suite/unit_tests/data/test___init__.py' which contains unit<br>
&gt;&gt; &gt; &gt; tests for the class methods of the relax data storage singleton<br>
&gt;&gt; in the<br>
&gt;&gt; &gt; &gt; relax file 'data/__init__.py'.  If you like, I could have a go at<br>
&gt;&gt; &gt; &gt; fixing this.<br>
&gt;&gt; &gt; &gt;<br>
&gt;&gt; &gt; Hum interesting I will need to think about this. If you can see a<br>
&gt;&gt; simple<br>
&gt;&gt; &gt; solution go for it and I can have a look at the results otherwise<br>
&gt;&gt; Imore<br>
&gt;&gt; &gt; will think about it soon (next 2-3 days)<br>
&gt;<br>
&gt;<br>
I have analysed the problem here and there are two things</tt><br>
<br>
<pre style="margin: 0em;">1. the test case for a file called test___init__.py is currently assumed
to be the class Test___init__(TestCase)
</pre></blockquote><pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">That'll be the problem!  Thanks.  What do you think of the idea of
extending the searching capabilities to find all classes starting with
'Test_' (or alternatively those subclassed from TestCase)?  The module
could then reflect the setup of relax modules containing multiple
classes - each relax module class has a corresponding unit test
TestCase class.</pre><br>
<br>
<blockquote class="blockquote"><tt>2. python will not accept classnames with trailing spaces (try it 
it's true!
</tt></blockquote><br>
</blockquote><pre style="margin: 0em;"><br>sorry trailing underscores (you can create them but you cant load them
:</pre><br>
<tt>e.g. make sure   data/test___init__.py contains the class Test___init__ 
and try<br>
unit_test_runner.py data/test___init__.py/Test___init__</tt><br>
<br>
<tt>it will fail<br>
test_suite/unit_tests&gt; unit_test_runner.py 
data/test___init__.py/Test___init__<br>
testing units...<br>
----------------</tt><br>
<br>
<tt>Error: no test directories found for input module: 
data/test___init__.py/Test___init__</tt><br>
<br>
<pre style="margin: 0em;"><br>now edit class Test___init__ in data/test___init__.py to Test___init and 
try</pre><br>
<pre style="margin: 0em;">unit_test_runner.py data/test___init__.py/Test___init</pre><br>
<pre style="margin: 0em;">it will load (and promply fail the unit tests that are in development</pre><br>
<pre style="margin: 0em;">testing units...
----------------</pre><br>
<tt>E.FFE<br>
======================================================================<br>
ERROR: Unit test for testing the addition of a new data pipe by the 
'add()' method.<br>
----------------------------------------------------------------------<br>
Traceback (most recent call last):<br>
 File 
&quot;/home/garyt/projects/relax_branch/branch-13/test_suite/unit_tests/data/test___init__.py&quot;, 
line 72, in test_add<br>
   self.data_store.add('new')<br>
AttributeError: 'NewStore' object has no attribute 'add'</tt><br>
<br>
<tt>======================================================================<br>
ERROR: Test that the relax data storage object is functioning as a 
singleton.<br>
----------------------------------------------------------------------<br>
Traceback (most recent call last):<br>
 File 
&quot;/home/garyt/projects/relax_branch/branch-13/test_suite/unit_tests/data/test___init__.py&quot;, 
line 64, in tearDown<br>
   del self.new_ref<br>
AttributeError: new_ref</tt><br>
<br>
<tt>======================================================================<br>
FAIL: Unit test for the __reset__() class method.<br>
----------------------------------------------------------------------<br>
Traceback (most recent call last):<br>
 File 
&quot;/home/garyt/projects/relax_branch/branch-13/test_suite/unit_tests/data/test___init__.py&quot;, 
line 101, in test_reset<br>
   self.assert_(hasattr(self.data_store, 'add'))<br>
AssertionError</tt><br>
<br>
<tt>======================================================================<br>
FAIL: Test that the relax data storage object is functioning as a singleton.<br>
----------------------------------------------------------------------<br>
Traceback (most recent call last):<br>
 File 
&quot;/home/garyt/projects/relax_branch/branch-13/test_suite/unit_tests/data/test___init__.py&quot;, 
line 121, in test_singleton<br>
   self.assert_(not hasattr(new, 'test'))<br>
AssertionError</tt><br>
<br>
<pre style="margin: 0em;">----------------------------------------------------------------------
Ran 4 tests in 0.003s</pre><br>
<pre style="margin: 0em;">FAILED (failures=2, errors=2)</pre><br>
<pre style="margin: 0em;">[snip]</pre><br>
<pre style="margin: 0em;">regards
gary</pre><br>
<blockquote class="blockquote"><pre style="margin: 0em;">...</pre><br>
<pre style="margin: 0em;">Cheers,</pre><br>
<pre style="margin: 0em;">Edward</pre><br>
<pre style="margin: 0em;">.</pre><br>
</blockquote><pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">--
-------------------------------------------------------------------
Dr Gary Thompson
Astbury Centre for Structural Molecular Biology,
University of Leeds, Astbury Building,
Leeds, LS2 9JT, West-Yorkshire, UK             Tel. +44-113-3433024
email: garyt@xxxxxxxxxxxxxxx                   Fax  +44-113-2331407
-------------------------------------------------------------------</pre><br>
<pre style="margin: 0em;"><br></pre><br>
<br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00061" href="msg00061.html">[Fwd: Re: r3194 - in /1.3: relax test_suite/runner.py	test_suite/unit_tests/unit_test_runner.py]</a></strong>
<ul><li><em>From:</em> Gary S. Thompson</li></ul></li>
<li><strong><a name="00064" href="msg00064.html">Re: [Fwd: Re: r3194 - in /1.3: relax test_suite/runner.py	test_suite/unit_tests/unit_test_runner.py]</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00067" href="msg00067.html">Re: [Fwd: Re: r3194 - in /1.3: relax test_suite/runner.py	test_suite/unit_tests/unit_test_runner.py]</a></strong>
<ul><li><em>From:</em> Gary S. Thompson</li></ul></li>
<li><strong><a name="00069" href="msg00069.html">Re: [Fwd: Re: r3194 - in /1.3: relax test_suite/runner.py	test_suite/unit_tests/unit_test_runner.py]</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu Mar 15 19:00:33 2007</div>  
</body>
</html>
