<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [task #7794] Make dx capture x, y, z positions during minimisation to make a video of minimisation -->
<!--X-From-R13: "Sqjneq q'Ohiretar" &#60;rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Mon, 12 May 2014 10:16:02 +0200 -->
<!--X-Message-Id: CAED9pY9JWMO1ddKBJ_T35=2m8eKTG&#45;QMOi6EFOW_zMOcQ5Jo8Q@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20140511&#45;064307.sv20529.20260@gna.org -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [task #7794] Make dx capture x, y, z positions during minimisation to make a video of minimisation -- May 12, 2014 - 10:16</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: [task #7794] Make dx capture x, y, z positions during minimisation to make a video of minimisation</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00320" class="tabs">Index by Date</a> | <a href="threads.html#00320" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00319.html">Date Prev</a>] [<a href="msg00326.html">Date Next</a>] [<a href="msg00300.html">Thread Prev</a>] [<a href="msg00322.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Troels E. Linnet&quot; &lt;NO-REPLY.INVALID-ADDRESS@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Mon, 12 May 2014 10:15:11 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113; h=mime-version:sender:in-reply-to:references:date:message-id:subject :from:to:cc:content-type; bh=a7ZoBmUppas85thhYA+KOYJSHKkJkmqgWa55gqQZXAU=; b=CTnygEDX8sleRRsh9PeilU3/FiGaSYv18fx2+evn+ykE4ofHqWlRVbom0QK1Yg7bUl ytAheR6hs6wjr9wU0Gb5uIBWE5EQMihY4KAPZUrER1ckxLVpIQWM5tgGWtUFlpLLRRds h2wFEkFHBXmakg7Hv18qptPwCF9iPhFNppRsOc6tzTQ/6CMdSSNa+ucp41si6QV2SEqO lflXcq3Oq+d+4J+Vh13bt5eCaBBJaB69zR5+YmnrUm5davejvcvri2hSs0Ljb3BU/oL0 nUssgMc4LuxeTMzj6+8eFMC4S/PqKwfF+7lsGaXmzhaO91wCtTsSIq+xsjb5US9rKSEf kgyQ==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;CAED9pY9JWMO1ddKBJ_T35=2m8eKTG-QMOi6EFOW_zMOcQ5Jo8Q@mail.gmail.com&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;<a href="msg00300.html">20140511-064307.sv20529.20260@gna.org</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on May 12, 2014 - 10:16:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi Troels,

This is a great idea!  But it is rather disruptive.  Therefore I have
some suggestions below.  Rather than answering all in one post, for a
nicer thread structure at
<a  rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.devel/5747">http://thread.gmane.org/gmane.science.nmr.relax.devel/5747</a>, it is good
to answer each point below in a separate post.  That will also help
focus discussions.  Cheers!


1)  You should make a subversion branch just for developing this
feature.  In case you give up or don't have the time, this will mean
that the trunk will not be severely disrupted.


2)  This is important - adding such a feature to the target functions
is computationally expensive.  I have tried it before in the
model-free analysis, but rejected the commits because of the huge
slow-down.  And it is expensive coding-wise, as you would need to do
that for all target functions for all analyses.  Therefore you should
not change target functions, but instead develop one generic wrapper
function for all.  This function would be sent into minfx as the
target function.  It would take the parameter vector, append it to a
list, and then send the parameter vector into the real target
function.


3)  Because of 2), it would be better to create a special dx.minimise
user function.  This would be similar to the minimise user function,
but would also add a few of the dx.map user function arguments.  It
could then create an OpenDX data file and matching *.general file.  It
could maybe even have a compulsory argument for a pre-created dx.map
output, so that it can create a new *.net OpenDX program for the
animation, which recycles many parts of the dx.map *.net program and
uses the chi-squared surface data.

As this would be a separate user function to the optimisation user
functions, it should not change the model parameter values.  I.e. it
performs optimisation from the current parameter values but then
ignores the result, only storing the parameter array for each
iteration for it's own internal use.  You should not change the relax
data store.


4)  You should understand the Nelder-Mead simplex algorithm verses all
other algorithms in minfx.  In the case of Nelder-Mead, you have a
geometric object walking through the space
(<a  rel="nofollow" href="https://en.wikipedia.org/wiki/File:Nelder_Mead1.gif">https://en.wikipedia.org/wiki/File:Nelder_Mead1.gif</a>).  For all other
methods, you have a simple line.  I.e. iteration 1 connects directly
to 2, 2 to 3, 3 to 4, and so forth.  For developing this, it would be
good to start with a line representation.  Once this works, you can
then catch the 'simplex' algorithm in the dx.minimise user function,
and then you can develop a special function to reconstruct the simplex
from the parameter vector.  This is not as easy as it seems,
especially identifying this step
<a  rel="nofollow" href="http://home.gna.org/minfx/minfx.simplex-pysrc.html#Simplex.contract">http://home.gna.org/minfx/minfx.simplex-pysrc.html#Simplex.contract</a>.
You will need to know each part of the algorithm and the exact order
of steps (<a  rel="nofollow" href="http://home.gna.org/minfx/minfx.simplex-pysrc.html">http://home.gna.org/minfx/minfx.simplex-pysrc.html</a>).

Note that a majority of function calls by an optimisation algorithm
will not be an optimisation step!  See <a  rel="nofollow" href="http://home.gna.org/minfx/">http://home.gna.org/minfx/</a>.
There are a lot of 'feeler' calls to allow the algorithm to understand
the space it is in, before it actually makes the real step.


5)  The analysis specific API.  To support this idea, you will
probably need to develop some standard methods for accessing the
analysis specific optimisation code and data.  Therefore you will need
to work with the specific API.  This will mean that a
RelaxImplementError will be raised for all analyses which do not
support the API functions yet.  This is a clean way of handling this,
and allows you to develop for only the dispersion analysis, while at
the same time developing a feature that can be used for all other
analyses in relax.  This is how all non-analysis specific features in
relax must be developed.  It's rather simple - you will know exactly
what methods to add when you get to a certain point and realise you
need something.  Then you add a prototype method to
specific_analyses.api_base.  And then add the method to
specific_analyses.relax_disp.api to return the dispersion specific
stuff.


Regards,

Edward

On 11 May 2014 08:43, Troels E. Linnet &lt;NO-REPLY.INVALID-ADDRESS@xxxxxxx&gt; 
wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">URL:
  &lt;<a  rel="nofollow" href="http://gna.org/task/?7794">http://gna.org/task/?7794</a>&gt;

                 Summary: Make dx capture x,y,z positions during 
minimisation
to make a video of minimisation
                 Project: relax
            Submitted by: tlinnet
            Submitted on: Sun 11 May 2014 06:43:07 AM UTC
         Should Start On: Sun 11 May 2014 12:00:00 AM UTC
   Should be Finished on: Mon 11 May 2015 12:00:00 AM UTC
                Category: relax's source code
                Priority: 1 - Later
                  Status: Postponed
        Percent Complete: 0%
             Assigned to: tlinnet
             Open/Closed: Open
         Discussion Lock: Any
                  Effort: 0.00

    _______________________________________________________

Details:

The idea is to make a dx.map with 3 parameters and map the chi isosurfaces.

Then let dx.video function run a minimisation, and capture the the x,y,z
coordinates of the parameters during the minimisation.

This can then be mapped as frames on the the dx map.
And then be turned into a video, showing the movement of the minimisation.

That would be a 3d version of
<a  rel="nofollow" href="http://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method">http://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method</a>
<a  rel="nofollow" href="http://en.wikipedia.org/wiki/File:Nelder_Mead1.gif">http://en.wikipedia.org/wiki/File:Nelder_Mead1.gif</a>

Some ideas to video can come from here
<a  rel="nofollow" href="http://physics.ucsd.edu/students/courses/winter2008/physics141/labnote2/dx_tutorial/DX_tutorial.html">http://physics.ucsd.edu/students/courses/winter2008/physics141/labnote2/dx_tutorial/DX_tutorial.html</a>

<a  rel="nofollow" href="https://www10.cs.fau.de/Teaching/Courses/NuSiF/howto.shtml">https://www10.cs.fau.de/Teaching/Courses/NuSiF/howto.shtml</a>

<a  rel="nofollow" href="http://www.physics.usyd.edu.au/app/complex/sv3/chapter5_2.html">http://www.physics.usyd.edu.au/app/complex/sv3/chapter5_2.html</a>




    _______________________________________________________

Reply to this item at:

  &lt;<a  rel="nofollow" href="http://gna.org/task/?7794">http://gna.org/task/?7794</a>&gt;

_______________________________________________
  Message sent via/by Gna!
  <a  rel="nofollow" href="http://gna.org/">http://gna.org/</a>


_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-devel mailing list
relax-devel@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="http://www.nmr-relax.com/mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a>
</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00300" href="msg00300.html">[task #7794] Make dx capture x, y, z positions during minimisation to make a video of minimisation</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Tue May 13 08:20:14 2014</div>  
</body>
</html>
