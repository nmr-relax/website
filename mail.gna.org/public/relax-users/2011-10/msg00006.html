<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: RelaxError: Negative error for spin, minimization not possible -->
<!--X-From-R13: "H.H." <iibfgevNtznvy.pbz> -->
<!--X-Date: Wed, 05 Oct 2011 22:38:27 +0200 -->
<!--X-Message-Id: CAO2iSXFYKyq3ULESXGn8XMqSjaBcqLuqLg5AwFtPovN5LAjnng@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: CAO2iSXGUNupwuz4s&#45;gNdRAdB3i6zQCsuem2_EFjgHOPq+6SL5g@mail.gmail.com -->
<!--X-Reference: CAED9pY97YPLQ0MjtQ173AwKmN1uhcY=W2=teC=mkrtogpwes4g@mail.gmail.com -->
<!--X-Reference: CAO2iSXES1rKL1zf6OkvJKMn4zqF9ZoGHQhx&#45;jjiT5s5Ldnn5eg@mail.gmail.com -->
<!--X-Reference: CAED9pY988YXFvfV41vG0r9Pv93cD26ZCpCBx7jTDqhkWcUHMeg@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: RelaxError: Negative error for spin, minimization not possible -- October 05, 2011 - 22:38</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: RelaxError: Negative error for spin, minimization not possible</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00006" class="tabs">Index by Date</a> | <a href="threads.html#00006" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00005.html">Date Prev</a>] [<a href="msg00007.html">Date Next</a>] [<a href="msg00005.html">Thread Prev</a>] [<a href="msg00007.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Edward d'Auvergne&quot; &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Wed, 5 Oct 2011 15:37:37 -0500</li>
<li class="menuitem">
<em>Cc</em>: relax-users@xxxxxxx</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;	h=mime-version:in-reply-to:references:from:date:message-id:subject:to	:cc:content-type:content-transfer-encoding;	bh=ldbwqgrJuRPk+1gPnHfcee6MyqbX+l87C3BO6Z6Y7kY=;	b=dN85FX46F1olpITBu00+/XWLDeMFYYCIGbzxdn4DBIYPk9R8BTTPcyKXB+WbAvkgyk	qv/zhy1o6OLL+2sLLGbAkBzdrQvmdEJqCcuu7VVNnnfh/q5aVkFMNvsh552BdUgNHE8H	TYGbPTpYNtWr6232Jt3JTZCKNo+3F677Txb2M=</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00006.html">CAO2iSXFYKyq3ULESXGn8XMqSjaBcqLuqLg5AwFtPovN5LAjnng@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;CAO2iSXGUNupwuz4s-gNdRAdB3i6zQCsuem2_EFjgHOPq+6SL5g@xxxxxxxxxxxxxx&gt;	&lt;CAED9pY97YPLQ0MjtQ173AwKmN1uhcY=W2=teC=mkrtogpwes4g@xxxxxxxxxxxxxx&gt;	&lt;CAO2iSXES1rKL1zf6OkvJKMn4zqF9ZoGHQhx-jjiT5s5Ldnn5eg@xxxxxxxxxxxxxx&gt;	&lt;CAED9pY988YXFvfV41vG0r9Pv93cD26ZCpCBx7jTDqhkWcUHMeg@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>V.V.</strong> on October 05, 2011 - 22:38:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi Edward,

With revision 14802 the script seems to work, provided the
&quot;spin_num_col=4&quot; is removed from &quot;sequence.read&quot; and
&quot;relax_data.read&quot;.

Thank you,
Vitaly


On Wed, Oct 5, 2011 at 11:18, Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

I have just looked at the code, and the recent change I made with the
spin_id was incorrect.  It should now be fixed by r14792.  I'll have a
look at the bug report and try to reproduce the bug now.

Cheers,

Edward



On 5 October 2011 18:07, V.V. &lt;vvostri@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Edward,

Thank you for your comments. The &quot;relax_data.read&quot; actually included
reading the data and errors (so much for copy-pasting). I have updated
the relax version to rev. 14791 and the error message now is
&quot;UnboundLocalError: local variable 'spin_id' referenced before
assignment&quot;.
I have submitted a bug report with an example attached (#18790).

Vitaly

On Wed, Oct 5, 2011 at 04:03, Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt; 
wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Vitaly,

The problem here is not to do with the spin numbering.  That is not
needed.  I've now updated relax to print out the full spin ID string
instead of just the spin number and name.  I've also modified the
error messages to be more informative.  Could you update your
repository copy of relax and send the new error messages?  Thanks.
One problem I see, though this may not be the cause of the error, is
in the reading of the relaxation data.  The script line:

relax_data.read(ri_id='R1_600', ri_type='R1', frq=600.484*1e6,
file='data.r1.600', mol_name_col=1, res_num_col=2, res_name_col=3,
spin_name_col=5)

should probably be:

relax_data.read(ri_id='R1_600', ri_type='R1', frq=600.484*1e6,
file='data.r1.600', mol_name_col=1, res_num_col=2, res_name_col=3,
spin_name_col=5, data_col=6, error_col=7)

Specifying the data and error columns is very important.  Though
according to the code, if the data and error were not read in, then
the checks resulting in the RelaxError should not occur.  The problem
with the spin numbers is that the numbers in 'data.r1.600' do not
match the numbers in the first column of the PDB file.  For proteins,
it is safe to not specify the spin number as all atoms of the residue
should have a different name.  For small organic molecules, RNA, DNA,
sugars, etc, this is not the case.  Anyway, the spin numbers in the
structural file and data files must match if they are used at all.

If you could, submitting a bug report would be appreciated
(<a  rel="nofollow" href="https://gna.org/bugs/?func=additem&amp;group=relax">https://gna.org/bugs/?func=additem&amp;group=relax</a>).  This helps other
relax users if they encounter the same issue.  If you could attach a
minimal script with a minimal data set (relaxation data for one or two
residues, randomised if you prefer), then I'll be able to quickly
reproduce the bug and normally fix it within 5 minutes.  I would then
also be able to add the script and data to the relax test suite to
make sure that the bug never returns.

Cheers,

Edward




On 5 October 2011 01:48, V.V. &lt;vvostri@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hello,

It looks like Relax scripts changed a bit since the last time I used
it. I am trying to setup the initial test calculation with
&quot;single_model.py&quot;, and running into problems with spins initialization
(revision 14778).

Sample input files:
=====
#mol_name res_num res_name spin_num spin_name data error
ave 1 Met 1 N None None
ave 2 Glu 2 N 1.8903 0.06062
...
=====

Script extract is below:
=====
name = 'tm1'
pipe.create(name, 'mf')

sequence.read('data.r1.600', mol_name_col=1, res_num_col=2,
res_name_col=3, spin_name_col=5)
structure.read_pdb('ave.pdb', read_mol=1, set_mol_name='ave', 
parser='internal')
relax_data.read(ri_id='R1_600', ri_type='R1', frq=600.484*1e6,
file='data.r1.600', mol_name_col=1, res_num_col=2, res_name_col=3,
spin_name_col=5)

#More data sets are loaded and other parameters initialized
Grid_search(inc=11)
=====

This returns an error:
&quot;RelaxError: Negative error for spin 'None N', minimization not possible&quot;

Is this because the &quot;spin_number&quot; has not been initialized during the
&quot;sequence.read&quot; and &quot;relax_data.read&quot;? If I try to use
&quot;spin_num_col=4&quot; in &quot;sequence.read&quot;, then &quot;structure.read&quot; returns an
error: &quot;RelaxWarning: Cannot find the atom in the structure (atom ID
':2@2&amp;@N')&quot;

Please let me know if you need more details.

Thank you,
Vitaly

_______________________________________________
relax (<a  rel="nofollow" href="http://nmr-relax.com">http://nmr-relax.com</a>)

This is the relax-users mailing list
relax-users@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-users">https://mail.gna.org/listinfo/relax-users</a>

</pre></blockquote><pre style="margin: 0em;">

</pre></blockquote><pre style="margin: 0em;">

_______________________________________________
relax (<a  rel="nofollow" href="http://nmr-relax.com">http://nmr-relax.com</a>)

This is the relax-users mailing list
relax-users@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-users">https://mail.gna.org/listinfo/relax-users</a>

</pre></blockquote><pre style="margin: 0em;">

</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00007" href="msg00007.html">Re: RelaxError: Negative error for spin, minimization not possible</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00001" href="msg00001.html">RelaxError: Negative error for spin, minimization not possible</a></strong>
<ul><li><em>From:</em> V.V.</li></ul></li>
<li><strong><a name="00003" href="msg00003.html">Re: RelaxError: Negative error for spin, minimization not possible</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00004" href="msg00004.html">Re: RelaxError: Negative error for spin, minimization not possible</a></strong>
<ul><li><em>From:</em> V.V.</li></ul></li>
<li><strong><a name="00005" href="msg00005.html">Re: RelaxError: Negative error for spin, minimization not possible</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Wed Oct 05 23:40:07 2011</div>  
</body>
</html>
