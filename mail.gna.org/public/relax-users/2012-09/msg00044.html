<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: Final model&#45;free run with dauvergne_protocol.py -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Tue, 25 Sep 2012 12:59:24 +0200 -->
<!--X-Message-Id: CAED9pY&#45;WAgJy3qEG&#45;z9bPGKZmVftEuPiRVbB&#45;VOzmy0h3x1ASA@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 5AE3CFD8&#45;BD3F&#45;497E&#45;804C&#45;827DB1C8AF41@iaf.inrs.ca -->
<!--X-Reference: CAED9pY&#45;s5x&#45;uJ1U+t9&#45;PfE4DyF=X&#45;8FL_vZ9+1GurwGb7TRdeg@mail.gmail.com -->
<!--X-Reference: CC4EBC67&#45;DA88&#45;4A35&#45;A882&#45;CFB6DFC4DAF1@iaf.inrs.ca -->
<!--X-Reference: CAED9pY_1COzo5UAhKZMwbJUMyU=+Aedg7TveCyZ9+09ynq9RTQ@mail.gmail.com -->
<!--X-Reference: 618F06209D97594BA025CD1FF49F4E07091B2FEF@piccolo.iaf.inrs.ca -->
<!--X-Reference: CAED9pY&#45;QaHCeMfo+WW7TOa2MS=SLKcqnFrkWCATZ&#45;bC9afPeKQ@mail.gmail.com -->
<!--X-Reference: 6FBD84DA&#45;8EC4&#45;4B88&#45;B4EB&#45;D688F6909059@iaf.inrs.ca -->
<!--X-Reference: CAED9pY9FrmoGyrLzAtit4RjG+W5BWbCpcEry&#45;Ptp+kC&#45;Gj0FJg@mail.gmail.com -->
<!--X-Reference: A2B572B3&#45;9F10&#45;4152&#45;850B&#45;ACAE75AA99B2@iaf.inrs.ca -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Final model-free run with dauvergne_protocol.py -- September 25, 2012 - 12:59</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Final model-free run with dauvergne_protocol.py</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00044" class="tabs">Index by Date</a> | <a href="threads.html#00044" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00043.html">Date Prev</a>] [<a href="msg00045.html">Date Next</a>] [<a href="msg00043.html">Thread Prev</a>] [<a href="msg00030.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Nicolas Doucet &lt;Nicolas.Doucet@xxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Tue, 25 Sep 2012 12:58:54 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-users@xxxxxxx&quot; &lt;relax-users@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113;	h=mime-version:sender:in-reply-to:references:date	:x-google-sender-auth:message-id:subject:from:to:cc:content-type;	bh=9FOkt9cDywiqD4AJ/VWmJxU51PWCdal6RsH31peneVU=;	b=JrW3QWrt/8Id6su9OLgOOASakXmq+Q9wse2cF3SwIWyGxIhbKfZ0AaXoOsnZl+/pDX	3iTKihN9amHnVAb9g4WphdQklO9NF739IUs1wHoROKEIiMlIXaPwg5woHolutkfUt7a1	qE+Y8CUc1uvHjq201hRf6miEUvuOb9yGY5HaC+f0GbOMAe3lQ/Eisixcq9SU9cBQvva7	5msEwK7YLFSVxcEfRw4yYPBxzbrUDec7J8LNT7NEAjNNBn2xRTz2Vzjd0N+PQ0Yv4sy4	vz1TG+Hyd8k1l45JI2GN5EWBNYCU688VuMIODhgSXDSd9PXQ+KHOUW4QJPS1O6Pzn1X7	5y6A==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00044.html">CAED9pY-WAgJy3qEG-z9bPGKZmVftEuPiRVbB-VOzmy0h3x1ASA@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;5AE3CFD8-BD3F-497E-804C-827DB1C8AF41@xxxxxxxxxxx&gt;	&lt;CAED9pY-s5x-uJ1U+t9-PfE4DyF=X-8FL_vZ9+1GurwGb7TRdeg@xxxxxxxxxxxxxx&gt;	&lt;CC4EBC67-DA88-4A35-A882-CFB6DFC4DAF1@xxxxxxxxxxx&gt;	&lt;CAED9pY_1COzo5UAhKZMwbJUMyU=+Aedg7TveCyZ9+09ynq9RTQ@xxxxxxxxxxxxxx&gt;	&lt;618F06209D97594BA025CD1FF49F4E07091B2FEF@xxxxxxxxxxxxxxxxxxx&gt;	&lt;CAED9pY-QaHCeMfo+WW7TOa2MS=SLKcqnFrkWCATZ-bC9afPeKQ@xxxxxxxxxxxxxx&gt;	&lt;6FBD84DA-8EC4-4B88-B4EB-D688F6909059@xxxxxxxxxxx&gt;	&lt;CAED9pY9FrmoGyrLzAtit4RjG+W5BWbCpcEry-Ptp+kC-Gj0FJg@xxxxxxxxxxxxxx&gt;	&lt;A2B572B3-9F10-4152-850B-ACAE75AA99B2@xxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on September 25, 2012 - 12:59:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi Nick,

I'll respond below:

</pre><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">Do you know why only 2 iterations for each diffusion tensor was completed?
</pre></blockquote><pre style="margin: 0em;">


I was kind of hoping you could suggest a few possibilities for such an
issue. I'm having a hard time figuring out why.
</pre></blockquote><pre style="margin: 0em;">

This may or may not be a problem.  It could be that the structure is
so well defined (well the NH backbone vector orientations at least)
and the combined dynamic parameter and model spaces are simple enought
that the algorithm converges incredibly quickly.  relax is designed to
produce an huge quantity of messages for the sole purpose of being
able to understand what is happening.

Instead of being a blackbox like the other model-free programs, you
can carefully go through the relax logs and see exactly what has
happened at each step - relax hides nothing from you.  To understand,
It is good to know the protocol that is being used.  My 2007 and 2008b
papers, PhD thesis on Amazon or a free PDF at
<a  rel="nofollow" href="http://www.nmr-relax.com/refs.html#dAuvergne06">http://www.nmr-relax.com/refs.html#dAuvergne06</a>, and/or the model-free
chapter of the relax user manual (specifically the current figure 8.3)
are all useful for understanding what is happening.  Then after
carefully checking the logs can you be certain of your result.

You can also look at the results from each of the diffusion models.
The final results for each are preserved at the end of the model-free
analysis.  You just have to use the data pipe editor window to switch
to the different data pipes for each diffusion model and then use the
'User function' menu system to visualise and output the results.

Another validation would be to run your data through the consistency
testing analysis added to relax by Sebastien Morin.  See that chapter
of the user manual for more details
(<a  rel="nofollow" href="http://www.nmr-relax.com/manual/Consistency_testing.html">http://www.nmr-relax.com/manual/Consistency_testing.html</a>).  This will
tell you if you have inconsistencies in your R2 data.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">To rule out a possible PDB problem, I wanted to try the same calculations
with another PDB. The first PDB we used is an NMR structure of the protein,
which includes the HN protons (all labeled H). It got loaded appropriately
by relax. However, whenever I try a crystal structure PDB to which protons
are added (e.g. with PyMOL or DSVisualizer), relax spits out errors.

Example:

I added protons to a crystal structure PDB and the file looks something like
this:

...
ATOM    218  N   ALA A  12      60.379   7.496  -2.579  1.00 21.96
</pre></blockquote><pre style="margin: 0em;">[snip]
</pre><blockquote class="blockquote"><pre style="margin: 0em;">ATOM    223  HN  ALA A  12      60.890   6.559  -2.506  1.00 24.77
</pre></blockquote><pre style="margin: 0em;">[snip]
</pre><blockquote class="blockquote"><pre style="margin: 0em;">...

Evidently, relax doesn't recognize 'HN' as the proton spin. I tried changing
the spin_id='@HN' in the dauvergne script but it doesn't work.
</pre></blockquote><pre style="margin: 0em;">

In relax, nothing is assumed!  You can call your proton spins
'Puff_the_magic_dragon' and relax will accept that (whitespace and the
characters '#', '@', and ':&quot; are the only problems).  Then again, the
PDB format itself might constrain you a bit so if you are using a PDB
file, you will have to shorten it to 'PUFF' or 'PTMD'.  In reality,
relax has no special atom naming translation tables (maybe in the
future this could be added if it doesn't break things for the RNA/DNA,
sugar, and organic molecule people).  So when using a PDB file, you
are constrained by the convention used in that file.  You do have one
option though, you can load all the 'HN' spins and then rename them
with the commands:

structure.load_spins('@HN')
spin.name(name='Puff_the_magic_dragon', spin_id='@HN', force=True)

Then you should be able to subsequently set up your
'Puff_the_magic_dragon' protons as the source of your dipole-dipole
relaxation.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">I also tried
replacing all 'HN' by 'H' in the PDB but I get the following error:
</pre></blockquote><pre style="margin: 0em;">[snip]
</pre><blockquote class="blockquote"><pre style="margin: 0em;">relax&gt; structure.read_pdb(file='test.pdb', dir=None, read_mol=None,
set_mol_name=None, read_model=None, set_model_num=None, parser='internal')

Internal relax PDB parser.
Opening the file 'test.pdb' for reading.
Traceback (most recent call last):
  File &quot;/usr/local/relax-2.1.0/multi/processor.py&quot;, line 479, in run
    self.callback.init_master(self)
  File &quot;/usr/local/relax-2.1.0/multi/__init__.py&quot;, line 318, in
default_init_master
    self.master.run()
  File &quot;/usr/local/relax-2.1.0/relax.py&quot;, line 182, in run
    self.interpreter.run(self.script_file)
  File &quot;/usr/local/relax-2.1.0/prompt/interpreter.py&quot;, line 279, in run
    return run_script(intro=self.__intro_string, local=locals(),
script_file=script_file, quit=self.__quit_flag,
show_script=self.__show_script, raise_relax_error=self.__raise_relax_error)
  File &quot;/usr/local/relax-2.1.0/prompt/interpreter.py&quot;, line 569, in
run_script
    return console.interact(intro, local, script_file, quit,
show_script=show_script, raise_relax_error=raise_relax_error)
  File &quot;/usr/local/relax-2.1.0/prompt/interpreter.py&quot;, line 454, in
interact_script
    exec_script(script_file, local)
  File &quot;/usr/local/relax-2.1.0/prompt/interpreter.py&quot;, line 328, in
exec_script
    runpy.run_module(module, globals)
  File &quot;/usr/lib/python2.7/runpy.py&quot;, line 180, in run_module
    fname, loader, pkg_name)
  File &quot;/usr/lib/python2.7/runpy.py&quot;, line 72, in _run_code
    exec code in run_globals
  File
&quot;/home/dgagne/nmrdata5/DG12-116_15SEP2012_ModelFree_Analysis_of_ECP_Free_Form/dauvergne_protocol/dauvergne_protocol.py&quot;,
line 184, in &lt;module&gt;
    structure.read_pdb('test.pdb')
  File &quot;/usr/local/relax-2.1.0/prompt/uf_objects.py&quot;, line 219, in __call__
    self._backend(*new_args, **uf_kargs)
  File &quot;/usr/local/relax-2.1.0/generic_fns/structure/main.py&quot;, line 505, in
read_pdb
    cdp.structure.load_pdb(file_path, read_mol=read_mol,
set_mol_name=set_mol_name, read_model=read_model,
set_model_num=set_model_num, verbosity=verbosity)
  File &quot;/usr/local/relax-2.1.0/generic_fns/structure/internal.py&quot;, line
1090, in load_pdb
    mol.fill_object_from_pdb(mol_records)
  File &quot;/usr/local/relax-2.1.0/generic_fns/structure/internal.py&quot;, line
2096, in fill_object_from_pdb
    record = self._parse_pdb_record(record)
  File &quot;/usr/local/relax-2.1.0/generic_fns/structure/internal.py&quot;, line
1932, in _parse_pdb_record
    fields[11] = float(fields[11])
ValueError: invalid literal for float(): 1.00 5
---------------------------------------------------------------------------
</pre></blockquote><pre style="margin: 0em;">

This it the classic message from the relax internal PDB reader for a
corrupted PDB file.  I should one day modify the parser to catch
character shifts in the PDB file, as this is a commonly encountered
problem.  The issue is that in the PDB, the columns are defined by
absolute character position
(<a  rel="nofollow" href="http://www.nmr-relax.com/api/generic_fns.structure.internal.MolContainer-class.html#_parse_pdb_record">http://www.nmr-relax.com/api/generic_fns.structure.internal.MolContainer-class.html#_parse_pdb_record</a>).
 You would need to replace 'HN' with ' N' rather than 'N'.  Note the
single space in front of the 'N' here, this is needed to preserve the
rigid position based column definitions.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">I tried several different PDBs of the protein and I always run into similar
'PDB parser' errors. How do you typically prepare your PDBs to make sure
they are properly loaded by relax?
</pre></blockquote><pre style="margin: 0em;">

For this you can use the PDB validation server at
<a  rel="nofollow" href="http://deposit.rcsb.org/validate/">http://deposit.rcsb.org/validate/</a>.  If it passes there, then relax
will be able to handle it.  The more difficult part will be then to
match your PDB spins to that in your other data files loaded into
relax, but for protons which are only used in the definition of the
magnetic dipole-dipole interaction, this should be no issue.

Regards,

Edward


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00028" href="msg00028.html">Final model-free run with dauvergne_protocol.py</a></strong>
<ul><li><em>From:</em> Nicolas Doucet</li></ul></li>
<li><strong><a name="00032" href="msg00032.html">Re: Final model-free run with dauvergne_protocol.py</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00036" href="msg00036.html">Re: Final model-free run with dauvergne_protocol.py</a></strong>
<ul><li><em>From:</em> Nicolas Doucet</li></ul></li>
<li><strong><a name="00037" href="msg00037.html">Re: Final model-free run with dauvergne_protocol.py</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00039" href="msg00039.html">RE: Final model-free run with dauvergne_protocol.py</a></strong>
<ul><li><em>From:</em> Doucet, Nicolas</li></ul></li>
<li><strong><a name="00040" href="msg00040.html">Re: Final model-free run with dauvergne_protocol.py</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00041" href="msg00041.html">Re: Final model-free run with dauvergne_protocol.py</a></strong>
<ul><li><em>From:</em> Nicolas Doucet</li></ul></li>
<li><strong><a name="00042" href="msg00042.html">Re: Final model-free run with dauvergne_protocol.py</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00043" href="msg00043.html">Re: Final model-free run with dauvergne_protocol.py</a></strong>
<ul><li><em>From:</em> Nicolas Doucet</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu Sep 27 16:20:10 2012</div>  
</body>
</html>
