<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: r22906 &#45; in /trunk/test_suite/shared_data/dispersion/Baldwin_2014: ./ Baldwin.py test.out test_w_error.out -->
<!--X-From-R13: "Sqjneq q'Ohiretar" &#60;rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Fri, 02 May 2014 09:30:49 +0200 -->
<!--X-Message-Id: CAED9pY89vUX3iq=mYwxQhuak&#45;4XcxQTziRn9OGzFbpeddV3RsA@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: E1WfmeW&#45;0000Ym&#45;97@subversion.gna.org -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: r22906 - in /trunk/test_suite/shared_data/dispersion/Baldwin_2014: ./ Baldwin.py test.out test_w_error.out -- May 02, 2014 - 09:30</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: r22906 - in /trunk/test_suite/shared_data/dispersion/Baldwin_2014: ./ Baldwin.py test.out test_w_error.out</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00018" class="tabs">Index by Date</a> | <a href="threads.html#00018" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00017.html">Date Prev</a>] [<a href="msg00019.html">Date Next</a>] [<a href="msg00017.html">Thread Prev</a>] [<a href="msg00048.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Fri, 2 May 2014 09:29:59 +0200</li>
<li class="menuitem">
<em>Cc</em>: Andrew Baldwin &lt;andrew.baldwin@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113; h=mime-version:sender:in-reply-to:references:date:message-id:subject :from:to:cc:content-type; bh=N4kWnzURUP78UxVSfrjLxykZ4cGsTOFBq4oi4l9620A=; b=tSyFU6zus+eg/aI0zTnR4XlKM8bd/ClyciyUTTaSTTYudWkaD9k7Rw16rcNR6wSxcj dLtTSbPJUc5ZnZPycjWTPvZ3YPt5qmg8M7kyXLLovPge4OcmK5KXOxp7fTa6pi31pPHP eV4G39IkvC0QDXU4x/ga1x1wHSHq1r0xdDTzlec1sV3DFEENxxqLuOn4IFm2OAkwVZ5R nAavQRLAoaB3HJqrulemj41gi/q5ViqT0MnXyJrl9Pwj93VNT+Dn/4E9ix66fTqobHL5 sHqKoWl4Wgcy8Dq9MiIxZnQvy/TyqH0tFaM07HehsAWdfSXltVrgyE3JWkmOL2j8DEWV Mx0w==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;CAED9pY89vUX3iq=mYwxQhuak-4XcxQTziRn9OGzFbpeddV3RsA@mail.gmail.com&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;E1WfmeW-0000Ym-97@subversion.gna.org&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on May 02, 2014 - 09:30:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi Troels,

For Andy's script at
test_suite/shared_data/dispersion/Baldwin_2014/Baldwin.py, we should
add the GPL3+ copyright notice as follows:

###############################################################################
#                                                                             
#
# Copyright (C) 2014 Andrew Baldwin (andrew.baldwin@xxxxxxxxxxxxx)            
#
#                                                                             
#
# This file is part of the program relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>).          
#
#                                                                             
#
# This program is free software: you can redistribute it and/or modify        
#
# it under the terms of the GNU General Public License as published by        
#
# the Free Software Foundation, either version 3 of the License, or           
#
# (at your option) any later version.                                         
#
#                                                                             
#
# This program is distributed in the hope that it will be useful,             
#
# but WITHOUT ANY WARRANTY; without even the implied warranty of              
#
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the               
#
# GNU General Public License for more details.                                
#
#                                                                             
#
# You should have received a copy of the GNU General Public License           
#
# along with this program.  If not, see &lt;<a  rel="nofollow" href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>&gt;.       
#
#                                                                             
#
###############################################################################

This is a simple legal formality needed to allow the script to be
bundled with relax.  This would start from the second line of the
script.  It would replace the text:

# Do not distribute without permission.
# Copyright (c)
# Andrew Baldwin
# andrew.baldwin@xxxxxxxxxxxxx
# University of Oxford 2014.

Andy, should we also include the &quot;University of Oxford&quot; text?

Cheers,

Edward


On 1 May 2014 10:47,  &lt;tlinnet@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Author: tlinnet
Date: Thu May  1 10:47:35 2014
New Revision: 22906

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=22906&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=22906&amp;view=rev</a>
Log:
Added Baldwin model B14 test data.

sr #3154: (<a  rel="nofollow" href="https://gna.org/support/?3154">https://gna.org/support/?3154</a>) Implementation of Baldwin (2014) 
B14 model - 2-site exact solution model for all time scales.

Added:
    trunk/test_suite/shared_data/dispersion/Baldwin_2014/
    trunk/test_suite/shared_data/dispersion/Baldwin_2014/Baldwin.py
    trunk/test_suite/shared_data/dispersion/Baldwin_2014/test.out
    trunk/test_suite/shared_data/dispersion/Baldwin_2014/test_w_error.out

Added: trunk/test_suite/shared_data/dispersion/Baldwin_2014/Baldwin.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/test_suite/shared_data/dispersion/Baldwin_2014/Baldwin.py?rev=22906&amp;view=auto">http://svn.gna.org/viewcvs/relax/trunk/test_suite/shared_data/dispersion/Baldwin_2014/Baldwin.py?rev=22906&amp;view=auto</a>
==============================================================================
--- trunk/test_suite/shared_data/dispersion/Baldwin_2014/Baldwin.py     
(added)
+++ trunk/test_suite/shared_data/dispersion/Baldwin_2014/Baldwin.py     Thu 
May  1 10:47:35 2014
@@ -0,0 +1,85 @@
+#!/usr/bin/python
+######################################################################
+# Script to simulate R2eff from a CPMG experiment
+#
+# Note assumption of only inphase magnetisation and 2 site exchange
+# only.
+#
+# Requires numpy.
+#
+#
+# Do not distribute without permission.
+# Copyright (c)
+# Andrew Baldwin
+# andrew.baldwin@xxxxxxxxxxxxx
+# University of Oxford 2014.
+#
+
+import numpy
+from math import cos,sin,atan2
+
+############################################################################
+#Note dw is in rad s-1.
+def BaldDisp(kex,pb,dw,ncyc,Trel,R2g,R2e,outfile):
+    pa=(1-pb)
+    keg=kex*(1-pb)
+    kge=kex*pb
+    deltaR2=R2e-R2g
+    nu_cpmg=ncyc/Trel
+    tcp=Trel/(4.0*ncyc)  #time for one free precession element
+    
#########################################################################
+    #get the real and imaginary components of the exchange induced shift
+    g1=2*dw*(deltaR2+keg-kge)                   #same as carver richards 
zeta
+    g2=(deltaR2+keg-kge)**2.0+4*keg*kge-dw**2   #same as carver richards 
psi
+    g3=cos(0.5*atan2(g1,g2))*(g1**2.0+g2**2.0)**(1/4.0)   #trig faster 
than square roots
+    g4=sin(0.5*atan2(g1,g2))*(g1**2.0+g2**2.0)**(1/4.0)   #trig faster 
than square roots
+    
#########################################################################
+    #time independent factors
+    N=complex(kge+g3-kge,g4)            #N=oG+oE
+    NNc=(g3**2.+g4**2.)
+    f0=(dw**2.+g3**2.)/(NNc)              #f0
+    f2=(dw**2.-g4**2.)/(NNc)              #f2
+    #t1=(-dw+g4)*(complex(-dw,-g3))/(NNc) #t1
+    t2=(dw+g4)*(complex(dw,-g3))/(NNc) #t2
+    t1pt2=complex(2*dw**2.,-g1)/(NNc)     #t1+t2
+    oGt2=complex((deltaR2+keg-kge-g3),(dw-g4))*t2  #-2*oG*t2
+    Rpre=(R2g+R2e+kex)/2.0   #-1/Trel*log(LpreDyn)
+    E0= 2.0*tcp*g3  #derived from relaxation       #E0=-2.0*tcp*(f00R-f11R)
+    E2= 2.0*tcp*g4  #derived from chemical shifts  
#E2=complex(0,-2.0*tcp*(f00I-f11I))
+    E1=(complex(g3,-g4))*tcp    #mixed term (complex) (E0-iE2)/2
+    ex0b=(f0*numpy.cosh(E0)-f2*numpy.cos(E2))               #real
+    ex0c=(f0*numpy.sinh(E0)-f2*numpy.sin(E2)*complex(0,1.)) #complex
+    ex1c=(numpy.sinh(E1))                                   #complex
+    v3=numpy.sqrt(ex0b**2.-1)  #exact result for v2v3
+    y=numpy.power((ex0b-v3)/(ex0b+v3),ncyc)
+    v2pPdN=(( complex(deltaR2+kex,dw) )*ex0c+(-oGt2-kge*t1pt2)*2*ex1c)     
   #off diagonal common factor. sinh fuctions
+    Tog=(((1+y)/2+(1-y)/(2*v3)*(v2pPdN)/N))
+    
Minty=Rpre-ncyc/(Trel)*numpy.arccosh((ex0b).real)-1/Trel*numpy.log((Tog.real))
  #estimate R2eff
+
+    array=[]
+    for i in range(len(ncyc)):
+        array.append((nu_cpmg[i],Minty[i]))
+    if(outfile!='Null'):
+        outy=open(outfile,'w')
+        for i in range(len(array)):
+            outy.write('%f\t%f\n' % (array[i][0],array[i][1]))
+        outy.close()
+    return array
+
+
+def ppm_to_rads(ppm,dfrq):
+    return ppm*2*numpy.pi*dfrq
+
+
+if __name__ == &quot;__main__&quot;:  #run this if this file is run as standalone
+    #otherwise use the function form your own code.
+    outfile='test.out'  #set to 'Null' if output is not required
+    kex=1000.  #exchange rate = k+ + k- (s-1)
+    pb=0.01    #fractional population of excited state k+/kex
+    dw_ppm=2.  #deltaOmega in ppm
+    dfrq=200.  #spectrometer frequency of nucleci (MHz)
+    ncyc=numpy.array((2,4,8,10,20,40,500,)) #number of cpmg cycles (1 
cycle = delay/180/delay/delay/180/delay)
+    R2g=2.     #relaxation rate of ground (s-1)
+    R2e=100.   #relaxation rate of excited (s-1)
+    Trelax=0.04 #total time of CPMG block
+    BaldDisp(kex,pb,ppm_to_rads(dw_ppm,dfrq),ncyc,Trelax,R2g,R2e,outfile)

Added: trunk/test_suite/shared_data/dispersion/Baldwin_2014/test.out
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/test_suite/shared_data/dispersion/Baldwin_2014/test.out?rev=22906&amp;view=auto">http://svn.gna.org/viewcvs/relax/trunk/test_suite/shared_data/dispersion/Baldwin_2014/test.out?rev=22906&amp;view=auto</a>
==============================================================================
--- trunk/test_suite/shared_data/dispersion/Baldwin_2014/test.out       
(added)
+++ trunk/test_suite/shared_data/dispersion/Baldwin_2014/test.out       Thu 
May  1 10:47:35 2014
@@ -0,0 +1,7 @@
+50.000000      10.286255
+100.000000     10.073083
+200.000000     9.692746
+250.000000     9.382441
+500.000000     6.312396
+1000.000000    3.957029
+12500.000000   2.880420

Added: trunk/test_suite/shared_data/dispersion/Baldwin_2014/test_w_error.out
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/test_suite/shared_data/dispersion/Baldwin_2014/test_w_error.out?rev=22906&amp;view=auto">http://svn.gna.org/viewcvs/relax/trunk/test_suite/shared_data/dispersion/Baldwin_2014/test_w_error.out?rev=22906&amp;view=auto</a>
==============================================================================
--- trunk/test_suite/shared_data/dispersion/Baldwin_2014/test_w_error.out   
    (added)
+++ trunk/test_suite/shared_data/dispersion/Baldwin_2014/test_w_error.out   
    Thu May  1 10:47:35 2014
@@ -0,0 +1,7 @@
+50.000000      10.286255 1.0
+100.000000     10.073083 1.0
+200.000000     9.692746 1.0
+250.000000     9.382441 1.0
+500.000000     6.312396 1.0
+1000.000000    3.957029 1.0
+12500.000000   2.880420 1.0


_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-commits mailing list
relax-commits@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-commits">https://mail.gna.org/listinfo/relax-commits</a>
</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00048" href="msg00048.html">Re: r22906 - in /trunk/test_suite/shared_data/dispersion/Baldwin_2014: ./ Baldwin.py test.out test_w_error.out</a></strong>
<ul><li><em>From:</em> Andrew Baldwin</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Fri May 02 14:40:08 2014</div>  
</body>
</html>
