<!-- MHonArc v2.6.16 -->
<!--X-Subject: r22247 &#45; in /trunk: lib/io.py	specific_analyses/relax_disp/disp_data.py -->
<!--X-From-R13: rqjneqNaze&#45;erynk.pbz -->
<!--X-Date: Fri, 21 Feb 2014 20:25:29 +0100 -->
<!--X-Message-Id: E1WGviy&#45;0000kZ&#45;RE@subversion.gna.org -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>r22247 - in /trunk: lib/io.py	specific_analyses/relax_disp/disp_data.py -- February 21, 2014 - 20:25</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />r22247 - in /trunk: lib/io.py	specific_analyses/relax_disp/disp_data.py</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00139" class="tabs">Index by Date</a> | <a href="threads.html#00139" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00138.html">Date Prev</a>] [<a href="msg00140.html">Date Next</a>] [<a href="msg00138.html">Thread Prev</a>] [<a href="msg00140.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: relax-commits@xxxxxxx</li>
<li class="menuitem">
<em>Date</em>: Fri, 21 Feb 2014 19:25:28 -0000</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00139.html">E1WGviy-0000kZ-RE@subversion.gna.org</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>edward</strong> on February 21, 2014 - 20:25:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Author: bugman
Date: Fri Feb 21 20:25:28 2014
New Revision: 22247

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=22247&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=22247&amp;view=rev</a>
Log:
Fix for bug #21704, the failure of the GUI analyses when the home directory 
'~' character is used.

The bug is located at <a  rel="nofollow" href="https://gna.org/bugs/?21704">https://gna.org/bugs/?21704</a>.

The problem is located in many parts of the program, and other problematic 
areas may still be
present.  In all cases where the directory or file is accessed, the 
os.path.expanduser() function
must be called.


Modified:
    trunk/lib/io.py
    trunk/specific_analyses/relax_disp/disp_data.py

Modified: trunk/lib/io.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/lib/io.py?rev=22247&amp;r1=22246&amp;r2=22247&amp;view=diff">http://svn.gna.org/viewcvs/relax/trunk/lib/io.py?rev=22247&amp;r1=22246&amp;r2=22247&amp;view=diff</a>
==============================================================================
--- trunk/lib/io.py (original)
+++ trunk/lib/io.py Fri Feb 21 20:25:28 2014
@@ -1,7 +1,7 @@
 from __future__ import absolute_import
 
###############################################################################
 #                                                                            
 #
-# Copyright (C) 2003-2013 Edward d'Auvergne                                  
 #
+# Copyright (C) 2003-2014 Edward d'Auvergne                                  
 #
 #                                                                            
 #
 # This file is part of the program relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>).         
 #
 #                                                                            
 #
@@ -308,6 +308,9 @@
     # No directory given.
     if dir == None:
         return
+
+    # Expand any ~ characters.
+    dir = expanduser(dir)
 
     # Make the directory.
     try:

Modified: trunk/specific_analyses/relax_disp/disp_data.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/specific_analyses/relax_disp/disp_data.py?rev=22247&amp;r1=22246&amp;r2=22247&amp;view=diff">http://svn.gna.org/viewcvs/relax/trunk/specific_analyses/relax_disp/disp_data.py?rev=22247&amp;r1=22246&amp;r2=22247&amp;view=diff</a>
==============================================================================
--- trunk/specific_analyses/relax_disp/disp_data.py (original)
+++ trunk/specific_analyses/relax_disp/disp_data.py Fri Feb 21 20:25:28 2014
@@ -53,6 +53,7 @@
 # Python module imports.
 from math import atan, floor, pi, sqrt
 from numpy import array, float64, int32, ones, zeros
+from os.path import expanduser
 from random import gauss
 from re import search
 import sys
@@ -1802,11 +1803,13 @@
     # Write the file.
     script_grace2images(file=file)
 
-    # Close the batch script, then make it executable.
+    # Close the batch script, then make it executable (expanding any ~ 
characters).
     file.close()
     if dir:
+        dir = expanduser(dir)
         chmod(dir + sep + file_name, S_IRWXU|S_IRGRP|S_IROTH)
     else:
+        file_name = expanduser(file_name)
         chmod(file_name, S_IRWXU|S_IRGRP|S_IROTH)
 
 



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Fri Feb 21 20:40:02 2014</div>  
</body>
</html>
