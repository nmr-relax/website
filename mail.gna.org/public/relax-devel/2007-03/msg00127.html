<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: Vote for the design of the relax data storage object singleton. -->
<!--X-From-R13: Quevf [npDnvyq <p.n.znpenvyqNyrrqf.np.hx> -->
<!--X-Date: Mon, 26 Mar 2007 11:13:28 +0200 -->
<!--X-Message-Id: 1174900364.16998.13.camel@mrspell -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 7f080ed10703140609p70d35295ye10ee5939da494a2@mail.gmail.com -->
<!--X-Reference: 1173971938.8066.377.camel@mrspell -->
<!--X-Reference: 7f080ed10703150921g7469b0d6ia5506c3c47c537c8@mail.gmail.com -->
<!--X-Reference: 45F98244.4080902@bmb.leeds.ac.uk -->
<!--X-Reference: 7f080ed10703161827h7ff085ffu8ccdcdc232db3241@mail.gmail.com -->
<!--X-Reference: 1174502990.8066.478.camel@mrspell -->
<!--X-Reference: 7f080ed10703212109pdaf2a1dge7bbe7ac1a2292e6@mail.gmail.com -->
<!--X-Reference: 1174563577.8066.531.camel@mrspell -->
<!--X-Reference: 1174622351.29465.5.camel@pc172&#45;31&#45;2&#45;63.biochem.unimelb.edu.au -->
<!--X-Reference: 1174643503.8066.571.camel@mrspell -->
<!--X-Reference: 7f080ed10703252153o73d66d9eya521ef735dd960b8@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Vote for the design of the relax data storage object singleton. -- March 26, 2007 - 11:13</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Vote for the design of the relax data storage object singleton.</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00127" class="tabs">Index by Date</a> | <a href="threads.html#00127" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00126.html">Date Prev</a>] [<a href="msg00128.html">Date Next</a>] [<a href="msg00125.html">Thread Prev</a>] [<a href="msg00047.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Mon, 26 Mar 2007 10:12:44 +0100</li>
<li class="menuitem">
<em>Cc</em>: &quot;Gary S. Thompson&quot; &lt;garyt@xxxxxxxxxxxxxxx&gt;, relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00127.html">1174900364.16998.13.camel@mrspell</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;<a href="msg00046.html">7f080ed10703140609p70d35295ye10ee5939da494a2@mail.gmail.com</a>&gt;	&lt;<a href="msg00066.html">1173971938.8066.377.camel@mrspell</a>&gt;	&lt;<a href="msg00068.html">7f080ed10703150921g7469b0d6ia5506c3c47c537c8@mail.gmail.com</a>&gt;	&lt;<a href="msg00070.html">45F98244.4080902@bmb.leeds.ac.uk</a>&gt;	&lt;<a href="msg00077.html">7f080ed10703161827h7ff085ffu8ccdcdc232db3241@mail.gmail.com</a>&gt;	&lt;<a href="msg00117.html">1174502990.8066.478.camel@mrspell</a>&gt;	&lt;<a href="msg00119.html">7f080ed10703212109pdaf2a1dge7bbe7ac1a2292e6@mail.gmail.com</a>&gt;	&lt;<a href="msg00120.html">1174563577.8066.531.camel@mrspell</a>&gt;	&lt;<a href="msg00122.html">1174622351.29465.5.camel@pc172-31-2-63.biochem.unimelb.edu.au</a>&gt;	&lt;<a href="msg00123.html">1174643503.8066.571.camel@mrspell</a>&gt;	&lt;<a href="msg00125.html">7f080ed10703252153o73d66d9eya521ef735dd960b8@mail.gmail.com</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Chris MacRaild</strong> on March 26, 2007 - 11:13:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">On Mon, 2007-03-26 at 14:53 +1000, Edward d'Auvergne wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">On 3/23/07, Chris MacRaild &lt;c.a.macraild@xxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">On Fri, 2007-03-23 at 14:59 +1100, Edward d'Auvergne wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">If the base class cannot be a singleton due to the derived class objects
being instances of it, then how can the three different values of 'x'
below be explained?
</pre></blockquote><pre style="margin: 0em;">

Please state specifically what conflict you see between these two ideas,
because, as I've said several times already, I can see none.
</pre></blockquote><pre style="margin: 0em;">

The singleton is a single distinct object within the program which can
only exist once.  Any subsequent attempts to instantiate the class
returns the reference (or pointer in C speak) to that object.  The
example below demonstrates three distinct objects (all values of the
variable 'x' are different).  Whether or not there has been
inheritance between the classes is inconsequential.  Whether or not
you use the word 'instance' it is the three distinct objects that make
the three distinct singletons.  Trying to instantiate the three again
just returns the references and hence the three different values of
'x' exist in the new references.   A singleton is an object and there
is only one of it.

</pre></blockquote><pre style="margin: 0em;">

No. A singleton is a class that can only ever have one instance.

By your definition, all objects are singletons, because there is only
ever one of any object.

</pre><blockquote class="blockquote"><pre style="margin: 0em;">

</pre><blockquote class="blockquote"><pre style="margin: 0em;">

</pre><blockquote class="blockquote"><pre style="margin: 0em;">


$ python
Python 2.4.1 (#2, Oct  6 2006, 15:14:48)
[GCC 4.0.1 (4.0.1-5mdk for Mandriva Linux release 2006.0)] on linux2
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">from Queue import Queue

class ThreadQueue(Queue, object):
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">...     instances = {}
...     def __new__(cls, *args, **kargs):
...         if ThreadQueue.instances.get(cls) is None:
...             ThreadQueue.instances[cls] = object.__new__(cls, *args,
**kargs)
...         return ThreadQueue.instances[cls]
...
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">class ResultsQueue(ThreadQueue):
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">...     mf_results = {}
...
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">class OptimisationQueue(ThreadQueue):
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">...     min_instances = []
...
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">

# Create the three singletons.
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">... thread_queue = ThreadQueue()
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">results_queue = ResultsQueue()
opt_queue = OptimisationQueue()

# Show that the singletons have different locations in memory - i.e.
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">are different instances.
... print id(thread_queue)
1077833228
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">print id(results_queue)
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">1077867628
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">print id(opt_queue)
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">1077881612
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">

# Add objects to the singletons.
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">... thread_queue.x = 1
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">results_queue.x = 2
opt_queue.x = 3

# Print the objects of the singletons.
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">... print thread_queue.x
1
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">print results_queue.x
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">2
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">print opt_queue.x
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">3
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">

</pre></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">

So, at this point we have three classes: ThreadQueue, ResultsQueue and
OptimisationQueue. We have three objects, which are class instances:
thread_queue, results_queue and opt_queue. We are in full agreement that
these are three different objects, so there is no suprise that you can
create an attribute of the same name in each object, and bind that
attribute to different values. Attributes of different objects are
themselves different objects, and there is no common namespace, so all
three attributes can have the same name without conflict. All of this
has nothing to do with the fact that results_queue has instancehood
relationships both with ResultsQueue and with ThreadQueue, and opt_queue
has has instancehood relationships both with ResultsQueue and with
OptimisationQueue.
</pre></blockquote><pre style="margin: 0em;">

The 'instancehood relationships' have nothing to do with the three
singletons - i.e. the three distinct objects which can exist only in
one copy.  I don't believe an object to be instances of its base
classes but rather the base classes are searched recursively for
attributes if the attribute isn't in the derived class (it's a scope
thing).  But even if it is, the example still demonstrates inheritance
together with 3 different objects which only ever exist once in the
program.  This shows that both the two classes and their base class
(which defines the singleton and queuing behaviour) are three distinct
singletons.

</pre></blockquote><pre style="margin: 0em;">

'instancehood relationships' are central to the definition of the
singleton design pattern. Again, a singleton is a class with only ever
one instance. Your ThreadQueue is not a singleton because:

</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">isinstance(thread_queue, ThreadQueue)
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">True
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">isinstance(results_queue, ThreadQueue)
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">True
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">thread_queue is results_queue
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">False

We have two different objects, both instances of ThreadQueue. Therefore
the design pattern is broken.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">

</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">print results_queue is thread_queue
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">False
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">print opt_queue is thread_queue
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">False
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">print results_queue is opt_queue
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">False
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">

# Instantiate the three singletons again.
</pre></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">

This is a contradiction in terms! If they are singletons, you instatiate
once and once only. Any attempt to do otherwise should either raise an
exception, or simply return the single existing instance of the class.
You have coded the second option, so ...
</pre></blockquote><pre style="margin: 0em;">

The instantiation returns references to the singleton object.  There's
nothing wrong with that, the class is only ever instantiated once.


</pre><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">... thread_queue2 = ThreadQueue()
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">results_queue2 = ResultsQueue()
opt_queue2 = OptimisationQueue()
</pre></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">

You have simply rebound thread_queue as thread_queue2, results_queue as
results_queue2 and opt_queue as opt_queue2. So...
</pre></blockquote><pre style="margin: 0em;">

This, together with the print statements below demonstrate 3
singletons - i.e. 3 objects which exist only once in the program.


</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">

# Print the objects of the singletons.
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">... print thread_queue2.x
1
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">print results_queue2.x
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">2
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">print opt_queue2.x
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">3

</pre></blockquote><pre style="margin: 0em;">

This follows obviously:

</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">thread_queue is thread_queue2
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">True
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">results_queue is results_queue2
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">True
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">opt_queue is opt_queue2
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">

so:

</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">thread_queue.x is thread_queue2.x
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">True

etc.


Again, where is the conflict?
</pre></blockquote><pre style="margin: 0em;">

There is no conflict.  This demonstrates three distinct objects and
hence three distinct singletons.
</pre></blockquote><pre style="margin: 0em;">

All objects are distinct, whether singletons or not. Three distinct
objects does not demonstrate three singletons.

</pre><blockquote class="blockquote"><pre style="margin: 0em;">

Edward

</pre></blockquote><pre style="margin: 0em;">



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00046" href="msg00046.html">Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00066" href="msg00066.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00068" href="msg00068.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00070" href="msg00070.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Gary S. Thompson</li></ul></li>
<li><strong><a name="00077" href="msg00077.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00117" href="msg00117.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00119" href="msg00119.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00120" href="msg00120.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00122" href="msg00122.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00123" href="msg00123.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00125" href="msg00125.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Mon Mar 26 18:20:40 2007</div>  
</body>
</html>
