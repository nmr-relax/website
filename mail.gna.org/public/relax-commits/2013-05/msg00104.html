<!-- MHonArc v2.6.16 -->
<!--X-Subject: r19715 &#45; in /branches/relax_disp/test_suite:	shared_data/dispersion/Hansen/r2eff_values.bz2	system_tests/relax_disp.py -->
<!--X-From-R13: rqjneqNaze&#45;erynk.pbz -->
<!--X-Date: Thu, 23 May 2013 19:21:38 +0200 -->
<!--X-Message-Id: E1UfZCs&#45;000232&#45;PP@subversion.gna.org -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>r19715 - in /branches/relax_disp/test_suite:	shared_data/dispersion/Hansen/r2eff_values.bz2	system_tests/relax_disp.py -- May 23, 2013 - 19:21</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />r19715 - in /branches/relax_disp/test_suite:	shared_data/dispersion/Hansen/r2eff_values.bz2	system_tests/relax_disp.py</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00104" class="tabs">Index by Date</a> | <a href="threads.html#00104" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00103.html">Date Prev</a>] [<a href="msg00105.html">Date Next</a>] [<a href="msg00103.html">Thread Prev</a>] [<a href="msg00105.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: relax-commits@xxxxxxx</li>
<li class="menuitem">
<em>Date</em>: Thu, 23 May 2013 17:21:38 -0000</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00104.html">E1UfZCs-000232-PP@subversion.gna.org</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>edward</strong> on May 23, 2013 - 19:21:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Author: bugman
Date: Thu May 23 19:21:38 2013
New Revision: 19715

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=19715&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=19715&amp;view=rev</a>
Log:
Created the Relax_disp.test_hansen_cpmgfit_input system test.

This is for checking the operation of the relax_disp.cpmgfit_input user 
function conversion of
Flemming Hansen's CPMG R2eff values into input files for CPMGFit.  A relax 
state file containing the
results of an analysis of an 'R2eff' model analysis of the truncated data has 
been added to the test
suite data to speed up the test and to check the loading of dispersion state 
files.


Added:
    
branches/relax_disp/test_suite/shared_data/dispersion/Hansen/r2eff_values.bz2 
  (with props)
Modified:
    branches/relax_disp/test_suite/system_tests/relax_disp.py

Added: 
branches/relax_disp/test_suite/shared_data/dispersion/Hansen/r2eff_values.bz2
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/relax_disp/test_suite/shared_data/dispersion/Hansen/r2eff_values.bz2?rev=19715&amp;view=auto">http://svn.gna.org/viewcvs/relax/branches/relax_disp/test_suite/shared_data/dispersion/Hansen/r2eff_values.bz2?rev=19715&amp;view=auto</a>
==============================================================================
Binary file - no diff available.

Propchange: 
branches/relax_disp/test_suite/shared_data/dispersion/Hansen/r2eff_values.bz2
------------------------------------------------------------------------------
    svn:mime-type = application/octet-stream

Modified: branches/relax_disp/test_suite/system_tests/relax_disp.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/relax_disp/test_suite/system_tests/relax_disp.py?rev=19715&amp;r1=19714&amp;r2=19715&amp;view=diff">http://svn.gna.org/viewcvs/relax/branches/relax_disp/test_suite/system_tests/relax_disp.py?rev=19715&amp;r1=19714&amp;r2=19715&amp;view=diff</a>
==============================================================================
--- branches/relax_disp/test_suite/system_tests/relax_disp.py (original)
+++ branches/relax_disp/test_suite/system_tests/relax_disp.py Thu May 23 
19:21:38 2013
@@ -80,6 +80,128 @@
 
         # Execute the script.
         self.interpreter.run(script_file=status.install_path + 
sep+'test_suite'+sep+'system_tests'+sep+'scripts'+sep+'relax_disp'+sep+'hansen_data.py')
+
+
+    def test_hansen_cpmgfit_input(self):
+        &quot;&quot;&quot;Conversion of Dr. Flemming Hansen's CPMG R2eff values into input 
files for CPMGFit.
+
+        This uses the data from Dr. Flemming Hansen's paper at 
<a  rel="nofollow" href="http://dx.doi.org/10.1021/jp074793o">http://dx.doi.org/10.1021/jp074793o</a>.  This is CPMG data with a fixed 
relaxation time period.
+        &quot;&quot;&quot;
+
+        # Load the state, preserving the temp directory.
+        tmpdir = ds.tmpdir
+        state = status.install_path + 
sep+'test_suite'+sep+'shared_data'+sep+'dispersion'+sep+'Hansen'+sep+'r2eff_values'
+        self.interpreter.state.load(state, force=True)
+        ds.tmpdir = tmpdir
+
+        # Set up the model.
+        self.interpreter.relax_disp.select_model('LM63')
+
+        # Generate the input files.
+        self.interpreter.relax_disp.cpmgfit_input(force=True, dir=ds.tmpdir)
+
+        # What the files should contain.
+        batch_file = ['#! /bin/sh\n', '\n', 'cpmgfit -xmgr -f 
spin_:70@xxxx\n', 'cpmgfit -xmgr -f spin_:71@xxxx\n']
+        spin1 = [
+            'title :70@N\n',
+            'fields 2 18.7892743865 11.7432964915\n',
+            'function CPMG\n',
+            'R2 1 10 20\n',
+            'Rex 0 100.0 100\n',
+            'tex 0 10.0 100\n',
+            'xmgr\n',
+            '@ xaxis label &quot;1/tcp (1/ms)&quot;\n',
+            '@ yaxis label &quot;R2(tcp) (rad/s)&quot;\n',
+            '@ xaxis ticklabel format decimal\n',
+            '@ yaxis ticklabel format decimal\n',
+            '@ xaxis ticklabel char size 0.8\n',
+            '@ yaxis ticklabel char size 0.8\n',
+            '@ world xmin 0.0\n',
+            'data\n',
+            '0.066667             16.045541            0.296491             
11.743296           \n',
+            '0.133333             14.877925            0.234000             
11.743296           \n',
+            '0.200000             14.357820            0.301228             
11.743296           \n',
+            '0.266667             12.664495            0.299527             
11.743296           \n',
+            '0.333333             12.363205            0.271194             
11.743296           \n',
+            '0.400000             11.092532            0.285045             
11.743296           \n',
+            '0.466667             10.566090            0.295090             
11.743296           \n',
+            '0.533333             9.805807             0.235226             
11.743296           \n',
+            '0.600000             9.564301             0.281865             
11.743296           \n',
+            '0.666667             9.015634             0.275269             
11.743296           \n',
+            '0.733333             8.607765             0.266371             
11.743296           \n',
+            '0.800000             8.279997             0.274045             
11.743296           \n',
+            '0.866667             8.474536             0.251836             
11.743296           \n',
+            '0.933333             8.158973             0.220777             
11.743296           \n',
+            '1.000000             7.988631             0.264123             
11.743296           \n',
+            '0.066667             22.224914            0.157014             
18.789274           \n',
+            '0.133333             21.230874            0.123960             
18.789274           \n',
+            '0.200000             20.603704            0.162258             
18.789274           \n',
+            '0.266667             20.327797            0.154694             
18.789274           \n',
+            '0.333333             18.855377            0.159253             
18.789274           \n',
+            '0.400000             18.537531            0.141982             
18.789274           \n',
+            '0.466667             17.508069            0.139421             
18.789274           \n',
+            '0.533333             16.035604            0.113450             
18.789274           \n',
+            '0.600000             15.168192            0.145221             
18.789274           \n',
+            '0.666667             14.431802            0.138125             
18.789274           \n',
+            '0.733333             14.034137            0.131017             
18.789274           \n',
+            '0.800000             12.920148            0.131678             
18.789274           \n',
+            '0.866667             12.653673            0.139552             
18.789274           \n',
+            '0.933333             12.610864            0.103480             
18.789274           \n',
+            '1.000000             11.969303            0.135988             
18.789274           \n'
+        ]
+        spin2 = [
+            'title :71@N\n',
+            'fields 2 18.7892743865 11.7432964915\n',
+            'function CPMG\n',
+            'R2 1 10 20\n',
+            'Rex 0 100.0 100\n',
+            'tex 0 10.0 100\n',
+            'xmgr\n',
+            '@ xaxis label &quot;1/tcp (1/ms)&quot;\n',
+            '@ yaxis label &quot;R2(tcp) (rad/s)&quot;\n',
+            '@ xaxis ticklabel format decimal\n',
+            '@ yaxis ticklabel format decimal\n',
+            '@ xaxis ticklabel char size 0.8\n',
+            '@ yaxis ticklabel char size 0.8\n',
+            '@ world xmin 0.0\n',
+            'data\n',
+            '0.066667             7.044342             0.174267             
11.743296           \n',
+            '0.133333             6.781033             0.137976             
11.743296           \n',
+            '0.200000             6.467623             0.171372             
11.743296           \n',
+            '0.266667             6.333340             0.179931             
11.743296           \n',
+            '0.333333             6.323238             0.162322             
11.743296           \n',
+            '0.400000             6.005245             0.166673             
11.743296           \n',
+            '0.466667             5.767052             0.168136             
11.743296           \n',
+            '0.533333             5.476968             0.134411             
11.743296           \n',
+            '0.600000             5.469949             0.157734             
11.743296           \n',
+            '0.666667             5.295113             0.168230             
11.743296           \n',
+            '0.733333             5.435648             0.163755             
11.743296           \n',
+            '0.800000             5.410400             0.165309             
11.743296           \n',
+            '0.866667             5.437554             0.158582             
11.743296           \n',
+            '0.933333             5.176844             0.144974             
11.743296           \n',
+            '1.000000             5.227232             0.162255             
11.743296           \n'
+        ]
+
+        # Check the batch file.
+        file = open(&quot;%s%sbatch_run.sh&quot; % (ds.tmpdir, sep))
+        lines = file.readlines()
+        file.close()
+        for i in range(len(lines)):
+            self.assertEqual(batch_file[i], lines[i])
+
+        # Check spin :70@N.
+        file = open(&quot;%s%sspin_%s.in&quot; % (ds.tmpdir, sep, ':70@N'))
+        lines = file.readlines()
+        file.close()
+        for i in range(len(lines)):
+            self.assertEqual(spin1[i], lines[i])
+
+        # Check spin :71@N.
+        file = open(&quot;%s%sspin_%s.in&quot; % (ds.tmpdir, sep, ':71@N'))
+        lines = file.readlines()
+        file.close()
+        for i in range(len(lines)):
+            self.assertEqual(spin2[i], lines[i])
 
 
     def test_exp_fit(self):



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu May 23 19:40:02 2013</div>  
</body>
</html>
