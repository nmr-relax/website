<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: r3243 &#45; in /branches/multi_processor: ./ multi/ prompt/	specific_fns/ -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneq.qnhiretarNtznvy.pbz> -->
<!--X-Date: Fri, 30 Mar 2007 04:31:46 +0200 -->
<!--X-Message-Id: 7f080ed10703291930l2e0da84fv984a79a626437823@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: E1HWrC8&#45;0002Jl&#45;Ii@subversion.gna.org -->
<!--X-Reference: 460B9BA0.1060402@bmb.leeds.ac.uk -->
<!--X-Reference: 7f080ed10703290839g1afb16c7k476b60bca781dca4@mail.gmail.com -->
<!--X-Reference: 460BE559.7010901@bmb.leeds.ac.uk -->
<!--X-Reference: f001463a0703291023l6145b88cs4ab84784c66524ab@mail.gmail.com -->
<!--X-Reference: f001463a0703291310r5e45cf69je67f791c95880e9b@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: r3243 - in /branches/multi_processor: ./ multi/ prompt/	specific_fns/ -- March 30, 2007 - 04:31</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: r3243 - in /branches/multi_processor: ./ multi/ prompt/	specific_fns/</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00160" class="tabs">Index by Date</a> | <a href="threads.html#00160" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00159.html">Date Prev</a>] [<a href="msg00161.html">Date Next</a>] [<a href="msg00158.html">Thread Prev</a>] [<a href="msg00159.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;gary thompson&quot; &lt;garyt.and.sarahb@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Fri, 30 Mar 2007 12:30:20 +1000</li>
<li class="menuitem">
<em>Cc</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Dkim-signature</em>: a=rsa-sha1; c=relaxed/relaxed; d=gmail.com; s=beta;	h=domainkey-signature:received:received:message-id:date:from:to:subject:cc:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;	b=SC7I1R6to9vI/pkhP/KGggAlyquTPaWJWOHzJjKFwlopCUWHPAY1rpktmTBQ7q1p4W0NqxrTjXeFA9EgG41SjYZJlkQ/xaLvGfe5xZ99LJbd0oNxdgmI0JZSnJ6MIKLHaLrYMt++nb1i+RldWfYLyPdw6H8wxYF5C4RUJRzr7Gc=</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00160.html">7f080ed10703291930l2e0da84fv984a79a626437823@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;E1HWrC8-0002Jl-Ii@subversion.gna.org&gt;	&lt;<a href="msg00148.html">460B9BA0.1060402@bmb.leeds.ac.uk</a>&gt;	&lt;<a href="msg00153.html">7f080ed10703290839g1afb16c7k476b60bca781dca4@mail.gmail.com</a>&gt;	&lt;<a href="msg00156.html">460BE559.7010901@bmb.leeds.ac.uk</a>&gt;	&lt;<a href="msg00157.html">f001463a0703291023l6145b88cs4ab84784c66524ab@mail.gmail.com</a>&gt;	&lt;<a href="msg00158.html">f001463a0703291310r5e45cf69je67f791c95880e9b@mail.gmail.com</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on March 30, 2007 - 04:31:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<tt>On 3/30/07, gary thompson &lt;garyt.and.sarahb@xxxxxxxxx&gt; wrote:
</tt><blockquote class="blockquote"><pre style="margin: 0em;">On 3/29/07, gary thompson &lt;garyt.and.sarahb@xxxxxxxxx&gt; wrote:
&gt; On 3/29/07, Gary S. Thompson &lt;garyt@xxxxxxxxxxxxxxx&gt; wrote:
&gt; &gt; Edward d'Auvergne wrote:
&gt; [snip]
&gt;
</pre></blockquote><br>
<blockquote class="blockquote"><pre style="margin: 0em;">&gt; &gt; &gt; Another point is that I can't
&gt; &gt; &gt; run the code in the branch without having MPI up and running.
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; you should be able to run relax without a --multi command line and
&gt; &gt; without an mpirun and the uniprocessor implimentations should run.
&gt; &gt; However, currently when I run it I get The dependency 'mpi4py' has not
&gt; &gt; been installed is that the problem you have?? I will investigate the 
problem
&gt; &gt;
&gt; &gt;
&gt; correction I have just gone home and run the command on the same
&gt; machine remotely and get no messages about dependencies!. if this is
&gt; the error you get please tell me.
&gt;
&gt; Ah revelation (realtime messaging and debugging!) in uni_processor I
&gt; am using multi.mpi4py_processor.Result_command which will load the
&gt; mpi4py_processor module which will result in  load of mpi4py (lines 14
&gt; onwards in mpi4py_processor). This is just an oversight due to me
&gt; being lazy and winging it while testing corrections on the way ;-)
&gt;</pre><br>
<pre style="margin: 0em;">I had to work a bit harder than expected on this but 3248 should cure it ;-)</pre><br>
<pre style="margin: 0em;">Also two other comments</pre><br>
<pre style="margin: 0em;"><br>1. This code is only compatible with python 2.4 currently. calling it
on 2.3.3 results in the crash</pre><br>
<pre style="margin: 0em;">Traceback (most recent call last):
  File &quot;../relax&quot;, line 588, in ?
    multi_processor.run()
  File 
&quot;/usr/jessy/garyt/projects/relax_branch/branch_multi1/multi/uni_processor.py&quot;,
line 43, in run
    self.relax_instance.run()
  File &quot;../relax&quot;, line 175, in run
    self.interpreter.run()
  File 
&quot;/usr/jessy/garyt/projects/relax_branch/branch_multi1/prompt/interpreter.py&quot;,
line 216, in run
    run_script(intro=self.relax.intro_string, local=self.local,
script_file=self.relax.script_file, quit=1)
  File 
&quot;/usr/jessy/garyt/projects/relax_branch/branch_multi1/prompt/interpreter.py&quot;,
line 392, in run_script
    console.interact(intro, local, script_file, quit)
  File 
&quot;/usr/jessy/garyt/projects/relax_branch/branch_multi1/prompt/interpreter.py&quot;,
line 343, in interact_script
    execfile(script_file, local)
  File &quot;test_small.py&quot;, line 52, in ?
    grid_search(name, inc=11)
  File 
&quot;/usr/jessy/garyt/projects/relax_branch/branch_multi1/prompt/minimisation.py&quot;,
line 144, in grid_search
    self.relax.generic.minimise.grid_search(run=run, lower=lower,
upper=upper, inc=inc, constraints=constraints, print_flag=print_flag)
  File 
&quot;/usr/jessy/garyt/projects/relax_branch/branch_multi1/generic_fns/minimise.py&quot;,
line 96, in grid_search
    grid_search(run=run, lower=lower, upper=upper, inc=inc,
constraints=constraints, print_flag=print_flag)
  File 
&quot;/usr/jessy/garyt/projects/relax_branch/branch_multi1/specific_fns/model_free.py&quot;,
line 1520, in grid_search
    self.minimise(run=run, min_algor='grid', constraints=constraints,
print_flag=print_flag, sim_index=sim_index)
  File 
&quot;/usr/jessy/garyt/projects/relax_branch/branch_multi1/specific_fns/model_free.py&quot;,
line 2408, in minimise
    mu0=self.relax.data.mu0, num_params=num_params, vectors=xh_unit_vectors)
  File 
&quot;/usr/jessy/garyt/projects/relax_branch/branch_multi1/multi/commands.py&quot;,
line 84, in set_mf
    self.mf_map.update(**kwargs)
TypeError: update() takes no keyword arguments</pre><br>
<tt>clearly update won't take dictionaries on 2.3.3
</tt></blockquote><pre style="margin: 0em;"><br>Is there another way of doing this which doesn't require the update() 
method?</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">2. I ran the uniprocessor and the mpi4py versions on my machine and
was suprised to find that if you directed stdout to a file they had
almost identical ruintimes. so it appears that most of the
interprocess communication overhead is from returning stdout
</pre></blockquote><pre style="margin: 0em;"><br>Writing to stdout is a big factor for the fast calculations (models m1
to m4).  It's not an issue for the slower calculations which take
almost all of the CPU time (models m5 to m8).</pre><br>
<pre style="margin: 0em;">A useful measure might be to test the uniprocessor version versus the
normal operation of relax (possibly the revision of the 1.3 line prior
to your branch).  The uniprocessor must not be slower in any way than
the normal single machine operation for it to replace the current
model-free minimise() function.  Once uniprocessor and the normal
minimise() function operate at exactly the same speeds, then the
comparison between uniprocessor and the MPI code should be more
meaningful.  Do you know if the profile flag at the end of the file
'relax' can be used successfully with MPI?</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">3. note most of the text output is scrambled!</pre><br>
<pre style="margin: 0em;">e.g.</pre><br>
<pre style="margin: 0em;">&gt; Fitting to residue: 27 ALA
~~~~~~~~~~~~~~~~~~~~~~~~~~
Unconstrained grid search size: 11 (constraints may decrease this size).</pre><br>
<pre style="margin: 0em;">Fitting to residue: 28 GLY
~~~~~~~~~~~~~~~~~~~~~~~~~~
Unconstrained grid search size: 11 (constraints may decrease this size).</pre><br>
<pre style="margin: 0em;">Fitting to residue: 29 LYS
~~~~~~~~~~~~~~~~~~~~~~~~~~
Unconstrained grid search size: 11 (constraints may decrease this size).</pre><br>
<pre style="margin: 0em;">Fitting to residue: 30 ASP
~~~~~~~~~~~~~~~~~~~~~~~~~~
Unconstrained grid search size: 11 (constraints may decrease this size).</pre><br>
<pre style="margin: 0em;">followed by</pre><br>
<pre style="margin: 0em;"><br>Grid search
~~~~~~~~~~~</pre><br>
<pre style="margin: 0em;">....
Grid search
~~~~~~~~~~~</pre><br>
<pre style="margin: 0em;">.....</pre><br>
<tt><br>this is because the minimisation is carried out of order with the queuing
</tt></blockquote><pre style="margin: 0em;"><br>The optimisation printout should be printed in the order in which they
are calculated.  We'll need to get the headers such at 'Fitting to
residue: 27 ALA' to somehow match the optimisation printout.</pre><br>
<pre style="margin: 0em;">Cheers,</pre><br>
<pre style="margin: 0em;">Edward</pre><br>
<br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00148" href="msg00148.html">Re: r3243 - in /branches/multi_processor: ./ multi/ prompt/	specific_fns/</a></strong>
<ul><li><em>From:</em> Gary S. Thompson</li></ul></li>
<li><strong><a name="00153" href="msg00153.html">Re: r3243 - in /branches/multi_processor: ./ multi/ prompt/	specific_fns/</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00156" href="msg00156.html">Re: r3243 - in /branches/multi_processor: ./ multi/ prompt/	specific_fns/</a></strong>
<ul><li><em>From:</em> Gary S. Thompson</li></ul></li>
<li><strong><a name="00157" href="msg00157.html">Re: r3243 - in /branches/multi_processor: ./ multi/ prompt/	specific_fns/</a></strong>
<ul><li><em>From:</em> gary thompson</li></ul></li>
<li><strong><a name="00158" href="msg00158.html">Re: r3243 - in /branches/multi_processor: ./ multi/ prompt/	specific_fns/</a></strong>
<ul><li><em>From:</em> gary thompson</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Fri Mar 30 07:41:00 2007</div>  
</body>
</html>
