<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: r5308 &#45; in /1.3: physical_constants.py prompt/jw_mapping.py	specific_fns/jw_mapping.py test_suite/system_tests/jw_mapping.py -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Fri, 04 Apr 2008 16:42:07 +0200 -->
<!--X-Message-Id: 7f080ed10804040741x3e26f862r808982451ab522c8@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: E1JhmnI&#45;0006T5&#45;RK@subversion.gna.org -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: r5308 - in /1.3: physical_constants.py prompt/jw_mapping.py	specific_fns/jw_mapping.py test_suite/system_tests/jw_mapping.py -- April 04, 2008 - 16:42</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: r5308 - in /1.3: physical_constants.py prompt/jw_mapping.py	specific_fns/jw_mapping.py test_suite/system_tests/jw_mapping.py</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00033" class="tabs">Index by Date</a> | <a href="threads.html#00033" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00032.html">Date Prev</a>] [<a href="msg00034.html">Date Next</a>] [<a href="msg00031.html">Thread Prev</a>] [<a href="msg00034.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Date</em>: Fri, 4 Apr 2008 16:41:55 +0200</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00033.html">7f080ed10804040741x3e26f862r808982451ab522c8@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;E1JhmnI-0006T5-RK@xxxxxxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on April 04, 2008 - 16:42:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi,

It may have been best to make separate commits for these different
changes.  The reason is because in the file 'physical_constants.py',
the variable 'nuclues' should not have changed to 'heteronuc_type'.
The proton is not a heteronucleus, this function simply returns the
gyromagnetic ratio for the desired nucleus.  As the changes to these 4
files were committed together, the revision cannot be reverted.
However the changes to the file can be reverted using normal reversion
commands but with the file name at the end.

Cheers,

Edward



On Fri, Apr 4, 2008 at 4:21 PM,  &lt;sebastien.morin.1@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Author: semor
 Date: Fri Apr  4 16:21:27 2008
 New Revision: 5308

 URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=5308&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=5308&amp;view=rev</a>
 Log:
 Partially fixed the code so the Jw mapping system test can go further 
before failure.


 Modified:
    1.3/physical_constants.py
    1.3/prompt/jw_mapping.py
    1.3/specific_fns/jw_mapping.py
    1.3/test_suite/system_tests/jw_mapping.py

 Modified: 1.3/physical_constants.py
 URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/1.3/physical_constants.py?rev=5308&amp;r1=5307&amp;r2=5308&amp;view=diff">http://svn.gna.org/viewcvs/relax/1.3/physical_constants.py?rev=5308&amp;r1=5307&amp;r2=5308&amp;view=diff</a>
 
==============================================================================
 --- 1.3/physical_constants.py (original)
 +++ 1.3/physical_constants.py Fri Apr  4 16:21:27 2008
 @@ -70,29 +70,29 @@
  &quot;&quot;&quot;The 31P gyromagnetic ratio.&quot;&quot;&quot;

  # Function for returning the desired gyromagnetic ratio.
 -def return_gyromagnetic_ratio(nucleus=None):
 -    &quot;&quot;&quot;Return the gyromagnetic ratio for the given nucleus type.
 +def return_gyromagnetic_ratio(heteronuc_type=None):
 +    &quot;&quot;&quot;Return the gyromagnetic ratio for the given heteronucleus type.

 -    @keyword nucleus:   The nucleus type.
 -    @type nucleus:      str
 -    @raises RelaxError: If the nucleus type is unknown.
 -    @returns:           The desired gyromagnetic ratio.
 -    @rtype:             float
 +    @keyword heteronuc_type:   The heteronucleus type.
 +    @type heteronucleus:       str
 +    @raises RelaxError:        If the nucleus type is unknown.
 +    @returns:                  The desired gyromagnetic ratio.
 +    @rtype:                    float
     &quot;&quot;&quot;

     # Matching loop.
 -    if nucleus == '13C':
 +    if heteronuc_type == '13C':
         return g13C
 -    elif nucleus == '1H':
 +    elif heteronuc_type == '1H':
         return g1H
 -    elif nucleus == '15N':
 +    elif heteronuc_type == '15N':
         return g15N
 -    elif nucleus == '17O':
 +    elif heteronuc_type == '17O':
         return g17O
 -    elif nucleus == '31P':
 +    elif heteronuc_type == '31P':
         return g31P
     else:
 -        raise RelaxError, &quot;The nucleus type &quot; + `nucleus` + &quot; is unknown.&quot;
 +        raise RelaxError, &quot;The heteronucleus type &quot; + `heteronuc_type` + 
&quot; is unknown.&quot;


  # Relative atomic masses.

 Modified: 1.3/prompt/jw_mapping.py
 URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/1.3/prompt/jw_mapping.py?rev=5308&amp;r1=5307&amp;r2=5308&amp;view=diff">http://svn.gna.org/viewcvs/relax/1.3/prompt/jw_mapping.py?rev=5308&amp;r1=5307&amp;r2=5308&amp;view=diff</a>
 
==============================================================================
 --- 1.3/prompt/jw_mapping.py (original)
 +++ 1.3/prompt/jw_mapping.py Fri Apr  4 16:21:27 2008
 @@ -26,6 +26,7 @@
  # relax module imports.
  import help
  from relax_errors import RelaxStrError
 +from specific_fns.setup import jw_mapping_obj


  class Jw_mapping:

 Modified: 1.3/specific_fns/jw_mapping.py
 URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/1.3/specific_fns/jw_mapping.py?rev=5308&amp;r1=5307&amp;r2=5308&amp;view=diff">http://svn.gna.org/viewcvs/relax/1.3/specific_fns/jw_mapping.py?rev=5308&amp;r1=5307&amp;r2=5308&amp;view=diff</a>
 
==============================================================================
 --- 1.3/specific_fns/jw_mapping.py (original)
 +++ 1.3/specific_fns/jw_mapping.py Fri Apr  4 16:21:27 2008
 @@ -174,7 +174,7 @@

         csa:  CSA value.

 -        nucleus:  The heteronucleus type.
 +        heteronuc_type:  The heteronucleus type.

         j0:  Spectral density value at 0 MHz.

 @@ -189,7 +189,7 @@
         # Values.
         names.append('r')
         names.append('csa')
 -        names.append('nucleus')
 +        names.append('heteronuc_type')

         # Spectral density values.
         names.append('j0')
 @@ -381,10 +381,6 @@
         # Alias the current data pipe.
         cdp = relax_data_store[relax_data_store.current_pipe]

 -        # Test if the run exists.
 -        if not self.run in relax_data_store.run_names:
 -            raise RelaxNoPipeError, self.run
 -
         # Test if the run type is set to 'jw'.
         function_type = relax_data_store.run_types[cdp.run_names.index]
         if function_type != 'jw':
 @@ -475,7 +471,7 @@
         relax_data_store.res[run][i].relax_sim_data = sim_data


 -    def write_columnar_line(self, file=None, num=None, name=None, 
select=None, data_set=None, nucleus=None, wH=None, j0=None, jwx=None, 
jwh=None, r=None, csa=None, ri_labels=None, remap_table=None, 
frq_labels=None, frq=None, ri=None, ri_error=None):
 +    def write_columnar_line(self, file=None, num=None, name=None, 
select=None, data_set=None, heteronuc_type=None, wH=None, j0=None, 
jwx=None, jwh=None, r=None, csa=None, ri_labels=None, remap_table=None, 
frq_labels=None, frq=None, ri=None, ri_error=None):
         &quot;&quot;&quot;Function for printing a single line of the columnar formatted 
results.&quot;&quot;&quot;

         # Residue number and name.
 @@ -485,7 +481,7 @@
         file.write(&quot;%-9s %-9s &quot; % (select, data_set))

         # Nucleus.
 -        file.write(&quot;%-7s &quot; % nucleus)
 +        file.write(&quot;%-7s &quot; % heteronuc_type)

         # Proton frequency.
         file.write(&quot;%-25s &quot; % wH)
 @@ -551,14 +547,14 @@
                 ri_error.append('Ri_error_(' + cdp.ri_labels[i] + &quot;_&quot; + 
cdp.frq_labels[cdp.remap_table[i]] + &quot;)&quot;)

         # Write the header line.
 -        self.write_columnar_line(file=file, num='Num', name='Name', 
select='Selected', data_set='Data_set', nucleus='Nucleus', 
wH='Proton_frq_(MHz)', j0='J(0)', jwx='J(wX)', jwh='J(wH)', 
r='Bond_length_(A)', csa='CSA_(ppm)', ri_labels='Ri_labels', 
remap_table='Remap_table', frq_labels='Frq_labels', frq='Frequencies', 
ri=ri, ri_error=ri_error)
 +        self.write_columnar_line(file=file, num='Num', name='Name', 
select='Selected', data_set='Data_set', heteronuc_type='Nucleus', 
wH='Proton_frq_(MHz)', j0='J(0)', jwx='J(wX)', jwh='J(wH)', 
r='Bond_length_(A)', csa='CSA_(ppm)', ri_labels='Ri_labels', 
remap_table='Remap_table', frq_labels='Frq_labels', frq='Frequencies', 
ri=ri, ri_error=ri_error)


         # Values.
         #########

         # Nucleus.
 -        nucleus = self.relax.generic.nuclei.find_nucleus()
 +        heteronuc_type = self.relax.generic.nuclei.find_heteronuc_type()

         # The proton frequency in MHz.
         wH = cdp.jw_frq / 1e6
 @@ -628,7 +624,7 @@
                         ri_error.append(None)

             # Write the line.
 -            self.write_columnar_line(file=file, num=spin.num, 
name=spin.name, select=spin.select, spin_set='value', nucleus=nucleus, 
wH=`wH`, j0=`j0`, jwx=`jwx`, jwh=`jwh`, r=`r`, csa=`csa`, 
ri_labels=ri_labels, remap_table=remap_table, frq_labels=frq_labels, 
frq=frq, ri=ri, ri_error=ri_error)
 +            self.write_columnar_line(file=file, num=spin.num, 
name=spin.name, select=spin.select, spin_set='value', 
heteronuc_type=heteronuc_type, wH=`wH`, j0=`j0`, jwx=`jwx`, jwh=`jwh`, 
r=`r`, csa=`csa`, ri_labels=ri_labels, remap_table=remap_table, 
frq_labels=frq_labels, frq=frq, ri=ri, ri_error=ri_error)


         # Errors.
 @@ -676,7 +672,7 @@
                 ri_error.append(None)

             # Write the line.
 -            self.write_columnar_line(file=file, num=spin.num, 
name=spin.name, select=spin.select, spin_set='error', nucleus=nucleus, 
wH=`wH`, j0=`j0`, jwx=`jwx`, jwh=`jwh`, r=`r`, csa=`csa`, 
ri_labels=ri_labels, remap_table=remap_table, frq_labels=frq_labels, 
frq=frq, ri=ri, ri_error=ri_error)
 +            self.write_columnar_line(file=file, num=spin.num, 
name=spin.name, select=spin.select, spin_set='error', 
heteronuc_type=heteronuc_type, wH=`wH`, j0=`j0`, jwx=`jwx`, jwh=`jwh`, 
r=`r`, csa=`csa`, ri_labels=ri_labels, remap_table=remap_table, 
frq_labels=frq_labels, frq=frq, ri=ri, ri_error=ri_error)


         # Simulation values.
 @@ -734,4 +730,4 @@
                             ri_error.append(None)

                 # Write the line.
 -                self.write_columnar_line(file=file, num=spin.num, 
name=spin.name, select=spin.select, spin_set='sim_'+`i`, nucleus=nucleus, 
wH=`wH`, j0=`j0`, jwx=`jwx`, jwh=`jwh`, r=`r`, csa=`csa`, 
ri_labels=ri_labels, remap_table=remap_table, frq_labels=frq_labels, 
frq=frq, ri=ri, ri_error=ri_error)
 +                self.write_columnar_line(file=file, num=spin.num, 
name=spin.name, select=spin.select, spin_set='sim_'+`i`, 
heteronuc_type=heteronuc_type, wH=`wH`, j0=`j0`, jwx=`jwx`, jwh=`jwh`, 
r=`r`, csa=`csa`, ri_labels=ri_labels, remap_table=remap_table, 
frq_labels=frq_labels, frq=frq, ri=ri, ri_error=ri_error)

 Modified: 1.3/test_suite/system_tests/jw_mapping.py
 URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/1.3/test_suite/system_tests/jw_mapping.py?rev=5308&amp;r1=5307&amp;r2=5308&amp;view=diff">http://svn.gna.org/viewcvs/relax/1.3/test_suite/system_tests/jw_mapping.py?rev=5308&amp;r1=5307&amp;r2=5308&amp;view=diff</a>
 
==============================================================================
 --- 1.3/test_suite/system_tests/jw_mapping.py (original)
 +++ 1.3/test_suite/system_tests/jw_mapping.py Fri Apr  4 16:21:27 2008
 @@ -78,7 +78,7 @@
         # Set r, csa, and the nucleus type.
         self.relax.interpreter._Value.set(NH_BOND_LENGTH, 'bond_length')
         self.relax.interpreter._Value.set(N15_CSA, 'csa')
 -        self.relax.interpreter._Value.set('N', 'nucleus')
 +        self.relax.interpreter._Value.set('15N', 'heteronucleus')

         # Select the frequency.
         self.relax.interpreter._Jw_mapping.set_frq(frq=600.0 * 1e6)


 _______________________________________________
 relax (<a  rel="nofollow" href="http://nmr-relax.com">http://nmr-relax.com</a>)

 This is the relax-commits mailing list
 relax-commits@xxxxxxx

 To unsubscribe from this list, get a password
 reminder, or change your subscription options,
 visit the list information page at
 <a  rel="nofollow" href="/mail.gna.org/listinfo/relax-commits">https://mail.gna.org/listinfo/relax-commits</a>

</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Fri Apr 04 17:02:16 2008</div>  
</body>
</html>
