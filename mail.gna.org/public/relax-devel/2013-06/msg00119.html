<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: [sr #3045] Support for pooled standard deviation for: Peak	heights with partially replicated spectra -->
<!--X-From-R13: Febryf Szgrxæe Zvaarg <gyvaargNtznvy.pbz> -->
<!--X-Date: Wed, 19 Jun 2013 16:04:04 +0200 -->
<!--X-Message-Id: CA+CBx2OH_27M1EUT_2TVx8xijkLryw5Evz&#45;w_aQk9zxrbZoRgA@mail.gmail.com -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: 20130619&#45;125008.sv20529.35603@gna.org -->
<!--X-Reference: CAED9pY8=EP6_M+GGqVP8_qpB_pf3cBZWT3rxXv_V4e_Po14_0g@mail.gmail.com -->
<!--X-Reference: CAED9pY_u=ZKv9EQFKfYx1_86o0cGLCwDnxEUHJTce_wZLD=F1A@mail.gmail.com -->
<!--X-Reference: CAED9pY&#45;ByTC6g1gdGXzvWYMrzAL7MBE28LOKKpH1UscOF1ELVg@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [sr #3045] Support for pooled standard deviation for: Peak	heights with partially replicated spectra -- June 19, 2013 - 16:04</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: [sr #3045] Support for pooled standard deviation for: Peak	heights with partially replicated spectra</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00119" class="tabs">Index by Date</a> | <a href="threads.html#00119" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00118.html">Date Prev</a>] [<a href="msg00120.html">Date Next</a>] [<a href="msg00114.html">Thread Prev</a>] [<a href="msg00121.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Edward d'Auvergne&quot; &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Wed, 19 Jun 2013 16:03:17 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113;	h=mime-version:in-reply-to:references:from:date:message-id:subject:to	:cc:content-type;	bh=j/OpJTwBkvL2I7egsOqBYLN5J5XFJM83k84jk5QL+k8=;	b=HLk6r8tuRC07aGA8YCW3wyVuewpMiNVjRBYthT0uhTPx4H3cqlYrXr7SwNQ5QJPrEZ	57RGAxcK6Mc3SbfGpMgYWC7oxY7sY1T1KYwO2sobnRrv55j1gufjMHExOBsFDuCHT3qn	Ed0RoR6L7vgYxA4SsqEIhifGW7siH1lwGWEaTvMs7141uE7Xv6XhFuTHKg/zQI9+wLn9	DPHOF4CZZzfoV4mGbBwyC1Ig82HNeDZ/NGNJYWNHxeXQk1O1jkCzJ/+5XdvABgu50R+t	Mk3pBFA64o9BwgiuYiw9druykLvQsdpB2ZX+b439KE3nfo1V01Q7ftu5o8GkSFBHS45k	PQ2A==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00119.html">CA+CBx2OH_27M1EUT_2TVx8xijkLryw5Evz-w_aQk9zxrbZoRgA@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;20130619-125008.sv20529.35603@xxxxxxx&gt;	&lt;CAED9pY8=EP6_M+GGqVP8_qpB_pf3cBZWT3rxXv_V4e_Po14_0g@xxxxxxxxxxxxxx&gt;	&lt;CAED9pY_u=ZKv9EQFKfYx1_86o0cGLCwDnxEUHJTce_wZLD=F1A@xxxxxxxxxxxxxx&gt;	&lt;CAED9pY-ByTC6g1gdGXzvWYMrzAL7MBE28LOKKpH1UscOF1ELVg@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Troels Emtekær Linnet</strong> on June 19, 2013 - 16:04:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
Can we take an example?<div><br></div><div>Can I easily loop over </div><div>replicates, and extract intensity from just one spin?</div><div><br></div><div><div>cdp.replicates</div><div>[[&#39;0_2&#39;, &#39;7_2&#39;, &#39;14_2&#39;], [&#39;15_14&#39;, &#39;16_14&#39;, &#39;20_14&#39;], [&#39;3_30&#39;, &#39;8_30&#39;, &#39;17_30&#39;], [&#39;9_46&#39;, &#39;19_46&#39;, &#39;22_46&#39;]]</div>

</div><div><br clear="all"><div><br>Troels Emtekær Linnet<div style="display:inline"></div></div>
<br><br><div class="gmail_quote">2013/6/19 Edward d&#39;Auvergne <span dir="ltr">&lt;<a rel="nofollow" href="mailto:edward@xxxxxxxxxxxxx" target="_blank">edward@xxxxxxxxxxxxx</a>&gt;</span><br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">

And again I got it wrong :)  It&#39;s not the averaged variance divided by<br>
k!  It&#39;s the sum of variances divided by k, i.e. the average variance.<br>
 Therefore as all peaks are either duplicated, triplicated, etc., then<br>
in all cases the pooled variances collapses down to the average<br>
variance.  Therefore as I see it, the pooled variance for replicated<br>
spectra is redundant.  Or am I wrong again?<br>
<br>
Regards,<br>
<br>
Edward<br>
<div class="HOEnZb"><div class="h5"><br>
<br>
<br>
On 19 June 2013 15:27, Edward d&#39;Auvergne &lt;<a rel="nofollow" href="mailto:edward@xxxxxxxxxxxxx">edward@xxxxxxxxxxxxx</a>&gt; wrote:<br>
&gt; Just wait, I got that wrong!  First some definitions:<br>
&gt;<br>
&gt; n = number of replicated spectra,<br>
&gt; i = each spin system or peak,<br>
&gt; k = total number of peaks.<br>
&gt;<br>
&gt; The sum at the bottom of would mean that if n-1=1, then the<br>
&gt; denominator would be a large sum.  As n-1 would be the same for all i,<br>
&gt; then this becomes the averaged variance divided by k!  Therefore as<br>
&gt; you have more and more peaks in the spectrum, the smaller and smaller<br>
&gt; the estimator will be.  Taking this to the extreme, as you approach<br>
&gt; infinite peaks in the spectrum, the error approaches zero.  That seems<br>
&gt; absurd.  Maybe in this case, the unbiased estimator is absurd ;)  I<br>
&gt; think I should read that 3rd link you posted.<br>
&gt;<br>
&gt; Regards,<br>
&gt;<br>
&gt; Edward<br>
&gt;<br>
&gt;<br>
&gt;<br>
&gt;<br>
&gt; On 19 June 2013 15:15, Edward d&#39;Auvergne &lt;<a rel="nofollow" href="mailto:edward@xxxxxxxxxxxxx">edward@xxxxxxxxxxxxx</a>&gt; wrote:<br>
&gt;&gt; Hi,<br>
&gt;&gt;<br>
&gt;&gt; I&#39;m quite aware of this.  Another useful link is:<br>
&gt;&gt;<br>
&gt;&gt; <a rel="nofollow" href="http://en.wikipedia.org/wiki/Pooled_variance" target="_blank">http://en.wikipedia.org/wiki/Pooled_variance</a><br>
&gt;&gt;<br>
&gt;&gt; This has also been pointed out to me by Robert Schneider (but not on<br>
&gt;&gt; the mailing lists).  I am wondering if it is worth it as the number of<br>
&gt;&gt; users who would benefit are quite low.  The reason for this is that<br>
&gt;&gt; most users will only have duplicate spectra.  Therefore n-1 ends up<br>
&gt;&gt; being 1, as n is the number of replicated spectra, and this collapses<br>
&gt;&gt; down to the currently used variance averaging.  In the case where you<br>
&gt;&gt; have collected spectra in triplicate, then implementing this makes<br>
&gt;&gt; sense.  But the number of people using relax with triplicate spectra<br>
&gt;&gt; in the last 12 years is probably 1 or 2.  So it would be good to<br>
&gt;&gt; implement this, but it&#39;s priority is very low.  In any case, both<br>
&gt;&gt; averaged variances and pooled variances from a large collection of 2<br>
&gt;&gt; point sets is horrible statistics, but that&#39;s all we&#39;ve got.<br>
&gt;&gt;<br>
&gt;&gt; Note also that there are two averaging steps.  The first is to average<br>
&gt;&gt; the variance for all peaks in the spectrum.  The variance for a single<br>
&gt;&gt; peak is the dirty estimate from 2 points.  Then if some spectra are<br>
&gt;&gt; only measured once, then the variances for all spectra are averaged.<br>
&gt;&gt;<br>
&gt;&gt; Regards,<br>
&gt;&gt;<br>
&gt;&gt; Edward<br>
&gt;&gt;<br>
&gt;&gt;<br>
&gt;&gt;<br>
&gt;&gt;<br>
&gt;&gt;<br>
&gt;&gt;<br>
&gt;&gt; On 19 June 2013 14:50, Troels E. Linnet<br>
&gt;&gt; &lt;<a rel="nofollow" href="mailto:NO-REPLY.INVALID-ADDRESS@xxxxxxx">NO-REPLY.INVALID-ADDRESS@xxxxxxx</a>&gt; wrote:<br>
&gt;&gt;&gt; URL:<br>
&gt;&gt;&gt;   &lt;<a rel="nofollow" href="http://gna.org/support/?3045" target="_blank">http://gna.org/support/?3045</a>&gt;<br>
&gt;&gt;&gt;<br>
&gt;&gt;&gt;                  Summary: Support for pooled standard deviation for: Peak<br>
&gt;&gt;&gt; heights with partially replicated spectra<br>
&gt;&gt;&gt;                  Project: relax<br>
&gt;&gt;&gt;             Submitted by: tlinnet<br>
&gt;&gt;&gt;             Submitted on: Wed 19 Jun 2013 12:50:08 PM GMT<br>
&gt;&gt;&gt;                 Category: None<br>
&gt;&gt;&gt;                 Priority: 5 - Normal<br>
&gt;&gt;&gt;                 Severity: 3 - Normal<br>
&gt;&gt;&gt;                   Status: None<br>
&gt;&gt;&gt;                  Privacy: Public<br>
&gt;&gt;&gt;              Assigned to: None<br>
&gt;&gt;&gt;         Originator Email:<br>
&gt;&gt;&gt;              Open/Closed: Open<br>
&gt;&gt;&gt;          Discussion Lock: Any<br>
&gt;&gt;&gt;         Operating System: None<br>
&gt;&gt;&gt;<br>
&gt;&gt;&gt;     _______________________________________________________<br>
&gt;&gt;&gt;<br>
&gt;&gt;&gt; Details:<br>
&gt;&gt;&gt;<br>
&gt;&gt;&gt; According to the manual,<br>
&gt;&gt;&gt; <a rel="nofollow" href="http://www.nmr-relax.com/manual/spectrum_error_analysis.html" target="_blank">http://www.nmr-relax.com/manual/spectrum_error_analysis.html</a>,<br>
&gt;&gt;&gt; the variance for the replicated datasets are averaged, and used as the<br>
&gt;&gt;&gt; variance for single replicated spectrum.<br>
&gt;&gt;&gt;<br>
&gt;&gt;&gt; This is a very reasonable assumption, but I wonder if a pooled standard<br>
&gt;&gt;&gt; deviation should be used instead.<br>
&gt;&gt;&gt;<br>
&gt;&gt;&gt; If we look in the definition of IUPAC Gold Book:<br>
&gt;&gt;&gt; <a rel="nofollow" href="http://goldbook.iupac.org/P04758.html" target="_blank">http://goldbook.iupac.org/P04758.html</a><br>
&gt;&gt;&gt;<br>
&gt;&gt;&gt; &quot;&quot;&quot;<br>
&gt;&gt;&gt; Results from various series of measurements can be combined in the following<br>
&gt;&gt;&gt; way to give a pooled relative standard deviation $s_{r,p}$:<br>
&gt;&gt;&gt;<br>
&gt;&gt;&gt; $$<br>
&gt;&gt;&gt; s_{r,p}=\sqrt{\frac{\sum(n_i-1)s_{r,i}^2}{\sum n_i -1}} =<br>
&gt;&gt;&gt; \sqrt{\frac{\sum(n_i-1)s_i^2x_i^{-2}}{\sum n_i -1}}<br>
&gt;&gt;&gt; $$<br>
&gt;&gt;&gt; &quot;&quot;&quot;<br>
&gt;&gt;&gt;<br>
&gt;&gt;&gt; It is not an easy subject, and the discussion can be &quot;hot&quot;: See for example<br>
&gt;&gt;&gt; these gals and gils: <a rel="nofollow" href="http://www.physicsforums.com/showthread.php?t=268377" target="_blank">http://www.physicsforums.com/showthread.php?t=268377</a><br>
&gt;&gt;&gt;<br>
&gt;&gt;&gt;<br>
&gt;&gt;&gt; So my question is, is the use of average of variances the right way to<br>
&gt;&gt;&gt; estimate the variance for single recorded data point?<br>
&gt;&gt;&gt; And should another way be implemented?<br>
&gt;&gt;&gt;<br>
&gt;&gt;&gt;<br>
&gt;&gt;&gt;<br>
&gt;&gt;&gt;<br>
&gt;&gt;&gt;     _______________________________________________________<br>
&gt;&gt;&gt;<br>
&gt;&gt;&gt; Reply to this item at:<br>
&gt;&gt;&gt;<br>
&gt;&gt;&gt;   &lt;<a rel="nofollow" href="http://gna.org/support/?3045" target="_blank">http://gna.org/support/?3045</a>&gt;<br>
&gt;&gt;&gt;<br>
&gt;&gt;&gt; _______________________________________________<br>
&gt;&gt;&gt;   Message sent via/by Gna!<br>
&gt;&gt;&gt;   <a rel="nofollow" href="http://gna.org/" target="_blank">http://gna.org/</a><br>
&gt;&gt;&gt;<br>
&gt;&gt;&gt;<br>
&gt;&gt;&gt; _______________________________________________<br>
&gt;&gt;&gt; relax (<a rel="nofollow" href="http://www.nmr-relax.com" target="_blank">http://www.nmr-relax.com</a>)<br>
&gt;&gt;&gt;<br>
&gt;&gt;&gt; This is the relax-devel mailing list<br>
&gt;&gt;&gt; <a rel="nofollow" href="mailto:relax-devel@xxxxxxx">relax-devel@xxxxxxx</a><br>
&gt;&gt;&gt;<br>
&gt;&gt;&gt; To unsubscribe from this list, get a password<br>
&gt;&gt;&gt; reminder, or change your subscription options,<br>
&gt;&gt;&gt; visit the list information page at<br>
&gt;&gt;&gt; <a rel="nofollow" href="https://mail.gna.org/listinfo/relax-devel" target="_blank">https://mail.gna.org/listinfo/relax-devel</a><br>
</div></div></blockquote></div><br></div>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00121" href="msg00121.html">Re: [sr #3045] Support for pooled standard deviation for: Peak	heights with partially replicated spectra</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00110" href="msg00110.html">[sr #3045] Support for pooled standard deviation for: Peak heights	with partially replicated spectra</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00111" href="msg00111.html">Re: [sr #3045] Support for pooled standard deviation for: Peak	heights with partially replicated spectra</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00113" href="msg00113.html">Re: [sr #3045] Support for pooled standard deviation for: Peak	heights with partially replicated spectra</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00114" href="msg00114.html">Re: [sr #3045] Support for pooled standard deviation for: Peak	heights with partially replicated spectra</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Wed Jun 19 17:20:07 2013</div>  
</body>
</html>
