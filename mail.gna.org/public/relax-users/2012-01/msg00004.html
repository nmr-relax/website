<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: Tensor Euler angles -->
<!--X-From-R13: "H.H." <iibfgevNtznvy.pbz> -->
<!--X-Date: Mon, 23 Jan 2012 19:29:06 +0100 -->
<!--X-Message-Id: CAO2iSXGBtU5OUE1T37C9NeN_JyiBynJf7X51835WPtgLYEsf8g@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: CAO2iSXG1UqpkzZSVRjPR&#45;WCj1nvmQOL9OEg&#45;EMT5kmMRdD+e9g@mail.gmail.com -->
<!--X-Reference: CAED9pY&#45;=U7gnggHudFRSKWUUTB1_wzg=1_PLcRBqw05URxtawA@mail.gmail.com -->
<!--X-Reference: CAO2iSXHaD44hf5mDuFOH1KvQt_TnDAwcm67eUcyEwunW&#45;oxudw@mail.gmail.com -->
<!--X-Reference: CAED9pY8SGxe_rF6RKWmXJwyXjrDhzcPZaw5b&#45;nrkX_Bp+OEYMg@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Tensor Euler angles -- January 23, 2012 - 19:29</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Tensor Euler angles</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00004" class="tabs">Index by Date</a> | <a href="threads.html#00004" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00003.html">Date Prev</a>] [<a href="msg00005.html">Date Next</a>] [<a href="msg00003.html">Thread Prev</a>] [<a href="msg00005.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Edward d'Auvergne&quot; &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Mon, 23 Jan 2012 12:28:15 -0600</li>
<li class="menuitem">
<em>Cc</em>: relax-users@xxxxxxx</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;	h=mime-version:in-reply-to:references:from:date:message-id:subject:to	:cc:content-type:content-transfer-encoding;	bh=4SHGu8YRd2KEmEZPAVSLySiWB+9UkMm+seDiqlR5TvE=;	b=qoGXSDLZjWz021jgl0FSiqxoPUSG/oJ4cBFIAEyTqnt20EGrcVyh9UaqoAcnPT+8pG	CrBPgLt7jRG1353E7FoMTtLUtBwQUxwwdEUgRMEMFYschD0yBRFaA/yySH7ME/5V/EIt	er8+W/wa+Cq2C6rCDpYEP2Z685qyf72sO78xs=</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00004.html">CAO2iSXGBtU5OUE1T37C9NeN_JyiBynJf7X51835WPtgLYEsf8g@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;CAO2iSXG1UqpkzZSVRjPR-WCj1nvmQOL9OEg-EMT5kmMRdD+e9g@xxxxxxxxxxxxxx&gt;	&lt;CAED9pY-=U7gnggHudFRSKWUUTB1_wzg=1_PLcRBqw05URxtawA@xxxxxxxxxxxxxx&gt;	&lt;CAO2iSXHaD44hf5mDuFOH1KvQt_TnDAwcm67eUcyEwunW-oxudw@xxxxxxxxxxxxxx&gt;	&lt;CAED9pY8SGxe_rF6RKWmXJwyXjrDhzcPZaw5b-nrkX_Bp+OEYMg@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>V.V.</strong> on January 23, 2012 - 19:29:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Thank you, Edward.

I will re-read the papers you mention to see if I misunderstood
something. My confusion is mostly about the fixed parameters. Please
correct me if I am wrong, but I thought that if the diffusion tensor
is initialized manually and is set as &quot;fixed&quot;, then the values in the
output should be the same as entered.

The protein I work on has a symmetry axis, and the initial diffusion
tensor estimation seemed to work quite well. I had mixed results with
the &quot;dauvergne_protocol.py&quot;, as in some instances the spheroid tensors
were converging with |Dratio| of 4e-3, which did not make a lot of
sense. The results also tended to oscillate extensively and in some
cases the calculations lasted through ~120 rounds. I was under the
impression that the tensor convergence was an issue and this was the
main reason for reverting to the individual scripts.

I use the data at three fields (R1, R2, NOE for two fields and R1, NOE
for the third).

Vitaly

On Mon, Jan 23, 2012 at 12:05, Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

This type of behaviour is to be expected.  I have described it in
detail in my 2008b paper:

d'Auvergne, E. J. and Gooley, P. R. (2008). Optimisation of NMR
dynamic models II. A new methodology for the dual optimisation of the
model-free parameters and the Brownian rotational diffusion tensor. J.
Biomol. NMR, 40(2), 121-133.
(<a  rel="nofollow" href="http://dx.doi.org/10.1007/s10858-007-9213-3">http://dx.doi.org/10.1007/s10858-007-9213-3</a>)

Specifically see figure 2.  That paper, as well as my review at
<a  rel="nofollow" href="http://dx.doi.org/10.1007/s10858-006-9007-z">http://dx.doi.org/10.1007/s10858-006-9007-z</a>, go into full detail about
what is happening here.  If you have a close look, you'll see that the
model-free models for your spin systems will be different at the end
of points 3. and 6.  What surprises me is how fast your tensor has
converged.  Normally this takes 5 to 10 iterations of steps 4-6 before
the tensor stabilises (see fig 2).  Though you could be sitting in a
shallow region of the dual optimisation-modelling space and subsequent
repetitions of steps 4-6 could cause your tensor to rotate widely
before convergence (you might need to read the above two references
before this sentence makes any sense).  Also, if you only have single
field strength data, it can be sometimes difficult to separate the
real diffusion tensor from the internal motions (both real and fake).
Just try to repeat steps 4-6 and see how many rounds it takes until
the chi-squared value is identical (to machine precision) between two
rounds.  Note that as this is a search through not only the
optimisation space but also the modelling space, that there may not be
one solution but a repetitive circling around a minima in this dual
space - you can see this as the chi2 value repeating itself
(identically) every 2nd, 3rd, etc. iteration.  I hope this explanation
wasn't too complicated.

Regards,

Edward



On 23 January 2012 18:44, V.V. &lt;vvostri@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Edward,

Thank you for the fast (as always) response.

The order of the calculation is the following:
1. Model-free fitting using an estimated diffusion tensor with
&quot;mf-multimodel.py&quot;.
2. Model selection with &quot;modsel.py&quot;.
3. Diffusion tensor optimization (first output). Chi2 = 167.466849
4. Adjustment of the diffusion tensor in &quot;mf-multimodel.py&quot; to the one in 
#3.
5. Model-free fitting as in #1 (second output).
6. Model selection as in #2. Chi2 = 166.606795

I am using the repository version. I am not sure about the exact
revision, but the last update I made was about 2 weeks ago.

My first guess was just as yours, that the tensors are identical and
the angle difference is just due to symmetry, but it does not seem to
be the case. I can forward the two pdbs if it will help.

Vitaly


On Mon, Jan 23, 2012 at 11:20, Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt; 
wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Vitaly,

Do you mean that if you start with two different starting points, you
end up with two different tensors?  For the different rounds of
iterations do you mean from the dauvergne_protocol.py script?  Are the
chi-squared values the same in both?  There might also have been a fix
for the diffusion tensor representation in more recent relax versions.
 Are you using the newest 1.3.13 version?  Running 'relax -i' will
give all the version info.  There are symmetries in the diffusion
tensor space, so two {theta, phi} pairs with different values can
represent exactly the same tensor.  Though the different tensors are
very strange, especially considering that the tm and Dratio values are
essentially identical!  Are you using Modelfree4 as a back end
optimisation engine?

Regards,

Edward


On 23 January 2012 18:03, V.V. &lt;vvostri@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Dear Edward,

I have encountered strange behavior with the initialization of the
diffusion tensor. I ran the first round of iterations, ending up with
the following oblate tensor:

===============================
Alternate parameters {tm, Dratio, theta, phi}.
tm (s):  9.486979075650368e-09
Dratio:  0.6141733435119592
theta (rad):  3.64621046835412
phi (rad):  1.9625997908540063
===============================

For the next round of model-free optimization, I have specified these
parameters manually:

===============================
diffusion_tensor.init((9.486979075650368e-09, 0.6141733435119592,
3.64621046835412, 1.9625997908540063), param_types=2,
spheroid_type='oblate', fixed=True)
===============================

Yet in this round the diffusion tensor was showing up with different
Theta and Phi angles:

===============================
Alternate parameters {tm, Dratio, theta, phi}.
tm (s):  9.486979075650368e-09
Dratio:  0.6141733435119593
theta (rad):  0.0636383778934639
phi (rad):  0.0342538282493545
===============================

I have generated pdbs of both tensors and they are not identical. Do
you have any suggestions what is causing this?

Thank you,
Vitaly
</pre></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00000" href="msg00000.html">Tensor Euler angles</a></strong>
<ul><li><em>From:</em> V.V.</li></ul></li>
<li><strong><a name="00001" href="msg00001.html">Re: Tensor Euler angles</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00002" href="msg00002.html">Re: Tensor Euler angles</a></strong>
<ul><li><em>From:</em> V.V.</li></ul></li>
<li><strong><a name="00003" href="msg00003.html">Re: Tensor Euler angles</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Mon Jan 30 20:00:11 2012</div>  
</body>
</html>
