<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: r2533 &#45; in /1.2: errors.py prompt/interpreter.py relax -->
<!--X-From-R13: Quevf [npDnvyq <p.n.znpenvyqNyrrqf.np.hx> -->
<!--X-Date: Fri, 11 Aug 2006 11:27:47 +0200 -->
<!--X-Message-Id: 1155288109.28764.517.camel@fbsdpcu021 -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: E1GB7jy&#45;0002oT&#45;Rz@subversion.gna.org -->
<!--X-Reference: 7f080ed10608100351k224db22ftb3f5ebc1ecc7b452@mail.gmail.com -->
<!--X-Reference: 1155209240.28764.489.camel@fbsdpcu021 -->
<!--X-Reference: 7f080ed10608102339u4b9ba0e5p3ec0bc5a3775435e@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: r2533 - in /1.2: errors.py prompt/interpreter.py relax -- August 11, 2006 - 11:27</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: r2533 - in /1.2: errors.py prompt/interpreter.py relax</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00058" class="tabs">Index by Date</a> | <a href="threads.html#00058" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00057.html">Date Prev</a>] [<a href="msg00059.html">Date Next</a>] [<a href="msg00055.html">Thread Prev</a>] [<a href="msg00059.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;, relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Date</em>: Fri, 11 Aug 2006 10:21:49 +0100</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00058.html">1155288109.28764.517.camel@fbsdpcu021</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;E1GB7jy-0002oT-Rz@subversion.gna.org&gt;	&lt;<a href="msg00053.html">7f080ed10608100351k224db22ftb3f5ebc1ecc7b452@mail.gmail.com</a>&gt;	&lt;<a href="msg00054.html">1155209240.28764.489.camel@fbsdpcu021</a>&gt;	&lt;<a href="msg00055.html">7f080ed10608102339u4b9ba0e5p3ec0bc5a3775435e@mail.gmail.com</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Chris MacRaild</strong> on August 11, 2006 - 11:27:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">On Fri, 2006-08-11 at 16:39 +1000, Edward d'Auvergne wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">On 8/10/06, Chris MacRaild wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">On Thu, 2006-08-10 at 20:51 +1000, Edward d'Auvergne wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Thanks.  I have a suggestion to simplify the state saving code and
that is that the save_state function is called within the BaseError
class.  This means that save_state is only called from one place in
the code by placing it within the __str__ function (which is called to
get the error message).  For example something like:

    class BaseError(Exception):
        def __str__(self):
            # Save the program state.
            if Debug:
                self.save_state()

            # The RelaxError message.
            return (&quot;RelaxError: &quot; + self.text + &quot;\n&quot;)
</pre></blockquote><pre style="margin: 0em;">

There are a couple of reasons I didn't do it this way. One is that
__str__ is a 'special' function as far as Python is concerned, and it
exists for a specific purpose (same with all the double-underscore
functions). Although it's difficult to imagine how it might cause
problems in this case, I'm inclined to avoid messing with it on
principle.
</pre></blockquote><pre style="margin: 0em;">

Too late, I've already destroyed it ;)  I replaced it so that it
returns the specific RelaxError message generated and stored in
'self.text'.  I think the only problem with this special '__str__()'
function is that if it generates an error, you're in big trouble.
</pre></blockquote><pre style="margin: 0em;">

You havn't destroyed it. The special purpose of self.__str__() is to
return a string representation of self (ie. the current instance of the
class). This is exactly what __str__() does, as it stands. You have
overridden the __str__() inherited from the parent class (Exception) to
give a more meaningful string representation of the various RelaxErrors.
This is exactly the intended use of this special function. The mistake
would be to add additional behaviour to this function which is not
related to the string representation. To give an example of how it might
cause confusion, imagine a case where we wanted to downgrade a
particular RelaxError to a RelaxWarning at run time. To do this, we
might insert the following:

try:
    do_something_bugy()
except RelaxError:
    err = sys.exc_info()
    msg = err[1].__str__()
    warn(RelaxWarning(msg))
finally:
    del err

This gets the exception instance from sys.exc_info, and explicitly gets
the string representation to use it as a warning message, so we get the
relevant message, even though we havn't raised the exception. Of course
we dont expect this code to cause a state.save(), as it would if that
code was included in __str__()

Chris




</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00059" href="msg00059.html">Re: r2533 - in /1.2: errors.py prompt/interpreter.py relax</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00053" href="msg00053.html">Re: r2533 - in /1.2: errors.py prompt/interpreter.py relax</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00054" href="msg00054.html">Re: r2533 - in /1.2: errors.py prompt/interpreter.py relax</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00055" href="msg00055.html">Re: r2533 - in /1.2: errors.py prompt/interpreter.py relax</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Fri Aug 11 15:40:37 2006</div>  
</body>
</html>
