<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: [sr #3117] Functionality to inspect interactively after running	script &#45; The equivalence to python &#45;i -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Fri, 14 Feb 2014 10:47:06 +0100 -->
<!--X-Message-Id: CAED9pY89ZP6YAhqM_hsGbFH6rE61WaTk&#45;pL9AsV6eNiUc1Nuug@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20140213&#45;114757.sv20529.7323@gna.org -->
<!--X-Reference: 20140213&#45;164825.sv20529.67050@gna.org -->
<!--X-Reference: CAED9pY&#45;pF1cPK+2bGHt4K8JEJPO7h&#45;Hn2mfaa=gez6m90XXaPg@mail.gmail.com -->
<!--X-Reference: CA+CBx2NSSyg3B9bPRkzJfeB=kuOXuOfXT4PdnmGRsfbc0p4L3g@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [sr #3117] Functionality to inspect interactively after running	script - The equivalence to python -i -- February 14, 2014 - 10:47</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: [sr #3117] Functionality to inspect interactively after running	script - The equivalence to python -i</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00071" class="tabs">Index by Date</a> | <a href="threads.html#00071" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00070.html">Date Prev</a>] [<a href="msg00072.html">Date Next</a>] [<a href="msg00069.html">Thread Prev</a>] [<a href="msg00072.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Fri, 14 Feb 2014 10:46:34 +0100</li>
<li class="menuitem">
<em>Cc</em>: Chris MacRaild &lt;c.macraild@xxxxxxxxxxxxxx&gt;,	&quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113;	h=mime-version:sender:in-reply-to:references:date:message-id:subject	:from:to:cc:content-type:content-transfer-encoding;	bh=5TkB95F0gN4945us7pFu7OZNUStqMA/Q11/Wf3AcV2I=;	b=SMUnKPNl+iKzA9Hm4J/qMdHXo+yC50z3Fi1mVXmiBmzhj+vlIJHRns9GtDagnslWJb	IqcFybvkjCVQWbk6kUiilVULCbJzov10KWDHcznye9qklZu4Zhne2k9qnwZWs07EkE2X	grSY21nPaD/PCgSqAAZSlkj39bhtazlHysdOy5tiQQZAAn1Gz9YUHQIXd39kLOwUkPhD	7Ze+six4OnmhYY7d+q5MCJuze0abD1kGRbkIY15g8DPrl8XiIxZRO782Zo1v4nwNLP6y	rY4sXnSqCISXvOmGDPbJVv6zhjcSgPPau/bLEiOWtvLq4Ihqrxq4SC1+si9sXLaPD6rU	0JWA==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00071.html">CAED9pY89ZP6YAhqM_hsGbFH6rE61WaTk-pL9AsV6eNiUc1Nuug@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;20140213-114757.sv20529.7323@xxxxxxx&gt;	&lt;20140213-164825.sv20529.67050@xxxxxxx&gt;	&lt;CAED9pY-pF1cPK+2bGHt4K8JEJPO7h-Hn2mfaa=gez6m90XXaPg@xxxxxxxxxxxxxx&gt;	&lt;CA+CBx2NSSyg3B9bPRkzJfeB=kuOXuOfXT4PdnmGRsfbc0p4L3g@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on February 14, 2014 - 10:47:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi,

This is rather simple:

- First execute the run_script() function to have the script execute
prior to reaching the prompt.

- Then execute the prompt() function.

Without the prompt() function call, the Python execution will just run
to the end of the relax.py file and terminate.  The prompt() function
call prevents this by jumping into the interpreter mode.  The
interpreter mode is then exited with the special objects 'q', 'quit',
'exit', and 'bye' and [Ctrl-D].  These commands cause the prompt()
function to be exited, allowing the Python execution to run to the end
of the relax.py file and quit.  As an aside, if you look you'll see
that this implementation (the _Exit class/object) is not ideal as it
uses sys.exit(), which really should never be used - this is simply
ancient code which should one day be updated.

So what you need is that when a script is supplied together with the
--prompt argument, then you just run both of these, one after the
other.  That's what the pseudo-code I suggested does
(<a  rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.devel/5000/focus=5008">http://thread.gmane.org/gmane.science.nmr.relax.devel/5000/focus=5008</a>).
 I quickly tested running one function after the other and it works.
You don't need to worry about returning the status from the
run_script() function, as that's not used in relax yet.  But
eventually to allow for proper terminal behaviour, relax will one day
return a status value to the terminal.  The user combinations for
running relax would be:

- No arguments:  Run prompt(),
- Only the -p, --prompt arguments:  Run prompt(),
- Only a script file:  Run run_script(),
- Both the -p, --prompt arguments and a script file:  Run run_script()
then prompt().

I hope this is now clearer.

Regards,

Edward


On 14 February 2014 10:14, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt; 
wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Edward.

Thank you for the suggestions, which I will implement.

I wonder about the pseudo code.

My problem is that I don't know how to parse the script to the prompt?
Does the prompt needs to be modified to run the given script?

Best
Troels


2014-02-13 18:03 GMT+01:00 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:

</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

The idea in the patch looks ok.  It's worth discussing on the list the
idea though, rather than relying on reading the patch itself.  The
--pedantic flag activates this feature that Chris MacRaild added to
relax back in 2006.  So I gather that the suggestion is to change the
argument:

-p, --pedantic, escalate all warnings to errors

to:

-e, --escalate, escalate all warnings to errors

I guess this is reasonable.  I suggest committing just that change as
one commit yourself.  The current patch also includes the argument:

-p, --prompt, 'Execute the given script and continue into the prompt
mode to allow for interactive inspection'

This should be in a separate commit.  Also, the first letter of the
help text should be in lowercase to match the rest of the help system.
 There is also a problem with the logic of the if-else statement in
the run() method.  I would suggest the pseudo-code:

if script:
    script_status = run_script()
if not script or (script and status.prompt):
    prompt()

So essentially two commits, the first renaming --pedantic, the second
adding the --prompt argument and logic.  What do you think?

Regards,

Edward




On 13 February 2014 17:48, Troels E. Linnet
&lt;NO-REPLY.INVALID-ADDRESS@xxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Follow-up Comment #1, sr #3117 (project relax):

This follows the discussion at:
<a  rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.devel/5000">http://thread.gmane.org/gmane.science.nmr.relax.devel/5000</a>

The next step would be to figure out to run the code and stay in the
interpreter.
Is it necessary to write a new function?

Initial pathc applied.

(file #20034)
    _______________________________________________________

Additional Item Attachment:

File name: first.patch                    Size:5 KB


    _______________________________________________________

Reply to this item at:

  &lt;<a  rel="nofollow" href="http://gna.org/support/?3117">http://gna.org/support/?3117</a>&gt;

_______________________________________________
  Message sent via/by Gna!
  <a  rel="nofollow" href="http://gna.org/">http://gna.org/</a>


_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-devel mailing list
relax-devel@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a>
</pre></blockquote></blockquote><pre style="margin: 0em;">


</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00072" href="msg00072.html">Re: [sr #3117] Functionality to inspect interactively after running	script - The equivalence to python -i</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00059" href="msg00059.html">[sr #3117] Functionality to inspect interactively after running	script - The equivalence to python -i</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00065" href="msg00065.html">[sr #3117] Functionality to inspect interactively after running	script - The equivalence to python -i</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00067" href="msg00067.html">Re: [sr #3117] Functionality to inspect interactively after running	script - The equivalence to python -i</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00069" href="msg00069.html">Re: [sr #3117] Functionality to inspect interactively after running	script - The equivalence to python -i</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Fri Feb 14 11:00:11 2014</div>  
</body>
</html>
