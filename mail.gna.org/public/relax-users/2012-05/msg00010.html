<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: Nested exception from sub processor -->
<!--X-From-R13: "H.H." <iibfgevNtznvy.pbz> -->
<!--X-Date: Fri, 11 May 2012 19:57:07 +0200 -->
<!--X-Message-Id: CAO2iSXEZ4VSbe9ekUxYwew4=hchZT8HtuCjm0Q3TYuVWDPnVLg@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: CAO2iSXE1ycB4KX1vxqk15CxbW1rpWczZAyR_bX1g6j+yA2PCTQ@mail.gmail.com -->
<!--X-Reference: CAO2iSXEaqLD78c1pYMbPUo+Owa+obAOMMXz6JZBLzGJ7tkvL1A@mail.gmail.com -->
<!--X-Reference: CAED9pY8rCA88zDJ8tNfjwWsF&#45;bjOGvewGDd4bnuqSE5pM_QbQQ@mail.gmail.com -->
<!--X-Reference: CAO2iSXGW&#45;0&#45;QfiV+0bsU9Wdv4PZjj&#45;L9+9iODhFk8D7pqE_dmw@mail.gmail.com -->
<!--X-Reference: CAED9pY9PAZ=vYnX4HpVweEd1httNyMgv0RKv7t60TEX+m&#45;Z77A@mail.gmail.com -->
<!--X-Reference: CAED9pY&#45;SqaS4oA=wy10KSTOW41WS_ODzhq6E1GsdLg1fvjbNzg@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Nested exception from sub processor -- May 11, 2012 - 19:57</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Nested exception from sub processor</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00010" class="tabs">Index by Date</a> | <a href="threads.html#00010" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00009.html">Date Prev</a>] [<a href="msg00011.html">Date Next</a>] [<a href="msg00002.html">Thread Prev</a>] [<a href="msg00019.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Edward d'Auvergne&quot; &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Fri, 11 May 2012 12:56:17 -0500</li>
<li class="menuitem">
<em>Cc</em>: relax-users@xxxxxxx</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113;	h=mime-version:in-reply-to:references:from:date:message-id:subject:to	:cc:content-type:content-transfer-encoding;	bh=eWNjiYGMr9tyf+L+7bokeocaCCdG6oSPjgPP3mQpLIc=;	b=04AFdwZswKeBBgHtuwSP+hbki0CdZfALmBlvp/LNtvZ8ltVaTMiLgz/7D92inG+uBE	6SD+5xl0uGkrRQYWR47/lrrv2ZYUcOjvGo6L2Cgh6WUNz+FcTM62NZzE/YvfyKiWI+0f	nr6FvleY3j++s5rc1X5zUP+wgKg4/0aCLL+L3GaHmyy5gP/asShPLT1dewH41ymaISKu	XmoNp5jRDLEVmP6ovomd7dEqZGT7G/uvSP+wIidp129Vk/lc2uXn31AFLMvJlCf3H5Wt	qxkcPB+HK/JJr3vuFGaRi9RgUVdDnu3/6w06L23wlNIHR85WeVxBtnQlJrspk/hIohBZ	JSiQ==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00010.html">CAO2iSXEZ4VSbe9ekUxYwew4=hchZT8HtuCjm0Q3TYuVWDPnVLg@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;CAO2iSXE1ycB4KX1vxqk15CxbW1rpWczZAyR_bX1g6j+yA2PCTQ@xxxxxxxxxxxxxx&gt;	&lt;CAO2iSXEaqLD78c1pYMbPUo+Owa+obAOMMXz6JZBLzGJ7tkvL1A@xxxxxxxxxxxxxx&gt;	&lt;CAED9pY8rCA88zDJ8tNfjwWsF-bjOGvewGDd4bnuqSE5pM_QbQQ@xxxxxxxxxxxxxx&gt;	&lt;CAO2iSXGW-0-QfiV+0bsU9Wdv4PZjj-L9+9iODhFk8D7pqE_dmw@xxxxxxxxxxxxxx&gt;	&lt;CAED9pY9PAZ=vYnX4HpVweEd1httNyMgv0RKv7t60TEX+m-Z77A@xxxxxxxxxxxxxx&gt;	&lt;CAED9pY-SqaS4oA=wy10KSTOW41WS_ODzhq6E1GsdLg1fvjbNzg@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>V.V.</strong> on May 11, 2012 - 19:57:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi Edward,

I have updated relax to revision 16237. The &quot;ave=False&quot; flag is
working fine in the &quot;structure.read()&quot;, but when it comes to the
diffusion tensor optimization the error is returned:

File &quot;/home/vvostri/relax/math_fns/mf.py&quot;, line 80 in calc_spheroid_ci
data.ci[0] = 0.25 * data.three_dz2_one**2
ValueError: setting an array element with a sequence

Vitaly


On Wed, May 9, 2012 at 2:50 AM, Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt; 
wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Vitaly,

I have just made a change to the relax repository version to improve
remove this error message and replace it with an informative
RelaxError 
(<a  rel="nofollow" href="http://www.mail-archive.com/relax-commits@xxxxxxx/msg13833.html">http://www.mail-archive.com/relax-commits@xxxxxxx/msg13833.html</a>).
 I have added a check to the model-free analysis which will hopefully
catch the condition of multiple vectors loaded per spin.  Do you still
have copy of the repository?  If so, could you update it with 'svn up'
and check if this error message is improved?  If the message is clear,
I will then close the bug (<a  rel="nofollow" href="https://gna.org/bugs/?18807">https://gna.org/bugs/?18807</a>).

Cheers,

Edward


On 11 October 2011 22:16, Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

Thanks for that.  Setting the 'ave' flag to False is used in the other
parts of relax, specifically the N-state model analyses using RDCs,
PCSs, NOEs, etc.  Then each state or structure N has a separate bond
vector.  But for a model-free analysis, this has no use.

For your data, I would use the best of the NMR structures.  You could
compare this to an average, or to one of the other structures.  But
note that the calculation can take between 1 to 2 weeks to complete!
So doing this for 20 structures would be expensive.

Regards,

Edward


On 11 October 2011 21:52, V.V. &lt;vvostri@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Thank you, Edward (no problem about the delay). I have submitted the
bug report (#18807). I am just curious: is there any practical use for
the &quot;ave=False&quot; flag then?
As far as my data analysis goes, I can separate the NMR ensemble into
the individual models and run the calculations on each of them. Does
this sound like a reasonable approach?

Vitaly

On Tue, Oct 11, 2011 at 14:39, Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt; 
wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

Sorry for the delay there.  I've been quite busy lately.  The problem
is that I'm pretty sure that the model-free analysis is not set up to
handle multiple vectors.  This lies within the theory itself.  The
bond vector should be in the centre of the cone or whatever the vector
distribution is.  To be able to use multiple vectors would require
digging into the model-free theory and modifying it.  Therefore the
vectors should be averaged or a single structure used.  I am surprised
that relax allows the calculation to start without a RelaxError being
thrown.  I will modify the code later to give such an error and
prevent the calculation from starting.  Thanks for pointing out this
error.  If you could submit it as a bug to
<a  rel="nofollow" href="https://gna.org/bugs/?func=additem&amp;group=relax">https://gna.org/bugs/?func=additem&amp;group=relax</a>, that would be very
useful if some else encounters the same problem.

Cheers,

Edward


On 11 October 2011 21:29, V.V. &lt;vvostri@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Looks like it is an issue with &quot;ave=False&quot; flag in
&quot;structure.vectors&quot;, rather then &quot;deselect.read&quot;. The NMR ensemble I
have consists of two structured domains, connected with a flexible
loop, i.e. the overall RMSD is fairly high and the N-H vectors in
different models are likely to be quite different. Can this be the
reason for the previously mentioned exception?

Thank you,
Vitaly


On Fri, Oct 7, 2011 at 15:28, V.V. &lt;vvostri@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Edward,

I am running &quot;dauvergne_protocol&quot; script for my protein. The
&quot;local_tm&quot; and &quot;sphere&quot; models calculations proceeded fine, but with
prolate/oblate/ellipsoid diffusion tensors an exception is thrown (the
output is below). I have run the same script successfully before. The
difference is that I have excluded several mobile residues and using
&quot;ave=False&quot; in &quot;structure.vectors&quot; (the pdb file is an NMR ensemble,
20 models). If necessary, I can send the input files separately. Relax
revision is 14809.

Thank you,
Vitaly

Traceback (most recent call last):
 File &quot;/home/vitalyv/relax/multi/uni_processor.py&quot;, line 136, in run
   self.callback.init_master(self)
 File &quot;/home/vitalyv/relax/multi/processor.py&quot;, line 263, in
default_init_master
   self.master.run()
 File &quot;/home/vitalyv/relax/relax.py&quot;, line 174, in run
   self.interpreter.run(self.script_file)
 File &quot;/home/vitalyv/relax/prompt/interpreter.py&quot;, line 300, in run
   return run_script(intro=self.__intro_string, local=locals(),
script_file=script_file, quit=self.__quit_flag,
show_script=self.__show_script,
raise_relax_error=self.__raise_relax_error)
 File &quot;/home/vitalyv/relax/prompt/interpreter.py&quot;, line 610, in 
run_script
   return console.interact(intro, local, script_file, quit,
show_script=show_script, raise_relax_error=raise_relax_error)
 File &quot;/home/vitalyv/relax/prompt/interpreter.py&quot;, line 495, in 
interact_script
   exec_script(script_file, local)
 File &quot;/home/vitalyv/relax/prompt/interpreter.py&quot;, line 383, in 
exec_script
   runpy.run_module(module, globals)
 File &quot;/usr/lib/python2.7/runpy.py&quot;, line 180, in run_module
   fname, loader, pkg_name)
 File &quot;/usr/lib/python2.7/runpy.py&quot;, line 72, in _run_code
   exec code in run_globals
 File &quot;/home/vitalyv/relax/wtpln/dauvergne_protocol.py&quot;, line 218, in 
&lt;module&gt;
   dAuvergne_protocol(pipe_name=name, diff_model=DIFF_MODEL,
mf_models=MF_MODELS, local_tm_models=LOCAL_TM_MODELS,
grid_inc=GRID_INC, min_algor=MIN_ALGOR, mc_sim_num=MC_NUM,
conv_loop=CONV_LOOP)
 File &quot;/home/vitalyv/relax/auto_analyses/dauvergne_protocol.py&quot;, line
223, in __init__
   self.execute()
 File &quot;/home/vitalyv/relax/auto_analyses/dauvergne_protocol.py&quot;, line
596, in execute
   self.interpreter.grid_search(inc=inc)
 File &quot;/home/vitalyv/relax/prompt/minimisation.py&quot;, line 106, in 
grid_search
   minimise.grid_search(lower=lower, upper=upper, inc=inc,
constraints=constraints, verbosity=verbosity)
 File &quot;/home/vitalyv/relax/generic_fns/minimise.py&quot;, line 146, in 
grid_search
   processor_box.processor.run_queue()
 File &quot;/home/vitalyv/relax/multi/uni_processor.py&quot;, line 149, in 
run_queue
   command.run(self, completed)
 File 
&quot;/home/vitalyv/relax/specific_fns/model_free/multi_processor_commands.py&quot;,
line 144, in run
   raise Capturing_exception(rank=processor.rank(), 
name=processor.get_name())
Capturing_exception:

------------------------------------------------------------------------------------------------------------------------

 File 
&quot;/home/vitalyv/relax/specific_fns/model_free/multi_processor_commands.py&quot;,
line 132, in run
   results = self.optimise()
 File 
&quot;/home/vitalyv/relax/specific_fns/model_free/multi_processor_commands.py&quot;,
line 185, in optimise
   results = grid_point_array(func=self.mf.func, args=(),
points=self.opt_params.subdivision,
verbosity=self.opt_params.verbosity)
 File &quot;/usr/lib/python2.7/site-packages/minfx/grid.py&quot;, line 282, in
grid_point_array
   f = func(*(points[k],)+args)
 File &quot;/home/vitalyv/relax/maths_fns/mf.py&quot;, line 517, in func_diff
   self.diff_data.calc_ci(data, self.diff_data)
 File &quot;/home/vitalyv/relax/maths_fns/weights.py&quot;, line 80, in 
calc_spheroid_ci
   data.ci[0] = 0.25 * data.three_dz2_one**2


Nested Exception from sub processor
Exception type: ValueError
Message: setting an array element with a sequence.

</pre></blockquote><pre style="margin: 0em;">

</pre></blockquote><pre style="margin: 0em;">

</pre></blockquote><pre style="margin: 0em;">

</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00019" href="msg00019.html">Re: Nested exception from sub processor</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00002" href="msg00002.html">Re: Nested exception from sub processor</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu May 24 10:20:09 2012</div>  
</body>
</html>
