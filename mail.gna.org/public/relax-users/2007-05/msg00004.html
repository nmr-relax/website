<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: model selection -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneq.qnhiretarNtznvy.pbz> -->
<!--X-Date: Tue, 08 May 2007 01:03:26 +0200 -->
<!--X-Message-Id: 7f080ed10705071602y5de92a15g5fb977ea6e8fae@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 1172829093.45e7f3a5c5ccd@imp2.webmail.hku.hk -->
<!--X-Reference: 7f080ed10703040822u588e9689r2faf47cfba37d021@mail.gmail.com -->
<!--X-Reference: 1177901186.4635588238653@imp4.webmail.hku.hk -->
<!--X-Reference: 4635F91A.9050704@nottingham.ac.uk -->
<!--X-Reference: 21DA0CF4&#45;86FB&#45;4D50&#45;94C9&#45;606EE70F42AB@gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: model selection -- May 08, 2007 - 01:03</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: model selection</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00004" class="tabs">Index by Date</a> | <a href="threads.html#00004" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00003.html">Date Prev</a>] [<a href="msg00005.html">Date Next</a>] [<a href="msg00002.html">Thread Prev</a>] [<a href="msg00003.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Douglas Kojetin&quot; &lt;douglas.kojetin@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Tue, 8 May 2007 01:02:48 +0200</li>
<li class="menuitem">
<em>Cc</em>: relax-users@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00004.html">7f080ed10705071602y5de92a15g5fb977ea6e8fae@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;1172829093.45e7f3a5c5ccd@xxxxxxxxxxxxxxxxxxx&gt;	&lt;7f080ed10703040822u588e9689r2faf47cfba37d021@xxxxxxxxxxxxxx&gt;	&lt;1177901186.4635588238653@xxxxxxxxxxxxxxxxxxx&gt;	&lt;4635F91A.9050704@xxxxxxxxxxxxxxxx&gt;	&lt;21DA0CF4-86FB-4D50-94C9-606EE70F42AB@xxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on May 08, 2007 - 01:03:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Douglas,

Did the suggestion by Clare help fix the issue?  Unless you have
modified the script, full_analysis.py takes your amino acid sequence
from the PDB file and hence the heteronuc='N', proton='H' arguments to
the 'pdb()' user function may need to be changed for your structure.
Otherwise if this is not the issue would you be able to create a bug
report at <a  rel="nofollow" href="https://gna.org/bugs/?func=additem&amp;group=relax">https://gna.org/bugs/?func=additem&amp;group=relax</a>?  Thanks.
Any additional information would be much appreciated.

Thanks,

Edward




On 4/30/07, Douglas Kojetin &lt;douglas.kojetin@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">
While we are on the topic of model selection/optimization, I am
having some trouble with relax 1.2's full_analysis.py script.  I have
optimized the local_tm run, and I ran the initial run on the oblate
tensor (init).  When I attempt to optimize the oblate run (round_1),
I see the following error a:

relax&gt; results.write(run='final', file='results', dir='oblate/round_1/
aic', force=1, format='columnar', compress_type=1)Opening the file
'oblate/round_1/aic/results.bz2' for writing.RelaxError: The sequence
data for the run 'final' does not exist.

Any ideas?

Thanks,
Doug


On Apr 30, 2007, at 10:11 AM, Clare-Louise Evans wrote:

&gt; Dear Edward,
&gt;
&gt; Sorry for the thread hijack, but I noticed in the PS section of the
&gt; quote Hongyan has included below your comment regarding convergence.
&gt;
&gt; I am having problems with convergence at the moment when running the
&gt; full_analysis.py script.  I have run the optimisation of the diffusion
&gt; models on the same PC.  For the oblate, prolate and ellipsoid models I
&gt; have failed to reach convergence after 30+ rounds.  The sphere model
&gt; converged within 5 rounds.  However, when I look at the output the
&gt; only
&gt; difference between the chi-squared and other parameter values is in
&gt; the
&gt; 10th and later decimal places.  Surely, with having such small
&gt; differences between the values they can be considered to have
&gt; converged.  However, in your comment you state they have to be
&gt; identical.  If this really is the case then I'm not sure how to
&gt; proceed
&gt; given that I'm failing to reach convergence on these 3 models?
&gt;
&gt; Apologies if this ties in to the question I asked yesterday regarding
&gt; full_analysis.py.
&gt;
&gt; Kind regards
&gt; Clare
&gt;
&gt; Hongyan Li wrote:
&gt;&gt; Dear Edward,
&gt;&gt; Thanks for your early suggestion regarding different model
&gt;&gt; selections. I have
&gt;&gt; been busy on other stuff and only recently got time to focus on
&gt;&gt; this subject
&gt;&gt; again.
&gt;&gt; I have run all the diffusion models e.g. isotropic, prolate,
&gt;&gt; oblate and
&gt;&gt; ellipsoid and model selections were made within each model (in aic
&gt;&gt; directory).
&gt;&gt; I am not sure how to write a script to select different models using
&gt;&gt; 'model_selection()'. Could you please do me a favor?
&gt;&gt; Your help is highly appreciated!
&gt;&gt; Best wishes,
&gt;&gt; Hongyan
&gt;&gt;
&gt;&gt; Quoting Edward d'Auvergne &lt;edward.dauvergne@xxxxxxxxx&gt;:
&gt;&gt;
&gt;&gt;
&gt;&gt;&gt; Hi,
&gt;&gt;&gt;
&gt;&gt;&gt; To compare the results what you need to employ is a technique
&gt;&gt;&gt; from the
&gt;&gt;&gt; statistical field of model selection.  The spherical diffusion
&gt;&gt;&gt; (isotropic) + all model-free models of all selected residues is one
&gt;&gt;&gt; single mathematical model.  The prolate and oblate spheroids
&gt;&gt;&gt; (prolate
&gt;&gt;&gt; and oblate axially symmetric anisotropic diffusion tensors) + all
&gt;&gt;&gt; model-free models, and the ellipsoid (fully anisotropic or three
&gt;&gt;&gt; different eigenvalues) + all model-free models, are three additional
&gt;&gt;&gt; mathematical models.  Therefore to compare these four different
&gt;&gt;&gt; models
&gt;&gt;&gt; you need to select the model which best represents your relaxation
&gt;&gt;&gt; data.  These models are, however, not nested and therefore cannot be
&gt;&gt;&gt; compared using ANOVA F-tests!  Firstly the three types of diffusion
&gt;&gt;&gt; tensor are not nested (there is a reference from Dominique Marion's
&gt;&gt;&gt; group in which they say ANOVA statistics cannot be used but I can't
&gt;&gt;&gt; find it at the moment (although it shouldn't be too hard to track
&gt;&gt;&gt; down, it's related to Tensor)).  Secondly the model-free models
&gt;&gt;&gt; selected will be different between the four models.  Hence chi-
&gt;&gt;&gt; squared
&gt;&gt;&gt; and F-tests cannot be used.
&gt;&gt;&gt;
&gt;&gt;&gt; A useful reference (I'm not at all biased ;) for this problem is my
&gt;&gt;&gt; paper d'Auvergne, E. J. and Gooley, P. R. (2003), (see
&gt;&gt;&gt; <a  rel="nofollow" href="http://www.nmr-relax.com/refs.html">http://www.nmr-relax.com/refs.html</a> for the full reference).  On page
&gt;&gt;&gt; 37 at the end of that paper I discuss how AIC model selection is
&gt;&gt;&gt; perfect for selecting between these non-nested models.  The AIC
&gt;&gt;&gt; criterion is still
&gt;&gt;&gt;
&gt;&gt;&gt; AIC = chi2 + 2k,
&gt;&gt;&gt;
&gt;&gt;&gt; however chi2 is the minimised chi-squared value for the complete
&gt;&gt;&gt; model
&gt;&gt;&gt; and k is the sum of the number of diffusion parameters and number of
&gt;&gt;&gt; model-free parameters for all spin systems.  BIC model selection is
&gt;&gt;&gt; likely to work quite well as well.  If you have four runs, one for
&gt;&gt;&gt; each of the diffusion models, then the relax user function
&gt;&gt;&gt; 'model_selection()' is designed to select between these models.  I
&gt;&gt;&gt; hope this helps and hasn't been too biased.
&gt;&gt;&gt;
&gt;&gt;&gt; Cheers,
&gt;&gt;&gt;
&gt;&gt;&gt; Edward
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; P.S.  Prior to model selection between the diffusion models, the
&gt;&gt;&gt; diffusion models must have fully converged.  Multiple iterations of
&gt;&gt;&gt; optimisation of the model-free models, AIC model selection, and
&gt;&gt;&gt; optimisation of all parameters together (diffusion tensor + model-
&gt;&gt;&gt; free
&gt;&gt;&gt; parameter of all residues) must be executed.  Convergence is when
&gt;&gt;&gt; two
&gt;&gt;&gt; iterations possess identical chi-squared values, identical model-
&gt;&gt;&gt; free
&gt;&gt;&gt; models, and identical parameter values.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; On 3/2/07, Hongyan Li &lt;hylichem@xxxxxxxxxxxx&gt; wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Dear relax users,
&gt;&gt;&gt;&gt; I have managed to use Relax to run my dynamics data by both
&gt;&gt;&gt;&gt; isotropic and
&gt;&gt;&gt;&gt; axial-oblate models. My qestion is how to compare the results, by
&gt;&gt;&gt;&gt;
&gt;&gt;&gt; chi-square??
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; what is the criteria to make judgment that which residues is beter
&gt;&gt;&gt;&gt;
&gt;&gt;&gt; simulated
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; with which model?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Thanks for your kind help!
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Best wishes,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Hongyan
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Dr. Hongyan Li
&gt;&gt;&gt;&gt; Department of Chemistry
&gt;&gt;&gt;&gt; The University of Hong Kong
&gt;&gt;&gt;&gt; Pokfulam Road
&gt;&gt;&gt;&gt; Hong Kong
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt;&gt; relax (<a  rel="nofollow" href="http://nmr-relax.com">http://nmr-relax.com</a>)
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; This is the relax-users mailing list
&gt;&gt;&gt;&gt; relax-users@xxxxxxx
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; To unsubscribe from this list, get a password
&gt;&gt;&gt;&gt; reminder, or change your subscription options,
&gt;&gt;&gt;&gt; visit the list information page at
&gt;&gt;&gt;&gt; <a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-users">https://mail.gna.org/listinfo/relax-users</a>
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; Dr. Hongyan Li
&gt;&gt; Department of Chemistry
&gt;&gt; The University of Hong Kong
&gt;&gt; Pokfulam Road
&gt;&gt; Hong Kong
&gt;&gt;
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; relax (<a  rel="nofollow" href="http://nmr-relax.com">http://nmr-relax.com</a>)
&gt;&gt;
&gt;&gt; This is the relax-users mailing list
&gt;&gt; relax-users@xxxxxxx
&gt;&gt;
&gt;&gt; To unsubscribe from this list, get a password
&gt;&gt; reminder, or change your subscription options,
&gt;&gt; visit the list information page at
&gt;&gt; <a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-users">https://mail.gna.org/listinfo/relax-users</a>
&gt;&gt;
&gt;
&gt; This message has been checked for viruses but the contents of an
&gt; attachment
&gt; may still contain software viruses, which could damage your
&gt; computer system:
&gt; you are advised to perform your own checks. Email communications
&gt; with the
&gt; University of Nottingham may be monitored as permitted by UK
&gt; legislation.
&gt;
&gt;
&gt; _______________________________________________
&gt; relax (<a  rel="nofollow" href="http://nmr-relax.com">http://nmr-relax.com</a>)
&gt;
&gt; This is the relax-users mailing list
&gt; relax-users@xxxxxxx
&gt;
&gt; To unsubscribe from this list, get a password
&gt; reminder, or change your subscription options,
&gt; visit the list information page at
&gt; <a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-users">https://mail.gna.org/listinfo/relax-users</a>


_______________________________________________
relax (<a  rel="nofollow" href="http://nmr-relax.com">http://nmr-relax.com</a>)

This is the relax-users mailing list
relax-users@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-users">https://mail.gna.org/listinfo/relax-users</a>

</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Tue May 08 01:20:46 2007</div>  
</body>
</html>
