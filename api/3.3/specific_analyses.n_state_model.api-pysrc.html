<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>specific_analyses.n_state_model.api</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
  <!--Google analytics JS-->
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30096326-1']);
    _gaq.push(['_setDomainName', 'nmr-relax.com']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="/">relax</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="specific_analyses-module.html">Package&nbsp;specific_analyses</a> ::
        <a href="specific_analyses.n_state_model-module.html">Package&nbsp;n_state_model</a> ::
        Module&nbsp;api
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="specific_analyses.n_state_model.api-pysrc.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<h1 class="epydoc">Source Code for <a href="specific_analyses.n_state_model.api-module.html">Module specific_analyses.n_state_model.api</a></h1>
<pre class="py-src">
<a name="L1"></a><tt class="py-lineno">  1</tt>  <tt class="py-line"><tt class="py-comment">###############################################################################</tt> </tt>
<a name="L2"></a><tt class="py-lineno">  2</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L3"></a><tt class="py-lineno">  3</tt>  <tt class="py-line"><tt class="py-comment"># Copyright (C) 2007-2015 Edward d'Auvergne                                   #</tt> </tt>
<a name="L4"></a><tt class="py-lineno">  4</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L5"></a><tt class="py-lineno">  5</tt>  <tt class="py-line"><tt class="py-comment"># This file is part of the program relax (http://www.nmr-relax.com).          #</tt> </tt>
<a name="L6"></a><tt class="py-lineno">  6</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L7"></a><tt class="py-lineno">  7</tt>  <tt class="py-line"><tt class="py-comment"># This program is free software: you can redistribute it and/or modify        #</tt> </tt>
<a name="L8"></a><tt class="py-lineno">  8</tt>  <tt class="py-line"><tt class="py-comment"># it under the terms of the GNU General Public License as published by        #</tt> </tt>
<a name="L9"></a><tt class="py-lineno">  9</tt>  <tt class="py-line"><tt class="py-comment"># the Free Software Foundation, either version 3 of the License, or           #</tt> </tt>
<a name="L10"></a><tt class="py-lineno"> 10</tt>  <tt class="py-line"><tt class="py-comment"># (at your option) any later version.                                         #</tt> </tt>
<a name="L11"></a><tt class="py-lineno"> 11</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L12"></a><tt class="py-lineno"> 12</tt>  <tt class="py-line"><tt class="py-comment"># This program is distributed in the hope that it will be useful,             #</tt> </tt>
<a name="L13"></a><tt class="py-lineno"> 13</tt>  <tt class="py-line"><tt class="py-comment"># but WITHOUT ANY WARRANTY; without even the implied warranty of              #</tt> </tt>
<a name="L14"></a><tt class="py-lineno"> 14</tt>  <tt class="py-line"><tt class="py-comment"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the               #</tt> </tt>
<a name="L15"></a><tt class="py-lineno"> 15</tt>  <tt class="py-line"><tt class="py-comment"># GNU General Public License for more details.                                #</tt> </tt>
<a name="L16"></a><tt class="py-lineno"> 16</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L17"></a><tt class="py-lineno"> 17</tt>  <tt class="py-line"><tt class="py-comment"># You should have received a copy of the GNU General Public License           #</tt> </tt>
<a name="L18"></a><tt class="py-lineno"> 18</tt>  <tt class="py-line"><tt class="py-comment"># along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.       #</tt> </tt>
<a name="L19"></a><tt class="py-lineno"> 19</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L20"></a><tt class="py-lineno"> 20</tt>  <tt class="py-line"><tt class="py-comment">###############################################################################</tt> </tt>
<a name="L21"></a><tt class="py-lineno"> 21</tt>  <tt class="py-line"> </tt>
<a name="L22"></a><tt class="py-lineno"> 22</tt>  <tt class="py-line"><tt class="py-comment"># Module docstring.</tt> </tt>
<a name="L23"></a><tt class="py-lineno"> 23</tt>  <tt class="py-line"><tt class="py-docstring">"""The N-state model or structural ensemble analysis."""</tt> </tt>
<a name="L24"></a><tt class="py-lineno"> 24</tt>  <tt class="py-line"> </tt>
<a name="L25"></a><tt class="py-lineno"> 25</tt>  <tt class="py-line"><tt class="py-comment"># Python module imports.</tt> </tt>
<a name="L26"></a><tt class="py-lineno"> 26</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-0" class="py-name" targets="Function pipe_control.align_tensor.copy()=pipe_control.align_tensor-module.html#copy,Function pipe_control.diffusion_tensor.copy()=pipe_control.diffusion_tensor-module.html#copy,Function pipe_control.interatomic.copy()=pipe_control.interatomic-module.html#copy,Function pipe_control.j_coupling.copy()=pipe_control.j_coupling-module.html#copy,Function pipe_control.pcs.copy()=pipe_control.pcs-module.html#copy,Function pipe_control.pipes.copy()=pipe_control.pipes-module.html#copy,Function pipe_control.rdc.copy()=pipe_control.rdc-module.html#copy,Function pipe_control.relax_data.copy()=pipe_control.relax_data-module.html#copy,Function pipe_control.sequence.copy()=pipe_control.sequence-module.html#copy,Function pipe_control.value.copy()=pipe_control.value-module.html#copy,Function specific_analyses.relax_disp.parameters.copy()=specific_analyses.relax_disp.parameters-module.html#copy"><a title="pipe_control.align_tensor.copy
pipe_control.diffusion_tensor.copy
pipe_control.interatomic.copy
pipe_control.j_coupling.copy
pipe_control.pcs.copy
pipe_control.pipes.copy
pipe_control.rdc.copy
pipe_control.relax_data.copy
pipe_control.sequence.copy
pipe_control.value.copy
specific_analyses.relax_disp.parameters.copy" class="py-name" href="#" onclick="return doclink('link-0', 'copy', 'link-0');">copy</a></tt> <tt class="py-keyword">import</tt> <tt class="py-name">deepcopy</tt> </tt>
<a name="L27"></a><tt class="py-lineno"> 27</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-1" class="py-name" targets="Package minfx=minfx-module.html"><a title="minfx" class="py-name" href="#" onclick="return doclink('link-1', 'minfx', 'link-1');">minfx</a></tt><tt class="py-op">.</tt><tt id="link-2" class="py-name" targets="Module minfx.generic=minfx.generic-module.html,Module test_suite.system_tests.generic=test_suite.system_tests.generic-module.html"><a title="minfx.generic
test_suite.system_tests.generic" class="py-name" href="#" onclick="return doclink('link-2', 'generic', 'link-2');">generic</a></tt> <tt class="py-keyword">import</tt> <tt id="link-3" class="py-name" targets="Function minfx.generic.generic_minimise()=minfx.generic-module.html#generic_minimise"><a title="minfx.generic.generic_minimise" class="py-name" href="#" onclick="return doclink('link-3', 'generic_minimise', 'link-3');">generic_minimise</a></tt> </tt>
<a name="L28"></a><tt class="py-lineno"> 28</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-4" class="py-name"><a title="minfx" class="py-name" href="#" onclick="return doclink('link-4', 'minfx', 'link-1');">minfx</a></tt><tt class="py-op">.</tt><tt id="link-5" class="py-name" targets="Module gui.components.grid=gui.components.grid-module.html,Module minfx.grid=minfx.grid-module.html,Function minfx.grid.grid()=minfx.grid-module.html#grid"><a title="gui.components.grid
minfx.grid
minfx.grid.grid" class="py-name" href="#" onclick="return doclink('link-5', 'grid', 'link-5');">grid</a></tt> <tt class="py-keyword">import</tt> <tt id="link-6" class="py-name"><a title="gui.components.grid
minfx.grid
minfx.grid.grid" class="py-name" href="#" onclick="return doclink('link-6', 'grid', 'link-5');">grid</a></tt> </tt>
<a name="L29"></a><tt class="py-lineno"> 29</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">numpy</tt> <tt class="py-keyword">import</tt> <tt class="py-name">dot</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">,</tt> <tt class="py-name">zeros</tt> </tt>
<a name="L30"></a><tt class="py-lineno"> 30</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">re</tt> <tt class="py-keyword">import</tt> <tt id="link-7" class="py-name" targets="Function lib.regex.search()=lib.regex-module.html#search"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-7', 'search', 'link-7');">search</a></tt> </tt>
<a name="L31"></a><tt class="py-lineno"> 31</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-8" class="py-name" targets="Module lib.warnings=lib.warnings-module.html"><a title="lib.warnings" class="py-name" href="#" onclick="return doclink('link-8', 'warnings', 'link-8');">warnings</a></tt> <tt class="py-keyword">import</tt> <tt class="py-name">warn</tt> </tt>
<a name="L32"></a><tt class="py-lineno"> 32</tt>  <tt class="py-line"> </tt>
<a name="L33"></a><tt class="py-lineno"> 33</tt>  <tt class="py-line"><tt class="py-comment"># relax module imports.</tt> </tt>
<a name="L34"></a><tt class="py-lineno"> 34</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt id="link-9" class="py-name" targets="Package lib=lib-module.html"><a title="lib" class="py-name" href="#" onclick="return doclink('link-9', 'lib', 'link-9');">lib</a></tt><tt class="py-op">.</tt><tt id="link-10" class="py-name" targets="Module lib.arg_check=lib.arg_check-module.html"><a title="lib.arg_check" class="py-name" href="#" onclick="return doclink('link-10', 'arg_check', 'link-10');">arg_check</a></tt> </tt>
<a name="L35"></a><tt class="py-lineno"> 35</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-11" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-11', 'lib', 'link-9');">lib</a></tt><tt class="py-op">.</tt><tt id="link-12" class="py-name" targets="Module gui.errors=gui.errors-module.html,Module lib.errors=lib.errors-module.html,Module minfx.errors=minfx.errors-module.html"><a title="gui.errors
lib.errors
minfx.errors" class="py-name" href="#" onclick="return doclink('link-12', 'errors', 'link-12');">errors</a></tt> <tt class="py-keyword">import</tt> <tt id="link-13" class="py-name" targets="Class lib.errors.RelaxError=lib.errors.RelaxError-class.html"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-13', 'RelaxError', 'link-13');">RelaxError</a></tt><tt class="py-op">,</tt> <tt id="link-14" class="py-name" targets="Class lib.errors.RelaxInfError=lib.errors.RelaxInfError-class.html"><a title="lib.errors.RelaxInfError" class="py-name" href="#" onclick="return doclink('link-14', 'RelaxInfError', 'link-14');">RelaxInfError</a></tt><tt class="py-op">,</tt> <tt id="link-15" class="py-name" targets="Class lib.errors.RelaxNaNError=lib.errors.RelaxNaNError-class.html"><a title="lib.errors.RelaxNaNError" class="py-name" href="#" onclick="return doclink('link-15', 'RelaxNaNError', 'link-15');">RelaxNaNError</a></tt><tt class="py-op">,</tt> <tt id="link-16" class="py-name" targets="Class lib.errors.RelaxNoModelError=lib.errors.RelaxNoModelError-class.html"><a title="lib.errors.RelaxNoModelError" class="py-name" href="#" onclick="return doclink('link-16', 'RelaxNoModelError', 'link-16');">RelaxNoModelError</a></tt> </tt>
<a name="L36"></a><tt class="py-lineno"> 36</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-17" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-17', 'lib', 'link-9');">lib</a></tt><tt class="py-op">.</tt><tt id="link-18" class="py-name" targets="Module lib.float=lib.float-module.html"><a title="lib.float" class="py-name" href="#" onclick="return doclink('link-18', 'float', 'link-18');">float</a></tt> <tt class="py-keyword">import</tt> <tt id="link-19" class="py-name" targets="Function lib.float.isNaN()=lib.float-module.html#isNaN"><a title="lib.float.isNaN" class="py-name" href="#" onclick="return doclink('link-19', 'isNaN', 'link-19');">isNaN</a></tt><tt class="py-op">,</tt> <tt id="link-20" class="py-name" targets="Function lib.float.isInf()=lib.float-module.html#isInf"><a title="lib.float.isInf" class="py-name" href="#" onclick="return doclink('link-20', 'isInf', 'link-20');">isInf</a></tt> </tt>
<a name="L37"></a><tt class="py-lineno"> 37</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-21" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-21', 'lib', 'link-9');">lib</a></tt><tt class="py-op">.</tt><tt id="link-22" class="py-name"><a title="lib.warnings" class="py-name" href="#" onclick="return doclink('link-22', 'warnings', 'link-8');">warnings</a></tt> <tt class="py-keyword">import</tt> <tt id="link-23" class="py-name" targets="Class lib.warnings.RelaxWarning=lib.warnings.RelaxWarning-class.html"><a title="lib.warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-23', 'RelaxWarning', 'link-23');">RelaxWarning</a></tt> </tt>
<a name="L38"></a><tt class="py-lineno"> 38</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-24" class="py-name" targets="Package pipe_control=pipe_control-module.html"><a title="pipe_control" class="py-name" href="#" onclick="return doclink('link-24', 'pipe_control', 'link-24');">pipe_control</a></tt> <tt class="py-keyword">import</tt> <tt id="link-25" class="py-name" targets="Module data_store.align_tensor=data_store.align_tensor-module.html,Module pipe_control.align_tensor=pipe_control.align_tensor-module.html,Module test_suite.system_tests.align_tensor=test_suite.system_tests.align_tensor-module.html,Module user_functions.align_tensor=user_functions.align_tensor-module.html"><a title="data_store.align_tensor
pipe_control.align_tensor
test_suite.system_tests.align_tensor
user_functions.align_tensor" class="py-name" href="#" onclick="return doclink('link-25', 'align_tensor', 'link-25');">align_tensor</a></tt><tt class="py-op">,</tt> <tt id="link-26" class="py-name" targets="Module lib.alignment.pcs=lib.alignment.pcs-module.html,Module pipe_control.pcs=pipe_control.pcs-module.html,Module test_suite.system_tests.pcs=test_suite.system_tests.pcs-module.html,Module user_functions.pcs=user_functions.pcs-module.html"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-26', 'pcs', 'link-26');">pcs</a></tt><tt class="py-op">,</tt> <tt id="link-27" class="py-name" targets="Module lib.alignment.rdc=lib.alignment.rdc-module.html,Module pipe_control.rdc=pipe_control.rdc-module.html,Module test_suite.system_tests.rdc=test_suite.system_tests.rdc-module.html,Module user_functions.rdc=user_functions.rdc-module.html"><a title="lib.alignment.rdc
pipe_control.rdc
test_suite.system_tests.rdc
user_functions.rdc" class="py-name" href="#" onclick="return doclink('link-27', 'rdc', 'link-27');">rdc</a></tt> </tt>
<a name="L39"></a><tt class="py-lineno"> 39</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-28" class="py-name"><a title="pipe_control" class="py-name" href="#" onclick="return doclink('link-28', 'pipe_control', 'link-24');">pipe_control</a></tt><tt class="py-op">.</tt><tt id="link-29" class="py-name"><a title="data_store.align_tensor
pipe_control.align_tensor
test_suite.system_tests.align_tensor
user_functions.align_tensor" class="py-name" href="#" onclick="return doclink('link-29', 'align_tensor', 'link-25');">align_tensor</a></tt> <tt class="py-keyword">import</tt> <tt id="link-30" class="py-name" targets="Function pipe_control.align_tensor.opt_uses_align_data()=pipe_control.align_tensor-module.html#opt_uses_align_data,Function specific_analyses.frame_order.optimisation.opt_uses_align_data()=specific_analyses.frame_order.optimisation-module.html#opt_uses_align_data"><a title="pipe_control.align_tensor.opt_uses_align_data
specific_analyses.frame_order.optimisation.opt_uses_align_data" class="py-name" href="#" onclick="return doclink('link-30', 'opt_uses_align_data', 'link-30');">opt_uses_align_data</a></tt><tt class="py-op">,</tt> <tt id="link-31" class="py-name" targets="Function pipe_control.align_tensor.opt_uses_tensor()=pipe_control.align_tensor-module.html#opt_uses_tensor"><a title="pipe_control.align_tensor.opt_uses_tensor" class="py-name" href="#" onclick="return doclink('link-31', 'opt_uses_tensor', 'link-31');">opt_uses_tensor</a></tt> </tt>
<a name="L40"></a><tt class="py-lineno"> 40</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-32" class="py-name"><a title="pipe_control" class="py-name" href="#" onclick="return doclink('link-32', 'pipe_control', 'link-24');">pipe_control</a></tt><tt class="py-op">.</tt><tt id="link-33" class="py-name" targets="Module data_store.interatomic=data_store.interatomic-module.html,Module pipe_control.interatomic=pipe_control.interatomic-module.html,Module test_suite.gui_tests.interatomic=test_suite.gui_tests.interatomic-module.html,Module test_suite.system_tests.interatomic=test_suite.system_tests.interatomic-module.html"><a title="data_store.interatomic
pipe_control.interatomic
test_suite.gui_tests.interatomic
test_suite.system_tests.interatomic" class="py-name" href="#" onclick="return doclink('link-33', 'interatomic', 'link-33');">interatomic</a></tt> <tt class="py-keyword">import</tt> <tt id="link-34" class="py-name" targets="Function pipe_control.interatomic.interatomic_loop()=pipe_control.interatomic-module.html#interatomic_loop"><a title="pipe_control.interatomic.interatomic_loop" class="py-name" href="#" onclick="return doclink('link-34', 'interatomic_loop', 'link-34');">interatomic_loop</a></tt> </tt>
<a name="L41"></a><tt class="py-lineno"> 41</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-35" class="py-name"><a title="pipe_control" class="py-name" href="#" onclick="return doclink('link-35', 'pipe_control', 'link-24');">pipe_control</a></tt><tt class="py-op">.</tt><tt id="link-36" class="py-name" targets="Module data_store.mol_res_spin=data_store.mol_res_spin-module.html,Module pipe_control.mol_res_spin=pipe_control.mol_res_spin-module.html,Module test_suite.system_tests.mol_res_spin=test_suite.system_tests.mol_res_spin-module.html"><a title="data_store.mol_res_spin
pipe_control.mol_res_spin
test_suite.system_tests.mol_res_spin" class="py-name" href="#" onclick="return doclink('link-36', 'mol_res_spin', 'link-36');">mol_res_spin</a></tt> <tt class="py-keyword">import</tt> <tt id="link-37" class="py-name" targets="Function pipe_control.mol_res_spin.spin_loop()=pipe_control.mol_res_spin-module.html#spin_loop"><a title="pipe_control.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-37', 'spin_loop', 'link-37');">spin_loop</a></tt> </tt>
<a name="L42"></a><tt class="py-lineno"> 42</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-38" class="py-name" targets="Package specific_analyses=specific_analyses-module.html"><a title="specific_analyses" class="py-name" href="#" onclick="return doclink('link-38', 'specific_analyses', 'link-38');">specific_analyses</a></tt><tt class="py-op">.</tt><tt id="link-39" class="py-name" targets="Module specific_analyses.api_base=specific_analyses.api_base-module.html"><a title="specific_analyses.api_base" class="py-name" href="#" onclick="return doclink('link-39', 'api_base', 'link-39');">api_base</a></tt> <tt class="py-keyword">import</tt> <tt id="link-40" class="py-name" targets="Class specific_analyses.api_base.API_base=specific_analyses.api_base.API_base-class.html"><a title="specific_analyses.api_base.API_base" class="py-name" href="#" onclick="return doclink('link-40', 'API_base', 'link-40');">API_base</a></tt> </tt>
<a name="L43"></a><tt class="py-lineno"> 43</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-41" class="py-name"><a title="specific_analyses" class="py-name" href="#" onclick="return doclink('link-41', 'specific_analyses', 'link-38');">specific_analyses</a></tt><tt class="py-op">.</tt><tt id="link-42" class="py-name" targets="Module specific_analyses.api_common=specific_analyses.api_common-module.html"><a title="specific_analyses.api_common" class="py-name" href="#" onclick="return doclink('link-42', 'api_common', 'link-42');">api_common</a></tt> <tt class="py-keyword">import</tt> <tt id="link-43" class="py-name" targets="Class specific_analyses.api_common.API_common=specific_analyses.api_common.API_common-class.html"><a title="specific_analyses.api_common.API_common" class="py-name" href="#" onclick="return doclink('link-43', 'API_common', 'link-43');">API_common</a></tt> </tt>
<a name="L44"></a><tt class="py-lineno"> 44</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-44" class="py-name"><a title="specific_analyses" class="py-name" href="#" onclick="return doclink('link-44', 'specific_analyses', 'link-38');">specific_analyses</a></tt><tt class="py-op">.</tt><tt id="link-45" class="py-name" targets="Package specific_analyses.n_state_model=specific_analyses.n_state_model-module.html,Module target_functions.n_state_model=target_functions.n_state_model-module.html,Module test_suite.gui_tests.n_state_model=test_suite.gui_tests.n_state_model-module.html,Module test_suite.system_tests.n_state_model=test_suite.system_tests.n_state_model-module.html,Module user_functions.n_state_model=user_functions.n_state_model-module.html"><a title="specific_analyses.n_state_model
target_functions.n_state_model
test_suite.gui_tests.n_state_model
test_suite.system_tests.n_state_model
user_functions.n_state_model" class="py-name" href="#" onclick="return doclink('link-45', 'n_state_model', 'link-45');">n_state_model</a></tt><tt class="py-op">.</tt><tt id="link-46" class="py-name" targets="Module specific_analyses.frame_order.data=specific_analyses.frame_order.data-module.html,Module specific_analyses.model_free.data=specific_analyses.model_free.data-module.html,Module specific_analyses.n_state_model.data=specific_analyses.n_state_model.data-module.html,Module specific_analyses.relax_disp.data=specific_analyses.relax_disp.data-module.html,Module user_functions.data=user_functions.data-module.html"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-46', 'data', 'link-46');">data</a></tt> <tt class="py-keyword">import</tt> <tt id="link-47" class="py-name" targets="Function specific_analyses.frame_order.data.base_data_types()=specific_analyses.frame_order.data-module.html#base_data_types,Function specific_analyses.n_state_model.data.base_data_types()=specific_analyses.n_state_model.data-module.html#base_data_types"><a title="specific_analyses.frame_order.data.base_data_types
specific_analyses.n_state_model.data.base_data_types" class="py-name" href="#" onclick="return doclink('link-47', 'base_data_types', 'link-47');">base_data_types</a></tt><tt class="py-op">,</tt> <tt id="link-48" class="py-name" targets="Function specific_analyses.n_state_model.data.calc_ave_dist()=specific_analyses.n_state_model.data-module.html#calc_ave_dist"><a title="specific_analyses.n_state_model.data.calc_ave_dist" class="py-name" href="#" onclick="return doclink('link-48', 'calc_ave_dist', 'link-48');">calc_ave_dist</a></tt><tt class="py-op">,</tt> <tt id="link-49" class="py-name" targets="Function specific_analyses.n_state_model.data.num_data_points()=specific_analyses.n_state_model.data-module.html#num_data_points"><a title="specific_analyses.n_state_model.data.num_data_points" class="py-name" href="#" onclick="return doclink('link-49', 'num_data_points', 'link-49');">num_data_points</a></tt> </tt>
<a name="L45"></a><tt class="py-lineno"> 45</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-50" class="py-name"><a title="specific_analyses" class="py-name" href="#" onclick="return doclink('link-50', 'specific_analyses', 'link-38');">specific_analyses</a></tt><tt class="py-op">.</tt><tt id="link-51" class="py-name"><a title="specific_analyses.n_state_model
target_functions.n_state_model
test_suite.gui_tests.n_state_model
test_suite.system_tests.n_state_model
user_functions.n_state_model" class="py-name" href="#" onclick="return doclink('link-51', 'n_state_model', 'link-45');">n_state_model</a></tt><tt class="py-op">.</tt><tt id="link-52" class="py-name" targets="Module specific_analyses.frame_order.optimisation=specific_analyses.frame_order.optimisation-module.html,Module specific_analyses.model_free.optimisation=specific_analyses.model_free.optimisation-module.html,Module specific_analyses.n_state_model.optimisation=specific_analyses.n_state_model.optimisation-module.html,Module specific_analyses.relax_disp.optimisation=specific_analyses.relax_disp.optimisation-module.html,Module specific_analyses.relax_fit.optimisation=specific_analyses.relax_fit.optimisation-module.html"><a title="specific_analyses.frame_order.optimisation
specific_analyses.model_free.optimisation
specific_analyses.n_state_model.optimisation
specific_analyses.relax_disp.optimisation
specific_analyses.relax_fit.optimisation" class="py-name" href="#" onclick="return doclink('link-52', 'optimisation', 'link-52');">optimisation</a></tt> <tt class="py-keyword">import</tt> <tt id="link-53" class="py-name" targets="Function specific_analyses.n_state_model.optimisation.minimise_bc_data()=specific_analyses.n_state_model.optimisation-module.html#minimise_bc_data"><a title="specific_analyses.n_state_model.optimisation.minimise_bc_data" class="py-name" href="#" onclick="return doclink('link-53', 'minimise_bc_data', 'link-53');">minimise_bc_data</a></tt><tt class="py-op">,</tt> <tt id="link-54" class="py-name" targets="Function specific_analyses.frame_order.optimisation.target_fn_setup()=specific_analyses.frame_order.optimisation-module.html#target_fn_setup,Function specific_analyses.n_state_model.optimisation.target_fn_setup()=specific_analyses.n_state_model.optimisation-module.html#target_fn_setup"><a title="specific_analyses.frame_order.optimisation.target_fn_setup
specific_analyses.n_state_model.optimisation.target_fn_setup" class="py-name" href="#" onclick="return doclink('link-54', 'target_fn_setup', 'link-54');">target_fn_setup</a></tt> </tt>
<a name="L46"></a><tt class="py-lineno"> 46</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-55" class="py-name"><a title="specific_analyses" class="py-name" href="#" onclick="return doclink('link-55', 'specific_analyses', 'link-38');">specific_analyses</a></tt><tt class="py-op">.</tt><tt id="link-56" class="py-name"><a title="specific_analyses.n_state_model
target_functions.n_state_model
test_suite.gui_tests.n_state_model
test_suite.system_tests.n_state_model
user_functions.n_state_model" class="py-name" href="#" onclick="return doclink('link-56', 'n_state_model', 'link-45');">n_state_model</a></tt><tt class="py-op">.</tt><tt id="link-57" class="py-name" targets="Module specific_analyses.consistency_tests.parameter_object=specific_analyses.consistency_tests.parameter_object-module.html,Module specific_analyses.frame_order.parameter_object=specific_analyses.frame_order.parameter_object-module.html,Module specific_analyses.jw_mapping.parameter_object=specific_analyses.jw_mapping.parameter_object-module.html,Module specific_analyses.model_free.parameter_object=specific_analyses.model_free.parameter_object-module.html,Module specific_analyses.n_state_model.parameter_object=specific_analyses.n_state_model.parameter_object-module.html,Module specific_analyses.noe.parameter_object=specific_analyses.noe.parameter_object-module.html,Module specific_analyses.parameter_object=specific_analyses.parameter_object-module.html,Module specific_analyses.relax_disp.parameter_object=specific_analyses.relax_disp.parameter_object-module.html,Module specific_analyses.relax_fit.parameter_object=specific_analyses.relax_fit.parameter_object-module.html"><a title="specific_analyses.consistency_tests.parameter_object
specific_analyses.frame_order.parameter_object
specific_analyses.jw_mapping.parameter_object
specific_analyses.model_free.parameter_object
specific_analyses.n_state_model.parameter_object
specific_analyses.noe.parameter_object
specific_analyses.parameter_object
specific_analyses.relax_disp.parameter_object
specific_analyses.relax_fit.parameter_object" class="py-name" href="#" onclick="return doclink('link-57', 'parameter_object', 'link-57');">parameter_object</a></tt> <tt class="py-keyword">import</tt> <tt id="link-58" class="py-name" targets="Class specific_analyses.n_state_model.parameter_object.N_state_params=specific_analyses.n_state_model.parameter_object.N_state_params-class.html"><a title="specific_analyses.n_state_model.parameter_object.N_state_params" class="py-name" href="#" onclick="return doclink('link-58', 'N_state_params', 'link-58');">N_state_params</a></tt> </tt>
<a name="L47"></a><tt class="py-lineno"> 47</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-59" class="py-name"><a title="specific_analyses" class="py-name" href="#" onclick="return doclink('link-59', 'specific_analyses', 'link-38');">specific_analyses</a></tt><tt class="py-op">.</tt><tt id="link-60" class="py-name"><a title="specific_analyses.n_state_model
target_functions.n_state_model
test_suite.gui_tests.n_state_model
test_suite.system_tests.n_state_model
user_functions.n_state_model" class="py-name" href="#" onclick="return doclink('link-60', 'n_state_model', 'link-45');">n_state_model</a></tt><tt class="py-op">.</tt><tt id="link-61" class="py-name" targets="Module specific_analyses.frame_order.parameters=specific_analyses.frame_order.parameters-module.html,Module specific_analyses.model_free.parameters=specific_analyses.model_free.parameters-module.html,Module specific_analyses.n_state_model.parameters=specific_analyses.n_state_model.parameters-module.html,Module specific_analyses.relax_disp.parameters=specific_analyses.relax_disp.parameters-module.html,Module specific_analyses.relax_fit.parameters=specific_analyses.relax_fit.parameters-module.html"><a title="specific_analyses.frame_order.parameters
specific_analyses.model_free.parameters
specific_analyses.n_state_model.parameters
specific_analyses.relax_disp.parameters
specific_analyses.relax_fit.parameters" class="py-name" href="#" onclick="return doclink('link-61', 'parameters', 'link-61');">parameters</a></tt> <tt class="py-keyword">import</tt> <tt id="link-62" class="py-name" targets="Function specific_analyses.frame_order.parameters.assemble_param_vector()=specific_analyses.frame_order.parameters-module.html#assemble_param_vector,Function specific_analyses.model_free.parameters.assemble_param_vector()=specific_analyses.model_free.parameters-module.html#assemble_param_vector,Function specific_analyses.n_state_model.parameters.assemble_param_vector()=specific_analyses.n_state_model.parameters-module.html#assemble_param_vector,Function specific_analyses.relax_disp.parameters.assemble_param_vector()=specific_analyses.relax_disp.parameters-module.html#assemble_param_vector,Function specific_analyses.relax_fit.parameters.assemble_param_vector()=specific_analyses.relax_fit.parameters-module.html#assemble_param_vector,Method test_suite.unit_tests._lib._dispersion.test_cr72_full_cluster_one_field.Test_cr72_full_cluster_one_field.assemble_param_vector()=test_suite.unit_tests._lib._dispersion.test_cr72_full_cluster_one_field.Test_cr72_full_cluster_one_field-class.html#assemble_param_vector,Method test_suite.unit_tests._lib._dispersion.test_cr72_full_cluster_three_fields.Test_cr72_full_cluster_three_fields.assemble_param_vector()=test_suite.unit_tests._lib._dispersion.test_cr72_full_cluster_three_fields.Test_cr72_full_cluster_three_fields-class.html#assemble_param_vector"><a title="specific_analyses.frame_order.parameters.assemble_param_vector
specific_analyses.model_free.parameters.assemble_param_vector
specific_analyses.n_state_model.parameters.assemble_param_vector
specific_analyses.relax_disp.parameters.assemble_param_vector
specific_analyses.relax_fit.parameters.assemble_param_vector
test_suite.unit_tests._lib._dispersion.test_cr72_full_cluster_one_field.Test_cr72_full_cluster_one_field.assemble_param_vector
test_suite.unit_tests._lib._dispersion.test_cr72_full_cluster_three_fields.Test_cr72_full_cluster_three_fields.assemble_param_vector" class="py-name" href="#" onclick="return doclink('link-62', 'assemble_param_vector', 'link-62');">assemble_param_vector</a></tt><tt class="py-op">,</tt> <tt id="link-63" class="py-name" targets="Function specific_analyses.model_free.parameters.disassemble_param_vector()=specific_analyses.model_free.parameters-module.html#disassemble_param_vector,Function specific_analyses.n_state_model.parameters.disassemble_param_vector()=specific_analyses.n_state_model.parameters-module.html#disassemble_param_vector,Function specific_analyses.relax_disp.parameters.disassemble_param_vector()=specific_analyses.relax_disp.parameters-module.html#disassemble_param_vector,Function specific_analyses.relax_fit.parameters.disassemble_param_vector()=specific_analyses.relax_fit.parameters-module.html#disassemble_param_vector"><a title="specific_analyses.model_free.parameters.disassemble_param_vector
specific_analyses.n_state_model.parameters.disassemble_param_vector
specific_analyses.relax_disp.parameters.disassemble_param_vector
specific_analyses.relax_fit.parameters.disassemble_param_vector" class="py-name" href="#" onclick="return doclink('link-63', 'disassemble_param_vector', 'link-63');">disassemble_param_vector</a></tt><tt class="py-op">,</tt> <tt id="link-64" class="py-name" targets="Function specific_analyses.frame_order.parameters.linear_constraints()=specific_analyses.frame_order.parameters-module.html#linear_constraints,Function specific_analyses.model_free.parameters.linear_constraints()=specific_analyses.model_free.parameters-module.html#linear_constraints,Function specific_analyses.n_state_model.parameters.linear_constraints()=specific_analyses.n_state_model.parameters-module.html#linear_constraints,Function specific_analyses.relax_disp.parameters.linear_constraints()=specific_analyses.relax_disp.parameters-module.html#linear_constraints,Function specific_analyses.relax_fit.parameters.linear_constraints()=specific_analyses.relax_fit.parameters-module.html#linear_constraints"><a title="specific_analyses.frame_order.parameters.linear_constraints
specific_analyses.model_free.parameters.linear_constraints
specific_analyses.n_state_model.parameters.linear_constraints
specific_analyses.relax_disp.parameters.linear_constraints
specific_analyses.relax_fit.parameters.linear_constraints" class="py-name" href="#" onclick="return doclink('link-64', 'linear_constraints', 'link-64');">linear_constraints</a></tt><tt class="py-op">,</tt> <tt id="link-65" class="py-name" targets="Function specific_analyses.frame_order.parameters.param_num()=specific_analyses.frame_order.parameters-module.html#param_num,Function specific_analyses.n_state_model.parameters.param_num()=specific_analyses.n_state_model.parameters-module.html#param_num,Function specific_analyses.relax_disp.parameters.param_num()=specific_analyses.relax_disp.parameters-module.html#param_num"><a title="specific_analyses.frame_order.parameters.param_num
specific_analyses.n_state_model.parameters.param_num
specific_analyses.relax_disp.parameters.param_num" class="py-name" href="#" onclick="return doclink('link-65', 'param_num', 'link-65');">param_num</a></tt> </tt>
<a name="L48"></a><tt class="py-lineno"> 48</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-66" class="py-name" targets="Package target_functions=target_functions-module.html"><a title="target_functions" class="py-name" href="#" onclick="return doclink('link-66', 'target_functions', 'link-66');">target_functions</a></tt><tt class="py-op">.</tt><tt id="link-67" class="py-name" targets="Module target_functions.potential=target_functions.potential-module.html"><a title="target_functions.potential" class="py-name" href="#" onclick="return doclink('link-67', 'potential', 'link-67');">potential</a></tt> <tt class="py-keyword">import</tt> <tt id="link-68" class="py-name" targets="Function target_functions.potential.quad_pot()=target_functions.potential-module.html#quad_pot"><a title="target_functions.potential.quad_pot" class="py-name" href="#" onclick="return doclink('link-68', 'quad_pot', 'link-68');">quad_pot</a></tt> </tt>
<a name="L49"></a><tt class="py-lineno"> 49</tt>  <tt class="py-line"> </tt>
<a name="L50"></a><tt class="py-lineno"> 50</tt>  <tt class="py-line"> </tt>
<a name="N_state_model"></a><div id="N_state_model-def"><a name="L51"></a><tt class="py-lineno"> 51</tt> <a class="py-toggle" href="#" id="N_state_model-toggle" onclick="return toggle('N_state_model');">-</a><tt class="py-line"><tt class="py-keyword">class</tt> <a class="py-def-name" href="specific_analyses.n_state_model.api.N_state_model-class.html">N_state_model</a><tt class="py-op">(</tt><tt class="py-base-class">API_base</tt><tt class="py-op">,</tt> <tt class="py-base-class">API_common</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="N_state_model-expanded"><a name="L52"></a><tt class="py-lineno"> 52</tt>  <tt class="py-line">    <tt class="py-docstring">"""Class containing functions for the N-state model."""</tt> </tt>
<a name="L53"></a><tt class="py-lineno"> 53</tt>  <tt class="py-line"> </tt>
<a name="L54"></a><tt class="py-lineno"> 54</tt>  <tt class="py-line">    <tt class="py-comment"># Class variable for storing the class instance (for the singleton design pattern).</tt> </tt>
<a name="L55"></a><tt class="py-lineno"> 55</tt>  <tt class="py-line">    <tt id="link-69" class="py-name" targets="Variable bmrblib.version.Star_version.instance=bmrblib.version.Star_version-class.html#instance,Variable data_store.Relax_data_store.instance=data_store.Relax_data_store-class.html#instance,Variable info.Info_box.instance=info.Info_box-class.html#instance,Variable multi.Processor_box.instance=multi.Processor_box-class.html#instance,Variable multi.misc.Verbosity.instance=multi.misc.Verbosity-class.html#instance,Variable specific_analyses.api_base.API_base.instance=specific_analyses.api_base.API_base-class.html#instance,Variable specific_analyses.consistency_tests.api.Consistency_tests.instance=specific_analyses.consistency_tests.api.Consistency_tests-class.html#instance,Variable specific_analyses.frame_order.api.Frame_order.instance=specific_analyses.frame_order.api.Frame_order-class.html#instance,Variable specific_analyses.jw_mapping.api.Jw_mapping.instance=specific_analyses.jw_mapping.api.Jw_mapping-class.html#instance,Variable specific_analyses.model_free.api.Model_free.instance=specific_analyses.model_free.api.Model_free-class.html#instance,Variable specific_analyses.n_state_model.api.N_state_model.instance=specific_analyses.n_state_model.api.N_state_model-class.html#instance,Variable specific_analyses.noe.api.Noe.instance=specific_analyses.noe.api.Noe-class.html#instance,Variable specific_analyses.relax_disp.api.Relax_disp.instance=specific_analyses.relax_disp.api.Relax_disp-class.html#instance,Variable specific_analyses.relax_fit.api.Relax_fit.instance=specific_analyses.relax_fit.api.Relax_fit-class.html#instance"><a title="bmrblib.version.Star_version.instance
data_store.Relax_data_store.instance
info.Info_box.instance
multi.Processor_box.instance
multi.misc.Verbosity.instance
specific_analyses.api_base.API_base.instance
specific_analyses.consistency_tests.api.Consistency_tests.instance
specific_analyses.frame_order.api.Frame_order.instance
specific_analyses.jw_mapping.api.Jw_mapping.instance
specific_analyses.model_free.api.Model_free.instance
specific_analyses.n_state_model.api.N_state_model.instance
specific_analyses.noe.api.Noe.instance
specific_analyses.relax_disp.api.Relax_disp.instance
specific_analyses.relax_fit.api.Relax_fit.instance" class="py-name" href="#" onclick="return doclink('link-69', 'instance', 'link-69');">instance</a></tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L56"></a><tt class="py-lineno"> 56</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.__init__"></a><div id="N_state_model.__init__-def"><a name="L57"></a><tt class="py-lineno"> 57</tt> <a class="py-toggle" href="#" id="N_state_model.__init__-toggle" onclick="return toggle('N_state_model.__init__');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.api.N_state_model-class.html#__init__">__init__</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.__init__-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="N_state_model.__init__-expanded"><a name="L58"></a><tt class="py-lineno"> 58</tt>  <tt class="py-line">        <tt class="py-docstring">"""Initialise the class by placing API_common methods into the API."""</tt> </tt>
<a name="L59"></a><tt class="py-lineno"> 59</tt>  <tt class="py-line"> </tt>
<a name="L60"></a><tt class="py-lineno"> 60</tt>  <tt class="py-line">        <tt class="py-comment"># Place methods into the API.</tt> </tt>
<a name="L61"></a><tt class="py-lineno"> 61</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-70" class="py-name" targets="Method specific_analyses.api_base.API_base.get_model_container()=specific_analyses.api_base.API_base-class.html#get_model_container"><a title="specific_analyses.api_base.API_base.get_model_container" class="py-name" href="#" onclick="return doclink('link-70', 'get_model_container', 'link-70');">get_model_container</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-71" class="py-name" targets="Method specific_analyses.api_common.API_common._get_model_container_cdp()=specific_analyses.api_common.API_common-class.html#_get_model_container_cdp"><a title="specific_analyses.api_common.API_common._get_model_container_cdp" class="py-name" href="#" onclick="return doclink('link-71', '_get_model_container_cdp', 'link-71');">_get_model_container_cdp</a></tt> </tt>
<a name="L62"></a><tt class="py-lineno"> 62</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-72" class="py-name" targets="Method lib.structure.internal.object.Internal.model_loop()=lib.structure.internal.object.Internal-class.html#model_loop,Method specific_analyses.api_base.API_base.model_loop()=specific_analyses.api_base.API_base-class.html#model_loop,Method specific_analyses.hybrid.Hybrid.model_loop()=specific_analyses.hybrid.Hybrid-class.html#model_loop,Method specific_analyses.model_free.api.Model_free.model_loop()=specific_analyses.model_free.api.Model_free-class.html#model_loop,Method specific_analyses.relax_disp.api.Relax_disp.model_loop()=specific_analyses.relax_disp.api.Relax_disp-class.html#model_loop"><a title="lib.structure.internal.object.Internal.model_loop
specific_analyses.api_base.API_base.model_loop
specific_analyses.hybrid.Hybrid.model_loop
specific_analyses.model_free.api.Model_free.model_loop
specific_analyses.relax_disp.api.Relax_disp.model_loop" class="py-name" href="#" onclick="return doclink('link-72', 'model_loop', 'link-72');">model_loop</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-73" class="py-name" targets="Method specific_analyses.api_common.API_common._model_loop_single_global()=specific_analyses.api_common.API_common-class.html#_model_loop_single_global"><a title="specific_analyses.api_common.API_common._model_loop_single_global" class="py-name" href="#" onclick="return doclink('link-73', '_model_loop_single_global', 'link-73');">_model_loop_single_global</a></tt> </tt>
<a name="L63"></a><tt class="py-lineno"> 63</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-74" class="py-name" targets="Method specific_analyses.api_base.API_base.overfit_deselect()=specific_analyses.api_base.API_base-class.html#overfit_deselect,Method specific_analyses.consistency_tests.api.Consistency_tests.overfit_deselect()=specific_analyses.consistency_tests.api.Consistency_tests-class.html#overfit_deselect,Method specific_analyses.jw_mapping.api.Jw_mapping.overfit_deselect()=specific_analyses.jw_mapping.api.Jw_mapping-class.html#overfit_deselect,Method specific_analyses.model_free.api.Model_free.overfit_deselect()=specific_analyses.model_free.api.Model_free-class.html#overfit_deselect,Method specific_analyses.noe.api.Noe.overfit_deselect()=specific_analyses.noe.api.Noe-class.html#overfit_deselect,Method specific_analyses.relax_disp.api.Relax_disp.overfit_deselect()=specific_analyses.relax_disp.api.Relax_disp-class.html#overfit_deselect,Method specific_analyses.relax_fit.api.Relax_fit.overfit_deselect()=specific_analyses.relax_fit.api.Relax_fit-class.html#overfit_deselect"><a title="specific_analyses.api_base.API_base.overfit_deselect
specific_analyses.consistency_tests.api.Consistency_tests.overfit_deselect
specific_analyses.jw_mapping.api.Jw_mapping.overfit_deselect
specific_analyses.model_free.api.Model_free.overfit_deselect
specific_analyses.noe.api.Noe.overfit_deselect
specific_analyses.relax_disp.api.Relax_disp.overfit_deselect
specific_analyses.relax_fit.api.Relax_fit.overfit_deselect" class="py-name" href="#" onclick="return doclink('link-74', 'overfit_deselect', 'link-74');">overfit_deselect</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-75" class="py-name" targets="Method specific_analyses.api_common.API_common._overfit_deselect_dummy()=specific_analyses.api_common.API_common-class.html#_overfit_deselect_dummy"><a title="specific_analyses.api_common.API_common._overfit_deselect_dummy" class="py-name" href="#" onclick="return doclink('link-75', '_overfit_deselect_dummy', 'link-75');">_overfit_deselect_dummy</a></tt> </tt>
<a name="L64"></a><tt class="py-lineno"> 64</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-76" class="py-name" targets="Method specific_analyses.api_base.API_base.print_model_title()=specific_analyses.api_base.API_base-class.html#print_model_title,Method specific_analyses.model_free.api.Model_free.print_model_title()=specific_analyses.model_free.api.Model_free-class.html#print_model_title,Method specific_analyses.relax_disp.api.Relax_disp.print_model_title()=specific_analyses.relax_disp.api.Relax_disp-class.html#print_model_title"><a title="specific_analyses.api_base.API_base.print_model_title
specific_analyses.model_free.api.Model_free.print_model_title
specific_analyses.relax_disp.api.Relax_disp.print_model_title" class="py-name" href="#" onclick="return doclink('link-76', 'print_model_title', 'link-76');">print_model_title</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-77" class="py-name" targets="Method specific_analyses.api_common.API_common._print_model_title_global()=specific_analyses.api_common.API_common-class.html#_print_model_title_global"><a title="specific_analyses.api_common.API_common._print_model_title_global" class="py-name" href="#" onclick="return doclink('link-77', '_print_model_title_global', 'link-77');">_print_model_title_global</a></tt> </tt>
<a name="L65"></a><tt class="py-lineno"> 65</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-78" class="py-name" targets="Method specific_analyses.api_base.API_base.set_selected_sim()=specific_analyses.api_base.API_base-class.html#set_selected_sim,Method specific_analyses.frame_order.api.Frame_order.set_selected_sim()=specific_analyses.frame_order.api.Frame_order-class.html#set_selected_sim,Method specific_analyses.model_free.api.Model_free.set_selected_sim()=specific_analyses.model_free.api.Model_free-class.html#set_selected_sim,Method specific_analyses.relax_disp.api.Relax_disp.set_selected_sim()=specific_analyses.relax_disp.api.Relax_disp-class.html#set_selected_sim"><a title="specific_analyses.api_base.API_base.set_selected_sim
specific_analyses.frame_order.api.Frame_order.set_selected_sim
specific_analyses.model_free.api.Model_free.set_selected_sim
specific_analyses.relax_disp.api.Relax_disp.set_selected_sim" class="py-name" href="#" onclick="return doclink('link-78', 'set_selected_sim', 'link-78');">set_selected_sim</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-79" class="py-name" targets="Method specific_analyses.api_common.API_common._set_selected_sim_global()=specific_analyses.api_common.API_common-class.html#_set_selected_sim_global"><a title="specific_analyses.api_common.API_common._set_selected_sim_global" class="py-name" href="#" onclick="return doclink('link-79', '_set_selected_sim_global', 'link-79');">_set_selected_sim_global</a></tt> </tt>
<a name="L66"></a><tt class="py-lineno"> 66</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-80" class="py-name" targets="Method specific_analyses.api_base.API_base.sim_return_selected()=specific_analyses.api_base.API_base-class.html#sim_return_selected,Method specific_analyses.consistency_tests.api.Consistency_tests.sim_return_selected()=specific_analyses.consistency_tests.api.Consistency_tests-class.html#sim_return_selected,Method specific_analyses.frame_order.api.Frame_order.sim_return_selected()=specific_analyses.frame_order.api.Frame_order-class.html#sim_return_selected,Method specific_analyses.jw_mapping.api.Jw_mapping.sim_return_selected()=specific_analyses.jw_mapping.api.Jw_mapping-class.html#sim_return_selected,Method specific_analyses.model_free.api.Model_free.sim_return_selected()=specific_analyses.model_free.api.Model_free-class.html#sim_return_selected,Method specific_analyses.relax_disp.api.Relax_disp.sim_return_selected()=specific_analyses.relax_disp.api.Relax_disp-class.html#sim_return_selected"><a title="specific_analyses.api_base.API_base.sim_return_selected
specific_analyses.consistency_tests.api.Consistency_tests.sim_return_selected
specific_analyses.frame_order.api.Frame_order.sim_return_selected
specific_analyses.jw_mapping.api.Jw_mapping.sim_return_selected
specific_analyses.model_free.api.Model_free.sim_return_selected
specific_analyses.relax_disp.api.Relax_disp.sim_return_selected" class="py-name" href="#" onclick="return doclink('link-80', 'sim_return_selected', 'link-80');">sim_return_selected</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-81" class="py-name" targets="Method specific_analyses.api_common.API_common._sim_return_selected_global()=specific_analyses.api_common.API_common-class.html#_sim_return_selected_global"><a title="specific_analyses.api_common.API_common._sim_return_selected_global" class="py-name" href="#" onclick="return doclink('link-81', '_sim_return_selected_global', 'link-81');">_sim_return_selected_global</a></tt> </tt>
<a name="L67"></a><tt class="py-lineno"> 67</tt>  <tt class="py-line"> </tt>
<a name="L68"></a><tt class="py-lineno"> 68</tt>  <tt class="py-line">        <tt class="py-comment"># Place a copy of the parameter list object in the instance namespace.</tt> </tt>
<a name="L69"></a><tt class="py-lineno"> 69</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_PARAMS</tt> <tt class="py-op">=</tt> <tt id="link-82" class="py-name"><a title="specific_analyses.n_state_model.parameter_object.N_state_params" class="py-name" href="#" onclick="return doclink('link-82', 'N_state_params', 'link-58');">N_state_params</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
</div><a name="L70"></a><tt class="py-lineno"> 70</tt>  <tt class="py-line"> </tt>
<a name="L71"></a><tt class="py-lineno"> 71</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.base_data_loop"></a><div id="N_state_model.base_data_loop-def"><a name="L72"></a><tt class="py-lineno"> 72</tt> <a class="py-toggle" href="#" id="N_state_model.base_data_loop-toggle" onclick="return toggle('N_state_model.base_data_loop');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.api.N_state_model-class.html#base_data_loop">base_data_loop</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.base_data_loop-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="N_state_model.base_data_loop-expanded"><a name="L73"></a><tt class="py-lineno"> 73</tt>  <tt class="py-line">        <tt class="py-docstring">"""Loop over the base data of the spins - RDCs, PCSs, and NOESY data.</tt> </tt>
<a name="L74"></a><tt class="py-lineno"> 74</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L75"></a><tt class="py-lineno"> 75</tt>  <tt class="py-line"><tt class="py-docstring">        This loop iterates for each data point (RDC, PCS, NOESY) for each spin or interatomic data container, returning the identification information.</tt> </tt>
<a name="L76"></a><tt class="py-lineno"> 76</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L77"></a><tt class="py-lineno"> 77</tt>  <tt class="py-line"><tt class="py-docstring">        @return:            A list of the spin or interatomic data container, the data type ('rdc', 'pcs', 'noesy'), and the alignment ID if required.</tt> </tt>
<a name="L78"></a><tt class="py-lineno"> 78</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:             list of [SpinContainer instance, str, str] or [InteratomContainer instance, str, str]</tt> </tt>
<a name="L79"></a><tt class="py-lineno"> 79</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L80"></a><tt class="py-lineno"> 80</tt>  <tt class="py-line"> </tt>
<a name="L81"></a><tt class="py-lineno"> 81</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the interatomic data containers.</tt> </tt>
<a name="L82"></a><tt class="py-lineno"> 82</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-83" class="py-name" targets="Module user_functions.interatom=user_functions.interatom-module.html"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-83', 'interatom', 'link-83');">interatom</a></tt> <tt class="py-keyword">in</tt> <tt id="link-84" class="py-name"><a title="pipe_control.interatomic.interatomic_loop" class="py-name" href="#" onclick="return doclink('link-84', 'interatomic_loop', 'link-34');">interatomic_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L83"></a><tt class="py-lineno"> 83</tt>  <tt class="py-line">            <tt class="py-comment"># Skip deselected data.</tt> </tt>
<a name="L84"></a><tt class="py-lineno"> 84</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-85" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-85', 'interatom', 'link-83');">interatom</a></tt><tt class="py-op">.</tt><tt id="link-86" class="py-name" targets="Function pipe_control.model_selection.select()=pipe_control.model_selection-module.html#select,Module user_functions.select=user_functions.select-module.html"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-86', 'select', 'link-86');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L85"></a><tt class="py-lineno"> 85</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L86"></a><tt class="py-lineno"> 86</tt>  <tt class="py-line"> </tt>
<a name="L87"></a><tt class="py-lineno"> 87</tt>  <tt class="py-line">            <tt class="py-comment"># Re-initialise the data structure.</tt> </tt>
<a name="L88"></a><tt class="py-lineno"> 88</tt>  <tt class="py-line">            <tt id="link-87" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-87', 'data', 'link-46');">data</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt id="link-88" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-88', 'interatom', 'link-83');">interatom</a></tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">]</tt> </tt>
<a name="L89"></a><tt class="py-lineno"> 89</tt>  <tt class="py-line"> </tt>
<a name="L90"></a><tt class="py-lineno"> 90</tt>  <tt class="py-line">            <tt class="py-comment"># RDC data.</tt> </tt>
<a name="L91"></a><tt class="py-lineno"> 91</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-89" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-89', 'interatom', 'link-83');">interatom</a></tt><tt class="py-op">,</tt> <tt class="py-string">'rdc'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L92"></a><tt class="py-lineno"> 92</tt>  <tt class="py-line">                <tt id="link-90" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-90', 'data', 'link-46');">data</a></tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-string">'rdc'</tt> </tt>
<a name="L93"></a><tt class="py-lineno"> 93</tt>  <tt class="py-line"> </tt>
<a name="L94"></a><tt class="py-lineno"> 94</tt>  <tt class="py-line">                <tt class="py-comment"># Loop over the alignment IDs.</tt> </tt>
<a name="L95"></a><tt class="py-lineno"> 95</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">id</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">rdc_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L96"></a><tt class="py-lineno"> 96</tt>  <tt class="py-line">                    <tt class="py-comment"># Add the ID.</tt> </tt>
<a name="L97"></a><tt class="py-lineno"> 97</tt>  <tt class="py-line">                    <tt id="link-91" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-91', 'data', 'link-46');">data</a></tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">id</tt> </tt>
<a name="L98"></a><tt class="py-lineno"> 98</tt>  <tt class="py-line"> </tt>
<a name="L99"></a><tt class="py-lineno"> 99</tt>  <tt class="py-line">                    <tt class="py-comment"># Yield the set.</tt> </tt>
<a name="L100"></a><tt class="py-lineno">100</tt>  <tt class="py-line">                    <tt class="py-keyword">yield</tt> <tt id="link-92" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-92', 'data', 'link-46');">data</a></tt> </tt>
<a name="L101"></a><tt class="py-lineno">101</tt>  <tt class="py-line"> </tt>
<a name="L102"></a><tt class="py-lineno">102</tt>  <tt class="py-line">            <tt class="py-comment"># NOESY data.</tt> </tt>
<a name="L103"></a><tt class="py-lineno">103</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-93" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-93', 'interatom', 'link-83');">interatom</a></tt><tt class="py-op">,</tt> <tt class="py-string">'noesy'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L104"></a><tt class="py-lineno">104</tt>  <tt class="py-line">                <tt id="link-94" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-94', 'data', 'link-46');">data</a></tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-string">'noesy'</tt> </tt>
<a name="L105"></a><tt class="py-lineno">105</tt>  <tt class="py-line"> </tt>
<a name="L106"></a><tt class="py-lineno">106</tt>  <tt class="py-line">                <tt class="py-comment"># Loop over the alignment IDs.</tt> </tt>
<a name="L107"></a><tt class="py-lineno">107</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">id</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">noesy_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L108"></a><tt class="py-lineno">108</tt>  <tt class="py-line">                    <tt class="py-comment"># Add the ID.</tt> </tt>
<a name="L109"></a><tt class="py-lineno">109</tt>  <tt class="py-line">                    <tt id="link-95" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-95', 'data', 'link-46');">data</a></tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">id</tt> </tt>
<a name="L110"></a><tt class="py-lineno">110</tt>  <tt class="py-line"> </tt>
<a name="L111"></a><tt class="py-lineno">111</tt>  <tt class="py-line">                    <tt class="py-comment"># Yield the set.</tt> </tt>
<a name="L112"></a><tt class="py-lineno">112</tt>  <tt class="py-line">                    <tt class="py-keyword">yield</tt> <tt id="link-96" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-96', 'data', 'link-46');">data</a></tt> </tt>
<a name="L113"></a><tt class="py-lineno">113</tt>  <tt class="py-line"> </tt>
<a name="L114"></a><tt class="py-lineno">114</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the spins.</tt> </tt>
<a name="L115"></a><tt class="py-lineno">115</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-97" class="py-name" targets="Module test_suite.unit_tests._pipe_control.spin=test_suite.unit_tests._pipe_control.spin-module.html,Module user_functions.spin=user_functions.spin-module.html"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-97', 'spin', 'link-97');">spin</a></tt> <tt class="py-keyword">in</tt> <tt id="link-98" class="py-name"><a title="pipe_control.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-98', 'spin_loop', 'link-37');">spin_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L116"></a><tt class="py-lineno">116</tt>  <tt class="py-line">            <tt class="py-comment"># Skip deselected data.</tt> </tt>
<a name="L117"></a><tt class="py-lineno">117</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-99" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-99', 'spin', 'link-97');">spin</a></tt><tt class="py-op">.</tt><tt id="link-100" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-100', 'select', 'link-86');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L118"></a><tt class="py-lineno">118</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L119"></a><tt class="py-lineno">119</tt>  <tt class="py-line"> </tt>
<a name="L120"></a><tt class="py-lineno">120</tt>  <tt class="py-line">            <tt class="py-comment"># Re-initialise the data structure.</tt> </tt>
<a name="L121"></a><tt class="py-lineno">121</tt>  <tt class="py-line">            <tt id="link-101" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-101', 'data', 'link-46');">data</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt id="link-102" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-102', 'spin', 'link-97');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">]</tt> </tt>
<a name="L122"></a><tt class="py-lineno">122</tt>  <tt class="py-line"> </tt>
<a name="L123"></a><tt class="py-lineno">123</tt>  <tt class="py-line">            <tt class="py-comment"># PCS data.</tt> </tt>
<a name="L124"></a><tt class="py-lineno">124</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-103" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-103', 'spin', 'link-97');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L125"></a><tt class="py-lineno">125</tt>  <tt class="py-line">                <tt id="link-104" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-104', 'data', 'link-46');">data</a></tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-string">'pcs'</tt> </tt>
<a name="L126"></a><tt class="py-lineno">126</tt>  <tt class="py-line"> </tt>
<a name="L127"></a><tt class="py-lineno">127</tt>  <tt class="py-line">                <tt class="py-comment"># Loop over the alignment IDs.</tt> </tt>
<a name="L128"></a><tt class="py-lineno">128</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">id</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pcs_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L129"></a><tt class="py-lineno">129</tt>  <tt class="py-line">                    <tt class="py-comment"># Add the ID.</tt> </tt>
<a name="L130"></a><tt class="py-lineno">130</tt>  <tt class="py-line">                    <tt id="link-105" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-105', 'data', 'link-46');">data</a></tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">id</tt> </tt>
<a name="L131"></a><tt class="py-lineno">131</tt>  <tt class="py-line"> </tt>
<a name="L132"></a><tt class="py-lineno">132</tt>  <tt class="py-line">                    <tt class="py-comment"># Yield the set.</tt> </tt>
<a name="L133"></a><tt class="py-lineno">133</tt>  <tt class="py-line">                    <tt class="py-keyword">yield</tt> <tt id="link-106" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-106', 'data', 'link-46');">data</a></tt> </tt>
</div><a name="L134"></a><tt class="py-lineno">134</tt>  <tt class="py-line"> </tt>
<a name="L135"></a><tt class="py-lineno">135</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.calculate"></a><div id="N_state_model.calculate-def"><a name="L136"></a><tt class="py-lineno">136</tt> <a class="py-toggle" href="#" id="N_state_model.calculate-toggle" onclick="return toggle('N_state_model.calculate');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.api.N_state_model-class.html#calculate">calculate</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">spin_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">scaling_matrix</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">verbosity</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-param">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.calculate-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="N_state_model.calculate-expanded"><a name="L137"></a><tt class="py-lineno">137</tt>  <tt class="py-line">        <tt class="py-docstring">"""Calculation function.</tt> </tt>
<a name="L138"></a><tt class="py-lineno">138</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L139"></a><tt class="py-lineno">139</tt>  <tt class="py-line"><tt class="py-docstring">        Currently this function simply calculates the NOESY flat-bottom quadratic energy potential,</tt> </tt>
<a name="L140"></a><tt class="py-lineno">140</tt>  <tt class="py-line"><tt class="py-docstring">        if NOE restraints are available.</tt> </tt>
<a name="L141"></a><tt class="py-lineno">141</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L142"></a><tt class="py-lineno">142</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword spin_id:           The spin identification string (unused).</tt> </tt>
<a name="L143"></a><tt class="py-lineno">143</tt>  <tt class="py-line"><tt class="py-docstring">        @type spin_id:              None or str</tt> </tt>
<a name="L144"></a><tt class="py-lineno">144</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword scaling_matrix:    The per-model list of diagonal and square scaling matrices.</tt> </tt>
<a name="L145"></a><tt class="py-lineno">145</tt>  <tt class="py-line"><tt class="py-docstring">        @type scaling_matrix:       list of numpy rank-2, float64 array or list of None</tt> </tt>
<a name="L146"></a><tt class="py-lineno">146</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword verbosity:         The amount of information to print.  The higher the value, the greater the verbosity.</tt> </tt>
<a name="L147"></a><tt class="py-lineno">147</tt>  <tt class="py-line"><tt class="py-docstring">        @type verbosity:            int</tt> </tt>
<a name="L148"></a><tt class="py-lineno">148</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword sim_index:         The MC simulation index (unused).</tt> </tt>
<a name="L149"></a><tt class="py-lineno">149</tt>  <tt class="py-line"><tt class="py-docstring">        @type sim_index:            None</tt> </tt>
<a name="L150"></a><tt class="py-lineno">150</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L151"></a><tt class="py-lineno">151</tt>  <tt class="py-line"> </tt>
<a name="L152"></a><tt class="py-lineno">152</tt>  <tt class="py-line">        <tt class="py-comment"># Set up the target function for direct calculation.</tt> </tt>
<a name="L153"></a><tt class="py-lineno">153</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">scaling_matrix</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L154"></a><tt class="py-lineno">154</tt>  <tt class="py-line">            <tt class="py-name">scaling_matrix</tt> <tt class="py-op">=</tt> <tt class="py-name">scaling_matrix</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L155"></a><tt class="py-lineno">155</tt>  <tt class="py-line">        <tt id="link-107" class="py-name" targets="Function lib.structure.pdb_read.model()=lib.structure.pdb_read-module.html#model,Function lib.structure.pdb_write.model()=lib.structure.pdb_write-module.html#model,Module specific_analyses.model_free.model=specific_analyses.model_free.model-module.html,Module specific_analyses.relax_disp.model=specific_analyses.relax_disp.model-module.html"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-107', 'model', 'link-107');">model</a></tt><tt class="py-op">,</tt> <tt class="py-name">param_vector</tt><tt class="py-op">,</tt> <tt id="link-108" class="py-name" targets="Module test_suite.unit_tests._prompt.data_types=test_suite.unit_tests._prompt.data_types-module.html"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-108', 'data_types', 'link-108');">data_types</a></tt> <tt class="py-op">=</tt> <tt id="link-109" class="py-name"><a title="specific_analyses.frame_order.optimisation.target_fn_setup
specific_analyses.n_state_model.optimisation.target_fn_setup" class="py-name" href="#" onclick="return doclink('link-109', 'target_fn_setup', 'link-54');">target_fn_setup</a></tt><tt class="py-op">(</tt><tt class="py-name">scaling_matrix</tt><tt class="py-op">=</tt><tt class="py-name">scaling_matrix</tt><tt class="py-op">,</tt> <tt id="link-110" class="py-name" targets="Variable bmrblib.pystarlib.Text.verbosity=bmrblib.pystarlib.Text-module.html#verbosity,Variable bmrblib.pystarlib.verbosity=bmrblib.pystarlib-module.html#verbosity,Variable multi.multi_processor_base.verbosity=multi.multi_processor_base-module.html#verbosity,Variable multi.processor.verbosity=multi.processor-module.html#verbosity"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-110', 'verbosity', 'link-110');">verbosity</a></tt><tt class="py-op">=</tt><tt id="link-111" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-111', 'verbosity', 'link-110');">verbosity</a></tt><tt class="py-op">)</tt> </tt>
<a name="L156"></a><tt class="py-lineno">156</tt>  <tt class="py-line"> </tt>
<a name="L157"></a><tt class="py-lineno">157</tt>  <tt class="py-line">        <tt class="py-comment"># Calculate the chi-squared value.</tt> </tt>
<a name="L158"></a><tt class="py-lineno">158</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-112" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-112', 'model', 'link-107');">model</a></tt><tt class="py-op">:</tt> </tt>
<a name="L159"></a><tt class="py-lineno">159</tt>  <tt class="py-line">            <tt class="py-comment"># Make a function call.</tt> </tt>
<a name="L160"></a><tt class="py-lineno">160</tt>  <tt class="py-line">            <tt id="link-113" class="py-name" targets="Module target_functions.chi2=target_functions.chi2-module.html,Function target_functions.chi2.chi2()=target_functions.chi2-module.html#chi2"><a title="target_functions.chi2
target_functions.chi2.chi2" class="py-name" href="#" onclick="return doclink('link-113', 'chi2', 'link-113');">chi2</a></tt> <tt class="py-op">=</tt> <tt id="link-114" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-114', 'model', 'link-107');">model</a></tt><tt class="py-op">.</tt><tt id="link-115" class="py-name" targets="Method minfx.constraint_linear.Constraint_linear.func()=minfx.constraint_linear.Constraint_linear-class.html#func,Method target_functions.consistency_tests.Consistency.func()=target_functions.consistency_tests.Consistency-class.html#func,Method target_functions.ens_pivot_finder.Pivot_finder.func()=target_functions.ens_pivot_finder.Pivot_finder-class.html#func,Method target_functions.jw_mapping.Mapping.func()=target_functions.jw_mapping.Mapping-class.html#func"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func" class="py-name" href="#" onclick="return doclink('link-115', 'func', 'link-115');">func</a></tt><tt class="py-op">(</tt><tt class="py-name">param_vector</tt><tt class="py-op">)</tt> </tt>
<a name="L161"></a><tt class="py-lineno">161</tt>  <tt class="py-line"> </tt>
<a name="L162"></a><tt class="py-lineno">162</tt>  <tt class="py-line">            <tt class="py-comment"># Store the global chi-squared value.</tt> </tt>
<a name="L163"></a><tt class="py-lineno">163</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-116" class="py-name"><a title="target_functions.chi2
target_functions.chi2.chi2" class="py-name" href="#" onclick="return doclink('link-116', 'chi2', 'link-113');">chi2</a></tt> <tt class="py-op">=</tt> <tt id="link-117" class="py-name"><a title="target_functions.chi2
target_functions.chi2.chi2" class="py-name" href="#" onclick="return doclink('link-117', 'chi2', 'link-113');">chi2</a></tt> </tt>
<a name="L164"></a><tt class="py-lineno">164</tt>  <tt class="py-line"> </tt>
<a name="L165"></a><tt class="py-lineno">165</tt>  <tt class="py-line">            <tt class="py-comment"># Store the back-calculated data.</tt> </tt>
<a name="L166"></a><tt class="py-lineno">166</tt>  <tt class="py-line">            <tt id="link-118" class="py-name"><a title="specific_analyses.n_state_model.optimisation.minimise_bc_data" class="py-name" href="#" onclick="return doclink('link-118', 'minimise_bc_data', 'link-53');">minimise_bc_data</a></tt><tt class="py-op">(</tt><tt id="link-119" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-119', 'model', 'link-107');">model</a></tt><tt class="py-op">,</tt> <tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">)</tt> </tt>
<a name="L167"></a><tt class="py-lineno">167</tt>  <tt class="py-line"> </tt>
<a name="L168"></a><tt class="py-lineno">168</tt>  <tt class="py-line">            <tt class="py-comment"># Calculate the RDC Q factors.</tt> </tt>
<a name="L169"></a><tt class="py-lineno">169</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-string">'rdc'</tt> <tt class="py-keyword">in</tt> <tt id="link-120" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-120', 'data_types', 'link-108');">data_types</a></tt><tt class="py-op">:</tt> </tt>
<a name="L170"></a><tt class="py-lineno">170</tt>  <tt class="py-line">                <tt id="link-121" class="py-name"><a title="lib.alignment.rdc
pipe_control.rdc
test_suite.system_tests.rdc
user_functions.rdc" class="py-name" href="#" onclick="return doclink('link-121', 'rdc', 'link-27');">rdc</a></tt><tt class="py-op">.</tt><tt id="link-122" class="py-name" targets="Function pipe_control.pcs.q_factors()=pipe_control.pcs-module.html#q_factors,Function pipe_control.rdc.q_factors()=pipe_control.rdc-module.html#q_factors"><a title="pipe_control.pcs.q_factors
pipe_control.rdc.q_factors" class="py-name" href="#" onclick="return doclink('link-122', 'q_factors', 'link-122');">q_factors</a></tt><tt class="py-op">(</tt><tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">,</tt> <tt id="link-123" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-123', 'verbosity', 'link-110');">verbosity</a></tt><tt class="py-op">=</tt><tt id="link-124" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-124', 'verbosity', 'link-110');">verbosity</a></tt><tt class="py-op">)</tt> </tt>
<a name="L171"></a><tt class="py-lineno">171</tt>  <tt class="py-line"> </tt>
<a name="L172"></a><tt class="py-lineno">172</tt>  <tt class="py-line">            <tt class="py-comment"># Calculate the PCS Q factors.</tt> </tt>
<a name="L173"></a><tt class="py-lineno">173</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-string">'pcs'</tt> <tt class="py-keyword">in</tt> <tt id="link-125" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-125', 'data_types', 'link-108');">data_types</a></tt><tt class="py-op">:</tt> </tt>
<a name="L174"></a><tt class="py-lineno">174</tt>  <tt class="py-line">                <tt id="link-126" class="py-name"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-126', 'pcs', 'link-26');">pcs</a></tt><tt class="py-op">.</tt><tt id="link-127" class="py-name"><a title="pipe_control.pcs.q_factors
pipe_control.rdc.q_factors" class="py-name" href="#" onclick="return doclink('link-127', 'q_factors', 'link-122');">q_factors</a></tt><tt class="py-op">(</tt><tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">,</tt> <tt id="link-128" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-128', 'verbosity', 'link-110');">verbosity</a></tt><tt class="py-op">=</tt><tt id="link-129" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-129', 'verbosity', 'link-110');">verbosity</a></tt><tt class="py-op">)</tt> </tt>
<a name="L175"></a><tt class="py-lineno">175</tt>  <tt class="py-line"> </tt>
<a name="L176"></a><tt class="py-lineno">176</tt>  <tt class="py-line">        <tt class="py-comment"># NOE potential.</tt> </tt>
<a name="L177"></a><tt class="py-lineno">177</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'noe_restraints'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L178"></a><tt class="py-lineno">178</tt>  <tt class="py-line">            <tt class="py-comment"># Init some numpy arrays.</tt> </tt>
<a name="L179"></a><tt class="py-lineno">179</tt>  <tt class="py-line">            <tt class="py-name">num_restraints</tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-130" class="py-name" targets="Module test_suite.system_tests.noe_restraints=test_suite.system_tests.noe_restraints-module.html"><a title="test_suite.system_tests.noe_restraints" class="py-name" href="#" onclick="return doclink('link-130', 'noe_restraints', 'link-130');">noe_restraints</a></tt><tt class="py-op">)</tt> </tt>
<a name="L180"></a><tt class="py-lineno">180</tt>  <tt class="py-line">            <tt class="py-name">dist</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">num_restraints</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L181"></a><tt class="py-lineno">181</tt>  <tt class="py-line">            <tt class="py-name">pot</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">num_restraints</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L182"></a><tt class="py-lineno">182</tt>  <tt class="py-line">            <tt class="py-name">lower</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">num_restraints</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L183"></a><tt class="py-lineno">183</tt>  <tt class="py-line">            <tt class="py-name">upper</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">num_restraints</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L184"></a><tt class="py-lineno">184</tt>  <tt class="py-line"> </tt>
<a name="L185"></a><tt class="py-lineno">185</tt>  <tt class="py-line">            <tt class="py-comment"># Loop over the NOEs.</tt> </tt>
<a name="L186"></a><tt class="py-lineno">186</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-131" class="py-name" targets="Variable user_functions.molecule.i=user_functions.molecule-module.html#i"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-131', 'i', 'link-131');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">num_restraints</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L187"></a><tt class="py-lineno">187</tt>  <tt class="py-line">                <tt class="py-comment"># Create arrays of the NOEs.</tt> </tt>
<a name="L188"></a><tt class="py-lineno">188</tt>  <tt class="py-line">                <tt class="py-name">lower</tt><tt class="py-op">[</tt><tt id="link-132" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-132', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-133" class="py-name"><a title="test_suite.system_tests.noe_restraints" class="py-name" href="#" onclick="return doclink('link-133', 'noe_restraints', 'link-130');">noe_restraints</a></tt><tt class="py-op">[</tt><tt id="link-134" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-134', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt> </tt>
<a name="L189"></a><tt class="py-lineno">189</tt>  <tt class="py-line">                <tt class="py-name">upper</tt><tt class="py-op">[</tt><tt id="link-135" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-135', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-136" class="py-name"><a title="test_suite.system_tests.noe_restraints" class="py-name" href="#" onclick="return doclink('link-136', 'noe_restraints', 'link-130');">noe_restraints</a></tt><tt class="py-op">[</tt><tt id="link-137" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-137', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">3</tt><tt class="py-op">]</tt> </tt>
<a name="L190"></a><tt class="py-lineno">190</tt>  <tt class="py-line"> </tt>
<a name="L191"></a><tt class="py-lineno">191</tt>  <tt class="py-line">                <tt class="py-comment"># Calculate the average distances, using -6 power averaging.</tt> </tt>
<a name="L192"></a><tt class="py-lineno">192</tt>  <tt class="py-line">                <tt class="py-name">dist</tt><tt class="py-op">[</tt><tt id="link-138" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-138', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-139" class="py-name"><a title="specific_analyses.n_state_model.data.calc_ave_dist" class="py-name" href="#" onclick="return doclink('link-139', 'calc_ave_dist', 'link-48');">calc_ave_dist</a></tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-140" class="py-name"><a title="test_suite.system_tests.noe_restraints" class="py-name" href="#" onclick="return doclink('link-140', 'noe_restraints', 'link-130');">noe_restraints</a></tt><tt class="py-op">[</tt><tt id="link-141" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-141', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-142" class="py-name"><a title="test_suite.system_tests.noe_restraints" class="py-name" href="#" onclick="return doclink('link-142', 'noe_restraints', 'link-130');">noe_restraints</a></tt><tt class="py-op">[</tt><tt id="link-143" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-143', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">exp</tt><tt class="py-op">=</tt><tt class="py-op">-</tt><tt class="py-number">6</tt><tt class="py-op">)</tt> </tt>
<a name="L193"></a><tt class="py-lineno">193</tt>  <tt class="py-line"> </tt>
<a name="L194"></a><tt class="py-lineno">194</tt>  <tt class="py-line">            <tt class="py-comment"># Calculate the quadratic potential.</tt> </tt>
<a name="L195"></a><tt class="py-lineno">195</tt>  <tt class="py-line">            <tt id="link-144" class="py-name"><a title="target_functions.potential.quad_pot" class="py-name" href="#" onclick="return doclink('link-144', 'quad_pot', 'link-68');">quad_pot</a></tt><tt class="py-op">(</tt><tt class="py-name">dist</tt><tt class="py-op">,</tt> <tt class="py-name">pot</tt><tt class="py-op">,</tt> <tt class="py-name">lower</tt><tt class="py-op">,</tt> <tt class="py-name">upper</tt><tt class="py-op">)</tt> </tt>
<a name="L196"></a><tt class="py-lineno">196</tt>  <tt class="py-line"> </tt>
<a name="L197"></a><tt class="py-lineno">197</tt>  <tt class="py-line">            <tt class="py-comment"># Store the distance and potential information.</tt> </tt>
<a name="L198"></a><tt class="py-lineno">198</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">ave_dist</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L199"></a><tt class="py-lineno">199</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-145" class="py-name"><a title="target_functions.potential.quad_pot" class="py-name" href="#" onclick="return doclink('link-145', 'quad_pot', 'link-68');">quad_pot</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L200"></a><tt class="py-lineno">200</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-146" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-146', 'i', 'link-131');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">num_restraints</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L201"></a><tt class="py-lineno">201</tt>  <tt class="py-line">                <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">ave_dist</tt><tt class="py-op">.</tt><tt id="link-147" class="py-name" targets="Method data_store.diff_tensor.DiffTensorSimList.append()=data_store.diff_tensor.DiffTensorSimList-class.html#append"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-147', 'append', 'link-147');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-148" class="py-name"><a title="test_suite.system_tests.noe_restraints" class="py-name" href="#" onclick="return doclink('link-148', 'noe_restraints', 'link-130');">noe_restraints</a></tt><tt class="py-op">[</tt><tt id="link-149" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-149', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-150" class="py-name"><a title="test_suite.system_tests.noe_restraints" class="py-name" href="#" onclick="return doclink('link-150', 'noe_restraints', 'link-130');">noe_restraints</a></tt><tt class="py-op">[</tt><tt id="link-151" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-151', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">dist</tt><tt class="py-op">[</tt><tt id="link-152" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-152', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L202"></a><tt class="py-lineno">202</tt>  <tt class="py-line">                <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-153" class="py-name"><a title="target_functions.potential.quad_pot" class="py-name" href="#" onclick="return doclink('link-153', 'quad_pot', 'link-68');">quad_pot</a></tt><tt class="py-op">.</tt><tt id="link-154" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-154', 'append', 'link-147');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-155" class="py-name"><a title="test_suite.system_tests.noe_restraints" class="py-name" href="#" onclick="return doclink('link-155', 'noe_restraints', 'link-130');">noe_restraints</a></tt><tt class="py-op">[</tt><tt id="link-156" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-156', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-157" class="py-name"><a title="test_suite.system_tests.noe_restraints" class="py-name" href="#" onclick="return doclink('link-157', 'noe_restraints', 'link-130');">noe_restraints</a></tt><tt class="py-op">[</tt><tt id="link-158" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-158', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">pot</tt><tt class="py-op">[</tt><tt id="link-159" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-159', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
</div><a name="L203"></a><tt class="py-lineno">203</tt>  <tt class="py-line"> </tt>
<a name="L204"></a><tt class="py-lineno">204</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.create_mc_data"></a><div id="N_state_model.create_mc_data-def"><a name="L205"></a><tt class="py-lineno">205</tt> <a class="py-toggle" href="#" id="N_state_model.create_mc_data-toggle" onclick="return toggle('N_state_model.create_mc_data');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.api.N_state_model-class.html#create_mc_data">create_mc_data</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">data_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.create_mc_data-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="N_state_model.create_mc_data-expanded"><a name="L206"></a><tt class="py-lineno">206</tt>  <tt class="py-line">        <tt class="py-docstring">"""Create the Monte Carlo data by back-calculation.</tt> </tt>
<a name="L207"></a><tt class="py-lineno">207</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L208"></a><tt class="py-lineno">208</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword data_id:   The list of spin ID, data type, and alignment ID, as yielded by the base_data_loop() generator method.</tt> </tt>
<a name="L209"></a><tt class="py-lineno">209</tt>  <tt class="py-line"><tt class="py-docstring">        @type data_id:      str</tt> </tt>
<a name="L210"></a><tt class="py-lineno">210</tt>  <tt class="py-line"><tt class="py-docstring">        @return:            The Monte Carlo Ri data.</tt> </tt>
<a name="L211"></a><tt class="py-lineno">211</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:             list of floats</tt> </tt>
<a name="L212"></a><tt class="py-lineno">212</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L213"></a><tt class="py-lineno">213</tt>  <tt class="py-line"> </tt>
<a name="L214"></a><tt class="py-lineno">214</tt>  <tt class="py-line">        <tt class="py-comment"># Initialise the MC data structure.</tt> </tt>
<a name="L215"></a><tt class="py-lineno">215</tt>  <tt class="py-line">        <tt class="py-name">mc_data</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L216"></a><tt class="py-lineno">216</tt>  <tt class="py-line"> </tt>
<a name="L217"></a><tt class="py-lineno">217</tt>  <tt class="py-line">        <tt class="py-comment"># Alias the spin or interatomic data container.</tt> </tt>
<a name="L218"></a><tt class="py-lineno">218</tt>  <tt class="py-line">        <tt id="link-160" class="py-name" targets="Module test_suite.unit_tests._prompt.container=test_suite.unit_tests._prompt.container-module.html"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-160', 'container', 'link-160');">container</a></tt> <tt class="py-op">=</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L219"></a><tt class="py-lineno">219</tt>  <tt class="py-line"> </tt>
<a name="L220"></a><tt class="py-lineno">220</tt>  <tt class="py-line">        <tt class="py-comment"># RDC data.</tt> </tt>
<a name="L221"></a><tt class="py-lineno">221</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'rdc'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-161" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-161', 'container', 'link-160');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'rdc'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L222"></a><tt class="py-lineno">222</tt>  <tt class="py-line">            <tt class="py-comment"># Does back-calculated data exist?</tt> </tt>
<a name="L223"></a><tt class="py-lineno">223</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-162" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-162', 'container', 'link-160');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'rdc_bc'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L224"></a><tt class="py-lineno">224</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-163" class="py-name" targets="Method specific_analyses.api_base.API_base.calculate()=specific_analyses.api_base.API_base-class.html#calculate,Method specific_analyses.consistency_tests.api.Consistency_tests.calculate()=specific_analyses.consistency_tests.api.Consistency_tests-class.html#calculate,Method specific_analyses.frame_order.api.Frame_order.calculate()=specific_analyses.frame_order.api.Frame_order-class.html#calculate,Method specific_analyses.jw_mapping.api.Jw_mapping.calculate()=specific_analyses.jw_mapping.api.Jw_mapping-class.html#calculate,Method specific_analyses.model_free.api.Model_free.calculate()=specific_analyses.model_free.api.Model_free-class.html#calculate,Method specific_analyses.n_state_model.api.N_state_model.calculate()=specific_analyses.n_state_model.api.N_state_model-class.html#calculate,Method specific_analyses.noe.api.Noe.calculate()=specific_analyses.noe.api.Noe-class.html#calculate,Method specific_analyses.relax_disp.api.Relax_disp.calculate()=specific_analyses.relax_disp.api.Relax_disp-class.html#calculate"><a title="specific_analyses.api_base.API_base.calculate
specific_analyses.consistency_tests.api.Consistency_tests.calculate
specific_analyses.frame_order.api.Frame_order.calculate
specific_analyses.jw_mapping.api.Jw_mapping.calculate
specific_analyses.model_free.api.Model_free.calculate
specific_analyses.n_state_model.api.N_state_model.calculate
specific_analyses.noe.api.Noe.calculate
specific_analyses.relax_disp.api.Relax_disp.calculate" class="py-name" href="#" onclick="return doclink('link-163', 'calculate', 'link-163');">calculate</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L225"></a><tt class="py-lineno">225</tt>  <tt class="py-line"> </tt>
<a name="L226"></a><tt class="py-lineno">226</tt>  <tt class="py-line">            <tt class="py-comment"># The data.</tt> </tt>
<a name="L227"></a><tt class="py-lineno">227</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-164" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-164', 'container', 'link-160');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'rdc_bc'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt> <tt class="py-keyword">in</tt> <tt id="link-165" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-165', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_bc</tt><tt class="py-op">:</tt> </tt>
<a name="L228"></a><tt class="py-lineno">228</tt>  <tt class="py-line">                <tt id="link-166" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-166', 'data', 'link-46');">data</a></tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L229"></a><tt class="py-lineno">229</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L230"></a><tt class="py-lineno">230</tt>  <tt class="py-line">                <tt id="link-167" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-167', 'data', 'link-46');">data</a></tt> <tt class="py-op">=</tt> <tt id="link-168" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-168', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_bc</tt><tt class="py-op">[</tt><tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">]</tt> </tt>
<a name="L231"></a><tt class="py-lineno">231</tt>  <tt class="py-line"> </tt>
<a name="L232"></a><tt class="py-lineno">232</tt>  <tt class="py-line">            <tt class="py-comment"># Append the data.</tt> </tt>
<a name="L233"></a><tt class="py-lineno">233</tt>  <tt class="py-line">            <tt class="py-name">mc_data</tt><tt class="py-op">.</tt><tt id="link-169" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-169', 'append', 'link-147');">append</a></tt><tt class="py-op">(</tt><tt id="link-170" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-170', 'data', 'link-46');">data</a></tt><tt class="py-op">)</tt> </tt>
<a name="L234"></a><tt class="py-lineno">234</tt>  <tt class="py-line"> </tt>
<a name="L235"></a><tt class="py-lineno">235</tt>  <tt class="py-line">        <tt class="py-comment"># NOESY data.</tt> </tt>
<a name="L236"></a><tt class="py-lineno">236</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'noesy'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-171" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-171', 'container', 'link-160');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'noesy'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L237"></a><tt class="py-lineno">237</tt>  <tt class="py-line">            <tt class="py-comment"># Does back-calculated data exist?</tt> </tt>
<a name="L238"></a><tt class="py-lineno">238</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-172" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-172', 'container', 'link-160');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'noesy_bc'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L239"></a><tt class="py-lineno">239</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-173" class="py-name"><a title="specific_analyses.api_base.API_base.calculate
specific_analyses.consistency_tests.api.Consistency_tests.calculate
specific_analyses.frame_order.api.Frame_order.calculate
specific_analyses.jw_mapping.api.Jw_mapping.calculate
specific_analyses.model_free.api.Model_free.calculate
specific_analyses.n_state_model.api.N_state_model.calculate
specific_analyses.noe.api.Noe.calculate
specific_analyses.relax_disp.api.Relax_disp.calculate" class="py-name" href="#" onclick="return doclink('link-173', 'calculate', 'link-163');">calculate</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L240"></a><tt class="py-lineno">240</tt>  <tt class="py-line"> </tt>
<a name="L241"></a><tt class="py-lineno">241</tt>  <tt class="py-line">            <tt class="py-comment"># Append the data.</tt> </tt>
<a name="L242"></a><tt class="py-lineno">242</tt>  <tt class="py-line">            <tt class="py-name">mc_data</tt><tt class="py-op">.</tt><tt id="link-174" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-174', 'append', 'link-147');">append</a></tt><tt class="py-op">(</tt><tt id="link-175" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-175', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">noesy_bc</tt><tt class="py-op">)</tt> </tt>
<a name="L243"></a><tt class="py-lineno">243</tt>  <tt class="py-line"> </tt>
<a name="L244"></a><tt class="py-lineno">244</tt>  <tt class="py-line">        <tt class="py-comment"># PCS data.</tt> </tt>
<a name="L245"></a><tt class="py-lineno">245</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'pcs'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-176" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-176', 'container', 'link-160');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L246"></a><tt class="py-lineno">246</tt>  <tt class="py-line">            <tt class="py-comment"># Does back-calculated data exist?</tt> </tt>
<a name="L247"></a><tt class="py-lineno">247</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-177" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-177', 'container', 'link-160');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_bc'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L248"></a><tt class="py-lineno">248</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-178" class="py-name"><a title="specific_analyses.api_base.API_base.calculate
specific_analyses.consistency_tests.api.Consistency_tests.calculate
specific_analyses.frame_order.api.Frame_order.calculate
specific_analyses.jw_mapping.api.Jw_mapping.calculate
specific_analyses.model_free.api.Model_free.calculate
specific_analyses.n_state_model.api.N_state_model.calculate
specific_analyses.noe.api.Noe.calculate
specific_analyses.relax_disp.api.Relax_disp.calculate" class="py-name" href="#" onclick="return doclink('link-178', 'calculate', 'link-163');">calculate</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L249"></a><tt class="py-lineno">249</tt>  <tt class="py-line"> </tt>
<a name="L250"></a><tt class="py-lineno">250</tt>  <tt class="py-line">            <tt class="py-comment"># The data.</tt> </tt>
<a name="L251"></a><tt class="py-lineno">251</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-179" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-179', 'container', 'link-160');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_bc'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt> <tt class="py-keyword">in</tt> <tt id="link-180" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-180', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_bc</tt><tt class="py-op">:</tt> </tt>
<a name="L252"></a><tt class="py-lineno">252</tt>  <tt class="py-line">                <tt id="link-181" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-181', 'data', 'link-46');">data</a></tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L253"></a><tt class="py-lineno">253</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L254"></a><tt class="py-lineno">254</tt>  <tt class="py-line">                <tt id="link-182" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-182', 'data', 'link-46');">data</a></tt> <tt class="py-op">=</tt> <tt id="link-183" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-183', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_bc</tt><tt class="py-op">[</tt><tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">]</tt> </tt>
<a name="L255"></a><tt class="py-lineno">255</tt>  <tt class="py-line"> </tt>
<a name="L256"></a><tt class="py-lineno">256</tt>  <tt class="py-line">            <tt class="py-comment"># Append the data.</tt> </tt>
<a name="L257"></a><tt class="py-lineno">257</tt>  <tt class="py-line">            <tt class="py-name">mc_data</tt><tt class="py-op">.</tt><tt id="link-184" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-184', 'append', 'link-147');">append</a></tt><tt class="py-op">(</tt><tt id="link-185" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-185', 'data', 'link-46');">data</a></tt><tt class="py-op">)</tt> </tt>
<a name="L258"></a><tt class="py-lineno">258</tt>  <tt class="py-line"> </tt>
<a name="L259"></a><tt class="py-lineno">259</tt>  <tt class="py-line">        <tt class="py-comment"># Return the data.</tt> </tt>
<a name="L260"></a><tt class="py-lineno">260</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">mc_data</tt> </tt>
</div><a name="L261"></a><tt class="py-lineno">261</tt>  <tt class="py-line"> </tt>
<a name="L262"></a><tt class="py-lineno">262</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.get_param_names"></a><div id="N_state_model.get_param_names-def"><a name="L263"></a><tt class="py-lineno">263</tt> <a class="py-toggle" href="#" id="N_state_model.get_param_names-toggle" onclick="return toggle('N_state_model.get_param_names');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.api.N_state_model-class.html#get_param_names">get_param_names</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">model_info</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.get_param_names-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="N_state_model.get_param_names-expanded"><a name="L264"></a><tt class="py-lineno">264</tt>  <tt class="py-line">        <tt class="py-docstring">"""Return a vector of parameter names.</tt> </tt>
<a name="L265"></a><tt class="py-lineno">265</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L266"></a><tt class="py-lineno">266</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword model_info:    The model information from model_loop().  This is unused.</tt> </tt>
<a name="L267"></a><tt class="py-lineno">267</tt>  <tt class="py-line"><tt class="py-docstring">        @type model_info:       None</tt> </tt>
<a name="L268"></a><tt class="py-lineno">268</tt>  <tt class="py-line"><tt class="py-docstring">        @return:                The vector of parameter names.</tt> </tt>
<a name="L269"></a><tt class="py-lineno">269</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:                 list of str</tt> </tt>
<a name="L270"></a><tt class="py-lineno">270</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L271"></a><tt class="py-lineno">271</tt>  <tt class="py-line"> </tt>
<a name="L272"></a><tt class="py-lineno">272</tt>  <tt class="py-line">        <tt class="py-comment"># Init.</tt> </tt>
<a name="L273"></a><tt class="py-lineno">273</tt>  <tt class="py-line">        <tt class="py-name">param_names</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L274"></a><tt class="py-lineno">274</tt>  <tt class="py-line"> </tt>
<a name="L275"></a><tt class="py-lineno">275</tt>  <tt class="py-line">        <tt class="py-comment"># A RDC or PCS data type requires the alignment tensors to be at the start of the parameter vector (unless the tensors are fixed).</tt> </tt>
<a name="L276"></a><tt class="py-lineno">276</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-186" class="py-name"><a title="pipe_control.align_tensor.opt_uses_align_data
specific_analyses.frame_order.optimisation.opt_uses_align_data" class="py-name" href="#" onclick="return doclink('link-186', 'opt_uses_align_data', 'link-30');">opt_uses_align_data</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L277"></a><tt class="py-lineno">277</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-187" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-187', 'i', 'link-131');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L278"></a><tt class="py-lineno">278</tt>  <tt class="py-line">                <tt class="py-comment"># Skip non-optimised tensors.</tt> </tt>
<a name="L279"></a><tt class="py-lineno">279</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-188" class="py-name"><a title="pipe_control.align_tensor.opt_uses_tensor" class="py-name" href="#" onclick="return doclink('link-188', 'opt_uses_tensor', 'link-31');">opt_uses_tensor</a></tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">[</tt><tt id="link-189" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-189', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L280"></a><tt class="py-lineno">280</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L281"></a><tt class="py-lineno">281</tt>  <tt class="py-line"> </tt>
<a name="L282"></a><tt class="py-lineno">282</tt>  <tt class="py-line">                <tt class="py-comment"># Add the parameters.</tt> </tt>
<a name="L283"></a><tt class="py-lineno">283</tt>  <tt class="py-line">                <tt class="py-name">param_names</tt> <tt class="py-op">+=</tt> <tt class="py-op">[</tt><tt class="py-string">'Axx'</tt><tt class="py-op">,</tt> <tt class="py-string">'Ayy'</tt><tt class="py-op">,</tt> <tt class="py-string">'Axy'</tt><tt class="py-op">,</tt> <tt class="py-string">'Axz'</tt><tt class="py-op">,</tt> <tt class="py-string">'Ayz'</tt><tt class="py-op">]</tt> </tt>
<a name="L284"></a><tt class="py-lineno">284</tt>  <tt class="py-line"> </tt>
<a name="L285"></a><tt class="py-lineno">285</tt>  <tt class="py-line">        <tt class="py-comment"># Populations.</tt> </tt>
<a name="L286"></a><tt class="py-lineno">286</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-190" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-190', 'model', 'link-107');">model</a></tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt class="py-string">'2-domain'</tt><tt class="py-op">,</tt> <tt class="py-string">'population'</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L287"></a><tt class="py-lineno">287</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-191" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-191', 'i', 'link-131');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">N</tt> <tt class="py-op">-</tt> <tt class="py-number">1</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L288"></a><tt class="py-lineno">288</tt>  <tt class="py-line">                <tt class="py-name">param_names</tt><tt class="py-op">.</tt><tt id="link-192" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-192', 'append', 'link-147');">append</a></tt><tt class="py-op">(</tt><tt class="py-string">'probs'</tt><tt class="py-op">)</tt> </tt>
<a name="L289"></a><tt class="py-lineno">289</tt>  <tt class="py-line"> </tt>
<a name="L290"></a><tt class="py-lineno">290</tt>  <tt class="py-line">        <tt class="py-comment"># The Euler angles.</tt> </tt>
<a name="L291"></a><tt class="py-lineno">291</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-193" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-193', 'model', 'link-107');">model</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'2-domain'</tt><tt class="py-op">:</tt> </tt>
<a name="L292"></a><tt class="py-lineno">292</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-194" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-194', 'i', 'link-131');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">N</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L293"></a><tt class="py-lineno">293</tt>  <tt class="py-line">                <tt class="py-name">param_names</tt><tt class="py-op">.</tt><tt id="link-195" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-195', 'append', 'link-147');">append</a></tt><tt class="py-op">(</tt><tt class="py-string">'alpha'</tt><tt class="py-op">)</tt> </tt>
<a name="L294"></a><tt class="py-lineno">294</tt>  <tt class="py-line">                <tt class="py-name">param_names</tt><tt class="py-op">.</tt><tt id="link-196" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-196', 'append', 'link-147');">append</a></tt><tt class="py-op">(</tt><tt class="py-string">'beta'</tt><tt class="py-op">)</tt> </tt>
<a name="L295"></a><tt class="py-lineno">295</tt>  <tt class="py-line">                <tt class="py-name">param_names</tt><tt class="py-op">.</tt><tt id="link-197" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-197', 'append', 'link-147');">append</a></tt><tt class="py-op">(</tt><tt class="py-string">'gamma'</tt><tt class="py-op">)</tt> </tt>
<a name="L296"></a><tt class="py-lineno">296</tt>  <tt class="py-line"> </tt>
<a name="L297"></a><tt class="py-lineno">297</tt>  <tt class="py-line">        <tt class="py-comment"># The paramagnetic centre.</tt> </tt>
<a name="L298"></a><tt class="py-lineno">298</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'paramag_centre_fixed'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramag_centre_fixed</tt><tt class="py-op">:</tt> </tt>
<a name="L299"></a><tt class="py-lineno">299</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-198" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-198', 'i', 'link-131');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-number">3</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L300"></a><tt class="py-lineno">300</tt>  <tt class="py-line">                <tt class="py-name">param_names</tt><tt class="py-op">.</tt><tt id="link-199" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-199', 'append', 'link-147');">append</a></tt><tt class="py-op">(</tt><tt class="py-string">'paramagnetic_centre'</tt><tt class="py-op">)</tt> </tt>
<a name="L301"></a><tt class="py-lineno">301</tt>  <tt class="py-line"> </tt>
<a name="L302"></a><tt class="py-lineno">302</tt>  <tt class="py-line">        <tt class="py-comment"># Return the list.</tt> </tt>
<a name="L303"></a><tt class="py-lineno">303</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">param_names</tt> </tt>
</div><a name="L304"></a><tt class="py-lineno">304</tt>  <tt class="py-line"> </tt>
<a name="L305"></a><tt class="py-lineno">305</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.get_param_values"></a><div id="N_state_model.get_param_values-def"><a name="L306"></a><tt class="py-lineno">306</tt> <a class="py-toggle" href="#" id="N_state_model.get_param_values-toggle" onclick="return toggle('N_state_model.get_param_values');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.api.N_state_model-class.html#get_param_values">get_param_values</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">model_info</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.get_param_values-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="N_state_model.get_param_values-expanded"><a name="L307"></a><tt class="py-lineno">307</tt>  <tt class="py-line">        <tt class="py-docstring">"""Return a vector of parameter values.</tt> </tt>
<a name="L308"></a><tt class="py-lineno">308</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L309"></a><tt class="py-lineno">309</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword model_info:    The model information from model_loop().  This is unused.</tt> </tt>
<a name="L310"></a><tt class="py-lineno">310</tt>  <tt class="py-line"><tt class="py-docstring">        @type model_info:       None</tt> </tt>
<a name="L311"></a><tt class="py-lineno">311</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword sim_index:     The optional Monte Carlo simulation index.</tt> </tt>
<a name="L312"></a><tt class="py-lineno">312</tt>  <tt class="py-line"><tt class="py-docstring">        @type sim_index:        int</tt> </tt>
<a name="L313"></a><tt class="py-lineno">313</tt>  <tt class="py-line"><tt class="py-docstring">        @return:                The vector of parameter values.</tt> </tt>
<a name="L314"></a><tt class="py-lineno">314</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:                 list of str</tt> </tt>
<a name="L315"></a><tt class="py-lineno">315</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L316"></a><tt class="py-lineno">316</tt>  <tt class="py-line"> </tt>
<a name="L317"></a><tt class="py-lineno">317</tt>  <tt class="py-line">        <tt class="py-comment"># Return the vector.</tt> </tt>
<a name="L318"></a><tt class="py-lineno">318</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt id="link-200" class="py-name"><a title="specific_analyses.frame_order.parameters.assemble_param_vector
specific_analyses.model_free.parameters.assemble_param_vector
specific_analyses.n_state_model.parameters.assemble_param_vector
specific_analyses.relax_disp.parameters.assemble_param_vector
specific_analyses.relax_fit.parameters.assemble_param_vector
test_suite.unit_tests._lib._dispersion.test_cr72_full_cluster_one_field.Test_cr72_full_cluster_one_field.assemble_param_vector
test_suite.unit_tests._lib._dispersion.test_cr72_full_cluster_three_fields.Test_cr72_full_cluster_three_fields.assemble_param_vector" class="py-name" href="#" onclick="return doclink('link-200', 'assemble_param_vector', 'link-62');">assemble_param_vector</a></tt><tt class="py-op">(</tt><tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">)</tt> </tt>
</div><a name="L319"></a><tt class="py-lineno">319</tt>  <tt class="py-line"> </tt>
<a name="L320"></a><tt class="py-lineno">320</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.grid_search"></a><div id="N_state_model.grid_search-def"><a name="L321"></a><tt class="py-lineno">321</tt> <a class="py-toggle" href="#" id="N_state_model.grid_search-toggle" onclick="return toggle('N_state_model.grid_search');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.api.N_state_model-class.html#grid_search">grid_search</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">lower</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">upper</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">inc</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">scaling_matrix</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">constraints</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">,</tt> <tt class="py-param">verbosity</tt><tt class="py-op">=</tt><tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-param">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.grid_search-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="N_state_model.grid_search-expanded"><a name="L322"></a><tt class="py-lineno">322</tt>  <tt class="py-line">        <tt class="py-docstring">"""The grid search function.</tt> </tt>
<a name="L323"></a><tt class="py-lineno">323</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L324"></a><tt class="py-lineno">324</tt>  <tt class="py-line"><tt class="py-docstring">        @param lower:           The lower bounds of the grid search which must be equal to the number of parameters in the model.</tt> </tt>
<a name="L325"></a><tt class="py-lineno">325</tt>  <tt class="py-line"><tt class="py-docstring">        @type lower:            list of lists of floats</tt> </tt>
<a name="L326"></a><tt class="py-lineno">326</tt>  <tt class="py-line"><tt class="py-docstring">        @param upper:           The upper bounds of the grid search which must be equal to the number of parameters in the model.</tt> </tt>
<a name="L327"></a><tt class="py-lineno">327</tt>  <tt class="py-line"><tt class="py-docstring">        @type upper:            list of lists of floats</tt> </tt>
<a name="L328"></a><tt class="py-lineno">328</tt>  <tt class="py-line"><tt class="py-docstring">        @param inc:             The increments for each dimension of the space for the grid search.  The number of elements in the array must equal to the number of parameters in the model.</tt> </tt>
<a name="L329"></a><tt class="py-lineno">329</tt>  <tt class="py-line"><tt class="py-docstring">        @type inc:              list of lists of int</tt> </tt>
<a name="L330"></a><tt class="py-lineno">330</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword scaling_matrix:    The per-model list of diagonal and square scaling matrices.</tt> </tt>
<a name="L331"></a><tt class="py-lineno">331</tt>  <tt class="py-line"><tt class="py-docstring">        @type scaling_matrix:       list of numpy rank-2, float64 array or list of None</tt> </tt>
<a name="L332"></a><tt class="py-lineno">332</tt>  <tt class="py-line"><tt class="py-docstring">        @param constraints:     If True, constraints are applied during the grid search (elinating parts of the grid).  If False, no constraints are used.</tt> </tt>
<a name="L333"></a><tt class="py-lineno">333</tt>  <tt class="py-line"><tt class="py-docstring">        @type constraints:      bool</tt> </tt>
<a name="L334"></a><tt class="py-lineno">334</tt>  <tt class="py-line"><tt class="py-docstring">        @param verbosity:       A flag specifying the amount of information to print.  The higher the value, the greater the verbosity.</tt> </tt>
<a name="L335"></a><tt class="py-lineno">335</tt>  <tt class="py-line"><tt class="py-docstring">        @type verbosity:        int</tt> </tt>
<a name="L336"></a><tt class="py-lineno">336</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L337"></a><tt class="py-lineno">337</tt>  <tt class="py-line"> </tt>
<a name="L338"></a><tt class="py-lineno">338</tt>  <tt class="py-line">        <tt class="py-comment"># Test if the N-state model has been set up.</tt> </tt>
<a name="L339"></a><tt class="py-lineno">339</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'model'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L340"></a><tt class="py-lineno">340</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-201" class="py-name"><a title="lib.errors.RelaxNoModelError" class="py-name" href="#" onclick="return doclink('link-201', 'RelaxNoModelError', 'link-16');">RelaxNoModelError</a></tt><tt class="py-op">(</tt><tt class="py-string">'N-state'</tt><tt class="py-op">)</tt> </tt>
<a name="L341"></a><tt class="py-lineno">341</tt>  <tt class="py-line"> </tt>
<a name="L342"></a><tt class="py-lineno">342</tt>  <tt class="py-line">        <tt class="py-comment"># The number of parameters.</tt> </tt>
<a name="L343"></a><tt class="py-lineno">343</tt>  <tt class="py-line">        <tt class="py-name">n</tt> <tt class="py-op">=</tt> <tt id="link-202" class="py-name"><a title="specific_analyses.frame_order.parameters.param_num
specific_analyses.n_state_model.parameters.param_num
specific_analyses.relax_disp.parameters.param_num" class="py-name" href="#" onclick="return doclink('link-202', 'param_num', 'link-65');">param_num</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L344"></a><tt class="py-lineno">344</tt>  <tt class="py-line"> </tt>
<a name="L345"></a><tt class="py-lineno">345</tt>  <tt class="py-line">        <tt class="py-comment"># Determine the data type.</tt> </tt>
<a name="L346"></a><tt class="py-lineno">346</tt>  <tt class="py-line">        <tt id="link-203" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-203', 'data_types', 'link-108');">data_types</a></tt> <tt class="py-op">=</tt> <tt id="link-204" class="py-name"><a title="specific_analyses.frame_order.data.base_data_types
specific_analyses.n_state_model.data.base_data_types" class="py-name" href="#" onclick="return doclink('link-204', 'base_data_types', 'link-47');">base_data_types</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L347"></a><tt class="py-lineno">347</tt>  <tt class="py-line"> </tt>
<a name="L348"></a><tt class="py-lineno">348</tt>  <tt class="py-line">        <tt class="py-comment"># The number of tensors to optimise.</tt> </tt>
<a name="L349"></a><tt class="py-lineno">349</tt>  <tt class="py-line">        <tt class="py-name">tensor_num</tt> <tt class="py-op">=</tt> <tt id="link-205" class="py-name"><a title="data_store.align_tensor
pipe_control.align_tensor
test_suite.system_tests.align_tensor
user_functions.align_tensor" class="py-name" href="#" onclick="return doclink('link-205', 'align_tensor', 'link-25');">align_tensor</a></tt><tt class="py-op">.</tt><tt id="link-206" class="py-name" targets="Function pipe_control.align_tensor.num_tensors()=pipe_control.align_tensor-module.html#num_tensors"><a title="pipe_control.align_tensor.num_tensors" class="py-name" href="#" onclick="return doclink('link-206', 'num_tensors', 'link-206');">num_tensors</a></tt><tt class="py-op">(</tt><tt class="py-name">skip_fixed</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L350"></a><tt class="py-lineno">350</tt>  <tt class="py-line"> </tt>
<a name="L351"></a><tt class="py-lineno">351</tt>  <tt class="py-line">        <tt class="py-comment"># Custom sub-grid search for when only tensors are optimised (as each tensor is independent, the number of points collapses from inc**(5*N) to N*inc**5).</tt> </tt>
<a name="L352"></a><tt class="py-lineno">352</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-207" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-207', 'model', 'link-107');">model</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'fixed'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">tensor_num</tt> <tt class="py-op">&gt;</tt> <tt class="py-number">1</tt> <tt class="py-keyword">and</tt> <tt class="py-op">(</tt><tt class="py-string">'rdc'</tt> <tt class="py-keyword">in</tt> <tt id="link-208" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-208', 'data_types', 'link-108');">data_types</a></tt> <tt class="py-keyword">or</tt> <tt class="py-string">'pcs'</tt> <tt class="py-keyword">in</tt> <tt id="link-209" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-209', 'data_types', 'link-108');">data_types</a></tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt id="link-210" class="py-name"><a title="data_store.align_tensor
pipe_control.align_tensor
test_suite.system_tests.align_tensor
user_functions.align_tensor" class="py-name" href="#" onclick="return doclink('link-210', 'align_tensor', 'link-25');">align_tensor</a></tt><tt class="py-op">.</tt><tt id="link-211" class="py-name" targets="Function pipe_control.align_tensor.all_tensors_fixed()=pipe_control.align_tensor-module.html#all_tensors_fixed"><a title="pipe_control.align_tensor.all_tensors_fixed" class="py-name" href="#" onclick="return doclink('link-211', 'all_tensors_fixed', 'link-211');">all_tensors_fixed</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'paramag_centre_fixed'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramag_centre_fixed</tt><tt class="py-op">:</tt> </tt>
<a name="L353"></a><tt class="py-lineno">353</tt>  <tt class="py-line">            <tt class="py-comment"># Print out.</tt> </tt>
<a name="L354"></a><tt class="py-lineno">354</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Optimising each alignment tensor separately."</tt><tt class="py-op">)</tt> </tt>
<a name="L355"></a><tt class="py-lineno">355</tt>  <tt class="py-line"> </tt>
<a name="L356"></a><tt class="py-lineno">356</tt>  <tt class="py-line">            <tt class="py-comment"># Store the alignment tensor fixed flags.</tt> </tt>
<a name="L357"></a><tt class="py-lineno">357</tt>  <tt class="py-line">            <tt class="py-name">fixed_flags</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L358"></a><tt class="py-lineno">358</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-212" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-212', 'i', 'link-131');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L359"></a><tt class="py-lineno">359</tt>  <tt class="py-line">                <tt class="py-comment"># Get the tensor object.</tt> </tt>
<a name="L360"></a><tt class="py-lineno">360</tt>  <tt class="py-line">                <tt id="link-213" class="py-name" targets="Module bmrblib.structure.tensor=bmrblib.structure.tensor-module.html"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-213', 'tensor', 'link-213');">tensor</a></tt> <tt class="py-op">=</tt> <tt id="link-214" class="py-name"><a title="data_store.align_tensor
pipe_control.align_tensor
test_suite.system_tests.align_tensor
user_functions.align_tensor" class="py-name" href="#" onclick="return doclink('link-214', 'align_tensor', 'link-25');">align_tensor</a></tt><tt class="py-op">.</tt><tt id="link-215" class="py-name" targets="Function pipe_control.align_tensor.return_tensor()=pipe_control.align_tensor-module.html#return_tensor"><a title="pipe_control.align_tensor.return_tensor" class="py-name" href="#" onclick="return doclink('link-215', 'return_tensor', 'link-215');">return_tensor</a></tt><tt class="py-op">(</tt><tt class="py-name">index</tt><tt class="py-op">=</tt><tt id="link-216" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-216', 'i', 'link-131');">i</a></tt><tt class="py-op">,</tt> <tt class="py-name">skip_fixed</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt> </tt>
<a name="L361"></a><tt class="py-lineno">361</tt>  <tt class="py-line"> </tt>
<a name="L362"></a><tt class="py-lineno">362</tt>  <tt class="py-line">                <tt class="py-comment"># Store the flag.</tt> </tt>
<a name="L363"></a><tt class="py-lineno">363</tt>  <tt class="py-line">                <tt class="py-name">fixed_flags</tt><tt class="py-op">.</tt><tt id="link-217" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-217', 'append', 'link-147');">append</a></tt><tt class="py-op">(</tt><tt id="link-218" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-218', 'tensor', 'link-213');">tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">fixed</tt><tt class="py-op">)</tt> </tt>
<a name="L364"></a><tt class="py-lineno">364</tt>  <tt class="py-line"> </tt>
<a name="L365"></a><tt class="py-lineno">365</tt>  <tt class="py-line">                <tt class="py-comment"># Fix the tensor.</tt> </tt>
<a name="L366"></a><tt class="py-lineno">366</tt>  <tt class="py-line">                <tt id="link-219" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-219', 'tensor', 'link-213');">tensor</a></tt><tt class="py-op">.</tt><tt id="link-220" class="py-name" targets="Method data_store.align_tensor.AlignTensorData.set()=data_store.align_tensor.AlignTensorData-class.html#set,Method data_store.diff_tensor.DiffTensorData.set()=data_store.diff_tensor.DiffTensorData-class.html#set,Method multi.misc.Verbosity.set()=multi.misc.Verbosity-class.html#set,Function pipe_control.align_tensor.set()=pipe_control.align_tensor-module.html#set,Function pipe_control.diffusion_tensor.set()=pipe_control.diffusion_tensor-module.html#set,Function pipe_control.minimise.set()=pipe_control.minimise-module.html#set,Function pipe_control.value.set()=pipe_control.value-module.html#set,Method specific_analyses.parameter_object.Param_list.set()=specific_analyses.parameter_object.Param_list-class.html#set"><a title="data_store.align_tensor.AlignTensorData.set
data_store.diff_tensor.DiffTensorData.set
multi.misc.Verbosity.set
pipe_control.align_tensor.set
pipe_control.diffusion_tensor.set
pipe_control.minimise.set
pipe_control.value.set
specific_analyses.parameter_object.Param_list.set" class="py-name" href="#" onclick="return doclink('link-220', 'set', 'link-220');">set</a></tt><tt class="py-op">(</tt><tt class="py-string">'fixed'</tt><tt class="py-op">,</tt> <tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L367"></a><tt class="py-lineno">367</tt>  <tt class="py-line"> </tt>
<a name="L368"></a><tt class="py-lineno">368</tt>  <tt class="py-line">            <tt class="py-comment"># Loop over each sub-grid.</tt> </tt>
<a name="L369"></a><tt class="py-lineno">369</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-221" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-221', 'i', 'link-131');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L370"></a><tt class="py-lineno">370</tt>  <tt class="py-line">                <tt class="py-comment"># Skip the tensor if originally fixed.</tt> </tt>
<a name="L371"></a><tt class="py-lineno">371</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">fixed_flags</tt><tt class="py-op">[</tt><tt id="link-222" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-222', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L372"></a><tt class="py-lineno">372</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L373"></a><tt class="py-lineno">373</tt>  <tt class="py-line"> </tt>
<a name="L374"></a><tt class="py-lineno">374</tt>  <tt class="py-line">                <tt class="py-comment"># Get the tensor object.</tt> </tt>
<a name="L375"></a><tt class="py-lineno">375</tt>  <tt class="py-line">                <tt id="link-223" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-223', 'tensor', 'link-213');">tensor</a></tt> <tt class="py-op">=</tt> <tt id="link-224" class="py-name"><a title="data_store.align_tensor
pipe_control.align_tensor
test_suite.system_tests.align_tensor
user_functions.align_tensor" class="py-name" href="#" onclick="return doclink('link-224', 'align_tensor', 'link-25');">align_tensor</a></tt><tt class="py-op">.</tt><tt id="link-225" class="py-name"><a title="pipe_control.align_tensor.return_tensor" class="py-name" href="#" onclick="return doclink('link-225', 'return_tensor', 'link-215');">return_tensor</a></tt><tt class="py-op">(</tt><tt class="py-name">index</tt><tt class="py-op">=</tt><tt id="link-226" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-226', 'i', 'link-131');">i</a></tt><tt class="py-op">,</tt> <tt class="py-name">skip_fixed</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt> </tt>
<a name="L376"></a><tt class="py-lineno">376</tt>  <tt class="py-line"> </tt>
<a name="L377"></a><tt class="py-lineno">377</tt>  <tt class="py-line">                <tt class="py-comment"># Unfix the current tensor.</tt> </tt>
<a name="L378"></a><tt class="py-lineno">378</tt>  <tt class="py-line">                <tt id="link-227" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-227', 'tensor', 'link-213');">tensor</a></tt><tt class="py-op">.</tt><tt id="link-228" class="py-name"><a title="data_store.align_tensor.AlignTensorData.set
data_store.diff_tensor.DiffTensorData.set
multi.misc.Verbosity.set
pipe_control.align_tensor.set
pipe_control.diffusion_tensor.set
pipe_control.minimise.set
pipe_control.value.set
specific_analyses.parameter_object.Param_list.set" class="py-name" href="#" onclick="return doclink('link-228', 'set', 'link-220');">set</a></tt><tt class="py-op">(</tt><tt class="py-string">'fixed'</tt><tt class="py-op">,</tt> <tt class="py-name">False</tt><tt class="py-op">)</tt> </tt>
<a name="L379"></a><tt class="py-lineno">379</tt>  <tt class="py-line"> </tt>
<a name="L380"></a><tt class="py-lineno">380</tt>  <tt class="py-line">                <tt class="py-comment"># Grid search parameter subsets.</tt> </tt>
<a name="L381"></a><tt class="py-lineno">381</tt>  <tt class="py-line">                <tt class="py-name">lower_sub</tt> <tt class="py-op">=</tt> <tt class="py-name">lower</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt id="link-229" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-229', 'i', 'link-131');">i</a></tt><tt class="py-op">*</tt><tt class="py-number">5</tt><tt class="py-op">:</tt><tt id="link-230" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-230', 'i', 'link-131');">i</a></tt><tt class="py-op">*</tt><tt class="py-number">5</tt><tt class="py-op">+</tt><tt class="py-number">5</tt><tt class="py-op">]</tt> </tt>
<a name="L382"></a><tt class="py-lineno">382</tt>  <tt class="py-line">                <tt class="py-name">upper_sub</tt> <tt class="py-op">=</tt> <tt class="py-name">upper</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt id="link-231" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-231', 'i', 'link-131');">i</a></tt><tt class="py-op">*</tt><tt class="py-number">5</tt><tt class="py-op">:</tt><tt id="link-232" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-232', 'i', 'link-131');">i</a></tt><tt class="py-op">*</tt><tt class="py-number">5</tt><tt class="py-op">+</tt><tt class="py-number">5</tt><tt class="py-op">]</tt> </tt>
<a name="L383"></a><tt class="py-lineno">383</tt>  <tt class="py-line">                <tt class="py-name">inc_sub</tt> <tt class="py-op">=</tt> <tt class="py-name">inc</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt id="link-233" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-233', 'i', 'link-131');">i</a></tt><tt class="py-op">*</tt><tt class="py-number">5</tt><tt class="py-op">:</tt><tt id="link-234" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-234', 'i', 'link-131');">i</a></tt><tt class="py-op">*</tt><tt class="py-number">5</tt><tt class="py-op">+</tt><tt class="py-number">5</tt><tt class="py-op">]</tt> </tt>
<a name="L384"></a><tt class="py-lineno">384</tt>  <tt class="py-line"> </tt>
<a name="L385"></a><tt class="py-lineno">385</tt>  <tt class="py-line">                <tt class="py-comment"># Minimisation of the sub-grid.</tt> </tt>
<a name="L386"></a><tt class="py-lineno">386</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-235" class="py-name" targets="Method minfx.base_classes.Min.minimise()=minfx.base_classes.Min-class.html#minimise,Method minfx.log_barrier_function.Log_barrier_function.minimise()=minfx.log_barrier_function.Log_barrier_function-class.html#minimise,Method minfx.method_of_multipliers.Method_of_multipliers.minimise()=minfx.method_of_multipliers.Method_of_multipliers-class.html#minimise,Module pipe_control.minimise=pipe_control.minimise-module.html,Function pipe_control.minimise.minimise()=pipe_control.minimise-module.html#minimise,Method specific_analyses.api_base.API_base.minimise()=specific_analyses.api_base.API_base-class.html#minimise,Method specific_analyses.frame_order.api.Frame_order.minimise()=specific_analyses.frame_order.api.Frame_order-class.html#minimise,Method specific_analyses.model_free.api.Model_free.minimise()=specific_analyses.model_free.api.Model_free-class.html#minimise,Method specific_analyses.n_state_model.api.N_state_model.minimise()=specific_analyses.n_state_model.api.N_state_model-class.html#minimise,Method specific_analyses.relax_disp.api.Relax_disp.minimise()=specific_analyses.relax_disp.api.Relax_disp-class.html#minimise,Method specific_analyses.relax_fit.api.Relax_fit.minimise()=specific_analyses.relax_fit.api.Relax_fit-class.html#minimise"><a title="minfx.base_classes.Min.minimise
minfx.log_barrier_function.Log_barrier_function.minimise
minfx.method_of_multipliers.Method_of_multipliers.minimise
pipe_control.minimise
pipe_control.minimise.minimise
specific_analyses.api_base.API_base.minimise
specific_analyses.frame_order.api.Frame_order.minimise
specific_analyses.model_free.api.Model_free.minimise
specific_analyses.n_state_model.api.N_state_model.minimise
specific_analyses.relax_disp.api.Relax_disp.minimise
specific_analyses.relax_fit.api.Relax_fit.minimise" class="py-name" href="#" onclick="return doclink('link-235', 'minimise', 'link-235');">minimise</a></tt><tt class="py-op">(</tt><tt class="py-name">min_algor</tt><tt class="py-op">=</tt><tt class="py-string">'grid'</tt><tt class="py-op">,</tt> <tt class="py-name">lower</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt class="py-name">lower_sub</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">upper</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt class="py-name">upper_sub</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">inc</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt class="py-name">inc_sub</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">scaling_matrix</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt class="py-name">None</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">constraints</tt><tt class="py-op">=</tt><tt class="py-name">constraints</tt><tt class="py-op">,</tt> <tt id="link-236" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-236', 'verbosity', 'link-110');">verbosity</a></tt><tt class="py-op">=</tt><tt id="link-237" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-237', 'verbosity', 'link-110');">verbosity</a></tt><tt class="py-op">,</tt> <tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">)</tt> </tt>
<a name="L387"></a><tt class="py-lineno">387</tt>  <tt class="py-line"> </tt>
<a name="L388"></a><tt class="py-lineno">388</tt>  <tt class="py-line">                <tt class="py-comment"># Fix the tensor again.</tt> </tt>
<a name="L389"></a><tt class="py-lineno">389</tt>  <tt class="py-line">                <tt id="link-238" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-238', 'tensor', 'link-213');">tensor</a></tt><tt class="py-op">.</tt><tt id="link-239" class="py-name"><a title="data_store.align_tensor.AlignTensorData.set
data_store.diff_tensor.DiffTensorData.set
multi.misc.Verbosity.set
pipe_control.align_tensor.set
pipe_control.diffusion_tensor.set
pipe_control.minimise.set
pipe_control.value.set
specific_analyses.parameter_object.Param_list.set" class="py-name" href="#" onclick="return doclink('link-239', 'set', 'link-220');">set</a></tt><tt class="py-op">(</tt><tt class="py-string">'fixed'</tt><tt class="py-op">,</tt> <tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L390"></a><tt class="py-lineno">390</tt>  <tt class="py-line"> </tt>
<a name="L391"></a><tt class="py-lineno">391</tt>  <tt class="py-line">            <tt class="py-comment"># Reset the state of the tensors.</tt> </tt>
<a name="L392"></a><tt class="py-lineno">392</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-240" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-240', 'i', 'link-131');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L393"></a><tt class="py-lineno">393</tt>  <tt class="py-line">                <tt class="py-comment"># Get the tensor object.</tt> </tt>
<a name="L394"></a><tt class="py-lineno">394</tt>  <tt class="py-line">                <tt id="link-241" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-241', 'tensor', 'link-213');">tensor</a></tt> <tt class="py-op">=</tt> <tt id="link-242" class="py-name"><a title="data_store.align_tensor
pipe_control.align_tensor
test_suite.system_tests.align_tensor
user_functions.align_tensor" class="py-name" href="#" onclick="return doclink('link-242', 'align_tensor', 'link-25');">align_tensor</a></tt><tt class="py-op">.</tt><tt id="link-243" class="py-name"><a title="pipe_control.align_tensor.return_tensor" class="py-name" href="#" onclick="return doclink('link-243', 'return_tensor', 'link-215');">return_tensor</a></tt><tt class="py-op">(</tt><tt class="py-name">index</tt><tt class="py-op">=</tt><tt id="link-244" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-244', 'i', 'link-131');">i</a></tt><tt class="py-op">,</tt> <tt class="py-name">skip_fixed</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt> </tt>
<a name="L395"></a><tt class="py-lineno">395</tt>  <tt class="py-line"> </tt>
<a name="L396"></a><tt class="py-lineno">396</tt>  <tt class="py-line">                <tt class="py-comment"># Fix the tensor.</tt> </tt>
<a name="L397"></a><tt class="py-lineno">397</tt>  <tt class="py-line">                <tt id="link-245" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-245', 'tensor', 'link-213');">tensor</a></tt><tt class="py-op">.</tt><tt id="link-246" class="py-name"><a title="data_store.align_tensor.AlignTensorData.set
data_store.diff_tensor.DiffTensorData.set
multi.misc.Verbosity.set
pipe_control.align_tensor.set
pipe_control.diffusion_tensor.set
pipe_control.minimise.set
pipe_control.value.set
specific_analyses.parameter_object.Param_list.set" class="py-name" href="#" onclick="return doclink('link-246', 'set', 'link-220');">set</a></tt><tt class="py-op">(</tt><tt class="py-string">'fixed'</tt><tt class="py-op">,</tt> <tt class="py-name">fixed_flags</tt><tt class="py-op">[</tt><tt id="link-247" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-247', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L398"></a><tt class="py-lineno">398</tt>  <tt class="py-line"> </tt>
<a name="L399"></a><tt class="py-lineno">399</tt>  <tt class="py-line">        <tt class="py-comment"># All other minimisation.</tt> </tt>
<a name="L400"></a><tt class="py-lineno">400</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L401"></a><tt class="py-lineno">401</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-248" class="py-name"><a title="minfx.base_classes.Min.minimise
minfx.log_barrier_function.Log_barrier_function.minimise
minfx.method_of_multipliers.Method_of_multipliers.minimise
pipe_control.minimise
pipe_control.minimise.minimise
specific_analyses.api_base.API_base.minimise
specific_analyses.frame_order.api.Frame_order.minimise
specific_analyses.model_free.api.Model_free.minimise
specific_analyses.n_state_model.api.N_state_model.minimise
specific_analyses.relax_disp.api.Relax_disp.minimise
specific_analyses.relax_fit.api.Relax_fit.minimise" class="py-name" href="#" onclick="return doclink('link-248', 'minimise', 'link-235');">minimise</a></tt><tt class="py-op">(</tt><tt class="py-name">min_algor</tt><tt class="py-op">=</tt><tt class="py-string">'grid'</tt><tt class="py-op">,</tt> <tt class="py-name">lower</tt><tt class="py-op">=</tt><tt class="py-name">lower</tt><tt class="py-op">,</tt> <tt class="py-name">upper</tt><tt class="py-op">=</tt><tt class="py-name">upper</tt><tt class="py-op">,</tt> <tt class="py-name">inc</tt><tt class="py-op">=</tt><tt class="py-name">inc</tt><tt class="py-op">,</tt> <tt class="py-name">scaling_matrix</tt><tt class="py-op">=</tt><tt class="py-name">scaling_matrix</tt><tt class="py-op">,</tt> <tt class="py-name">constraints</tt><tt class="py-op">=</tt><tt class="py-name">constraints</tt><tt class="py-op">,</tt> <tt id="link-249" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-249', 'verbosity', 'link-110');">verbosity</a></tt><tt class="py-op">=</tt><tt id="link-250" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-250', 'verbosity', 'link-110');">verbosity</a></tt><tt class="py-op">,</tt> <tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">)</tt> </tt>
</div><a name="L402"></a><tt class="py-lineno">402</tt>  <tt class="py-line"> </tt>
<a name="L403"></a><tt class="py-lineno">403</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.is_spin_param"></a><div id="N_state_model.is_spin_param-def"><a name="L404"></a><tt class="py-lineno">404</tt> <a class="py-toggle" href="#" id="N_state_model.is_spin_param-toggle" onclick="return toggle('N_state_model.is_spin_param');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.api.N_state_model-class.html#is_spin_param">is_spin_param</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.is_spin_param-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="N_state_model.is_spin_param-expanded"><a name="L405"></a><tt class="py-lineno">405</tt>  <tt class="py-line">        <tt class="py-docstring">"""Determine whether the given parameter is spin specific.</tt> </tt>
<a name="L406"></a><tt class="py-lineno">406</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L407"></a><tt class="py-lineno">407</tt>  <tt class="py-line"><tt class="py-docstring">        @param name:    The name of the parameter.</tt> </tt>
<a name="L408"></a><tt class="py-lineno">408</tt>  <tt class="py-line"><tt class="py-docstring">        @type name:     str</tt> </tt>
<a name="L409"></a><tt class="py-lineno">409</tt>  <tt class="py-line"><tt class="py-docstring">        @return:        False</tt> </tt>
<a name="L410"></a><tt class="py-lineno">410</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:         bool</tt> </tt>
<a name="L411"></a><tt class="py-lineno">411</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L412"></a><tt class="py-lineno">412</tt>  <tt class="py-line"> </tt>
<a name="L413"></a><tt class="py-lineno">413</tt>  <tt class="py-line">        <tt class="py-comment"># Spin specific parameters.</tt> </tt>
<a name="L414"></a><tt class="py-lineno">414</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-251" class="py-name" targets="Variable bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name=bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe-class.html#name,Variable bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name=bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1-class.html#name,Variable bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name=bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name=bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name=bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name=bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name=bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1-class.html#name,Variable pipe_control.pipes.name=pipe_control.pipes-module.html#name,Variable user_functions.pipe.name=user_functions.pipe-module.html#name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-251', 'name', 'link-251');">name</a></tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt class="py-string">'r'</tt><tt class="py-op">,</tt> <tt class="py-string">'heteronuc_type'</tt><tt class="py-op">,</tt> <tt class="py-string">'proton_type'</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L415"></a><tt class="py-lineno">415</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">True</tt> </tt>
<a name="L416"></a><tt class="py-lineno">416</tt>  <tt class="py-line"> </tt>
<a name="L417"></a><tt class="py-lineno">417</tt>  <tt class="py-line">        <tt class="py-comment"># All other parameters are global.</tt> </tt>
<a name="L418"></a><tt class="py-lineno">418</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">False</tt> </tt>
</div><a name="L419"></a><tt class="py-lineno">419</tt>  <tt class="py-line"> </tt>
<a name="L420"></a><tt class="py-lineno">420</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.map_bounds"></a><div id="N_state_model.map_bounds-def"><a name="L421"></a><tt class="py-lineno">421</tt> <a class="py-toggle" href="#" id="N_state_model.map_bounds-toggle" onclick="return toggle('N_state_model.map_bounds');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.api.N_state_model-class.html#map_bounds">map_bounds</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">param</tt><tt class="py-op">,</tt> <tt class="py-param">spin_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.map_bounds-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="N_state_model.map_bounds-expanded"><a name="L422"></a><tt class="py-lineno">422</tt>  <tt class="py-line">        <tt class="py-docstring">"""Create bounds for the OpenDX mapping function.</tt> </tt>
<a name="L423"></a><tt class="py-lineno">423</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L424"></a><tt class="py-lineno">424</tt>  <tt class="py-line"><tt class="py-docstring">        @param param:       The name of the parameter to return the lower and upper bounds of.</tt> </tt>
<a name="L425"></a><tt class="py-lineno">425</tt>  <tt class="py-line"><tt class="py-docstring">        @type param:        str</tt> </tt>
<a name="L426"></a><tt class="py-lineno">426</tt>  <tt class="py-line"><tt class="py-docstring">        @param spin_id:     The spin identification string (unused).</tt> </tt>
<a name="L427"></a><tt class="py-lineno">427</tt>  <tt class="py-line"><tt class="py-docstring">        @type spin_id:      None</tt> </tt>
<a name="L428"></a><tt class="py-lineno">428</tt>  <tt class="py-line"><tt class="py-docstring">        @return:            The upper and lower bounds of the parameter.</tt> </tt>
<a name="L429"></a><tt class="py-lineno">429</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:             list of float</tt> </tt>
<a name="L430"></a><tt class="py-lineno">430</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L431"></a><tt class="py-lineno">431</tt>  <tt class="py-line"> </tt>
<a name="L432"></a><tt class="py-lineno">432</tt>  <tt class="py-line">        <tt class="py-comment"># Paramagnetic centre.</tt> </tt>
<a name="L433"></a><tt class="py-lineno">433</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-252" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-252', 'search', 'link-7');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'^paramag_[xyz]$'</tt><tt class="py-op">,</tt> <tt class="py-name">param</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L434"></a><tt class="py-lineno">434</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">100.0</tt><tt class="py-op">,</tt> <tt class="py-number">100.0</tt><tt class="py-op">]</tt> </tt>
</div><a name="L435"></a><tt class="py-lineno">435</tt>  <tt class="py-line"> </tt>
<a name="L436"></a><tt class="py-lineno">436</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.minimise"></a><div id="N_state_model.minimise-def"><a name="L437"></a><tt class="py-lineno">437</tt> <a class="py-toggle" href="#" id="N_state_model.minimise-toggle" onclick="return toggle('N_state_model.minimise');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.api.N_state_model-class.html#minimise">minimise</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">min_algor</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">min_options</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">func_tol</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">grad_tol</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">max_iterations</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">constraints</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">,</tt> <tt class="py-param">scaling_matrix</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">verbosity</tt><tt class="py-op">=</tt><tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-param">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">lower</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">upper</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">inc</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.minimise-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="N_state_model.minimise-expanded"><a name="L438"></a><tt class="py-lineno">438</tt>  <tt class="py-line">        <tt class="py-docstring">"""Minimisation function.</tt> </tt>
<a name="L439"></a><tt class="py-lineno">439</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L440"></a><tt class="py-lineno">440</tt>  <tt class="py-line"><tt class="py-docstring">        @param min_algor:           The minimisation algorithm to use.</tt> </tt>
<a name="L441"></a><tt class="py-lineno">441</tt>  <tt class="py-line"><tt class="py-docstring">        @type min_algor:            str</tt> </tt>
<a name="L442"></a><tt class="py-lineno">442</tt>  <tt class="py-line"><tt class="py-docstring">        @param min_options:         An array of options to be used by the minimisation algorithm.</tt> </tt>
<a name="L443"></a><tt class="py-lineno">443</tt>  <tt class="py-line"><tt class="py-docstring">        @type min_options:          array of str</tt> </tt>
<a name="L444"></a><tt class="py-lineno">444</tt>  <tt class="py-line"><tt class="py-docstring">        @param func_tol:            The function tolerance which, when reached, terminates optimisation. Setting this to None turns of the check.</tt> </tt>
<a name="L445"></a><tt class="py-lineno">445</tt>  <tt class="py-line"><tt class="py-docstring">        @type func_tol:             None or float</tt> </tt>
<a name="L446"></a><tt class="py-lineno">446</tt>  <tt class="py-line"><tt class="py-docstring">        @param grad_tol:            The gradient tolerance which, when reached, terminates optimisation. Setting this to None turns of the check.</tt> </tt>
<a name="L447"></a><tt class="py-lineno">447</tt>  <tt class="py-line"><tt class="py-docstring">        @type grad_tol:             None or float</tt> </tt>
<a name="L448"></a><tt class="py-lineno">448</tt>  <tt class="py-line"><tt class="py-docstring">        @param max_iterations:      The maximum number of iterations for the algorithm.</tt> </tt>
<a name="L449"></a><tt class="py-lineno">449</tt>  <tt class="py-line"><tt class="py-docstring">        @type max_iterations:       int</tt> </tt>
<a name="L450"></a><tt class="py-lineno">450</tt>  <tt class="py-line"><tt class="py-docstring">        @param constraints:         If True, constraints are used during optimisation.</tt> </tt>
<a name="L451"></a><tt class="py-lineno">451</tt>  <tt class="py-line"><tt class="py-docstring">        @type constraints:          bool</tt> </tt>
<a name="L452"></a><tt class="py-lineno">452</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword scaling_matrix:    The per-model list of diagonal and square scaling matrices.</tt> </tt>
<a name="L453"></a><tt class="py-lineno">453</tt>  <tt class="py-line"><tt class="py-docstring">        @type scaling_matrix:       list of numpy rank-2, float64 array or list of None</tt> </tt>
<a name="L454"></a><tt class="py-lineno">454</tt>  <tt class="py-line"><tt class="py-docstring">        @param verbosity:           A flag specifying the amount of information to print.  The higher the value, the greater the verbosity.</tt> </tt>
<a name="L455"></a><tt class="py-lineno">455</tt>  <tt class="py-line"><tt class="py-docstring">        @type verbosity:            int</tt> </tt>
<a name="L456"></a><tt class="py-lineno">456</tt>  <tt class="py-line"><tt class="py-docstring">        @param sim_index:           The index of the simulation to optimise.  This should be None if normal optimisation is desired.</tt> </tt>
<a name="L457"></a><tt class="py-lineno">457</tt>  <tt class="py-line"><tt class="py-docstring">        @type sim_index:            None or int</tt> </tt>
<a name="L458"></a><tt class="py-lineno">458</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword lower:             The per-model lower bounds of the grid search which must be equal to the number of parameters in the model.  This optional argument is only used when doing a grid search.</tt> </tt>
<a name="L459"></a><tt class="py-lineno">459</tt>  <tt class="py-line"><tt class="py-docstring">        @type lower:                list of lists of numbers</tt> </tt>
<a name="L460"></a><tt class="py-lineno">460</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword upper:             The per-model upper bounds of the grid search which must be equal to the number of parameters in the model.  This optional argument is only used when doing a grid search.</tt> </tt>
<a name="L461"></a><tt class="py-lineno">461</tt>  <tt class="py-line"><tt class="py-docstring">        @type upper:                list of lists of numbers</tt> </tt>
<a name="L462"></a><tt class="py-lineno">462</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword inc:               The per-model increments for each dimension of the space for the grid search.  The number of elements in the array must equal to the number of parameters in the model.  This argument is only used when doing a grid search.</tt> </tt>
<a name="L463"></a><tt class="py-lineno">463</tt>  <tt class="py-line"><tt class="py-docstring">        @type inc:                  list of lists of int</tt> </tt>
<a name="L464"></a><tt class="py-lineno">464</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L465"></a><tt class="py-lineno">465</tt>  <tt class="py-line"> </tt>
<a name="L466"></a><tt class="py-lineno">466</tt>  <tt class="py-line">        <tt class="py-comment"># Set up the target function for direct calculation.</tt> </tt>
<a name="L467"></a><tt class="py-lineno">467</tt>  <tt class="py-line">        <tt id="link-253" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-253', 'model', 'link-107');">model</a></tt><tt class="py-op">,</tt> <tt class="py-name">param_vector</tt><tt class="py-op">,</tt> <tt id="link-254" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-254', 'data_types', 'link-108');">data_types</a></tt> <tt class="py-op">=</tt> <tt id="link-255" class="py-name"><a title="specific_analyses.frame_order.optimisation.target_fn_setup
specific_analyses.n_state_model.optimisation.target_fn_setup" class="py-name" href="#" onclick="return doclink('link-255', 'target_fn_setup', 'link-54');">target_fn_setup</a></tt><tt class="py-op">(</tt><tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">,</tt> <tt class="py-name">scaling_matrix</tt><tt class="py-op">=</tt><tt class="py-name">scaling_matrix</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt id="link-256" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-256', 'verbosity', 'link-110');">verbosity</a></tt><tt class="py-op">=</tt><tt id="link-257" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-257', 'verbosity', 'link-110');">verbosity</a></tt><tt class="py-op">)</tt> </tt>
<a name="L468"></a><tt class="py-lineno">468</tt>  <tt class="py-line"> </tt>
<a name="L469"></a><tt class="py-lineno">469</tt>  <tt class="py-line">        <tt class="py-comment"># Nothing to do!</tt> </tt>
<a name="L470"></a><tt class="py-lineno">470</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">param_vector</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L471"></a><tt class="py-lineno">471</tt>  <tt class="py-line">            <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-258" class="py-name"><a title="lib.warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-258', 'RelaxWarning', 'link-23');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"The model has no parameters, minimisation cannot be performed."</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L472"></a><tt class="py-lineno">472</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
<a name="L473"></a><tt class="py-lineno">473</tt>  <tt class="py-line"> </tt>
<a name="L474"></a><tt class="py-lineno">474</tt>  <tt class="py-line">        <tt class="py-comment"># Right, constraints cannot be used for the 'fixed' model.</tt> </tt>
<a name="L475"></a><tt class="py-lineno">475</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">constraints</tt> <tt class="py-keyword">and</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-259" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-259', 'model', 'link-107');">model</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'fixed'</tt><tt class="py-op">:</tt> </tt>
<a name="L476"></a><tt class="py-lineno">476</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-260" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-260', 'verbosity', 'link-110');">verbosity</a></tt><tt class="py-op">:</tt> </tt>
<a name="L477"></a><tt class="py-lineno">477</tt>  <tt class="py-line">                <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-261" class="py-name"><a title="lib.warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-261', 'RelaxWarning', 'link-23');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"Turning constraints off.  These cannot be used for the 'fixed' model."</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L478"></a><tt class="py-lineno">478</tt>  <tt class="py-line">            <tt class="py-name">constraints</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L479"></a><tt class="py-lineno">479</tt>  <tt class="py-line"> </tt>
<a name="L480"></a><tt class="py-lineno">480</tt>  <tt class="py-line">            <tt class="py-comment"># Pop out the Method of Multipliers algorithm.</tt> </tt>
<a name="L481"></a><tt class="py-lineno">481</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">min_algor</tt> <tt class="py-op">==</tt> <tt class="py-string">'Method of Multipliers'</tt><tt class="py-op">:</tt> </tt>
<a name="L482"></a><tt class="py-lineno">482</tt>  <tt class="py-line">                <tt class="py-name">min_algor</tt> <tt class="py-op">=</tt> <tt class="py-name">min_options</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L483"></a><tt class="py-lineno">483</tt>  <tt class="py-line">                <tt class="py-name">min_options</tt> <tt class="py-op">=</tt> <tt class="py-name">min_options</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">:</tt><tt class="py-op">]</tt> </tt>
<a name="L484"></a><tt class="py-lineno">484</tt>  <tt class="py-line"> </tt>
<a name="L485"></a><tt class="py-lineno">485</tt>  <tt class="py-line">        <tt class="py-comment"># And constraints absolutely must be used for the 'population' model.</tt> </tt>
<a name="L486"></a><tt class="py-lineno">486</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">constraints</tt> <tt class="py-keyword">and</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-262" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-262', 'model', 'link-107');">model</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'population'</tt><tt class="py-op">:</tt> </tt>
<a name="L487"></a><tt class="py-lineno">487</tt>  <tt class="py-line">            <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-263" class="py-name"><a title="lib.warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-263', 'RelaxWarning', 'link-23');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"Turning constraints on.  These absolutely must be used for the 'population' model."</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L488"></a><tt class="py-lineno">488</tt>  <tt class="py-line">            <tt class="py-name">constraints</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L489"></a><tt class="py-lineno">489</tt>  <tt class="py-line"> </tt>
<a name="L490"></a><tt class="py-lineno">490</tt>  <tt class="py-line">            <tt class="py-comment"># Add the Method of Multipliers algorithm.</tt> </tt>
<a name="L491"></a><tt class="py-lineno">491</tt>  <tt class="py-line">            <tt class="py-name">min_options</tt> <tt class="py-op">=</tt> <tt class="py-op">(</tt><tt class="py-name">min_algor</tt><tt class="py-op">,</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-name">min_options</tt> </tt>
<a name="L492"></a><tt class="py-lineno">492</tt>  <tt class="py-line">            <tt class="py-name">min_algor</tt> <tt class="py-op">=</tt> <tt class="py-string">'Method of Multipliers'</tt> </tt>
<a name="L493"></a><tt class="py-lineno">493</tt>  <tt class="py-line"> </tt>
<a name="L494"></a><tt class="py-lineno">494</tt>  <tt class="py-line">        <tt class="py-comment"># Disallow Newton optimisation and other Hessian optimisers for the paramagnetic centre position optimisation (the PCS Hessian is not yet implemented).</tt> </tt>
<a name="L495"></a><tt class="py-lineno">495</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'paramag_centre_fixed'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramag_centre_fixed</tt><tt class="py-op">:</tt> </tt>
<a name="L496"></a><tt class="py-lineno">496</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">min_algor</tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt class="py-string">'newton'</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L497"></a><tt class="py-lineno">497</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-264" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-264', 'RelaxError', 'link-13');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"For the paramagnetic centre position, as the Hessians are not yet implemented Newton optimisation cannot be performed."</tt><tt class="py-op">)</tt> </tt>
<a name="L498"></a><tt class="py-lineno">498</tt>  <tt class="py-line"> </tt>
<a name="L499"></a><tt class="py-lineno">499</tt>  <tt class="py-line">        <tt class="py-comment"># Linear constraints.</tt> </tt>
<a name="L500"></a><tt class="py-lineno">500</tt>  <tt class="py-line">        <tt class="py-name">A</tt><tt class="py-op">,</tt> <tt class="py-name">b</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt> </tt>
<a name="L501"></a><tt class="py-lineno">501</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">constraints</tt><tt class="py-op">:</tt> </tt>
<a name="L502"></a><tt class="py-lineno">502</tt>  <tt class="py-line">            <tt class="py-name">A</tt><tt class="py-op">,</tt> <tt class="py-name">b</tt> <tt class="py-op">=</tt> <tt id="link-265" class="py-name"><a title="specific_analyses.frame_order.parameters.linear_constraints
specific_analyses.model_free.parameters.linear_constraints
specific_analyses.n_state_model.parameters.linear_constraints
specific_analyses.relax_disp.parameters.linear_constraints
specific_analyses.relax_fit.parameters.linear_constraints" class="py-name" href="#" onclick="return doclink('link-265', 'linear_constraints', 'link-64');">linear_constraints</a></tt><tt class="py-op">(</tt><tt id="link-266" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-266', 'data_types', 'link-108');">data_types</a></tt><tt class="py-op">=</tt><tt id="link-267" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-267', 'data_types', 'link-108');">data_types</a></tt><tt class="py-op">,</tt> <tt class="py-name">scaling_matrix</tt><tt class="py-op">=</tt><tt class="py-name">scaling_matrix</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L503"></a><tt class="py-lineno">503</tt>  <tt class="py-line"> </tt>
<a name="L504"></a><tt class="py-lineno">504</tt>  <tt class="py-line">        <tt class="py-comment"># Grid search.</tt> </tt>
<a name="L505"></a><tt class="py-lineno">505</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-268" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-268', 'search', 'link-7');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'^[Gg]rid'</tt><tt class="py-op">,</tt> <tt class="py-name">min_algor</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L506"></a><tt class="py-lineno">506</tt>  <tt class="py-line">            <tt class="py-comment"># The search.</tt> </tt>
<a name="L507"></a><tt class="py-lineno">507</tt>  <tt class="py-line">            <tt id="link-269" class="py-name" targets="Module pipe_control.results=pipe_control.results-module.html,Module test_suite.system_tests.results=test_suite.system_tests.results-module.html,Module user_functions.results=user_functions.results-module.html"><a title="pipe_control.results
test_suite.system_tests.results
user_functions.results" class="py-name" href="#" onclick="return doclink('link-269', 'results', 'link-269');">results</a></tt> <tt class="py-op">=</tt> <tt id="link-270" class="py-name"><a title="gui.components.grid
minfx.grid
minfx.grid.grid" class="py-name" href="#" onclick="return doclink('link-270', 'grid', 'link-5');">grid</a></tt><tt class="py-op">(</tt><tt id="link-271" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func" class="py-name" href="#" onclick="return doclink('link-271', 'func', 'link-115');">func</a></tt><tt class="py-op">=</tt><tt id="link-272" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-272', 'model', 'link-107');">model</a></tt><tt class="py-op">.</tt><tt id="link-273" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func" class="py-name" href="#" onclick="return doclink('link-273', 'func', 'link-115');">func</a></tt><tt class="py-op">,</tt> <tt class="py-name">args</tt><tt class="py-op">=</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">num_incs</tt><tt class="py-op">=</tt><tt class="py-name">inc</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">lower</tt><tt class="py-op">=</tt><tt class="py-name">lower</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">upper</tt><tt class="py-op">=</tt><tt class="py-name">upper</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">A</tt><tt class="py-op">=</tt><tt class="py-name">A</tt><tt class="py-op">,</tt> <tt class="py-name">b</tt><tt class="py-op">=</tt><tt class="py-name">b</tt><tt class="py-op">,</tt> <tt id="link-274" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-274', 'verbosity', 'link-110');">verbosity</a></tt><tt class="py-op">=</tt><tt id="link-275" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-275', 'verbosity', 'link-110');">verbosity</a></tt><tt class="py-op">)</tt> </tt>
<a name="L508"></a><tt class="py-lineno">508</tt>  <tt class="py-line"> </tt>
<a name="L509"></a><tt class="py-lineno">509</tt>  <tt class="py-line">            <tt class="py-comment"># Unpack the results.</tt> </tt>
<a name="L510"></a><tt class="py-lineno">510</tt>  <tt class="py-line">            <tt class="py-name">param_vector</tt><tt class="py-op">,</tt> <tt id="link-276" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func" class="py-name" href="#" onclick="return doclink('link-276', 'func', 'link-115');">func</a></tt><tt class="py-op">,</tt> <tt class="py-name">iter_count</tt><tt class="py-op">,</tt> <tt id="link-277" class="py-name" targets="Variable gui.analyses.auto_model_free.Local_tm_list.warning=gui.analyses.auto_model_free.Local_tm_list-class.html#warning,Variable gui.analyses.auto_model_free.Mf_list.warning=gui.analyses.auto_model_free.Mf_list-class.html#warning,Variable gui.analyses.elements.model_list.Model_list.warning=gui.analyses.elements.model_list.Model_list-class.html#warning"><a title="gui.analyses.auto_model_free.Local_tm_list.warning
gui.analyses.auto_model_free.Mf_list.warning
gui.analyses.elements.model_list.Model_list.warning" class="py-name" href="#" onclick="return doclink('link-277', 'warning', 'link-277');">warning</a></tt> <tt class="py-op">=</tt> <tt id="link-278" class="py-name"><a title="pipe_control.results
test_suite.system_tests.results
user_functions.results" class="py-name" href="#" onclick="return doclink('link-278', 'results', 'link-269');">results</a></tt> </tt>
<a name="L511"></a><tt class="py-lineno">511</tt>  <tt class="py-line">            <tt class="py-name">f_count</tt> <tt class="py-op">=</tt> <tt class="py-name">iter_count</tt> </tt>
<a name="L512"></a><tt class="py-lineno">512</tt>  <tt class="py-line">            <tt class="py-name">g_count</tt> <tt class="py-op">=</tt> <tt class="py-number">0.0</tt> </tt>
<a name="L513"></a><tt class="py-lineno">513</tt>  <tt class="py-line">            <tt class="py-name">h_count</tt> <tt class="py-op">=</tt> <tt class="py-number">0.0</tt> </tt>
<a name="L514"></a><tt class="py-lineno">514</tt>  <tt class="py-line"> </tt>
<a name="L515"></a><tt class="py-lineno">515</tt>  <tt class="py-line">        <tt class="py-comment"># Minimisation.</tt> </tt>
<a name="L516"></a><tt class="py-lineno">516</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L517"></a><tt class="py-lineno">517</tt>  <tt class="py-line">            <tt id="link-279" class="py-name"><a title="pipe_control.results
test_suite.system_tests.results
user_functions.results" class="py-name" href="#" onclick="return doclink('link-279', 'results', 'link-269');">results</a></tt> <tt class="py-op">=</tt> <tt id="link-280" class="py-name"><a title="minfx.generic.generic_minimise" class="py-name" href="#" onclick="return doclink('link-280', 'generic_minimise', 'link-3');">generic_minimise</a></tt><tt class="py-op">(</tt><tt id="link-281" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func" class="py-name" href="#" onclick="return doclink('link-281', 'func', 'link-115');">func</a></tt><tt class="py-op">=</tt><tt id="link-282" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-282', 'model', 'link-107');">model</a></tt><tt class="py-op">.</tt><tt id="link-283" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func" class="py-name" href="#" onclick="return doclink('link-283', 'func', 'link-115');">func</a></tt><tt class="py-op">,</tt> <tt id="link-284" class="py-name" targets="Method minfx.constraint_linear.Constraint_linear.dfunc()=minfx.constraint_linear.Constraint_linear-class.html#dfunc"><a title="minfx.constraint_linear.Constraint_linear.dfunc" class="py-name" href="#" onclick="return doclink('link-284', 'dfunc', 'link-284');">dfunc</a></tt><tt class="py-op">=</tt><tt id="link-285" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-285', 'model', 'link-107');">model</a></tt><tt class="py-op">.</tt><tt id="link-286" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.dfunc" class="py-name" href="#" onclick="return doclink('link-286', 'dfunc', 'link-284');">dfunc</a></tt><tt class="py-op">,</tt> <tt class="py-name">d2func</tt><tt class="py-op">=</tt><tt id="link-287" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-287', 'model', 'link-107');">model</a></tt><tt class="py-op">.</tt><tt class="py-name">d2func</tt><tt class="py-op">,</tt> <tt class="py-name">args</tt><tt class="py-op">=</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">x0</tt><tt class="py-op">=</tt><tt class="py-name">param_vector</tt><tt class="py-op">,</tt> <tt class="py-name">min_algor</tt><tt class="py-op">=</tt><tt class="py-name">min_algor</tt><tt class="py-op">,</tt> <tt class="py-name">min_options</tt><tt class="py-op">=</tt><tt class="py-name">min_options</tt><tt class="py-op">,</tt> <tt class="py-name">func_tol</tt><tt class="py-op">=</tt><tt class="py-name">func_tol</tt><tt class="py-op">,</tt> <tt class="py-name">grad_tol</tt><tt class="py-op">=</tt><tt class="py-name">grad_tol</tt><tt class="py-op">,</tt> <tt class="py-name">maxiter</tt><tt class="py-op">=</tt><tt class="py-name">max_iterations</tt><tt class="py-op">,</tt> <tt class="py-name">A</tt><tt class="py-op">=</tt><tt class="py-name">A</tt><tt class="py-op">,</tt> <tt class="py-name">b</tt><tt class="py-op">=</tt><tt class="py-name">b</tt><tt class="py-op">,</tt> <tt class="py-name">full_output</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">print_flag</tt><tt class="py-op">=</tt><tt id="link-288" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-288', 'verbosity', 'link-110');">verbosity</a></tt><tt class="py-op">)</tt> </tt>
<a name="L518"></a><tt class="py-lineno">518</tt>  <tt class="py-line"> </tt>
<a name="L519"></a><tt class="py-lineno">519</tt>  <tt class="py-line">            <tt class="py-comment"># Unpack the results.</tt> </tt>
<a name="L520"></a><tt class="py-lineno">520</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-289" class="py-name"><a title="pipe_control.results
test_suite.system_tests.results
user_functions.results" class="py-name" href="#" onclick="return doclink('link-289', 'results', 'link-269');">results</a></tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L521"></a><tt class="py-lineno">521</tt>  <tt class="py-line">                <tt class="py-keyword">return</tt> </tt>
<a name="L522"></a><tt class="py-lineno">522</tt>  <tt class="py-line">            <tt class="py-name">param_vector</tt><tt class="py-op">,</tt> <tt id="link-290" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func" class="py-name" href="#" onclick="return doclink('link-290', 'func', 'link-115');">func</a></tt><tt class="py-op">,</tt> <tt class="py-name">iter_count</tt><tt class="py-op">,</tt> <tt class="py-name">f_count</tt><tt class="py-op">,</tt> <tt class="py-name">g_count</tt><tt class="py-op">,</tt> <tt class="py-name">h_count</tt><tt class="py-op">,</tt> <tt id="link-291" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.warning
gui.analyses.auto_model_free.Mf_list.warning
gui.analyses.elements.model_list.Model_list.warning" class="py-name" href="#" onclick="return doclink('link-291', 'warning', 'link-277');">warning</a></tt> <tt class="py-op">=</tt> <tt id="link-292" class="py-name"><a title="pipe_control.results
test_suite.system_tests.results
user_functions.results" class="py-name" href="#" onclick="return doclink('link-292', 'results', 'link-269');">results</a></tt> </tt>
<a name="L523"></a><tt class="py-lineno">523</tt>  <tt class="py-line"> </tt>
<a name="L524"></a><tt class="py-lineno">524</tt>  <tt class="py-line">        <tt class="py-comment"># Catch infinite chi-squared values.</tt> </tt>
<a name="L525"></a><tt class="py-lineno">525</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-293" class="py-name"><a title="lib.float.isInf" class="py-name" href="#" onclick="return doclink('link-293', 'isInf', 'link-20');">isInf</a></tt><tt class="py-op">(</tt><tt id="link-294" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func" class="py-name" href="#" onclick="return doclink('link-294', 'func', 'link-115');">func</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L526"></a><tt class="py-lineno">526</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-295" class="py-name"><a title="lib.errors.RelaxInfError" class="py-name" href="#" onclick="return doclink('link-295', 'RelaxInfError', 'link-14');">RelaxInfError</a></tt><tt class="py-op">(</tt><tt class="py-string">'chi-squared'</tt><tt class="py-op">)</tt> </tt>
<a name="L527"></a><tt class="py-lineno">527</tt>  <tt class="py-line"> </tt>
<a name="L528"></a><tt class="py-lineno">528</tt>  <tt class="py-line">        <tt class="py-comment"># Catch chi-squared values of NaN.</tt> </tt>
<a name="L529"></a><tt class="py-lineno">529</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-296" class="py-name"><a title="lib.float.isNaN" class="py-name" href="#" onclick="return doclink('link-296', 'isNaN', 'link-19');">isNaN</a></tt><tt class="py-op">(</tt><tt id="link-297" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func" class="py-name" href="#" onclick="return doclink('link-297', 'func', 'link-115');">func</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L530"></a><tt class="py-lineno">530</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-298" class="py-name"><a title="lib.errors.RelaxNaNError" class="py-name" href="#" onclick="return doclink('link-298', 'RelaxNaNError', 'link-15');">RelaxNaNError</a></tt><tt class="py-op">(</tt><tt class="py-string">'chi-squared'</tt><tt class="py-op">)</tt> </tt>
<a name="L531"></a><tt class="py-lineno">531</tt>  <tt class="py-line"> </tt>
<a name="L532"></a><tt class="py-lineno">532</tt>  <tt class="py-line">        <tt class="py-comment"># Make a last function call to update the back-calculated RDC and PCS structures to the optimal values.</tt> </tt>
<a name="L533"></a><tt class="py-lineno">533</tt>  <tt class="py-line">        <tt id="link-299" class="py-name"><a title="target_functions.chi2
target_functions.chi2.chi2" class="py-name" href="#" onclick="return doclink('link-299', 'chi2', 'link-113');">chi2</a></tt> <tt class="py-op">=</tt> <tt id="link-300" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-300', 'model', 'link-107');">model</a></tt><tt class="py-op">.</tt><tt id="link-301" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func" class="py-name" href="#" onclick="return doclink('link-301', 'func', 'link-115');">func</a></tt><tt class="py-op">(</tt><tt class="py-name">param_vector</tt><tt class="py-op">)</tt> </tt>
<a name="L534"></a><tt class="py-lineno">534</tt>  <tt class="py-line"> </tt>
<a name="L535"></a><tt class="py-lineno">535</tt>  <tt class="py-line">        <tt class="py-comment"># Scaling.</tt> </tt>
<a name="L536"></a><tt class="py-lineno">536</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">scaling_matrix</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L537"></a><tt class="py-lineno">537</tt>  <tt class="py-line">            <tt class="py-name">param_vector</tt> <tt class="py-op">=</tt> <tt class="py-name">dot</tt><tt class="py-op">(</tt><tt class="py-name">scaling_matrix</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">param_vector</tt><tt class="py-op">)</tt> </tt>
<a name="L538"></a><tt class="py-lineno">538</tt>  <tt class="py-line"> </tt>
<a name="L539"></a><tt class="py-lineno">539</tt>  <tt class="py-line">        <tt class="py-comment"># Disassemble the parameter vector.</tt> </tt>
<a name="L540"></a><tt class="py-lineno">540</tt>  <tt class="py-line">        <tt id="link-302" class="py-name"><a title="specific_analyses.model_free.parameters.disassemble_param_vector
specific_analyses.n_state_model.parameters.disassemble_param_vector
specific_analyses.relax_disp.parameters.disassemble_param_vector
specific_analyses.relax_fit.parameters.disassemble_param_vector" class="py-name" href="#" onclick="return doclink('link-302', 'disassemble_param_vector', 'link-63');">disassemble_param_vector</a></tt><tt class="py-op">(</tt><tt class="py-name">param_vector</tt><tt class="py-op">=</tt><tt class="py-name">param_vector</tt><tt class="py-op">,</tt> <tt id="link-303" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-303', 'data_types', 'link-108');">data_types</a></tt><tt class="py-op">=</tt><tt id="link-304" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-304', 'data_types', 'link-108');">data_types</a></tt><tt class="py-op">,</tt> <tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">)</tt> </tt>
<a name="L541"></a><tt class="py-lineno">541</tt>  <tt class="py-line"> </tt>
<a name="L542"></a><tt class="py-lineno">542</tt>  <tt class="py-line">        <tt class="py-comment"># Monte Carlo minimisation statistics.</tt> </tt>
<a name="L543"></a><tt class="py-lineno">543</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">sim_index</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L544"></a><tt class="py-lineno">544</tt>  <tt class="py-line">            <tt class="py-comment"># Chi-squared statistic.</tt> </tt>
<a name="L545"></a><tt class="py-lineno">545</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">chi2_sim</tt><tt class="py-op">[</tt><tt class="py-name">sim_index</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-305" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func" class="py-name" href="#" onclick="return doclink('link-305', 'func', 'link-115');">func</a></tt> </tt>
<a name="L546"></a><tt class="py-lineno">546</tt>  <tt class="py-line"> </tt>
<a name="L547"></a><tt class="py-lineno">547</tt>  <tt class="py-line">            <tt class="py-comment"># Iterations.</tt> </tt>
<a name="L548"></a><tt class="py-lineno">548</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">iter_sim</tt><tt class="py-op">[</tt><tt class="py-name">sim_index</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">iter_count</tt> </tt>
<a name="L549"></a><tt class="py-lineno">549</tt>  <tt class="py-line"> </tt>
<a name="L550"></a><tt class="py-lineno">550</tt>  <tt class="py-line">            <tt class="py-comment"># Function evaluations.</tt> </tt>
<a name="L551"></a><tt class="py-lineno">551</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">f_count_sim</tt><tt class="py-op">[</tt><tt class="py-name">sim_index</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">f_count</tt> </tt>
<a name="L552"></a><tt class="py-lineno">552</tt>  <tt class="py-line"> </tt>
<a name="L553"></a><tt class="py-lineno">553</tt>  <tt class="py-line">            <tt class="py-comment"># Gradient evaluations.</tt> </tt>
<a name="L554"></a><tt class="py-lineno">554</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">g_count_sim</tt><tt class="py-op">[</tt><tt class="py-name">sim_index</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">g_count</tt> </tt>
<a name="L555"></a><tt class="py-lineno">555</tt>  <tt class="py-line"> </tt>
<a name="L556"></a><tt class="py-lineno">556</tt>  <tt class="py-line">            <tt class="py-comment"># Hessian evaluations.</tt> </tt>
<a name="L557"></a><tt class="py-lineno">557</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">h_count_sim</tt><tt class="py-op">[</tt><tt class="py-name">sim_index</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">h_count</tt> </tt>
<a name="L558"></a><tt class="py-lineno">558</tt>  <tt class="py-line"> </tt>
<a name="L559"></a><tt class="py-lineno">559</tt>  <tt class="py-line">            <tt class="py-comment"># Warning.</tt> </tt>
<a name="L560"></a><tt class="py-lineno">560</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">warning_sim</tt><tt class="py-op">[</tt><tt class="py-name">sim_index</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-306" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.warning
gui.analyses.auto_model_free.Mf_list.warning
gui.analyses.elements.model_list.Model_list.warning" class="py-name" href="#" onclick="return doclink('link-306', 'warning', 'link-277');">warning</a></tt> </tt>
<a name="L561"></a><tt class="py-lineno">561</tt>  <tt class="py-line"> </tt>
<a name="L562"></a><tt class="py-lineno">562</tt>  <tt class="py-line">        <tt class="py-comment"># Normal statistics.</tt> </tt>
<a name="L563"></a><tt class="py-lineno">563</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L564"></a><tt class="py-lineno">564</tt>  <tt class="py-line">            <tt class="py-comment"># Chi-squared statistic.</tt> </tt>
<a name="L565"></a><tt class="py-lineno">565</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-307" class="py-name"><a title="target_functions.chi2
target_functions.chi2.chi2" class="py-name" href="#" onclick="return doclink('link-307', 'chi2', 'link-113');">chi2</a></tt> <tt class="py-op">=</tt> <tt id="link-308" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func" class="py-name" href="#" onclick="return doclink('link-308', 'func', 'link-115');">func</a></tt> </tt>
<a name="L566"></a><tt class="py-lineno">566</tt>  <tt class="py-line"> </tt>
<a name="L567"></a><tt class="py-lineno">567</tt>  <tt class="py-line">            <tt class="py-comment"># Iterations.</tt> </tt>
<a name="L568"></a><tt class="py-lineno">568</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">iter</tt> <tt class="py-op">=</tt> <tt class="py-name">iter_count</tt> </tt>
<a name="L569"></a><tt class="py-lineno">569</tt>  <tt class="py-line"> </tt>
<a name="L570"></a><tt class="py-lineno">570</tt>  <tt class="py-line">            <tt class="py-comment"># Function evaluations.</tt> </tt>
<a name="L571"></a><tt class="py-lineno">571</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">f_count</tt> <tt class="py-op">=</tt> <tt class="py-name">f_count</tt> </tt>
<a name="L572"></a><tt class="py-lineno">572</tt>  <tt class="py-line"> </tt>
<a name="L573"></a><tt class="py-lineno">573</tt>  <tt class="py-line">            <tt class="py-comment"># Gradient evaluations.</tt> </tt>
<a name="L574"></a><tt class="py-lineno">574</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">g_count</tt> <tt class="py-op">=</tt> <tt class="py-name">g_count</tt> </tt>
<a name="L575"></a><tt class="py-lineno">575</tt>  <tt class="py-line"> </tt>
<a name="L576"></a><tt class="py-lineno">576</tt>  <tt class="py-line">            <tt class="py-comment"># Hessian evaluations.</tt> </tt>
<a name="L577"></a><tt class="py-lineno">577</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">h_count</tt> <tt class="py-op">=</tt> <tt class="py-name">h_count</tt> </tt>
<a name="L578"></a><tt class="py-lineno">578</tt>  <tt class="py-line"> </tt>
<a name="L579"></a><tt class="py-lineno">579</tt>  <tt class="py-line">            <tt class="py-comment"># Warning.</tt> </tt>
<a name="L580"></a><tt class="py-lineno">580</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-309" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.warning
gui.analyses.auto_model_free.Mf_list.warning
gui.analyses.elements.model_list.Model_list.warning" class="py-name" href="#" onclick="return doclink('link-309', 'warning', 'link-277');">warning</a></tt> <tt class="py-op">=</tt> <tt id="link-310" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.warning
gui.analyses.auto_model_free.Mf_list.warning
gui.analyses.elements.model_list.Model_list.warning" class="py-name" href="#" onclick="return doclink('link-310', 'warning', 'link-277');">warning</a></tt> </tt>
<a name="L581"></a><tt class="py-lineno">581</tt>  <tt class="py-line"> </tt>
<a name="L582"></a><tt class="py-lineno">582</tt>  <tt class="py-line">        <tt class="py-comment"># Statistical analysis.</tt> </tt>
<a name="L583"></a><tt class="py-lineno">583</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-string">'rdc'</tt> <tt class="py-keyword">in</tt> <tt id="link-311" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-311', 'data_types', 'link-108');">data_types</a></tt> <tt class="py-keyword">or</tt> <tt class="py-string">'pcs'</tt> <tt class="py-keyword">in</tt> <tt id="link-312" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-312', 'data_types', 'link-108');">data_types</a></tt><tt class="py-op">:</tt> </tt>
<a name="L584"></a><tt class="py-lineno">584</tt>  <tt class="py-line">            <tt class="py-comment"># Get the final back calculated data (for the Q factor and</tt> </tt>
<a name="L585"></a><tt class="py-lineno">585</tt>  <tt class="py-line">            <tt id="link-313" class="py-name"><a title="specific_analyses.n_state_model.optimisation.minimise_bc_data" class="py-name" href="#" onclick="return doclink('link-313', 'minimise_bc_data', 'link-53');">minimise_bc_data</a></tt><tt class="py-op">(</tt><tt id="link-314" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-314', 'model', 'link-107');">model</a></tt><tt class="py-op">,</tt> <tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">)</tt> </tt>
<a name="L586"></a><tt class="py-lineno">586</tt>  <tt class="py-line"> </tt>
<a name="L587"></a><tt class="py-lineno">587</tt>  <tt class="py-line">            <tt class="py-comment"># Calculate the RDC Q factors.</tt> </tt>
<a name="L588"></a><tt class="py-lineno">588</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-string">'rdc'</tt> <tt class="py-keyword">in</tt> <tt id="link-315" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-315', 'data_types', 'link-108');">data_types</a></tt><tt class="py-op">:</tt> </tt>
<a name="L589"></a><tt class="py-lineno">589</tt>  <tt class="py-line">                <tt id="link-316" class="py-name"><a title="lib.alignment.rdc
pipe_control.rdc
test_suite.system_tests.rdc
user_functions.rdc" class="py-name" href="#" onclick="return doclink('link-316', 'rdc', 'link-27');">rdc</a></tt><tt class="py-op">.</tt><tt id="link-317" class="py-name"><a title="pipe_control.pcs.q_factors
pipe_control.rdc.q_factors" class="py-name" href="#" onclick="return doclink('link-317', 'q_factors', 'link-122');">q_factors</a></tt><tt class="py-op">(</tt><tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">,</tt> <tt id="link-318" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-318', 'verbosity', 'link-110');">verbosity</a></tt><tt class="py-op">=</tt><tt id="link-319" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-319', 'verbosity', 'link-110');">verbosity</a></tt><tt class="py-op">)</tt> </tt>
<a name="L590"></a><tt class="py-lineno">590</tt>  <tt class="py-line"> </tt>
<a name="L591"></a><tt class="py-lineno">591</tt>  <tt class="py-line">            <tt class="py-comment"># Calculate the PCS Q factors.</tt> </tt>
<a name="L592"></a><tt class="py-lineno">592</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-string">'pcs'</tt> <tt class="py-keyword">in</tt> <tt id="link-320" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-320', 'data_types', 'link-108');">data_types</a></tt><tt class="py-op">:</tt> </tt>
<a name="L593"></a><tt class="py-lineno">593</tt>  <tt class="py-line">                <tt id="link-321" class="py-name"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-321', 'pcs', 'link-26');">pcs</a></tt><tt class="py-op">.</tt><tt id="link-322" class="py-name"><a title="pipe_control.pcs.q_factors
pipe_control.rdc.q_factors" class="py-name" href="#" onclick="return doclink('link-322', 'q_factors', 'link-122');">q_factors</a></tt><tt class="py-op">(</tt><tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">,</tt> <tt id="link-323" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-323', 'verbosity', 'link-110');">verbosity</a></tt><tt class="py-op">=</tt><tt id="link-324" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-324', 'verbosity', 'link-110');">verbosity</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L594"></a><tt class="py-lineno">594</tt>  <tt class="py-line"> </tt>
<a name="L595"></a><tt class="py-lineno">595</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.model_statistics"></a><div id="N_state_model.model_statistics-def"><a name="L596"></a><tt class="py-lineno">596</tt> <a class="py-toggle" href="#" id="N_state_model.model_statistics-toggle" onclick="return toggle('N_state_model.model_statistics');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.api.N_state_model-class.html#model_statistics">model_statistics</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">model_info</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">spin_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">global_stats</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.model_statistics-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="N_state_model.model_statistics-expanded"><a name="L597"></a><tt class="py-lineno">597</tt>  <tt class="py-line">        <tt class="py-docstring">"""Return the k, n, and chi2 model statistics.</tt> </tt>
<a name="L598"></a><tt class="py-lineno">598</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L599"></a><tt class="py-lineno">599</tt>  <tt class="py-line"><tt class="py-docstring">        k - number of parameters.</tt> </tt>
<a name="L600"></a><tt class="py-lineno">600</tt>  <tt class="py-line"><tt class="py-docstring">        n - number of data points.</tt> </tt>
<a name="L601"></a><tt class="py-lineno">601</tt>  <tt class="py-line"><tt class="py-docstring">        chi2 - the chi-squared value.</tt> </tt>
<a name="L602"></a><tt class="py-lineno">602</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L603"></a><tt class="py-lineno">603</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L604"></a><tt class="py-lineno">604</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword model_info:    The model information from model_loop().  This is unused.</tt> </tt>
<a name="L605"></a><tt class="py-lineno">605</tt>  <tt class="py-line"><tt class="py-docstring">        @type model_info:       None</tt> </tt>
<a name="L606"></a><tt class="py-lineno">606</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword spin_id:       The spin identification string.  This is ignored in the N-state model.</tt> </tt>
<a name="L607"></a><tt class="py-lineno">607</tt>  <tt class="py-line"><tt class="py-docstring">        @type spin_id:          None or str</tt> </tt>
<a name="L608"></a><tt class="py-lineno">608</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword global_stats:  A parameter which determines if global or local statistics are returned.  For the N-state model, this argument is ignored.</tt> </tt>
<a name="L609"></a><tt class="py-lineno">609</tt>  <tt class="py-line"><tt class="py-docstring">        @type global_stats:     None or bool</tt> </tt>
<a name="L610"></a><tt class="py-lineno">610</tt>  <tt class="py-line"><tt class="py-docstring">        @return:                The optimisation statistics, in tuple format, of the number of parameters (k), the number of data points (n), and the chi-squared value (chi2).</tt> </tt>
<a name="L611"></a><tt class="py-lineno">611</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:                 tuple of (int, int, float)</tt> </tt>
<a name="L612"></a><tt class="py-lineno">612</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L613"></a><tt class="py-lineno">613</tt>  <tt class="py-line"> </tt>
<a name="L614"></a><tt class="py-lineno">614</tt>  <tt class="py-line">        <tt class="py-comment"># Return the values.</tt> </tt>
<a name="L615"></a><tt class="py-lineno">615</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt id="link-325" class="py-name"><a title="specific_analyses.frame_order.parameters.param_num
specific_analyses.n_state_model.parameters.param_num
specific_analyses.relax_disp.parameters.param_num" class="py-name" href="#" onclick="return doclink('link-325', 'param_num', 'link-65');">param_num</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt id="link-326" class="py-name"><a title="specific_analyses.n_state_model.data.num_data_points" class="py-name" href="#" onclick="return doclink('link-326', 'num_data_points', 'link-49');">num_data_points</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-327" class="py-name"><a title="target_functions.chi2
target_functions.chi2.chi2" class="py-name" href="#" onclick="return doclink('link-327', 'chi2', 'link-113');">chi2</a></tt> </tt>
</div><a name="L616"></a><tt class="py-lineno">616</tt>  <tt class="py-line"> </tt>
<a name="L617"></a><tt class="py-lineno">617</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.return_data"></a><div id="N_state_model.return_data-def"><a name="L618"></a><tt class="py-lineno">618</tt> <a class="py-toggle" href="#" id="N_state_model.return_data-toggle" onclick="return toggle('N_state_model.return_data');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.api.N_state_model-class.html#return_data">return_data</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">data_id</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.return_data-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="N_state_model.return_data-expanded"><a name="L619"></a><tt class="py-lineno">619</tt>  <tt class="py-line">        <tt class="py-docstring">"""Return the base data for the given data ID.</tt> </tt>
<a name="L620"></a><tt class="py-lineno">620</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L621"></a><tt class="py-lineno">621</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword data_id:   The list of spin ID, data type, and alignment ID, as yielded by the base_data_loop() generator method.</tt> </tt>
<a name="L622"></a><tt class="py-lineno">622</tt>  <tt class="py-line"><tt class="py-docstring">        @type data_id:      list of str</tt> </tt>
<a name="L623"></a><tt class="py-lineno">623</tt>  <tt class="py-line"><tt class="py-docstring">        @return:            The base data.</tt> </tt>
<a name="L624"></a><tt class="py-lineno">624</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:             list of (float or None)</tt> </tt>
<a name="L625"></a><tt class="py-lineno">625</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L626"></a><tt class="py-lineno">626</tt>  <tt class="py-line"> </tt>
<a name="L627"></a><tt class="py-lineno">627</tt>  <tt class="py-line">        <tt class="py-comment"># Alias the spin or interatomic data container, data type and alignment ID.</tt> </tt>
<a name="L628"></a><tt class="py-lineno">628</tt>  <tt class="py-line">        <tt id="link-328" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-328', 'container', 'link-160');">container</a></tt> <tt class="py-op">=</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L629"></a><tt class="py-lineno">629</tt>  <tt class="py-line">        <tt id="link-329" class="py-name" targets="Method specific_analyses.api_base.API_base.data_type()=specific_analyses.api_base.API_base-class.html#data_type"><a title="specific_analyses.api_base.API_base.data_type" class="py-name" href="#" onclick="return doclink('link-329', 'data_type', 'link-329');">data_type</a></tt> <tt class="py-op">=</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> </tt>
<a name="L630"></a><tt class="py-lineno">630</tt>  <tt class="py-line">        <tt class="py-name">align_id</tt> <tt class="py-op">=</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt> </tt>
<a name="L631"></a><tt class="py-lineno">631</tt>  <tt class="py-line"> </tt>
<a name="L632"></a><tt class="py-lineno">632</tt>  <tt class="py-line">        <tt class="py-comment"># The data structure to return.</tt> </tt>
<a name="L633"></a><tt class="py-lineno">633</tt>  <tt class="py-line">        <tt id="link-330" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-330', 'data', 'link-46');">data</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L634"></a><tt class="py-lineno">634</tt>  <tt class="py-line"> </tt>
<a name="L635"></a><tt class="py-lineno">635</tt>  <tt class="py-line">        <tt class="py-comment"># Skip deselected spins.</tt> </tt>
<a name="L636"></a><tt class="py-lineno">636</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'pcs'</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt id="link-331" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-331', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt id="link-332" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-332', 'select', 'link-86');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L637"></a><tt class="py-lineno">637</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
<a name="L638"></a><tt class="py-lineno">638</tt>  <tt class="py-line"> </tt>
<a name="L639"></a><tt class="py-lineno">639</tt>  <tt class="py-line">        <tt class="py-comment"># Return the RDC data.</tt> </tt>
<a name="L640"></a><tt class="py-lineno">640</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-333" class="py-name"><a title="specific_analyses.api_base.API_base.data_type" class="py-name" href="#" onclick="return doclink('link-333', 'data_type', 'link-329');">data_type</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'rdc'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-334" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-334', 'container', 'link-160');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'rdc'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L641"></a><tt class="py-lineno">641</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt id="link-335" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-335', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt id="link-336" class="py-name"><a title="lib.alignment.rdc
pipe_control.rdc
test_suite.system_tests.rdc
user_functions.rdc" class="py-name" href="#" onclick="return doclink('link-336', 'rdc', 'link-27');">rdc</a></tt><tt class="py-op">:</tt> </tt>
<a name="L642"></a><tt class="py-lineno">642</tt>  <tt class="py-line">                <tt id="link-337" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-337', 'data', 'link-46');">data</a></tt><tt class="py-op">.</tt><tt id="link-338" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-338', 'append', 'link-147');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">None</tt><tt class="py-op">)</tt> </tt>
<a name="L643"></a><tt class="py-lineno">643</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L644"></a><tt class="py-lineno">644</tt>  <tt class="py-line">                <tt id="link-339" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-339', 'data', 'link-46');">data</a></tt><tt class="py-op">.</tt><tt id="link-340" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-340', 'append', 'link-147');">append</a></tt><tt class="py-op">(</tt><tt id="link-341" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-341', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt id="link-342" class="py-name"><a title="lib.alignment.rdc
pipe_control.rdc
test_suite.system_tests.rdc
user_functions.rdc" class="py-name" href="#" onclick="return doclink('link-342', 'rdc', 'link-27');">rdc</a></tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L645"></a><tt class="py-lineno">645</tt>  <tt class="py-line"> </tt>
<a name="L646"></a><tt class="py-lineno">646</tt>  <tt class="py-line">        <tt class="py-comment"># Return the NOESY data.</tt> </tt>
<a name="L647"></a><tt class="py-lineno">647</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt id="link-343" class="py-name"><a title="specific_analyses.api_base.API_base.data_type" class="py-name" href="#" onclick="return doclink('link-343', 'data_type', 'link-329');">data_type</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'noesy'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-344" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-344', 'container', 'link-160');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'noesy'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L648"></a><tt class="py-lineno">648</tt>  <tt class="py-line">            <tt id="link-345" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-345', 'data', 'link-46');">data</a></tt><tt class="py-op">.</tt><tt id="link-346" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-346', 'append', 'link-147');">append</a></tt><tt class="py-op">(</tt><tt id="link-347" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-347', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt id="link-348" class="py-name" targets="Module pipe_control.noesy=pipe_control.noesy-module.html"><a title="pipe_control.noesy" class="py-name" href="#" onclick="return doclink('link-348', 'noesy', 'link-348');">noesy</a></tt><tt class="py-op">)</tt> </tt>
<a name="L649"></a><tt class="py-lineno">649</tt>  <tt class="py-line"> </tt>
<a name="L650"></a><tt class="py-lineno">650</tt>  <tt class="py-line">        <tt class="py-comment"># Return the PCS data.</tt> </tt>
<a name="L651"></a><tt class="py-lineno">651</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'pcs'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-349" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-349', 'container', 'link-160');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L652"></a><tt class="py-lineno">652</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt id="link-350" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-350', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt id="link-351" class="py-name"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-351', 'pcs', 'link-26');">pcs</a></tt><tt class="py-op">:</tt> </tt>
<a name="L653"></a><tt class="py-lineno">653</tt>  <tt class="py-line">                <tt id="link-352" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-352', 'data', 'link-46');">data</a></tt><tt class="py-op">.</tt><tt id="link-353" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-353', 'append', 'link-147');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">None</tt><tt class="py-op">)</tt> </tt>
<a name="L654"></a><tt class="py-lineno">654</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L655"></a><tt class="py-lineno">655</tt>  <tt class="py-line">                <tt id="link-354" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-354', 'data', 'link-46');">data</a></tt><tt class="py-op">.</tt><tt id="link-355" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-355', 'append', 'link-147');">append</a></tt><tt class="py-op">(</tt><tt id="link-356" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-356', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt id="link-357" class="py-name"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-357', 'pcs', 'link-26');">pcs</a></tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L656"></a><tt class="py-lineno">656</tt>  <tt class="py-line"> </tt>
<a name="L657"></a><tt class="py-lineno">657</tt>  <tt class="py-line">        <tt class="py-comment"># Return the data.</tt> </tt>
<a name="L658"></a><tt class="py-lineno">658</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt id="link-358" class="py-name"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-358', 'data', 'link-46');">data</a></tt> </tt>
</div><a name="L659"></a><tt class="py-lineno">659</tt>  <tt class="py-line"> </tt>
<a name="L660"></a><tt class="py-lineno">660</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.return_error"></a><div id="N_state_model.return_error-def"><a name="L661"></a><tt class="py-lineno">661</tt> <a class="py-toggle" href="#" id="N_state_model.return_error-toggle" onclick="return toggle('N_state_model.return_error');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.api.N_state_model-class.html#return_error">return_error</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">data_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.return_error-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="N_state_model.return_error-expanded"><a name="L662"></a><tt class="py-lineno">662</tt>  <tt class="py-line">        <tt class="py-docstring">"""Create and return the spin specific Monte Carlo Ri error structure.</tt> </tt>
<a name="L663"></a><tt class="py-lineno">663</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L664"></a><tt class="py-lineno">664</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword data_id:   The list of spin ID, data type, and alignment ID, as yielded by the base_data_loop() generator method.</tt> </tt>
<a name="L665"></a><tt class="py-lineno">665</tt>  <tt class="py-line"><tt class="py-docstring">        @type data_id:      str</tt> </tt>
<a name="L666"></a><tt class="py-lineno">666</tt>  <tt class="py-line"><tt class="py-docstring">        @return:            The Monte Carlo simulation data errors.</tt> </tt>
<a name="L667"></a><tt class="py-lineno">667</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:             list of float</tt> </tt>
<a name="L668"></a><tt class="py-lineno">668</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L669"></a><tt class="py-lineno">669</tt>  <tt class="py-line"> </tt>
<a name="L670"></a><tt class="py-lineno">670</tt>  <tt class="py-line">        <tt class="py-comment"># Initialise the MC data structure.</tt> </tt>
<a name="L671"></a><tt class="py-lineno">671</tt>  <tt class="py-line">        <tt class="py-name">mc_errors</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L672"></a><tt class="py-lineno">672</tt>  <tt class="py-line"> </tt>
<a name="L673"></a><tt class="py-lineno">673</tt>  <tt class="py-line">        <tt class="py-comment"># Alias the spin or interatomic data container.</tt> </tt>
<a name="L674"></a><tt class="py-lineno">674</tt>  <tt class="py-line">        <tt id="link-359" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-359', 'container', 'link-160');">container</a></tt> <tt class="py-op">=</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L675"></a><tt class="py-lineno">675</tt>  <tt class="py-line"> </tt>
<a name="L676"></a><tt class="py-lineno">676</tt>  <tt class="py-line">        <tt class="py-comment"># Skip deselected spins.</tt> </tt>
<a name="L677"></a><tt class="py-lineno">677</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'pcs'</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt id="link-360" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-360', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt id="link-361" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-361', 'select', 'link-86');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L678"></a><tt class="py-lineno">678</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
<a name="L679"></a><tt class="py-lineno">679</tt>  <tt class="py-line"> </tt>
<a name="L680"></a><tt class="py-lineno">680</tt>  <tt class="py-line">        <tt class="py-comment"># RDC data.</tt> </tt>
<a name="L681"></a><tt class="py-lineno">681</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'rdc'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-362" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-362', 'container', 'link-160');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'rdc'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L682"></a><tt class="py-lineno">682</tt>  <tt class="py-line">            <tt class="py-comment"># Do errors exist?</tt> </tt>
<a name="L683"></a><tt class="py-lineno">683</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-363" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-363', 'container', 'link-160');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'rdc_err'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L684"></a><tt class="py-lineno">684</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-364" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-364', 'RelaxError', 'link-13');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The RDC errors are missing for the spin pair '%s' and '%s'."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt id="link-365" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-365', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">spin_id1</tt><tt class="py-op">,</tt> <tt id="link-366" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-366', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">spin_id2</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L685"></a><tt class="py-lineno">685</tt>  <tt class="py-line"> </tt>
<a name="L686"></a><tt class="py-lineno">686</tt>  <tt class="py-line">            <tt class="py-comment"># The error.</tt> </tt>
<a name="L687"></a><tt class="py-lineno">687</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt id="link-367" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-367', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_err</tt><tt class="py-op">:</tt> </tt>
<a name="L688"></a><tt class="py-lineno">688</tt>  <tt class="py-line">                <tt class="py-name">err</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L689"></a><tt class="py-lineno">689</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L690"></a><tt class="py-lineno">690</tt>  <tt class="py-line">                <tt class="py-name">err</tt> <tt class="py-op">=</tt> <tt id="link-368" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-368', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_err</tt><tt class="py-op">[</tt><tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">]</tt> </tt>
<a name="L691"></a><tt class="py-lineno">691</tt>  <tt class="py-line"> </tt>
<a name="L692"></a><tt class="py-lineno">692</tt>  <tt class="py-line">            <tt class="py-comment"># Append the data.</tt> </tt>
<a name="L693"></a><tt class="py-lineno">693</tt>  <tt class="py-line">            <tt class="py-name">mc_errors</tt><tt class="py-op">.</tt><tt id="link-369" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-369', 'append', 'link-147');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">err</tt><tt class="py-op">)</tt> </tt>
<a name="L694"></a><tt class="py-lineno">694</tt>  <tt class="py-line"> </tt>
<a name="L695"></a><tt class="py-lineno">695</tt>  <tt class="py-line">        <tt class="py-comment"># NOESY data.</tt> </tt>
<a name="L696"></a><tt class="py-lineno">696</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'noesy'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-370" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-370', 'container', 'link-160');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'noesy'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L697"></a><tt class="py-lineno">697</tt>  <tt class="py-line">            <tt class="py-comment"># Do errors exist?</tt> </tt>
<a name="L698"></a><tt class="py-lineno">698</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-371" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-371', 'container', 'link-160');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'noesy_err'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L699"></a><tt class="py-lineno">699</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-372" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-372', 'RelaxError', 'link-13');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The NOESY errors are missing for the spin pair '%s' and '%s'."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt id="link-373" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-373', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">spin_id1</tt><tt class="py-op">,</tt> <tt id="link-374" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-374', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">spin_id2</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L700"></a><tt class="py-lineno">700</tt>  <tt class="py-line"> </tt>
<a name="L701"></a><tt class="py-lineno">701</tt>  <tt class="py-line">            <tt class="py-comment"># Append the data.</tt> </tt>
<a name="L702"></a><tt class="py-lineno">702</tt>  <tt class="py-line">            <tt class="py-name">mc_errors</tt><tt class="py-op">.</tt><tt id="link-375" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-375', 'append', 'link-147');">append</a></tt><tt class="py-op">(</tt><tt id="link-376" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-376', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">noesy_err</tt><tt class="py-op">)</tt> </tt>
<a name="L703"></a><tt class="py-lineno">703</tt>  <tt class="py-line"> </tt>
<a name="L704"></a><tt class="py-lineno">704</tt>  <tt class="py-line">        <tt class="py-comment"># PCS data.</tt> </tt>
<a name="L705"></a><tt class="py-lineno">705</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'pcs'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-377" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-377', 'container', 'link-160');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L706"></a><tt class="py-lineno">706</tt>  <tt class="py-line">            <tt class="py-comment"># Do errors exist?</tt> </tt>
<a name="L707"></a><tt class="py-lineno">707</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-378" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-378', 'container', 'link-160');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_err'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L708"></a><tt class="py-lineno">708</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-379" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-379', 'RelaxError', 'link-13');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The PCS errors are missing for spin '%s'."</tt> <tt class="py-op">%</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L709"></a><tt class="py-lineno">709</tt>  <tt class="py-line"> </tt>
<a name="L710"></a><tt class="py-lineno">710</tt>  <tt class="py-line">            <tt class="py-comment"># The error.</tt> </tt>
<a name="L711"></a><tt class="py-lineno">711</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt id="link-380" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-380', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt><tt class="py-op">:</tt> </tt>
<a name="L712"></a><tt class="py-lineno">712</tt>  <tt class="py-line">                <tt class="py-name">err</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L713"></a><tt class="py-lineno">713</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L714"></a><tt class="py-lineno">714</tt>  <tt class="py-line">                <tt class="py-name">err</tt> <tt class="py-op">=</tt> <tt id="link-381" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-381', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt><tt class="py-op">[</tt><tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">]</tt> </tt>
<a name="L715"></a><tt class="py-lineno">715</tt>  <tt class="py-line"> </tt>
<a name="L716"></a><tt class="py-lineno">716</tt>  <tt class="py-line">            <tt class="py-comment"># Append the data.</tt> </tt>
<a name="L717"></a><tt class="py-lineno">717</tt>  <tt class="py-line">            <tt class="py-name">mc_errors</tt><tt class="py-op">.</tt><tt id="link-382" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-382', 'append', 'link-147');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">err</tt><tt class="py-op">)</tt> </tt>
<a name="L718"></a><tt class="py-lineno">718</tt>  <tt class="py-line"> </tt>
<a name="L719"></a><tt class="py-lineno">719</tt>  <tt class="py-line">        <tt class="py-comment"># Return the errors.</tt> </tt>
<a name="L720"></a><tt class="py-lineno">720</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">mc_errors</tt> </tt>
</div><a name="L721"></a><tt class="py-lineno">721</tt>  <tt class="py-line"> </tt>
<a name="L722"></a><tt class="py-lineno">722</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.set_error"></a><div id="N_state_model.set_error-def"><a name="L723"></a><tt class="py-lineno">723</tt> <a class="py-toggle" href="#" id="N_state_model.set_error-toggle" onclick="return toggle('N_state_model.set_error');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.api.N_state_model-class.html#set_error">set_error</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">index</tt><tt class="py-op">,</tt> <tt class="py-param">error</tt><tt class="py-op">,</tt> <tt class="py-param">model_info</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.set_error-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="N_state_model.set_error-expanded"><a name="L724"></a><tt class="py-lineno">724</tt>  <tt class="py-line">        <tt class="py-docstring">"""Set the parameter errors.</tt> </tt>
<a name="L725"></a><tt class="py-lineno">725</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L726"></a><tt class="py-lineno">726</tt>  <tt class="py-line"><tt class="py-docstring">        @param index:           The index of the parameter to set the errors for.</tt> </tt>
<a name="L727"></a><tt class="py-lineno">727</tt>  <tt class="py-line"><tt class="py-docstring">        @type index:            int</tt> </tt>
<a name="L728"></a><tt class="py-lineno">728</tt>  <tt class="py-line"><tt class="py-docstring">        @param error:           The error value.</tt> </tt>
<a name="L729"></a><tt class="py-lineno">729</tt>  <tt class="py-line"><tt class="py-docstring">        @type error:            float</tt> </tt>
<a name="L730"></a><tt class="py-lineno">730</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword model_info:    The model information from model_loop().  This is unused.</tt> </tt>
<a name="L731"></a><tt class="py-lineno">731</tt>  <tt class="py-line"><tt class="py-docstring">        @type model_info:       None</tt> </tt>
<a name="L732"></a><tt class="py-lineno">732</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L733"></a><tt class="py-lineno">733</tt>  <tt class="py-line"> </tt>
<a name="L734"></a><tt class="py-lineno">734</tt>  <tt class="py-line">        <tt class="py-comment"># Align parameters.</tt> </tt>
<a name="L735"></a><tt class="py-lineno">735</tt>  <tt class="py-line">        <tt id="link-383" class="py-name" targets="Method data_store.align_tensor.AlignTensorList.names()=data_store.align_tensor.AlignTensorList-class.html#names"><a title="data_store.align_tensor.AlignTensorList.names" class="py-name" href="#" onclick="return doclink('link-383', 'names', 'link-383');">names</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-string">'Axx'</tt><tt class="py-op">,</tt> <tt class="py-string">'Ayy'</tt><tt class="py-op">,</tt> <tt class="py-string">'Axy'</tt><tt class="py-op">,</tt> <tt class="py-string">'Axz'</tt><tt class="py-op">,</tt> <tt class="py-string">'Ayz'</tt><tt class="py-op">]</tt> </tt>
<a name="L736"></a><tt class="py-lineno">736</tt>  <tt class="py-line"> </tt>
<a name="L737"></a><tt class="py-lineno">737</tt>  <tt class="py-line">        <tt class="py-comment"># Alignment tensor parameters.</tt> </tt>
<a name="L738"></a><tt class="py-lineno">738</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">index</tt> <tt class="py-op">&lt;</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt><tt class="py-op">)</tt><tt class="py-op">*</tt><tt class="py-number">5</tt><tt class="py-op">:</tt> </tt>
<a name="L739"></a><tt class="py-lineno">739</tt>  <tt class="py-line">            <tt class="py-comment"># The tensor and parameter index.</tt> </tt>
<a name="L740"></a><tt class="py-lineno">740</tt>  <tt class="py-line">            <tt class="py-name">param_index</tt> <tt class="py-op">=</tt> <tt class="py-name">index</tt> <tt class="py-op">%</tt> <tt class="py-number">5</tt> </tt>
<a name="L741"></a><tt class="py-lineno">741</tt>  <tt class="py-line">            <tt class="py-name">tensor_index</tt> <tt class="py-op">=</tt> <tt class="py-op">(</tt><tt class="py-name">index</tt> <tt class="py-op">-</tt> <tt class="py-name">index</tt> <tt class="py-op">%</tt> <tt class="py-number">5</tt><tt class="py-op">)</tt> <tt class="py-op">/</tt> <tt class="py-number">5</tt> </tt>
<a name="L742"></a><tt class="py-lineno">742</tt>  <tt class="py-line"> </tt>
<a name="L743"></a><tt class="py-lineno">743</tt>  <tt class="py-line">            <tt class="py-comment"># Set the error.</tt> </tt>
<a name="L744"></a><tt class="py-lineno">744</tt>  <tt class="py-line">            <tt id="link-384" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-384', 'tensor', 'link-213');">tensor</a></tt> <tt class="py-op">=</tt> <tt id="link-385" class="py-name"><a title="data_store.align_tensor
pipe_control.align_tensor
test_suite.system_tests.align_tensor
user_functions.align_tensor" class="py-name" href="#" onclick="return doclink('link-385', 'align_tensor', 'link-25');">align_tensor</a></tt><tt class="py-op">.</tt><tt id="link-386" class="py-name"><a title="pipe_control.align_tensor.return_tensor" class="py-name" href="#" onclick="return doclink('link-386', 'return_tensor', 'link-215');">return_tensor</a></tt><tt class="py-op">(</tt><tt class="py-name">index</tt><tt class="py-op">=</tt><tt class="py-name">tensor_index</tt><tt class="py-op">,</tt> <tt class="py-name">skip_fixed</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L745"></a><tt class="py-lineno">745</tt>  <tt class="py-line">            <tt id="link-387" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-387', 'tensor', 'link-213');">tensor</a></tt><tt class="py-op">.</tt><tt id="link-388" class="py-name"><a title="data_store.align_tensor.AlignTensorData.set
data_store.diff_tensor.DiffTensorData.set
multi.misc.Verbosity.set
pipe_control.align_tensor.set
pipe_control.diffusion_tensor.set
pipe_control.minimise.set
pipe_control.value.set
specific_analyses.parameter_object.Param_list.set" class="py-name" href="#" onclick="return doclink('link-388', 'set', 'link-220');">set</a></tt><tt class="py-op">(</tt><tt class="py-name">param</tt><tt class="py-op">=</tt><tt id="link-389" class="py-name"><a title="data_store.align_tensor.AlignTensorList.names" class="py-name" href="#" onclick="return doclink('link-389', 'names', 'link-383');">names</a></tt><tt class="py-op">[</tt><tt class="py-name">param_index</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt id="link-390" class="py-name" targets="Module gui.input_elements.value=gui.input_elements.value-module.html,Module pipe_control.value=pipe_control.value-module.html,Module test_suite.system_tests.value=test_suite.system_tests.value-module.html,Module user_functions.value=user_functions.value-module.html"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-390', 'value', 'link-390');">value</a></tt><tt class="py-op">=</tt><tt id="link-391" class="py-name" targets="Method relax.RelaxParser.error()=relax.RelaxParser-class.html#error"><a title="relax.RelaxParser.error" class="py-name" href="#" onclick="return doclink('link-391', 'error', 'link-391');">error</a></tt><tt class="py-op">,</tt> <tt id="link-392" class="py-name" targets="Variable test_suite.relax_test_runner.RelaxTestRunner.category=test_suite.relax_test_runner.RelaxTestRunner-class.html#category"><a title="test_suite.relax_test_runner.RelaxTestRunner.category" class="py-name" href="#" onclick="return doclink('link-392', 'category', 'link-392');">category</a></tt><tt class="py-op">=</tt><tt class="py-string">'err'</tt><tt class="py-op">)</tt> </tt>
<a name="L746"></a><tt class="py-lineno">746</tt>  <tt class="py-line"> </tt>
<a name="L747"></a><tt class="py-lineno">747</tt>  <tt class="py-line">            <tt class="py-comment"># Return the object.</tt> </tt>
<a name="L748"></a><tt class="py-lineno">748</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt id="link-393" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-393', 'tensor', 'link-213');">tensor</a></tt><tt class="py-op">,</tt> <tt id="link-394" class="py-name"><a title="data_store.align_tensor.AlignTensorList.names" class="py-name" href="#" onclick="return doclink('link-394', 'names', 'link-383');">names</a></tt><tt class="py-op">[</tt><tt class="py-name">param_index</tt><tt class="py-op">]</tt><tt class="py-op">+</tt><tt class="py-string">'_err'</tt><tt class="py-op">)</tt> </tt>
</div><a name="L749"></a><tt class="py-lineno">749</tt>  <tt class="py-line"> </tt>
<a name="L750"></a><tt class="py-lineno">750</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.set_param_values"></a><div id="N_state_model.set_param_values-def"><a name="L751"></a><tt class="py-lineno">751</tt> <a class="py-toggle" href="#" id="N_state_model.set_param_values-toggle" onclick="return toggle('N_state_model.set_param_values');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.api.N_state_model-class.html#set_param_values">set_param_values</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">param</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">value</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">index</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">spin_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">error</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">,</tt> <tt class="py-param">force</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.set_param_values-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="N_state_model.set_param_values-expanded"><a name="L752"></a><tt class="py-lineno">752</tt>  <tt class="py-line">        <tt class="py-docstring">"""Set the N-state model parameter values.</tt> </tt>
<a name="L753"></a><tt class="py-lineno">753</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L754"></a><tt class="py-lineno">754</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword param:     The parameter name list.</tt> </tt>
<a name="L755"></a><tt class="py-lineno">755</tt>  <tt class="py-line"><tt class="py-docstring">        @type param:        list of str</tt> </tt>
<a name="L756"></a><tt class="py-lineno">756</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword value:     The parameter value list.</tt> </tt>
<a name="L757"></a><tt class="py-lineno">757</tt>  <tt class="py-line"><tt class="py-docstring">        @type value:        list</tt> </tt>
<a name="L758"></a><tt class="py-lineno">758</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword index:     The index for parameters which are of the list-type (probs, alpha, beta, and gamma).  This is ignored for all other types.</tt> </tt>
<a name="L759"></a><tt class="py-lineno">759</tt>  <tt class="py-line"><tt class="py-docstring">        @type index:        None or int</tt> </tt>
<a name="L760"></a><tt class="py-lineno">760</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword spin_id:   The spin identification string (unused).</tt> </tt>
<a name="L761"></a><tt class="py-lineno">761</tt>  <tt class="py-line"><tt class="py-docstring">        @type spin_id:      None</tt> </tt>
<a name="L762"></a><tt class="py-lineno">762</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword error:     A flag which if True will allow the parameter errors to be set instead of the values.</tt> </tt>
<a name="L763"></a><tt class="py-lineno">763</tt>  <tt class="py-line"><tt class="py-docstring">        @type error:        bool</tt> </tt>
<a name="L764"></a><tt class="py-lineno">764</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword force:     A flag which if True will cause current values to be overwritten.  If False, a RelaxError will raised if the parameter value is already set.</tt> </tt>
<a name="L765"></a><tt class="py-lineno">765</tt>  <tt class="py-line"><tt class="py-docstring">        @type force:        bool</tt> </tt>
<a name="L766"></a><tt class="py-lineno">766</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L767"></a><tt class="py-lineno">767</tt>  <tt class="py-line"> </tt>
<a name="L768"></a><tt class="py-lineno">768</tt>  <tt class="py-line">        <tt class="py-comment"># Checks.</tt> </tt>
<a name="L769"></a><tt class="py-lineno">769</tt>  <tt class="py-line">        <tt id="link-395" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-395', 'lib', 'link-9');">lib</a></tt><tt class="py-op">.</tt><tt id="link-396" class="py-name"><a title="lib.arg_check" class="py-name" href="#" onclick="return doclink('link-396', 'arg_check', 'link-10');">arg_check</a></tt><tt class="py-op">.</tt><tt id="link-397" class="py-name" targets="Function lib.arg_check.is_str_list()=lib.arg_check-module.html#is_str_list"><a title="lib.arg_check.is_str_list" class="py-name" href="#" onclick="return doclink('link-397', 'is_str_list', 'link-397');">is_str_list</a></tt><tt class="py-op">(</tt><tt class="py-name">param</tt><tt class="py-op">,</tt> <tt class="py-string">'parameter name'</tt><tt class="py-op">)</tt> </tt>
<a name="L770"></a><tt class="py-lineno">770</tt>  <tt class="py-line">        <tt id="link-398" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-398', 'lib', 'link-9');">lib</a></tt><tt class="py-op">.</tt><tt id="link-399" class="py-name"><a title="lib.arg_check" class="py-name" href="#" onclick="return doclink('link-399', 'arg_check', 'link-10');">arg_check</a></tt><tt class="py-op">.</tt><tt id="link-400" class="py-name" targets="Function lib.arg_check.is_list()=lib.arg_check-module.html#is_list,Function lib.check_types.is_list()=lib.check_types-module.html#is_list"><a title="lib.arg_check.is_list
lib.check_types.is_list" class="py-name" href="#" onclick="return doclink('link-400', 'is_list', 'link-400');">is_list</a></tt><tt class="py-op">(</tt><tt id="link-401" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-401', 'value', 'link-390');">value</a></tt><tt class="py-op">,</tt> <tt class="py-string">'parameter value'</tt><tt class="py-op">)</tt> </tt>
<a name="L771"></a><tt class="py-lineno">771</tt>  <tt class="py-line"> </tt>
<a name="L772"></a><tt class="py-lineno">772</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the parameters.</tt> </tt>
<a name="L773"></a><tt class="py-lineno">773</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-402" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-402', 'i', 'link-131');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">param</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L774"></a><tt class="py-lineno">774</tt>  <tt class="py-line">            <tt class="py-comment"># Is the parameter is valid?</tt> </tt>
<a name="L775"></a><tt class="py-lineno">775</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">param</tt><tt class="py-op">[</tt><tt id="link-403" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-403', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L776"></a><tt class="py-lineno">776</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-404" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-404', 'RelaxError', 'link-13');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The parameter '%s' is not valid for this data pipe type."</tt> <tt class="py-op">%</tt> <tt class="py-name">param</tt><tt class="py-op">[</tt><tt id="link-405" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-405', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L777"></a><tt class="py-lineno">777</tt>  <tt class="py-line"> </tt>
<a name="L778"></a><tt class="py-lineno">778</tt>  <tt class="py-line">            <tt class="py-comment"># Error object.</tt> </tt>
<a name="L779"></a><tt class="py-lineno">779</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-406" class="py-name"><a title="relax.RelaxParser.error" class="py-name" href="#" onclick="return doclink('link-406', 'error', 'link-391');">error</a></tt><tt class="py-op">:</tt> </tt>
<a name="L780"></a><tt class="py-lineno">780</tt>  <tt class="py-line">                <tt class="py-name">param</tt><tt class="py-op">[</tt><tt id="link-407" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-407', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">+=</tt> <tt class="py-string">'_err'</tt> </tt>
<a name="L781"></a><tt class="py-lineno">781</tt>  <tt class="py-line"> </tt>
<a name="L782"></a><tt class="py-lineno">782</tt>  <tt class="py-line">            <tt class="py-comment"># Set the indexed parameter.</tt> </tt>
<a name="L783"></a><tt class="py-lineno">783</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">param</tt><tt class="py-op">[</tt><tt id="link-408" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-408', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt class="py-string">'probs'</tt><tt class="py-op">,</tt> <tt class="py-string">'alpha'</tt><tt class="py-op">,</tt> <tt class="py-string">'beta'</tt><tt class="py-op">,</tt> <tt class="py-string">'gamma'</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L784"></a><tt class="py-lineno">784</tt>  <tt class="py-line">                <tt class="py-name">obj</tt> <tt class="py-op">=</tt> <tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-name">param</tt><tt class="py-op">[</tt><tt id="link-409" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-409', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L785"></a><tt class="py-lineno">785</tt>  <tt class="py-line">                <tt class="py-name">obj</tt><tt class="py-op">[</tt><tt class="py-name">index</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-410" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-410', 'value', 'link-390');">value</a></tt><tt class="py-op">[</tt><tt id="link-411" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-411', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt> </tt>
<a name="L786"></a><tt class="py-lineno">786</tt>  <tt class="py-line"> </tt>
<a name="L787"></a><tt class="py-lineno">787</tt>  <tt class="py-line">            <tt class="py-comment"># Set the spin parameters.</tt> </tt>
<a name="L788"></a><tt class="py-lineno">788</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L789"></a><tt class="py-lineno">789</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt id="link-412" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-412', 'spin', 'link-97');">spin</a></tt> <tt class="py-keyword">in</tt> <tt id="link-413" class="py-name"><a title="pipe_control.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-413', 'spin_loop', 'link-37');">spin_loop</a></tt><tt class="py-op">(</tt><tt id="link-414" class="py-name" targets="Module gui.input_elements.spin_id=gui.input_elements.spin_id-module.html"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-414', 'spin_id', 'link-414');">spin_id</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L790"></a><tt class="py-lineno">790</tt>  <tt class="py-line">                    <tt class="py-name">setattr</tt><tt class="py-op">(</tt><tt id="link-415" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-415', 'spin', 'link-97');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">param</tt><tt class="py-op">[</tt><tt id="link-416" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-416', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt id="link-417" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-417', 'value', 'link-390');">value</a></tt><tt class="py-op">[</tt><tt id="link-418" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-418', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
</div><a name="L791"></a><tt class="py-lineno">791</tt>  <tt class="py-line"> </tt>
<a name="L792"></a><tt class="py-lineno">792</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.sim_init_values"></a><div id="N_state_model.sim_init_values-def"><a name="L793"></a><tt class="py-lineno">793</tt> <a class="py-toggle" href="#" id="N_state_model.sim_init_values-toggle" onclick="return toggle('N_state_model.sim_init_values');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.api.N_state_model-class.html#sim_init_values">sim_init_values</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.sim_init_values-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="N_state_model.sim_init_values-expanded"><a name="L794"></a><tt class="py-lineno">794</tt>  <tt class="py-line">        <tt class="py-docstring">"""Initialise the Monte Carlo parameter values."""</tt> </tt>
<a name="L795"></a><tt class="py-lineno">795</tt>  <tt class="py-line"> </tt>
<a name="L796"></a><tt class="py-lineno">796</tt>  <tt class="py-line">        <tt class="py-comment"># Get the minimisation statistic object names.</tt> </tt>
<a name="L797"></a><tt class="py-lineno">797</tt>  <tt class="py-line">        <tt class="py-name">sim_names</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-419" class="py-name" targets="Function pipe_control.diffusion_tensor.data_names()=pipe_control.diffusion_tensor-module.html#data_names,Method specific_analyses.api_base.API_base.data_names()=specific_analyses.api_base.API_base-class.html#data_names,Method specific_analyses.hybrid.Hybrid.data_names()=specific_analyses.hybrid.Hybrid-class.html#data_names,Method specific_analyses.parameter_object.Param_list.data_names()=specific_analyses.parameter_object.Param_list-class.html#data_names"><a title="pipe_control.diffusion_tensor.data_names
specific_analyses.api_base.API_base.data_names
specific_analyses.hybrid.Hybrid.data_names
specific_analyses.parameter_object.Param_list.data_names" class="py-name" href="#" onclick="return doclink('link-419', 'data_names', 'link-419');">data_names</a></tt><tt class="py-op">(</tt><tt id="link-420" class="py-name"><a title="data_store.align_tensor.AlignTensorData.set
data_store.diff_tensor.DiffTensorData.set
multi.misc.Verbosity.set
pipe_control.align_tensor.set
pipe_control.diffusion_tensor.set
pipe_control.minimise.set
pipe_control.value.set
specific_analyses.parameter_object.Param_list.set" class="py-name" href="#" onclick="return doclink('link-420', 'set', 'link-220');">set</a></tt><tt class="py-op">=</tt><tt class="py-string">'min'</tt><tt class="py-op">)</tt> </tt>
<a name="L798"></a><tt class="py-lineno">798</tt>  <tt class="py-line"> </tt>
<a name="L799"></a><tt class="py-lineno">799</tt>  <tt class="py-line">        <tt class="py-comment"># Add the paramagnetic centre, if optimised.</tt> </tt>
<a name="L800"></a><tt class="py-lineno">800</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'paramag_centre_fixed'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramag_centre_fixed</tt><tt class="py-op">:</tt> </tt>
<a name="L801"></a><tt class="py-lineno">801</tt>  <tt class="py-line">            <tt class="py-name">sim_names</tt> <tt class="py-op">+=</tt> <tt class="py-op">[</tt><tt class="py-string">'paramagnetic_centre'</tt><tt class="py-op">]</tt> </tt>
<a name="L802"></a><tt class="py-lineno">802</tt>  <tt class="py-line"> </tt>
<a name="L803"></a><tt class="py-lineno">803</tt>  <tt class="py-line">        <tt class="py-comment"># Alignments.</tt> </tt>
<a name="L804"></a><tt class="py-lineno">804</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'align_tensors'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L805"></a><tt class="py-lineno">805</tt>  <tt class="py-line">            <tt class="py-comment"># The parameter names.</tt> </tt>
<a name="L806"></a><tt class="py-lineno">806</tt>  <tt class="py-line">            <tt id="link-421" class="py-name"><a title="data_store.align_tensor.AlignTensorList.names" class="py-name" href="#" onclick="return doclink('link-421', 'names', 'link-383');">names</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-string">'Axx'</tt><tt class="py-op">,</tt> <tt class="py-string">'Ayy'</tt><tt class="py-op">,</tt> <tt class="py-string">'Axy'</tt><tt class="py-op">,</tt> <tt class="py-string">'Axz'</tt><tt class="py-op">,</tt> <tt class="py-string">'Ayz'</tt><tt class="py-op">]</tt> </tt>
<a name="L807"></a><tt class="py-lineno">807</tt>  <tt class="py-line"> </tt>
<a name="L808"></a><tt class="py-lineno">808</tt>  <tt class="py-line">            <tt class="py-comment"># Loop over the alignments, adding the alignment tensor parameters to the tensor data container.</tt> </tt>
<a name="L809"></a><tt class="py-lineno">809</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-422" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-422', 'i', 'link-131');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L810"></a><tt class="py-lineno">810</tt>  <tt class="py-line">                <tt class="py-comment"># Skip non-optimised tensors.</tt> </tt>
<a name="L811"></a><tt class="py-lineno">811</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-423" class="py-name"><a title="pipe_control.align_tensor.opt_uses_tensor" class="py-name" href="#" onclick="return doclink('link-423', 'opt_uses_tensor', 'link-31');">opt_uses_tensor</a></tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">[</tt><tt id="link-424" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-424', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L812"></a><tt class="py-lineno">812</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L813"></a><tt class="py-lineno">813</tt>  <tt class="py-line"> </tt>
<a name="L814"></a><tt class="py-lineno">814</tt>  <tt class="py-line">                <tt class="py-comment"># Set up the number of simulations.</tt> </tt>
<a name="L815"></a><tt class="py-lineno">815</tt>  <tt class="py-line">                <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">[</tt><tt id="link-425" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-425', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-426" class="py-name" targets="Method data_store.align_tensor.AlignTensorData.set_sim_num()=data_store.align_tensor.AlignTensorData-class.html#set_sim_num,Method data_store.diff_tensor.DiffTensorData.set_sim_num()=data_store.diff_tensor.DiffTensorData-class.html#set_sim_num"><a title="data_store.align_tensor.AlignTensorData.set_sim_num
data_store.diff_tensor.DiffTensorData.set_sim_num" class="py-name" href="#" onclick="return doclink('link-426', 'set_sim_num', 'link-426');">set_sim_num</a></tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">sim_number</tt><tt class="py-op">)</tt> </tt>
<a name="L816"></a><tt class="py-lineno">816</tt>  <tt class="py-line"> </tt>
<a name="L817"></a><tt class="py-lineno">817</tt>  <tt class="py-line">                <tt class="py-comment"># Loop over all the parameter names, setting the initial simulation values to those of the parameter value.</tt> </tt>
<a name="L818"></a><tt class="py-lineno">818</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">object_name</tt> <tt class="py-keyword">in</tt> <tt id="link-427" class="py-name"><a title="data_store.align_tensor.AlignTensorList.names" class="py-name" href="#" onclick="return doclink('link-427', 'names', 'link-383');">names</a></tt><tt class="py-op">:</tt> </tt>
<a name="L819"></a><tt class="py-lineno">819</tt>  <tt class="py-line">                    <tt class="py-keyword">for</tt> <tt class="py-name">j</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">sim_number</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L820"></a><tt class="py-lineno">820</tt>  <tt class="py-line">                        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">[</tt><tt id="link-428" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-428', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-429" class="py-name"><a title="data_store.align_tensor.AlignTensorData.set
data_store.diff_tensor.DiffTensorData.set
multi.misc.Verbosity.set
pipe_control.align_tensor.set
pipe_control.diffusion_tensor.set
pipe_control.minimise.set
pipe_control.value.set
specific_analyses.parameter_object.Param_list.set" class="py-name" href="#" onclick="return doclink('link-429', 'set', 'link-220');">set</a></tt><tt class="py-op">(</tt><tt class="py-name">param</tt><tt class="py-op">=</tt><tt class="py-name">object_name</tt><tt class="py-op">,</tt> <tt id="link-430" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-430', 'value', 'link-390');">value</a></tt><tt class="py-op">=</tt><tt class="py-name">deepcopy</tt><tt class="py-op">(</tt><tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">[</tt><tt id="link-431" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-431', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">object_name</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt id="link-432" class="py-name"><a title="test_suite.relax_test_runner.RelaxTestRunner.category" class="py-name" href="#" onclick="return doclink('link-432', 'category', 'link-392');">category</a></tt><tt class="py-op">=</tt><tt class="py-string">'sim'</tt><tt class="py-op">,</tt> <tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">j</tt><tt class="py-op">)</tt> </tt>
<a name="L821"></a><tt class="py-lineno">821</tt>  <tt class="py-line"> </tt>
<a name="L822"></a><tt class="py-lineno">822</tt>  <tt class="py-line">            <tt class="py-comment"># Create all other simulation objects.</tt> </tt>
<a name="L823"></a><tt class="py-lineno">823</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">object_name</tt> <tt class="py-keyword">in</tt> <tt class="py-name">sim_names</tt><tt class="py-op">:</tt> </tt>
<a name="L824"></a><tt class="py-lineno">824</tt>  <tt class="py-line">                <tt class="py-comment"># Name for the simulation object.</tt> </tt>
<a name="L825"></a><tt class="py-lineno">825</tt>  <tt class="py-line">                <tt class="py-name">sim_object_name</tt> <tt class="py-op">=</tt> <tt class="py-name">object_name</tt> <tt class="py-op">+</tt> <tt class="py-string">'_sim'</tt> </tt>
<a name="L826"></a><tt class="py-lineno">826</tt>  <tt class="py-line"> </tt>
<a name="L827"></a><tt class="py-lineno">827</tt>  <tt class="py-line">                <tt class="py-comment"># Create the simulation object.</tt> </tt>
<a name="L828"></a><tt class="py-lineno">828</tt>  <tt class="py-line">                <tt class="py-name">setattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-name">sim_object_name</tt><tt class="py-op">,</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L829"></a><tt class="py-lineno">829</tt>  <tt class="py-line"> </tt>
<a name="L830"></a><tt class="py-lineno">830</tt>  <tt class="py-line">                <tt class="py-comment"># Get the simulation object.</tt> </tt>
<a name="L831"></a><tt class="py-lineno">831</tt>  <tt class="py-line">                <tt class="py-name">sim_object</tt> <tt class="py-op">=</tt> <tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-name">sim_object_name</tt><tt class="py-op">)</tt> </tt>
<a name="L832"></a><tt class="py-lineno">832</tt>  <tt class="py-line"> </tt>
<a name="L833"></a><tt class="py-lineno">833</tt>  <tt class="py-line">                <tt class="py-comment"># Loop over the simulations.</tt> </tt>
<a name="L834"></a><tt class="py-lineno">834</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">j</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">sim_number</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L835"></a><tt class="py-lineno">835</tt>  <tt class="py-line">                    <tt class="py-comment"># Append None to fill the structure.</tt> </tt>
<a name="L836"></a><tt class="py-lineno">836</tt>  <tt class="py-line">                    <tt class="py-name">sim_object</tt><tt class="py-op">.</tt><tt id="link-433" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-433', 'append', 'link-147');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">None</tt><tt class="py-op">)</tt> </tt>
<a name="L837"></a><tt class="py-lineno">837</tt>  <tt class="py-line"> </tt>
<a name="L838"></a><tt class="py-lineno">838</tt>  <tt class="py-line">            <tt class="py-comment"># Set the simulation paramagnetic centre positions to the optimised values.</tt> </tt>
<a name="L839"></a><tt class="py-lineno">839</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'paramag_centre_fixed'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramag_centre_fixed</tt><tt class="py-op">:</tt> </tt>
<a name="L840"></a><tt class="py-lineno">840</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">j</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">sim_number</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L841"></a><tt class="py-lineno">841</tt>  <tt class="py-line">                    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramagnetic_centre_sim</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">deepcopy</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramagnetic_centre</tt><tt class="py-op">)</tt> </tt>
</div><a name="L842"></a><tt class="py-lineno">842</tt>  <tt class="py-line"> </tt>
<a name="L843"></a><tt class="py-lineno">843</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.sim_pack_data"></a><div id="N_state_model.sim_pack_data-def"><a name="L844"></a><tt class="py-lineno">844</tt> <a class="py-toggle" href="#" id="N_state_model.sim_pack_data-toggle" onclick="return toggle('N_state_model.sim_pack_data');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.api.N_state_model-class.html#sim_pack_data">sim_pack_data</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">data_id</tt><tt class="py-op">,</tt> <tt class="py-param">sim_data</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.sim_pack_data-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="N_state_model.sim_pack_data-expanded"><a name="L845"></a><tt class="py-lineno">845</tt>  <tt class="py-line">        <tt class="py-docstring">"""Pack the Monte Carlo simulation data.</tt> </tt>
<a name="L846"></a><tt class="py-lineno">846</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L847"></a><tt class="py-lineno">847</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword data_id:   The list of spin ID, data type, and alignment ID, as yielded by the base_data_loop() generator method.</tt> </tt>
<a name="L848"></a><tt class="py-lineno">848</tt>  <tt class="py-line"><tt class="py-docstring">        @type data_id:      list of str</tt> </tt>
<a name="L849"></a><tt class="py-lineno">849</tt>  <tt class="py-line"><tt class="py-docstring">        @param sim_data:    The Monte Carlo simulation data.</tt> </tt>
<a name="L850"></a><tt class="py-lineno">850</tt>  <tt class="py-line"><tt class="py-docstring">        @type sim_data:     list of float</tt> </tt>
<a name="L851"></a><tt class="py-lineno">851</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L852"></a><tt class="py-lineno">852</tt>  <tt class="py-line"> </tt>
<a name="L853"></a><tt class="py-lineno">853</tt>  <tt class="py-line">        <tt class="py-comment"># Alias the spin or interatomic data container.</tt> </tt>
<a name="L854"></a><tt class="py-lineno">854</tt>  <tt class="py-line">        <tt id="link-434" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-434', 'container', 'link-160');">container</a></tt> <tt class="py-op">=</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L855"></a><tt class="py-lineno">855</tt>  <tt class="py-line"> </tt>
<a name="L856"></a><tt class="py-lineno">856</tt>  <tt class="py-line">        <tt class="py-comment"># RDC data.</tt> </tt>
<a name="L857"></a><tt class="py-lineno">857</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'rdc'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-435" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-435', 'container', 'link-160');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'rdc'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L858"></a><tt class="py-lineno">858</tt>  <tt class="py-line">            <tt class="py-comment"># Initialise.</tt> </tt>
<a name="L859"></a><tt class="py-lineno">859</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-436" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-436', 'container', 'link-160');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'rdc_sim'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L860"></a><tt class="py-lineno">860</tt>  <tt class="py-line">                <tt id="link-437" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-437', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_sim</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L861"></a><tt class="py-lineno">861</tt>  <tt class="py-line">                 </tt>
<a name="L862"></a><tt class="py-lineno">862</tt>  <tt class="py-line">            <tt class="py-comment"># Store the data structure.</tt> </tt>
<a name="L863"></a><tt class="py-lineno">863</tt>  <tt class="py-line">            <tt id="link-438" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-438', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_sim</tt><tt class="py-op">[</tt><tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L864"></a><tt class="py-lineno">864</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-439" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-439', 'i', 'link-131');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">sim_number</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L865"></a><tt class="py-lineno">865</tt>  <tt class="py-line">                <tt id="link-440" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-440', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_sim</tt><tt class="py-op">[</tt><tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-441" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-441', 'append', 'link-147');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">sim_data</tt><tt class="py-op">[</tt><tt id="link-442" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-442', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L866"></a><tt class="py-lineno">866</tt>  <tt class="py-line"> </tt>
<a name="L867"></a><tt class="py-lineno">867</tt>  <tt class="py-line">        <tt class="py-comment"># NOESY data.</tt> </tt>
<a name="L868"></a><tt class="py-lineno">868</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'noesy'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-443" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-443', 'container', 'link-160');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'noesy'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L869"></a><tt class="py-lineno">869</tt>  <tt class="py-line">            <tt class="py-comment"># Store the data structure.</tt> </tt>
<a name="L870"></a><tt class="py-lineno">870</tt>  <tt class="py-line">            <tt id="link-444" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-444', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">noesy_sim</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L871"></a><tt class="py-lineno">871</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-445" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-445', 'i', 'link-131');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">sim_number</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L872"></a><tt class="py-lineno">872</tt>  <tt class="py-line">                <tt id="link-446" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-446', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">noesy_sim</tt><tt class="py-op">[</tt><tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-447" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-447', 'append', 'link-147');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">sim_data</tt><tt class="py-op">[</tt><tt id="link-448" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-448', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L873"></a><tt class="py-lineno">873</tt>  <tt class="py-line"> </tt>
<a name="L874"></a><tt class="py-lineno">874</tt>  <tt class="py-line">        <tt class="py-comment"># PCS data.</tt> </tt>
<a name="L875"></a><tt class="py-lineno">875</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'pcs'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-449" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-449', 'container', 'link-160');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L876"></a><tt class="py-lineno">876</tt>  <tt class="py-line">            <tt class="py-comment"># Initialise.</tt> </tt>
<a name="L877"></a><tt class="py-lineno">877</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-450" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-450', 'container', 'link-160');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_sim'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L878"></a><tt class="py-lineno">878</tt>  <tt class="py-line">                <tt id="link-451" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-451', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_sim</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L879"></a><tt class="py-lineno">879</tt>  <tt class="py-line">                 </tt>
<a name="L880"></a><tt class="py-lineno">880</tt>  <tt class="py-line">            <tt class="py-comment"># Store the data structure.</tt> </tt>
<a name="L881"></a><tt class="py-lineno">881</tt>  <tt class="py-line">            <tt id="link-452" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-452', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_sim</tt><tt class="py-op">[</tt><tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L882"></a><tt class="py-lineno">882</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-453" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-453', 'i', 'link-131');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">sim_number</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L883"></a><tt class="py-lineno">883</tt>  <tt class="py-line">                <tt id="link-454" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-454', 'container', 'link-160');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_sim</tt><tt class="py-op">[</tt><tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-455" class="py-name"><a title="data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-455', 'append', 'link-147');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">sim_data</tt><tt class="py-op">[</tt><tt id="link-456" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-456', 'i', 'link-131');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
</div><a name="L884"></a><tt class="py-lineno">884</tt>  <tt class="py-line"> </tt>
<a name="L885"></a><tt class="py-lineno">885</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.sim_return_param"></a><div id="N_state_model.sim_return_param-def"><a name="L886"></a><tt class="py-lineno">886</tt> <a class="py-toggle" href="#" id="N_state_model.sim_return_param-toggle" onclick="return toggle('N_state_model.sim_return_param');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.api.N_state_model-class.html#sim_return_param">sim_return_param</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">index</tt><tt class="py-op">,</tt> <tt class="py-param">model_info</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.sim_return_param-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="N_state_model.sim_return_param-expanded"><a name="L887"></a><tt class="py-lineno">887</tt>  <tt class="py-line">        <tt class="py-docstring">"""Return the array of simulation parameter values.</tt> </tt>
<a name="L888"></a><tt class="py-lineno">888</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L889"></a><tt class="py-lineno">889</tt>  <tt class="py-line"><tt class="py-docstring">        @param index:           The index of the parameter to return the array of values for.</tt> </tt>
<a name="L890"></a><tt class="py-lineno">890</tt>  <tt class="py-line"><tt class="py-docstring">        @type index:            int</tt> </tt>
<a name="L891"></a><tt class="py-lineno">891</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword model_info:    The model information from model_loop().  This is unused.</tt> </tt>
<a name="L892"></a><tt class="py-lineno">892</tt>  <tt class="py-line"><tt class="py-docstring">        @type model_info:       None</tt> </tt>
<a name="L893"></a><tt class="py-lineno">893</tt>  <tt class="py-line"><tt class="py-docstring">        @return:                The array of simulation parameter values.</tt> </tt>
<a name="L894"></a><tt class="py-lineno">894</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:                 list of float</tt> </tt>
<a name="L895"></a><tt class="py-lineno">895</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L896"></a><tt class="py-lineno">896</tt>  <tt class="py-line"> </tt>
<a name="L897"></a><tt class="py-lineno">897</tt>  <tt class="py-line">        <tt class="py-comment"># Align parameters.</tt> </tt>
<a name="L898"></a><tt class="py-lineno">898</tt>  <tt class="py-line">        <tt id="link-457" class="py-name"><a title="data_store.align_tensor.AlignTensorList.names" class="py-name" href="#" onclick="return doclink('link-457', 'names', 'link-383');">names</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-string">'Axx'</tt><tt class="py-op">,</tt> <tt class="py-string">'Ayy'</tt><tt class="py-op">,</tt> <tt class="py-string">'Axy'</tt><tt class="py-op">,</tt> <tt class="py-string">'Axz'</tt><tt class="py-op">,</tt> <tt class="py-string">'Ayz'</tt><tt class="py-op">]</tt> </tt>
<a name="L899"></a><tt class="py-lineno">899</tt>  <tt class="py-line"> </tt>
<a name="L900"></a><tt class="py-lineno">900</tt>  <tt class="py-line">        <tt class="py-comment"># Alignment tensor parameters.</tt> </tt>
<a name="L901"></a><tt class="py-lineno">901</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">index</tt> <tt class="py-op">&lt;</tt> <tt id="link-458" class="py-name"><a title="data_store.align_tensor
pipe_control.align_tensor
test_suite.system_tests.align_tensor
user_functions.align_tensor" class="py-name" href="#" onclick="return doclink('link-458', 'align_tensor', 'link-25');">align_tensor</a></tt><tt class="py-op">.</tt><tt id="link-459" class="py-name"><a title="pipe_control.align_tensor.num_tensors" class="py-name" href="#" onclick="return doclink('link-459', 'num_tensors', 'link-206');">num_tensors</a></tt><tt class="py-op">(</tt><tt class="py-name">skip_fixed</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">*</tt><tt class="py-number">5</tt><tt class="py-op">:</tt> </tt>
<a name="L902"></a><tt class="py-lineno">902</tt>  <tt class="py-line">            <tt class="py-comment"># The tensor and parameter index.</tt> </tt>
<a name="L903"></a><tt class="py-lineno">903</tt>  <tt class="py-line">            <tt class="py-name">param_index</tt> <tt class="py-op">=</tt> <tt class="py-name">index</tt> <tt class="py-op">%</tt> <tt class="py-number">5</tt> </tt>
<a name="L904"></a><tt class="py-lineno">904</tt>  <tt class="py-line">            <tt class="py-name">tensor_index</tt> <tt class="py-op">=</tt> <tt class="py-op">(</tt><tt class="py-name">index</tt> <tt class="py-op">-</tt> <tt class="py-name">index</tt> <tt class="py-op">%</tt> <tt class="py-number">5</tt><tt class="py-op">)</tt> <tt class="py-op">/</tt> <tt class="py-number">5</tt> </tt>
<a name="L905"></a><tt class="py-lineno">905</tt>  <tt class="py-line"> </tt>
<a name="L906"></a><tt class="py-lineno">906</tt>  <tt class="py-line">            <tt class="py-comment"># Return the simulation parameter array.</tt> </tt>
<a name="L907"></a><tt class="py-lineno">907</tt>  <tt class="py-line">            <tt id="link-460" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-460', 'tensor', 'link-213');">tensor</a></tt> <tt class="py-op">=</tt> <tt id="link-461" class="py-name"><a title="data_store.align_tensor
pipe_control.align_tensor
test_suite.system_tests.align_tensor
user_functions.align_tensor" class="py-name" href="#" onclick="return doclink('link-461', 'align_tensor', 'link-25');">align_tensor</a></tt><tt class="py-op">.</tt><tt id="link-462" class="py-name"><a title="pipe_control.align_tensor.return_tensor" class="py-name" href="#" onclick="return doclink('link-462', 'return_tensor', 'link-215');">return_tensor</a></tt><tt class="py-op">(</tt><tt class="py-name">index</tt><tt class="py-op">=</tt><tt class="py-name">tensor_index</tt><tt class="py-op">,</tt> <tt class="py-name">skip_fixed</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L908"></a><tt class="py-lineno">908</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt id="link-463" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-463', 'tensor', 'link-213');">tensor</a></tt><tt class="py-op">,</tt> <tt id="link-464" class="py-name"><a title="data_store.align_tensor.AlignTensorList.names" class="py-name" href="#" onclick="return doclink('link-464', 'names', 'link-383');">names</a></tt><tt class="py-op">[</tt><tt class="py-name">param_index</tt><tt class="py-op">]</tt><tt class="py-op">+</tt><tt class="py-string">'_sim'</tt><tt class="py-op">)</tt> </tt>
</div></div><a name="L909"></a><tt class="py-lineno">909</tt>  <tt class="py-line"> </tt><script type="text/javascript">
<!--
expandto(location.href);
// -->
</script>
</pre>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="/">relax</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Wed Sep 30 14:41:47 2015
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
