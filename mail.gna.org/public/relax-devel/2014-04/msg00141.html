<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [sr #3154] Implementation of Baldwin (2014) B14 model &#45; 2&#45;site exact solution model for all time scales -->
<!--X-From-R13: "Sqjneq q'Ohiretar" &#60;rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Wed, 30 Apr 2014 16:12:45 +0200 -->
<!--X-Message-Id: CAED9pY8oW7J&#45;7YcBgSRpDPexRghuRNnK851VJ7E+GePdnS2m3Q@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20140429&#45;222552.sv20529.12099@gna.org -->
<!--X-Reference: 20140429&#45;222920.sv20529.65319@gna.org -->
<!--X-Reference: 20140429&#45;223825.sv20529.27067@gna.org -->
<!--X-Reference: CA+CBx2N5ti2&#45;+cs4TPViYxqnEpjH3432hydxCicgOcdLb01cEw@mail.gmail.com -->
<!--X-Reference: CAED9pY9josZukT1kOeax=U02GsHL5FMpuaQ9JqTTT+Gx5Ah&#45;eQ@mail.gmail.com -->
<!--X-Reference: 5360CCC8.3050309@chem.ox.ac.uk -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales -- April 30, 2014 - 16:12</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00141" class="tabs">Index by Date</a> | <a href="threads.html#00141" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00140.html">Date Prev</a>] [<a href="msg00142.html">Date Next</a>] [<a href="msg00134.html">Thread Prev</a>] [<a href="msg00139.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Andrew Baldwin &lt;andrew.baldwin@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Wed, 30 Apr 2014 16:11:49 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113; h=mime-version:sender:in-reply-to:references:date:message-id:subject :from:to:cc:content-type; bh=ycAaCEwdtfSi7zaNf9P+GD8eqDIvaq0FeIOY/JRa8Cw=; b=Wm4xzKrXC1NqEEy/5Zr6LaOtb1BJpEjcBbIFRg7MO+GagVcMTIu1mY5p5xYIB1eLIg 01faxT68c30EfJuQQhAM9on7leFYmzOwqwJzlgrY4hjVzK9POkH6TfUml8F4NLbjNA9d cLBYM9kJTesswwJ77K5yEpJe1Cz/ccyVl97ynF9r48qQof/Kffyaln699k7fxaNbsNAG PayjQvdE5v7ju56rE8wH5EN9tSqg+WRcUWtg+1jOzb/uojSGPwfqSbdbPhos9bDDMxef v1zHZSIRs8EiFl1+fOXHjeyiEQ10DthKaZVhWwIkrQyjPmOU8Zz065cwkjarykQWr7p/ zKOg==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00141.html">CAED9pY8oW7J-7YcBgSRpDPexRghuRNnK851VJ7E+GePdnS2m3Q@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;<a href="msg00116.html">20140429-222552.sv20529.12099@gna.org</a>&gt; &lt;<a href="msg00117.html">20140429-222920.sv20529.65319@gna.org</a>&gt; &lt;<a href="msg00118.html">20140429-223825.sv20529.27067@gna.org</a>&gt; &lt;<a href="msg00119.html">CA+CBx2N5ti2-+cs4TPViYxqnEpjH3432hydxCicgOcdLb01cEw@mail.gmail.com</a>&gt; &lt;CAED9pY9josZukT1kOeax=U02GsHL5FMpuaQ9JqTTT+Gx5Ah-eQ@mail.gmail.com&gt; &lt;5360CCC8.3050309@chem.ox.ac.uk&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on April 30, 2014 - 16:12:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi Andy,

</pre><blockquote class="blockquote"><pre style="margin: 0em;">The origin of the code was my fat head.
</pre></blockquote><pre style="margin: 0em;">

That's good enough :)


</pre><blockquote class="blockquote"><pre style="margin: 0em;">One thing relevent: the cofactors i've called F0 and F2 turned out the same
as used by Carver and Richards. In my hands at least, there is a faster way
of computing them using trig functions rather than
square-roots-of-square-roots (see my code for details). Also, i'd make
triple sure that the definitions you've used for e.g tau_c match mine. There
are at least three conventions I know of in the literature. In my code, a
CPMG cycle is tau/180/tau/tau/180/tau. That'll be the same as Flemming and
Dimitri use. There's a typo in Carver Richard's paper that has propagated
nastily throughout the literature. I can send my implementation of CR that I
used for direct comparison with my result and the numerical result if that
helps keep your headaches down.
</pre></blockquote><pre style="margin: 0em;">

The Carver and Richards code in relax is fast enough, though Troels
might have an interest in squeezing out a little more speed.  Though
it would require different value checking to avoid NaNs, divide by
zeros, trig function overflows (which don't occur for math.sqrt), etc.
 Any changes would have to be heavily documented in the manual, wiki,
etc.

For the tau_c, tau_cp, tau_cpmg, etc. definitions, comparing the relax
code to your script will ensure that the correct definition is used.
That's how I've made sure that all other dispersion models are
correctly handled - simple comparison to other software.  I'm only
aware of two definitions though:

tau_cpmg = 1 / (4 nu_cpmg)
tau_cpmg = 1 / (2 nu_cpmg)

What is the third?  Internally in relax, the 1 / (4 nu_cpmg)
definition is used.  But the user inputs nu_cpmg.  This avoids the
user making this mistake as nu_cpmg only has one definition.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">You guys are free to use my code (I don't mind the gnu license) or of course
implement from scratch as needed.
</pre></blockquote><pre style="margin: 0em;">

Cheers!  For a valid copyright licensing agreement, you'll need text
something along the lines of:

&quot;I agree to licence my contributions to the code in the file
<a  rel="nofollow" href="http://gna.org/support/download.php?file_id=20615">http://gna.org/support/download.php?file_id=20615</a> attached to
<a  rel="nofollow" href="http://gna.org/support/?3154">http://gna.org/support/?3154</a> under the GNU General Public Licence,
version three or higher.&quot;

Feel free to copy and paste.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">I'd like to note again though that anyone using this formula to fit data,
though exact in the case of 2site exchange/inphase magnetisation, evaluated
at double floating point precision should not be doing so! Neglecting scalar
coupling/off resonance/spin flips/the details of the specific pulse sequence
used will lead to avoidable foobars. I do see value in this, as described in
the paper, as being a feeder for initial conditions for a more fancy
implemenation. But beyond that, 'tis a bad idea. Ideally this should appear
in big red letters in your (very nice!) gui when used.
</pre></blockquote><pre style="margin: 0em;">

In relax, we allow the user to do anything though, via the
auto-analysis (hence the GUI), we direct the user along the best path.
 The default is to use the CR72 and 'NS CPMG 2-site expanded' models
(Carver &amp; Richards, and Martin Tollinger and Nikolai Skrynnikov's
Maple expansion numeric model).  We use the CR72 model result as the
starting point for optimisation of the numeric models, allowing a huge
speed up in the analysis.  The user can also choose to not use the
CR72 model results for the final model selection - for determining
dispersion curve significance.

As for the scalar coupling and spin flips, I am unaware of any
dispersion software that handles this.  And only Flemming's CATIA
handles the CPMG off-resonance effects.  This is all explained in the
relax manual.  I have asked the authors of most dispersion software
about this too, just to be sure.  I don't know how much of an effect
these have though.  But one day they may be implemented in relax as
well, and then the user can perform the comparison themselves and see
if all these claims hold.

Anyway, the warnings about analytic versers numeric are described in
the manual.  But your new model which adds a new factor to the CR72
model, just as Dimitry Korzhnev's cpmg_fit software does for his
multiple quantum extension of the equation (from his 2004 and 2005
papers), sounds like it removes the major differences between the
analytic and numeric results anyway.  In any case, I have never seen
an analytic result which is more than 10% different in parameter
values (kex specifically) compared to the numeric results.  I am
constantly on the lookout for a real or synthetic data set to add to
relax to prove this wrong though.

Cheers,

Edward


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00116" href="msg00116.html">[sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00117" href="msg00117.html">[sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00118" href="msg00118.html">[sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00119" href="msg00119.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Troels Emtek√¶r Linnet</li></ul></li>
<li><strong><a name="00134" href="msg00134.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Wed Apr 30 16:40:16 2014</div>  
</body>
</html>
