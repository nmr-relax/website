<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: Model selection and local_tm -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneq.qnhiretarNtznvy.pbz> -->
<!--X-Date: Thu, 03 Apr 2008 12:12:43 +0200 -->
<!--X-Message-Id: 7f080ed10804030306n137c116fgfca6f160ad8dae05@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: mailman.13.1206529249.22850.relax&#45;users@gna.org -->
<!--X-Reference: 1206709145.6713.27.camel@matsl.fkem2.lth.se -->
<!--X-Reference: 7f080ed10803310228t19a4bb38uc885cc27fdf0107c@mail.gmail.com -->
<!--X-Reference: 1207146206.6713.182.camel@matsl.fkem2.lth.se -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Model selection and local_tm -- April 03, 2008 - 12:12</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Model selection and local_tm</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00006" class="tabs">Index by Date</a> | <a href="threads.html#00006" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00005.html">Date Prev</a>] [<a href="msg00007.html">Date Next</a>] [<a href="msg00003.html">Thread Prev</a>] [<a href="msg00001.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Carl Diehl&quot; &lt;Carl.Diehl@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Thu, 3 Apr 2008 12:06:00 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-users@xxxxxxx&quot; &lt;relax-users@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00006.html">7f080ed10804030306n137c116fgfca6f160ad8dae05@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;mailman.13.1206529249.22850.relax-users@xxxxxxx&gt;	&lt;1206709145.6713.27.camel@xxxxxxxxxxxxxxxxxx&gt;	&lt;7f080ed10803310228t19a4bb38uc885cc27fdf0107c@xxxxxxxxxxxxxx&gt;	&lt;1207146206.6713.182.camel@xxxxxxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on April 03, 2008 - 12:12:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">On Wed, Apr 2, 2008 at 4:23 PM, Carl Diehl &lt;Carl.Diehl@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;"> On Mon, 2008-03-31 at 11:28, Edward d'Auvergne wrote:
 &gt; On Fri, Mar 28, 2008 at 2:59 PM, Carl Diehl &lt;Carl.Diehl@xxxxxxxxx&gt; wrote:
 &gt; &gt; Hi.
 &gt; &gt;  I used the full_analysis.py script for testing and evaluating relax in
 &gt; &gt;  comparison with published data.
 &gt; &gt;
 &gt; &gt;  The system was calcium-loaded Calbindin D9k, with R1 &amp; NOE at 600 MHz
 &gt; &gt;  and R2, R1 &amp; NOE at 500 MHz. The relaxation data is of very high
 &gt; &gt;  quality. The model selection was done using home-written software, so 
no
 &gt; &gt;  ordinary model selection à Modelfree.
 &gt;
 &gt; What do you mean by model selection?  Did you use a different
 &gt; technique from the statistical field of mathematical modelling and
 &gt; model selection?  Did you use a frequentist method, a Bayesian method,
 &gt; or hypothesis testing methods (the last of which is described in
 &gt; textbooks from this field of knowledge as being very, very bad)?  Did
 &gt; you use this to select between model-free models, diffusion models, or
 &gt; the combined global model (model-free + diffusion)?
 &gt;
 &gt;
 To clarify, in the example above I've only used published relaxation
 values for D9k (Johan Kördel et al, Biochemistry 1992, 31, 4856-4866).
 This is a pretty old article and I'm mainly using the data for comparing
 and validating relax vs Modelfree. In other words none of the original
 model selection was done by me.
 The diffusion model was isotropic.
 The model selection was done by first optimising the global sum of
 squares vs model m2.
 Residues with a R2/R1 ratio below the average value were optimised with
 model m5.
</pre></blockquote><pre style="margin: 0em;">

Ah, that could be why the local_tm model is being selected.  Because
you have followed the construction of the isotropic model as per the
paper, this model is quite possibly much worse than the local_tm
model.  Well, that's precisely what the model selection is saying.


</pre><blockquote class="blockquote"><pre style="margin: 0em;"> &gt; &gt;  After running full_analysis.py (removing excess models),
 &gt;
 &gt; By 'removing excess models', do you mean eliminating failed models?
 &gt; What is an excess of models?
 Models with more parameters than the number of experimental values.
 MF_MODELS = ['m0', 'm1', 'm2', 'm3', 'm4', 'm5', 'm6', 'm7', 'm8', 'm9']
 LOCAL_TM_MODELS = ['tm0', 'tm1', 'tm2', 'tm3', 'tm4', 'tm5', 'tm6',
 'tm7', 'tm9']
</pre></blockquote><pre style="margin: 0em;">

This makes sense, over-fitting must be avoided.


</pre><blockquote class="blockquote"><pre style="margin: 0em;"> &gt; &gt; model selection
 &gt; &gt; gives me local_tm as the best model for the diffusion tensor.
 &gt;Previous
 &gt; &gt; calculations (both 15N and 13C relaxation data) indicates that the
 &gt; &gt; diffusion tensor is to a good approximation, isotropic (only a very
 &gt; &gt;  slight anistropy).

 &gt; What does 'good', 'slight', etc. really mean?  For a mathematical
 &gt; modelling perspective, I don't understand these.  Is a Da of
 &gt; 1.001+/-0.001 slight, or 1.2+/-0.01, or 1.6+/-0.3?  From my
 &gt; experience, my opinion is that unless all the bond vectors point in
 &gt; the same direction, isotropy will never be statistically significant
 &gt; over the spheroids and ellipsoids.
 Dpar/Dper = 1.08 +/- 0.001. The axially symmetric diffusion model is
 statistically significant compared to the isotropic model as you say 
(after digging up the paper).
 An anistropy of 1.08 gives only a small effect on the relaxation rates
 (R1 +/- 0.05, ~R2 +/- ~0.25, NOE +/- ~0.01), an isotropic diffusion
 tensor is therefore a good approximation for most calculations.
</pre></blockquote><pre style="margin: 0em;">

Although the effect on the rates is small, the effects on the
model-free model parameters can be very significant.  That's because
relaxation is dominated by the global rotational tumbling of the
molecule whereas the internal motions only exhibit a small effect.
That is why the diffusion tensor has to be precisely determined,
otherwise artificial motions appear (Schurr 94, Tjandra 96).  This, of
course, depends on the bond vector orientation relative to the
diffusion frame.


</pre><blockquote class="blockquote"><pre style="margin: 0em;"> &gt; &gt;  Looking at the local_tm values for the secondary structure, most of 
them
 &gt; &gt;  have a local_tm which is similar to the isotropic tensor.
 &gt;
 &gt; If you used AIC or BIC model selection between the two models, what
 &gt; are the chi-squared values, criteria values, and parameter numbers for
 &gt; each model?  In the test, did you compare the local_tm model to the
 &gt; isotropic model?  Or did you compare the local_tm model to the
 &gt; isotropic, 2 spheroids, and ellipsoid simultaneously?  Again, what is
 &gt; the qualifier most?  And how do the non-conforming residues not
 &gt; conform?
 &gt;
 I used the full_analysis.py script and ran all diffusion models until
 convergence according to protocol within the script.
 I will have to get back to you with the exact values of the model
 selection.
</pre></blockquote><pre style="margin: 0em;">

Did you run all diffusion models?  Was full_analysis.py modified in any way?


</pre><blockquote class="blockquote"><pre style="margin: 0em;"> &gt; &gt;  Is the local_tm model always correct? For a well folded protein, one
 &gt; &gt;  would expect that the local_tm model should be invalid?
 &gt;
 &gt; As this is mathematical modelling, there is no such thing as an
 &gt; invalid model.  By definition of the term model, a model is an
 &gt; approximation of something far more complex.  Therefore there is only
 &gt; a grey scale of how good a model approximates reality (of course we
 &gt; can never know what is reality).  For a folded, single domain,
 &gt; globular protein (with no significant, floppy loops), then the sphere,
 &gt; spheroids, or ellipsoid should be a good description and the local_tm
 &gt; model will not be selected.  Could you reproduce the model selection
 &gt; statistics for all 4?  If the local_tm model is chosen, then it is an
 &gt; indication that something is not normal - quite possibly interesting
 &gt; dynamics.  Unfortunately, there's not enough information in your post
 &gt; for me to tell you exactly what happened.  One point that concerns me
 &gt; is that you only have an R2 measurement at a single field strength.
 &gt; Note that to differentiate between chemical exchange effects (which
 &gt; are scaled quadratically with field strength) and internal nanosecond
 &gt; motions (constant at different fields) and anisotropic tumbling of the
 &gt; molecule (again constant), you really need the R2 collected at 2
 &gt; fields.  But this may not necessarily be the reason you're seeing the
 &gt; local_tm model being selected.  I'm sorry that I am not yet able to
 &gt; give you a clear answer.
 &gt;
 Chemical exchange is not an issue for D9k. D9k has floppy ends and a
 loop in the middle, the rest of the sequence is rigid (S2 ~ 0.8-0.9).
 Instead of measuring R2 at two fields, one option is to measure 1H-15N
 dipolar/CSA transverse and longitudinal crossrelaxation and extract R2
 without chemical exchange. The Kay group also published an article
 recently which allows measurements of R2 without chemical exchange.

 BTW, is it possible to incorporate the above types of relaxation rates
 as another experimental value to fit against.
</pre></blockquote><pre style="margin: 0em;">

Measuring R2 without chemical exchange is a very useful thing, as it
simplifies the model-free problem considerably (the number of
universes encompasing the entire problem is nevertheless still huge).
 The two cross-correlated relaxation rates (interference) would also
be very useful but, as of yet, this has not been incorporated into
relax.  This has been discussed before a number of times.  For example
see the tread starting at
<a  rel="nofollow" href="https://mail.gna.org/public/relax-devel/2006-10/msg00063.html">https://mail.gna.org/public/relax-devel/2006-10/msg00063.html</a>.  I do
plan to eventually add these rates to the 1.3 relax development line
(but not the 1.2 stable line).

Cheers,

Edward


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00000" href="msg00000.html">Re: Model selection and local_tm</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00003" href="msg00003.html">Re: Model selection and local_tm</a></strong>
<ul><li><em>From:</em> Carl Diehl</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu Apr 03 15:41:07 2008</div>  
</body>
</html>
