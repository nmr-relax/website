<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: Model&#45;free analysis error -->
<!--X-From-R13: Febryf Szgrxæe Zvaarg <gyvaargNaze&#45;erynk.pbz> -->
<!--X-Date: Mon, 03 Mar 2014 10:32:22 +0100 -->
<!--X-Message-Id: CA+CBx2MOF=fv2TUyBZgYP0TkAUvZhCjpOaEaFVmAZJ9zYLH6Jw@mail.gmail.com -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: loom.20140207T152903&#45;876@post.gmane.org -->
<!--X-Reference: CAED9pY&#45;&#45;SKVNqRYj1PXBJX0BV5eO7aBQxaOPQS7xV8e&#45;ecfXfA@mail.gmail.com -->
<!--X-Reference: 57E7794ED2439341B1ED0B47DBB1D89D32C52C20@MBX10.ad.oak.ox.ac.uk -->
<!--X-Reference: CAED9pY8TfdoOqQ9i=PsqS3Y2dtsjBniH28c69m2XMTzjPUGR2g@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Model-free analysis error -- March 03, 2014 - 10:32</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Model-free analysis error</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00000" class="tabs">Index by Date</a> | <a href="threads.html#00000" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[Date Prev] [<a href="msg00001.html">Date Next</a>] [Thread Prev] [<a href="msg00001.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Edward d'Auvergne&quot; &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Mon, 3 Mar 2014 10:31:31 +0100</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-users@xxxxxxx&quot; &lt;relax-users@xxxxxxx&gt;,	Kaare Teilum &lt;kaare.teilum@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113;	h=mime-version:sender:in-reply-to:references:from:date:message-id	:subject:to:cc:content-type;	bh=SMX79iZ9aaiZToWmlGevV7YUoOHnDfryZtcuPhVtL2k=;	b=Up8HDtBQiaQVxAuD9d/HDcx0Wl4aNgVZPY4l597uyYEvrxOiXs9oDGzludlX1LnRmq	bVS2mvGXBLYBGgJIMsQXbNkTyYW81sAgAPFtNKz0d+ghUkJlSZrw3uXfVnMcWLCkL5MT	xoW0l4VZysITvQ8vK3QuqPcHmbXHfySgk8/ZcaYU+iULIW6yXeh+Lzot1XeTAYusprM/	G1ZVDpZ87+Wn7EjIXzsSbMslwFEcXMMDBC9wT0nFjFpn6GpDwzA870ZISg62JmFBu1PA	djayqxQoF/IAHZbGNRbnBwhhiu3MuGOfQImhIE3vptHbe6ucNvv/5GmTEvWt26mzpX7o	3rEw==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00000.html">CA+CBx2MOF=fv2TUyBZgYP0TkAUvZhCjpOaEaFVmAZJ9zYLH6Jw@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;loom.20140207T152903-876@xxxxxxxxxxxxxx&gt;	&lt;CAED9pY--SKVNqRYj1PXBJX0BV5eO7aBQxaOPQS7xV8e-ecfXfA@xxxxxxxxxxxxxx&gt;	&lt;57E7794ED2439341B1ED0B47DBB1D89D32C52C20@xxxxxxxxxxxxxxxxxxxxx&gt;	&lt;CAED9pY8TfdoOqQ9i=PsqS3Y2dtsjBniH28c69m2XMTzjPUGR2g@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Troels Emtekær Linnet</strong> on March 03, 2014 - 10:32:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<div dir="ltr"><div><div><div>Dear Edward.<br><br>Thank you for your lengthy explanation on this subject.<br><br>I have put it at the wiki, as a lookup reference:<br><a rel="nofollow" href="http://wiki.nmr-relax.com/Model-free_analysis_single_field">http://wiki.nmr-relax.com/Model-free_analysis_single_field</a><br>

<br>I have though been met with a re-quest to try to analyse some old data, only recorded at one field.<br></div></div><div><br></div><div>If I should try to copy and modify auto_anlayses/dauvergne_protocol.py script,<br>

</div><div>would you accept that copy to reside inside the trunk or would the best way to keep such a copy<br></div><div>local and not-part of the relax source repository ?<br></div><br></div>Best<br>Troels<br></div><div class="gmail_extra">

<br><br><div class="gmail_quote">2014-02-10 17:09 GMT+01:00 Edward d&#39;Auvergne <span dir="ltr">&lt;<a rel="nofollow" href="mailto:edward@xxxxxxxxxxxxx" target="_blank">edward@xxxxxxxxxxxxx</a>&gt;</span>:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">

Hi Ivan,<br>
<br>
To continue:<br>
<div class=""><br>
&gt; On another note, I wonder if it is possible to modify the nmr-relax programme so that I can do model-free analysis with data from only one field strength? Alternatively, do you know of any programme (that can be installed on Windows) that can do such analysis? My work focused mainly on small molecule and ligand-based NMR and I have only just very recently started looking in to protein dynamics so I am still experimentinng different software and data treatment etc.<br>


<br>
</div>Firstly, the subject of single field strength data has been discussed<br>
numerous times on this mailing list.  I would recommend you read my<br>
previous responses to questions relating to single field strength<br>
data, and look the other messages in those threads.  You will find<br>
these discussions quite informative and highly detailed:<br>
<br>
- Martin Ballaschk:<br>
<a rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.user/1409/focus=1438" target="_blank">http://thread.gmane.org/gmane.science.nmr.relax.user/1409/focus=1438</a><br>
- Shantanu Bhattacharyya:<br>
<a rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.user/1367/focus=1369" target="_blank">http://thread.gmane.org/gmane.science.nmr.relax.user/1367/focus=1369</a><br>
- Mengjun Xue:<br>
<a rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.user/1276/focus=1277" target="_blank">http://thread.gmane.org/gmane.science.nmr.relax.user/1276/focus=1277</a><br>
- Fernando Amador: <a rel="nofollow" href="http://article.gmane.org/gmane.science.nmr.relax.user/84" target="_blank">http://article.gmane.org/gmane.science.nmr.relax.user/84</a><br>
- Shantanu Bhattacharyya:<br>
<a rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.user/1086/focus=1087" target="_blank">http://thread.gmane.org/gmane.science.nmr.relax.user/1086/focus=1087</a><br>
- Dhanasekaran Muthu:<br>
<a rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.user/1152/focus=1153" target="_blank">http://thread.gmane.org/gmane.science.nmr.relax.user/1152/focus=1153</a><br>
- Vitaly Vostrikov:<br>
<a rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.user/1147/focus=1150" target="_blank">http://thread.gmane.org/gmane.science.nmr.relax.user/1147/focus=1150</a><br>
- Aldino Viegas:<br>
<a rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.user/1127/focus=1128" target="_blank">http://thread.gmane.org/gmane.science.nmr.relax.user/1127/focus=1128</a><br>
- Pierre-Yves Savard:<br>
<a rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.user/724/focus=725" target="_blank">http://thread.gmane.org/gmane.science.nmr.relax.user/724/focus=725</a><br>
- Keith Constantine:<br>
<a rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.user/513/focus=517" target="_blank">http://thread.gmane.org/gmane.science.nmr.relax.user/513/focus=517</a><br>
- Clare-Louise Evans:<br>
<a rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.user/326/focus=332" target="_blank">http://thread.gmane.org/gmane.science.nmr.relax.user/326/focus=332</a><br>
- Hongyan Li:  <a rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.devel/694/focus=701" target="_blank">http://thread.gmane.org/gmane.science.nmr.relax.devel/694/focus=701</a><br>
<br>
These will have lots of additional information.  This is just a<br>
selection of possibly the most useful messages.<br>
<br>
<br>
You will soon see that this is a complicated topic.  Note that relax<br>
is capable of performing 100% of the functionality of Modelfree4 (with<br>
or without the Fast-Modelfree GUI interface), Dasha, Tensor2, and<br>
DYNAMICS.  If you play with the optimisation settings you can even<br>
find identical results to within machine precision - relax can mimic<br>
these other softwares.<br>
<br>
The key is that the full analysis protocol is rather complicated -<br>
many people don&#39;t understand this - and that these softwares do not<br>
implement the full iterative protocol.  Therefore you either have to<br>
perform it manually or write a script to perform all of the steps.<br>
The protocol is described in the relax manual in figure 7.2<br>
(<a rel="nofollow" href="http://www.nmr-relax.com/manual/diffusion_seeded_paradigm.html" target="_blank">http://www.nmr-relax.com/manual/diffusion_seeded_paradigm.html</a>).  In<br>
summary:<br>
<br>
a)  Find an initial diffusion tensor estimate (you can do this in<br>
relax by only using model m0).  This requires all non-mobile residues<br>
and side chain spins to be excluded, and this can be problematic.  See<br>
the d&#39;Auvergne and Gooley, 2008b paper at<br>
<a rel="nofollow" href="http://dx.doi.org/10.1007/s10858-007-9213-3" target="_blank">http://dx.doi.org/10.1007/s10858-007-9213-3</a> for an example of the<br>
catastrophic failure that this initial estimate can result in.  Or the<br>
bacteriorhodopsin fragment of Korzhnev et al., 1999<br>
(<a rel="nofollow" href="http://dx.doi.org/10.1023/a:1008356809071" target="_blank">http://dx.doi.org/10.1023/a:1008356809071</a>) where this complete<br>
failure was earlier demonstrated.<br>
<br>
b)  Optimise all of the model-free models from m0 to m9.  This<br>
requires high precision optimisation, for a comparison of all the<br>
softwares see the d&#39;Auvergne and Gooley, 2008a model-free optimisation<br>
paper at <a rel="nofollow" href="http://dx.doi.org/10.1007/s10858-007-9214-2" target="_blank">http://dx.doi.org/10.1007/s10858-007-9214-2</a>.  Only relax and<br>
Dasha implement the full range of model-free models, though the models<br>
m6, m7, and m8 cannot be used if only single field strength data is<br>
used (m6 is the original 2-time scale motion model of Clore et al.,<br>
1990).<br>
<br>
c)  Eliminate failed models (this is only available in relax, see the<br>
d&#39;Auvergne and Gooley, 2006 model elimination paper at<br>
<a rel="nofollow" href="http://dx.doi.org/10.1007/s10858-006-9007-z" target="_blank">http://dx.doi.org/10.1007/s10858-006-9007-z</a>).<br>
<br>
d)  Select the best model-free model for each spin system.  This again<br>
requires precision modern techniques, with the best being AIC model<br>
select (see the d&#39;Auvergne and Gooley, 2003 model-free model selection<br>
paper at <a rel="nofollow" href="http://dx.doi.org/10.1023/A:1021902006114" target="_blank">http://dx.doi.org/10.1023/A:1021902006114</a>).  If you are<br>
unaware that ANOVA statistics for model selection (hypothesis testing<br>
via chi-squared, F- and t-tests) was abandoned by the field of model<br>
selection over 100 years ago (a field which makes the NMR field look<br>
very, very small), then you should really look at that paper.<br>
<br>
e)  Optimise the global model.  This is the diffusion tensor plus the<br>
model-free models for all spin systems.<br>
<br>
f)  Check for convergence (identical chi-squared values to a previous<br>
iteration, and not necessarily the last one).  If no, then go back to<br>
b) and repeat.  Note that the chi-squared value can go up<br>
significantly between iterations, but this is because the model is<br>
simplifying itself at a much faster rate by loosing parameters - it&#39;s<br>
Occam&#39;s razor at work.  Again see the d&#39;Auvergne and Gooley, 2008b<br>
paper at <a rel="nofollow" href="http://dx.doi.org/10.1007/s10858-007-9213-3" target="_blank">http://dx.doi.org/10.1007/s10858-007-9213-3</a> for figures<br>
demonstrating this.  The concept as to what is happening during this<br>
combined model-free optimisation and model selection algorithm is<br>
described in the d&#39;Auvergne and Gooley, 2007 MolBiosyst paper at<br>
<a rel="nofollow" href="http://dx.doi.org/10.1039/b702202f" target="_blank">http://dx.doi.org/10.1039/b702202f</a>.  It can take up to 20 iterations<br>
or more to reach convergence, depending upon the quality of the<br>
relaxation data and the 3D structure or the system in study.<br>
<br>
g)  Once steps a-f have been completed for all global models<br>
(characterised by the spheroid, prolate spheroid, oblate spheroid, and<br>
ellipsoid diffusion tensors), then model selection between the<br>
different global models needs to be performed.<br>
<br>
h)  Monte Carlo simulations for error analysis must be performed at the end.<br>
<br>
i)  Elimination of failed Monte Carlo simulations is essential for<br>
keeping the errors to reasonable values for certain spin systems.<br>
This is also a relax-only feature (see the d&#39;Auvergne and Gooley, 2007<br>
model elimination paper at<br>
<a rel="nofollow" href="http://dx.doi.org/10.1007/s10858-006-9007-z" target="_blank">http://dx.doi.org/10.1007/s10858-006-9007-z</a>).<br>
<br>
These steps must be implemented independently of which software you<br>
use, as NONE implement the full protocol.  Note however that the<br>
protocol I developed (in the d&#39;Auvergne and Gooley, 2007 theory paper<br>
at <a rel="nofollow" href="http://dx.doi.org/10.1039/b702202f" target="_blank">http://dx.doi.org/10.1039/b702202f</a> and the d&#39;Auvergne and Gooley,<br>
2008b paper at <a rel="nofollow" href="http://dx.doi.org/10.1007/s10858-007-9213-3" target="_blank">http://dx.doi.org/10.1007/s10858-007-9213-3</a>) is fully<br>
implemented in relax, however this required multiple field strength<br>
data.  This is a rather large script located at<br>
auto_anlayses/dauvergne_protocol.py.  This protocol is used by the<br>
GUI.  So one option would be to copy this<br>
auto_anlayses/dauvergne_protocol.py script and modify it for the<br>
figure 7.2 protocol.<br>
<br>
<br>
*** Note *** I must warn you about using single field strength data.<br>
It is now quite difficult to publish a model-free analysis with only<br>
single field strength data as most of the field know about the<br>
catastrophic analysis failures resulting in large amounts of<br>
artificial motion.  These failures can also be much more subtle.  Many<br>
reviewers will ask for such data to be collected as the results cannot<br>
not be trusted otherwise.  For a model-free analysis, it is almost<br>
essential to collect data at multiple field strengths, otherwise it<br>
can be sometimes impossible to distinguish between the anisotropic<br>
part of the Brownian tumbling of the molecule and internal motion -<br>
specifically due to the NH vectors in secondary structure elements all<br>
pointing in a similar direction.  I have a much better explanation, as<br>
well as citations to all the relevant literature in:<br>
<br>
d&#39;Auvergne E. J., Gooley P. R. (2007). Set theory formulation of the<br>
model-free problem and the diffusion seeded model-free paradigm. Mol.<br>
Biosyst., 3(7), 483-494. (<a rel="nofollow" href="http://dx.doi.org/10.1039/b702202f" target="_blank">http://dx.doi.org/10.1039/b702202f</a>)<br>
<br>
In this paper, you will see reviewed both the artificial nanosecond<br>
motions of the Schurr 1994 paper and the artifical Rex motions of the<br>
Tjandra 1995 paper.<br>
<br>
Finally, you will probably find it much easier to spend the 7-8 days<br>
collecting data at another field strength than to implement the<br>
protocol of steps a-i in a relax, Modelfree4, or Dasha script (or via<br>
multiple iterations of the GUI programs), as well as study all of the<br>
relevant literature to understand all of the types of failures than<br>
only occurs with single field strength data.  With multiple field<br>
strength data you can perform Sebastien Morin&#39;s consistency testing<br>
analysis in relax (<a rel="nofollow" href="http://dx.doi.org/10.1007/s10858-009-9381-4" target="_blank">http://dx.doi.org/10.1007/s10858-009-9381-4</a> and<br>
<a rel="nofollow" href="http://www.nmr-relax.com/manual/Consistency_testing.html" target="_blank">http://www.nmr-relax.com/manual/Consistency_testing.html</a>).  That way<br>
you can see if your per-experiment temperature calibration and<br>
per-experiment temperature control techniques have works sufficiently<br>
well (<a rel="nofollow" href="http://www.nmr-relax.com/manual/Temperature_control_calibration.html" target="_blank">http://www.nmr-relax.com/manual/Temperature_control_calibration.html</a>)<br>
and if you have used long enough recycle delays.  Collecting data at a<br>
second field would probably save you significant amounts of time, and<br>
has the additional benefit that it would guarantee that the dynamics<br>
you see at the end will be real.  I cannot emphasize enough how<br>
important it is to collect data at multiple fields, most importantly<br>
the NOE and R2 data.<br>
<br>
Regards,<br>
<br>
Edward<br>
<div class="HOEnZb"><div class="h5"><br>
_______________________________________________<br>
relax (<a rel="nofollow" href="http://www.nmr-relax.com" target="_blank">http://www.nmr-relax.com</a>)<br>
<br>
This is the relax-users mailing list<br>
<a rel="nofollow" href="mailto:relax-users@xxxxxxx">relax-users@xxxxxxx</a><br>
<br>
To unsubscribe from this list, get a password<br>
reminder, or change your subscription options,<br>
visit the list information page at<br>
<a rel="nofollow" href="https://mail.gna.org/listinfo/relax-users" target="_blank">https://mail.gna.org/listinfo/relax-users</a><br>
</div></div></blockquote></div><br></div>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00001" href="msg00001.html">Re: Model-free analysis error</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Mon Mar 03 17:00:25 2014</div>  
</body>
</html>
