<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: [bug #9259] Reduced spectral density mapping yielding bad values -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneq.qnhiretarNtznvy.pbz> -->
<!--X-Date: Tue, 19 Jun 2007 19:15:29 +0200 -->
<!--X-Message-Id: 7f080ed10706191014j793eda83td849f9397a52a193@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20070601&#45;171559.sv0.50521@gna.org -->
<!--X-Reference: 7f080ed10706011031j6cb5c066v5c22d9183b048c83@mail.gmail.com -->
<!--X-Reference: 46702272.9000709@ulaval.ca -->
<!--X-Reference: 7f080ed10706150040v7366098dvad9b863201861b50@mail.gmail.com -->
<!--X-Reference: 4672B36C.9090608@ulaval.ca -->
<!--X-Reference: 7f080ed10706190302h740ac77fh3a53c9376ce92cff@mail.gmail.com -->
<!--X-Reference: 4677F1AD.3070803@ulaval.ca -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [bug #9259] Reduced spectral density mapping yielding bad values -- June 19, 2007 - 19:15</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: [bug #9259] Reduced spectral density mapping yielding bad values</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00014" class="tabs">Index by Date</a> | <a href="threads.html#00014" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00013.html">Date Prev</a>] [<a href="msg00015.html">Date Next</a>] [<a href="msg00013.html">Thread Prev</a>] [<a href="msg00015.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Sebastien Morin&quot; &lt;sebastien.morin.1@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Tue, 19 Jun 2007 19:14:50 +0200</li>
<li class="menuitem">
<em>Cc</em>: Stephane Gagne &lt;smg@xxxxxxxxxxxxxx&gt;, relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00014.html">7f080ed10706191014j793eda83td849f9397a52a193@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;20070601-171559.sv0.50521@xxxxxxx&gt;	&lt;7f080ed10706011031j6cb5c066v5c22d9183b048c83@xxxxxxxxxxxxxx&gt;	&lt;46702272.9000709@xxxxxxxxx&gt;	&lt;7f080ed10706150040v7366098dvad9b863201861b50@xxxxxxxxxxxxxx&gt;	&lt;4672B36C.9090608@xxxxxxxxx&gt;	&lt;7f080ed10706190302h740ac77fh3a53c9376ce92cff@xxxxxxxxxxxxxx&gt;	&lt;4677F1AD.3070803@xxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on June 19, 2007 - 19:15:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Hi,

In this IUPAC report, on page 11, the radian unit is described as &quot;The
units radian (rad) and steradian (sr), for plane angle and solid angle
respectively, are described as 'SI supplementary units' [3]. Since
they are of dimension 1 (i.e. dimensionless), they may be included if
appropriate, or they may be omitted if clarity is not lost thereby, in
expressions for derived SI units.&quot;  This is the part meaning that
radians are implied if you are doing anything angular.  I don't know
what they mean by clarity because by omitting them it complicates
things.  Maybe you have to be a physicist before you can see this
clarity.

Séb, would you be able to create a single patch that contains your bug
fixes, the changes to the system tests for the reduced spectral
density mapping, and with the multiplication by 2pi added back (the
first patch removed it), that would be very much appreciated.  I can
then apply a single patch with a single commit message saying that bug
#9259 (<a  rel="nofollow" href="http://gna.org/bugs/?9259">http://gna.org/bugs/?9259</a>) has been fixed (by you of course).

Thanks,

Edward


P. S.  As a side note, could you provide a link rather than attach a
file to a post to a mailing list.  Thanks.  Because this mailing list
is archived in many different internet repositories and because the
message is sent out to all those subscribed to this list, the system
is not designed to handle large attachments.



On 6/19/07, Sebastien Morin &lt;sebastien.morin.1@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">
Hi,

I agree quite well with what you say.

However, I would have thought that, even if radians are often implied
and not discussed, they should be present in the IUPAC reports (see
attached file). See, for example, that the Planck constant divided by 2
pi has units of J s, and that the magnetogyric ratio has also units
devoid of radians (s^-1 T^-1), and even the Larmor angular frequency has
units of s^-1 (without radians). Maybe even the IUPAC treats the radians
as implied and doesn't bother with them...

I just checked with data from the Lefevre paper (1996) and I can
approximately reproduce their data (approximately, since I don't know
the exact values and precisions they used for the different constants)
when I multiply the frequencies by 2 pi... However, the discrepancy
between spectral densities calculated with frequencies multiplied or not
by 2 pi is small... so this verification is not really that precise...
Here are the values :

Res   R1    R2     NOE     J(0)  J(wN)  J(wH)   My values...  J(0)
J(wN)  J(wH)

4     1.8   4.92   0.162   1.23  0.32   0.027        -----    1.50  0.40
  0.024
                                                     x 2 pi   1.24
0.33   0.024   &lt;- Best

14    2.08  11.16  0.757   3.15  0.42   0.009        -----    3.86
0.51   0.008
                                                     x 2 pi   3.18
0.42   0.008   &lt;- Best


It seems that Ed is right and that radians are part of the units and
that the frequencies in Hz should be multiplied by 2 pi (as in the
Lefevre paper).

Cheers


Séb




Edward d'Auvergne wrote:
&gt; Hi,
&gt;
&gt; I have thoroughly checked all the units of the physical constants,
&gt; spectral densities, rotational correlation times, and relaxation rates
&gt; and have a few important corrections about the units which are used in
&gt; relax and elsewhere.  Please read below for the details and a long
&gt; story about SI vs. CGS units, frequency vs. angular frequency, and how
&gt; it all relates to angular momentum.
&gt;
&gt;
&gt; On 6/15/07, Sebastien Morin &lt;sebastien.morin.1@xxxxxxxxx&gt; wrote:
&gt;&gt; Hi,
&gt;&gt;
&gt;&gt; Here are the different values I obtain for a residue with R1 = 1.1336 +-
&gt;&gt; 0.0851 ; R2 = 12.9336 +- 0.9649 ; and NOE = 0.463921 +- 0.045
&gt;&gt;
&gt;&gt;
&gt;&gt;     J(0)                      J(wN)                    J(wH)
&gt;&gt;     =====================     =====================
&gt;&gt; =====================
&gt;&gt;
&gt;&gt; Here are the results with Leo Spyracopoulos's Mathematica notebook.
&gt;&gt;
&gt;&gt;     4.704231413115747e-9      2.664085520910741e-10
&gt;&gt; 9.485555428699657e-12
&gt;&gt;
&gt;&gt;
&gt;&gt; Here are the results with relax without multiplying frequencies in Hz by
&gt;&gt; 2 pi.
&gt;&gt;
&gt;&gt;     4.6978912534878238e-09    2.6603551824374712e-10
&gt;&gt; 9.478993207668287e-12
&gt;&gt;
&gt;&gt;     ratio
&gt;&gt;     0.9986522432526923179     0.9985997677461966745
&gt;&gt; 0.9993081880043085706
&gt;&gt;
&gt;&gt;
&gt;&gt; Here are the results with relax when multiplying frequencies in Hz by
&gt;&gt; 2 pi.
&gt;&gt;
&gt;&gt;     3.4634030539343071e-09    1.9612804482358541e-10
&gt;&gt; 9.478993207668287e-12
&gt;&gt;
&gt;&gt;     ratio
&gt;&gt;     0.7362314371436068543     0.7361927508863804185
&gt;&gt; 0.9993081880043085706
&gt;&gt;
&gt;&gt;
&gt;&gt; The very small discrepancy we get (ratio 0.999...) is due to several
&gt;&gt; small differences in the definitions of constants (e.g. gn = -2.7126 in
&gt;&gt; relax and -2.7108 in Leo's notebook). This is not important. However,
&gt;&gt; there is a non negligible difference with the use of either frequencies
&gt;&gt; in Hz or frequencies transformed to rad/s.
&gt;&gt;
&gt;&gt; Now, what do we do with that ?
&gt;&gt;
&gt;&gt; The spectral densities are in units of rad / s = rad s^-1. (these are
&gt;&gt; not SI units, however)
&gt;
&gt; The units of radians per second, or radian Hertz, is the angular
&gt; frequency (omega) rather than the frequency (nu), yet both are
&gt; nevertheless SI units.  For example see
&gt; <a  rel="nofollow" href="http://en.wikipedia.org/wiki/Angular_frequency">http://en.wikipedia.org/wiki/Angular_frequency</a> or related sites.
&gt; These SI units are the same in the CGS unit system.  The reason that
&gt; we use the angular frequency rather than frequency is because we are
&gt; talking about angular momentum.
&gt;
&gt;
&gt;&gt; The rates (R1, R2 and sigmaNOE) are in units of s^-1.
&gt;&gt;
&gt;&gt; The constant 'd' is in units of s^-2.
&gt;
&gt; This is not correct.  The correct units are rad^2.s^-2.  This can be
&gt; found by doing a unit analysis on the SI dipolar constant with the
&gt; mu0/4pi component (or alternatively doing the analysis in the CGS
&gt; system).  The reason for the radians being part of the equation is
&gt; because we are using Dirac's constant (h_bar) rather than Planck's
&gt; constant (h).  While Planck's constant has the units of Joules per
&gt; Hertz (or Joule seconds) because Dirac's constant is divided by 2pi
&gt; its units are Joules per Hertz per radian.  However in most cases the
&gt; radian units of Dirac's constant are not stated as we are usually
&gt; talking about angular momentum (the angular part means we use radians
&gt; hence it is indirectly implied).  The other reason is because the
&gt; gyromagnetic ratio also has units of radian, and again this is usually
&gt; not reported (for example see Table 1.1 of Cavanagh in which the
&gt; gyromagnetic ratios are in fact in rad.s^-1.T^-1, although they are
&gt; not reported as such).  All of this is still in SI units - the radian
&gt; components are independent of the SI or CGS systems.
&gt;
&gt; The relevant units in the SI system for the dipolar constant, defined as
&gt;
&gt; d = (mu0/4pi)^2 . (gH.gX.h_bar/&lt;r&gt;^3)^2,
&gt;
&gt; are
&gt;
&gt; mu0 -&gt; kg.m.s^-2.A^-2,
&gt; h_bar -&gt; J.s.rad^-1,
&gt; gx -&gt; rad.s^-1.T^-1,
&gt; r -&gt; m,
&gt;
&gt; where tesla (T) is equal to the units kg.A^-1.s^-2.
&gt;
&gt; The SI units for the CSA constant, defined as
&gt;
&gt; c = (omegaX . csa / 3)^2,
&gt;
&gt; are
&gt;
&gt; omegaX -&gt; rad.s^-1,
&gt; csa -&gt; unitless.
&gt;
&gt; Hence both constants have the units of rad^2.s^-2.
&gt;
&gt;
&gt;&gt; The constant 'c' is in units of s^-2 also (or rad^2 s^-2 if we use
&gt;&gt; frequencies in rad s^-1, which are not SI units).
&gt;
&gt; The constant c is defined by the angular frequency (omega) rather than
&gt; the frequency (nu).  Hence the units of this constant in the
&gt; relaxation equations, in both SI and CGS units, is always rad^2.s^-2
&gt; as well.
&gt;
&gt;
&gt;&gt; I now hesitate between 3 views.
&gt;&gt;
&gt;&gt; 1. Should the spectral densities be in SI units (i.e. in s, as the
&gt;&gt; frequencies are in s^-1 and the rates in s^-1) ?
&gt;
&gt; relax currently reports the spectral densities in the SI units for
&gt; angular frequency of radian Hertz.   Although often reported as Hertz,
&gt; the correct unit is radian Hertz.  This is again because radians are
&gt; implied, but this time because we are talking about rotations.  The
&gt; reason is as follows:
&gt;
&gt; The spectral density function for isotropic diffusion is
&gt;
&gt; J(w) = tm / (1 + (w.tm)^2).
&gt;
&gt; The units for w (or omega) is rad.s^-1.  Because the product w.tm is
&gt; unitless the units for tm are in reality s.rad^-1.  Hence the units of
&gt; the spectral density function J(w) is also s.rad^-1.
&gt;
&gt; Although not reported in text books such as Cavanagh, you can still
&gt; see remnants of the radians.  For example in that book tc (or tm) is
&gt; described as being &quot;approximately the average time for the molecule to
&gt; rotate by one radian&quot;.  All the external and internal correlation
&gt; times are in units of s.rad^-1 as they are all rotational correlation
&gt; times!  But because the are rotational times, the radians are implied
&gt; and do not need to be reported.
&gt;
&gt;
&gt;&gt; 2. If the spectral densities are in s rad^-1, the frequencies used to
&gt;&gt; calculate them should also be in rad s^-1, thus the constant 'c' should
&gt;&gt; be in rad^2 s^-2 and the constant 'd' also (so we should calculate it
&gt;&gt; without multiplying by the factor of (mu/4pi)^2). This would be about
&gt;&gt; using old units instead of the SI units, but then the spectral densities
&gt;&gt; would be in s rad^-1.
&gt;
&gt; In SI units the spectral density function is in units of s.rad^-1
&gt; whereas the physical constants (dipolar, csa, etc.) are in rad^2.s^-2.
&gt; Hence the units for the relaxation rates - hold on to your seat - is
&gt; in radian Hertz!  The R1 relaxation rate is in rad.s^-1.  Or the T1
&gt; relaxation time is in s.rad^-1.
&gt;
&gt; The reason that all of this is hardly ever discussed is because the
&gt; units of radians is implied by the fact that this all relates to
&gt; angular momentum.  In the rotational world, radians are ubiquitous.
&gt; Yet they are silent because they are implied.  Unfortunately this
&gt; 'hiding' of radians, combined with the CGS vs. SI unit systems,
&gt; creates large amounts of confusion.
&gt;
&gt;
&gt;&gt; 3. We could calculate everything in SI units (as we do right now) and
&gt;&gt; normalize to rs ad^-1 in the end.
&gt;&gt;
&gt;&gt; Either way, I think that Leo's notebook yields spectral densities s and
&gt;&gt; not the usual s rad^-1 (as in the 2006 paper : JBNMR,36:215-224, for
&gt;&gt; which I calculated back spectral density values and yielded the same as
&gt;&gt; published where they say it's in s rad^-1, but the units deriving says
&gt;&gt; it's s).
&gt;
&gt; relax reports spectral densities in the SI (and CGS) units of s.rad^-1
&gt; as dictated by angular momentum.  Hence the input frequency of Hz must
&gt; be multiplied by 2pi.  Otherwise the product w.tc is not unitless and
&gt; hence its square cannot be added to 1 as J(w) = tm/(1+(w.tm)^2).
&gt;
&gt;
&gt;&gt; Can you please tell me if I'm right with those ideas before I write to
&gt;&gt; Leo to report this apparent bug or typo or whatever...
&gt;
&gt; I hope that what I've written clarifies a few of the problems.
&gt;
&gt; Sincerely,
&gt;
&gt; Edward
&gt;

--
         ______________________________________
     _______________________________________________
    |                                               |
   || Sebastien Morin                               ||
  ||| Etudiant au PhD en biochimie                  |||
 |||| Laboratoire de resonance magnetique nucleaire ||||
||||| Dr Stephane Gagne                             |||||
 |||| CREFSIP (Universite Laval, Quebec, CANADA)    ||||
  ||| 1-418-656-2131 #4530                          |||
   ||                                               ||
    |_______________________________________________|
         ______________________________________



</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00015" href="msg00015.html">Re: [bug #9259] Reduced spectral density mapping yielding bad values</a></strong>
<ul><li><em>From:</em> Sebastien Morin</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00001" href="msg00001.html">[bug #9259] Reduced spectral density mapping yielding bad values</a></strong>
<ul><li><em>From:</em> anonymous</li></ul></li>
<li><strong><a name="00002" href="msg00002.html">Re: [bug #9259] Reduced spectral density mapping yielding bad values</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00003" href="msg00003.html">Re: [bug #9259] Reduced spectral density mapping yielding bad values</a></strong>
<ul><li><em>From:</em> Sebastien Morin</li></ul></li>
<li><strong><a name="00006" href="msg00006.html">Re: [bug #9259] Reduced spectral density mapping yielding bad values</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00007" href="msg00007.html">Re: [bug #9259] Reduced spectral density mapping yielding bad values</a></strong>
<ul><li><em>From:</em> Sebastien Morin</li></ul></li>
<li><strong><a name="00012" href="msg00012.html">Re: [bug #9259] Reduced spectral density mapping yielding bad values</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00013" href="msg00013.html">Re: [bug #9259] Reduced spectral density mapping yielding bad values</a></strong>
<ul><li><em>From:</em> Sebastien Morin</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Tue Jun 19 20:00:36 2007</div>  
</body>
</html>
