<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [sr #3154] Implementation of Baldwin (2014) B14 model &#45; 2&#45;site exact solution model for all time scales -->
<!--X-From-R13: Oaqerj Pnyqjva &#60;naqerj.onyqjvaNpurz.bk.np.hx> -->
<!--X-Date: Tue, 06 May 2014 12:22:01 +0200 -->
<!--X-Message-Id: 5368B79B.3070206@chem.ox.ac.uk -->
<!--X-Content-Type: multipart/mixed -->
<!--X-Reference: 20140429&#45;222552.sv20529.12099@gna.org -->
<!--X-Reference: 20140429&#45;222920.sv20529.65319@gna.org -->
<!--X-Reference: 20140429&#45;223825.sv20529.27067@gna.org -->
<!--X-Reference: CA+CBx2N5ti2&#45;+cs4TPViYxqnEpjH3432hydxCicgOcdLb01cEw@mail.gmail.com -->
<!--X-Reference: CAED9pY9josZukT1kOeax=U02GsHL5FMpuaQ9JqTTT+Gx5Ah&#45;eQ@mail.gmail.com -->
<!--X-Reference: 5360CCC8.3050309@chem.ox.ac.uk -->
<!--X-Reference: CAED9pY8oW7J&#45;7YcBgSRpDPexRghuRNnK851VJ7E+GePdnS2m3Q@mail.gmail.com -->
<!--X-Reference: 536200D2.2010005@chem.ox.ac.uk -->
<!--X-Reference: CA+CBx2Nbfndqpv7Rq+X751z&#45;5fi41DmXo2sGFSar_qOWQPWEuA@mail.gmail.com -->
<!--X-Reference: 5366AA19.3000304@chem.ox.ac.uk -->
<!--X-Reference: CA+CBx2PXnmcr9DcCEO1K=Jr=ymMncFAJv8amxyBWwzRRv0w3kw@mail.gmail.com -->
<!--X-Reference: 53675322.2@chem.ox.ac.uk -->
<!--X-Reference: CA+CBx2NMXNk5hVD8_3UO=wToC+PR5vDanWj5RNDpZB5Q=PfGEQ@mail.gmail.com -->
<!--X-Reference: CAED9pY&#45;=&#45;81yQe1r_RLn+OwbjTf=7h2q9G+OWTw9bKtB7itHYA@mail.gmail.com -->
<!--X-Reference: 5368A5D5.6040505@chem.ox.ac.uk -->
<!--X-Reference: CAED9pY&#45;PDah4W=E90USk3YakAi=UECBKznFbNmewicFa83tz6Q@mail.gmail.com -->
<!--X-Derived: pdfpBAlfgmZie.pdf -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales -- May 06, 2014 - 12:22</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00153" class="tabs">Index by Date</a> | <a href="threads.html#00153" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00152.html">Date Prev</a>] [<a href="msg00154.html">Date Next</a>] [<a href="msg00150.html">Thread Prev</a>] [<a href="msg00159.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Tue, 06 May 2014 11:21:15 +0100</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;, Martin Tollinger &lt;Martin.Tollinger@xxxxxxxxxx&gt;, Nikolai Skrynnikov &lt;nikolai@xxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00153.html">5368B79B.3070206@chem.ox.ac.uk</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;20140429-222552.sv20529.12099@gna.org&gt;	&lt;20140429-222920.sv20529.65319@gna.org&gt;	&lt;20140429-223825.sv20529.27067@gna.org&gt;	&lt;CA+CBx2N5ti2-+cs4TPViYxqnEpjH3432hydxCicgOcdLb01cEw@mail.gmail.com&gt;	&lt;CAED9pY9josZukT1kOeax=U02GsHL5FMpuaQ9JqTTT+Gx5Ah-eQ@mail.gmail.com&gt;	&lt;<a href="msg00000.html">5360CCC8.3050309@chem.ox.ac.uk</a>&gt;	&lt;CAED9pY8oW7J-7YcBgSRpDPexRghuRNnK851VJ7E+GePdnS2m3Q@mail.gmail.com&gt;	&lt;<a href="msg00010.html">536200D2.2010005@chem.ox.ac.uk</a>&gt;	&lt;<a href="msg00063.html">CA+CBx2Nbfndqpv7Rq+X751z-5fi41DmXo2sGFSar_qOWQPWEuA@mail.gmail.com</a>&gt;	&lt;<a href="msg00088.html">5366AA19.3000304@chem.ox.ac.uk</a>&gt;	&lt;CA+CBx2PXnmcr9DcCEO1K=Jr=ymMncFAJv8amxyBWwzRRv0w3kw@mail.gmail.com&gt;	&lt;<a href="msg00098.html">53675322.2@chem.ox.ac.uk</a>&gt;	&lt;CA+CBx2NMXNk5hVD8_3UO=wToC+PR5vDanWj5RNDpZB5Q=PfGEQ@mail.gmail.com&gt;	&lt;CAED9pY-=-81yQe1r_RLn+OwbjTf=7h2q9G+OWTw9bKtB7itHYA@mail.gmail.com&gt;	&lt;<a href="msg00145.html">5368A5D5.6040505@chem.ox.ac.uk</a>&gt; &lt;CAED9pY-PDah4W=E90USk3YakAi=UECBKznFbNmewicFa83tz6Q@mail.gmail.com&gt;</li>
<li class="menuitem">
<em>User-agent</em>: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:24.0) Gecko/20100101 Thunderbird/24.5.0</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Andrew Baldwin</strong> on May 06, 2014 - 12:22:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<tt>Okay. The proper definition of tcp for your code shows that both 
</tt><tt>functions (fun and rieko) behave similarly. Good!
</tt><pre style="margin: 0em;">

</pre><tt>I also agree that even with the strictest tests, a long double 
</tt><tt>implementation of the algorithm comes out with errors that are much 
</tt><tt>smaller than anything we could ever hope to measure experimentally. 23 
</tt><tt>decimal places seems to be needed to get things to machine precision. 
</tt><tt>This is overkill. The paper makes all these points in a manner that I 
</tt><tt>hope is clear (see last fig).
</tt><pre style="margin: 0em;">

Best,

Andy.


</pre><blockquote class="blockquote"><pre style="margin: 0em;">

</pre><tt>  
</tt><tt>The tcp in this function in relax is defined as 1/(4*nu_CPMG), but in
</tt><pre style="margin: 0em;">
your script you have &quot;tcp=1./(2*nu_cpmg);&quot;.  Apart from that, it looks
ok.  Changing to the correct tcp gives:

Relative times of the various approaches:
Baldwin 0.159632 1.0
Numerical 19.974315 125.127261451
Meiboom 0.056497 0.353920266613
Carver 0.080027 0.501321790117
Nikolai 0.453068 2.83820286659
NikolaiFun 0.284052 1.77941766062
NikolaiLong 50.020116 313.34642177
NikolaiLong 50.430594 315.917823494
Maximum error over grid (s-1):
Meiboom:          237214256.582
Baldwin:          6.57168541807e-10
CarverRichards:   29.9287668504
Nikolai fun:                104.735381561
Nikolai dougle (9):          142.46676955
Nikolai long double (18):     0.063449549192819563320223
Nikolai long double (23):     5.7775487944482434059452e-7

That's far more reasonable for Nikolai's fun!


</pre><blockquote class="blockquote"><pre style="margin: 0em;">
I was hoping that the modification would make it more stable. If anything
the reverse is true. I would have included a note to this effect in the
paper (and still will if you can show it's better). Note the error is very
temperamental. You can miss it even by setting up the grid search
differently. Give it a narrow grid, and you won't see the error. Only
relatively specific, but seemingly hard to predict sets of parameters (all
with large deltaOs) lead it to explode.
</pre></blockquote><pre style="margin: 0em;">
It is worth looking at all deviations rather than just the single
maximum R2eff difference.  It could be that there is an edge case in
the grid whereby a maths domain error occurs.  Or an trig function
overflow.  The median deviation to avoid such outliers might also be
of worth.  By switching in your code all numpy.max() calls with
numpy.median(), and making sure the &quot;Nikolai long double (*)&quot; results
are pre-converted to a numpy float64 array, I then see an incredibly
different picture:

Relative times of the various approaches:
Baldwin 0.152725 1.0
Numerical 19.596446 128.3119725
Meiboom 0.05604 0.366934031756
Carver 0.077236 0.505719430349
Nikolai 0.43944 2.87732853167
NikolaiFun 0.273977 1.7939237191
NikolaiLong 50.243433 328.979754461
NikolaiLong 50.784841 332.524740547
Median error over grid (s-1):
Meiboom:          4.0064828013
Baldwin:          3.9630521087e-12
CarverRichards:   0.00661151728704
Nikolai fun:                6.62225829728e-12
Nikolai dougle (9):          6.70041799822e-12
Nikolai long double (18):     2.62099543458e-12
Nikolai long double (23):     2.27758174227e-12

!

So this is much clearer - outliers are the major difference you are
seeing.  A study of such outliers and their cause would be quite
interesting.  But in most of these cases, simple collapsed equations
for each model should be derivable at the edges which then produce the
expected R2eff over the entire parameter space rather than
computational artefacts in some corners.  Anyway, this result makes it
crystal clear that the different models should not be judged by the
single maximum outlier over the entire parameter space.

Regards,

Edward
</pre></blockquote><pre style="margin: 0em;">

</pre><p><strong>Attachment:
<a href="pdfpBAlfgmZie.pdf" ><tt>240514 exchange14_supp.pdf</tt></a></strong><br>
<em>Description:</em> Adobe PDF document</p>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00159" href="msg00159.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00000" href="msg00000.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Andrew Baldwin</li></ul></li>
<li><strong><a name="00010" href="msg00010.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Andrew Baldwin</li></ul></li>
<li><strong><a name="00063" href="msg00063.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00088" href="msg00088.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Andrew Baldwin</li></ul></li>
<li><strong><a name="00089" href="msg00089.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00098" href="msg00098.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Andrew Baldwin</li></ul></li>
<li><strong><a name="00113" href="msg00113.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00141" href="msg00141.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00145" href="msg00145.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Andrew Baldwin</li></ul></li>
<li><strong><a name="00149" href="msg00149.html">Re: [sr #3154] Implementation of Baldwin (2014) B14 model - 2-site exact solution model for all time scales</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Tue May 06 14:20:10 2014</div>  
</body>
</html>
