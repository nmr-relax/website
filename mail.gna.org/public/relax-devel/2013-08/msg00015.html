<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: [sr #3043] Support for NMRPipe seriesTab format *.ser -->
<!--X-From-R13: Febryf Szgrxæe Zvaarg <gyvaargNtznvy.pbz> -->
<!--X-Date: Fri, 02 Aug 2013 18:13:58 +0200 -->
<!--X-Message-Id: CA+CBx2Mh2nRUa9NeCr=z0Le+mG2vkOEO1L1cBHR3twCmvZ21_Q@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20130618&#45;111658.sv20529.92371@gna.org -->
<!--X-Reference: 20130621&#45;104836.sv20529.74597@gna.org -->
<!--X-Reference: 20130621&#45;110326.sv20529.53221@gna.org -->
<!--X-Reference: 20130621&#45;125601.sv20529.4232@gna.org -->
<!--X-Reference: 20130621&#45;133538.sv20529.35811@gna.org -->
<!--X-Reference: 20130621&#45;133624.sv20529.28609@gna.org -->
<!--X-Reference: 20130621&#45;134734.sv20529.63622@gna.org -->
<!--X-Reference: 20130621&#45;135732.sv20529.11927@gna.org -->
<!--X-Reference: 20130621&#45;143814.sv20529.47445@gna.org -->
<!--X-Reference: 20130621&#45;144033.sv2782.32592@gna.org -->
<!--X-Reference: 20130621&#45;144059.sv2782.9513@gna.org -->
<!--X-Reference: 20130621&#45;152621.sv20529.10944@gna.org -->
<!--X-Reference: 20130621&#45;152918.sv2782.33904@gna.org -->
<!--X-Reference: 20130621&#45;155028.sv20529.59982@gna.org -->
<!--X-Reference: 20130621&#45;155445.sv20529.38949@gna.org -->
<!--X-Reference: 20130621&#45;160244.sv20529.97199@gna.org -->
<!--X-Reference: 20130621&#45;161055.sv20529.98641@gna.org -->
<!--X-Reference: 20130621&#45;161450.sv20529.54611@gna.org -->
<!--X-Reference: 20130621&#45;173006.sv20529.34821@gna.org -->
<!--X-Reference: 20130621&#45;174335.sv20529.95831@gna.org -->
<!--X-Reference: 20130621&#45;174724.sv20529.63909@gna.org -->
<!--X-Reference: 20130621&#45;175836.sv20529.88391@gna.org -->
<!--X-Reference: 20130621&#45;180416.sv20529.2309@gna.org -->
<!--X-Reference: 20130624&#45;094924.sv20529.63314@gna.org -->
<!--X-Reference: 20130624&#45;104521.sv20529.19556@gna.org -->
<!--X-Reference: 20130624&#45;124624.sv20529.87885@gna.org -->
<!--X-Reference: 20130624&#45;142927.sv20529.87827@gna.org -->
<!--X-Reference: 20130625&#45;170643.sv20529.66724@gna.org -->
<!--X-Reference: 20130626&#45;131656.sv20529.87900@gna.org -->
<!--X-Reference: 20130720&#45;111435.sv20529.57662@gna.org -->
<!--X-Reference: 20130720&#45;163956.sv20529.18980@gna.org -->
<!--X-Reference: 20130802&#45;082933.sv20529.44392@gna.org -->
<!--X-Reference: 20130802&#45;113735.sv20529.87604@gna.org -->
<!--X-Reference: 20130802&#45;115138.sv20529.59841@gna.org -->
<!--X-Reference: 20130802&#45;152917.sv20529.29978@gna.org -->
<!--X-Reference: CAED9pY8Zg6pj7970J=Q=t0Ze2=R_&#45;TypJDg5pv&#45;REAhaerq&#45;&#45;w@mail.gmail.com -->
<!--X-Reference: CA+CBx2Pirn+VT4ugUX5J0TMN_jJrJGwkuL0Awi4DgZPYZQsLDA@mail.gmail.com -->
<!--X-Reference: CAED9pY&#45;QAHTeise6+0SEwpAtTF=fbWHXcxnv=QPAtdMtYPqJvg@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [sr #3043] Support for NMRPipe seriesTab format *.ser -- August 02, 2013 - 18:13</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: [sr #3043] Support for NMRPipe seriesTab format *.ser</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00015" class="tabs">Index by Date</a> | <a href="threads.html#00015" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00014.html">Date Prev</a>] [<a href="msg00016.html">Date Next</a>] [<a href="msg00014.html">Thread Prev</a>] [<a href="msg00018.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Edward d'Auvergne&quot; &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Fri, 2 Aug 2013 18:13:07 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;Troels E. Linnet&quot; &lt;NO-REPLY.INVALID-ADDRESS@xxxxxxx&gt;,	&quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113;	h=mime-version:in-reply-to:references:from:date:message-id:subject:to	:cc:content-type:content-transfer-encoding;	bh=RNhEmjWETJ6yYXdVZKC+wRhifejq2LNhXzS2WwJVnzo=;	b=GEKg4JVR8BpRQSD/EKEJsppYKVy0iCXD40lko0ZuNvQMIFN4kdzgSmkn9aZXKrvvp1	l1pppF67V74Wnjdy7afYrS9daqRQ7Qgo6MFngrugAXi4/J7HIhlatF7t7RA4gwAVOboA	zbxWVKv2Dx6SxyZlvpz4tA1rlSeS5hxSNe+EW+TxpiKLu5CL9VcoLKOXs2Db/ZbxJV4b	Fpvw05WQ1d0GYZ8hw7YGhMgIvOCBMIZ4dTSyAiwPLT95MZFe2dnIqFjii9+6Fwv9+Jb9	AjGLszbZU8fvVGE1anNI5ZfKfQjxgZ33DmO98hPdhCvLME+s0DAD58rKp7zPa3bHdiJ5	stXg==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00015.html">CA+CBx2Mh2nRUa9NeCr=z0Le+mG2vkOEO1L1cBHR3twCmvZ21_Q@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;20130618-111658.sv20529.92371@xxxxxxx&gt;	&lt;20130621-104836.sv20529.74597@xxxxxxx&gt;	&lt;20130621-110326.sv20529.53221@xxxxxxx&gt;	&lt;20130621-125601.sv20529.4232@xxxxxxx&gt;	&lt;20130621-133538.sv20529.35811@xxxxxxx&gt;	&lt;20130621-133624.sv20529.28609@xxxxxxx&gt;	&lt;20130621-134734.sv20529.63622@xxxxxxx&gt;	&lt;20130621-135732.sv20529.11927@xxxxxxx&gt;	&lt;20130621-143814.sv20529.47445@xxxxxxx&gt;	&lt;20130621-144033.sv2782.32592@xxxxxxx&gt;	&lt;20130621-144059.sv2782.9513@xxxxxxx&gt;	&lt;20130621-152621.sv20529.10944@xxxxxxx&gt;	&lt;20130621-152918.sv2782.33904@xxxxxxx&gt;	&lt;20130621-155028.sv20529.59982@xxxxxxx&gt;	&lt;20130621-155445.sv20529.38949@xxxxxxx&gt;	&lt;20130621-160244.sv20529.97199@xxxxxxx&gt;	&lt;20130621-161055.sv20529.98641@xxxxxxx&gt;	&lt;20130621-161450.sv20529.54611@xxxxxxx&gt;	&lt;20130621-173006.sv20529.34821@xxxxxxx&gt;	&lt;20130621-174335.sv20529.95831@xxxxxxx&gt;	&lt;20130621-174724.sv20529.63909@xxxxxxx&gt;	&lt;20130621-175836.sv20529.88391@xxxxxxx&gt;	&lt;20130621-180416.sv20529.2309@xxxxxxx&gt;	&lt;20130624-094924.sv20529.63314@xxxxxxx&gt;	&lt;20130624-104521.sv20529.19556@xxxxxxx&gt;	&lt;20130624-124624.sv20529.87885@xxxxxxx&gt;	&lt;20130624-142927.sv20529.87827@xxxxxxx&gt;	&lt;20130625-170643.sv20529.66724@xxxxxxx&gt;	&lt;20130626-131656.sv20529.87900@xxxxxxx&gt;	&lt;20130720-111435.sv20529.57662@xxxxxxx&gt;	&lt;20130720-163956.sv20529.18980@xxxxxxx&gt;	&lt;20130802-082933.sv20529.44392@xxxxxxx&gt;	&lt;20130802-113735.sv20529.87604@xxxxxxx&gt;	&lt;20130802-115138.sv20529.59841@xxxxxxx&gt;	&lt;20130802-152917.sv20529.29978@xxxxxxx&gt;	&lt;CAED9pY8Zg6pj7970J=Q=t0Ze2=R_-TypJDg5pv-REAhaerq--w@xxxxxxxxxxxxxx&gt;	&lt;CA+CBx2Pirn+VT4ugUX5J0TMN_jJrJGwkuL0Awi4DgZPYZQsLDA@xxxxxxxxxxxxxx&gt;	&lt;CAED9pY-QAHTeise6+0SEwpAtTF=fbWHXcxnv=QPAtdMtYPqJvg@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Troels Emtekær Linnet</strong> on August 02, 2013 - 18:13:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">I was thinking...

On 10/10 scale, how long time would it take to make a GUI user function.

nmrpipe -&gt; create NMRPipe-format Peak Table from SPARKY assigment.

Input: A SPARKY output file with X and Y in PPM
Input frqX, frqY from OBS MHz
Input sizeX, sizeY from DATA SIZE
Input origX, origY from ORIG Hz
Input swX, swY from SW Hz

-------------------------------------------------------------------
[tlinnet@tomat ft2_data]$ showhdr test.ft2
FILE: test.ft2 DIM: 2 QUAD: Real 2DMODE: States
BYTES: 527360 PRED: 527360 MIN: 0 MAX: 0 VALID: 0
ORDER: 2 1 PIPE: 0 PLANES: 1 513x256x1 Not Transposed

               X-Axis        Y-Axis

DATA SIZE:           513          256
APOD SIZE:           160          128
SW Hz:       2504.882812  1400.020996
OBS MHz:      499.862000    50.655998
ORIG Hz:     2996.960938  5300.190918
DOMAIN:             Freq         Freq
MODE:               Real         Real
NAME:                 H1          N15
--------------------------------------------------------

This is in perl:
$stepX=$swX/$frqX/$sizeX;
$highX=($origX+$swX)/$frqX;
$stepY=$swY/$frqY/$sizeY;
$highY=($origY+$swY)/$frqY;
$i=1;
print &quot;VARS   INDEX X_AXIS Y_AXIS X_PPM Y_PPM VOL ASS\n&quot;;
print &quot;FORMAT %5d %9.3f %9.3f %8.3f %8.3f %+e %s\n\n&quot;;

open IN, &quot;$sparkyList&quot; or die &quot;Cannot open $sparkyList for read&quot;;
        while (&lt;IN&gt;){
                @process = split (/\s+/, $_);
                if ($process[0] eq &quot;&quot;){splice (@process, 0, 1)};
                if ($process[0] ne &quot;Assignment&quot; &amp;&amp; $process[0] ne &quot;&quot;){
                        $ptsX=($highX-$process[2])/$stepX;
                        $ptsY=($highY-$process[1])/$stepY;
                        printf &quot;%5d %9.3f %9.3f %8.3f %8.3f %+e
%s\n&quot;,$i,$ptsX,$ptsY,$process[2],$process[1],700000,$process[0];
                        $i++;
                };
        };
close (IN);

Best
Troels Emtekær Linnet


2013/8/2 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

Ok, then we keep it as the Sparky format.  When a user encounters a
non-Sparky format, we can deal with it then.

Cheers,

Edward



On 2 August 2013 17:50, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Edward.

When you generate NMRPipe series tab file, you need to have
a file with the spectral points.

See example here:
<a  rel="nofollow" href="http://wiki.nmr-relax.com/NMRPipe_seriesTab">http://wiki.nmr-relax.com/NMRPipe_seriesTab</a>

VARS   INDEX X_AXIS Y_AXIS X_PPM Y_PPM VOL ASS
FORMAT %5d %9.3f %9.3f %8.3f %8.3f %+e %s

    1   246.658    18.268    9.932  128.374 +7.000000e+05 W62NE1-W62HE1
    2   321.698    30.994    9.419  127.066 +7.000000e+05 L10N-L10HN
    3   320.089    55.737    9.430  124.523 +7.000000e+05 V6N-V6HN

It is the X_AXIS and Y_AXIS spectral points that is essential to make
the summation correct.
And it will just snap the assignment in the last column, without any
check (As far as I know.)

If you use SPARKY to export your file, you should get the assignment
as seen above.
And you get the Y_AXIS X_PPM Y_PPM.
You can calculate  X_AXIS Y_AXIS, if you extract information from use
of nmrpipe &quot;head&quot; on the .ft2 file

But here comes the trouble. Different NMR program can export in SPARKY
like format, but always a little
different. So, until now, I keep it in SPARKY format.

Best
Troels Emtekær Linnet


2013/8/2 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;
</pre><blockquote class="blockquote"><pre style="margin: 0em;">

Hi Troels,

I'm getting through you patches and have applied the first two.  These
are ok.  I have an issue with
0003-The-ID-of-spins-in-seriesTab_multi.ser-was-not-forma.patch though
(git hash f49b4f096773cb2f7ecb70293122e03b0b40e889).  It says that you
are changing the seriesTab_multi.ser file's 'ASS' column format to
that of Sparky.  Why is this so?  Is there an NMRPipe seriesTab format
which is different from Sparky?  If so, we should support that.

Cheers,

Edward


On 2 August 2013 17:29, Troels E. Linnet
&lt;NO-REPLY.INVALID-ADDRESS@xxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Follow-up Comment #53, sr #3043 (project relax):

Multi colums import now supported.

Note, I made it possible to autogenerate spectrum ID's, if
 spectrum_id='auto' for the function:

spectrum.read_intensities(file=&quot;seriesTab_multi.ser&quot;, 
dir=status.install_path
+ sep+'test_suite'+sep+'shared_data'+sep+'peak_lists', 
spectrum_id='auto',
int_method='point sum')

(file #18619)
    _______________________________________________________

Additional Item Attachment:

File name: stab.patch.tar.gz              Size:4 KB


    _______________________________________________________

Reply to this item at:

  &lt;<a  rel="nofollow" href="http://gna.org/support/?3043">http://gna.org/support/?3043</a>&gt;

_______________________________________________
  Message sent via/by Gna!
  <a  rel="nofollow" href="http://gna.org/">http://gna.org/</a>

</pre></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00018" href="msg00018.html">Re: [sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00001" href="msg00001.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00006" href="msg00006.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00007" href="msg00007.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00009" href="msg00009.html">[sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00010" href="msg00010.html">Re: [sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00012" href="msg00012.html">Re: [sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00014" href="msg00014.html">Re: [sr #3043] Support for NMRPipe seriesTab format *.ser</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Fri Aug 02 18:40:06 2013</div>  
</body>
</html>
