<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: Curve fitting -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Mon, 20 Oct 2008 11:01:24 +0200 -->
<!--X-Message-Id: 7f080ed10810200201l7d0258f4m38a0bc5742fbc78d@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 48F6BF00.2060705@ulaval.ca -->
<!--X-Reference: 3b3f50350810152202k5111822ahc95ecfe4f6b25198@mail.gmail.com -->
<!--X-Reference: 7f080ed10810160207m722eea76q49a2eb9e012fc875@mail.gmail.com -->
<!--X-Reference: 3b3f50350810161659g14eb7e42i390ba2e404ae291f@mail.gmail.com -->
<!--X-Reference: 7f080ed10810170849s6d8e4b69tdb6af2ba9c4abe@mail.gmail.com -->
<!--X-Reference: 48F8BA3A.1040605@ulaval.ca -->
<!--X-Reference: 7f080ed10810171420y1e9857dat31cd91c866221360@mail.gmail.com -->
<!--X-Reference: 3b3f50350810191620q14589239r838332897e15c341@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Curve fitting -- October 20, 2008 - 11:01</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Curve fitting</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00059" class="tabs">Index by Date</a> | <a href="threads.html#00059" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00058.html">Date Prev</a>] [<a href="msg00060.html">Date Next</a>] [<a href="msg00058.html">Thread Prev</a>] [<a href="msg00052.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Chris MacRaild&quot; &lt;macraild@xxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Mon, 20 Oct 2008 11:01:20 +0200</li>
<li class="menuitem">
<em>Cc</em>: Stephane Gagne &lt;smg@xxxxxxxxxxxxxx&gt;, relax-users@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00059.html">7f080ed10810200201l7d0258f4m38a0bc5742fbc78d@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;48F6BF00.2060705@xxxxxxxxx&gt;	&lt;3b3f50350810152202k5111822ahc95ecfe4f6b25198@xxxxxxxxxxxxxx&gt;	&lt;7f080ed10810160207m722eea76q49a2eb9e012fc875@xxxxxxxxxxxxxx&gt;	&lt;3b3f50350810161659g14eb7e42i390ba2e404ae291f@xxxxxxxxxxxxxx&gt;	&lt;7f080ed10810170849s6d8e4b69tdb6af2ba9c4abe@xxxxxxxxxxxxxx&gt;	&lt;48F8BA3A.1040605@xxxxxxxxx&gt;	&lt;7f080ed10810171420y1e9857dat31cd91c866221360@xxxxxxxxxxxxxx&gt;	&lt;3b3f50350810191620q14589239r838332897e15c341@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on October 20, 2008 - 11:01:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">On Mon, Oct 20, 2008 at 1:20 AM, Chris MacRaild &lt;macraild@xxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">On Sat, Oct 18, 2008 at 8:20 AM, Edward d'Auvergne
&lt;edward.dauvergne@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

Before you sent this message, I was talking to Ben Frank (a PhD
student in Griesinger's lab) about this exact problem - baseplane RMSD
noise to volume error.  The formula of Nicholson et al., 1992 you
mentioned makes perfect sense as that's what we came up with too.
Volume integration over a given area is the sum of the heights of all
the discrete points in the frequency domain spectrum within that box.
So the error of a single point is the same as that of the peak height.
 We just have n*m points within this box.  And as variances add, not
standard deviations, then the variance (sigma^2) of the volume is:

sigma_vol^2 = sigma_i^2 * n * m,

where sigma_vol is the standard deviation of the volume, sigma_i is
the standard deviation of a single point assumed to be equal to the
RMSD of the baseplane noise, and n and m are the dimensions of the
box.  Taking the square root of this gives the Nicholson et al.
formula:

sigma_vol = sigma_i * sqrt(n*m).

</pre></blockquote><pre style="margin: 0em;">

This is the strategy I have used to try and get precision estimates
from peak volumes. As I said earlier, in my hands it does not perform
well. Uncertainties from this method will systematically over-estimate
the precision of strong peaks and underestimate the precision of weak
ones as compared to estimates from duplicate spectra (or perhaps its
the other way around, I don't remember). This may not be evident for
proteins like ubiquitin, where virtually all amides give uniformly
strong peaks in the HSQC, but for proteins with more varied relaxation
behaviour, this can be a major issue. Its important to keep in mind
just how much signal processing goes on between a raw fid (in which
the noise in adjacent points is independent and uncorrelated) and the
spectrum that we integrate (in which, apparently, noise in adjacent
points is not always independent and uncorrelated).

Even apart from this issue, I have always found peak height to give
better results for fitting relaxation data. Heights would be expected
to be less sensitive to all sorts of experimental complications like
imperfect baselines, peak overlap, phase errors, etc. In my hands this
always seems to outweigh the greater precision afforded by peak
volumes.
</pre></blockquote><pre style="margin: 0em;">

I'm about to implement a much better system for handling spectra and
peak intensities in relax, by creating a new 'spectrum' user function
class.  I hope to implement as many different ways of handling
intensities and errors.  I might summarise all later, but these
include:

Intensity type;  Noise source;  Error scope

height;  RMSD baseplane;  sigma per peak per spectrum.
height;  partial duplicate + variance averaging;  one sigma for all
peaks, all spectra.
height;  all replicated + variance averaging;  one sigma per time point.
volume;  partial duplicate + variance averaging;  one sigma for all
peaks, all spectra.
volume;  all replicated + variance averaging;  one sigma per time point.

Note that there is no volume + RMSD of baseplane yet because I don't
know how to handle this.  Maybe I could let the user specify how many
points were used in the integration (and force them to state the
integration method to internally check for compatibility - i.e.
disallow Sparky Gaussian integration!).  As you said, the errors are
correlated in the frequency domain - I think this is due to the
smoothing of the window function and the wavelet like interpolation of
zero filling - but the RMSD measure takes that into account.  So for
volume integration methods using point summing, then we can use the
equation:

sigma_vol = sigma_i * sqrt(N),

where sigma_vol is the standard deviation of the volume, sigma_i is
the standard deviation of a single point assumed to be equal to the
RMSD of the baseplane noise, and N is the total number of points used
in the summation integration method.  Does anyone know any other
methods that could be used here?  Because of your description Chris,
do you think we should we have relax throw a RelaxWarning stating that
this error estimation method is not very accurate?


</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">Edward d'Auvergne wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Oh, I forgot about the std error formula.  Is where the sqrt(2) comes
from?  Doh, that would be retarded.  Then I know someone who would
require sqrt(3) for the NOE spectra!  Is that really what Palmer
meant, that std error is the same as &quot;the standard deviation of the
differences between the heights of corresponding peaks in the paired
spectra&quot; which &quot;is equal to sqrt(2)*sigma&quot; (Palmer et al., 1991)?

I'm pretty sure though that the standard error is not the measure we
want for the confidence interval of the peak intensity.  The reason is
because I think that the std error is a measure of how far the sample
mean is from the true mean (ignore this, this is a quick reference for
myself: <a  rel="nofollow" href="http://en.wikipedia.org/wiki/Standard_error_">http://en.wikipedia.org/wiki/Standard_error_</a>(statistics) ).
(Warning, from here to the end of the paragraph is a rant!) This is
similar in concept to AIC model selection (see
<a  rel="nofollow" href="http://en.wikipedia.org/wiki/Akaike_information_criterion">http://en.wikipedia.org/wiki/Akaike_information_criterion</a> and
<a  rel="nofollow" href="http://en.wikipedia.org/wiki/Model_selection">http://en.wikipedia.org/wiki/Model_selection</a> if you haven't heard
about the advanced statistical field of model selection before).  AIC
is a little more advanced though as it estimates the Kullback-Leibler
discrepancy (<a  rel="nofollow" href="http://en.wikipedia.org/wiki/Kullback–Leibler_divergence">http://en.wikipedia.org/wiki/Kullback–Leibler_divergence</a>)
which is a measure of distance between the true distribution and the
back-calculated distribution using all information about the
distribution.  Ok, that wasn't too relevant.  Anyway, the std error as
a measure of the differences in means of 2 different distributions is
not a measure of the spread of either the true, measured, or
back-calculated distributions (or the 4th distribution, the
back-calculated from the fit to the true model).  The std error is not
the confidence intervals of any of these 4 distributions, just the
difference between 2 of them using only a small part of the
information of those distributions.  It's the statistical measure of
the difference in means of the true and measured distributions.  As an
aside, for those completely lost now a clearer explanation of these 4
distributions fundamental to data analysis, likelihood, discrepancies,
etc. can be read in section 2.2 of my PhD thesis at
<a  rel="nofollow" href="http://dtl.unimelb.edu.au:80/R/-?func=dbin-jump-full&amp;amp;object_id=67077&amp;amp;current_base=GEN01">http://dtl.unimelb.edu.au:80/R/-?func=dbin-jump-full&amp;amp;object_id=67077&amp;amp;current_base=GEN01</a>
or 
<a  rel="nofollow" href="http://www.amazon.com/Protein-Dynamics-Model-free-Analysis-Relaxation/dp/3639057627/ref=sr_1_6?ie=UTF8&amp;s=books&amp;qid=1219247007&amp;sr=8-6">http://www.amazon.com/Protein-Dynamics-Model-free-Analysis-Relaxation/dp/3639057627/ref=sr_1_6?ie=UTF8&amp;s=books&amp;qid=1219247007&amp;sr=8-6</a>
(sorry for the blatant plug ;).  Oh, the best way to picture all of
these concepts and the links between them is to draw and label 4
distributions on a piece of paper on the same x and y-axes with not
too much overlap between them and connect them with arrows labelled
with all the weird terminology.

Sorry, that was just a long way of saying that the std error is the
quality of how the sample mean matches the real mean and how the
standard deviation is the spread of the distribution.  That being so,
I would avoid setting the standard error as the peak height
uncertainty.  Maybe it would be best to do as you say Chris, and also
avoid the averaging of the replicated intensities.
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">

I didn't mean to suggest that std error should be taken as the peak
height uncertainty. Rather, it should be taken as the uncertainty for
any value which is the mean of peak heights (eg. the mean value of a
duplicate measurement). So, for a peak height measured from a single
spectrum, the uncertainty is best estimated as the std dev of
duplicates, but failing that from the RMS noise. For a mean value
derived from duplicates the std error is the appropriate estimate of
precision.
</pre></blockquote><pre style="margin: 0em;">

Would you recommend, therefore, that we should not average peak
heights and use the normal peak height standard deviation from the
replicated spectra?  This would weight the fitting towards the
replicated points, but maybe that would be more accurate for the error
analysis.  Does anyone have opinions as to the best method for
fitting+error propagation using replicated spectra?

Regards,

Edward


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00041" href="msg00041.html">Curve fitting</a></strong>
<ul><li><em>From:</em> Sébastien Morin</li></ul></li>
<li><strong><a name="00042" href="msg00042.html">Re: Curve fitting</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00045" href="msg00045.html">Re: Curve fitting</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00051" href="msg00051.html">Re: Curve fitting</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00054" href="msg00054.html">Re: Curve fitting</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00055" href="msg00055.html">Re: Curve fitting</a></strong>
<ul><li><em>From:</em> Sébastien Morin</li></ul></li>
<li><strong><a name="00056" href="msg00056.html">Re: Curve fitting</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00058" href="msg00058.html">Re: Curve fitting</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Mon Oct 20 17:20:37 2008</div>  
</body>
</html>
