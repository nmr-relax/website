<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: r25036 &#45; /trunk/specific_analyses/relax_disp/api.py -->
<!--X-From-R13: "Sqjneq q'Ohiretar" &#60;rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Tue, 19 Aug 2014 16:36:39 +0200 -->
<!--X-Message-Id: CAED9pY&#45;ejc6V=bMXGZFiysD3hwv5jUWKWZfS&#45;Y2B8kHvuu+ojQ@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: E1XIKlO&#45;0007tt&#45;3m@subversion.gna.org -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: r25036 - /trunk/specific_analyses/relax_disp/api.py -- August 19, 2014 - 16:36</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: r25036 - /trunk/specific_analyses/relax_disp/api.py</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00152" class="tabs">Index by Date</a> | <a href="threads.html#00152" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00151.html">Date Prev</a>] [<a href="msg00153.html">Date Next</a>] [<a href="msg00150.html">Thread Prev</a>] [<a href="msg00156.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Tue, 19 Aug 2014 16:36:08 +0200</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113; h=mime-version:sender:in-reply-to:references:date:message-id:subject :from:to:content-type; bh=Yvjomx0ySs6Af7qkOKq11bYEN9euQgtovxm/GJsBdpQ=; b=hAnI6gHIhAGLIOXTDMdAoJzcxb8LPjf9H5KrzQeeHnnVq8X/kr4vgNyrRBsdmkm0TK r9bt0NOZE2i7P/xn2HElMgNFP5yuGvtSGbAE9i6qT5OkaQKCnmWUAmjqeff34kAgRTBE w7PbfDNHSrSfAEPR+2dFafFq+O4m2P1bC9eR5GQF2JaVCfl8Mjg1KVSRJ/WgW/n1sRhx ABeP+/AefXgHV4R1TYMJR6EKzjUYTLq+lmaw66MK8SYNaPFFIZBbtHU8WcE5I5jkQ9gT r864krOPTSFHbe07sJiP0kYJGDm4NbyHaVDOJMwqL8PLwWTg5RYevz5zQk25hHkloo1x AE8w==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;CAED9pY-ejc6V=bMXGZFiysD3hwv5jUWKWZfS-Y2B8kHvuu+ojQ@mail.gmail.com&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;E1XIKlO-0007tt-3m@subversion.gna.org&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on August 19, 2014 - 16:36:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi,

This is a difficult problem as R1 values are normally stored in the
ri_data dictionary object, the same place that R2 values are stored.
I don't have an easy solution for this, but future attempts at
unifying the handling of relaxation data in all analyses will affect
your current work.  For example the 'r1' parameter here will probably
be converted into 'ri_data', and the 'ri_data' object set up with a
special method in the base Parameter_object class.  The 'ri_data'
object is correctly handled by value.set and grace.write, but the
current implementation in the model-free parameter object is ugly.
Does your implementation now work correctly?

Regards,

Edward



On 15 August 2014 18:54,  &lt;tlinnet@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Author: tlinnet
Date: Fri Aug 15 18:54:01 2014
New Revision: 25036

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=25036&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=25036&amp;view=rev</a>
Log:
Fix in relax_disp API, how to handle the r1_fit parameter type.

bug #22470(<a  rel="nofollow" href="https://gna.org/bugs/index.php?22470">https://gna.org/bugs/index.php?22470</a>): value.set does not work 
for parameter r1_fit.

Modified:
    trunk/specific_analyses/relax_disp/api.py

Modified: trunk/specific_analyses/relax_disp/api.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/specific_analyses/relax_disp/api.py?rev=25036&amp;r1=25035&amp;r2=25036&amp;view=diff">http://svn.gna.org/viewcvs/relax/trunk/specific_analyses/relax_disp/api.py?rev=25036&amp;r1=25035&amp;r2=25036&amp;view=diff</a>
==============================================================================
--- trunk/specific_analyses/relax_disp/api.py   (original)
+++ trunk/specific_analyses/relax_disp/api.py   Fri Aug 15 18:54:01 2014
@@ -1001,8 +1001,29 @@
                 if error:
                     obj_name += '_err'

+                # Handle the R10 parameters.
+                if param[i] in ['r1_fit']:
+                    # Loop over the current keys.
+                    for exp_type, frq, ei, mi in 
loop_exp_frq(return_indices=True):
+                        # The parameter key.
+                        key = generate_r20_key(exp_type=exp_type, frq=frq)
+
+                        # Initialise the structure if needed.
+                        if not hasattr(spin, obj_name):
+                            setattr(spin, obj_name, {})
+
+                        # Set the value.
+                        if index == None:
+                            obj = getattr(spin, obj_name)
+                            obj[key] = value[i]
+
+                        # If the index is specified, let it match the 
frequency index
+                        elif mi == index:
+                            obj = getattr(spin, obj_name)
+                            obj[key] = value[i]
+
                 # Handle the R20 parameters.
-                if param[i] in PARAMS_R20:
+                elif param[i] in PARAMS_R20:
                     # Loop over the current keys.
                     for exp_type, frq, ei, mi in 
loop_exp_frq(return_indices=True):
                         # The parameter key.


_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-commits mailing list
relax-commits@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-commits">https://mail.gna.org/listinfo/relax-commits</a>
</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00156" href="msg00156.html">Re: r25036 - /trunk/specific_analyses/relax_disp/api.py</a></strong>
<ul><li><em>From:</em> Troels Emtek√¶r Linnet</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Tue Aug 19 17:00:17 2014</div>  
</body>
</html>
