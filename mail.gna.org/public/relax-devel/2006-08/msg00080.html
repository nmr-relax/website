<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: RelaxWarnings -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneq.qnhiretarNtznvy.pbz> -->
<!--X-Date: Thu, 17 Aug 2006 14:16:43 +0200 -->
<!--X-Message-Id: 7f080ed10608170516y5042a6f6v1ff0adfc0e1fd9f9@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 7f080ed10608100336r3dc92d80h1ce3251e55b49347@mail.gmail.com -->
<!--X-Reference: 1155569275.28764.654.camel@fbsdpcu021 -->
<!--X-Reference: 7f080ed10608142258t2e4d4c02hf4859c8f29b400c3@mail.gmail.com -->
<!--X-Reference: 1155637306.28764.740.camel@fbsdpcu021 -->
<!--X-Reference: 7f080ed10608160054ta16d3c7mbfd858f61df9ddce@mail.gmail.com -->
<!--X-Reference: 1155722684.28764.797.camel@fbsdpcu021 -->
<!--X-Reference: 7f080ed10608160917g38780203s650432c7112ef866@mail.gmail.com -->
<!--X-Reference: 1155747684.28764.827.camel@fbsdpcu021 -->
<!--X-Reference: 7f080ed10608161015p595f274dl792721dc236695c5@mail.gmail.com -->
<!--X-Reference: 1155810593.28764.852.camel@fbsdpcu021 -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: RelaxWarnings -- August 17, 2006 - 14:16</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: RelaxWarnings</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00080" class="tabs">Index by Date</a> | <a href="threads.html#00080" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00079.html">Date Prev</a>] [<a href="msg00081.html">Date Next</a>] [<a href="msg00079.html">Thread Prev</a>] [<a href="msg00053.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Chris MacRaild&quot; &lt;c.a.macraild@xxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Thu, 17 Aug 2006 22:16:05 +1000</li>
<li class="menuitem">
<em>Cc</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00080.html">7f080ed10608170516y5042a6f6v1ff0adfc0e1fd9f9@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;<a href="msg00052.html">7f080ed10608100336r3dc92d80h1ce3251e55b49347@mail.gmail.com</a>&gt;	&lt;<a href="msg00067.html">1155569275.28764.654.camel@fbsdpcu021</a>&gt;	&lt;<a href="msg00068.html">7f080ed10608142258t2e4d4c02hf4859c8f29b400c3@mail.gmail.com</a>&gt;	&lt;<a href="msg00069.html">1155637306.28764.740.camel@fbsdpcu021</a>&gt;	&lt;<a href="msg00070.html">7f080ed10608160054ta16d3c7mbfd858f61df9ddce@mail.gmail.com</a>&gt;	&lt;<a href="msg00071.html">1155722684.28764.797.camel@fbsdpcu021</a>&gt;	&lt;<a href="msg00072.html">7f080ed10608160917g38780203s650432c7112ef866@mail.gmail.com</a>&gt;	&lt;<a href="msg00074.html">1155747684.28764.827.camel@fbsdpcu021</a>&gt;	&lt;<a href="msg00076.html">7f080ed10608161015p595f274dl792721dc236695c5@mail.gmail.com</a>&gt;	&lt;<a href="msg00079.html">1155810593.28764.852.camel@fbsdpcu021</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on August 17, 2006 - 14:16:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<tt>On 8/17/06, Chris MacRaild wrote:
</tt><blockquote class="blockquote"><pre style="margin: 0em;">On Thu, 2006-08-17 at 03:15 +1000, Edward d'Auvergne wrote:</pre><br>
<pre style="margin: 0em;">&gt; &gt; &gt;
&gt; &gt; &gt; A problem that needs to be solved is how do we implement specific
&gt; &gt; &gt; warnings?  For example if two distant areas of relax test for zero
&gt; &gt; &gt; length XH bond vectors, there should be one function which takes the
&gt; &gt; &gt; residue number and formats a standard message for that warning.
&gt; &gt; &gt; However the 'warn()' function expects a message?  What if we have a
&gt; &gt; &gt; class object called RelaxZeroLengthWarning which has a __call__()
&gt; &gt; &gt; method which returns the formatted string?  You could then, from
&gt; &gt; &gt; within different parts of relax, generate an error by having the code:
&gt; &gt; &gt;
&gt; &gt; &gt; if len(xh) == 0.0:
&gt; &gt; &gt;     warn(RelaxZeroLengthWarning(res))
&gt; &gt; &gt;
&gt; &gt; &gt; where warn was placed into __builtin__ by relax (see the
&gt; &gt; &gt; 'nan_catch_test' branch) and 'res' is the residue number.  There
&gt; &gt; &gt; might, however, be a much better way to implement specific warnings.
&gt; &gt; &gt; The rest of the system could be setup as in the 'nan_catch_test'
&gt; &gt; &gt; branch.
&gt; &gt; &gt;
&gt; &gt;
&gt; &gt; This is a good point. After some head-scratching, I think the 'correct'
&gt; &gt; way to do it is to treat each warning category specifically in the
&gt; &gt; formatwarning function. So we would have something more like:
&gt; &gt;
&gt; &gt; def format(message, category, filename, lineno):
&gt; &gt;     if issubclass(category, RelaxZeroLengthWarning):
&gt; &gt;         message = &quot;Zero length vector at residue %s&quot; % message
&gt; &gt;
&gt; &gt;     # ...lots more specific warning cases...
&gt; &gt;
&gt; &gt;     if issubclass(category, BaseWarning):
&gt; &gt;         message = &quot;RelaxWarning: %s\n&quot; % message
&gt; &gt;
&gt; &gt;     return message
&gt; &gt;
&gt; &gt; warnings.formatwarning = format
&gt; &gt;
&gt; &gt;
&gt; &gt; Then the 'message' for RelaxZeroLengthWarning when we do warn() is just
&gt; &gt; the residue, and format() does the rest.
&gt;
&gt; A number of RelaxErrors take a number of arguments and from my reading
&gt; of the docs I would guess that the warning system would assert that
&gt; the 'message' argument to 'warn()' must be a string.</pre><br>
<pre style="margin: 0em;">Another good point. That proposal wont work.</pre><br>
<pre style="margin: 0em;">&gt; How about using
&gt; the '__call__()' function to pass in the relevant data to the class
&gt; using keywords and then store it within the object.</pre><br>
<pre style="margin: 0em;">The problem here is that __call__() works when you call an instance of a
class. RelaxZeroLengthWarning is a class, so RelaxZeroLengthWarning(res)
instanciates the class, effectively calling __init__(res).</pre><br>
<pre style="margin: 0em;">After some more head-scratching and some help from Gary, I realise that
this is a actually what we want. warn() can be called with a single
argument which is an instance of a Warning class, then message is str()
called on that instance, and category is class() called on that
instance. So if we code the message formatting in __str__() for each of
the warning classes, we can do:</pre><br>
<pre style="margin: 0em;">warn(RelaxZeroLengthWarning(res))</pre><br>
<pre style="margin: 0em;">as you propose, and this will allow for an arbitrary number and type of
arguments. It might even be possible to subclass the warning classes
from the equivalent error class, making for even more streamlining of
the code.</pre><br>
<pre style="margin: 0em;">I'll have a shot at making this work, based on the start you have made
in the nan_catch_test branch.</pre><br>
</blockquote><pre style="margin: 0em;"><br>I didn't think of using the __str__() function, you don't have to
ignore the message argument.  Also the else-if block isn't necessary
as you just need to pull out matches to BaseWarning.</pre><br>
<pre style="margin: 0em;">Chris, would you be able to revert the changes I made to the 1.2 line
(the RelaxErrorSystem stuff).  This experiment is a dead end so it
would be good to revert the changes to clean it up.  Then you could
either use the nan_catch_test branch or a new branch off 1.2 to try
out the warning system.</pre><br>
<pre style="margin: 0em;">I have to run off to the airport now,</pre><br>
<pre style="margin: 0em;">Edward</pre><br>
<br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00052" href="msg00052.html">RelaxWarnings and RelaxErrors.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00067" href="msg00067.html">Re: RelaxWarnings and RelaxErrors.</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00068" href="msg00068.html">Re: RelaxWarnings and RelaxErrors.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00069" href="msg00069.html">Re: RelaxWarnings and RelaxErrors.</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00070" href="msg00070.html">Re: RelaxWarnings and RelaxErrors.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00071" href="msg00071.html">RelaxWarnings</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00072" href="msg00072.html">Re: RelaxWarnings</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00074" href="msg00074.html">Re: RelaxWarnings</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00076" href="msg00076.html">Re: RelaxWarnings</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00079" href="msg00079.html">Re: RelaxWarnings</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Wed Aug 30 07:01:15 2006</div>  
</body>
</html>
