<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: model selection -->
<!--X-From-R13: Qyner&#45;Zbhvfr Sinaf <cpkpyrNabggvatunz.np.hx> -->
<!--X-Date: Mon, 30 Apr 2007 16:28:10 +0200 -->
<!--X-Message-Id: 4635FCEC.7050303@nottingham.ac.uk -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 1172829093.45e7f3a5c5ccd@imp2.webmail.hku.hk -->
<!--X-Reference: 7f080ed10703040822u588e9689r2faf47cfba37d021@mail.gmail.com -->
<!--X-Reference: 1177901186.4635588238653@imp4.webmail.hku.hk -->
<!--X-Reference: 4635F91A.9050704@nottingham.ac.uk -->
<!--X-Reference: 21DA0CF4&#45;86FB&#45;4D50&#45;94C9&#45;606EE70F42AB@gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: model selection -- April 30, 2007 - 16:28</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: model selection</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00010" class="tabs">Index by Date</a> | <a href="threads.html#00010" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00009.html">Date Prev</a>] [Date Next] [<a href="msg00009.html">Thread Prev</a>] [Thread Next]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: relax-users@xxxxxxx</li>
<li class="menuitem">
<em>Date</em>: Mon, 30 Apr 2007 15:27:56 +0100</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00010.html">4635FCEC.7050303@nottingham.ac.uk</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;1172829093.45e7f3a5c5ccd@xxxxxxxxxxxxxxxxxxx&gt;	&lt;7f080ed10703040822u588e9689r2faf47cfba37d021@xxxxxxxxxxxxxx&gt;	&lt;1177901186.4635588238653@xxxxxxxxxxxxxxxxxxx&gt;	&lt;4635F91A.9050704@xxxxxxxxxxxxxxxx&gt;	&lt;21DA0CF4-86FB-4D50-94C9-606EE70F42AB@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>User-agent</em>: Thunderbird 1.5.0.10 (Macintosh/20070221)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Clare-Louise Evans</strong> on April 30, 2007 - 16:28:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Dear Douglas,

</pre><tt>I kept getting this same error when I first tried using relax.  after 
</tt><tt>checking all the input formats, it turned out to be that it wasn't 
</tt><tt>finding the NH vectors because of the H atoms in my pdb.  I found simply 
</tt><tt>changing the HN atoms to H rectified this.  Whether this was the true 
</tt><tt>reason I'm unsure, but the error message stopped after I did this.
</tt><pre style="margin: 0em;">

Hope this helps.

Clare

Douglas Kojetin wrote:
</pre><blockquote class="blockquote"><tt>While we are on the topic of model selection/optimization, I am  
</tt><tt>having some trouble with relax 1.2's full_analysis.py script.  I have  
</tt><tt>optimized the local_tm run, and I ran the initial run on the oblate  
</tt><tt>tensor (init).  When I attempt to optimize the oblate run (round_1),  
</tt><tt>I see the following error a:
</tt><pre style="margin: 0em;">

</pre><tt>relax&gt; results.write(run='final', file='results', dir='oblate/round_1/ 
</tt><tt>aic', force=1, format='columnar', compress_type=1)Opening the file  
</tt><tt>'oblate/round_1/aic/results.bz2' for writing.RelaxError: The sequence  
</tt><tt>data for the run 'final' does not exist.
</tt><pre style="margin: 0em;">

Any ideas?

Thanks,
Doug


On Apr 30, 2007, at 10:11 AM, Clare-Louise Evans wrote:

</pre><tt>  
</tt><blockquote class="blockquote"><pre style="margin: 0em;">
Dear Edward,

Sorry for the thread hijack, but I noticed in the PS section of the
quote Hongyan has included below your comment regarding convergence.

I am having problems with convergence at the moment when running the
full_analysis.py script.  I have run the optimisation of the diffusion
models on the same PC.  For the oblate, prolate and ellipsoid models I
have failed to reach convergence after 30+ rounds.  The sphere model
</pre><tt>converged within 5 rounds.  However, when I look at the output the  
</tt><tt>only
</tt><tt>difference between the chi-squared and other parameter values is in  
</tt><tt>the
</tt><pre style="margin: 0em;">
10th and later decimal places.  Surely, with having such small
differences between the values they can be considered to have
converged.  However, in your comment you state they have to be
</pre><tt>identical.  If this really is the case then I'm not sure how to  
</tt><tt>proceed
</tt><pre style="margin: 0em;">
given that I'm failing to reach convergence on these 3 models?

Apologies if this ties in to the question I asked yesterday regarding
full_analysis.py.

Kind regards
Clare

Hongyan Li wrote:
</pre><tt>    
</tt><blockquote class="blockquote"><pre style="margin: 0em;">
Dear Edward,
</pre><tt>Thanks for your early suggestion regarding different model  
</tt><tt>selections. I have
</tt><tt>been busy on other stuff and only recently got time to focus on  
</tt><tt>this subject
</tt><pre style="margin: 0em;">
again.
</pre><tt>I have run all the diffusion models e.g. isotropic, prolate,  
</tt><tt>oblate and
</tt><tt>ellipsoid and model selections were made within each model (in aic  
</tt><tt>directory).
</tt><pre style="margin: 0em;">
I am not sure how to write a script to select different models using
'model_selection()'. Could you please do me a favor?
Your help is highly appreciated!
Best wishes,
Hongyan

Quoting Edward d'Auvergne &lt;edward.dauvergne@xxxxxxxxx&gt;:


</pre><tt>      
</tt><blockquote class="blockquote"><pre style="margin: 0em;">
Hi,

</pre><tt>To compare the results what you need to employ is a technique  
</tt><tt>from the
</tt><pre style="margin: 0em;">
statistical field of model selection.  The spherical diffusion
(isotropic) + all model-free models of all selected residues is one
</pre><tt>single mathematical model.  The prolate and oblate spheroids  
</tt><tt>(prolate
</tt><pre style="margin: 0em;">
and oblate axially symmetric anisotropic diffusion tensors) + all
model-free models, and the ellipsoid (fully anisotropic or three
different eigenvalues) + all model-free models, are three additional
</pre><tt>mathematical models.  Therefore to compare these four different  
</tt><tt>models
</tt><pre style="margin: 0em;">
you need to select the model which best represents your relaxation
data.  These models are, however, not nested and therefore cannot be
compared using ANOVA F-tests!  Firstly the three types of diffusion
tensor are not nested (there is a reference from Dominique Marion's
group in which they say ANOVA statistics cannot be used but I can't
find it at the moment (although it shouldn't be too hard to track
down, it's related to Tensor)).  Secondly the model-free models
</pre><tt>selected will be different between the four models.  Hence chi- 
</tt><tt>squared
</tt><pre style="margin: 0em;">
and F-tests cannot be used.

A useful reference (I'm not at all biased ;) for this problem is my
paper d'Auvergne, E. J. and Gooley, P. R. (2003), (see
<a  rel="nofollow" href="http://www.nmr-relax.com/refs.html">http://www.nmr-relax.com/refs.html</a> for the full reference).  On page
37 at the end of that paper I discuss how AIC model selection is
perfect for selecting between these non-nested models.  The AIC
criterion is still

AIC = chi2 + 2k,

</pre><tt>however chi2 is the minimised chi-squared value for the complete  
</tt><tt>model
</tt><pre style="margin: 0em;">
and k is the sum of the number of diffusion parameters and number of
model-free parameters for all spin systems.  BIC model selection is
likely to work quite well as well.  If you have four runs, one for
each of the diffusion models, then the relax user function
'model_selection()' is designed to select between these models.  I
hope this helps and hasn't been too biased.

Cheers,

Edward


P.S.  Prior to model selection between the diffusion models, the
diffusion models must have fully converged.  Multiple iterations of
optimisation of the model-free models, AIC model selection, and
</pre><tt>optimisation of all parameters together (diffusion tensor + model- 
</tt><tt>free
</tt><tt>parameter of all residues) must be executed.  Convergence is when  
</tt><tt>two
</tt><tt>iterations possess identical chi-squared values, identical model- 
</tt><tt>free
</tt><pre style="margin: 0em;">
models, and identical parameter values.


On 3/2/07, Hongyan Li &lt;hylichem@xxxxxxxxxxxx&gt; wrote:

</pre><tt>        
</tt><blockquote class="blockquote"><pre style="margin: 0em;">
Dear relax users,
</pre><tt>I have managed to use Relax to run my dynamics data by both  
</tt><tt>isotropic and
</tt><pre style="margin: 0em;">
axial-oblate models. My qestion is how to compare the results, by

</pre><tt>          
</tt></blockquote><pre style="margin: 0em;">
chi-square??

</pre><tt>        
</tt><blockquote class="blockquote"><pre style="margin: 0em;">
what is the criteria to make judgment that which residues is beter

</pre><tt>          
</tt></blockquote><pre style="margin: 0em;">
simulated

</pre><tt>        
</tt><blockquote class="blockquote"><pre style="margin: 0em;">
with which model?

Thanks for your kind help!

Best wishes,

Hongyan

Dr. Hongyan Li
Department of Chemistry
The University of Hong Kong
Pokfulam Road
Hong Kong


_______________________________________________
relax (<a  rel="nofollow" href="http://nmr-relax.com">http://nmr-relax.com</a>)

This is the relax-users mailing list
relax-users@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-users">https://mail.gna.org/listinfo/relax-users</a>


</pre><tt>          
</tt></blockquote></blockquote><pre style="margin: 0em;">
Dr. Hongyan Li
Department of Chemistry
The University of Hong Kong
Pokfulam Road
Hong Kong


_______________________________________________
relax (<a  rel="nofollow" href="http://nmr-relax.com">http://nmr-relax.com</a>)

This is the relax-users mailing list
relax-users@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-users">https://mail.gna.org/listinfo/relax-users</a>

</pre><tt>      
</tt></blockquote><tt>This message has been checked for viruses but the contents of an  
</tt><tt>attachment
</tt><tt>may still contain software viruses, which could damage your  
</tt><tt>computer system:
</tt><tt>you are advised to perform your own checks. Email communications  
</tt><tt>with the
</tt><tt>University of Nottingham may be monitored as permitted by UK  
</tt><tt>legislation.
</tt><pre style="margin: 0em;">


_______________________________________________
relax (<a  rel="nofollow" href="http://nmr-relax.com">http://nmr-relax.com</a>)

This is the relax-users mailing list
relax-users@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-users">https://mail.gna.org/listinfo/relax-users</a>
</pre><tt>    
</tt></blockquote><pre style="margin: 0em;">


_______________________________________________
relax (<a  rel="nofollow" href="http://nmr-relax.com">http://nmr-relax.com</a>)

This is the relax-users mailing list
relax-users@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-users">https://mail.gna.org/listinfo/relax-users</a>
</pre><tt>  
</tt></blockquote><pre style="margin: 0em;">

This message has been checked for viruses but the contents of an attachment
may still contain software viruses, which could damage your computer system:
you are advised to perform your own checks. Email communications with the
University of Nottingham may be monitored as permitted by UK legislation.



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00007" href="msg00007.html">model selection</a></strong>
<ul><li><em>From:</em> Hongyan Li</li></ul></li>
<li><strong><a name="00008" href="msg00008.html">Re: model selection</a></strong>
<ul><li><em>From:</em> Clare-Louise Evans</li></ul></li>
<li><strong><a name="00009" href="msg00009.html">Re: model selection</a></strong>
<ul><li><em>From:</em> Douglas Kojetin</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Mon Apr 30 16:40:28 2007</div>  
</body>
</html>
