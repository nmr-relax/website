<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: Relax_fit.py problem -->
<!--X-From-R13: Flyre Drqql <FDSRRKNqny.pn> -->
<!--X-Date: Thu, 16 Oct 2008 16:36:56 +0200 -->
<!--X-Message-Id: 20081016113014.jks67wg6218g4swo@my3.dal.ca -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20081008120727.ydgz29n4sf4gowww@my4.dal.ca -->
<!--X-Reference: 7f080ed10810080943g4228140ev43c8f481ccac0a37@mail.gmail.com -->
<!--X-Reference: 20081013144416.y8sycmhkxqg488og@my6.dal.ca -->
<!--X-Reference: 7f080ed10810141250y26c6889bu8686a3139d9d02bc@mail.gmail.com -->
<!--X-Reference: 20081015105356.9thn6ozzyxqwcsos@my5.dal.ca -->
<!--X-Reference: 7f080ed10810150803i61db919ia2c98e1774e71e18@mail.gmail.com -->
<!--X-Reference: 3b3f50350810151609g589b5caap24b4a9144ceddaa2@mail.gmail.com -->
<!--X-Reference: 7f080ed10810160057j3eb0387aj45ffa070f3c63b20@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Relax_fit.py problem -- October 16, 2008 - 16:36</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Relax_fit.py problem</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00048" class="tabs">Index by Date</a> | <a href="threads.html#00048" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00047.html">Date Prev</a>] [<a href="msg00049.html">Date Next</a>] [<a href="msg00043.html">Thread Prev</a>] [<a href="msg00049.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Edward d'Auvergne&quot; &lt;edward.dauvergne@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Thu, 16 Oct 2008 11:30:14 -0300</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-users@xxxxxxx&quot; &lt;relax-users@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00048.html">20081016113014.jks67wg6218g4swo@my3.dal.ca</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;20081008120727.ydgz29n4sf4gowww@xxxxxxxxxx&gt;	&lt;7f080ed10810080943g4228140ev43c8f481ccac0a37@xxxxxxxxxxxxxx&gt;	&lt;20081013144416.y8sycmhkxqg488og@xxxxxxxxxx&gt;	&lt;7f080ed10810141250y26c6889bu8686a3139d9d02bc@xxxxxxxxxxxxxx&gt;	&lt;20081015105356.9thn6ozzyxqwcsos@xxxxxxxxxx&gt;	&lt;7f080ed10810150803i61db919ia2c98e1774e71e18@xxxxxxxxxxxxxx&gt;	&lt;3b3f50350810151609g589b5caap24b4a9144ceddaa2@xxxxxxxxxxxxxx&gt;	&lt;7f080ed10810160057j3eb0387aj45ffa070f3c63b20@xxxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>User-agent</em>: Internet Messaging Program (IMP) H3 (4.0.3)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Tyler Reddy</strong> on October 16, 2008 - 16:36:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Hi,

So what I've been doing for NOE data is using the DSN command in vnmrj (which
gives S/N ratio) and then converting this to the rms value by RMSD = highest
peak/(S/N)

If I understand what is planned for the relax program, I would want rms values
for each of the T1 and T2 spectra at all field strengths, but I'm not sure if
it would be worthwhile to collect error information for the different delays
within a given spectrum (i.e. rms at 0.01 s and 0.05 s for a single spectrum).
In principle I would think it should be comparable, and I don't want to make
this unnecessarily complicated.

</pre><tt>In any case, do you have an estimate for how long it will take to 
</tt><tt>implement the
</tt><pre style="margin: 0em;">
base plane rms functionality for the curve-fitting portion of relax? If there
is something I can do to help feel free to let me know. Ultimately I'd like to
compare results from a few different programs, so if it will be a few weeks I
might try an alternate method first and then come back and compare the results
at various stages with relax. That said, I don't know if base plane rms will
</pre><tt>work from the get-go with any other packages, and a lot of the 
</tt><tt>alternatives may
</tt><pre style="margin: 0em;">
not be user friendly.

Tyler






Quoting Edward d'Auvergne &lt;edward.dauvergne@xxxxxxxxx&gt;:

</pre><blockquote class="blockquote"><pre style="margin: 0em;">
On Thu, Oct 16, 2008 at 1:09 AM, Chris MacRaild &lt;macraild@xxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">

Well, the Jackknife technique
(<a  rel="nofollow" href="http://en.wikipedia.org/wiki/Resampling_">http://en.wikipedia.org/wiki/Resampling_</a>(statistics)#Jackknife) does
something like this.  It uses the errors present inside the collected
data to estimate the parameter errors.  It's not great, but is useful
when errors cannot be measured.  You can also use the covariance
matrix from the optimisation space to estimate errors.  Both are rough
and approximate, and in convoluted spaces (the diffusion tensor space
and double motion model-free models of Clore et al., 1990) are known
to have problems.  Monte Carlo simulations perform much better in
complex spaces.

</pre></blockquote><pre style="margin: 0em;">

I have used (and extensively tested) Bootstrap resampling for this
problem. In my hands it works very well provided the data quality is
high (which of course it must be if the resulting values are to be of
any use in model-free analysis). In other words it gives errors
indistinguishable from those derived by Monte Carlo based on duplicate
spectra. Bootstraping, like Jacknife, does not depend on an estimate
of peak hight uncertainty. Its success presumably reflects the smooth
and simple optimisation space involved in an exponential fit to good
data - I fully expect it to fail if applied to the complex spaces of
model-free optimisation.
</pre></blockquote><pre style="margin: 0em;">

If someone would like bootstrapping for a certain technique, this
could added to relax without too much problem by duplicating the Monte
Carlo code and making slight modifications.  Implementing Jackknife or
the covariance matrix for error propagation would be more complex and
questionable as to its value.  Anyway, if it's not absolutely
necessary I will concentrate my efforts on getting Gary Thompson's
multi processor code functional (to run relax on clusters, grids, or
multi-cpu systems - see
<a  rel="nofollow" href="http://www.nmr-relax.com/mail.gna.org/public/relax-devel/2006-04/msg00023.html">https://mail.gna.org/public/relax-devel/2006-04/msg00023.html</a>).  And
the BMRB and CCPN integration (CCPN at
<a  rel="nofollow" href="http://www.nmr-relax.com/mail.gna.org/public/relax-devel/2007-11/msg00037.html">https://mail.gna.org/public/relax-devel/2007-11/msg00037.html</a>
continued at <a  rel="nofollow" href="http://www.nmr-relax.com/mail.gna.org/public/relax-devel/2007-12/msg00000.html">https://mail.gna.org/public/relax-devel/2007-12/msg00000.html</a>,
and BMRB at <a  rel="nofollow" href="http://www.nmr-relax.com/mail.gna.org/public/relax-devel/2008-07/msg00057.html">https://mail.gna.org/public/relax-devel/2008-07/msg00057.html</a>).

One question I have about the bootstrapping you used Chris is, how did
you get the errors for the variance of the Gaussian distributions used
to generate the bootstrapping samples?  The bootstrapping method I
know for error analysis is very similar to Monte Carlo simulations.
For Monte Carlo simulations you have:

1)  Fit the original data set to get the fitted parameter set (this
uses the original error set).
2)  Generate the back calculated data set from the fitted parameter set.
3)  Randomise n times, assuming a Gaussian distribution, the back
calculated data set using original error set.
4)  Fit the n Monte Carlo data sets as in 1).
5)  The values of 1) and standard deviation of 4) give the final
parameter values.

The bootstrapping technique for error analysis I am familiar with is:

1)  Fit the original data set to get the fitted parameter set (this
uses the original error set).
2)  N/A.
3)  Randomise n times, assuming a Gaussian distribution, the original
data set using original error set.
4)  Fit the n bootstrapped data sets as in 1).
5)  The values of 1) and standard deviation of 4) give the final
parameter values.

Is this how you implemented it?


</pre><blockquote class="blockquote"><pre style="margin: 0em;">
While on the topic, I can also confirm that baseline RMSD is a good
estimator of peak hight uncertainty. In my hands no sqrt(2) correction
is required. Interestingly, there seems to be no simple relationship
between baseline RMSD and peak volume uncertainty. I never managed to
understand why that is, but perhaps it is related to the behaviour of
noise under apodisation?
</pre></blockquote><pre style="margin: 0em;">

This is quite useful to know.  If you are using peak volumes for an
intensity measure and you don't have duplicate spectra, you could be
in trouble.  I have extensively played with noise and peak position
uncertainty in experiments and simulation and I would guess that for
volumes the problem is more than just the apodisation.  I think that
total spectral power; truncation; phasing; apodisation - which affects
error smoothing, truncation, peak intensity, spectral power, etc.;
zero filling (again related to spectral power); and window position
and size all have an effect here.  Well they do for the chemical shift
uncertainty in my simulations anyway - so much for Bax's LW/SN formula
for 2 coupled peaks!  This might require a full PhD project in
spectral processing to solve.

Btw, as I mentioned earlier in this thread there is still the bug in
relax's relaxation curve fitting where the standard deviations are
averaged rather than the variances!

Cheers,

Edward

</pre></blockquote><pre style="margin: 0em;">





</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00049" href="msg00049.html">Re: Relax_fit.py problem</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00016" href="msg00016.html">Relax_fit.py problem</a></strong>
<ul><li><em>From:</em> Tyler Reddy</li></ul></li>
<li><strong><a name="00019" href="msg00019.html">Re: Relax_fit.py problem</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00026" href="msg00026.html">Re: Relax_fit.py problem</a></strong>
<ul><li><em>From:</em> Tyler Reddy</li></ul></li>
<li><strong><a name="00027" href="msg00027.html">Re: Relax_fit.py problem</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00028" href="msg00028.html">Re: Relax_fit.py problem</a></strong>
<ul><li><em>From:</em> Tyler Reddy</li></ul></li>
<li><strong><a name="00030" href="msg00030.html">Re: Relax_fit.py problem</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00039" href="msg00039.html">Re: Relax_fit.py problem</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00043" href="msg00043.html">Re: Relax_fit.py problem</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu Oct 16 20:40:51 2008</div>  
</body>
</html>
