<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: r3237 &#45; in /branches/multi_processor: multi/mpi4py_processor.py	relax -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Mon, 19 Mar 2007 17:24:35 +0100 -->
<!--X-Message-Id: 7f080ed10703190923s4b09fab1vd958ed6001031b9c@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: E1HTJY1&#45;0005VF&#45;O1@subversion.gna.org -->
<!--X-Reference: 45FEAC46.8020307@bmb.leeds.ac.uk -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: r3237 - in /branches/multi_processor: multi/mpi4py_processor.py	relax -- March 19, 2007 - 17:24</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: r3237 - in /branches/multi_processor: multi/mpi4py_processor.py	relax</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00091" class="tabs">Index by Date</a> | <a href="threads.html#00091" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00090.html">Date Prev</a>] [<a href="msg00092.html">Date Next</a>] [<a href="msg00088.html">Thread Prev</a>] [<a href="msg00094.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Gary S. Thompson&quot; &lt;garyt@xxxxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Tue, 20 Mar 2007 03:23:51 +1100</li>
<li class="menuitem">
<em>Cc</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Dkim-signature</em>: a=rsa-sha1; c=relaxed/relaxed; d=gmail.com; s=beta;	h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:cc:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;	b=KuJM7s+AB9MYPLhIIbb2oQXGycX07eo52q+HZO2T12kX0nxo3HGC7Yt+GiYGjFLlrNLaXbQaeySXqcvon7bc+NtetDAlnZEWuRROyeWPpUy+CH40AkJCJfDoTD409+gBXoiFIWYmqghD4jTQodbrrrA7TPSDZwljxNZUOk59YA4=</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00091.html">7f080ed10703190923s4b09fab1vd958ed6001031b9c@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;E1HTJY1-0005VF-O1@subversion.gna.org&gt;	&lt;<a href="msg00088.html">45FEAC46.8020307@bmb.leeds.ac.uk</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on March 19, 2007 - 17:24:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi,</pre><br>
<pre style="margin: 0em;">Just a quick point, it would be good to either start a new thread for
these types of questions or changing the subject field (unless you use
the Gmail web interface like I am at the moment).  People may miss
important discussions with such scary subject lines!</pre><br>
<tt><br>On 3/20/07, Gary S. Thompson &lt;garyt@xxxxxxxxxxxxxxx&gt; wrote:
</tt><blockquote class="blockquote"><pre style="margin: 0em;">garyt@xxxxxxxxxxxxxxx wrote:</pre><br>
<pre style="margin: 0em;">Dear Ed
d this is a good enough point to tell you how to run things and what to
install for the mpi version i am testing with</pre><br>
<tt>I have installed mpipy and lam
</tt></blockquote><pre style="margin: 0em;"><br>Are both, together with mpi4py, essential for MPI operation?  As MPI
is solely for those who are very serious and have access to clusters,
the user should be able handle installing these dependencies (or at
least be able to get someone to install it for them).</pre><br>
<br>
<blockquote class="blockquote"><tt>lam should  be available in your linux distribution ??? ;-)
</tt></blockquote><pre style="margin: 0em;"><br>I'm using Mandriva so I would assume that it is within it's 'contrib'
repositories.  You are talking about <a  href="http://www.lam-mpi.org/">http://www.lam-mpi.org/</a> aren't
you?  As OpenMPI (<a  href="http://www.open-mpi.org/">http://www.open-mpi.org/</a>) seems to be the future of
that project, wouldn't this be the better option?  It's more likely to
be supported in future linux distros.</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">mpi4py came from <a  href="http://www.python.org/pypi/mpi4py">http://www.python.org/pypi/mpi4py</a> (there is an mpi4py
website but it is out of date, however, mpi4py is under recent development)
</pre></blockquote><pre style="margin: 0em;"><br>Do you think mpi4py 0.4 or below will be stable enough?  Are there 
alternatives?</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">follow the instructions to install mpi4py</pre><br>
<pre style="margin: 0em;">create the file  'test_multi1.py'</pre><br>
<pre style="margin: 0em;">-------------------8&lt;-----------------------
import multi
cmd  =  multi.mpi4py_processor.Get_name_command()
self.relax.processor.run_command(cmd)
-------------------8&lt;-----------------------</pre><br>
<pre style="margin: 0em;">then type lamboot</pre><br>
<pre style="margin: 0em;">and to run the test type:</pre><br>
<pre style="margin: 0em;">mpirun -np 6 python relax --multi mpi4py test_mult1.py</pre><br>
<pre style="margin: 0em;">to get:</pre><br>
<pre style="margin: 0em;">                                  relax repository checkout</pre><br>
<pre style="margin: 0em;">                          Protein dynamics by NMR relaxation data analysis</pre><br>
<pre style="margin: 0em;">                             Copyright (C) 2001-2006 Edward d'Auvergne</pre><br>
<pre style="margin: 0em;">This is free software which you are welcome to modify and redistribute
under the conditions of the
GNU General Public License (GPL).  This program, including all modules,
is licensed under the GPL
and comes with absolutely no warranty.  For details type 'GPL'.
Assistance in using this program
can be accessed by typing 'help'.</pre><br>
<pre style="margin: 0em;">script = 'test_mult1.py'
----------------------------------------------------------------------------------------------------
import sys</pre><br>
<pre style="margin: 0em;"><br>import multi
cmd  =  multi.mpi4py_processor.Get_name_command()
self.relax.processor.run_command(cmd)
----------------------------------------------------------------------------------------------------
1 fbsdpcu156-9377
2 fbsdpcu156-9378
3 fbsdpcu156-9379
4 fbsdpcu156-9380
5 fbsdpcu156-9381</pre><br>
</blockquote><pre style="margin: 0em;"><br>I'll have to play with this tomorrow.</pre><br>
<br>
<blockquote class="blockquote"><tt>hope this is useful!
</tt></blockquote><pre style="margin: 0em;"><br>I'm starting to get a better idea of how this will be implemented!</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">Now a question what is the best way to get an etrenally running relax
interpreter I can just fire commands at (for the slaves)?
</pre></blockquote><pre style="margin: 0em;"><br>The prompt based interface (as well as the script interface) is only
one way of invoking relax.  An important question is how should we
present relax to the user when using MPI.  Should the parent process
present a functional interpreter or should operation be solely
dictated by a script?  Or should a completely different mechanism of
operation be devised for the interface of the parent.  For the grid
computing code the parent UI is either the prompt or the script while
the slaves use the interface started by 'relax --thread'.  The slave
use none of the user functions and only really invoke the number
crunching code.</pre><br>
<pre style="margin: 0em;">For the MPI slaves (I'm assuming these are separate processes with
different PIDs running on different nodes) we should avoid the
standard UI interfaces as these are superfluous.  In this case a
simple MPI interface should probably be devised - it accepts the MPI
commands and returns data back to the parent.  Is this though stdin,
stdout, and stderr in MPI?  My knowledge of MPI is very limited.</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">basically I just need to</pre><br>
<pre style="margin: 0em;">1. do some setup
2. send a command object</pre><br>
<tt>but without quitting at the end of the script
</tt></blockquote><pre style="margin: 0em;"><br>If the prompt and scripting UI interface are not used by the slaves,
this shouldn't be an issue.  The parent should hang and wait at the
'grid_search()' and 'minimise()' user functions until these complete.
No other code needs to be executed by MPI.</pre><br>
<pre style="margin: 0em;">All that needs to be done is to send the minimal amount of data to the
slave (see the minimise() method of the specific_fns.model_free code
for the objects required in this case), run the specific optimisation
code, and then return the parameter vector and minimisation stats back
to the parent.</pre><br>
<br>
<blockquote class="blockquote"><pre style="margin: 0em;">do i modify interpreter.run to take a quit varaiable set to False  so
that run_script can be
run with quit = false?
</pre></blockquote><pre style="margin: 0em;"><br>Avoid the interpreter and wait at the optimisation steps - the only
serious number crunching code in relax.</pre><br>
<pre style="margin: 0em;">I hope this helps,</pre><br>
<pre style="margin: 0em;">Edward</pre><br>
<br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00094" href="msg00094.html">Re: r3237 - in /branches/multi_processor: multi/mpi4py_processor.py	relax</a></strong>
<ul><li><em>From:</em> Gary S. Thompson</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00088" href="msg00088.html">Re: r3237 - in /branches/multi_processor: multi/mpi4py_processor.py	relax</a></strong>
<ul><li><em>From:</em> Gary S. Thompson</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Tue Mar 20 00:40:31 2007</div>  
</body>
</html>
