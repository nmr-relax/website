<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [task #7415] Implement support for inversion&#45;recovery R1 curve fitting -->
<!--X-From-R13: "Sqjneq q'Ohiretar" &#60;rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Sun, 30 Nov 2014 11:01:04 +0100 -->
<!--X-Message-Id: CAED9pY9&#45;PpJeVn+TzSYFxgYj+1QU=cFQWSM5SG=FsgJ0yo6HCw@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20110615&#45;090536.sv7147.19419@gna.org -->
<!--X-Reference: 20110616&#45;055159.sv7147.36865@gna.org -->
<!--X-Reference: 20110620&#45;135218.sv7147.28621@gna.org -->
<!--X-Reference: 20130110&#45;152339.sv2782.96178@gna.org -->
<!--X-Reference: 20141126&#45;165021.sv2782.1841@gna.org -->
<!--X-Reference: 20141126&#45;165113.sv2782.56278@gna.org -->
<!--X-Reference: 20141126&#45;165345.sv2782.6803@gna.org -->
<!--X-Reference: 20141126&#45;165911.sv2782.12376@gna.org -->
<!--X-Reference: 20141126&#45;170916.sv2782.76586@gna.org -->
<!--X-Reference: 20141126&#45;171418.sv2782.64913@gna.org -->
<!--X-Reference: 20141126&#45;172007.sv2782.78262@gna.org -->
<!--X-Reference: 20141126&#45;211817.sv21648.32930@gna.org -->
<!--X-Reference: 20141127&#45;173513.sv21648.15293@gna.org -->
<!--X-Reference: 20141127&#45;181935.sv2782.56047@gna.org -->
<!--X-Reference: 20141127&#45;182054.sv2782.82339@gna.org -->
<!--X-Reference: 20141127&#45;182106.sv2782.95796@gna.org -->
<!--X-Reference: 20141128&#45;141455.sv21648.81198@gna.org -->
<!--X-Reference: 20141128&#45;173515.sv21648.57540@gna.org -->
<!--X-Reference: 20141130&#45;003338.sv2782.38617@gna.org -->
<!--X-Reference: 7C03ECAFB770DE43A2478DF9AF4819DFF69FE30979@ITCCRMAIL02.MED.HARVARD.EDU -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [task #7415] Implement support for inversion-recovery R1 curve fitting -- November 30, 2014 - 11:01</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: [task #7415] Implement support for inversion-recovery R1 curve fitting</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00101" class="tabs">Index by Date</a> | <a href="threads.html#00101" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00100.html">Date Prev</a>] [<a href="msg00102.html">Date Next</a>] [<a href="msg00100.html">Thread Prev</a>] [<a href="msg00043.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Boeszoermenyi, Andras&quot; &lt;Andras_Boeszoermenyi@xxxxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Sun, 30 Nov 2014 11:00:33 +0100</li>
<li class="menuitem">
<em>Cc</em>: Edward d Auvergne &lt;NO-REPLY.INVALID-ADDRESS@xxxxxxx&gt;, &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;, &quot;sebastien@xxxxxxxxxxxxx&quot; &lt;sebastien@xxxxxxxxxxxxx&gt;, Sébastien Morin &lt;sebastianomorino@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113; h=mime-version:sender:in-reply-to:references:date:message-id:subject :from:to:cc:content-type:content-transfer-encoding; bh=iaf1UF8ysFa6a10J07KmYR0pNj+14HuYLJfbCuKzeOI=; b=kFc7xKD8zAu8uunbuMZZ7LZC54XvgtPdGkQlOEEK6vUH1wf84KhN3Wu9fjrRYsNol4 aSRDUrmcvlpMywogS/PUK3JIbn+bOZed+cO1rSDrOFIawST6r+ut72FUSeN7VKE5QcxT xZf0z/GDUlxha8W4NaW0r25yG6W6vSMyJDINlC3h0TPwlMi0Oq4S0LnWkGymlzJXd/Jy 6h1fs49qPbZVQ1fhEFlpJv9axAODphjMgLt2BaeqhKIdbkzvZ9JYC+uJbcz2DBMgYKXK vmp40SdnBS+rrJS5BI9czxPJCddZDifDuoRjtO+hgr3hlRtxYU+V/hWC4+kwMtaz4jWq M0SQ==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;CAED9pY9-PpJeVn+TzSYFxgYj+1QU=cFQWSM5SG=FsgJ0yo6HCw@mail.gmail.com&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;20110615-090536.sv7147.19419@gna.org&gt; &lt;20110616-055159.sv7147.36865@gna.org&gt; &lt;20110620-135218.sv7147.28621@gna.org&gt; &lt;20130110-152339.sv2782.96178@gna.org&gt; &lt;<a href="msg00032.html">20141126-165021.sv2782.1841@gna.org</a>&gt; &lt;<a href="msg00033.html">20141126-165113.sv2782.56278@gna.org</a>&gt; &lt;<a href="msg00034.html">20141126-165345.sv2782.6803@gna.org</a>&gt; &lt;<a href="msg00035.html">20141126-165911.sv2782.12376@gna.org</a>&gt; &lt;<a href="msg00036.html">20141126-170916.sv2782.76586@gna.org</a>&gt; &lt;<a href="msg00037.html">20141126-171418.sv2782.64913@gna.org</a>&gt; &lt;<a href="msg00038.html">20141126-172007.sv2782.78262@gna.org</a>&gt; &lt;<a href="msg00040.html">20141126-211817.sv21648.32930@gna.org</a>&gt; &lt;<a href="msg00068.html">20141127-173513.sv21648.15293@gna.org</a>&gt; &lt;<a href="msg00073.html">20141127-181935.sv2782.56047@gna.org</a>&gt; &lt;<a href="msg00074.html">20141127-182054.sv2782.82339@gna.org</a>&gt; &lt;<a href="msg00075.html">20141127-182106.sv2782.95796@gna.org</a>&gt; &lt;<a href="msg00078.html">20141128-141455.sv21648.81198@gna.org</a>&gt; &lt;<a href="msg00089.html">20141128-173515.sv21648.57540@gna.org</a>&gt; &lt;<a href="msg00098.html">20141130-003338.sv2782.38617@gna.org</a>&gt; &lt;<a href="msg00100.html">7C03ECAFB770DE43A2478DF9AF4819DFF69FE30979@ITCCRMAIL02.MED.HARVARD.EDU</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on November 30, 2014 - 11:01:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi Andras,

No problems.  Due to the infrastructure changes since Sébastien
started the inversion-recovery branch, the new implementation took
less than a day.  It is not ideal from a programming perspective
though, as the code in the target_functions/relax_fit_wrapper.py
should really shift into the relax_fit.c module, as the C module can
and should provide all of this functionality.  But this is the part
where Séb got stuck - how to dynamically select between target
functions in the C code.  So it is really a short cut to finally get
this code running.

As for choosing your curve type, you can select the standard 2
parameter exponential (does this have a unique name, I don't
remember?), in which the peak starts positive at I0 and decays to zero
with:

relax_fit.select_model('exp')

Or the inversion recovery experiment whereby the peak is initially
negative at -I0 and decays to a positive Iinf value:

relax_fit.select_model('inv')

Or the saturation recovery experiment whereby the peak starts at 0 and
decays to a positive Iinf value:

relax_fit.select_model('sat')

Note that I have changed I0 to Iinf in the saturation recovery
experiment equation.  This is for internal parameter consistency in
relax, to match the other two models.  The saturation recovery
equation I(t) = Iinf*(1 - exp(-Rt)) was also not present in the
inversion-recovery branch, but that was easy to implement by copying
the target_functions/exponential.c file to exponential_sat.c and
changing all the value, gradient and Hessian functions for the
different equation.  Are there any other categories of exponential
relaxation experiment out there that do not fit into these three?

Regards,

Edward


On 30 November 2014 at 03:59, Boeszoermenyi, Andras
&lt;Andras_Boeszoermenyi@xxxxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Edward,

thanks a ton.

I have been testing the inversion recovery with real data and it does 
really well, but I would have one more question.

How would I call the saturation recovery experiment in 
relax_fit.select_model?

Best,
Andras
________________________________________
From: Edward d Auvergne [NO-REPLY.INVALID-ADDRESS@xxxxxxx]
Sent: Saturday, November 29, 2014 7:33 PM
To: Edward d Auvergne; Boeszoermenyi, Andras; Sébastien Morin; 
sebastien@xxxxxxxxxxxxx; Troels E. Linnet; relax-devel@xxxxxxx
Subject: [task #7415] Implement support for inversion-recovery R1 curve 
fitting

Update of task #7415 (project relax):

                  Status:               Postponed =&gt; Completed
        Percent Complete:                     50% =&gt; 100%
             Open/Closed:                    Open =&gt; Closed

    _______________________________________________________

Follow-up Comment #9:

This is now fully implemented in the relax trunk.  The system test
Relax_fit.test_inversion_recovery, based on the original inversion-recovery
branch and the relax_fit_exp_3param_inv_neg.py system test script, now 
passes.
 This demonstrates that the inversion recovery R1 curve-fitting is fully
functional.

The C code from the original branch was not used, as it was simpler to
duplicate the target_functions/exponential.c file to exponential_inv.c and
update function, gradient, and Hessian functions for the different curve 
type.
 The original code did not have gradient or Hessians implemented, as this is
relatively new for the curve-fitting analysis.

In addition, the saturation recovery model type has also been fully
implemented and a system test based on the attached files passes.

    _______________________________________________________

Reply to this item at:

  &lt;<a  rel="nofollow" href="http://gna.org/task/?7415">http://gna.org/task/?7415</a>&gt;

_______________________________________________
  Message sent via/by Gna!
  <a  rel="nofollow" href="http://gna.org/">http://gna.org/</a>
</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00032" href="msg00032.html">[task #7415] Implement support for inversion-recovery R1 curve fitting</a></strong>
<ul><li><em>From:</em> Edward d Auvergne</li></ul></li>
<li><strong><a name="00033" href="msg00033.html">[task #7415] Implement support for inversion-recovery R1 curve fitting</a></strong>
<ul><li><em>From:</em> Edward d Auvergne</li></ul></li>
<li><strong><a name="00034" href="msg00034.html">[task #7415] Implement support for inversion-recovery R1 curve fitting</a></strong>
<ul><li><em>From:</em> Edward d Auvergne</li></ul></li>
<li><strong><a name="00035" href="msg00035.html">[task #7415] Implement support for inversion-recovery R1 curve fitting</a></strong>
<ul><li><em>From:</em> Edward d Auvergne</li></ul></li>
<li><strong><a name="00036" href="msg00036.html">[task #7415] Implement support for inversion-recovery R1 curve fitting</a></strong>
<ul><li><em>From:</em> Edward d Auvergne</li></ul></li>
<li><strong><a name="00037" href="msg00037.html">[task #7415] Implement support for inversion-recovery R1 curve fitting</a></strong>
<ul><li><em>From:</em> Edward d Auvergne</li></ul></li>
<li><strong><a name="00038" href="msg00038.html">[task #7415] Implement support for inversion-recovery R1 curve fitting</a></strong>
<ul><li><em>From:</em> Edward d Auvergne</li></ul></li>
<li><strong><a name="00040" href="msg00040.html">[task #7415] Implement support for inversion-recovery R1 curve fitting</a></strong>
<ul><li><em>From:</em> Andras Boeszoermenyi</li></ul></li>
<li><strong><a name="00068" href="msg00068.html">[task #7415] Implement support for inversion-recovery R1 curve fitting</a></strong>
<ul><li><em>From:</em> Andras Boeszoermenyi</li></ul></li>
<li><strong><a name="00073" href="msg00073.html">[task #7415] Implement support for inversion-recovery R1 curve fitting</a></strong>
<ul><li><em>From:</em> Edward d Auvergne</li></ul></li>
<li><strong><a name="00074" href="msg00074.html">[task #7415] Implement support for inversion-recovery R1 curve fitting</a></strong>
<ul><li><em>From:</em> Edward d Auvergne</li></ul></li>
<li><strong><a name="00075" href="msg00075.html">[task #7415] Implement support for inversion-recovery R1 curve fitting</a></strong>
<ul><li><em>From:</em> Edward d Auvergne</li></ul></li>
<li><strong><a name="00078" href="msg00078.html">[task #7415] Implement support for inversion-recovery R1 curve fitting</a></strong>
<ul><li><em>From:</em> Andras Boeszoermenyi</li></ul></li>
<li><strong><a name="00089" href="msg00089.html">[task #7415] Implement support for inversion-recovery R1 curve fitting</a></strong>
<ul><li><em>From:</em> Andras Boeszoermenyi</li></ul></li>
<li><strong><a name="00098" href="msg00098.html">[task #7415] Implement support for inversion-recovery R1 curve fitting</a></strong>
<ul><li><em>From:</em> Edward d Auvergne</li></ul></li>
<li><strong><a name="00100" href="msg00100.html">RE: [task #7415] Implement support for inversion-recovery R1 curve fitting</a></strong>
<ul><li><em>From:</em> Boeszoermenyi, Andras</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Sun Nov 30 21:20:18 2014</div>  
</body>
</html>
