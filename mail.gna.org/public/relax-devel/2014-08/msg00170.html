<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: r25077 &#45; /trunk/docs/latex/dispersion.tex -->
<!--X-From-R13: "Sqjneq q'Ohiretar" &#60;rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Wed, 20 Aug 2014 09:35:28 +0200 -->
<!--X-Message-Id: CAED9pY_Oz0rStwsWxiWC1UtwV1VyFEkd76q11t0gHJRDmxVkfw@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: E1XJk4Y&#45;00056v&#45;8F@subversion.gna.org -->
<!--X-Reference: CA+CBx2Oi3dnRK8JNZ5b5RWZJQH14zD6pF&#45;y5nYbgZhGF1ykxzw@mail.gmail.com -->
<!--X-Reference: CAED9pY9H=NvdO+z_nSp75+yu1ya_Ryecnz&#45;b6DZmsjckocuPSg@mail.gmail.com -->
<!--X-Reference: CA+CBx2NNnpFjfOeactexpwMr45oJpHrCSYsoG=ROJBo96guHSw@mail.gmail.com -->
<!--X-Reference: CAED9pY9aT127qcHZtjdm95xAHSfK0=Ygyd21YeH3FZ_4jwfoeg@mail.gmail.com -->
<!--X-Reference: CA+CBx2OLSOSXndWxBbjpqgJX4=EkEe0dZqqtN+kWvR3R4svfcg@mail.gmail.com -->
<!--X-Reference: CA+CBx2O5&#45;bETmigYWO=BZrupvcakjqiM7kGy4yvtztkTuYbBQg@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: r25077 - /trunk/docs/latex/dispersion.tex -- August 20, 2014 - 09:35</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: r25077 - /trunk/docs/latex/dispersion.tex</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00170" class="tabs">Index by Date</a> | <a href="threads.html#00170" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00169.html">Date Prev</a>] [<a href="msg00171.html">Date Next</a>] [<a href="msg00169.html">Thread Prev</a>] [<a href="msg00171.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Wed, 20 Aug 2014 09:34:57 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113; h=mime-version:sender:in-reply-to:references:date:message-id:subject :from:to:cc:content-type:content-transfer-encoding; bh=iV0pXL9vLgkiW9rKMQnqcqLrCW7EHYERVjoCyx467eM=; b=GM/uYJEbmh5ldUTya12p2/kN4kDsAwaMZFuXWjKTpL/aY+qeOUe7cItiaARQDSO7SN e04YMCy/vvMGUZsGy92nwTZ2256NxsYKwxu3k2C3UbRCV54QLQmX1X61RYtYwuI2VArY Ng2UerYAHia9N3zdbDVoS2hWnAqHeecHtCv+tpqNvC51BOWW+kBqII02f5Kn9V7X5ZTw j3sri6M4wG0R6OhBZW7JwGOOdJqrsgjpBch14mBwlt6R7LAeyWK1NmKf2xvixwvtdUZ1 sp3JA2UhjSk4w14bECbKSIA/0izu7PuKj20BIvoHow0WwPWP9I4KVXqnetrIcawF9h0N a6ww==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00170.html">CAED9pY_Oz0rStwsWxiWC1UtwV1VyFEkd76q11t0gHJRDmxVkfw@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;E1XJk4Y-00056v-8F@subversion.gna.org&gt; &lt;<a href="msg00158.html">CA+CBx2Oi3dnRK8JNZ5b5RWZJQH14zD6pF-y5nYbgZhGF1ykxzw@mail.gmail.com</a>&gt; &lt;CAED9pY9H=NvdO+z_nSp75+yu1ya_Ryecnz-b6DZmsjckocuPSg@mail.gmail.com&gt; &lt;CA+CBx2NNnpFjfOeactexpwMr45oJpHrCSYsoG=ROJBo96guHSw@mail.gmail.com&gt; &lt;CAED9pY9aT127qcHZtjdm95xAHSfK0=Ygyd21YeH3FZ_4jwfoeg@mail.gmail.com&gt; &lt;CA+CBx2OLSOSXndWxBbjpqgJX4=EkEe0dZqqtN+kWvR3R4svfcg@mail.gmail.com&gt; &lt;CA+CBx2O5-bETmigYWO=BZrupvcakjqiM7kGy4yvtztkTuYbBQg@mail.gmail.com&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on August 20, 2014 - 09:35:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">I'm not sure what the best behaviour would be as we don't have much to
test against.  As all the parameters will be the same for AB and BC, I
don't think pB will change in a grid search.  Or it will change but
that pB and pC are convoluted together, as they represent the same
state as they have the same parameter values and you have an infinite
set of pB, pC solutions.  So maybe it is best to calculate it as you
said and hence set pC to zero to allow the two states to differentiate
during optimisation.  But I could be wrong.  As long as there is a
sentence in the auto-analysis part of the dispersion chapter of the
manual explaining the behaviour, either might be ok.

Cheers,

Edward



On 20 August 2014 09:27, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">I can also let it be.

One parameter left for Grid Search should be okay. :-)

Best
Troels

2014-08-19 18:44 GMT+02:00 Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt;:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">I can set it 1 - pA?

Best
Troels

2014-08-19 18:13 GMT+02:00 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">That would be the correct behaviour without optimisation.  Hmmm, what
was pB set to in this case originally?  Maybe we need to set pB to 0
to start with, and then let it optimise away from this.  What do you
think?

Regards,

Edward



On 19 August 2014 18:06, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt; 
wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Edward.

'r2', 'pA', 'dw', 'kex'

I then read this as:

        self.assertEqual(par_dic['r2'], 'r2')
        self.assertEqual(par_dic['pA'], 'pA')
        self.assertEqual(par_dic['dw_AB'], 'dw')
        self.assertEqual(par_dic['kex_AB'], 'kex')
        self.assertEqual(par_dic['pB'], None)
        self.assertEqual(par_dic['dw_BC'], 'dw')
        self.assertEqual(par_dic['kex_BC'], 'kex')
        self.assertEqual(par_dic['kex_AC'], 'kex')

Best
Troels

2014-08-19 17:42 GMT+02:00 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi,

I saw that the code has evolved to do this.  The original idea and
implementation was to set states B and C to the same values of the
2-state model parameters and then let them drift apart.  This was
mentioned in the manual.  This is not great, but the alternative of
performing a grid search on 'dw_AB', 'kex_AB', 'pB', 'dw_BC',
'kex_BC', 'kex_AC' is worse - this grid search is just impossibly long
if you choose a reasonable number of grid increments.  Being a
multi-minima problem also invalidates this.  The grid search and local
optimisation is only for single minimum problems.  When multiple
minima are present, then global algorithms are required (the main ones
are simulated annealing and genetic algorithms, neither of which are
present in minfx yet and hence relax).  Therefore setting B and C to
the same thing is not too unreasonable considering the alternative
issues.

The same thing was done for the '* full' models.  The value of R20 was
copied to R20A and R20B and then the two allowed to drift apart.  This
is also an incredibly difficult optimisation problem with possible
multiple minima.

There is no perfect solution for the R20A != R20B or 3-site models yet.

Regards,

Edward



On 19 August 2014 17:21, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt; 
wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Edward.


Just to confirm.

If the model is: MODEL_PARAMS_NS_R1RHO_3SITE
And the nested model is: MODEL_PARAMS_NS_R1RHO_2SITE

The possible parameters for conversion are:
        self.assertEqual(par_dic['r2'], 'r2')
        self.assertEqual(par_dic['pA'], 'pA')
        self.assertEqual(par_dic['dw_AB'], None)
        self.assertEqual(par_dic['kex_AB'], None)
        self.assertEqual(par_dic['pB'], None)
        self.assertEqual(par_dic['dw_BC'], None)
        self.assertEqual(par_dic['kex_BC'], None)
        self.assertEqual(par_dic['kex_AC'], None)

This means, that MODEL_PARAMS_NS_R1RHO_3SITE would start to Grid 
Search:
'dw_AB', 'kex_AB', 'pB', 'dw_BC', 'kex_BC', 'kex_AC'

Do we agree on this?

Best
Troels


---------- Forwarded message ----------
From:  &lt;edward@xxxxxxxxxxxxx&gt;
Date: 2014-08-19 16:07 GMT+02:00
Subject: r25077 - /trunk/docs/latex/dispersion.tex
To: relax-commits@xxxxxxx


Author: bugman
Date: Tue Aug 19 16:07:37 2014
New Revision: 25077

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=25077&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=25077&amp;view=rev</a>
Log:
Added a table for dispersion model nesting in the auto-analysis to the 
manual.

This adds the ideas discussed in the thread
<a  rel="nofollow" href="http://thread.gmane.org/gmane.science.nmr.relax.devel/6684">http://thread.gmane.org/gmane.science.nmr.relax.devel/6684</a>.


Modified:
    trunk/docs/latex/dispersion.tex

Modified: trunk/docs/latex/dispersion.tex
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/docs/latex/dispersion.tex?rev=25077&amp;r1=25076&amp;r2=25077&amp;view=diff">http://svn.gna.org/viewcvs/relax/trunk/docs/latex/dispersion.tex?rev=25077&amp;r1=25076&amp;r2=25077&amp;view=diff</a>
==============================================================================
--- trunk/docs/latex/dispersion.tex     (original)
+++ trunk/docs/latex/dispersion.tex     Tue Aug 19 16:07:37 2014
@@ -1689,8 +1689,9 @@
       For the cluster specific parameters, i.e.\ the populations of
the states and the exchange parameters, an average value will be used
as the starting point.
       For all other parameters, the $\Rtwozero$ values for each spin
and magnetic field, as well as the parameters related to the chemical
shift difference $\dw$, the optimised values of the previous run will
be directly copied.
     \item[Model nesting:]  If two models are nested, then the
parameters of the simpler will be used as the starting point for
optimisation of the more complex.
-      The currently supported nested model pairs are `LM63' and `LM63
3-site', `CR72' and `CR72 full', `CR72' and `MMQ CR72', `NS CPMG
2-site 3D' and `NS CPMG 2-site 3D full', and `NS CPMG 2-site star' and
`NS CPMG 2-site star full'.
-      In these cases, the $\RtwozeroA$ and $\RtwozeroB$ parameter
values are set to the simpler model $\Rtwozero$ value and the grid
search is bypassed.
+      The currently supported nested model sets are presented in
Table~\ref{table: dispersion model nesting} on page~\pageref{table:
dispersion model nesting}.
+      The models are optimised in the order presented in that table.
+      In some cases, the $\RtwozeroA$ and $\RtwozeroB$ parameter
values are set to the simpler model $\Rtwozero$ value and the grid
search is bypassed.
     \item[Model equivalence:]  When two models are equivalent, the
optimised parameters of one model can be used as the starting point of
the other rather than performing a grid search.
       This is used in the auto-analysis for avoiding the grid search
in the numeric models.
       The optimised `CR72' model is used for the `NS CPMG 2-site
expanded', `NS CPMG 2-site 3D', and  `NS CPMG 2-site star' models.
@@ -1722,6 +1723,103 @@
 If you are a power user, you are free to use all of the relax user
functions, the relax library, and the relax data store to implement
your own protocol.
 If you wish, the protocol can be converted into a new auto-analysis
and distributed as part of relax.
 The relax test suite will ensure the protocol remains functional for
the lifetime of relax.
+
+\begin{landscape}
+\begin{center}
+\begin{small}
+
+% The longtable environment.
+\begin{longtable}{ll}
+
+% Caption.
+\caption{Model nesting for the relaxation dispersion auto-analysis.}
+
+% Header.
+\\
+\toprule
+Model &amp; Nested models\footnotemark[1] \\
+\midrule
+\endhead
+
+% Footer.
+\bottomrule
+\endfoot
+
+% Label.
+\label{table: dispersion model nesting}
+
+
+% Experiment independent models.
+\\[-5pt]
+Base models \\
+\cline{1-1}
+$\Rtwoeff/\Ronerhoprime$         &amp; - \\
+No Rex                           &amp; - \\
+
+% CPMG-type models.
+\\[-5pt]
+Single quantum (SQ) CPMG-type \\
+\cline{1-1}
+LM63                             &amp; - \\
+LM63 3-site                      &amp; LM63 \\
+CR72                             &amp; NS CPMG 2-site 3D, NS CPMG 2-site
star, NS CPMG 2-site expanded, B14 \\
+CR72 full                        &amp; NS CPMG 2-site 3D full, NS CPMG
2-site star full, B14 full, NS CPMG 2-site 3D, \\
+                                 &amp; NS CPMG 2-site star, NS CPMG
2-site expanded, B14, CR72 \\
+IT99                             &amp; - \\
+TSMFK01                          &amp; - \\
+B14                              &amp; NS CPMG 2-site 3D, NS CPMG 2-site
star, NS CPMG 2-site expanded, CR72 \\
+B14 full                         &amp; NS CPMG 2-site 3D full, NS CPMG
2-site star full, CR72 full, NS CPMG 2-site 3D, \\
+                                 &amp; NS CPMG 2-site star, NS CPMG
2-site expanded, B14, CR72 \\
+NS CPMG 2-site expanded          &amp; NS CPMG 2-site 3D, NS CPMG 2-site
star, B14, CR72 \\
+NS CPMG 2-site 3D                &amp; NS CPMG 2-site star, NS CPMG
2-site expanded, B14, CR72 \\
+NS CPMG 2-site 3D full           &amp; NS CPMG 2-site star full, B14
full, CR72 full, NS CPMG 2-site 3D, NS CPMG 2-site star, \\
+                                 &amp; NS CPMG 2-site expanded, B14, CR72 
\\
+NS CPMG 2-site star              &amp; NS CPMG 2-site 3D, NS CPMG 2-site
expanded, B14, CR722 \\
+NS CPMG 2-site star full         &amp; NS CPMG 2-site 3D full, B14 full,
CR72 full, NS CPMG 2-site 3D, NS CPMG 2-site star, \\
+                                 &amp; NS CPMG 2-site expanded, B14, CR72 
\\
+
+% SQ, ZQ, DQ and MQ CPMG-type models.
+\\[-5pt]
+MMQ (SQ, ZQ, DQ, \&amp; MQ) CPMG-type \\
+\cline{1-1}
+MMQ CR72                         &amp; NS MMQ 2-site \\
+NS MMQ 2-site                    &amp; MMQ CR72 \\
+NS MMQ 3-site linear             &amp; NS MMQ 2-site, MMQ CR72 \\
+NS MMQ 3-site                    &amp; NS MMQ 3-site linear, NS MMQ
2-site, MMQ CR72 \\
+
+% R1rho-type models.
+\clearpage
+\\[-5pt]
+$\Ronerho$-type \\
+\cline{1-1}
+M61                              &amp; - \\
+M61 skew                         &amp; - \\
+DPL94                            &amp; - \\
+DPL94 $\Rone$ fit                &amp; DPL94 \\
+TP02                             &amp; MP05, TAP03 \\
+TP02 $\Rone$ fit                 &amp; MP05 $\Rone$ fit, TAP03 $\Rone$ 
fit \\
+TAP03                            &amp; MP05, TP02 \\
+TAP03 $\Rone$ fit                &amp; MP05 $\Rone$ fit, TP02 $\Rone$ fit 
\\
+MP05                             &amp; TAP03, TP02 \\
+MP05 $\Rone$ fit                 &amp; TAP03 $\Rone$ fit, TP02 $\Rone$ 
fit \\
+NS $\Ronerho$ 2-site             &amp; MP05, TAP03, TP02 \\
+NS $\Ronerho$ 2-site $\Rone$ fit &amp; MP05 $\Rone$ fit, TAP03 $\Rone$
fit, TP02 $\Rone$ fit \\
+NS $\Ronerho$ 3-site linear      &amp; NS $\Ronerho$ 2-site, MP05, TAP03, 
TP02 \\
+NS $\Ronerho$ 3-site             &amp; NS $\Ronerho$ 3-site linear, NS
$\Ronerho$ 2-site, MP05, TAP03, TP02 \\
+
+\footnotetext[1]{The nested models are ordered by preference.
+The earliest model in the list which has been optimised in the
auto-analysis will be used as the nested model.
+For example for the 'B14 full' model, the 'CR72 full' model is the
first preference, followed by 'B14', then the final fall back is
'CR72' is neither 'CR72 full' or 'B14' have been optimised.
+If none of the nested models have been optimised, the grid search
will be performed.
+In this example, 'CR72 full' is preferred as it has perfect parameter
nesting -- all parameters of 'B14 full' are found in 'CR72 full'.
+The B14 and CR72 are fallbacks, and for these R20A and R20B are
copied from R20 so they start optimisation as R20A == R20B.
+Hence 'CR72 full' whereby R20A != R20B is a much better starting
point as R20A and R20B have been optimised to different values.
+But because of the large model instability in the 'CR72 full' model,
you may wish to instead start with 'B14'.}
+
+\end{longtable}
+\end{small}
+\end{center}
+\end{landscape}


 % Dispersion curve insignificance.


_______________________________________________
relax (<a  rel="nofollow" href="/">http://www.nmr-relax.com</a>)

This is the relax-commits mailing list
relax-commits@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="/mail.gna.org/listinfo/relax-commits">https://mail.gna.org/listinfo/relax-commits</a>

_______________________________________________
relax (<a  rel="nofollow" href="/">http://www.nmr-relax.com</a>)

This is the relax-devel mailing list
relax-devel@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="/mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a>
</pre></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00171" href="msg00171.html">Re: r25077 - /trunk/docs/latex/dispersion.tex</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00158" href="msg00158.html">Fwd: r25077 - /trunk/docs/latex/dispersion.tex</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00159" href="msg00159.html">Re: r25077 - /trunk/docs/latex/dispersion.tex</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00164" href="msg00164.html">Re: r25077 - /trunk/docs/latex/dispersion.tex</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00165" href="msg00165.html">Re: r25077 - /trunk/docs/latex/dispersion.tex</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00167" href="msg00167.html">Re: r25077 - /trunk/docs/latex/dispersion.tex</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00169" href="msg00169.html">Re: r25077 - /trunk/docs/latex/dispersion.tex</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Wed Aug 20 12:40:13 2014</div>  
</body>
</html>
