<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>specific_analyses.relax_disp.api</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
  <!--Google analytics JS-->
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30096326-1']);
    _gaq.push(['_setDomainName', 'nmr-relax.com']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://www.nmr-relax.com">relax</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="specific_analyses-module.html">Package&nbsp;specific_analyses</a> ::
        <a href="specific_analyses.relax_disp-module.html">Package&nbsp;relax_disp</a> ::
        Module&nbsp;api
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="specific_analyses.relax_disp.api-pysrc.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<h1 class="epydoc">Source Code for <a href="specific_analyses.relax_disp.api-module.html">Module specific_analyses.relax_disp.api</a></h1>
<pre class="py-src">
<a name="L1"></a><tt class="py-lineno">   1</tt>  <tt class="py-line"><tt class="py-comment">###############################################################################</tt> </tt>
<a name="L2"></a><tt class="py-lineno">   2</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L3"></a><tt class="py-lineno">   3</tt>  <tt class="py-line"><tt class="py-comment"># Copyright (C) 2004-2014 Edward d'Auvergne                                   #</tt> </tt>
<a name="L4"></a><tt class="py-lineno">   4</tt>  <tt class="py-line"><tt class="py-comment"># Copyright (C) 2009 Sebastien Morin                                          #</tt> </tt>
<a name="L5"></a><tt class="py-lineno">   5</tt>  <tt class="py-line"><tt class="py-comment"># Copyright (C) 2013-2014 Troels E. Linnet                                    #</tt> </tt>
<a name="L6"></a><tt class="py-lineno">   6</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L7"></a><tt class="py-lineno">   7</tt>  <tt class="py-line"><tt class="py-comment"># This file is part of the program relax (http://www.nmr-relax.com).          #</tt> </tt>
<a name="L8"></a><tt class="py-lineno">   8</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L9"></a><tt class="py-lineno">   9</tt>  <tt class="py-line"><tt class="py-comment"># This program is free software: you can redistribute it and/or modify        #</tt> </tt>
<a name="L10"></a><tt class="py-lineno">  10</tt>  <tt class="py-line"><tt class="py-comment"># it under the terms of the GNU General Public License as published by        #</tt> </tt>
<a name="L11"></a><tt class="py-lineno">  11</tt>  <tt class="py-line"><tt class="py-comment"># the Free Software Foundation, either version 3 of the License, or           #</tt> </tt>
<a name="L12"></a><tt class="py-lineno">  12</tt>  <tt class="py-line"><tt class="py-comment"># (at your option) any later version.                                         #</tt> </tt>
<a name="L13"></a><tt class="py-lineno">  13</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L14"></a><tt class="py-lineno">  14</tt>  <tt class="py-line"><tt class="py-comment"># This program is distributed in the hope that it will be useful,             #</tt> </tt>
<a name="L15"></a><tt class="py-lineno">  15</tt>  <tt class="py-line"><tt class="py-comment"># but WITHOUT ANY WARRANTY; without even the implied warranty of              #</tt> </tt>
<a name="L16"></a><tt class="py-lineno">  16</tt>  <tt class="py-line"><tt class="py-comment"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the               #</tt> </tt>
<a name="L17"></a><tt class="py-lineno">  17</tt>  <tt class="py-line"><tt class="py-comment"># GNU General Public License for more details.                                #</tt> </tt>
<a name="L18"></a><tt class="py-lineno">  18</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L19"></a><tt class="py-lineno">  19</tt>  <tt class="py-line"><tt class="py-comment"># You should have received a copy of the GNU General Public License           #</tt> </tt>
<a name="L20"></a><tt class="py-lineno">  20</tt>  <tt class="py-line"><tt class="py-comment"># along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.       #</tt> </tt>
<a name="L21"></a><tt class="py-lineno">  21</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L22"></a><tt class="py-lineno">  22</tt>  <tt class="py-line"><tt class="py-comment">###############################################################################</tt> </tt>
<a name="L23"></a><tt class="py-lineno">  23</tt>  <tt class="py-line"> </tt>
<a name="L24"></a><tt class="py-lineno">  24</tt>  <tt class="py-line"><tt class="py-comment"># Module docstring.</tt> </tt>
<a name="L25"></a><tt class="py-lineno">  25</tt>  <tt class="py-line"><tt class="py-docstring">"""The relaxation dispersion API object."""</tt> </tt>
<a name="L26"></a><tt class="py-lineno">  26</tt>  <tt class="py-line"> </tt>
<a name="L27"></a><tt class="py-lineno">  27</tt>  <tt class="py-line"><tt class="py-comment"># Python module imports.</tt> </tt>
<a name="L28"></a><tt class="py-lineno">  28</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt id="link-0" class="py-name" targets="Package bmrblib=bmrblib-module.html"><a title="bmrblib" class="py-name" href="#" onclick="return doclink('link-0', 'bmrblib', 'link-0');">bmrblib</a></tt> </tt>
<a name="L29"></a><tt class="py-lineno">  29</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-1" class="py-name" targets="Function pipe_control.align_tensor.copy()=pipe_control.align_tensor-module.html#copy,Function pipe_control.diffusion_tensor.copy()=pipe_control.diffusion_tensor-module.html#copy,Function pipe_control.interatomic.copy()=pipe_control.interatomic-module.html#copy,Function pipe_control.j_coupling.copy()=pipe_control.j_coupling-module.html#copy,Function pipe_control.pcs.copy()=pipe_control.pcs-module.html#copy,Function pipe_control.pipes.copy()=pipe_control.pipes-module.html#copy,Function pipe_control.rdc.copy()=pipe_control.rdc-module.html#copy,Function pipe_control.relax_data.copy()=pipe_control.relax_data-module.html#copy,Function pipe_control.sequence.copy()=pipe_control.sequence-module.html#copy,Function pipe_control.value.copy()=pipe_control.value-module.html#copy,Function specific_analyses.relax_disp.parameters.copy()=specific_analyses.relax_disp.parameters-module.html#copy"><a title="pipe_control.align_tensor.copy
pipe_control.diffusion_tensor.copy
pipe_control.interatomic.copy
pipe_control.j_coupling.copy
pipe_control.pcs.copy
pipe_control.pipes.copy
pipe_control.rdc.copy
pipe_control.relax_data.copy
pipe_control.sequence.copy
pipe_control.value.copy
specific_analyses.relax_disp.parameters.copy" class="py-name" href="#" onclick="return doclink('link-1', 'copy', 'link-1');">copy</a></tt> <tt class="py-keyword">import</tt> <tt class="py-name">deepcopy</tt> </tt>
<a name="L30"></a><tt class="py-lineno">  30</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">numpy</tt> <tt class="py-keyword">import</tt> <tt class="py-name">int32</tt><tt class="py-op">,</tt> <tt class="py-name">zeros</tt> </tt>
<a name="L31"></a><tt class="py-lineno">  31</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">re</tt> <tt class="py-keyword">import</tt> <tt class="py-name">match</tt><tt class="py-op">,</tt> <tt id="link-2" class="py-name" targets="Function lib.regex.search()=lib.regex-module.html#search"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-2', 'search', 'link-2');">search</a></tt> </tt>
<a name="L32"></a><tt class="py-lineno">  32</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt id="link-3" class="py-name" targets="Module lib.text.string=lib.text.string-module.html"><a title="lib.text.string" class="py-name" href="#" onclick="return doclink('link-3', 'string', 'link-3');">string</a></tt> </tt>
<a name="L33"></a><tt class="py-lineno">  33</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">sys</tt> </tt>
<a name="L34"></a><tt class="py-lineno">  34</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">types</tt> <tt class="py-keyword">import</tt> <tt class="py-name">MethodType</tt> </tt>
<a name="L35"></a><tt class="py-lineno">  35</tt>  <tt class="py-line"> </tt>
<a name="L36"></a><tt class="py-lineno">  36</tt>  <tt class="py-line"><tt class="py-comment"># relax module imports.</tt> </tt>
<a name="L37"></a><tt class="py-lineno">  37</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-4" class="py-name" targets="Package lib=lib-module.html"><a title="lib" class="py-name" href="#" onclick="return doclink('link-4', 'lib', 'link-4');">lib</a></tt><tt class="py-op">.</tt><tt id="link-5" class="py-name" targets="Module lib.arg_check=lib.arg_check-module.html"><a title="lib.arg_check" class="py-name" href="#" onclick="return doclink('link-5', 'arg_check', 'link-5');">arg_check</a></tt> <tt class="py-keyword">import</tt> <tt id="link-6" class="py-name" targets="Function lib.arg_check.is_list()=lib.arg_check-module.html#is_list,Function lib.check_types.is_list()=lib.check_types-module.html#is_list"><a title="lib.arg_check.is_list
lib.check_types.is_list" class="py-name" href="#" onclick="return doclink('link-6', 'is_list', 'link-6');">is_list</a></tt><tt class="py-op">,</tt> <tt id="link-7" class="py-name" targets="Function lib.arg_check.is_str_list()=lib.arg_check-module.html#is_str_list"><a title="lib.arg_check.is_str_list" class="py-name" href="#" onclick="return doclink('link-7', 'is_str_list', 'link-7');">is_str_list</a></tt> </tt>
<a name="L38"></a><tt class="py-lineno">  38</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-8" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-8', 'lib', 'link-4');">lib</a></tt><tt class="py-op">.</tt><tt id="link-9" class="py-name" targets="Package lib.dispersion=lib.dispersion-module.html"><a title="lib.dispersion" class="py-name" href="#" onclick="return doclink('link-9', 'dispersion', 'link-9');">dispersion</a></tt><tt class="py-op">.</tt><tt id="link-10" class="py-name" targets="Module lib.dispersion.variables=lib.dispersion.variables-module.html"><a title="lib.dispersion.variables" class="py-name" href="#" onclick="return doclink('link-10', 'variables', 'link-10');">variables</a></tt> <tt class="py-keyword">import</tt> <tt id="link-11" class="py-name" targets="Variable lib.dispersion.variables.EXP_TYPE_CPMG_PROTON_MQ=lib.dispersion.variables-module.html#EXP_TYPE_CPMG_PROTON_MQ"><a title="lib.dispersion.variables.EXP_TYPE_CPMG_PROTON_MQ" class="py-name" href="#" onclick="return doclink('link-11', 'EXP_TYPE_CPMG_PROTON_MQ', 'link-11');">EXP_TYPE_CPMG_PROTON_MQ</a></tt><tt class="py-op">,</tt> <tt id="link-12" class="py-name" targets="Variable lib.dispersion.variables.EXP_TYPE_CPMG_PROTON_SQ=lib.dispersion.variables-module.html#EXP_TYPE_CPMG_PROTON_SQ"><a title="lib.dispersion.variables.EXP_TYPE_CPMG_PROTON_SQ" class="py-name" href="#" onclick="return doclink('link-12', 'EXP_TYPE_CPMG_PROTON_SQ', 'link-12');">EXP_TYPE_CPMG_PROTON_SQ</a></tt><tt class="py-op">,</tt> <tt id="link-13" class="py-name" targets="Variable lib.dispersion.variables.MODEL_LIST_MMQ=lib.dispersion.variables-module.html#MODEL_LIST_MMQ"><a title="lib.dispersion.variables.MODEL_LIST_MMQ" class="py-name" href="#" onclick="return doclink('link-13', 'MODEL_LIST_MMQ', 'link-13');">MODEL_LIST_MMQ</a></tt><tt class="py-op">,</tt> <tt id="link-14" class="py-name" targets="Variable lib.dispersion.variables.MODEL_R2EFF=lib.dispersion.variables-module.html#MODEL_R2EFF"><a title="lib.dispersion.variables.MODEL_R2EFF" class="py-name" href="#" onclick="return doclink('link-14', 'MODEL_R2EFF', 'link-14');">MODEL_R2EFF</a></tt><tt class="py-op">,</tt> <tt id="link-15" class="py-name" targets="Variable lib.dispersion.variables.PARAMS_R20=lib.dispersion.variables-module.html#PARAMS_R20"><a title="lib.dispersion.variables.PARAMS_R20" class="py-name" href="#" onclick="return doclink('link-15', 'PARAMS_R20', 'link-15');">PARAMS_R20</a></tt> </tt>
<a name="L39"></a><tt class="py-lineno">  39</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-16" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-16', 'lib', 'link-4');">lib</a></tt><tt class="py-op">.</tt><tt id="link-17" class="py-name" targets="Module gui.errors=gui.errors-module.html,Module lib.errors=lib.errors-module.html,Module minfx.errors=minfx.errors-module.html"><a title="gui.errors
lib.errors
minfx.errors" class="py-name" href="#" onclick="return doclink('link-17', 'errors', 'link-17');">errors</a></tt> <tt class="py-keyword">import</tt> <tt id="link-18" class="py-name" targets="Class lib.errors.RelaxError=lib.errors.RelaxError-class.html"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-18', 'RelaxError', 'link-18');">RelaxError</a></tt><tt class="py-op">,</tt> <tt id="link-19" class="py-name" targets="Class lib.errors.RelaxImplementError=lib.errors.RelaxImplementError-class.html"><a title="lib.errors.RelaxImplementError" class="py-name" href="#" onclick="return doclink('link-19', 'RelaxImplementError', 'link-19');">RelaxImplementError</a></tt> </tt>
<a name="L40"></a><tt class="py-lineno">  40</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-20" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-20', 'lib', 'link-4');">lib</a></tt><tt class="py-op">.</tt><tt id="link-21" class="py-name" targets="Module lib.selection=lib.selection-module.html,Method lib.structure.internal.object.Internal.selection()=lib.structure.internal.object.Internal-class.html#selection,Module lib.structure.internal.selection=lib.structure.internal.selection-module.html,Module pipe_control.selection=pipe_control.selection-module.html,Module test_suite.system_tests.selection=test_suite.system_tests.selection-module.html"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-21', 'selection', 'link-21');">selection</a></tt> <tt class="py-keyword">import</tt> <tt id="link-22" class="py-name" targets="Class lib.selection.Selection=lib.selection.Selection-class.html,Class test_suite.system_tests.selection.Selection=test_suite.system_tests.selection.Selection-class.html"><a title="lib.selection.Selection
test_suite.system_tests.selection.Selection" class="py-name" href="#" onclick="return doclink('link-22', 'Selection', 'link-22');">Selection</a></tt><tt class="py-op">,</tt> <tt id="link-23" class="py-name" targets="Function lib.selection.tokenise()=lib.selection-module.html#tokenise"><a title="lib.selection.tokenise" class="py-name" href="#" onclick="return doclink('link-23', 'tokenise', 'link-23');">tokenise</a></tt> </tt>
<a name="L41"></a><tt class="py-lineno">  41</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-24" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-24', 'lib', 'link-4');">lib</a></tt><tt class="py-op">.</tt><tt id="link-25" class="py-name" targets="Package lib.text=lib.text-module.html,Variable prompt.help._Helper.text=prompt.help._Helper-class.html#text,Variable prompt.help._Helper_python.text=prompt.help._Helper_python-class.html#text,Variable user_functions.molecule.text=user_functions.molecule-module.html#text"><a title="lib.text
prompt.help._Helper.text
prompt.help._Helper_python.text
user_functions.molecule.text" class="py-name" href="#" onclick="return doclink('link-25', 'text', 'link-25');">text</a></tt><tt class="py-op">.</tt><tt id="link-26" class="py-name" targets="Module lib.text.sectioning=lib.text.sectioning-module.html"><a title="lib.text.sectioning" class="py-name" href="#" onclick="return doclink('link-26', 'sectioning', 'link-26');">sectioning</a></tt> <tt class="py-keyword">import</tt> <tt id="link-27" class="py-name" targets="Function lib.text.sectioning.subsection()=lib.text.sectioning-module.html#subsection"><a title="lib.text.sectioning.subsection" class="py-name" href="#" onclick="return doclink('link-27', 'subsection', 'link-27');">subsection</a></tt> </tt>
<a name="L42"></a><tt class="py-lineno">  42</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-28" class="py-name" targets="Package multi=multi-module.html"><a title="multi" class="py-name" href="#" onclick="return doclink('link-28', 'multi', 'link-28');">multi</a></tt> <tt class="py-keyword">import</tt> <tt id="link-29" class="py-name" targets="Class multi.Processor_box=multi.Processor_box-class.html"><a title="multi.Processor_box" class="py-name" href="#" onclick="return doclink('link-29', 'Processor_box', 'link-29');">Processor_box</a></tt> </tt>
<a name="L43"></a><tt class="py-lineno">  43</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-30" class="py-name" targets="Package pipe_control=pipe_control-module.html"><a title="pipe_control" class="py-name" href="#" onclick="return doclink('link-30', 'pipe_control', 'link-30');">pipe_control</a></tt> <tt class="py-keyword">import</tt> <tt id="link-31" class="py-name" targets="Module pipe_control.pipes=pipe_control.pipes-module.html,Module test_suite.gui_tests.pipes=test_suite.gui_tests.pipes-module.html,Module test_suite.system_tests.pipes=test_suite.system_tests.pipes-module.html"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-31', 'pipes', 'link-31');">pipes</a></tt><tt class="py-op">,</tt> <tt id="link-32" class="py-name" targets="Module gui.components.relax_data=gui.components.relax_data-module.html,Module pipe_control.relax_data=pipe_control.relax_data-module.html,Module test_suite.system_tests.relax_data=test_suite.system_tests.relax_data-module.html,Module user_functions.relax_data=user_functions.relax_data-module.html"><a title="gui.components.relax_data
pipe_control.relax_data
test_suite.system_tests.relax_data
user_functions.relax_data" class="py-name" href="#" onclick="return doclink('link-32', 'relax_data', 'link-32');">relax_data</a></tt><tt class="py-op">,</tt> <tt id="link-33" class="py-name" targets="Module gui.input_elements.sequence=gui.input_elements.sequence-module.html,Module lib.sequence=lib.sequence-module.html,Module pipe_control.sequence=pipe_control.sequence-module.html,Module test_suite.system_tests.sequence=test_suite.system_tests.sequence-module.html,Module user_functions.sequence=user_functions.sequence-module.html"><a title="gui.input_elements.sequence
lib.sequence
pipe_control.sequence
test_suite.system_tests.sequence
user_functions.sequence" class="py-name" href="#" onclick="return doclink('link-33', 'sequence', 'link-33');">sequence</a></tt> </tt>
<a name="L44"></a><tt class="py-lineno">  44</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-34" class="py-name"><a title="pipe_control" class="py-name" href="#" onclick="return doclink('link-34', 'pipe_control', 'link-30');">pipe_control</a></tt><tt class="py-op">.</tt><tt id="link-35" class="py-name" targets="Module data_store.exp_info=data_store.exp_info-module.html,Module pipe_control.exp_info=pipe_control.exp_info-module.html"><a title="data_store.exp_info
pipe_control.exp_info" class="py-name" href="#" onclick="return doclink('link-35', 'exp_info', 'link-35');">exp_info</a></tt> <tt class="py-keyword">import</tt> <tt id="link-36" class="py-name" targets="Function pipe_control.exp_info.bmrb_write_citations()=pipe_control.exp_info-module.html#bmrb_write_citations"><a title="pipe_control.exp_info.bmrb_write_citations" class="py-name" href="#" onclick="return doclink('link-36', 'bmrb_write_citations', 'link-36');">bmrb_write_citations</a></tt><tt class="py-op">,</tt> <tt id="link-37" class="py-name" targets="Function pipe_control.exp_info.bmrb_write_methods()=pipe_control.exp_info-module.html#bmrb_write_methods"><a title="pipe_control.exp_info.bmrb_write_methods" class="py-name" href="#" onclick="return doclink('link-37', 'bmrb_write_methods', 'link-37');">bmrb_write_methods</a></tt><tt class="py-op">,</tt> <tt id="link-38" class="py-name" targets="Function pipe_control.exp_info.bmrb_write_software()=pipe_control.exp_info-module.html#bmrb_write_software"><a title="pipe_control.exp_info.bmrb_write_software" class="py-name" href="#" onclick="return doclink('link-38', 'bmrb_write_software', 'link-38');">bmrb_write_software</a></tt> </tt>
<a name="L45"></a><tt class="py-lineno">  45</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-39" class="py-name"><a title="pipe_control" class="py-name" href="#" onclick="return doclink('link-39', 'pipe_control', 'link-30');">pipe_control</a></tt><tt class="py-op">.</tt><tt id="link-40" class="py-name" targets="Module data_store.mol_res_spin=data_store.mol_res_spin-module.html,Module pipe_control.mol_res_spin=pipe_control.mol_res_spin-module.html,Module test_suite.system_tests.mol_res_spin=test_suite.system_tests.mol_res_spin-module.html"><a title="data_store.mol_res_spin
pipe_control.mol_res_spin
test_suite.system_tests.mol_res_spin" class="py-name" href="#" onclick="return doclink('link-40', 'mol_res_spin', 'link-40');">mol_res_spin</a></tt> <tt class="py-keyword">import</tt> <tt id="link-41" class="py-name" targets="Function pipe_control.mol_res_spin.bmrb_write_entity()=pipe_control.mol_res_spin-module.html#bmrb_write_entity"><a title="pipe_control.mol_res_spin.bmrb_write_entity" class="py-name" href="#" onclick="return doclink('link-41', 'bmrb_write_entity', 'link-41');">bmrb_write_entity</a></tt><tt class="py-op">,</tt> <tt id="link-42" class="py-name" targets="Function pipe_control.mol_res_spin.check_mol_res_spin_data()=pipe_control.mol_res_spin-module.html#check_mol_res_spin_data"><a title="pipe_control.mol_res_spin.check_mol_res_spin_data" class="py-name" href="#" onclick="return doclink('link-42', 'check_mol_res_spin_data', 'link-42');">check_mol_res_spin_data</a></tt><tt class="py-op">,</tt> <tt id="link-43" class="py-name" targets="Function pipe_control.mol_res_spin.get_molecule_names()=pipe_control.mol_res_spin-module.html#get_molecule_names"><a title="pipe_control.mol_res_spin.get_molecule_names" class="py-name" href="#" onclick="return doclink('link-43', 'get_molecule_names', 'link-43');">get_molecule_names</a></tt><tt class="py-op">,</tt> <tt id="link-44" class="py-name" targets="Function pipe_control.mol_res_spin.return_spin()=pipe_control.mol_res_spin-module.html#return_spin"><a title="pipe_control.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-44', 'return_spin', 'link-44');">return_spin</a></tt><tt class="py-op">,</tt> <tt id="link-45" class="py-name" targets="Function pipe_control.mol_res_spin.spin_loop()=pipe_control.mol_res_spin-module.html#spin_loop"><a title="pipe_control.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-45', 'spin_loop', 'link-45');">spin_loop</a></tt> </tt>
<a name="L46"></a><tt class="py-lineno">  46</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-46" class="py-name"><a title="pipe_control" class="py-name" href="#" onclick="return doclink('link-46', 'pipe_control', 'link-30');">pipe_control</a></tt><tt class="py-op">.</tt><tt id="link-47" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-47', 'pipes', 'link-31');">pipes</a></tt> <tt class="py-keyword">import</tt> <tt id="link-48" class="py-name" targets="Variable pipe_control.pipes.check_pipe=pipe_control.pipes-module.html#check_pipe"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-48', 'check_pipe', 'link-48');">check_pipe</a></tt> </tt>
<a name="L47"></a><tt class="py-lineno">  47</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-49" class="py-name"><a title="pipe_control" class="py-name" href="#" onclick="return doclink('link-49', 'pipe_control', 'link-30');">pipe_control</a></tt><tt class="py-op">.</tt><tt id="link-50" class="py-name" targets="Module pipe_control.spectrometer=pipe_control.spectrometer-module.html,Module user_functions.spectrometer=user_functions.spectrometer-module.html"><a title="pipe_control.spectrometer
user_functions.spectrometer" class="py-name" href="#" onclick="return doclink('link-50', 'spectrometer', 'link-50');">spectrometer</a></tt> <tt class="py-keyword">import</tt> <tt id="link-51" class="py-name" targets="Variable pipe_control.spectrometer.check_spectrometer_setup=pipe_control.spectrometer-module.html#check_spectrometer_setup"><a title="pipe_control.spectrometer.check_spectrometer_setup" class="py-name" href="#" onclick="return doclink('link-51', 'check_spectrometer_setup', 'link-51');">check_spectrometer_setup</a></tt> </tt>
<a name="L48"></a><tt class="py-lineno">  48</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-52" class="py-name"><a title="pipe_control" class="py-name" href="#" onclick="return doclink('link-52', 'pipe_control', 'link-30');">pipe_control</a></tt><tt class="py-op">.</tt><tt id="link-53" class="py-name"><a title="gui.input_elements.sequence
lib.sequence
pipe_control.sequence
test_suite.system_tests.sequence
user_functions.sequence" class="py-name" href="#" onclick="return doclink('link-53', 'sequence', 'link-33');">sequence</a></tt> <tt class="py-keyword">import</tt> <tt id="link-54" class="py-name" targets="Function pipe_control.sequence.return_attached_protons()=pipe_control.sequence-module.html#return_attached_protons"><a title="pipe_control.sequence.return_attached_protons" class="py-name" href="#" onclick="return doclink('link-54', 'return_attached_protons', 'link-54');">return_attached_protons</a></tt> </tt>
<a name="L49"></a><tt class="py-lineno">  49</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-55" class="py-name" targets="Package specific_analyses=specific_analyses-module.html"><a title="specific_analyses" class="py-name" href="#" onclick="return doclink('link-55', 'specific_analyses', 'link-55');">specific_analyses</a></tt><tt class="py-op">.</tt><tt id="link-56" class="py-name" targets="Module specific_analyses.api_base=specific_analyses.api_base-module.html"><a title="specific_analyses.api_base" class="py-name" href="#" onclick="return doclink('link-56', 'api_base', 'link-56');">api_base</a></tt> <tt class="py-keyword">import</tt> <tt id="link-57" class="py-name" targets="Class specific_analyses.api_base.API_base=specific_analyses.api_base.API_base-class.html"><a title="specific_analyses.api_base.API_base" class="py-name" href="#" onclick="return doclink('link-57', 'API_base', 'link-57');">API_base</a></tt> </tt>
<a name="L50"></a><tt class="py-lineno">  50</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-58" class="py-name"><a title="specific_analyses" class="py-name" href="#" onclick="return doclink('link-58', 'specific_analyses', 'link-55');">specific_analyses</a></tt><tt class="py-op">.</tt><tt id="link-59" class="py-name" targets="Module specific_analyses.api_common=specific_analyses.api_common-module.html"><a title="specific_analyses.api_common" class="py-name" href="#" onclick="return doclink('link-59', 'api_common', 'link-59');">api_common</a></tt> <tt class="py-keyword">import</tt> <tt id="link-60" class="py-name" targets="Class specific_analyses.api_common.API_common=specific_analyses.api_common.API_common-class.html"><a title="specific_analyses.api_common.API_common" class="py-name" href="#" onclick="return doclink('link-60', 'API_common', 'link-60');">API_common</a></tt> </tt>
<a name="L51"></a><tt class="py-lineno">  51</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-61" class="py-name"><a title="specific_analyses" class="py-name" href="#" onclick="return doclink('link-61', 'specific_analyses', 'link-55');">specific_analyses</a></tt><tt class="py-op">.</tt><tt id="link-62" class="py-name" targets="Module auto_analyses.relax_disp=auto_analyses.relax_disp-module.html,Package specific_analyses.relax_disp=specific_analyses.relax_disp-module.html,Module target_functions.relax_disp=target_functions.relax_disp-module.html,Module test_suite.gui_tests.relax_disp=test_suite.gui_tests.relax_disp-module.html,Module test_suite.system_tests.relax_disp=test_suite.system_tests.relax_disp-module.html,Module user_functions.relax_disp=user_functions.relax_disp-module.html"><a title="auto_analyses.relax_disp
specific_analyses.relax_disp
target_functions.relax_disp
test_suite.gui_tests.relax_disp
test_suite.system_tests.relax_disp
user_functions.relax_disp" class="py-name" href="#" onclick="return doclink('link-62', 'relax_disp', 'link-62');">relax_disp</a></tt><tt class="py-op">.</tt><tt id="link-63" class="py-name" targets="Module lib.checks=lib.checks-module.html,Module pipe_control.structure.checks=pipe_control.structure.checks-module.html,Module specific_analyses.frame_order.checks=specific_analyses.frame_order.checks-module.html,Module specific_analyses.relax_disp.checks=specific_analyses.relax_disp.checks-module.html,Module specific_analyses.relax_fit.checks=specific_analyses.relax_fit.checks-module.html"><a title="lib.checks
pipe_control.structure.checks
specific_analyses.frame_order.checks
specific_analyses.relax_disp.checks
specific_analyses.relax_fit.checks" class="py-name" href="#" onclick="return doclink('link-63', 'checks', 'link-63');">checks</a></tt> <tt class="py-keyword">import</tt> <tt id="link-64" class="py-name" targets="Function specific_analyses.relax_disp.checks.check_model_type()=specific_analyses.relax_disp.checks-module.html#check_model_type"><a title="specific_analyses.relax_disp.checks.check_model_type" class="py-name" href="#" onclick="return doclink('link-64', 'check_model_type', 'link-64');">check_model_type</a></tt> </tt>
<a name="L52"></a><tt class="py-lineno">  52</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-65" class="py-name"><a title="specific_analyses" class="py-name" href="#" onclick="return doclink('link-65', 'specific_analyses', 'link-55');">specific_analyses</a></tt><tt class="py-op">.</tt><tt id="link-66" class="py-name"><a title="auto_analyses.relax_disp
specific_analyses.relax_disp
target_functions.relax_disp
test_suite.gui_tests.relax_disp
test_suite.system_tests.relax_disp
user_functions.relax_disp" class="py-name" href="#" onclick="return doclink('link-66', 'relax_disp', 'link-62');">relax_disp</a></tt><tt class="py-op">.</tt><tt id="link-67" class="py-name" targets="Module specific_analyses.frame_order.data=specific_analyses.frame_order.data-module.html,Module specific_analyses.model_free.data=specific_analyses.model_free.data-module.html,Module specific_analyses.n_state_model.data=specific_analyses.n_state_model.data-module.html,Module specific_analyses.relax_disp.data=specific_analyses.relax_disp.data-module.html,Module user_functions.data=user_functions.data-module.html"><a title="specific_analyses.frame_order.data
specific_analyses.model_free.data
specific_analyses.n_state_model.data
specific_analyses.relax_disp.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-67', 'data', 'link-67');">data</a></tt> <tt class="py-keyword">import</tt> <tt id="link-68" class="py-name" targets="Function specific_analyses.relax_disp.data.average_intensity()=specific_analyses.relax_disp.data-module.html#average_intensity"><a title="specific_analyses.relax_disp.data.average_intensity" class="py-name" href="#" onclick="return doclink('link-68', 'average_intensity', 'link-68');">average_intensity</a></tt><tt class="py-op">,</tt> <tt id="link-69" class="py-name" targets="Function specific_analyses.relax_disp.data.calc_rotating_frame_params()=specific_analyses.relax_disp.data-module.html#calc_rotating_frame_params"><a title="specific_analyses.relax_disp.data.calc_rotating_frame_params" class="py-name" href="#" onclick="return doclink('link-69', 'calc_rotating_frame_params', 'link-69');">calc_rotating_frame_params</a></tt><tt class="py-op">,</tt> <tt id="link-70" class="py-name" targets="Function specific_analyses.relax_disp.data.find_intensity_keys()=specific_analyses.relax_disp.data-module.html#find_intensity_keys"><a title="specific_analyses.relax_disp.data.find_intensity_keys" class="py-name" href="#" onclick="return doclink('link-70', 'find_intensity_keys', 'link-70');">find_intensity_keys</a></tt><tt class="py-op">,</tt> <tt id="link-71" class="py-name" targets="Function specific_analyses.relax_disp.data.generate_r20_key()=specific_analyses.relax_disp.data-module.html#generate_r20_key"><a title="specific_analyses.relax_disp.data.generate_r20_key" class="py-name" href="#" onclick="return doclink('link-71', 'generate_r20_key', 'link-71');">generate_r20_key</a></tt><tt class="py-op">,</tt> <tt id="link-72" class="py-name" targets="Function specific_analyses.relax_disp.data.has_exponential_exp_type()=specific_analyses.relax_disp.data-module.html#has_exponential_exp_type"><a title="specific_analyses.relax_disp.data.has_exponential_exp_type" class="py-name" href="#" onclick="return doclink('link-72', 'has_exponential_exp_type', 'link-72');">has_exponential_exp_type</a></tt><tt class="py-op">,</tt> <tt id="link-73" class="py-name" targets="Function specific_analyses.relax_disp.data.has_proton_mmq_cpmg()=specific_analyses.relax_disp.data-module.html#has_proton_mmq_cpmg"><a title="specific_analyses.relax_disp.data.has_proton_mmq_cpmg" class="py-name" href="#" onclick="return doclink('link-73', 'has_proton_mmq_cpmg', 'link-73');">has_proton_mmq_cpmg</a></tt><tt class="py-op">,</tt> <tt id="link-74" class="py-name" targets="Function specific_analyses.relax_disp.data.loop_cluster()=specific_analyses.relax_disp.data-module.html#loop_cluster"><a title="specific_analyses.relax_disp.data.loop_cluster" class="py-name" href="#" onclick="return doclink('link-74', 'loop_cluster', 'link-74');">loop_cluster</a></tt><tt class="py-op">,</tt> <tt id="link-75" class="py-name" targets="Function specific_analyses.relax_disp.data.loop_exp_frq()=specific_analyses.relax_disp.data-module.html#loop_exp_frq"><a title="specific_analyses.relax_disp.data.loop_exp_frq" class="py-name" href="#" onclick="return doclink('link-75', 'loop_exp_frq', 'link-75');">loop_exp_frq</a></tt><tt class="py-op">,</tt> <tt id="link-76" class="py-name" targets="Function specific_analyses.relax_disp.data.loop_exp_frq_offset_point()=specific_analyses.relax_disp.data-module.html#loop_exp_frq_offset_point"><a title="specific_analyses.relax_disp.data.loop_exp_frq_offset_point" class="py-name" href="#" onclick="return doclink('link-76', 'loop_exp_frq_offset_point', 'link-76');">loop_exp_frq_offset_point</a></tt><tt class="py-op">,</tt> <tt id="link-77" class="py-name" targets="Function specific_analyses.relax_disp.data.loop_time()=specific_analyses.relax_disp.data-module.html#loop_time"><a title="specific_analyses.relax_disp.data.loop_time" class="py-name" href="#" onclick="return doclink('link-77', 'loop_time', 'link-77');">loop_time</a></tt><tt class="py-op">,</tt> <tt id="link-78" class="py-name" targets="Function specific_analyses.relax_disp.data.pack_back_calc_r2eff()=specific_analyses.relax_disp.data-module.html#pack_back_calc_r2eff"><a title="specific_analyses.relax_disp.data.pack_back_calc_r2eff" class="py-name" href="#" onclick="return doclink('link-78', 'pack_back_calc_r2eff', 'link-78');">pack_back_calc_r2eff</a></tt><tt class="py-op">,</tt> <tt id="link-79" class="py-name" targets="Function specific_analyses.relax_disp.data.return_param_key_from_data()=specific_analyses.relax_disp.data-module.html#return_param_key_from_data"><a title="specific_analyses.relax_disp.data.return_param_key_from_data" class="py-name" href="#" onclick="return doclink('link-79', 'return_param_key_from_data', 'link-79');">return_param_key_from_data</a></tt><tt class="py-op">,</tt> <tt id="link-80" class="py-name" targets="Function specific_analyses.relax_disp.data.spin_ids_to_containers()=specific_analyses.relax_disp.data-module.html#spin_ids_to_containers"><a title="specific_analyses.relax_disp.data.spin_ids_to_containers" class="py-name" href="#" onclick="return doclink('link-80', 'spin_ids_to_containers', 'link-80');">spin_ids_to_containers</a></tt> </tt>
<a name="L53"></a><tt class="py-lineno">  53</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-81" class="py-name"><a title="specific_analyses" class="py-name" href="#" onclick="return doclink('link-81', 'specific_analyses', 'link-55');">specific_analyses</a></tt><tt class="py-op">.</tt><tt id="link-82" class="py-name"><a title="auto_analyses.relax_disp
specific_analyses.relax_disp
target_functions.relax_disp
test_suite.gui_tests.relax_disp
test_suite.system_tests.relax_disp
user_functions.relax_disp" class="py-name" href="#" onclick="return doclink('link-82', 'relax_disp', 'link-62');">relax_disp</a></tt><tt class="py-op">.</tt><tt id="link-83" class="py-name" targets="Module specific_analyses.frame_order.optimisation=specific_analyses.frame_order.optimisation-module.html,Module specific_analyses.model_free.optimisation=specific_analyses.model_free.optimisation-module.html,Module specific_analyses.n_state_model.optimisation=specific_analyses.n_state_model.optimisation-module.html,Module specific_analyses.relax_disp.optimisation=specific_analyses.relax_disp.optimisation-module.html,Module specific_analyses.relax_fit.optimisation=specific_analyses.relax_fit.optimisation-module.html"><a title="specific_analyses.frame_order.optimisation
specific_analyses.model_free.optimisation
specific_analyses.n_state_model.optimisation
specific_analyses.relax_disp.optimisation
specific_analyses.relax_fit.optimisation" class="py-name" href="#" onclick="return doclink('link-83', 'optimisation', 'link-83');">optimisation</a></tt> <tt class="py-keyword">import</tt> <tt id="link-84" class="py-name" targets="Class specific_analyses.relax_disp.optimisation.Disp_memo=specific_analyses.relax_disp.optimisation.Disp_memo-class.html"><a title="specific_analyses.relax_disp.optimisation.Disp_memo" class="py-name" href="#" onclick="return doclink('link-84', 'Disp_memo', 'link-84');">Disp_memo</a></tt><tt class="py-op">,</tt> <tt id="link-85" class="py-name" targets="Class specific_analyses.relax_disp.optimisation.Disp_minimise_command=specific_analyses.relax_disp.optimisation.Disp_minimise_command-class.html"><a title="specific_analyses.relax_disp.optimisation.Disp_minimise_command" class="py-name" href="#" onclick="return doclink('link-85', 'Disp_minimise_command', 'link-85');">Disp_minimise_command</a></tt><tt class="py-op">,</tt> <tt id="link-86" class="py-name" targets="Function specific_analyses.relax_disp.optimisation.back_calc_peak_intensities()=specific_analyses.relax_disp.optimisation-module.html#back_calc_peak_intensities"><a title="specific_analyses.relax_disp.optimisation.back_calc_peak_intensities" class="py-name" href="#" onclick="return doclink('link-86', 'back_calc_peak_intensities', 'link-86');">back_calc_peak_intensities</a></tt><tt class="py-op">,</tt> <tt id="link-87" class="py-name" targets="Function specific_analyses.relax_disp.optimisation.back_calc_r2eff()=specific_analyses.relax_disp.optimisation-module.html#back_calc_r2eff"><a title="specific_analyses.relax_disp.optimisation.back_calc_r2eff" class="py-name" href="#" onclick="return doclink('link-87', 'back_calc_r2eff', 'link-87');">back_calc_r2eff</a></tt><tt class="py-op">,</tt> <tt id="link-88" class="py-name" targets="Function specific_analyses.relax_disp.optimisation.calculate_r2eff()=specific_analyses.relax_disp.optimisation-module.html#calculate_r2eff"><a title="specific_analyses.relax_disp.optimisation.calculate_r2eff" class="py-name" href="#" onclick="return doclink('link-88', 'calculate_r2eff', 'link-88');">calculate_r2eff</a></tt><tt class="py-op">,</tt> <tt id="link-89" class="py-name" targets="Function specific_analyses.relax_disp.optimisation.minimise_r2eff()=specific_analyses.relax_disp.optimisation-module.html#minimise_r2eff"><a title="specific_analyses.relax_disp.optimisation.minimise_r2eff" class="py-name" href="#" onclick="return doclink('link-89', 'minimise_r2eff', 'link-89');">minimise_r2eff</a></tt> </tt>
<a name="L54"></a><tt class="py-lineno">  54</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-90" class="py-name"><a title="specific_analyses" class="py-name" href="#" onclick="return doclink('link-90', 'specific_analyses', 'link-55');">specific_analyses</a></tt><tt class="py-op">.</tt><tt id="link-91" class="py-name"><a title="auto_analyses.relax_disp
specific_analyses.relax_disp
target_functions.relax_disp
test_suite.gui_tests.relax_disp
test_suite.system_tests.relax_disp
user_functions.relax_disp" class="py-name" href="#" onclick="return doclink('link-91', 'relax_disp', 'link-62');">relax_disp</a></tt><tt class="py-op">.</tt><tt id="link-92" class="py-name" targets="Module specific_analyses.consistency_tests.parameter_object=specific_analyses.consistency_tests.parameter_object-module.html,Module specific_analyses.frame_order.parameter_object=specific_analyses.frame_order.parameter_object-module.html,Module specific_analyses.jw_mapping.parameter_object=specific_analyses.jw_mapping.parameter_object-module.html,Module specific_analyses.model_free.parameter_object=specific_analyses.model_free.parameter_object-module.html,Module specific_analyses.n_state_model.parameter_object=specific_analyses.n_state_model.parameter_object-module.html,Module specific_analyses.noe.parameter_object=specific_analyses.noe.parameter_object-module.html,Module specific_analyses.parameter_object=specific_analyses.parameter_object-module.html,Module specific_analyses.relax_disp.parameter_object=specific_analyses.relax_disp.parameter_object-module.html,Module specific_analyses.relax_fit.parameter_object=specific_analyses.relax_fit.parameter_object-module.html"><a title="specific_analyses.consistency_tests.parameter_object
specific_analyses.frame_order.parameter_object
specific_analyses.jw_mapping.parameter_object
specific_analyses.model_free.parameter_object
specific_analyses.n_state_model.parameter_object
specific_analyses.noe.parameter_object
specific_analyses.parameter_object
specific_analyses.relax_disp.parameter_object
specific_analyses.relax_fit.parameter_object" class="py-name" href="#" onclick="return doclink('link-92', 'parameter_object', 'link-92');">parameter_object</a></tt> <tt class="py-keyword">import</tt> <tt id="link-93" class="py-name" targets="Class specific_analyses.relax_disp.parameter_object.Relax_disp_params=specific_analyses.relax_disp.parameter_object.Relax_disp_params-class.html"><a title="specific_analyses.relax_disp.parameter_object.Relax_disp_params" class="py-name" href="#" onclick="return doclink('link-93', 'Relax_disp_params', 'link-93');">Relax_disp_params</a></tt> </tt>
<a name="L55"></a><tt class="py-lineno">  55</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-94" class="py-name"><a title="specific_analyses" class="py-name" href="#" onclick="return doclink('link-94', 'specific_analyses', 'link-55');">specific_analyses</a></tt><tt class="py-op">.</tt><tt id="link-95" class="py-name"><a title="auto_analyses.relax_disp
specific_analyses.relax_disp
target_functions.relax_disp
test_suite.gui_tests.relax_disp
test_suite.system_tests.relax_disp
user_functions.relax_disp" class="py-name" href="#" onclick="return doclink('link-95', 'relax_disp', 'link-62');">relax_disp</a></tt><tt class="py-op">.</tt><tt id="link-96" class="py-name" targets="Module specific_analyses.frame_order.parameters=specific_analyses.frame_order.parameters-module.html,Module specific_analyses.model_free.parameters=specific_analyses.model_free.parameters-module.html,Module specific_analyses.n_state_model.parameters=specific_analyses.n_state_model.parameters-module.html,Module specific_analyses.relax_disp.parameters=specific_analyses.relax_disp.parameters-module.html,Module specific_analyses.relax_fit.parameters=specific_analyses.relax_fit.parameters-module.html"><a title="specific_analyses.frame_order.parameters
specific_analyses.model_free.parameters
specific_analyses.n_state_model.parameters
specific_analyses.relax_disp.parameters
specific_analyses.relax_fit.parameters" class="py-name" href="#" onclick="return doclink('link-96', 'parameters', 'link-96');">parameters</a></tt> <tt class="py-keyword">import</tt> <tt id="link-97" class="py-name" targets="Method specific_analyses.api_base.API_base.get_param_names()=specific_analyses.api_base.API_base-class.html#get_param_names,Method specific_analyses.consistency_tests.api.Consistency_tests.get_param_names()=specific_analyses.consistency_tests.api.Consistency_tests-class.html#get_param_names,Method specific_analyses.frame_order.api.Frame_order.get_param_names()=specific_analyses.frame_order.api.Frame_order-class.html#get_param_names,Method specific_analyses.jw_mapping.api.Jw_mapping.get_param_names()=specific_analyses.jw_mapping.api.Jw_mapping-class.html#get_param_names,Method specific_analyses.model_free.api.Model_free.get_param_names()=specific_analyses.model_free.api.Model_free-class.html#get_param_names,Method specific_analyses.n_state_model.api.N_state_model.get_param_names()=specific_analyses.n_state_model.api.N_state_model-class.html#get_param_names,Method specific_analyses.noe.api.Noe.get_param_names()=specific_analyses.noe.api.Noe-class.html#get_param_names,Method specific_analyses.relax_disp.api.Relax_disp.get_param_names()=specific_analyses.relax_disp.api.Relax_disp-class.html#get_param_names,Function specific_analyses.relax_disp.parameters.get_param_names()=specific_analyses.relax_disp.parameters-module.html#get_param_names,Method specific_analyses.relax_fit.api.Relax_fit.get_param_names()=specific_analyses.relax_fit.api.Relax_fit-class.html#get_param_names"><a title="specific_analyses.api_base.API_base.get_param_names
specific_analyses.consistency_tests.api.Consistency_tests.get_param_names
specific_analyses.frame_order.api.Frame_order.get_param_names
specific_analyses.jw_mapping.api.Jw_mapping.get_param_names
specific_analyses.model_free.api.Model_free.get_param_names
specific_analyses.n_state_model.api.N_state_model.get_param_names
specific_analyses.noe.api.Noe.get_param_names
specific_analyses.relax_disp.api.Relax_disp.get_param_names
specific_analyses.relax_disp.parameters.get_param_names
specific_analyses.relax_fit.api.Relax_fit.get_param_names" class="py-name" href="#" onclick="return doclink('link-97', 'get_param_names', 'link-97');">get_param_names</a></tt><tt class="py-op">,</tt> <tt id="link-98" class="py-name" targets="Function specific_analyses.relax_disp.parameters.get_value()=specific_analyses.relax_disp.parameters-module.html#get_value"><a title="specific_analyses.relax_disp.parameters.get_value" class="py-name" href="#" onclick="return doclink('link-98', 'get_value', 'link-98');">get_value</a></tt><tt class="py-op">,</tt> <tt id="link-99" class="py-name" targets="Function specific_analyses.relax_disp.parameters.loop_parameters()=specific_analyses.relax_disp.parameters-module.html#loop_parameters,Method test_suite.unit_tests._lib._dispersion.test_cr72_full_cluster_one_field.Test_cr72_full_cluster_one_field.loop_parameters()=test_suite.unit_tests._lib._dispersion.test_cr72_full_cluster_one_field.Test_cr72_full_cluster_one_field-class.html#loop_parameters,Method test_suite.unit_tests._lib._dispersion.test_cr72_full_cluster_three_fields.Test_cr72_full_cluster_three_fields.loop_parameters()=test_suite.unit_tests._lib._dispersion.test_cr72_full_cluster_three_fields.Test_cr72_full_cluster_three_fields-class.html#loop_parameters"><a title="specific_analyses.relax_disp.parameters.loop_parameters
test_suite.unit_tests._lib._dispersion.test_cr72_full_cluster_one_field.Test_cr72_full_cluster_one_field.loop_parameters
test_suite.unit_tests._lib._dispersion.test_cr72_full_cluster_three_fields.Test_cr72_full_cluster_three_fields.loop_parameters" class="py-name" href="#" onclick="return doclink('link-99', 'loop_parameters', 'link-99');">loop_parameters</a></tt><tt class="py-op">,</tt> <tt id="link-100" class="py-name" targets="Function specific_analyses.relax_disp.parameters.param_index_to_param_info()=specific_analyses.relax_disp.parameters-module.html#param_index_to_param_info"><a title="specific_analyses.relax_disp.parameters.param_index_to_param_info" class="py-name" href="#" onclick="return doclink('link-100', 'param_index_to_param_info', 'link-100');">param_index_to_param_info</a></tt><tt class="py-op">,</tt> <tt id="link-101" class="py-name" targets="Function specific_analyses.frame_order.parameters.param_num()=specific_analyses.frame_order.parameters-module.html#param_num,Function specific_analyses.n_state_model.parameters.param_num()=specific_analyses.n_state_model.parameters-module.html#param_num,Function specific_analyses.relax_disp.parameters.param_num()=specific_analyses.relax_disp.parameters-module.html#param_num"><a title="specific_analyses.frame_order.parameters.param_num
specific_analyses.n_state_model.parameters.param_num
specific_analyses.relax_disp.parameters.param_num" class="py-name" href="#" onclick="return doclink('link-101', 'param_num', 'link-101');">param_num</a></tt><tt class="py-op">,</tt> <tt id="link-102" class="py-name" targets="Function specific_analyses.relax_disp.parameters.r1_setup()=specific_analyses.relax_disp.parameters-module.html#r1_setup"><a title="specific_analyses.relax_disp.parameters.r1_setup" class="py-name" href="#" onclick="return doclink('link-102', 'r1_setup', 'link-102');">r1_setup</a></tt> </tt>
<a name="L56"></a><tt class="py-lineno">  56</tt>  <tt class="py-line"> </tt>
<a name="L57"></a><tt class="py-lineno">  57</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp"></a><div id="Relax_disp-def"><a name="L58"></a><tt class="py-lineno">  58</tt> <a class="py-toggle" href="#" id="Relax_disp-toggle" onclick="return toggle('Relax_disp');">-</a><tt class="py-line"><tt class="py-keyword">class</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html">Relax_disp</a><tt class="py-op">(</tt><tt class="py-base-class">API_base</tt><tt class="py-op">,</tt> <tt class="py-base-class">API_common</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="Relax_disp-expanded"><a name="L59"></a><tt class="py-lineno">  59</tt>  <tt class="py-line">    <tt class="py-docstring">"""Class containing functions for relaxation dispersion curve fitting."""</tt> </tt>
<a name="L60"></a><tt class="py-lineno">  60</tt>  <tt class="py-line"> </tt>
<a name="L61"></a><tt class="py-lineno">  61</tt>  <tt class="py-line">    <tt class="py-comment"># Class variable for storing the class instance (for the singleton design pattern).</tt> </tt>
<a name="L62"></a><tt class="py-lineno">  62</tt>  <tt class="py-line">    <tt id="link-103" class="py-name" targets="Variable bmrblib.version.Star_version.instance=bmrblib.version.Star_version-class.html#instance,Variable data_store.Relax_data_store.instance=data_store.Relax_data_store-class.html#instance,Variable info.Info_box.instance=info.Info_box-class.html#instance,Variable multi.Processor_box.instance=multi.Processor_box-class.html#instance,Variable multi.misc.Verbosity.instance=multi.misc.Verbosity-class.html#instance,Variable specific_analyses.api_base.API_base.instance=specific_analyses.api_base.API_base-class.html#instance,Variable specific_analyses.consistency_tests.api.Consistency_tests.instance=specific_analyses.consistency_tests.api.Consistency_tests-class.html#instance,Variable specific_analyses.frame_order.api.Frame_order.instance=specific_analyses.frame_order.api.Frame_order-class.html#instance,Variable specific_analyses.jw_mapping.api.Jw_mapping.instance=specific_analyses.jw_mapping.api.Jw_mapping-class.html#instance,Variable specific_analyses.model_free.api.Model_free.instance=specific_analyses.model_free.api.Model_free-class.html#instance,Variable specific_analyses.n_state_model.api.N_state_model.instance=specific_analyses.n_state_model.api.N_state_model-class.html#instance,Variable specific_analyses.noe.api.Noe.instance=specific_analyses.noe.api.Noe-class.html#instance,Variable specific_analyses.relax_disp.api.Relax_disp.instance=specific_analyses.relax_disp.api.Relax_disp-class.html#instance,Variable specific_analyses.relax_fit.api.Relax_fit.instance=specific_analyses.relax_fit.api.Relax_fit-class.html#instance"><a title="bmrblib.version.Star_version.instance
data_store.Relax_data_store.instance
info.Info_box.instance
multi.Processor_box.instance
multi.misc.Verbosity.instance
specific_analyses.api_base.API_base.instance
specific_analyses.consistency_tests.api.Consistency_tests.instance
specific_analyses.frame_order.api.Frame_order.instance
specific_analyses.jw_mapping.api.Jw_mapping.instance
specific_analyses.model_free.api.Model_free.instance
specific_analyses.n_state_model.api.N_state_model.instance
specific_analyses.noe.api.Noe.instance
specific_analyses.relax_disp.api.Relax_disp.instance
specific_analyses.relax_fit.api.Relax_fit.instance" class="py-name" href="#" onclick="return doclink('link-103', 'instance', 'link-103');">instance</a></tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L63"></a><tt class="py-lineno">  63</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.__init__"></a><div id="Relax_disp.__init__-def"><a name="L64"></a><tt class="py-lineno">  64</tt> <a class="py-toggle" href="#" id="Relax_disp.__init__-toggle" onclick="return toggle('Relax_disp.__init__');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#__init__">__init__</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.__init__-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.__init__-expanded"><a name="L65"></a><tt class="py-lineno">  65</tt>  <tt class="py-line">        <tt class="py-docstring">"""Initialise the class by placing API_common methods into the API."""</tt> </tt>
<a name="L66"></a><tt class="py-lineno">  66</tt>  <tt class="py-line"> </tt>
<a name="L67"></a><tt class="py-lineno">  67</tt>  <tt class="py-line">        <tt class="py-comment"># Place methods into the API.</tt> </tt>
<a name="L68"></a><tt class="py-lineno">  68</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-104" class="py-name" targets="Method specific_analyses.api_base.API_base.data_init()=specific_analyses.api_base.API_base-class.html#data_init,Method specific_analyses.consistency_tests.api.Consistency_tests.data_init()=specific_analyses.consistency_tests.api.Consistency_tests-class.html#data_init,Method specific_analyses.jw_mapping.api.Jw_mapping.data_init()=specific_analyses.jw_mapping.api.Jw_mapping-class.html#data_init,Method specific_analyses.model_free.api.Model_free.data_init()=specific_analyses.model_free.api.Model_free-class.html#data_init,Method specific_analyses.relax_fit.api.Relax_fit.data_init()=specific_analyses.relax_fit.api.Relax_fit-class.html#data_init"><a title="specific_analyses.api_base.API_base.data_init
specific_analyses.consistency_tests.api.Consistency_tests.data_init
specific_analyses.jw_mapping.api.Jw_mapping.data_init
specific_analyses.model_free.api.Model_free.data_init
specific_analyses.relax_fit.api.Relax_fit.data_init" class="py-name" href="#" onclick="return doclink('link-104', 'data_init', 'link-104');">data_init</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-105" class="py-name" targets="Method specific_analyses.api_common.API_common._data_init_spin()=specific_analyses.api_common.API_common-class.html#_data_init_spin"><a title="specific_analyses.api_common.API_common._data_init_spin" class="py-name" href="#" onclick="return doclink('link-105', '_data_init_spin', 'link-105');">_data_init_spin</a></tt> </tt>
<a name="L69"></a><tt class="py-lineno">  69</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-106" class="py-name" targets="Method specific_analyses.api_base.API_base.model_type()=specific_analyses.api_base.API_base-class.html#model_type,Method specific_analyses.hybrid.Hybrid.model_type()=specific_analyses.hybrid.Hybrid-class.html#model_type,Method specific_analyses.model_free.api.Model_free.model_type()=specific_analyses.model_free.api.Model_free-class.html#model_type"><a title="specific_analyses.api_base.API_base.model_type
specific_analyses.hybrid.Hybrid.model_type
specific_analyses.model_free.api.Model_free.model_type" class="py-name" href="#" onclick="return doclink('link-106', 'model_type', 'link-106');">model_type</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-107" class="py-name" targets="Method specific_analyses.api_common.API_common._model_type_local()=specific_analyses.api_common.API_common-class.html#_model_type_local"><a title="specific_analyses.api_common.API_common._model_type_local" class="py-name" href="#" onclick="return doclink('link-107', '_model_type_local', 'link-107');">_model_type_local</a></tt> </tt>
<a name="L70"></a><tt class="py-lineno">  70</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-108" class="py-name" targets="Method specific_analyses.api_base.API_base.return_conversion_factor()=specific_analyses.api_base.API_base-class.html#return_conversion_factor"><a title="specific_analyses.api_base.API_base.return_conversion_factor" class="py-name" href="#" onclick="return doclink('link-108', 'return_conversion_factor', 'link-108');">return_conversion_factor</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-109" class="py-name" targets="Method specific_analyses.api_common.API_common._return_no_conversion_factor()=specific_analyses.api_common.API_common-class.html#_return_no_conversion_factor"><a title="specific_analyses.api_common.API_common._return_no_conversion_factor" class="py-name" href="#" onclick="return doclink('link-109', '_return_no_conversion_factor', 'link-109');">_return_no_conversion_factor</a></tt> </tt>
<a name="L71"></a><tt class="py-lineno">  71</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-110" class="py-name" targets="Variable dep_check.return_value=dep_check-module.html#return_value,Function pipe_control.relax_data.return_value()=pipe_control.relax_data-module.html#return_value,Method specific_analyses.api_base.API_base.return_value()=specific_analyses.api_base.API_base-class.html#return_value,Method specific_analyses.relax_disp.api.Relax_disp.return_value()=specific_analyses.relax_disp.api.Relax_disp-class.html#return_value"><a title="dep_check.return_value
pipe_control.relax_data.return_value
specific_analyses.api_base.API_base.return_value
specific_analyses.relax_disp.api.Relax_disp.return_value" class="py-name" href="#" onclick="return doclink('link-110', 'return_value', 'link-110');">return_value</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-111" class="py-name"><a title="dep_check.return_value
pipe_control.relax_data.return_value
specific_analyses.api_base.API_base.return_value
specific_analyses.relax_disp.api.Relax_disp.return_value" class="py-name" href="#" onclick="return doclink('link-111', 'return_value', 'link-110');">return_value</a></tt> </tt>
<a name="L72"></a><tt class="py-lineno">  72</tt>  <tt class="py-line"> </tt>
<a name="L73"></a><tt class="py-lineno">  73</tt>  <tt class="py-line">        <tt class="py-comment"># Place a copy of the parameter list object in the instance namespace.</tt> </tt>
<a name="L74"></a><tt class="py-lineno">  74</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_PARAMS</tt> <tt class="py-op">=</tt> <tt id="link-112" class="py-name"><a title="specific_analyses.relax_disp.parameter_object.Relax_disp_params" class="py-name" href="#" onclick="return doclink('link-112', 'Relax_disp_params', 'link-93');">Relax_disp_params</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
</div><a name="L75"></a><tt class="py-lineno">  75</tt>  <tt class="py-line"> </tt>
<a name="L76"></a><tt class="py-lineno">  76</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.base_data_loop"></a><div id="Relax_disp.base_data_loop-def"><a name="L77"></a><tt class="py-lineno">  77</tt> <a class="py-toggle" href="#" id="Relax_disp.base_data_loop-toggle" onclick="return toggle('Relax_disp.base_data_loop');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#base_data_loop">base_data_loop</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.base_data_loop-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.base_data_loop-expanded"><a name="L78"></a><tt class="py-lineno">  78</tt>  <tt class="py-line">        <tt class="py-docstring">"""Custom generator method for looping over the base data.</tt> </tt>
<a name="L79"></a><tt class="py-lineno">  79</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L80"></a><tt class="py-lineno">  80</tt>  <tt class="py-line"><tt class="py-docstring">        For the R2eff model, the base data is the peak intensity data defining a single exponential curve.  For all other models, the base data is the R2eff/R1rho values for individual spins.</tt> </tt>
<a name="L81"></a><tt class="py-lineno">  81</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L82"></a><tt class="py-lineno">  82</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L83"></a><tt class="py-lineno">  83</tt>  <tt class="py-line"><tt class="py-docstring">        @return:    For the R2eff model, a tuple of the spin container and the exponential curve identifying key (the CPMG frequency or R1rho spin-lock field strength).  For all other models, the spin container and ID from the spin loop.</tt> </tt>
<a name="L84"></a><tt class="py-lineno">  84</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:     (tuple of SpinContainer instance and float) or (SpinContainer instance and str)</tt> </tt>
<a name="L85"></a><tt class="py-lineno">  85</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L86"></a><tt class="py-lineno">  86</tt>  <tt class="py-line"> </tt>
<a name="L87"></a><tt class="py-lineno">  87</tt>  <tt class="py-line">        <tt class="py-comment"># The R2eff model data (the base data is peak intensities).</tt> </tt>
<a name="L88"></a><tt class="py-lineno">  88</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-113" class="py-name"><a title="specific_analyses.api_base.API_base.model_type
specific_analyses.hybrid.Hybrid.model_type
specific_analyses.model_free.api.Model_free.model_type" class="py-name" href="#" onclick="return doclink('link-113', 'model_type', 'link-106');">model_type</a></tt> <tt class="py-op">==</tt> <tt id="link-114" class="py-name"><a title="lib.dispersion.variables.MODEL_R2EFF" class="py-name" href="#" onclick="return doclink('link-114', 'MODEL_R2EFF', 'link-14');">MODEL_R2EFF</a></tt><tt class="py-op">:</tt> </tt>
<a name="L89"></a><tt class="py-lineno">  89</tt>  <tt class="py-line">            <tt class="py-comment"># Loop over the sequence.</tt> </tt>
<a name="L90"></a><tt class="py-lineno">  90</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-115" class="py-name" targets="Module test_suite.unit_tests._pipe_control.spin=test_suite.unit_tests._pipe_control.spin-module.html,Module user_functions.spin=user_functions.spin-module.html"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-115', 'spin', 'link-115');">spin</a></tt> <tt class="py-keyword">in</tt> <tt id="link-116" class="py-name"><a title="pipe_control.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-116', 'spin_loop', 'link-45');">spin_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L91"></a><tt class="py-lineno">  91</tt>  <tt class="py-line">                <tt class="py-comment"># Skip deselected spins.</tt> </tt>
<a name="L92"></a><tt class="py-lineno">  92</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-117" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-117', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-118" class="py-name" targets="Function pipe_control.model_selection.select()=pipe_control.model_selection-module.html#select,Module user_functions.select=user_functions.select-module.html"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-118', 'select', 'link-118');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L93"></a><tt class="py-lineno">  93</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L94"></a><tt class="py-lineno">  94</tt>  <tt class="py-line"> </tt>
<a name="L95"></a><tt class="py-lineno">  95</tt>  <tt class="py-line">                <tt class="py-comment"># Skip spins with no peak intensity data.</tt> </tt>
<a name="L96"></a><tt class="py-lineno">  96</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-119" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-119', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'peak_intensity'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L97"></a><tt class="py-lineno">  97</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L98"></a><tt class="py-lineno">  98</tt>  <tt class="py-line"> </tt>
<a name="L99"></a><tt class="py-lineno">  99</tt>  <tt class="py-line">                <tt class="py-comment"># Loop over each spectrometer frequency and dispersion point.</tt> </tt>
<a name="L100"></a><tt class="py-lineno"> 100</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">exp_type</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt><tt class="py-op">,</tt> <tt id="link-120" class="py-name" targets="Method gui.about.About_base.offset()=gui.about.About_base-class.html#offset"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-120', 'offset', 'link-120');">offset</a></tt><tt class="py-op">,</tt> <tt class="py-name">point</tt> <tt class="py-keyword">in</tt> <tt id="link-121" class="py-name"><a title="specific_analyses.relax_disp.data.loop_exp_frq_offset_point" class="py-name" href="#" onclick="return doclink('link-121', 'loop_exp_frq_offset_point', 'link-76');">loop_exp_frq_offset_point</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L101"></a><tt class="py-lineno"> 101</tt>  <tt class="py-line">                    <tt class="py-keyword">yield</tt> <tt id="link-122" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-122', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">exp_type</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt><tt class="py-op">,</tt> <tt id="link-123" class="py-name"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-123', 'offset', 'link-120');">offset</a></tt><tt class="py-op">,</tt> <tt class="py-name">point</tt> </tt>
<a name="L102"></a><tt class="py-lineno"> 102</tt>  <tt class="py-line"> </tt>
<a name="L103"></a><tt class="py-lineno"> 103</tt>  <tt class="py-line">        <tt class="py-comment"># All other models (the base data is the R2eff/R1rho values).</tt> </tt>
<a name="L104"></a><tt class="py-lineno"> 104</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L105"></a><tt class="py-lineno"> 105</tt>  <tt class="py-line">            <tt class="py-comment"># 1H MMQ flag.</tt> </tt>
<a name="L106"></a><tt class="py-lineno"> 106</tt>  <tt class="py-line">            <tt class="py-name">proton_mmq_flag</tt> <tt class="py-op">=</tt> <tt id="link-124" class="py-name"><a title="specific_analyses.relax_disp.data.has_proton_mmq_cpmg" class="py-name" href="#" onclick="return doclink('link-124', 'has_proton_mmq_cpmg', 'link-73');">has_proton_mmq_cpmg</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L107"></a><tt class="py-lineno"> 107</tt>  <tt class="py-line"> </tt>
<a name="L108"></a><tt class="py-lineno"> 108</tt>  <tt class="py-line">            <tt class="py-comment"># Loop over the sequence.</tt> </tt>
<a name="L109"></a><tt class="py-lineno"> 109</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-125" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-125', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt id="link-126" class="py-name" targets="Module gui.input_elements.spin_id=gui.input_elements.spin_id-module.html"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-126', 'spin_id', 'link-126');">spin_id</a></tt> <tt class="py-keyword">in</tt> <tt id="link-127" class="py-name"><a title="pipe_control.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-127', 'spin_loop', 'link-45');">spin_loop</a></tt><tt class="py-op">(</tt><tt class="py-name">return_id</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L110"></a><tt class="py-lineno"> 110</tt>  <tt class="py-line">                <tt class="py-comment"># Skip deselected spins.</tt> </tt>
<a name="L111"></a><tt class="py-lineno"> 111</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-128" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-128', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-129" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-129', 'select', 'link-118');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L112"></a><tt class="py-lineno"> 112</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L113"></a><tt class="py-lineno"> 113</tt>  <tt class="py-line"> </tt>
<a name="L114"></a><tt class="py-lineno"> 114</tt>  <tt class="py-line">                <tt class="py-comment"># Skip protons for MMQ data.</tt> </tt>
<a name="L115"></a><tt class="py-lineno"> 115</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt id="link-130" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-130', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-131" class="py-name" targets="Function lib.structure.pdb_read.model()=lib.structure.pdb_read-module.html#model,Function lib.structure.pdb_write.model()=lib.structure.pdb_write-module.html#model,Module specific_analyses.model_free.model=specific_analyses.model_free.model-module.html,Module specific_analyses.relax_disp.model=specific_analyses.relax_disp.model-module.html"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-131', 'model', 'link-131');">model</a></tt> <tt class="py-keyword">in</tt> <tt id="link-132" class="py-name"><a title="lib.dispersion.variables.MODEL_LIST_MMQ" class="py-name" href="#" onclick="return doclink('link-132', 'MODEL_LIST_MMQ', 'link-13');">MODEL_LIST_MMQ</a></tt> <tt class="py-keyword">and</tt> <tt id="link-133" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-133', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">isotope</tt> <tt class="py-op">==</tt> <tt class="py-string">'1H'</tt><tt class="py-op">:</tt> </tt>
<a name="L116"></a><tt class="py-lineno"> 116</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L117"></a><tt class="py-lineno"> 117</tt>  <tt class="py-line"> </tt>
<a name="L118"></a><tt class="py-lineno"> 118</tt>  <tt class="py-line">                <tt class="py-comment"># Get the attached proton.</tt> </tt>
<a name="L119"></a><tt class="py-lineno"> 119</tt>  <tt class="py-line">                <tt class="py-name">proton</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L120"></a><tt class="py-lineno"> 120</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">proton_mmq_flag</tt><tt class="py-op">:</tt> </tt>
<a name="L121"></a><tt class="py-lineno"> 121</tt>  <tt class="py-line">                    <tt class="py-name">proton</tt> <tt class="py-op">=</tt> <tt id="link-134" class="py-name"><a title="pipe_control.sequence.return_attached_protons" class="py-name" href="#" onclick="return doclink('link-134', 'return_attached_protons', 'link-54');">return_attached_protons</a></tt><tt class="py-op">(</tt><tt id="link-135" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-135', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">)</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L122"></a><tt class="py-lineno"> 122</tt>  <tt class="py-line"> </tt>
<a name="L123"></a><tt class="py-lineno"> 123</tt>  <tt class="py-line">                <tt class="py-comment"># Skip spins with no R2eff/R1rho values.</tt> </tt>
<a name="L124"></a><tt class="py-lineno"> 124</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-136" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-136', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'r2eff'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">proton</tt><tt class="py-op">,</tt> <tt class="py-string">'r2eff'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L125"></a><tt class="py-lineno"> 125</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L126"></a><tt class="py-lineno"> 126</tt>  <tt class="py-line"> </tt>
<a name="L127"></a><tt class="py-lineno"> 127</tt>  <tt class="py-line">                <tt class="py-comment"># Yield the spin container and ID.</tt> </tt>
<a name="L128"></a><tt class="py-lineno"> 128</tt>  <tt class="py-line">                <tt class="py-keyword">yield</tt> <tt id="link-137" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-137', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt id="link-138" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-138', 'spin_id', 'link-126');">spin_id</a></tt> </tt>
</div><a name="L129"></a><tt class="py-lineno"> 129</tt>  <tt class="py-line"> </tt>
<a name="L130"></a><tt class="py-lineno"> 130</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.bmrb_write"></a><div id="Relax_disp.bmrb_write-def"><a name="L131"></a><tt class="py-lineno"> 131</tt> <a class="py-toggle" href="#" id="Relax_disp.bmrb_write-toggle" onclick="return toggle('Relax_disp.bmrb_write');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#bmrb_write">bmrb_write</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">file_path</tt><tt class="py-op">,</tt> <tt class="py-param">version</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.bmrb_write-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.bmrb_write-expanded"><a name="L132"></a><tt class="py-lineno"> 132</tt>  <tt class="py-line">        <tt class="py-docstring">"""Write the model-free results to a BMRB NMR-STAR v3.1 formatted file.</tt> </tt>
<a name="L133"></a><tt class="py-lineno"> 133</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L134"></a><tt class="py-lineno"> 134</tt>  <tt class="py-line"><tt class="py-docstring">        @param file_path:   The full file path.</tt> </tt>
<a name="L135"></a><tt class="py-lineno"> 135</tt>  <tt class="py-line"><tt class="py-docstring">        @type file_path:    str</tt> </tt>
<a name="L136"></a><tt class="py-lineno"> 136</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword version:   The BMRB NMR-STAR dictionary format to output to.</tt> </tt>
<a name="L137"></a><tt class="py-lineno"> 137</tt>  <tt class="py-line"><tt class="py-docstring">        @type version:      str</tt> </tt>
<a name="L138"></a><tt class="py-lineno"> 138</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L139"></a><tt class="py-lineno"> 139</tt>  <tt class="py-line"> </tt>
<a name="L140"></a><tt class="py-lineno"> 140</tt>  <tt class="py-line">        <tt class="py-comment"># This function is not yet implemented, as it would require a re-write of the relax_data bmrb_write(star) function, and proper handling of cdp.ri_ids.</tt> </tt>
<a name="L141"></a><tt class="py-lineno"> 141</tt>  <tt class="py-line">        <tt class="py-comment"># It was also not readily possible to find examples of submitted CPMG data in the BMRB database.</tt> </tt>
<a name="L142"></a><tt class="py-lineno"> 142</tt>  <tt class="py-line"> </tt>
<a name="L143"></a><tt class="py-lineno"> 143</tt>  <tt class="py-line">        <tt class="py-comment"># Not implemented.</tt> </tt>
<a name="L144"></a><tt class="py-lineno"> 144</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-139" class="py-name"><a title="lib.errors.RelaxImplementError" class="py-name" href="#" onclick="return doclink('link-139', 'RelaxImplementError', 'link-19');">RelaxImplementError</a></tt><tt class="py-op">(</tt><tt class="py-string">'bmrb_write'</tt><tt class="py-op">)</tt> </tt>
<a name="L145"></a><tt class="py-lineno"> 145</tt>  <tt class="py-line"> </tt>
<a name="L146"></a><tt class="py-lineno"> 146</tt>  <tt class="py-line">        <tt class="py-comment"># Checks.</tt> </tt>
<a name="L147"></a><tt class="py-lineno"> 147</tt>  <tt class="py-line">        <tt id="link-140" class="py-name"><a title="pipe_control.spectrometer.check_spectrometer_setup" class="py-name" href="#" onclick="return doclink('link-140', 'check_spectrometer_setup', 'link-51');">check_spectrometer_setup</a></tt><tt class="py-op">(</tt><tt class="py-name">escalate</tt><tt class="py-op">=</tt><tt class="py-number">2</tt><tt class="py-op">)</tt> </tt>
<a name="L148"></a><tt class="py-lineno"> 148</tt>  <tt class="py-line"> </tt>
<a name="L149"></a><tt class="py-lineno"> 149</tt>  <tt class="py-line">        <tt class="py-comment"># Alias the current data pipe.</tt> </tt>
<a name="L150"></a><tt class="py-lineno"> 150</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt> <tt class="py-op">=</tt> <tt id="link-141" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-141', 'pipes', 'link-31');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-142" class="py-name" targets="Function pipe_control.pipes.get_pipe()=pipe_control.pipes-module.html#get_pipe"><a title="pipe_control.pipes.get_pipe" class="py-name" href="#" onclick="return doclink('link-142', 'get_pipe', 'link-142');">get_pipe</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L151"></a><tt class="py-lineno"> 151</tt>  <tt class="py-line"> </tt>
<a name="L152"></a><tt class="py-lineno"> 152</tt>  <tt class="py-line">        <tt class="py-comment"># Initialise the NMR-STAR data object.</tt> </tt>
<a name="L153"></a><tt class="py-lineno"> 153</tt>  <tt class="py-line">        <tt class="py-name">star</tt> <tt class="py-op">=</tt> <tt id="link-143" class="py-name"><a title="bmrblib" class="py-name" href="#" onclick="return doclink('link-143', 'bmrblib', 'link-0');">bmrblib</a></tt><tt class="py-op">.</tt><tt id="link-144" class="py-name" targets="Function bmrblib.create_nmr_star()=bmrblib-module.html#create_nmr_star"><a title="bmrblib.create_nmr_star" class="py-name" href="#" onclick="return doclink('link-144', 'create_nmr_star', 'link-144');">create_nmr_star</a></tt><tt class="py-op">(</tt><tt class="py-string">'relax_relaxation_dispersion_results'</tt><tt class="py-op">,</tt> <tt class="py-name">file_path</tt><tt class="py-op">,</tt> <tt id="link-145" class="py-name" targets="Variable bmrblib.base_classes.version=bmrblib.base_classes-module.html#version,Module bmrblib.version=bmrblib.version-module.html,Module version=version-module.html,Variable version.version=version-module.html#version"><a title="bmrblib.base_classes.version
bmrblib.version
version
version.version" class="py-name" href="#" onclick="return doclink('link-145', 'version', 'link-145');">version</a></tt><tt class="py-op">)</tt> </tt>
<a name="L154"></a><tt class="py-lineno"> 154</tt>  <tt class="py-line"> </tt>
<a name="L155"></a><tt class="py-lineno"> 155</tt>  <tt class="py-line">        <tt class="py-comment"># Initialise the spin specific data lists.</tt> </tt>
<a name="L156"></a><tt class="py-lineno"> 156</tt>  <tt class="py-line">        <tt class="py-name">mol_name_list</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L157"></a><tt class="py-lineno"> 157</tt>  <tt class="py-line">        <tt class="py-name">res_num_list</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L158"></a><tt class="py-lineno"> 158</tt>  <tt class="py-line">        <tt class="py-name">res_name_list</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L159"></a><tt class="py-lineno"> 159</tt>  <tt class="py-line">        <tt class="py-name">atom_name_list</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L160"></a><tt class="py-lineno"> 160</tt>  <tt class="py-line"> </tt>
<a name="L161"></a><tt class="py-lineno"> 161</tt>  <tt class="py-line">        <tt class="py-name">isotope_list</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L162"></a><tt class="py-lineno"> 162</tt>  <tt class="py-line">        <tt class="py-name">element_list</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L163"></a><tt class="py-lineno"> 163</tt>  <tt class="py-line"> </tt>
<a name="L164"></a><tt class="py-lineno"> 164</tt>  <tt class="py-line">        <tt class="py-name">chi2_list</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L165"></a><tt class="py-lineno"> 165</tt>  <tt class="py-line">        <tt id="link-146" class="py-name" targets="Module gui.analyses.elements.model_list=gui.analyses.elements.model_list-module.html"><a title="gui.analyses.elements.model_list" class="py-name" href="#" onclick="return doclink('link-146', 'model_list', 'link-146');">model_list</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L166"></a><tt class="py-lineno"> 166</tt>  <tt class="py-line"> </tt>
<a name="L167"></a><tt class="py-lineno"> 167</tt>  <tt class="py-line">        <tt class="py-comment"># Store the spin specific data in lists for later use.</tt> </tt>
<a name="L168"></a><tt class="py-lineno"> 168</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-147" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-147', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">mol_name</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">,</tt> <tt id="link-148" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-148', 'spin_id', 'link-126');">spin_id</a></tt> <tt class="py-keyword">in</tt> <tt id="link-149" class="py-name"><a title="pipe_control.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-149', 'spin_loop', 'link-45');">spin_loop</a></tt><tt class="py-op">(</tt><tt class="py-name">full_info</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">return_id</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L169"></a><tt class="py-lineno"> 169</tt>  <tt class="py-line">            <tt class="py-comment"># Skip the protons.</tt> </tt>
<a name="L170"></a><tt class="py-lineno"> 170</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-150" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-150', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-151" class="py-name" targets="Variable bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name=bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe-class.html#name,Variable bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name=bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1-class.html#name,Variable bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name=bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name=bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name=bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name=bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name=bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1-class.html#name,Variable pipe_control.pipes.name=pipe_control.pipes-module.html#name,Variable user_functions.pipe.name=user_functions.pipe-module.html#name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-151', 'name', 'link-151');">name</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'H'</tt> <tt class="py-keyword">or</tt> <tt class="py-op">(</tt><tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-152" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-152', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'element'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt id="link-153" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-153', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-154" class="py-name" targets="Variable lib.periodic_table.element=lib.periodic_table-module.html#element"><a title="lib.periodic_table.element" class="py-name" href="#" onclick="return doclink('link-154', 'element', 'link-154');">element</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'H'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L171"></a><tt class="py-lineno"> 171</tt>  <tt class="py-line">                <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-155" class="py-name" targets="Class lib.warnings.RelaxWarning=lib.warnings.RelaxWarning-class.html"><a title="lib.warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-155', 'RelaxWarning', 'link-155');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"Skipping the proton spin '%s'."</tt> <tt class="py-op">%</tt> <tt id="link-156" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-156', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L172"></a><tt class="py-lineno"> 172</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L173"></a><tt class="py-lineno"> 173</tt>  <tt class="py-line"> </tt>
<a name="L174"></a><tt class="py-lineno"> 174</tt>  <tt class="py-line">            <tt class="py-comment"># Check the data for None (not allowed in BMRB!).</tt> </tt>
<a name="L175"></a><tt class="py-lineno"> 175</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">res_num</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L176"></a><tt class="py-lineno"> 176</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-157" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-157', 'RelaxError', 'link-18');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"For the BMRB, the residue of spin '%s' must be numbered."</tt> <tt class="py-op">%</tt> <tt id="link-158" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-158', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L177"></a><tt class="py-lineno"> 177</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">res_name</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L178"></a><tt class="py-lineno"> 178</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-159" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-159', 'RelaxError', 'link-18');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"For the BMRB, the residue of spin '%s' must be named."</tt> <tt class="py-op">%</tt> <tt id="link-160" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-160', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L179"></a><tt class="py-lineno"> 179</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-161" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-161', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-162" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-162', 'name', 'link-151');">name</a></tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L180"></a><tt class="py-lineno"> 180</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-163" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-163', 'RelaxError', 'link-18');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"For the BMRB, the spin '%s' must be named."</tt> <tt class="py-op">%</tt> <tt id="link-164" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-164', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L181"></a><tt class="py-lineno"> 181</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-165" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-165', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'isotope'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt id="link-166" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-166', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">isotope</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L182"></a><tt class="py-lineno"> 182</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-167" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-167', 'RelaxError', 'link-18');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"For the BMRB, the spin isotope type of '%s' must be specified."</tt> <tt class="py-op">%</tt> <tt id="link-168" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-168', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L183"></a><tt class="py-lineno"> 183</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-169" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-169', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'element'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt id="link-170" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-170', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-171" class="py-name"><a title="lib.periodic_table.element" class="py-name" href="#" onclick="return doclink('link-171', 'element', 'link-154');">element</a></tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L184"></a><tt class="py-lineno"> 184</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-172" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-172', 'RelaxError', 'link-18');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"For the BMRB, the spin element type of '%s' must be specified.  Please use the spin user function for setting the element type."</tt> <tt class="py-op">%</tt> <tt id="link-173" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-173', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L185"></a><tt class="py-lineno"> 185</tt>  <tt class="py-line"> </tt>
<a name="L186"></a><tt class="py-lineno"> 186</tt>  <tt class="py-line">            <tt class="py-comment"># The molecule/residue/spin info.</tt> </tt>
<a name="L187"></a><tt class="py-lineno"> 187</tt>  <tt class="py-line">            <tt class="py-name">mol_name_list</tt><tt class="py-op">.</tt><tt id="link-174" class="py-name" targets="Method data_store.align_tensor.AlignTensorSimList.append()=data_store.align_tensor.AlignTensorSimList-class.html#append,Method data_store.diff_tensor.DiffTensorSimList.append()=data_store.diff_tensor.DiffTensorSimList-class.html#append"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-174', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">mol_name</tt><tt class="py-op">)</tt> </tt>
<a name="L188"></a><tt class="py-lineno"> 188</tt>  <tt class="py-line">            <tt class="py-name">res_num_list</tt><tt class="py-op">.</tt><tt id="link-175" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-175', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">res_num</tt><tt class="py-op">)</tt> </tt>
<a name="L189"></a><tt class="py-lineno"> 189</tt>  <tt class="py-line">            <tt class="py-name">res_name_list</tt><tt class="py-op">.</tt><tt id="link-176" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-176', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">res_name</tt><tt class="py-op">)</tt> </tt>
<a name="L190"></a><tt class="py-lineno"> 190</tt>  <tt class="py-line">            <tt class="py-name">atom_name_list</tt><tt class="py-op">.</tt><tt id="link-177" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-177', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt id="link-178" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-178', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-179" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-179', 'name', 'link-151');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L191"></a><tt class="py-lineno"> 191</tt>  <tt class="py-line"> </tt>
<a name="L192"></a><tt class="py-lineno"> 192</tt>  <tt class="py-line">            <tt class="py-comment"># The nuclear isotope.</tt> </tt>
<a name="L193"></a><tt class="py-lineno"> 193</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-180" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-180', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'isotope'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L194"></a><tt class="py-lineno"> 194</tt>  <tt class="py-line">                <tt class="py-name">isotope_list</tt><tt class="py-op">.</tt><tt id="link-181" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-181', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">int</tt><tt class="py-op">(</tt><tt id="link-182" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-182', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">isotope</tt><tt class="py-op">.</tt><tt id="link-183" class="py-name" targets="Function lib.io.strip()=lib.io-module.html#strip"><a title="lib.io.strip" class="py-name" href="#" onclick="return doclink('link-183', 'strip', 'link-183');">strip</a></tt><tt class="py-op">(</tt><tt id="link-184" class="py-name"><a title="lib.text.string" class="py-name" href="#" onclick="return doclink('link-184', 'string', 'link-3');">string</a></tt><tt class="py-op">.</tt><tt class="py-name">ascii_letters</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L195"></a><tt class="py-lineno"> 195</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L196"></a><tt class="py-lineno"> 196</tt>  <tt class="py-line">                <tt class="py-name">isotope_list</tt><tt class="py-op">.</tt><tt id="link-185" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-185', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">None</tt><tt class="py-op">)</tt> </tt>
<a name="L197"></a><tt class="py-lineno"> 197</tt>  <tt class="py-line"> </tt>
<a name="L198"></a><tt class="py-lineno"> 198</tt>  <tt class="py-line">            <tt class="py-comment"># The element.</tt> </tt>
<a name="L199"></a><tt class="py-lineno"> 199</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-186" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-186', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'element'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L200"></a><tt class="py-lineno"> 200</tt>  <tt class="py-line">                <tt class="py-name">element_list</tt><tt class="py-op">.</tt><tt id="link-187" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-187', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt id="link-188" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-188', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-189" class="py-name"><a title="lib.periodic_table.element" class="py-name" href="#" onclick="return doclink('link-189', 'element', 'link-154');">element</a></tt><tt class="py-op">)</tt> </tt>
<a name="L201"></a><tt class="py-lineno"> 201</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L202"></a><tt class="py-lineno"> 202</tt>  <tt class="py-line">                <tt class="py-name">element_list</tt><tt class="py-op">.</tt><tt id="link-190" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-190', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">None</tt><tt class="py-op">)</tt> </tt>
<a name="L203"></a><tt class="py-lineno"> 203</tt>  <tt class="py-line"> </tt>
<a name="L204"></a><tt class="py-lineno"> 204</tt>  <tt class="py-line">            <tt class="py-comment"># Opt stats.</tt> </tt>
<a name="L205"></a><tt class="py-lineno"> 205</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-191" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-191', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'chi2'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L206"></a><tt class="py-lineno"> 206</tt>  <tt class="py-line">                <tt class="py-name">chi2_list</tt><tt class="py-op">.</tt><tt id="link-192" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-192', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt id="link-193" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-193', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-194" class="py-name" targets="Module target_functions.chi2=target_functions.chi2-module.html,Function target_functions.chi2.chi2()=target_functions.chi2-module.html#chi2"><a title="target_functions.chi2
target_functions.chi2.chi2" class="py-name" href="#" onclick="return doclink('link-194', 'chi2', 'link-194');">chi2</a></tt><tt class="py-op">)</tt> </tt>
<a name="L207"></a><tt class="py-lineno"> 207</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L208"></a><tt class="py-lineno"> 208</tt>  <tt class="py-line">                <tt class="py-name">chi2_list</tt><tt class="py-op">.</tt><tt id="link-195" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-195', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">None</tt><tt class="py-op">)</tt> </tt>
<a name="L209"></a><tt class="py-lineno"> 209</tt>  <tt class="py-line"> </tt>
<a name="L210"></a><tt class="py-lineno"> 210</tt>  <tt class="py-line">            <tt class="py-comment"># Model-free model.</tt> </tt>
<a name="L211"></a><tt class="py-lineno"> 211</tt>  <tt class="py-line">            <tt id="link-196" class="py-name"><a title="gui.analyses.elements.model_list" class="py-name" href="#" onclick="return doclink('link-196', 'model_list', 'link-146');">model_list</a></tt><tt class="py-op">.</tt><tt id="link-197" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-197', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt id="link-198" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-198', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-199" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-199', 'model', 'link-131');">model</a></tt><tt class="py-op">)</tt> </tt>
<a name="L212"></a><tt class="py-lineno"> 212</tt>  <tt class="py-line"> </tt>
<a name="L213"></a><tt class="py-lineno"> 213</tt>  <tt class="py-line">        <tt class="py-comment"># Convert the molecule names into the entity IDs.</tt> </tt>
<a name="L214"></a><tt class="py-lineno"> 214</tt>  <tt class="py-line">        <tt class="py-name">entity_ids</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">mol_name_list</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">int32</tt><tt class="py-op">)</tt> </tt>
<a name="L215"></a><tt class="py-lineno"> 215</tt>  <tt class="py-line">        <tt class="py-name">mol_names</tt> <tt class="py-op">=</tt> <tt id="link-200" class="py-name"><a title="pipe_control.mol_res_spin.get_molecule_names" class="py-name" href="#" onclick="return doclink('link-200', 'get_molecule_names', 'link-43');">get_molecule_names</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L216"></a><tt class="py-lineno"> 216</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-201" class="py-name" targets="Variable user_functions.molecule.i=user_functions.molecule-module.html#i"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-201', 'i', 'link-201');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">mol_name_list</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L217"></a><tt class="py-lineno"> 217</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">j</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">mol_names</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L218"></a><tt class="py-lineno"> 218</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">mol_name_list</tt><tt class="py-op">[</tt><tt id="link-202" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-202', 'i', 'link-201');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-name">mol_names</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L219"></a><tt class="py-lineno"> 219</tt>  <tt class="py-line">                    <tt class="py-name">entity_ids</tt><tt class="py-op">[</tt><tt id="link-203" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-203', 'i', 'link-201');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">j</tt><tt class="py-op">+</tt><tt class="py-number">1</tt> </tt>
<a name="L220"></a><tt class="py-lineno"> 220</tt>  <tt class="py-line"> </tt>
<a name="L221"></a><tt class="py-lineno"> 221</tt>  <tt class="py-line"> </tt>
<a name="L222"></a><tt class="py-lineno"> 222</tt>  <tt class="py-line">        <tt class="py-comment"># Create Supergroup 2 : The citations.</tt> </tt>
<a name="L223"></a><tt class="py-lineno"> 223</tt>  <tt class="py-line">        <tt class="py-comment">######################################</tt> </tt>
<a name="L224"></a><tt class="py-lineno"> 224</tt>  <tt class="py-line"> </tt>
<a name="L225"></a><tt class="py-lineno"> 225</tt>  <tt class="py-line">        <tt class="py-comment"># Generate the citations saveframe.</tt> </tt>
<a name="L226"></a><tt class="py-lineno"> 226</tt>  <tt class="py-line">        <tt id="link-204" class="py-name"><a title="pipe_control.exp_info.bmrb_write_citations" class="py-name" href="#" onclick="return doclink('link-204', 'bmrb_write_citations', 'link-36');">bmrb_write_citations</a></tt><tt class="py-op">(</tt><tt class="py-name">star</tt><tt class="py-op">)</tt> </tt>
<a name="L227"></a><tt class="py-lineno"> 227</tt>  <tt class="py-line"> </tt>
<a name="L228"></a><tt class="py-lineno"> 228</tt>  <tt class="py-line"> </tt>
<a name="L229"></a><tt class="py-lineno"> 229</tt>  <tt class="py-line">        <tt class="py-comment"># Create Supergroup 3 : The molecular assembly saveframes.</tt> </tt>
<a name="L230"></a><tt class="py-lineno"> 230</tt>  <tt class="py-line">        <tt class="py-comment">##########################################################</tt> </tt>
<a name="L231"></a><tt class="py-lineno"> 231</tt>  <tt class="py-line"> </tt>
<a name="L232"></a><tt class="py-lineno"> 232</tt>  <tt class="py-line">        <tt class="py-comment"># Generate the entity saveframe.</tt> </tt>
<a name="L233"></a><tt class="py-lineno"> 233</tt>  <tt class="py-line">        <tt id="link-205" class="py-name"><a title="pipe_control.mol_res_spin.bmrb_write_entity" class="py-name" href="#" onclick="return doclink('link-205', 'bmrb_write_entity', 'link-41');">bmrb_write_entity</a></tt><tt class="py-op">(</tt><tt class="py-name">star</tt><tt class="py-op">)</tt> </tt>
<a name="L234"></a><tt class="py-lineno"> 234</tt>  <tt class="py-line"> </tt>
<a name="L235"></a><tt class="py-lineno"> 235</tt>  <tt class="py-line"> </tt>
<a name="L236"></a><tt class="py-lineno"> 236</tt>  <tt class="py-line">        <tt class="py-comment"># Create Supergroup 4:  The experimental descriptions saveframes.</tt> </tt>
<a name="L237"></a><tt class="py-lineno"> 237</tt>  <tt class="py-line">        <tt class="py-comment">#################################################################</tt> </tt>
<a name="L238"></a><tt class="py-lineno"> 238</tt>  <tt class="py-line"> </tt>
<a name="L239"></a><tt class="py-lineno"> 239</tt>  <tt class="py-line">        <tt class="py-comment"># Generate the method saveframes.</tt> </tt>
<a name="L240"></a><tt class="py-lineno"> 240</tt>  <tt class="py-line">        <tt id="link-206" class="py-name"><a title="pipe_control.exp_info.bmrb_write_methods" class="py-name" href="#" onclick="return doclink('link-206', 'bmrb_write_methods', 'link-37');">bmrb_write_methods</a></tt><tt class="py-op">(</tt><tt class="py-name">star</tt><tt class="py-op">)</tt> </tt>
<a name="L241"></a><tt class="py-lineno"> 241</tt>  <tt class="py-line"> </tt>
<a name="L242"></a><tt class="py-lineno"> 242</tt>  <tt class="py-line">        <tt class="py-comment"># Generate the software saveframe.</tt> </tt>
<a name="L243"></a><tt class="py-lineno"> 243</tt>  <tt class="py-line">        <tt class="py-name">software_ids</tt><tt class="py-op">,</tt> <tt class="py-name">software_labels</tt> <tt class="py-op">=</tt> <tt id="link-207" class="py-name"><a title="pipe_control.exp_info.bmrb_write_software" class="py-name" href="#" onclick="return doclink('link-207', 'bmrb_write_software', 'link-38');">bmrb_write_software</a></tt><tt class="py-op">(</tt><tt class="py-name">star</tt><tt class="py-op">)</tt> </tt>
</div><a name="L244"></a><tt class="py-lineno"> 244</tt>  <tt class="py-line"> </tt>
<a name="L245"></a><tt class="py-lineno"> 245</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.calculate"></a><div id="Relax_disp.calculate-def"><a name="L246"></a><tt class="py-lineno"> 246</tt> <a class="py-toggle" href="#" id="Relax_disp.calculate-toggle" onclick="return toggle('Relax_disp.calculate');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#calculate">calculate</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">spin_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">scaling_matrix</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">verbosity</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-param">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.calculate-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.calculate-expanded"><a name="L247"></a><tt class="py-lineno"> 247</tt>  <tt class="py-line">        <tt class="py-docstring">"""Calculate the model chi-squared value or the R2eff values for fixed time period data.</tt> </tt>
<a name="L248"></a><tt class="py-lineno"> 248</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L249"></a><tt class="py-lineno"> 249</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword spin_id:           The spin identification string.</tt> </tt>
<a name="L250"></a><tt class="py-lineno"> 250</tt>  <tt class="py-line"><tt class="py-docstring">        @type spin_id:              None or str</tt> </tt>
<a name="L251"></a><tt class="py-lineno"> 251</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword scaling_matrix:    The per-model list of diagonal and square scaling matrices.</tt> </tt>
<a name="L252"></a><tt class="py-lineno"> 252</tt>  <tt class="py-line"><tt class="py-docstring">        @type scaling_matrix:       list of numpy rank-2, float64 array or list of None</tt> </tt>
<a name="L253"></a><tt class="py-lineno"> 253</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword verbosity:         The amount of information to print.  The higher the value, the greater the verbosity.</tt> </tt>
<a name="L254"></a><tt class="py-lineno"> 254</tt>  <tt class="py-line"><tt class="py-docstring">        @type verbosity:            int</tt> </tt>
<a name="L255"></a><tt class="py-lineno"> 255</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword sim_index:         The MC simulation index (unused).</tt> </tt>
<a name="L256"></a><tt class="py-lineno"> 256</tt>  <tt class="py-line"><tt class="py-docstring">        @type sim_index:            None</tt> </tt>
<a name="L257"></a><tt class="py-lineno"> 257</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L258"></a><tt class="py-lineno"> 258</tt>  <tt class="py-line"> </tt>
<a name="L259"></a><tt class="py-lineno"> 259</tt>  <tt class="py-line">        <tt class="py-comment"># Data checks.</tt> </tt>
<a name="L260"></a><tt class="py-lineno"> 260</tt>  <tt class="py-line">        <tt id="link-208" class="py-name"><a title="pipe_control.pipes.check_pipe" class="py-name" href="#" onclick="return doclink('link-208', 'check_pipe', 'link-48');">check_pipe</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L261"></a><tt class="py-lineno"> 261</tt>  <tt class="py-line">        <tt id="link-209" class="py-name"><a title="pipe_control.mol_res_spin.check_mol_res_spin_data" class="py-name" href="#" onclick="return doclink('link-209', 'check_mol_res_spin_data', 'link-42');">check_mol_res_spin_data</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L262"></a><tt class="py-lineno"> 262</tt>  <tt class="py-line">        <tt id="link-210" class="py-name"><a title="specific_analyses.relax_disp.checks.check_model_type" class="py-name" href="#" onclick="return doclink('link-210', 'check_model_type', 'link-64');">check_model_type</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L263"></a><tt class="py-lineno"> 263</tt>  <tt class="py-line"> </tt>
<a name="L264"></a><tt class="py-lineno"> 264</tt>  <tt class="py-line">        <tt class="py-comment"># Special exponential curve-fitting for the R2eff model.</tt> </tt>
<a name="L265"></a><tt class="py-lineno"> 265</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-211" class="py-name"><a title="specific_analyses.api_base.API_base.model_type
specific_analyses.hybrid.Hybrid.model_type
specific_analyses.model_free.api.Model_free.model_type" class="py-name" href="#" onclick="return doclink('link-211', 'model_type', 'link-106');">model_type</a></tt> <tt class="py-op">==</tt> <tt id="link-212" class="py-name"><a title="lib.dispersion.variables.MODEL_R2EFF" class="py-name" href="#" onclick="return doclink('link-212', 'MODEL_R2EFF', 'link-14');">MODEL_R2EFF</a></tt><tt class="py-op">:</tt> </tt>
<a name="L266"></a><tt class="py-lineno"> 266</tt>  <tt class="py-line">            <tt id="link-213" class="py-name"><a title="specific_analyses.relax_disp.optimisation.calculate_r2eff" class="py-name" href="#" onclick="return doclink('link-213', 'calculate_r2eff', 'link-88');">calculate_r2eff</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L267"></a><tt class="py-lineno"> 267</tt>  <tt class="py-line"> </tt>
<a name="L268"></a><tt class="py-lineno"> 268</tt>  <tt class="py-line">        <tt class="py-comment"># Calculate the chi-squared value.</tt> </tt>
<a name="L269"></a><tt class="py-lineno"> 269</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L270"></a><tt class="py-lineno"> 270</tt>  <tt class="py-line">            <tt class="py-comment"># 1H MMQ flag.</tt> </tt>
<a name="L271"></a><tt class="py-lineno"> 271</tt>  <tt class="py-line">            <tt class="py-name">proton_mmq_flag</tt> <tt class="py-op">=</tt> <tt id="link-214" class="py-name"><a title="specific_analyses.relax_disp.data.has_proton_mmq_cpmg" class="py-name" href="#" onclick="return doclink('link-214', 'has_proton_mmq_cpmg', 'link-73');">has_proton_mmq_cpmg</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L272"></a><tt class="py-lineno"> 272</tt>  <tt class="py-line"> </tt>
<a name="L273"></a><tt class="py-lineno"> 273</tt>  <tt class="py-line">            <tt class="py-comment"># Loop over the spin blocks.</tt> </tt>
<a name="L274"></a><tt class="py-lineno"> 274</tt>  <tt class="py-line">            <tt class="py-name">model_index</tt> <tt class="py-op">=</tt> <tt class="py-op">-</tt><tt class="py-number">1</tt> </tt>
<a name="L275"></a><tt class="py-lineno"> 275</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">spin_ids</tt> <tt class="py-keyword">in</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-215" class="py-name" targets="Method lib.structure.internal.object.Internal.model_loop()=lib.structure.internal.object.Internal-class.html#model_loop,Method specific_analyses.api_base.API_base.model_loop()=specific_analyses.api_base.API_base-class.html#model_loop,Method specific_analyses.hybrid.Hybrid.model_loop()=specific_analyses.hybrid.Hybrid-class.html#model_loop,Method specific_analyses.model_free.api.Model_free.model_loop()=specific_analyses.model_free.api.Model_free-class.html#model_loop,Method specific_analyses.relax_disp.api.Relax_disp.model_loop()=specific_analyses.relax_disp.api.Relax_disp-class.html#model_loop"><a title="lib.structure.internal.object.Internal.model_loop
specific_analyses.api_base.API_base.model_loop
specific_analyses.hybrid.Hybrid.model_loop
specific_analyses.model_free.api.Model_free.model_loop
specific_analyses.relax_disp.api.Relax_disp.model_loop" class="py-name" href="#" onclick="return doclink('link-215', 'model_loop', 'link-215');">model_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L276"></a><tt class="py-lineno"> 276</tt>  <tt class="py-line">                <tt class="py-comment"># Increment the model index.</tt> </tt>
<a name="L277"></a><tt class="py-lineno"> 277</tt>  <tt class="py-line">                <tt class="py-name">model_index</tt> <tt class="py-op">+=</tt> <tt class="py-number">1</tt> </tt>
<a name="L278"></a><tt class="py-lineno"> 278</tt>  <tt class="py-line"> </tt>
<a name="L279"></a><tt class="py-lineno"> 279</tt>  <tt class="py-line">                <tt class="py-comment"># The spin containers.</tt> </tt>
<a name="L280"></a><tt class="py-lineno"> 280</tt>  <tt class="py-line">                <tt class="py-name">spins</tt> <tt class="py-op">=</tt> <tt id="link-216" class="py-name"><a title="specific_analyses.relax_disp.data.spin_ids_to_containers" class="py-name" href="#" onclick="return doclink('link-216', 'spin_ids_to_containers', 'link-80');">spin_ids_to_containers</a></tt><tt class="py-op">(</tt><tt class="py-name">spin_ids</tt><tt class="py-op">)</tt> </tt>
<a name="L281"></a><tt class="py-lineno"> 281</tt>  <tt class="py-line"> </tt>
<a name="L282"></a><tt class="py-lineno"> 282</tt>  <tt class="py-line">                <tt class="py-comment"># Skip deselected clusters.</tt> </tt>
<a name="L283"></a><tt class="py-lineno"> 283</tt>  <tt class="py-line">                <tt class="py-name">skip</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L284"></a><tt class="py-lineno"> 284</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt id="link-217" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-217', 'spin', 'link-115');">spin</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">spins</tt><tt class="py-op">:</tt> </tt>
<a name="L285"></a><tt class="py-lineno"> 285</tt>  <tt class="py-line">                    <tt class="py-keyword">if</tt> <tt id="link-218" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-218', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-219" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-219', 'select', 'link-118');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L286"></a><tt class="py-lineno"> 286</tt>  <tt class="py-line">                        <tt class="py-name">skip</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L287"></a><tt class="py-lineno"> 287</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">skip</tt><tt class="py-op">:</tt> </tt>
<a name="L288"></a><tt class="py-lineno"> 288</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L289"></a><tt class="py-lineno"> 289</tt>  <tt class="py-line"> </tt>
<a name="L290"></a><tt class="py-lineno"> 290</tt>  <tt class="py-line">                <tt class="py-comment"># The back calculated values.</tt> </tt>
<a name="L291"></a><tt class="py-lineno"> 291</tt>  <tt class="py-line">                <tt id="link-220" class="py-name" targets="Function pipe_control.pcs.back_calc()=pipe_control.pcs-module.html#back_calc,Function pipe_control.rdc.back_calc()=pipe_control.rdc-module.html#back_calc,Function pipe_control.relax_data.back_calc()=pipe_control.relax_data-module.html#back_calc,Function specific_analyses.relax_fit.optimisation.back_calc()=specific_analyses.relax_fit.optimisation-module.html#back_calc"><a title="pipe_control.pcs.back_calc
pipe_control.rdc.back_calc
pipe_control.relax_data.back_calc
specific_analyses.relax_fit.optimisation.back_calc" class="py-name" href="#" onclick="return doclink('link-220', 'back_calc', 'link-220');">back_calc</a></tt> <tt class="py-op">=</tt> <tt id="link-221" class="py-name"><a title="specific_analyses.relax_disp.optimisation.back_calc_r2eff" class="py-name" href="#" onclick="return doclink('link-221', 'back_calc_r2eff', 'link-87');">back_calc_r2eff</a></tt><tt class="py-op">(</tt><tt class="py-name">spins</tt><tt class="py-op">=</tt><tt class="py-name">spins</tt><tt class="py-op">,</tt> <tt class="py-name">spin_ids</tt><tt class="py-op">=</tt><tt class="py-name">spin_ids</tt><tt class="py-op">,</tt> <tt class="py-name">store_chi2</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L292"></a><tt class="py-lineno"> 292</tt>  <tt class="py-line"> </tt>
<a name="L293"></a><tt class="py-lineno"> 293</tt>  <tt class="py-line">                <tt class="py-comment"># Pack the data.</tt> </tt>
<a name="L294"></a><tt class="py-lineno"> 294</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt id="link-222" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-222', 'i', 'link-201');">i</a></tt><tt class="py-op">,</tt> <tt id="link-223" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-223', 'spin_id', 'link-126');">spin_id</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">enumerate</tt><tt class="py-op">(</tt><tt class="py-name">spin_ids</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L295"></a><tt class="py-lineno"> 295</tt>  <tt class="py-line">                    <tt id="link-224" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-224', 'spin', 'link-115');">spin</a></tt> <tt class="py-op">=</tt> <tt class="py-name">spins</tt><tt class="py-op">[</tt><tt id="link-225" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-225', 'i', 'link-201');">i</a></tt><tt class="py-op">]</tt> </tt>
<a name="L296"></a><tt class="py-lineno"> 296</tt>  <tt class="py-line">                    <tt id="link-226" class="py-name"><a title="specific_analyses.relax_disp.data.pack_back_calc_r2eff" class="py-name" href="#" onclick="return doclink('link-226', 'pack_back_calc_r2eff', 'link-78');">pack_back_calc_r2eff</a></tt><tt class="py-op">(</tt><tt id="link-227" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-227', 'spin', 'link-115');">spin</a></tt><tt class="py-op">=</tt><tt id="link-228" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-228', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt id="link-229" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-229', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">=</tt><tt id="link-230" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-230', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">,</tt> <tt class="py-name">si</tt><tt class="py-op">=</tt><tt id="link-231" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-231', 'i', 'link-201');">i</a></tt><tt class="py-op">,</tt> <tt id="link-232" class="py-name"><a title="pipe_control.pcs.back_calc
pipe_control.rdc.back_calc
pipe_control.relax_data.back_calc
specific_analyses.relax_fit.optimisation.back_calc" class="py-name" href="#" onclick="return doclink('link-232', 'back_calc', 'link-220');">back_calc</a></tt><tt class="py-op">=</tt><tt id="link-233" class="py-name"><a title="pipe_control.pcs.back_calc
pipe_control.rdc.back_calc
pipe_control.relax_data.back_calc
specific_analyses.relax_fit.optimisation.back_calc" class="py-name" href="#" onclick="return doclink('link-233', 'back_calc', 'link-220');">back_calc</a></tt><tt class="py-op">,</tt> <tt class="py-name">proton_mmq_flag</tt><tt class="py-op">=</tt><tt class="py-name">proton_mmq_flag</tt><tt class="py-op">)</tt> </tt>
</div><a name="L297"></a><tt class="py-lineno"> 297</tt>  <tt class="py-line"> </tt>
<a name="L298"></a><tt class="py-lineno"> 298</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.constraint_algorithm"></a><div id="Relax_disp.constraint_algorithm-def"><a name="L299"></a><tt class="py-lineno"> 299</tt> <a class="py-toggle" href="#" id="Relax_disp.constraint_algorithm-toggle" onclick="return toggle('Relax_disp.constraint_algorithm');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#constraint_algorithm">constraint_algorithm</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.constraint_algorithm-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.constraint_algorithm-expanded"><a name="L300"></a><tt class="py-lineno"> 300</tt>  <tt class="py-line">        <tt class="py-docstring">"""Return the 'Log barrier' optimisation constraint algorithm.</tt> </tt>
<a name="L301"></a><tt class="py-lineno"> 301</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L302"></a><tt class="py-lineno"> 302</tt>  <tt class="py-line"><tt class="py-docstring">        @return:    The 'Log barrier' constraint algorithm.</tt> </tt>
<a name="L303"></a><tt class="py-lineno"> 303</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:     str</tt> </tt>
<a name="L304"></a><tt class="py-lineno"> 304</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L305"></a><tt class="py-lineno"> 305</tt>  <tt class="py-line"> </tt>
<a name="L306"></a><tt class="py-lineno"> 306</tt>  <tt class="py-line">        <tt class="py-comment"># The log barrier algorithm, as required by minfx.</tt> </tt>
<a name="L307"></a><tt class="py-lineno"> 307</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-string">'Log barrier'</tt> </tt>
</div><a name="L308"></a><tt class="py-lineno"> 308</tt>  <tt class="py-line"> </tt>
<a name="L309"></a><tt class="py-lineno"> 309</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.create_mc_data"></a><div id="Relax_disp.create_mc_data-def"><a name="L310"></a><tt class="py-lineno"> 310</tt> <a class="py-toggle" href="#" id="Relax_disp.create_mc_data-toggle" onclick="return toggle('Relax_disp.create_mc_data');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#create_mc_data">create_mc_data</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">data_id</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.create_mc_data-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.create_mc_data-expanded"><a name="L311"></a><tt class="py-lineno"> 311</tt>  <tt class="py-line">        <tt class="py-docstring">"""Create the Monte Carlo peak intensity data.</tt> </tt>
<a name="L312"></a><tt class="py-lineno"> 312</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L313"></a><tt class="py-lineno"> 313</tt>  <tt class="py-line"><tt class="py-docstring">        @param data_id: The tuple of the spin container and the exponential curve identifying key, as yielded by the base_data_loop() generator method.</tt> </tt>
<a name="L314"></a><tt class="py-lineno"> 314</tt>  <tt class="py-line"><tt class="py-docstring">        @type data_id:  SpinContainer instance and float</tt> </tt>
<a name="L315"></a><tt class="py-lineno"> 315</tt>  <tt class="py-line"><tt class="py-docstring">        @return:        The Monte Carlo simulation data.</tt> </tt>
<a name="L316"></a><tt class="py-lineno"> 316</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:         list of floats</tt> </tt>
<a name="L317"></a><tt class="py-lineno"> 317</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L318"></a><tt class="py-lineno"> 318</tt>  <tt class="py-line"> </tt>
<a name="L319"></a><tt class="py-lineno"> 319</tt>  <tt class="py-line">        <tt class="py-comment"># The R2eff model (with peak intensity base data).</tt> </tt>
<a name="L320"></a><tt class="py-lineno"> 320</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-234" class="py-name"><a title="specific_analyses.api_base.API_base.model_type
specific_analyses.hybrid.Hybrid.model_type
specific_analyses.model_free.api.Model_free.model_type" class="py-name" href="#" onclick="return doclink('link-234', 'model_type', 'link-106');">model_type</a></tt> <tt class="py-op">==</tt> <tt id="link-235" class="py-name"><a title="lib.dispersion.variables.MODEL_R2EFF" class="py-name" href="#" onclick="return doclink('link-235', 'MODEL_R2EFF', 'link-14');">MODEL_R2EFF</a></tt><tt class="py-op">:</tt> </tt>
<a name="L321"></a><tt class="py-lineno"> 321</tt>  <tt class="py-line">            <tt class="py-comment"># Unpack the data.</tt> </tt>
<a name="L322"></a><tt class="py-lineno"> 322</tt>  <tt class="py-line">            <tt id="link-236" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-236', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">exp_type</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt><tt class="py-op">,</tt> <tt id="link-237" class="py-name"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-237', 'offset', 'link-120');">offset</a></tt><tt class="py-op">,</tt> <tt class="py-name">point</tt> <tt class="py-op">=</tt> <tt class="py-name">data_id</tt> </tt>
<a name="L323"></a><tt class="py-lineno"> 323</tt>  <tt class="py-line"> </tt>
<a name="L324"></a><tt class="py-lineno"> 324</tt>  <tt class="py-line">            <tt class="py-comment"># Back calculate the peak intensities.</tt> </tt>
<a name="L325"></a><tt class="py-lineno"> 325</tt>  <tt class="py-line">            <tt class="py-name">values</tt> <tt class="py-op">=</tt> <tt id="link-238" class="py-name"><a title="specific_analyses.relax_disp.optimisation.back_calc_peak_intensities" class="py-name" href="#" onclick="return doclink('link-238', 'back_calc_peak_intensities', 'link-86');">back_calc_peak_intensities</a></tt><tt class="py-op">(</tt><tt id="link-239" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-239', 'spin', 'link-115');">spin</a></tt><tt class="py-op">=</tt><tt id="link-240" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-240', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">exp_type</tt><tt class="py-op">=</tt><tt class="py-name">exp_type</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt><tt class="py-op">=</tt><tt class="py-name">frq</tt><tt class="py-op">,</tt> <tt id="link-241" class="py-name"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-241', 'offset', 'link-120');">offset</a></tt><tt class="py-op">=</tt><tt id="link-242" class="py-name"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-242', 'offset', 'link-120');">offset</a></tt><tt class="py-op">,</tt> <tt class="py-name">point</tt><tt class="py-op">=</tt><tt class="py-name">point</tt><tt class="py-op">)</tt> </tt>
<a name="L326"></a><tt class="py-lineno"> 326</tt>  <tt class="py-line"> </tt>
<a name="L327"></a><tt class="py-lineno"> 327</tt>  <tt class="py-line">        <tt class="py-comment"># All other models (with R2eff/R1rho base data).</tt> </tt>
<a name="L328"></a><tt class="py-lineno"> 328</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L329"></a><tt class="py-lineno"> 329</tt>  <tt class="py-line">            <tt class="py-comment"># 1H MMQ flag.</tt> </tt>
<a name="L330"></a><tt class="py-lineno"> 330</tt>  <tt class="py-line">            <tt class="py-name">proton_mmq_flag</tt> <tt class="py-op">=</tt> <tt id="link-243" class="py-name"><a title="specific_analyses.relax_disp.data.has_proton_mmq_cpmg" class="py-name" href="#" onclick="return doclink('link-243', 'has_proton_mmq_cpmg', 'link-73');">has_proton_mmq_cpmg</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L331"></a><tt class="py-lineno"> 331</tt>  <tt class="py-line"> </tt>
<a name="L332"></a><tt class="py-lineno"> 332</tt>  <tt class="py-line">            <tt class="py-comment"># Unpack the data.</tt> </tt>
<a name="L333"></a><tt class="py-lineno"> 333</tt>  <tt class="py-line">            <tt id="link-244" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-244', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt id="link-245" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-245', 'spin_id', 'link-126');">spin_id</a></tt> <tt class="py-op">=</tt> <tt class="py-name">data_id</tt> </tt>
<a name="L334"></a><tt class="py-lineno"> 334</tt>  <tt class="py-line"> </tt>
<a name="L335"></a><tt class="py-lineno"> 335</tt>  <tt class="py-line">            <tt class="py-comment"># Back calculate the R2eff/R1rho data.</tt> </tt>
<a name="L336"></a><tt class="py-lineno"> 336</tt>  <tt class="py-line">            <tt id="link-246" class="py-name"><a title="pipe_control.pcs.back_calc
pipe_control.rdc.back_calc
pipe_control.relax_data.back_calc
specific_analyses.relax_fit.optimisation.back_calc" class="py-name" href="#" onclick="return doclink('link-246', 'back_calc', 'link-220');">back_calc</a></tt> <tt class="py-op">=</tt> <tt id="link-247" class="py-name"><a title="specific_analyses.relax_disp.optimisation.back_calc_r2eff" class="py-name" href="#" onclick="return doclink('link-247', 'back_calc_r2eff', 'link-87');">back_calc_r2eff</a></tt><tt class="py-op">(</tt><tt class="py-name">spins</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt id="link-248" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-248', 'spin', 'link-115');">spin</a></tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">spin_ids</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt id="link-249" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-249', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L337"></a><tt class="py-lineno"> 337</tt>  <tt class="py-line"> </tt>
<a name="L338"></a><tt class="py-lineno"> 338</tt>  <tt class="py-line">            <tt class="py-comment"># Get the attached proton data.</tt> </tt>
<a name="L339"></a><tt class="py-lineno"> 339</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">proton_mmq_flag</tt><tt class="py-op">:</tt> </tt>
<a name="L340"></a><tt class="py-lineno"> 340</tt>  <tt class="py-line">                <tt class="py-name">proton</tt> <tt class="py-op">=</tt> <tt id="link-250" class="py-name"><a title="pipe_control.sequence.return_attached_protons" class="py-name" href="#" onclick="return doclink('link-250', 'return_attached_protons', 'link-54');">return_attached_protons</a></tt><tt class="py-op">(</tt><tt id="link-251" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-251', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">)</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L341"></a><tt class="py-lineno"> 341</tt>  <tt class="py-line">                <tt class="py-name">proton_back_calc</tt> <tt class="py-op">=</tt> <tt id="link-252" class="py-name"><a title="specific_analyses.relax_disp.optimisation.back_calc_r2eff" class="py-name" href="#" onclick="return doclink('link-252', 'back_calc_r2eff', 'link-87');">back_calc_r2eff</a></tt><tt class="py-op">(</tt><tt class="py-name">spins</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt class="py-name">proton</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">spin_ids</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt id="link-253" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-253', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L342"></a><tt class="py-lineno"> 342</tt>  <tt class="py-line"> </tt>
<a name="L343"></a><tt class="py-lineno"> 343</tt>  <tt class="py-line">            <tt class="py-comment"># Convert to a dictionary matching the R2eff data structure.</tt> </tt>
<a name="L344"></a><tt class="py-lineno"> 344</tt>  <tt class="py-line">            <tt class="py-name">values</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L345"></a><tt class="py-lineno"> 345</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">exp_type</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt><tt class="py-op">,</tt> <tt id="link-254" class="py-name"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-254', 'offset', 'link-120');">offset</a></tt><tt class="py-op">,</tt> <tt class="py-name">point</tt><tt class="py-op">,</tt> <tt class="py-name">ei</tt><tt class="py-op">,</tt> <tt class="py-name">mi</tt><tt class="py-op">,</tt> <tt class="py-name">oi</tt><tt class="py-op">,</tt> <tt class="py-name">di</tt> <tt class="py-keyword">in</tt> <tt id="link-255" class="py-name"><a title="specific_analyses.relax_disp.data.loop_exp_frq_offset_point" class="py-name" href="#" onclick="return doclink('link-255', 'loop_exp_frq_offset_point', 'link-76');">loop_exp_frq_offset_point</a></tt><tt class="py-op">(</tt><tt class="py-name">return_indices</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L346"></a><tt class="py-lineno"> 346</tt>  <tt class="py-line">                <tt class="py-comment"># Alias the correct data.</tt> </tt>
<a name="L347"></a><tt class="py-lineno"> 347</tt>  <tt class="py-line">                <tt class="py-name">current_bc</tt> <tt class="py-op">=</tt> <tt id="link-256" class="py-name"><a title="pipe_control.pcs.back_calc
pipe_control.rdc.back_calc
pipe_control.relax_data.back_calc
specific_analyses.relax_fit.optimisation.back_calc" class="py-name" href="#" onclick="return doclink('link-256', 'back_calc', 'link-220');">back_calc</a></tt> </tt>
<a name="L348"></a><tt class="py-lineno"> 348</tt>  <tt class="py-line">                <tt class="py-name">current_spin</tt> <tt class="py-op">=</tt> <tt id="link-257" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-257', 'spin', 'link-115');">spin</a></tt> </tt>
<a name="L349"></a><tt class="py-lineno"> 349</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">exp_type</tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt id="link-258" class="py-name"><a title="lib.dispersion.variables.EXP_TYPE_CPMG_PROTON_SQ" class="py-name" href="#" onclick="return doclink('link-258', 'EXP_TYPE_CPMG_PROTON_SQ', 'link-12');">EXP_TYPE_CPMG_PROTON_SQ</a></tt><tt class="py-op">,</tt> <tt id="link-259" class="py-name"><a title="lib.dispersion.variables.EXP_TYPE_CPMG_PROTON_MQ" class="py-name" href="#" onclick="return doclink('link-259', 'EXP_TYPE_CPMG_PROTON_MQ', 'link-11');">EXP_TYPE_CPMG_PROTON_MQ</a></tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L350"></a><tt class="py-lineno"> 350</tt>  <tt class="py-line">                    <tt class="py-name">current_spin</tt> <tt class="py-op">=</tt> <tt class="py-name">proton</tt> </tt>
<a name="L351"></a><tt class="py-lineno"> 351</tt>  <tt class="py-line">                    <tt class="py-name">current_bc</tt> <tt class="py-op">=</tt> <tt class="py-name">proton_back_calc</tt> </tt>
<a name="L352"></a><tt class="py-lineno"> 352</tt>  <tt class="py-line"> </tt>
<a name="L353"></a><tt class="py-lineno"> 353</tt>  <tt class="py-line">                <tt class="py-comment"># The parameter key.</tt> </tt>
<a name="L354"></a><tt class="py-lineno"> 354</tt>  <tt class="py-line">                <tt class="py-name">param_key</tt> <tt class="py-op">=</tt> <tt id="link-260" class="py-name"><a title="specific_analyses.relax_disp.data.return_param_key_from_data" class="py-name" href="#" onclick="return doclink('link-260', 'return_param_key_from_data', 'link-79');">return_param_key_from_data</a></tt><tt class="py-op">(</tt><tt class="py-name">exp_type</tt><tt class="py-op">=</tt><tt class="py-name">exp_type</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt><tt class="py-op">=</tt><tt class="py-name">frq</tt><tt class="py-op">,</tt> <tt id="link-261" class="py-name"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-261', 'offset', 'link-120');">offset</a></tt><tt class="py-op">=</tt><tt id="link-262" class="py-name"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-262', 'offset', 'link-120');">offset</a></tt><tt class="py-op">,</tt> <tt class="py-name">point</tt><tt class="py-op">=</tt><tt class="py-name">point</tt><tt class="py-op">)</tt> </tt>
<a name="L355"></a><tt class="py-lineno"> 355</tt>  <tt class="py-line"> </tt>
<a name="L356"></a><tt class="py-lineno"> 356</tt>  <tt class="py-line">                <tt class="py-comment"># Skip missing data.</tt> </tt>
<a name="L357"></a><tt class="py-lineno"> 357</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">current_spin</tt><tt class="py-op">,</tt> <tt class="py-string">'r2eff'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-name">param_key</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt class="py-name">current_spin</tt><tt class="py-op">.</tt><tt id="link-263" class="py-name" targets="Variable lib.text.gui.r2eff=lib.text.gui-module.html#r2eff"><a title="lib.text.gui.r2eff" class="py-name" href="#" onclick="return doclink('link-263', 'r2eff', 'link-263');">r2eff</a></tt><tt class="py-op">:</tt> </tt>
<a name="L358"></a><tt class="py-lineno"> 358</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L359"></a><tt class="py-lineno"> 359</tt>  <tt class="py-line"> </tt>
<a name="L360"></a><tt class="py-lineno"> 360</tt>  <tt class="py-line">                <tt class="py-comment"># Store the result.</tt> </tt>
<a name="L361"></a><tt class="py-lineno"> 361</tt>  <tt class="py-line">                <tt class="py-name">values</tt><tt class="py-op">[</tt><tt class="py-name">param_key</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-264" class="py-name"><a title="pipe_control.pcs.back_calc
pipe_control.rdc.back_calc
pipe_control.relax_data.back_calc
specific_analyses.relax_fit.optimisation.back_calc" class="py-name" href="#" onclick="return doclink('link-264', 'back_calc', 'link-220');">back_calc</a></tt><tt class="py-op">[</tt><tt class="py-name">ei</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-name">mi</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-name">oi</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-name">di</tt><tt class="py-op">]</tt> </tt>
<a name="L362"></a><tt class="py-lineno"> 362</tt>  <tt class="py-line"> </tt>
<a name="L363"></a><tt class="py-lineno"> 363</tt>  <tt class="py-line">        <tt class="py-comment"># Return the MC data.</tt> </tt>
<a name="L364"></a><tt class="py-lineno"> 364</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">values</tt> </tt>
</div><a name="L365"></a><tt class="py-lineno"> 365</tt>  <tt class="py-line"> </tt>
<a name="L366"></a><tt class="py-lineno"> 366</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.deselect"></a><div id="Relax_disp.deselect-def"><a name="L367"></a><tt class="py-lineno"> 367</tt> <a class="py-toggle" href="#" id="Relax_disp.deselect-toggle" onclick="return toggle('Relax_disp.deselect');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#deselect">deselect</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">model_info</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.deselect-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.deselect-expanded"><a name="L368"></a><tt class="py-lineno"> 368</tt>  <tt class="py-line">        <tt class="py-docstring">"""Deselect models or simulations.</tt> </tt>
<a name="L369"></a><tt class="py-lineno"> 369</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L370"></a><tt class="py-lineno"> 370</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword sim_index:     The optional Monte Carlo simulation index.  If None, then models will be deselected, otherwise the given simulation will.</tt> </tt>
<a name="L371"></a><tt class="py-lineno"> 371</tt>  <tt class="py-line"><tt class="py-docstring">        @type sim_index:        None or int</tt> </tt>
<a name="L372"></a><tt class="py-lineno"> 372</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword model_info:    The list of spins and spin IDs per cluster originating from model_loop().</tt> </tt>
<a name="L373"></a><tt class="py-lineno"> 373</tt>  <tt class="py-line"><tt class="py-docstring">        @type model_info:       list of SpinContainer instances, list of str</tt> </tt>
<a name="L374"></a><tt class="py-lineno"> 374</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L375"></a><tt class="py-lineno"> 375</tt>  <tt class="py-line"> </tt>
<a name="L376"></a><tt class="py-lineno"> 376</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over all the spins and deselect them.</tt> </tt>
<a name="L377"></a><tt class="py-lineno"> 377</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-265" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-265', 'spin_id', 'link-126');">spin_id</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">model_info</tt><tt class="py-op">:</tt> </tt>
<a name="L378"></a><tt class="py-lineno"> 378</tt>  <tt class="py-line">            <tt class="py-comment"># Get the spin.</tt> </tt>
<a name="L379"></a><tt class="py-lineno"> 379</tt>  <tt class="py-line">            <tt id="link-266" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-266', 'spin', 'link-115');">spin</a></tt> <tt class="py-op">=</tt> <tt id="link-267" class="py-name"><a title="pipe_control.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-267', 'return_spin', 'link-44');">return_spin</a></tt><tt class="py-op">(</tt><tt id="link-268" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-268', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L380"></a><tt class="py-lineno"> 380</tt>  <tt class="py-line"> </tt>
<a name="L381"></a><tt class="py-lineno"> 381</tt>  <tt class="py-line">            <tt class="py-comment"># Spin deselection.</tt> </tt>
<a name="L382"></a><tt class="py-lineno"> 382</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">sim_index</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L383"></a><tt class="py-lineno"> 383</tt>  <tt class="py-line">                <tt id="link-269" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-269', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-270" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-270', 'select', 'link-118');">select</a></tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L384"></a><tt class="py-lineno"> 384</tt>  <tt class="py-line"> </tt>
<a name="L385"></a><tt class="py-lineno"> 385</tt>  <tt class="py-line">            <tt class="py-comment"># Simulation deselection.</tt> </tt>
<a name="L386"></a><tt class="py-lineno"> 386</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L387"></a><tt class="py-lineno"> 387</tt>  <tt class="py-line">                <tt id="link-271" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-271', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">select_sim</tt><tt class="py-op">[</tt><tt class="py-name">sim_index</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
</div><a name="L388"></a><tt class="py-lineno"> 388</tt>  <tt class="py-line"> </tt>
<a name="L389"></a><tt class="py-lineno"> 389</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.duplicate_data"></a><div id="Relax_disp.duplicate_data-def"><a name="L390"></a><tt class="py-lineno"> 390</tt> <a class="py-toggle" href="#" id="Relax_disp.duplicate_data-toggle" onclick="return toggle('Relax_disp.duplicate_data');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#duplicate_data">duplicate_data</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">pipe_from</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">pipe_to</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">model_info</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">global_stats</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">,</tt> <tt class="py-param">verbose</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.duplicate_data-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.duplicate_data-expanded"><a name="L391"></a><tt class="py-lineno"> 391</tt>  <tt class="py-line">        <tt class="py-docstring">"""Duplicate the data specific to a single model.</tt> </tt>
<a name="L392"></a><tt class="py-lineno"> 392</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L393"></a><tt class="py-lineno"> 393</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword pipe_from:     The data pipe to copy the data from.</tt> </tt>
<a name="L394"></a><tt class="py-lineno"> 394</tt>  <tt class="py-line"><tt class="py-docstring">        @type pipe_from:        str</tt> </tt>
<a name="L395"></a><tt class="py-lineno"> 395</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword pipe_to:       The data pipe to copy the data to.</tt> </tt>
<a name="L396"></a><tt class="py-lineno"> 396</tt>  <tt class="py-line"><tt class="py-docstring">        @type pipe_to:          str</tt> </tt>
<a name="L397"></a><tt class="py-lineno"> 397</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword model_info:    The list of spins and spin IDs per cluster originating from model_loop().</tt> </tt>
<a name="L398"></a><tt class="py-lineno"> 398</tt>  <tt class="py-line"><tt class="py-docstring">        @type model_info:       list of SpinContainer instances, list of str</tt> </tt>
<a name="L399"></a><tt class="py-lineno"> 399</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword global_stats:  The global statistics flag.</tt> </tt>
<a name="L400"></a><tt class="py-lineno"> 400</tt>  <tt class="py-line"><tt class="py-docstring">        @type global_stats:     bool</tt> </tt>
<a name="L401"></a><tt class="py-lineno"> 401</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword verbose:       A flag which if True will cause info to be printed out.</tt> </tt>
<a name="L402"></a><tt class="py-lineno"> 402</tt>  <tt class="py-line"><tt class="py-docstring">        @type verbose:          bool</tt> </tt>
<a name="L403"></a><tt class="py-lineno"> 403</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L404"></a><tt class="py-lineno"> 404</tt>  <tt class="py-line"> </tt>
<a name="L405"></a><tt class="py-lineno"> 405</tt>  <tt class="py-line">        <tt class="py-comment"># First create the pipe_to data pipe, if it doesn't exist, but don't switch to it.</tt> </tt>
<a name="L406"></a><tt class="py-lineno"> 406</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-272" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-272', 'pipes', 'link-31');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-273" class="py-name" targets="Function pipe_control.pipes.has_pipe()=pipe_control.pipes-module.html#has_pipe"><a title="pipe_control.pipes.has_pipe" class="py-name" href="#" onclick="return doclink('link-273', 'has_pipe', 'link-273');">has_pipe</a></tt><tt class="py-op">(</tt><tt class="py-name">pipe_to</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L407"></a><tt class="py-lineno"> 407</tt>  <tt class="py-line">            <tt id="link-274" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-274', 'pipes', 'link-31');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-275" class="py-name" targets="Method bmrblib.base_classes.TagCategory.create()=bmrblib.base_classes.TagCategory-class.html#create,Function pipe_control.dasha.create()=pipe_control.dasha-module.html#create,Function pipe_control.palmer.create()=pipe_control.palmer-module.html#create,Function pipe_control.pipes.create()=pipe_control.pipes-module.html#create"><a title="bmrblib.base_classes.TagCategory.create
pipe_control.dasha.create
pipe_control.palmer.create
pipe_control.pipes.create" class="py-name" href="#" onclick="return doclink('link-275', 'create', 'link-275');">create</a></tt><tt class="py-op">(</tt><tt class="py-name">pipe_to</tt><tt class="py-op">,</tt> <tt class="py-name">pipe_type</tt><tt class="py-op">=</tt><tt class="py-string">'relax_disp'</tt><tt class="py-op">,</tt> <tt id="link-276" class="py-name" targets="Function pipe_control.pipes.switch()=pipe_control.pipes-module.html#switch"><a title="pipe_control.pipes.switch" class="py-name" href="#" onclick="return doclink('link-276', 'switch', 'link-276');">switch</a></tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt> </tt>
<a name="L408"></a><tt class="py-lineno"> 408</tt>  <tt class="py-line"> </tt>
<a name="L409"></a><tt class="py-lineno"> 409</tt>  <tt class="py-line">        <tt class="py-comment"># Get the data pipes.</tt> </tt>
<a name="L410"></a><tt class="py-lineno"> 410</tt>  <tt class="py-line">        <tt class="py-name">dp_from</tt> <tt class="py-op">=</tt> <tt id="link-277" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-277', 'pipes', 'link-31');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-278" class="py-name"><a title="pipe_control.pipes.get_pipe" class="py-name" href="#" onclick="return doclink('link-278', 'get_pipe', 'link-142');">get_pipe</a></tt><tt class="py-op">(</tt><tt class="py-name">pipe_from</tt><tt class="py-op">)</tt> </tt>
<a name="L411"></a><tt class="py-lineno"> 411</tt>  <tt class="py-line">        <tt class="py-name">dp_to</tt> <tt class="py-op">=</tt> <tt id="link-279" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-279', 'pipes', 'link-31');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-280" class="py-name"><a title="pipe_control.pipes.get_pipe" class="py-name" href="#" onclick="return doclink('link-280', 'get_pipe', 'link-142');">get_pipe</a></tt><tt class="py-op">(</tt><tt class="py-name">pipe_to</tt><tt class="py-op">)</tt> </tt>
<a name="L412"></a><tt class="py-lineno"> 412</tt>  <tt class="py-line"> </tt>
<a name="L413"></a><tt class="py-lineno"> 413</tt>  <tt class="py-line">        <tt class="py-comment"># Duplicate all non-sequence specific data.</tt> </tt>
<a name="L414"></a><tt class="py-lineno"> 414</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">data_name</tt> <tt class="py-keyword">in</tt> <tt id="link-281" class="py-name" targets="Module gui.input_elements.dir=gui.input_elements.dir-module.html"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-281', 'dir', 'link-281');">dir</a></tt><tt class="py-op">(</tt><tt class="py-name">dp_from</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L415"></a><tt class="py-lineno"> 415</tt>  <tt class="py-line">            <tt class="py-comment"># Skip the container objects.</tt> </tt>
<a name="L416"></a><tt class="py-lineno"> 416</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">data_name</tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt class="py-string">'mol'</tt><tt class="py-op">,</tt> <tt class="py-string">'interatomic'</tt><tt class="py-op">,</tt> <tt class="py-string">'structure'</tt><tt class="py-op">,</tt> <tt class="py-string">'exp_info'</tt><tt class="py-op">,</tt> <tt class="py-string">'result_files'</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L417"></a><tt class="py-lineno"> 417</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L418"></a><tt class="py-lineno"> 418</tt>  <tt class="py-line"> </tt>
<a name="L419"></a><tt class="py-lineno"> 419</tt>  <tt class="py-line">            <tt class="py-comment"># Skip dispersion specific parameters.</tt> </tt>
<a name="L420"></a><tt class="py-lineno"> 420</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">data_name</tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt class="py-string">'model'</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L421"></a><tt class="py-lineno"> 421</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L422"></a><tt class="py-lineno"> 422</tt>  <tt class="py-line"> </tt>
<a name="L423"></a><tt class="py-lineno"> 423</tt>  <tt class="py-line">            <tt class="py-comment"># Skip special objects.</tt> </tt>
<a name="L424"></a><tt class="py-lineno"> 424</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-282" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-282', 'search', 'link-2');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'^_'</tt><tt class="py-op">,</tt> <tt class="py-name">data_name</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-name">data_name</tt> <tt class="py-keyword">in</tt> <tt class="py-name">dp_from</tt><tt class="py-op">.</tt><tt class="py-name">__class__</tt><tt class="py-op">.</tt><tt class="py-name">__dict__</tt><tt class="py-op">:</tt> </tt>
<a name="L425"></a><tt class="py-lineno"> 425</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L426"></a><tt class="py-lineno"> 426</tt>  <tt class="py-line"> </tt>
<a name="L427"></a><tt class="py-lineno"> 427</tt>  <tt class="py-line">            <tt class="py-comment"># Get the original object.</tt> </tt>
<a name="L428"></a><tt class="py-lineno"> 428</tt>  <tt class="py-line">            <tt class="py-name">data_from</tt> <tt class="py-op">=</tt> <tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt class="py-name">dp_from</tt><tt class="py-op">,</tt> <tt class="py-name">data_name</tt><tt class="py-op">)</tt> </tt>
<a name="L429"></a><tt class="py-lineno"> 429</tt>  <tt class="py-line"> </tt>
<a name="L430"></a><tt class="py-lineno"> 430</tt>  <tt class="py-line">            <tt class="py-comment"># The data already exists.</tt> </tt>
<a name="L431"></a><tt class="py-lineno"> 431</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">dp_to</tt><tt class="py-op">,</tt> <tt class="py-name">data_name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L432"></a><tt class="py-lineno"> 432</tt>  <tt class="py-line">                <tt class="py-comment"># Get the object in the target pipe.</tt> </tt>
<a name="L433"></a><tt class="py-lineno"> 433</tt>  <tt class="py-line">                <tt class="py-name">data_to</tt> <tt class="py-op">=</tt> <tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt class="py-name">dp_to</tt><tt class="py-op">,</tt> <tt class="py-name">data_name</tt><tt class="py-op">)</tt> </tt>
<a name="L434"></a><tt class="py-lineno"> 434</tt>  <tt class="py-line"> </tt>
<a name="L435"></a><tt class="py-lineno"> 435</tt>  <tt class="py-line">                <tt class="py-comment"># The data must match!</tt> </tt>
<a name="L436"></a><tt class="py-lineno"> 436</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">data_from</tt> <tt class="py-op">!=</tt> <tt class="py-name">data_to</tt><tt class="py-op">:</tt> </tt>
<a name="L437"></a><tt class="py-lineno"> 437</tt>  <tt class="py-line">                    <tt class="py-keyword">raise</tt> <tt id="link-283" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-283', 'RelaxError', 'link-18');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The object "</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">data_name</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">" is not consistent between the pipes "</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">pipe_from</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">" and "</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">pipe_to</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">"."</tt><tt class="py-op">)</tt> </tt>
<a name="L438"></a><tt class="py-lineno"> 438</tt>  <tt class="py-line"> </tt>
<a name="L439"></a><tt class="py-lineno"> 439</tt>  <tt class="py-line">                <tt class="py-comment"># Skip the data.</tt> </tt>
<a name="L440"></a><tt class="py-lineno"> 440</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L441"></a><tt class="py-lineno"> 441</tt>  <tt class="py-line"> </tt>
<a name="L442"></a><tt class="py-lineno"> 442</tt>  <tt class="py-line">            <tt class="py-comment"># Duplicate the data.</tt> </tt>
<a name="L443"></a><tt class="py-lineno"> 443</tt>  <tt class="py-line">            <tt class="py-name">setattr</tt><tt class="py-op">(</tt><tt class="py-name">dp_to</tt><tt class="py-op">,</tt> <tt class="py-name">data_name</tt><tt class="py-op">,</tt> <tt class="py-name">deepcopy</tt><tt class="py-op">(</tt><tt class="py-name">data_from</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L444"></a><tt class="py-lineno"> 444</tt>  <tt class="py-line"> </tt>
<a name="L445"></a><tt class="py-lineno"> 445</tt>  <tt class="py-line">        <tt class="py-comment"># No sequence data, so skip the rest.</tt> </tt>
<a name="L446"></a><tt class="py-lineno"> 446</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">dp_from</tt><tt class="py-op">.</tt><tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-284" class="py-name" targets="Method bmrblib.base_classes.TagCategory.is_empty()=bmrblib.base_classes.TagCategory-class.html#is_empty,Method bmrblib.experimental_details.method.MethodCitation.is_empty()=bmrblib.experimental_details.method.MethodCitation-class.html#is_empty,Method data_store.Relax_data_store.is_empty()=data_store.Relax_data_store-class.html#is_empty,Method data_store.data_classes.Element.is_empty()=data_store.data_classes.Element-class.html#is_empty,Method data_store.interatomic.InteratomContainer.is_empty()=data_store.interatomic.InteratomContainer-class.html#is_empty,Method data_store.interatomic.InteratomList.is_empty()=data_store.interatomic.InteratomList-class.html#is_empty,Method data_store.mol_res_spin.MoleculeContainer.is_empty()=data_store.mol_res_spin.MoleculeContainer-class.html#is_empty,Method data_store.mol_res_spin.MoleculeList.is_empty()=data_store.mol_res_spin.MoleculeList-class.html#is_empty,Method data_store.mol_res_spin.ResidueContainer.is_empty()=data_store.mol_res_spin.ResidueContainer-class.html#is_empty,Method data_store.mol_res_spin.ResidueList.is_empty()=data_store.mol_res_spin.ResidueList-class.html#is_empty,Method data_store.mol_res_spin.SpinContainer.is_empty()=data_store.mol_res_spin.SpinContainer-class.html#is_empty,Method data_store.mol_res_spin.SpinList.is_empty()=data_store.mol_res_spin.SpinList-class.html#is_empty,Method data_store.pipe_container.PipeContainer.is_empty()=data_store.pipe_container.PipeContainer-class.html#is_empty,Method lib.structure.internal.models.ModelContainer.is_empty()=lib.structure.internal.models.ModelContainer-class.html#is_empty,Method lib.structure.internal.models.ModelList.is_empty()=lib.structure.internal.models.ModelList-class.html#is_empty,Method lib.structure.internal.molecules.MolContainer.is_empty()=lib.structure.internal.molecules.MolContainer-class.html#is_empty,Method lib.structure.internal.molecules.MolList.is_empty()=lib.structure.internal.molecules.MolList-class.html#is_empty"><a title="bmrblib.base_classes.TagCategory.is_empty
bmrblib.experimental_details.method.MethodCitation.is_empty
data_store.Relax_data_store.is_empty
data_store.data_classes.Element.is_empty
data_store.interatomic.InteratomContainer.is_empty
data_store.interatomic.InteratomList.is_empty
data_store.mol_res_spin.MoleculeContainer.is_empty
data_store.mol_res_spin.MoleculeList.is_empty
data_store.mol_res_spin.ResidueContainer.is_empty
data_store.mol_res_spin.ResidueList.is_empty
data_store.mol_res_spin.SpinContainer.is_empty
data_store.mol_res_spin.SpinList.is_empty
data_store.pipe_container.PipeContainer.is_empty
lib.structure.internal.models.ModelContainer.is_empty
lib.structure.internal.models.ModelList.is_empty
lib.structure.internal.molecules.MolContainer.is_empty
lib.structure.internal.molecules.MolList.is_empty" class="py-name" href="#" onclick="return doclink('link-284', 'is_empty', 'link-284');">is_empty</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L447"></a><tt class="py-lineno"> 447</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
<a name="L448"></a><tt class="py-lineno"> 448</tt>  <tt class="py-line"> </tt>
<a name="L449"></a><tt class="py-lineno"> 449</tt>  <tt class="py-line">        <tt class="py-comment"># Duplicate the sequence data if it doesn't exist.</tt> </tt>
<a name="L450"></a><tt class="py-lineno"> 450</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">dp_to</tt><tt class="py-op">.</tt><tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-285" class="py-name"><a title="bmrblib.base_classes.TagCategory.is_empty
bmrblib.experimental_details.method.MethodCitation.is_empty
data_store.Relax_data_store.is_empty
data_store.data_classes.Element.is_empty
data_store.interatomic.InteratomContainer.is_empty
data_store.interatomic.InteratomList.is_empty
data_store.mol_res_spin.MoleculeContainer.is_empty
data_store.mol_res_spin.MoleculeList.is_empty
data_store.mol_res_spin.ResidueContainer.is_empty
data_store.mol_res_spin.ResidueList.is_empty
data_store.mol_res_spin.SpinContainer.is_empty
data_store.mol_res_spin.SpinList.is_empty
data_store.pipe_container.PipeContainer.is_empty
lib.structure.internal.models.ModelContainer.is_empty
lib.structure.internal.models.ModelList.is_empty
lib.structure.internal.molecules.MolContainer.is_empty
lib.structure.internal.molecules.MolList.is_empty" class="py-name" href="#" onclick="return doclink('link-285', 'is_empty', 'link-284');">is_empty</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L451"></a><tt class="py-lineno"> 451</tt>  <tt class="py-line">            <tt id="link-286" class="py-name"><a title="gui.input_elements.sequence
lib.sequence
pipe_control.sequence
test_suite.system_tests.sequence
user_functions.sequence" class="py-name" href="#" onclick="return doclink('link-286', 'sequence', 'link-33');">sequence</a></tt><tt class="py-op">.</tt><tt id="link-287" class="py-name"><a title="pipe_control.align_tensor.copy
pipe_control.diffusion_tensor.copy
pipe_control.interatomic.copy
pipe_control.j_coupling.copy
pipe_control.pcs.copy
pipe_control.pipes.copy
pipe_control.rdc.copy
pipe_control.relax_data.copy
pipe_control.sequence.copy
pipe_control.value.copy
specific_analyses.relax_disp.parameters.copy" class="py-name" href="#" onclick="return doclink('link-287', 'copy', 'link-1');">copy</a></tt><tt class="py-op">(</tt><tt class="py-name">pipe_from</tt><tt class="py-op">=</tt><tt class="py-name">pipe_from</tt><tt class="py-op">,</tt> <tt class="py-name">pipe_to</tt><tt class="py-op">=</tt><tt class="py-name">pipe_to</tt><tt class="py-op">,</tt> <tt class="py-name">preserve_select</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">verbose</tt><tt class="py-op">=</tt><tt class="py-name">verbose</tt><tt class="py-op">)</tt> </tt>
<a name="L452"></a><tt class="py-lineno"> 452</tt>  <tt class="py-line"> </tt>
<a name="L453"></a><tt class="py-lineno"> 453</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the cluster.</tt> </tt>
<a name="L454"></a><tt class="py-lineno"> 454</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">id</tt> <tt class="py-keyword">in</tt> <tt class="py-name">model_info</tt><tt class="py-op">:</tt> </tt>
<a name="L455"></a><tt class="py-lineno"> 455</tt>  <tt class="py-line">            <tt class="py-comment"># The original spin container.</tt> </tt>
<a name="L456"></a><tt class="py-lineno"> 456</tt>  <tt class="py-line">            <tt id="link-288" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-288', 'spin', 'link-115');">spin</a></tt> <tt class="py-op">=</tt> <tt id="link-289" class="py-name"><a title="pipe_control.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-289', 'return_spin', 'link-44');">return_spin</a></tt><tt class="py-op">(</tt><tt class="py-name">id</tt><tt class="py-op">,</tt> <tt id="link-290" class="py-name" targets="Module user_functions.pipe=user_functions.pipe-module.html"><a title="user_functions.pipe" class="py-name" href="#" onclick="return doclink('link-290', 'pipe', 'link-290');">pipe</a></tt><tt class="py-op">=</tt><tt class="py-name">pipe_from</tt><tt class="py-op">)</tt> </tt>
<a name="L457"></a><tt class="py-lineno"> 457</tt>  <tt class="py-line"> </tt>
<a name="L458"></a><tt class="py-lineno"> 458</tt>  <tt class="py-line">            <tt class="py-comment"># Duplicate the spin specific data.</tt> </tt>
<a name="L459"></a><tt class="py-lineno"> 459</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-291" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-291', 'name', 'link-151');">name</a></tt> <tt class="py-keyword">in</tt> <tt id="link-292" class="py-name"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-292', 'dir', 'link-281');">dir</a></tt><tt class="py-op">(</tt><tt id="link-293" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-293', 'spin', 'link-115');">spin</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L460"></a><tt class="py-lineno"> 460</tt>  <tt class="py-line">                <tt class="py-comment"># Skip special objects.</tt> </tt>
<a name="L461"></a><tt class="py-lineno"> 461</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt id="link-294" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-294', 'search', 'link-2');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'^__'</tt><tt class="py-op">,</tt> <tt id="link-295" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-295', 'name', 'link-151');">name</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L462"></a><tt class="py-lineno"> 462</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L463"></a><tt class="py-lineno"> 463</tt>  <tt class="py-line"> </tt>
<a name="L464"></a><tt class="py-lineno"> 464</tt>  <tt class="py-line">                <tt class="py-comment"># Get the object.</tt> </tt>
<a name="L465"></a><tt class="py-lineno"> 465</tt>  <tt class="py-line">                <tt class="py-name">obj</tt> <tt class="py-op">=</tt> <tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt id="link-296" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-296', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt id="link-297" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-297', 'name', 'link-151');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L466"></a><tt class="py-lineno"> 466</tt>  <tt class="py-line"> </tt>
<a name="L467"></a><tt class="py-lineno"> 467</tt>  <tt class="py-line">                <tt class="py-comment"># Skip methods.</tt> </tt>
<a name="L468"></a><tt class="py-lineno"> 468</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">isinstance</tt><tt class="py-op">(</tt><tt class="py-name">obj</tt><tt class="py-op">,</tt> <tt class="py-name">MethodType</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L469"></a><tt class="py-lineno"> 469</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L470"></a><tt class="py-lineno"> 470</tt>  <tt class="py-line"> </tt>
<a name="L471"></a><tt class="py-lineno"> 471</tt>  <tt class="py-line">                <tt class="py-comment"># Duplicate the object.</tt> </tt>
<a name="L472"></a><tt class="py-lineno"> 472</tt>  <tt class="py-line">                <tt class="py-name">new_obj</tt> <tt class="py-op">=</tt> <tt class="py-name">deepcopy</tt><tt class="py-op">(</tt><tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt id="link-298" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-298', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt id="link-299" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-299', 'name', 'link-151');">name</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L473"></a><tt class="py-lineno"> 473</tt>  <tt class="py-line">                <tt class="py-name">setattr</tt><tt class="py-op">(</tt><tt class="py-name">dp_to</tt><tt class="py-op">.</tt><tt class="py-name">mol</tt><tt class="py-op">[</tt><tt id="link-300" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-300', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">_mol_index</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">res</tt><tt class="py-op">[</tt><tt id="link-301" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-301', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">_res_index</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-302" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-302', 'spin', 'link-115');">spin</a></tt><tt class="py-op">[</tt><tt id="link-303" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-303', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">_spin_index</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt id="link-304" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-304', 'name', 'link-151');">name</a></tt><tt class="py-op">,</tt> <tt class="py-name">new_obj</tt><tt class="py-op">)</tt> </tt>
</div><a name="L474"></a><tt class="py-lineno"> 474</tt>  <tt class="py-line"> </tt>
<a name="L475"></a><tt class="py-lineno"> 475</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.eliminate"></a><div id="Relax_disp.eliminate-def"><a name="L476"></a><tt class="py-lineno"> 476</tt> <a class="py-toggle" href="#" id="Relax_disp.eliminate-toggle" onclick="return toggle('Relax_disp.eliminate');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#eliminate">eliminate</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">name</tt><tt class="py-op">,</tt> <tt class="py-param">value</tt><tt class="py-op">,</tt> <tt class="py-param">args</tt><tt class="py-op">,</tt> <tt class="py-param">sim</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">model_info</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.eliminate-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.eliminate-expanded"><a name="L477"></a><tt class="py-lineno"> 477</tt>  <tt class="py-line">        <tt class="py-docstring">"""Relaxation dispersion model elimination, parameter by parameter.</tt> </tt>
<a name="L478"></a><tt class="py-lineno"> 478</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L479"></a><tt class="py-lineno"> 479</tt>  <tt class="py-line"><tt class="py-docstring">        @param name:            The parameter name.</tt> </tt>
<a name="L480"></a><tt class="py-lineno"> 480</tt>  <tt class="py-line"><tt class="py-docstring">        @type name:             str</tt> </tt>
<a name="L481"></a><tt class="py-lineno"> 481</tt>  <tt class="py-line"><tt class="py-docstring">        @param value:           The parameter value.</tt> </tt>
<a name="L482"></a><tt class="py-lineno"> 482</tt>  <tt class="py-line"><tt class="py-docstring">        @type value:            float</tt> </tt>
<a name="L483"></a><tt class="py-lineno"> 483</tt>  <tt class="py-line"><tt class="py-docstring">        @param args:            The c1 and c2 elimination constant overrides.</tt> </tt>
<a name="L484"></a><tt class="py-lineno"> 484</tt>  <tt class="py-line"><tt class="py-docstring">        @type args:             None or tuple of float</tt> </tt>
<a name="L485"></a><tt class="py-lineno"> 485</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword sim:           The Monte Carlo simulation index.</tt> </tt>
<a name="L486"></a><tt class="py-lineno"> 486</tt>  <tt class="py-line"><tt class="py-docstring">        @type sim:              int</tt> </tt>
<a name="L487"></a><tt class="py-lineno"> 487</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword model_info:    The list of spins and spin IDs per cluster originating from model_loop().</tt> </tt>
<a name="L488"></a><tt class="py-lineno"> 488</tt>  <tt class="py-line"><tt class="py-docstring">        @type model_info:       list of SpinContainer instances, list of str</tt> </tt>
<a name="L489"></a><tt class="py-lineno"> 489</tt>  <tt class="py-line"><tt class="py-docstring">        @return:                True if the model is to be eliminated, False otherwise.</tt> </tt>
<a name="L490"></a><tt class="py-lineno"> 490</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:                 bool</tt> </tt>
<a name="L491"></a><tt class="py-lineno"> 491</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L492"></a><tt class="py-lineno"> 492</tt>  <tt class="py-line"> </tt>
<a name="L493"></a><tt class="py-lineno"> 493</tt>  <tt class="py-line">        <tt class="py-comment"># Skip the R2eff model parameters.</tt> </tt>
<a name="L494"></a><tt class="py-lineno"> 494</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-305" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-305', 'name', 'link-151');">name</a></tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt class="py-string">'r2eff'</tt><tt class="py-op">,</tt> <tt class="py-string">'i0'</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L495"></a><tt class="py-lineno"> 495</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">False</tt> </tt>
<a name="L496"></a><tt class="py-lineno"> 496</tt>  <tt class="py-line"> </tt>
<a name="L497"></a><tt class="py-lineno"> 497</tt>  <tt class="py-line">        <tt class="py-comment"># Default limits.</tt> </tt>
<a name="L498"></a><tt class="py-lineno"> 498</tt>  <tt class="py-line">        <tt class="py-name">c1</tt> <tt class="py-op">=</tt> <tt class="py-number">0.501</tt> </tt>
<a name="L499"></a><tt class="py-lineno"> 499</tt>  <tt class="py-line">        <tt class="py-name">c2</tt> <tt class="py-op">=</tt> <tt class="py-number">0.999</tt> </tt>
<a name="L500"></a><tt class="py-lineno"> 500</tt>  <tt class="py-line">        <tt class="py-name">c3</tt> <tt class="py-op">=</tt> <tt class="py-number">1.0</tt> </tt>
<a name="L501"></a><tt class="py-lineno"> 501</tt>  <tt class="py-line"> </tt>
<a name="L502"></a><tt class="py-lineno"> 502</tt>  <tt class="py-line">        <tt class="py-comment"># Depack the arguments.</tt> </tt>
<a name="L503"></a><tt class="py-lineno"> 503</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">args</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L504"></a><tt class="py-lineno"> 504</tt>  <tt class="py-line">            <tt class="py-name">c1</tt><tt class="py-op">,</tt> <tt class="py-name">c2</tt><tt class="py-op">,</tt> <tt class="py-name">c3</tt> <tt class="py-op">=</tt> <tt class="py-name">args</tt> </tt>
<a name="L505"></a><tt class="py-lineno"> 505</tt>  <tt class="py-line"> </tt>
<a name="L506"></a><tt class="py-lineno"> 506</tt>  <tt class="py-line">        <tt class="py-comment"># Elimination text.</tt> </tt>
<a name="L507"></a><tt class="py-lineno"> 507</tt>  <tt class="py-line">        <tt class="py-name">elim_text</tt> <tt class="py-op">=</tt> <tt class="py-string">"Data pipe '%s':  The %s parameter of %.5f is %s, eliminating "</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt id="link-306" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-306', 'pipes', 'link-31');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-307" class="py-name" targets="Function pipe_control.pipes.cdp_name()=pipe_control.pipes-module.html#cdp_name"><a title="pipe_control.pipes.cdp_name" class="py-name" href="#" onclick="return doclink('link-307', 'cdp_name', 'link-307');">cdp_name</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt id="link-308" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-308', 'name', 'link-151');">name</a></tt><tt class="py-op">,</tt> <tt id="link-309" class="py-name" targets="Module gui.input_elements.value=gui.input_elements.value-module.html,Module pipe_control.value=pipe_control.value-module.html,Module test_suite.system_tests.value=test_suite.system_tests.value-module.html,Module user_functions.value=user_functions.value-module.html"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-309', 'value', 'link-309');">value</a></tt><tt class="py-op">,</tt> <tt class="py-string">"%s"</tt><tt class="py-op">)</tt> </tt>
<a name="L508"></a><tt class="py-lineno"> 508</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">sim</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L509"></a><tt class="py-lineno"> 509</tt>  <tt class="py-line">            <tt class="py-name">elim_text</tt> <tt class="py-op">+=</tt> <tt class="py-string">"the spin cluster %s."</tt> <tt class="py-op">%</tt> <tt class="py-name">model_info</tt> </tt>
<a name="L510"></a><tt class="py-lineno"> 510</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L511"></a><tt class="py-lineno"> 511</tt>  <tt class="py-line">            <tt class="py-name">elim_text</tt> <tt class="py-op">+=</tt> <tt class="py-string">"simulation %i of the spin cluster %s."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-name">sim</tt><tt class="py-op">,</tt> <tt class="py-name">model_info</tt><tt class="py-op">)</tt> </tt>
<a name="L512"></a><tt class="py-lineno"> 512</tt>  <tt class="py-line"> </tt>
<a name="L513"></a><tt class="py-lineno"> 513</tt>  <tt class="py-line">        <tt class="py-comment"># The pA parameter.</tt> </tt>
<a name="L514"></a><tt class="py-lineno"> 514</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-310" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-310', 'name', 'link-151');">name</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'pA'</tt><tt class="py-op">:</tt> </tt>
<a name="L515"></a><tt class="py-lineno"> 515</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-311" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-311', 'value', 'link-309');">value</a></tt> <tt class="py-op">&lt;</tt> <tt class="py-name">c1</tt><tt class="py-op">:</tt> </tt>
<a name="L516"></a><tt class="py-lineno"> 516</tt>  <tt class="py-line">                <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-name">elim_text</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">"less than  %.5f"</tt> <tt class="py-op">%</tt> <tt class="py-name">c1</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L517"></a><tt class="py-lineno"> 517</tt>  <tt class="py-line">                <tt class="py-keyword">return</tt> <tt class="py-name">True</tt> </tt>
<a name="L518"></a><tt class="py-lineno"> 518</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-312" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-312', 'value', 'link-309');">value</a></tt> <tt class="py-op">&gt;</tt> <tt class="py-name">c2</tt><tt class="py-op">:</tt> </tt>
<a name="L519"></a><tt class="py-lineno"> 519</tt>  <tt class="py-line">                <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-name">elim_text</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">"greater than  %.5f"</tt> <tt class="py-op">%</tt> <tt class="py-name">c2</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L520"></a><tt class="py-lineno"> 520</tt>  <tt class="py-line">                <tt class="py-keyword">return</tt> <tt class="py-name">True</tt> </tt>
<a name="L521"></a><tt class="py-lineno"> 521</tt>  <tt class="py-line"> </tt>
<a name="L522"></a><tt class="py-lineno"> 522</tt>  <tt class="py-line">        <tt class="py-comment"># The tex parameter.</tt> </tt>
<a name="L523"></a><tt class="py-lineno"> 523</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-313" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-313', 'name', 'link-151');">name</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'tex'</tt><tt class="py-op">:</tt> </tt>
<a name="L524"></a><tt class="py-lineno"> 524</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-314" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-314', 'value', 'link-309');">value</a></tt> <tt class="py-op">&gt;</tt> <tt class="py-name">c3</tt><tt class="py-op">:</tt> </tt>
<a name="L525"></a><tt class="py-lineno"> 525</tt>  <tt class="py-line">                <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-name">elim_text</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">"greater than  %.5f"</tt> <tt class="py-op">%</tt> <tt class="py-name">c3</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L526"></a><tt class="py-lineno"> 526</tt>  <tt class="py-line">                <tt class="py-keyword">return</tt> <tt class="py-name">True</tt> </tt>
<a name="L527"></a><tt class="py-lineno"> 527</tt>  <tt class="py-line"> </tt>
<a name="L528"></a><tt class="py-lineno"> 528</tt>  <tt class="py-line">        <tt class="py-comment"># Accept model.</tt> </tt>
<a name="L529"></a><tt class="py-lineno"> 529</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">False</tt> </tt>
</div><a name="L530"></a><tt class="py-lineno"> 530</tt>  <tt class="py-line"> </tt>
<a name="L531"></a><tt class="py-lineno"> 531</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.get_param_names"></a><div id="Relax_disp.get_param_names-def"><a name="L532"></a><tt class="py-lineno"> 532</tt> <a class="py-toggle" href="#" id="Relax_disp.get_param_names-toggle" onclick="return toggle('Relax_disp.get_param_names');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#get_param_names">get_param_names</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">model_info</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.get_param_names-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.get_param_names-expanded"><a name="L533"></a><tt class="py-lineno"> 533</tt>  <tt class="py-line">        <tt class="py-docstring">"""Return a vector of parameter names.</tt> </tt>
<a name="L534"></a><tt class="py-lineno"> 534</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L535"></a><tt class="py-lineno"> 535</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword model_info:    The list of spins and spin IDs per cluster originating from model_loop().</tt> </tt>
<a name="L536"></a><tt class="py-lineno"> 536</tt>  <tt class="py-line"><tt class="py-docstring">        @type model_info:       list of SpinContainer instances, list of str</tt> </tt>
<a name="L537"></a><tt class="py-lineno"> 537</tt>  <tt class="py-line"><tt class="py-docstring">        @return:                The vector of parameter names.</tt> </tt>
<a name="L538"></a><tt class="py-lineno"> 538</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:                 list of str</tt> </tt>
<a name="L539"></a><tt class="py-lineno"> 539</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L540"></a><tt class="py-lineno"> 540</tt>  <tt class="py-line"> </tt>
<a name="L541"></a><tt class="py-lineno"> 541</tt>  <tt class="py-line">        <tt class="py-comment"># Get the spin containers.</tt> </tt>
<a name="L542"></a><tt class="py-lineno"> 542</tt>  <tt class="py-line">        <tt class="py-name">spins</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L543"></a><tt class="py-lineno"> 543</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-315" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-315', 'spin_id', 'link-126');">spin_id</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">model_info</tt><tt class="py-op">:</tt> </tt>
<a name="L544"></a><tt class="py-lineno"> 544</tt>  <tt class="py-line">            <tt class="py-comment"># Get the spin.</tt> </tt>
<a name="L545"></a><tt class="py-lineno"> 545</tt>  <tt class="py-line">            <tt id="link-316" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-316', 'spin', 'link-115');">spin</a></tt> <tt class="py-op">=</tt> <tt id="link-317" class="py-name"><a title="pipe_control.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-317', 'return_spin', 'link-44');">return_spin</a></tt><tt class="py-op">(</tt><tt id="link-318" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-318', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L546"></a><tt class="py-lineno"> 546</tt>  <tt class="py-line"> </tt>
<a name="L547"></a><tt class="py-lineno"> 547</tt>  <tt class="py-line">            <tt class="py-comment"># Skip deselected spins.</tt> </tt>
<a name="L548"></a><tt class="py-lineno"> 548</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-319" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-319', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-320" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-320', 'select', 'link-118');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L549"></a><tt class="py-lineno"> 549</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L550"></a><tt class="py-lineno"> 550</tt>  <tt class="py-line"> </tt>
<a name="L551"></a><tt class="py-lineno"> 551</tt>  <tt class="py-line">            <tt class="py-comment"># Add the spin.</tt> </tt>
<a name="L552"></a><tt class="py-lineno"> 552</tt>  <tt class="py-line">            <tt class="py-name">spins</tt><tt class="py-op">.</tt><tt id="link-321" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-321', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt id="link-322" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-322', 'spin', 'link-115');">spin</a></tt><tt class="py-op">)</tt> </tt>
<a name="L553"></a><tt class="py-lineno"> 553</tt>  <tt class="py-line"> </tt>
<a name="L554"></a><tt class="py-lineno"> 554</tt>  <tt class="py-line">        <tt class="py-comment"># No spins.</tt> </tt>
<a name="L555"></a><tt class="py-lineno"> 555</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">spins</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L556"></a><tt class="py-lineno"> 556</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">None</tt> </tt>
<a name="L557"></a><tt class="py-lineno"> 557</tt>  <tt class="py-line"> </tt>
<a name="L558"></a><tt class="py-lineno"> 558</tt>  <tt class="py-line">        <tt class="py-comment"># Call the get_param_names() function.</tt> </tt>
<a name="L559"></a><tt class="py-lineno"> 559</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt id="link-323" class="py-name"><a title="specific_analyses.api_base.API_base.get_param_names
specific_analyses.consistency_tests.api.Consistency_tests.get_param_names
specific_analyses.frame_order.api.Frame_order.get_param_names
specific_analyses.jw_mapping.api.Jw_mapping.get_param_names
specific_analyses.model_free.api.Model_free.get_param_names
specific_analyses.n_state_model.api.N_state_model.get_param_names
specific_analyses.noe.api.Noe.get_param_names
specific_analyses.relax_disp.api.Relax_disp.get_param_names
specific_analyses.relax_disp.parameters.get_param_names
specific_analyses.relax_fit.api.Relax_fit.get_param_names" class="py-name" href="#" onclick="return doclink('link-323', 'get_param_names', 'link-97');">get_param_names</a></tt><tt class="py-op">(</tt><tt class="py-name">spins</tt><tt class="py-op">)</tt> </tt>
</div><a name="L560"></a><tt class="py-lineno"> 560</tt>  <tt class="py-line"> </tt>
<a name="L561"></a><tt class="py-lineno"> 561</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.get_param_values"></a><div id="Relax_disp.get_param_values-def"><a name="L562"></a><tt class="py-lineno"> 562</tt> <a class="py-toggle" href="#" id="Relax_disp.get_param_values-toggle" onclick="return toggle('Relax_disp.get_param_values');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#get_param_values">get_param_values</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">model_info</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.get_param_values-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.get_param_values-expanded"><a name="L563"></a><tt class="py-lineno"> 563</tt>  <tt class="py-line">        <tt class="py-docstring">"""Return a vector of parameter values.</tt> </tt>
<a name="L564"></a><tt class="py-lineno"> 564</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L565"></a><tt class="py-lineno"> 565</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword model_info:    The list of spins and spin IDs per cluster originating from model_loop().</tt> </tt>
<a name="L566"></a><tt class="py-lineno"> 566</tt>  <tt class="py-line"><tt class="py-docstring">        @type model_info:       list of SpinContainer instances, list of str</tt> </tt>
<a name="L567"></a><tt class="py-lineno"> 567</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword sim_index:     The Monte Carlo simulation index.</tt> </tt>
<a name="L568"></a><tt class="py-lineno"> 568</tt>  <tt class="py-line"><tt class="py-docstring">        @type sim_index:        int</tt> </tt>
<a name="L569"></a><tt class="py-lineno"> 569</tt>  <tt class="py-line"><tt class="py-docstring">        @return:                The vector of parameter values.</tt> </tt>
<a name="L570"></a><tt class="py-lineno"> 570</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:                 list of str</tt> </tt>
<a name="L571"></a><tt class="py-lineno"> 571</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L572"></a><tt class="py-lineno"> 572</tt>  <tt class="py-line"> </tt>
<a name="L573"></a><tt class="py-lineno"> 573</tt>  <tt class="py-line">        <tt class="py-comment"># Get the spin containers.</tt> </tt>
<a name="L574"></a><tt class="py-lineno"> 574</tt>  <tt class="py-line">        <tt class="py-name">spins</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L575"></a><tt class="py-lineno"> 575</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-324" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-324', 'spin_id', 'link-126');">spin_id</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">model_info</tt><tt class="py-op">:</tt> </tt>
<a name="L576"></a><tt class="py-lineno"> 576</tt>  <tt class="py-line">            <tt class="py-comment"># Get the spin.</tt> </tt>
<a name="L577"></a><tt class="py-lineno"> 577</tt>  <tt class="py-line">            <tt id="link-325" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-325', 'spin', 'link-115');">spin</a></tt> <tt class="py-op">=</tt> <tt id="link-326" class="py-name"><a title="pipe_control.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-326', 'return_spin', 'link-44');">return_spin</a></tt><tt class="py-op">(</tt><tt id="link-327" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-327', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L578"></a><tt class="py-lineno"> 578</tt>  <tt class="py-line"> </tt>
<a name="L579"></a><tt class="py-lineno"> 579</tt>  <tt class="py-line">            <tt class="py-comment"># Skip deselected spins.</tt> </tt>
<a name="L580"></a><tt class="py-lineno"> 580</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-328" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-328', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-329" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-329', 'select', 'link-118');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L581"></a><tt class="py-lineno"> 581</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L582"></a><tt class="py-lineno"> 582</tt>  <tt class="py-line"> </tt>
<a name="L583"></a><tt class="py-lineno"> 583</tt>  <tt class="py-line">            <tt class="py-comment"># Add the spin.</tt> </tt>
<a name="L584"></a><tt class="py-lineno"> 584</tt>  <tt class="py-line">            <tt class="py-name">spins</tt><tt class="py-op">.</tt><tt id="link-330" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-330', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt id="link-331" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-331', 'spin', 'link-115');">spin</a></tt><tt class="py-op">)</tt> </tt>
<a name="L585"></a><tt class="py-lineno"> 585</tt>  <tt class="py-line"> </tt>
<a name="L586"></a><tt class="py-lineno"> 586</tt>  <tt class="py-line">        <tt class="py-comment"># No spins.</tt> </tt>
<a name="L587"></a><tt class="py-lineno"> 587</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">spins</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L588"></a><tt class="py-lineno"> 588</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">None</tt> </tt>
<a name="L589"></a><tt class="py-lineno"> 589</tt>  <tt class="py-line"> </tt>
<a name="L590"></a><tt class="py-lineno"> 590</tt>  <tt class="py-line">        <tt class="py-comment"># Set up the R1 parameter, if needed.</tt> </tt>
<a name="L591"></a><tt class="py-lineno"> 591</tt>  <tt class="py-line">        <tt id="link-332" class="py-name"><a title="specific_analyses.relax_disp.parameters.r1_setup" class="py-name" href="#" onclick="return doclink('link-332', 'r1_setup', 'link-102');">r1_setup</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L592"></a><tt class="py-lineno"> 592</tt>  <tt class="py-line"> </tt>
<a name="L593"></a><tt class="py-lineno"> 593</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the parameters of the cluster, fetching their values.</tt> </tt>
<a name="L594"></a><tt class="py-lineno"> 594</tt>  <tt class="py-line">        <tt class="py-name">values</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L595"></a><tt class="py-lineno"> 595</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">param_name</tt><tt class="py-op">,</tt> <tt class="py-name">param_index</tt><tt class="py-op">,</tt> <tt class="py-name">si</tt><tt class="py-op">,</tt> <tt class="py-name">r20_key</tt> <tt class="py-keyword">in</tt> <tt id="link-333" class="py-name"><a title="specific_analyses.relax_disp.parameters.loop_parameters
test_suite.unit_tests._lib._dispersion.test_cr72_full_cluster_one_field.Test_cr72_full_cluster_one_field.loop_parameters
test_suite.unit_tests._lib._dispersion.test_cr72_full_cluster_three_fields.Test_cr72_full_cluster_three_fields.loop_parameters" class="py-name" href="#" onclick="return doclink('link-333', 'loop_parameters', 'link-99');">loop_parameters</a></tt><tt class="py-op">(</tt><tt class="py-name">spins</tt><tt class="py-op">=</tt><tt class="py-name">spins</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L596"></a><tt class="py-lineno"> 596</tt>  <tt class="py-line">            <tt class="py-name">values</tt><tt class="py-op">.</tt><tt id="link-334" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-334', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt id="link-335" class="py-name"><a title="specific_analyses.relax_disp.parameters.get_value" class="py-name" href="#" onclick="return doclink('link-335', 'get_value', 'link-98');">get_value</a></tt><tt class="py-op">(</tt><tt class="py-name">spins</tt><tt class="py-op">=</tt><tt class="py-name">spins</tt><tt class="py-op">,</tt> <tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">,</tt> <tt class="py-name">param_name</tt><tt class="py-op">=</tt><tt class="py-name">param_name</tt><tt class="py-op">,</tt> <tt class="py-name">spin_index</tt><tt class="py-op">=</tt><tt class="py-name">si</tt><tt class="py-op">,</tt> <tt class="py-name">r20_key</tt><tt class="py-op">=</tt><tt class="py-name">r20_key</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L597"></a><tt class="py-lineno"> 597</tt>  <tt class="py-line"> </tt>
<a name="L598"></a><tt class="py-lineno"> 598</tt>  <tt class="py-line">        <tt class="py-comment"># Return all values.</tt> </tt>
<a name="L599"></a><tt class="py-lineno"> 599</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">values</tt> </tt>
</div><a name="L600"></a><tt class="py-lineno"> 600</tt>  <tt class="py-line"> </tt>
<a name="L601"></a><tt class="py-lineno"> 601</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.grid_search"></a><div id="Relax_disp.grid_search-def"><a name="L602"></a><tt class="py-lineno"> 602</tt> <a class="py-toggle" href="#" id="Relax_disp.grid_search-toggle" onclick="return toggle('Relax_disp.grid_search');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#grid_search">grid_search</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">lower</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">upper</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">inc</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">scaling_matrix</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">constraints</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-param">verbosity</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-param">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.grid_search-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.grid_search-expanded"><a name="L603"></a><tt class="py-lineno"> 603</tt>  <tt class="py-line">        <tt class="py-docstring">"""The relaxation dispersion curve fitting grid search function.</tt> </tt>
<a name="L604"></a><tt class="py-lineno"> 604</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L605"></a><tt class="py-lineno"> 605</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword lower:             The per-model lower bounds of the grid search which must be equal to the number of parameters in the model.</tt> </tt>
<a name="L606"></a><tt class="py-lineno"> 606</tt>  <tt class="py-line"><tt class="py-docstring">        @type lower:                list of list of numbers</tt> </tt>
<a name="L607"></a><tt class="py-lineno"> 607</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword upper:             The per-model upper bounds of the grid search which must be equal to the number of parameters in the model.</tt> </tt>
<a name="L608"></a><tt class="py-lineno"> 608</tt>  <tt class="py-line"><tt class="py-docstring">        @type upper:                list of list of numbers</tt> </tt>
<a name="L609"></a><tt class="py-lineno"> 609</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword inc:               The per-model increments for each dimension of the space for the grid search. The number of elements in the array must equal to the number of parameters in the model.</tt> </tt>
<a name="L610"></a><tt class="py-lineno"> 610</tt>  <tt class="py-line"><tt class="py-docstring">        @type inc:                  list of list of int</tt> </tt>
<a name="L611"></a><tt class="py-lineno"> 611</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword scaling_matrix:    The per-model list of diagonal and square scaling matrices.</tt> </tt>
<a name="L612"></a><tt class="py-lineno"> 612</tt>  <tt class="py-line"><tt class="py-docstring">        @type scaling_matrix:       list of numpy rank-2, float64 array or list of None</tt> </tt>
<a name="L613"></a><tt class="py-lineno"> 613</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword constraints:       If True, constraints are applied during the grid search (eliminating parts of the grid).  If False, no constraints are used.</tt> </tt>
<a name="L614"></a><tt class="py-lineno"> 614</tt>  <tt class="py-line"><tt class="py-docstring">        @type constraints:          bool</tt> </tt>
<a name="L615"></a><tt class="py-lineno"> 615</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword verbosity:         A flag specifying the amount of information to print.  The higher the value, the greater the verbosity.</tt> </tt>
<a name="L616"></a><tt class="py-lineno"> 616</tt>  <tt class="py-line"><tt class="py-docstring">        @type verbosity:            int</tt> </tt>
<a name="L617"></a><tt class="py-lineno"> 617</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword sim_index:         The index of the simulation to apply the grid search to.  If None, the normal model is optimised.</tt> </tt>
<a name="L618"></a><tt class="py-lineno"> 618</tt>  <tt class="py-line"><tt class="py-docstring">        @type sim_index:            int</tt> </tt>
<a name="L619"></a><tt class="py-lineno"> 619</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L620"></a><tt class="py-lineno"> 620</tt>  <tt class="py-line"> </tt>
<a name="L621"></a><tt class="py-lineno"> 621</tt>  <tt class="py-line">        <tt class="py-comment"># Minimisation.</tt> </tt>
<a name="L622"></a><tt class="py-lineno"> 622</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-336" class="py-name" targets="Method minfx.base_classes.Min.minimise()=minfx.base_classes.Min-class.html#minimise,Method minfx.log_barrier_function.Log_barrier_function.minimise()=minfx.log_barrier_function.Log_barrier_function-class.html#minimise,Method minfx.method_of_multipliers.Method_of_multipliers.minimise()=minfx.method_of_multipliers.Method_of_multipliers-class.html#minimise,Module pipe_control.minimise=pipe_control.minimise-module.html,Function pipe_control.minimise.minimise()=pipe_control.minimise-module.html#minimise,Method specific_analyses.api_base.API_base.minimise()=specific_analyses.api_base.API_base-class.html#minimise,Method specific_analyses.frame_order.api.Frame_order.minimise()=specific_analyses.frame_order.api.Frame_order-class.html#minimise,Method specific_analyses.model_free.api.Model_free.minimise()=specific_analyses.model_free.api.Model_free-class.html#minimise,Method specific_analyses.n_state_model.api.N_state_model.minimise()=specific_analyses.n_state_model.api.N_state_model-class.html#minimise,Method specific_analyses.relax_disp.api.Relax_disp.minimise()=specific_analyses.relax_disp.api.Relax_disp-class.html#minimise,Method specific_analyses.relax_fit.api.Relax_fit.minimise()=specific_analyses.relax_fit.api.Relax_fit-class.html#minimise"><a title="minfx.base_classes.Min.minimise
minfx.log_barrier_function.Log_barrier_function.minimise
minfx.method_of_multipliers.Method_of_multipliers.minimise
pipe_control.minimise
pipe_control.minimise.minimise
specific_analyses.api_base.API_base.minimise
specific_analyses.frame_order.api.Frame_order.minimise
specific_analyses.model_free.api.Model_free.minimise
specific_analyses.n_state_model.api.N_state_model.minimise
specific_analyses.relax_disp.api.Relax_disp.minimise
specific_analyses.relax_fit.api.Relax_fit.minimise" class="py-name" href="#" onclick="return doclink('link-336', 'minimise', 'link-336');">minimise</a></tt><tt class="py-op">(</tt><tt class="py-name">min_algor</tt><tt class="py-op">=</tt><tt class="py-string">'grid'</tt><tt class="py-op">,</tt> <tt class="py-name">lower</tt><tt class="py-op">=</tt><tt class="py-name">lower</tt><tt class="py-op">,</tt> <tt class="py-name">upper</tt><tt class="py-op">=</tt><tt class="py-name">upper</tt><tt class="py-op">,</tt> <tt class="py-name">inc</tt><tt class="py-op">=</tt><tt class="py-name">inc</tt><tt class="py-op">,</tt> <tt class="py-name">scaling_matrix</tt><tt class="py-op">=</tt><tt class="py-name">scaling_matrix</tt><tt class="py-op">,</tt> <tt class="py-name">constraints</tt><tt class="py-op">=</tt><tt class="py-name">constraints</tt><tt class="py-op">,</tt> <tt id="link-337" class="py-name" targets="Variable bmrblib.pystarlib.Text.verbosity=bmrblib.pystarlib.Text-module.html#verbosity,Variable bmrblib.pystarlib.verbosity=bmrblib.pystarlib-module.html#verbosity,Variable multi.multi_processor_base.verbosity=multi.multi_processor_base-module.html#verbosity,Variable multi.processor.verbosity=multi.processor-module.html#verbosity"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-337', 'verbosity', 'link-337');">verbosity</a></tt><tt class="py-op">=</tt><tt id="link-338" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-338', 'verbosity', 'link-337');">verbosity</a></tt><tt class="py-op">,</tt> <tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">)</tt> </tt>
</div><a name="L623"></a><tt class="py-lineno"> 623</tt>  <tt class="py-line"> </tt>
<a name="L624"></a><tt class="py-lineno"> 624</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.map_bounds"></a><div id="Relax_disp.map_bounds-def"><a name="L625"></a><tt class="py-lineno"> 625</tt> <a class="py-toggle" href="#" id="Relax_disp.map_bounds-toggle" onclick="return toggle('Relax_disp.map_bounds');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#map_bounds">map_bounds</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">param</tt><tt class="py-op">,</tt> <tt class="py-param">spin_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.map_bounds-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.map_bounds-expanded"><a name="L626"></a><tt class="py-lineno"> 626</tt>  <tt class="py-line">        <tt class="py-docstring">"""Create bounds for the OpenDX mapping function.</tt> </tt>
<a name="L627"></a><tt class="py-lineno"> 627</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L628"></a><tt class="py-lineno"> 628</tt>  <tt class="py-line"><tt class="py-docstring">        @param param:       The name of the parameter to return the lower and upper bounds of.</tt> </tt>
<a name="L629"></a><tt class="py-lineno"> 629</tt>  <tt class="py-line"><tt class="py-docstring">        @type param:        str</tt> </tt>
<a name="L630"></a><tt class="py-lineno"> 630</tt>  <tt class="py-line"><tt class="py-docstring">        @param spin_id:     The spin identification string (unused).</tt> </tt>
<a name="L631"></a><tt class="py-lineno"> 631</tt>  <tt class="py-line"><tt class="py-docstring">        @type spin_id:      None</tt> </tt>
<a name="L632"></a><tt class="py-lineno"> 632</tt>  <tt class="py-line"><tt class="py-docstring">        @return:            The upper and lower bounds of the parameter.</tt> </tt>
<a name="L633"></a><tt class="py-lineno"> 633</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:             list of float</tt> </tt>
<a name="L634"></a><tt class="py-lineno"> 634</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L635"></a><tt class="py-lineno"> 635</tt>  <tt class="py-line"> </tt>
<a name="L636"></a><tt class="py-lineno"> 636</tt>  <tt class="py-line">        <tt class="py-comment"># Is the parameter is valid?</tt> </tt>
<a name="L637"></a><tt class="py-lineno"> 637</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_PARAMS</tt><tt class="py-op">.</tt><tt id="link-339" class="py-name" targets="Method specific_analyses.parameter_object.Param_list.contains()=specific_analyses.parameter_object.Param_list-class.html#contains"><a title="specific_analyses.parameter_object.Param_list.contains" class="py-name" href="#" onclick="return doclink('link-339', 'contains', 'link-339');">contains</a></tt><tt class="py-op">(</tt><tt class="py-name">param</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L638"></a><tt class="py-lineno"> 638</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-340" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-340', 'RelaxError', 'link-18');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The parameter '%s' is not valid for this data pipe type."</tt> <tt class="py-op">%</tt> <tt class="py-name">param</tt><tt class="py-op">)</tt> </tt>
<a name="L639"></a><tt class="py-lineno"> 639</tt>  <tt class="py-line"> </tt>
<a name="L640"></a><tt class="py-lineno"> 640</tt>  <tt class="py-line">        <tt class="py-comment"># Return the spin.</tt> </tt>
<a name="L641"></a><tt class="py-lineno"> 641</tt>  <tt class="py-line">        <tt id="link-341" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-341', 'spin', 'link-115');">spin</a></tt> <tt class="py-op">=</tt> <tt id="link-342" class="py-name"><a title="pipe_control.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-342', 'return_spin', 'link-44');">return_spin</a></tt><tt class="py-op">(</tt><tt id="link-343" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-343', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L642"></a><tt class="py-lineno"> 642</tt>  <tt class="py-line"> </tt>
<a name="L643"></a><tt class="py-lineno"> 643</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over each spectrometer frequency and dispersion point to collect param_keys.</tt> </tt>
<a name="L644"></a><tt class="py-lineno"> 644</tt>  <tt class="py-line">        <tt class="py-name">param_keys</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L645"></a><tt class="py-lineno"> 645</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">exp_type</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt><tt class="py-op">,</tt> <tt id="link-344" class="py-name"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-344', 'offset', 'link-120');">offset</a></tt><tt class="py-op">,</tt> <tt class="py-name">point</tt> <tt class="py-keyword">in</tt> <tt id="link-345" class="py-name"><a title="specific_analyses.relax_disp.data.loop_exp_frq_offset_point" class="py-name" href="#" onclick="return doclink('link-345', 'loop_exp_frq_offset_point', 'link-76');">loop_exp_frq_offset_point</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L646"></a><tt class="py-lineno"> 646</tt>  <tt class="py-line">            <tt class="py-comment"># The parameter key.</tt> </tt>
<a name="L647"></a><tt class="py-lineno"> 647</tt>  <tt class="py-line">            <tt class="py-name">param_key</tt> <tt class="py-op">=</tt> <tt id="link-346" class="py-name"><a title="specific_analyses.relax_disp.data.return_param_key_from_data" class="py-name" href="#" onclick="return doclink('link-346', 'return_param_key_from_data', 'link-79');">return_param_key_from_data</a></tt><tt class="py-op">(</tt><tt class="py-name">exp_type</tt><tt class="py-op">=</tt><tt class="py-name">exp_type</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt><tt class="py-op">=</tt><tt class="py-name">frq</tt><tt class="py-op">,</tt> <tt id="link-347" class="py-name"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-347', 'offset', 'link-120');">offset</a></tt><tt class="py-op">=</tt><tt id="link-348" class="py-name"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-348', 'offset', 'link-120');">offset</a></tt><tt class="py-op">,</tt> <tt class="py-name">point</tt><tt class="py-op">=</tt><tt class="py-name">point</tt><tt class="py-op">)</tt> </tt>
<a name="L648"></a><tt class="py-lineno"> 648</tt>  <tt class="py-line"> </tt>
<a name="L649"></a><tt class="py-lineno"> 649</tt>  <tt class="py-line">            <tt class="py-comment"># Collect the key.</tt> </tt>
<a name="L650"></a><tt class="py-lineno"> 650</tt>  <tt class="py-line">            <tt class="py-name">param_keys</tt><tt class="py-op">.</tt><tt id="link-349" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-349', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">param_key</tt><tt class="py-op">)</tt> </tt>
<a name="L651"></a><tt class="py-lineno"> 651</tt>  <tt class="py-line"> </tt>
<a name="L652"></a><tt class="py-lineno"> 652</tt>  <tt class="py-line">        <tt class="py-comment"># The initial parameter vector.</tt> </tt>
<a name="L653"></a><tt class="py-lineno"> 653</tt>  <tt class="py-line">        <tt class="py-name">param_vector</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L654"></a><tt class="py-lineno"> 654</tt>  <tt class="py-line"> </tt>
<a name="L655"></a><tt class="py-lineno"> 655</tt>  <tt class="py-line">        <tt class="py-comment"># Collect param_names.</tt> </tt>
<a name="L656"></a><tt class="py-lineno"> 656</tt>  <tt class="py-line">        <tt class="py-name">param_names</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L657"></a><tt class="py-lineno"> 657</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">param_name</tt><tt class="py-op">,</tt> <tt class="py-name">param_index</tt><tt class="py-op">,</tt> <tt class="py-name">si</tt><tt class="py-op">,</tt> <tt class="py-name">r20_key</tt> <tt class="py-keyword">in</tt> <tt id="link-350" class="py-name"><a title="specific_analyses.relax_disp.parameters.loop_parameters
test_suite.unit_tests._lib._dispersion.test_cr72_full_cluster_one_field.Test_cr72_full_cluster_one_field.loop_parameters
test_suite.unit_tests._lib._dispersion.test_cr72_full_cluster_three_fields.Test_cr72_full_cluster_three_fields.loop_parameters" class="py-name" href="#" onclick="return doclink('link-350', 'loop_parameters', 'link-99');">loop_parameters</a></tt><tt class="py-op">(</tt><tt class="py-name">spins</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt id="link-351" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-351', 'spin', 'link-115');">spin</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L658"></a><tt class="py-lineno"> 658</tt>  <tt class="py-line">            <tt class="py-comment"># Add to the param vector.</tt> </tt>
<a name="L659"></a><tt class="py-lineno"> 659</tt>  <tt class="py-line">            <tt class="py-name">param_vector</tt><tt class="py-op">.</tt><tt id="link-352" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-352', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-number">0.0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L660"></a><tt class="py-lineno"> 660</tt>  <tt class="py-line"> </tt>
<a name="L661"></a><tt class="py-lineno"> 661</tt>  <tt class="py-line">            <tt class="py-comment"># Collect parameter names.</tt> </tt>
<a name="L662"></a><tt class="py-lineno"> 662</tt>  <tt class="py-line">            <tt class="py-name">param_names</tt><tt class="py-op">.</tt><tt id="link-353" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-353', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">param_name</tt><tt class="py-op">)</tt> </tt>
<a name="L663"></a><tt class="py-lineno"> 663</tt>  <tt class="py-line"> </tt>
<a name="L664"></a><tt class="py-lineno"> 664</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the parameter names.</tt> </tt>
<a name="L665"></a><tt class="py-lineno"> 665</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-354" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-354', 'i', 'link-201');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">param_names</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L666"></a><tt class="py-lineno"> 666</tt>  <tt class="py-line">            <tt class="py-comment"># Test if the parameter is in the list:</tt> </tt>
<a name="L667"></a><tt class="py-lineno"> 667</tt>  <tt class="py-line"> </tt>
<a name="L668"></a><tt class="py-lineno"> 668</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">param_names</tt><tt class="py-op">[</tt><tt id="link-355" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-355', 'i', 'link-201');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-name">param</tt><tt class="py-op">:</tt> </tt>
<a name="L669"></a><tt class="py-lineno"> 669</tt>  <tt class="py-line">                <tt class="py-keyword">return</tt> <tt class="py-op">[</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_PARAMS</tt><tt class="py-op">.</tt><tt id="link-356" class="py-name" targets="Method specific_analyses.parameter_object.Param_list.grid_lower()=specific_analyses.parameter_object.Param_list-class.html#grid_lower"><a title="specific_analyses.parameter_object.Param_list.grid_lower" class="py-name" href="#" onclick="return doclink('link-356', 'grid_lower', 'link-356');">grid_lower</a></tt><tt class="py-op">(</tt><tt class="py-name">param</tt><tt class="py-op">,</tt> <tt class="py-name">incs</tt><tt class="py-op">=</tt><tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-name">model_info</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt id="link-357" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-357', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_PARAMS</tt><tt class="py-op">.</tt><tt id="link-358" class="py-name" targets="Method specific_analyses.parameter_object.Param_list.grid_upper()=specific_analyses.parameter_object.Param_list-class.html#grid_upper"><a title="specific_analyses.parameter_object.Param_list.grid_upper" class="py-name" href="#" onclick="return doclink('link-358', 'grid_upper', 'link-358');">grid_upper</a></tt><tt class="py-op">(</tt><tt class="py-name">param</tt><tt class="py-op">,</tt> <tt class="py-name">incs</tt><tt class="py-op">=</tt><tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-name">model_info</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt id="link-359" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-359', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">]</tt> </tt>
</div><a name="L670"></a><tt class="py-lineno"> 670</tt>  <tt class="py-line"> </tt>
<a name="L671"></a><tt class="py-lineno"> 671</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.minimise"></a><div id="Relax_disp.minimise-def"><a name="L672"></a><tt class="py-lineno"> 672</tt> <a class="py-toggle" href="#" id="Relax_disp.minimise-toggle" onclick="return toggle('Relax_disp.minimise');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#minimise">minimise</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">min_algor</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">min_options</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">func_tol</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">grad_tol</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">max_iterations</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">constraints</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">,</tt> <tt class="py-param">scaling_matrix</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">verbosity</tt><tt class="py-op">=</tt><tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-param">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">lower</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">upper</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">inc</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.minimise-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.minimise-expanded"><a name="L673"></a><tt class="py-lineno"> 673</tt>  <tt class="py-line">        <tt class="py-docstring">"""Relaxation dispersion curve fitting function.</tt> </tt>
<a name="L674"></a><tt class="py-lineno"> 674</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L675"></a><tt class="py-lineno"> 675</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword min_algor:         The minimisation algorithm to use.</tt> </tt>
<a name="L676"></a><tt class="py-lineno"> 676</tt>  <tt class="py-line"><tt class="py-docstring">        @type min_algor:            str</tt> </tt>
<a name="L677"></a><tt class="py-lineno"> 677</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword min_options:       An array of options to be used by the minimisation algorithm.</tt> </tt>
<a name="L678"></a><tt class="py-lineno"> 678</tt>  <tt class="py-line"><tt class="py-docstring">        @type min_options:          array of str</tt> </tt>
<a name="L679"></a><tt class="py-lineno"> 679</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword func_tol:          The function tolerance which, when reached, terminates optimisation.  Setting this to None turns of the check.</tt> </tt>
<a name="L680"></a><tt class="py-lineno"> 680</tt>  <tt class="py-line"><tt class="py-docstring">        @type func_tol:             None or float</tt> </tt>
<a name="L681"></a><tt class="py-lineno"> 681</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword grad_tol:          The gradient tolerance which, when reached, terminates optimisation.  Setting this to None turns of the check.</tt> </tt>
<a name="L682"></a><tt class="py-lineno"> 682</tt>  <tt class="py-line"><tt class="py-docstring">        @type grad_tol:             None or float</tt> </tt>
<a name="L683"></a><tt class="py-lineno"> 683</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword max_iterations:    The maximum number of iterations for the algorithm.</tt> </tt>
<a name="L684"></a><tt class="py-lineno"> 684</tt>  <tt class="py-line"><tt class="py-docstring">        @type max_iterations:       int</tt> </tt>
<a name="L685"></a><tt class="py-lineno"> 685</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword constraints:       If True, constraints are used during optimisation.</tt> </tt>
<a name="L686"></a><tt class="py-lineno"> 686</tt>  <tt class="py-line"><tt class="py-docstring">        @type constraints:          bool</tt> </tt>
<a name="L687"></a><tt class="py-lineno"> 687</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword scaling_matrix:    The per-model list of diagonal and square scaling matrices.</tt> </tt>
<a name="L688"></a><tt class="py-lineno"> 688</tt>  <tt class="py-line"><tt class="py-docstring">        @type scaling_matrix:       list of numpy rank-2, float64 array or list of None</tt> </tt>
<a name="L689"></a><tt class="py-lineno"> 689</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword verbosity:         The amount of information to print.  The higher the value, the greater the verbosity.</tt> </tt>
<a name="L690"></a><tt class="py-lineno"> 690</tt>  <tt class="py-line"><tt class="py-docstring">        @type verbosity:            int</tt> </tt>
<a name="L691"></a><tt class="py-lineno"> 691</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword sim_index:         The index of the simulation to optimise.  This should be None if normal optimisation is desired.</tt> </tt>
<a name="L692"></a><tt class="py-lineno"> 692</tt>  <tt class="py-line"><tt class="py-docstring">        @type sim_index:            None or int</tt> </tt>
<a name="L693"></a><tt class="py-lineno"> 693</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword lower:             The per-model lower bounds of the grid search which must be equal to the number of parameters in the model.  This optional argument is only used when doing a grid search.</tt> </tt>
<a name="L694"></a><tt class="py-lineno"> 694</tt>  <tt class="py-line"><tt class="py-docstring">        @type lower:                list of list of numbers</tt> </tt>
<a name="L695"></a><tt class="py-lineno"> 695</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword upper:             The per-model upper bounds of the grid search which must be equal to the number of parameters in the model.  This optional argument is only used when doing a grid search.</tt> </tt>
<a name="L696"></a><tt class="py-lineno"> 696</tt>  <tt class="py-line"><tt class="py-docstring">        @type upper:                list of list of numbers</tt> </tt>
<a name="L697"></a><tt class="py-lineno"> 697</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword inc:               The per-model increments for each dimension of the space for the grid search. The number of elements in the array must equal to the number of parameters in the model.  This argument is only used when doing a grid search.</tt> </tt>
<a name="L698"></a><tt class="py-lineno"> 698</tt>  <tt class="py-line"><tt class="py-docstring">        @type inc:                  list of list of int</tt> </tt>
<a name="L699"></a><tt class="py-lineno"> 699</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L700"></a><tt class="py-lineno"> 700</tt>  <tt class="py-line"> </tt>
<a name="L701"></a><tt class="py-lineno"> 701</tt>  <tt class="py-line">        <tt class="py-comment"># Data checks.</tt> </tt>
<a name="L702"></a><tt class="py-lineno"> 702</tt>  <tt class="py-line">        <tt id="link-360" class="py-name"><a title="pipe_control.mol_res_spin.check_mol_res_spin_data" class="py-name" href="#" onclick="return doclink('link-360', 'check_mol_res_spin_data', 'link-42');">check_mol_res_spin_data</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L703"></a><tt class="py-lineno"> 703</tt>  <tt class="py-line">        <tt id="link-361" class="py-name"><a title="specific_analyses.relax_disp.checks.check_model_type" class="py-name" href="#" onclick="return doclink('link-361', 'check_model_type', 'link-64');">check_model_type</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L704"></a><tt class="py-lineno"> 704</tt>  <tt class="py-line"> </tt>
<a name="L705"></a><tt class="py-lineno"> 705</tt>  <tt class="py-line">        <tt class="py-comment"># Check the optimisation algorithm.</tt> </tt>
<a name="L706"></a><tt class="py-lineno"> 706</tt>  <tt class="py-line">        <tt class="py-name">algor</tt> <tt class="py-op">=</tt> <tt class="py-name">min_algor</tt> </tt>
<a name="L707"></a><tt class="py-lineno"> 707</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">min_algor</tt> <tt class="py-op">==</tt> <tt class="py-string">'Log barrier'</tt><tt class="py-op">:</tt> </tt>
<a name="L708"></a><tt class="py-lineno"> 708</tt>  <tt class="py-line">            <tt class="py-name">algor</tt> <tt class="py-op">=</tt> <tt class="py-name">min_options</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L709"></a><tt class="py-lineno"> 709</tt>  <tt class="py-line"> </tt>
<a name="L710"></a><tt class="py-lineno"> 710</tt>  <tt class="py-line">        <tt class="py-name">allow</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L711"></a><tt class="py-lineno"> 711</tt>  <tt class="py-line">        <tt class="py-comment"># Check the model type.</tt> </tt>
<a name="L712"></a><tt class="py-lineno"> 712</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'model_type'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L713"></a><tt class="py-lineno"> 713</tt>  <tt class="py-line">            <tt class="py-comment"># Set the model type:</tt> </tt>
<a name="L714"></a><tt class="py-lineno"> 714</tt>  <tt class="py-line">            <tt id="link-362" class="py-name"><a title="specific_analyses.api_base.API_base.model_type
specific_analyses.hybrid.Hybrid.model_type
specific_analyses.model_free.api.Model_free.model_type" class="py-name" href="#" onclick="return doclink('link-362', 'model_type', 'link-106');">model_type</a></tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-363" class="py-name"><a title="specific_analyses.api_base.API_base.model_type
specific_analyses.hybrid.Hybrid.model_type
specific_analyses.model_free.api.Model_free.model_type" class="py-name" href="#" onclick="return doclink('link-363', 'model_type', 'link-106');">model_type</a></tt> </tt>
<a name="L715"></a><tt class="py-lineno"> 715</tt>  <tt class="py-line"> </tt>
<a name="L716"></a><tt class="py-lineno"> 716</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-364" class="py-name"><a title="specific_analyses.api_base.API_base.model_type
specific_analyses.hybrid.Hybrid.model_type
specific_analyses.model_free.api.Model_free.model_type" class="py-name" href="#" onclick="return doclink('link-364', 'model_type', 'link-106');">model_type</a></tt> <tt class="py-op">==</tt> <tt id="link-365" class="py-name"><a title="lib.dispersion.variables.MODEL_R2EFF" class="py-name" href="#" onclick="return doclink('link-365', 'MODEL_R2EFF', 'link-14');">MODEL_R2EFF</a></tt><tt class="py-op">:</tt> </tt>
<a name="L717"></a><tt class="py-lineno"> 717</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">match</tt><tt class="py-op">(</tt><tt class="py-string">'^[Gg]rid$'</tt><tt class="py-op">,</tt> <tt class="py-name">algor</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L718"></a><tt class="py-lineno"> 718</tt>  <tt class="py-line">                    <tt class="py-name">allow</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L719"></a><tt class="py-lineno"> 719</tt>  <tt class="py-line"> </tt>
<a name="L720"></a><tt class="py-lineno"> 720</tt>  <tt class="py-line">                <tt class="py-keyword">elif</tt> <tt class="py-name">match</tt><tt class="py-op">(</tt><tt class="py-string">'^[Ss]implex$'</tt><tt class="py-op">,</tt> <tt class="py-name">algor</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L721"></a><tt class="py-lineno"> 721</tt>  <tt class="py-line">                    <tt class="py-name">allow</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L722"></a><tt class="py-lineno"> 722</tt>  <tt class="py-line"> </tt>
<a name="L723"></a><tt class="py-lineno"> 723</tt>  <tt class="py-line">                <tt class="py-comment"># Quasi-Newton BFGS minimisation.</tt> </tt>
<a name="L724"></a><tt class="py-lineno"> 724</tt>  <tt class="py-line">                <tt class="py-keyword">elif</tt> <tt class="py-name">match</tt><tt class="py-op">(</tt><tt class="py-string">'^[Bb][Ff][Gg][Ss]$'</tt><tt class="py-op">,</tt> <tt class="py-name">algor</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L725"></a><tt class="py-lineno"> 725</tt>  <tt class="py-line">                    <tt class="py-name">allow</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L726"></a><tt class="py-lineno"> 726</tt>  <tt class="py-line"> </tt>
<a name="L727"></a><tt class="py-lineno"> 727</tt>  <tt class="py-line">                <tt class="py-comment"># Newton minimisation.</tt> </tt>
<a name="L728"></a><tt class="py-lineno"> 728</tt>  <tt class="py-line">                <tt class="py-keyword">elif</tt> <tt class="py-name">match</tt><tt class="py-op">(</tt><tt class="py-string">'^[Nn]ewton$'</tt><tt class="py-op">,</tt> <tt class="py-name">algor</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L729"></a><tt class="py-lineno"> 729</tt>  <tt class="py-line">                    <tt class="py-name">allow</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L730"></a><tt class="py-lineno"> 730</tt>  <tt class="py-line"> </tt>
<a name="L731"></a><tt class="py-lineno"> 731</tt>  <tt class="py-line">                <tt class="py-comment"># Newton minimisation.</tt> </tt>
<a name="L732"></a><tt class="py-lineno"> 732</tt>  <tt class="py-line">                <tt class="py-keyword">elif</tt> <tt class="py-name">match</tt><tt class="py-op">(</tt><tt class="py-string">'^[Nn]ewton$'</tt><tt class="py-op">,</tt> <tt class="py-name">algor</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L733"></a><tt class="py-lineno"> 733</tt>  <tt class="py-line">                    <tt class="py-name">allow</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L734"></a><tt class="py-lineno"> 734</tt>  <tt class="py-line"> </tt>
<a name="L735"></a><tt class="py-lineno"> 735</tt>  <tt class="py-line">                <tt class="py-comment"># Constrained method, Method of Multipliers.</tt> </tt>
<a name="L736"></a><tt class="py-lineno"> 736</tt>  <tt class="py-line">                <tt class="py-keyword">elif</tt> <tt class="py-name">match</tt><tt class="py-op">(</tt><tt class="py-string">'^[Mm][Oo][Mm]$'</tt><tt class="py-op">,</tt> <tt class="py-name">algor</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-name">match</tt><tt class="py-op">(</tt><tt class="py-string">'[Mm]ethod of [Mm]ultipliers$'</tt><tt class="py-op">,</tt> <tt class="py-name">algor</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L737"></a><tt class="py-lineno"> 737</tt>  <tt class="py-line">                    <tt class="py-name">allow</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L738"></a><tt class="py-lineno"> 738</tt>  <tt class="py-line">                     </tt>
<a name="L739"></a><tt class="py-lineno"> 739</tt>  <tt class="py-line">                <tt class="py-comment"># Constrained method, Logarithmic barrier function.</tt> </tt>
<a name="L740"></a><tt class="py-lineno"> 740</tt>  <tt class="py-line">                <tt class="py-keyword">elif</tt> <tt class="py-name">match</tt><tt class="py-op">(</tt><tt class="py-string">'^[Ll]og [Bb]arrier$'</tt><tt class="py-op">,</tt> <tt class="py-name">algor</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L741"></a><tt class="py-lineno"> 741</tt>  <tt class="py-line">                    <tt class="py-name">allow</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L742"></a><tt class="py-lineno"> 742</tt>  <tt class="py-line"> </tt>
<a name="L743"></a><tt class="py-lineno"> 743</tt>  <tt class="py-line">            <tt class="py-comment"># If the Jacobian and Hessian matrix have not been specified for fitting, 'simplex' should be used.</tt> </tt>
<a name="L744"></a><tt class="py-lineno"> 744</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L745"></a><tt class="py-lineno"> 745</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">match</tt><tt class="py-op">(</tt><tt class="py-string">'^[Gg]rid$'</tt><tt class="py-op">,</tt> <tt class="py-name">algor</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L746"></a><tt class="py-lineno"> 746</tt>  <tt class="py-line">                    <tt class="py-name">allow</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L747"></a><tt class="py-lineno"> 747</tt>  <tt class="py-line"> </tt>
<a name="L748"></a><tt class="py-lineno"> 748</tt>  <tt class="py-line">                <tt class="py-keyword">elif</tt> <tt class="py-name">match</tt><tt class="py-op">(</tt><tt class="py-string">'^[Ss]implex$'</tt><tt class="py-op">,</tt> <tt class="py-name">algor</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L749"></a><tt class="py-lineno"> 749</tt>  <tt class="py-line">                    <tt class="py-name">allow</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L750"></a><tt class="py-lineno"> 750</tt>  <tt class="py-line"> </tt>
<a name="L751"></a><tt class="py-lineno"> 751</tt>  <tt class="py-line">        <tt class="py-comment"># Do not allow, if no model has been specified.</tt> </tt>
<a name="L752"></a><tt class="py-lineno"> 752</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L753"></a><tt class="py-lineno"> 753</tt>  <tt class="py-line">            <tt id="link-366" class="py-name"><a title="specific_analyses.api_base.API_base.model_type
specific_analyses.hybrid.Hybrid.model_type
specific_analyses.model_free.api.Model_free.model_type" class="py-name" href="#" onclick="return doclink('link-366', 'model_type', 'link-106');">model_type</a></tt> <tt class="py-op">=</tt> <tt class="py-string">'None'</tt> </tt>
<a name="L754"></a><tt class="py-lineno"> 754</tt>  <tt class="py-line">            <tt class="py-comment"># Do not allow.</tt> </tt>
<a name="L755"></a><tt class="py-lineno"> 755</tt>  <tt class="py-line">            <tt class="py-name">allow</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L756"></a><tt class="py-lineno"> 756</tt>  <tt class="py-line"> </tt>
<a name="L757"></a><tt class="py-lineno"> 757</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">allow</tt><tt class="py-op">:</tt> </tt>
<a name="L758"></a><tt class="py-lineno"> 758</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-367" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-367', 'RelaxError', 'link-18');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Minimisation algorithm '%s' is not allowed, since function gradients for model '%s' is not implemented.  Only the 'simplex' minimisation algorithm is supported for the relaxation dispersion analysis of this model."</tt><tt class="py-op">%</tt><tt class="py-op">(</tt><tt class="py-name">algor</tt><tt class="py-op">,</tt> <tt id="link-368" class="py-name"><a title="specific_analyses.api_base.API_base.model_type
specific_analyses.hybrid.Hybrid.model_type
specific_analyses.model_free.api.Model_free.model_type" class="py-name" href="#" onclick="return doclink('link-368', 'model_type', 'link-106');">model_type</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L759"></a><tt class="py-lineno"> 759</tt>  <tt class="py-line"> </tt>
<a name="L760"></a><tt class="py-lineno"> 760</tt>  <tt class="py-line">        <tt class="py-comment"># Initialise some empty data pipe structures so that the target function set up does not fail.</tt> </tt>
<a name="L761"></a><tt class="py-lineno"> 761</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'cpmg_frqs_list'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L762"></a><tt class="py-lineno"> 762</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">cpmg_frqs_list</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L763"></a><tt class="py-lineno"> 763</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'spin_lock_nu1_list'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L764"></a><tt class="py-lineno"> 764</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">spin_lock_nu1_list</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L765"></a><tt class="py-lineno"> 765</tt>  <tt class="py-line"> </tt>
<a name="L766"></a><tt class="py-lineno"> 766</tt>  <tt class="py-line">        <tt class="py-comment"># Get the Processor box singleton (it contains the Processor instance) and alias the Processor.</tt> </tt>
<a name="L767"></a><tt class="py-lineno"> 767</tt>  <tt class="py-line">        <tt class="py-name">processor_box</tt> <tt class="py-op">=</tt> <tt id="link-369" class="py-name"><a title="multi.Processor_box" class="py-name" href="#" onclick="return doclink('link-369', 'Processor_box', 'link-29');">Processor_box</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt>  </tt>
<a name="L768"></a><tt class="py-lineno"> 768</tt>  <tt class="py-line">        <tt id="link-370" class="py-name" targets="Module multi.processor=multi.processor-module.html"><a title="multi.processor" class="py-name" href="#" onclick="return doclink('link-370', 'processor', 'link-370');">processor</a></tt> <tt class="py-op">=</tt> <tt class="py-name">processor_box</tt><tt class="py-op">.</tt><tt id="link-371" class="py-name"><a title="multi.processor" class="py-name" href="#" onclick="return doclink('link-371', 'processor', 'link-370');">processor</a></tt> </tt>
<a name="L769"></a><tt class="py-lineno"> 769</tt>  <tt class="py-line"> </tt>
<a name="L770"></a><tt class="py-lineno"> 770</tt>  <tt class="py-line">        <tt class="py-comment"># The number of time points for the exponential curves (if present).</tt> </tt>
<a name="L771"></a><tt class="py-lineno"> 771</tt>  <tt class="py-line">        <tt class="py-name">num_time_pts</tt> <tt class="py-op">=</tt> <tt class="py-number">1</tt> </tt>
<a name="L772"></a><tt class="py-lineno"> 772</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'num_time_pts'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L773"></a><tt class="py-lineno"> 773</tt>  <tt class="py-line">            <tt class="py-name">num_time_pts</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">num_time_pts</tt> </tt>
<a name="L774"></a><tt class="py-lineno"> 774</tt>  <tt class="py-line"> </tt>
<a name="L775"></a><tt class="py-lineno"> 775</tt>  <tt class="py-line">        <tt class="py-comment"># Number of spectrometer fields.</tt> </tt>
<a name="L776"></a><tt class="py-lineno"> 776</tt>  <tt class="py-line">        <tt class="py-name">fields</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-name">None</tt><tt class="py-op">]</tt> </tt>
<a name="L777"></a><tt class="py-lineno"> 777</tt>  <tt class="py-line">        <tt class="py-name">field_count</tt> <tt class="py-op">=</tt> <tt class="py-number">1</tt> </tt>
<a name="L778"></a><tt class="py-lineno"> 778</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'spectrometer_frq'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L779"></a><tt class="py-lineno"> 779</tt>  <tt class="py-line">            <tt class="py-name">fields</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">spectrometer_frq_list</tt> </tt>
<a name="L780"></a><tt class="py-lineno"> 780</tt>  <tt class="py-line">            <tt class="py-name">field_count</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">spectrometer_frq_count</tt> </tt>
<a name="L781"></a><tt class="py-lineno"> 781</tt>  <tt class="py-line"> </tt>
<a name="L782"></a><tt class="py-lineno"> 782</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the spin blocks.</tt> </tt>
<a name="L783"></a><tt class="py-lineno"> 783</tt>  <tt class="py-line">        <tt class="py-name">model_index</tt> <tt class="py-op">=</tt> <tt class="py-op">-</tt><tt class="py-number">1</tt> </tt>
<a name="L784"></a><tt class="py-lineno"> 784</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">spin_ids</tt> <tt class="py-keyword">in</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-372" class="py-name"><a title="lib.structure.internal.object.Internal.model_loop
specific_analyses.api_base.API_base.model_loop
specific_analyses.hybrid.Hybrid.model_loop
specific_analyses.model_free.api.Model_free.model_loop
specific_analyses.relax_disp.api.Relax_disp.model_loop" class="py-name" href="#" onclick="return doclink('link-372', 'model_loop', 'link-215');">model_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L785"></a><tt class="py-lineno"> 785</tt>  <tt class="py-line">            <tt class="py-comment"># Increment the model index.</tt> </tt>
<a name="L786"></a><tt class="py-lineno"> 786</tt>  <tt class="py-line">            <tt class="py-name">model_index</tt> <tt class="py-op">+=</tt> <tt class="py-number">1</tt> </tt>
<a name="L787"></a><tt class="py-lineno"> 787</tt>  <tt class="py-line"> </tt>
<a name="L788"></a><tt class="py-lineno"> 788</tt>  <tt class="py-line">            <tt class="py-comment"># The spin containers.</tt> </tt>
<a name="L789"></a><tt class="py-lineno"> 789</tt>  <tt class="py-line">            <tt class="py-name">spins</tt> <tt class="py-op">=</tt> <tt id="link-373" class="py-name"><a title="specific_analyses.relax_disp.data.spin_ids_to_containers" class="py-name" href="#" onclick="return doclink('link-373', 'spin_ids_to_containers', 'link-80');">spin_ids_to_containers</a></tt><tt class="py-op">(</tt><tt class="py-name">spin_ids</tt><tt class="py-op">)</tt> </tt>
<a name="L790"></a><tt class="py-lineno"> 790</tt>  <tt class="py-line"> </tt>
<a name="L791"></a><tt class="py-lineno"> 791</tt>  <tt class="py-line">            <tt class="py-comment"># Skip deselected clusters.</tt> </tt>
<a name="L792"></a><tt class="py-lineno"> 792</tt>  <tt class="py-line">            <tt class="py-name">skip</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L793"></a><tt class="py-lineno"> 793</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-374" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-374', 'spin', 'link-115');">spin</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">spins</tt><tt class="py-op">:</tt> </tt>
<a name="L794"></a><tt class="py-lineno"> 794</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt id="link-375" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-375', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-376" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-376', 'select', 'link-118');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L795"></a><tt class="py-lineno"> 795</tt>  <tt class="py-line">                    <tt class="py-name">skip</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L796"></a><tt class="py-lineno"> 796</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">skip</tt><tt class="py-op">:</tt> </tt>
<a name="L797"></a><tt class="py-lineno"> 797</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L798"></a><tt class="py-lineno"> 798</tt>  <tt class="py-line"> </tt>
<a name="L799"></a><tt class="py-lineno"> 799</tt>  <tt class="py-line">            <tt class="py-comment"># Alias the grid options.</tt> </tt>
<a name="L800"></a><tt class="py-lineno"> 800</tt>  <tt class="py-line">            <tt class="py-name">lower_i</tt><tt class="py-op">,</tt> <tt class="py-name">upper_i</tt><tt class="py-op">,</tt> <tt class="py-name">inc_i</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt> </tt>
<a name="L801"></a><tt class="py-lineno"> 801</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">min_algor</tt> <tt class="py-op">==</tt> <tt class="py-string">'grid'</tt><tt class="py-op">:</tt> </tt>
<a name="L802"></a><tt class="py-lineno"> 802</tt>  <tt class="py-line">                <tt class="py-name">lower_i</tt> <tt class="py-op">=</tt> <tt class="py-name">lower</tt><tt class="py-op">[</tt><tt class="py-name">model_index</tt><tt class="py-op">]</tt> </tt>
<a name="L803"></a><tt class="py-lineno"> 803</tt>  <tt class="py-line">                <tt class="py-name">upper_i</tt> <tt class="py-op">=</tt> <tt class="py-name">upper</tt><tt class="py-op">[</tt><tt class="py-name">model_index</tt><tt class="py-op">]</tt> </tt>
<a name="L804"></a><tt class="py-lineno"> 804</tt>  <tt class="py-line">                <tt class="py-name">inc_i</tt> <tt class="py-op">=</tt> <tt class="py-name">inc</tt><tt class="py-op">[</tt><tt class="py-name">model_index</tt><tt class="py-op">]</tt> </tt>
<a name="L805"></a><tt class="py-lineno"> 805</tt>  <tt class="py-line"> </tt>
<a name="L806"></a><tt class="py-lineno"> 806</tt>  <tt class="py-line">            <tt class="py-comment"># Special exponential curve-fitting for the R2eff model.</tt> </tt>
<a name="L807"></a><tt class="py-lineno"> 807</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-377" class="py-name"><a title="specific_analyses.api_base.API_base.model_type
specific_analyses.hybrid.Hybrid.model_type
specific_analyses.model_free.api.Model_free.model_type" class="py-name" href="#" onclick="return doclink('link-377', 'model_type', 'link-106');">model_type</a></tt> <tt class="py-op">==</tt> <tt id="link-378" class="py-name"><a title="lib.dispersion.variables.MODEL_R2EFF" class="py-name" href="#" onclick="return doclink('link-378', 'MODEL_R2EFF', 'link-14');">MODEL_R2EFF</a></tt><tt class="py-op">:</tt> </tt>
<a name="L808"></a><tt class="py-lineno"> 808</tt>  <tt class="py-line">                <tt class="py-comment"># Sanity checks.</tt> </tt>
<a name="L809"></a><tt class="py-lineno"> 809</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-379" class="py-name"><a title="specific_analyses.relax_disp.data.has_exponential_exp_type" class="py-name" href="#" onclick="return doclink('link-379', 'has_exponential_exp_type', 'link-72');">has_exponential_exp_type</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L810"></a><tt class="py-lineno"> 810</tt>  <tt class="py-line">                    <tt class="py-keyword">raise</tt> <tt id="link-380" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-380', 'RelaxError', 'link-18');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The R2eff model with the fixed time period dispersion experiments cannot be optimised."</tt><tt class="py-op">)</tt> </tt>
<a name="L811"></a><tt class="py-lineno"> 811</tt>  <tt class="py-line"> </tt>
<a name="L812"></a><tt class="py-lineno"> 812</tt>  <tt class="py-line">                <tt class="py-comment"># Optimisation.</tt> </tt>
<a name="L813"></a><tt class="py-lineno"> 813</tt>  <tt class="py-line">                <tt id="link-381" class="py-name"><a title="specific_analyses.relax_disp.optimisation.minimise_r2eff" class="py-name" href="#" onclick="return doclink('link-381', 'minimise_r2eff', 'link-89');">minimise_r2eff</a></tt><tt class="py-op">(</tt><tt class="py-name">spins</tt><tt class="py-op">=</tt><tt class="py-name">spins</tt><tt class="py-op">,</tt> <tt class="py-name">spin_ids</tt><tt class="py-op">=</tt><tt class="py-name">spin_ids</tt><tt class="py-op">,</tt> <tt class="py-name">min_algor</tt><tt class="py-op">=</tt><tt class="py-name">min_algor</tt><tt class="py-op">,</tt> <tt class="py-name">min_options</tt><tt class="py-op">=</tt><tt class="py-name">min_options</tt><tt class="py-op">,</tt> <tt class="py-name">func_tol</tt><tt class="py-op">=</tt><tt class="py-name">func_tol</tt><tt class="py-op">,</tt> <tt class="py-name">grad_tol</tt><tt class="py-op">=</tt><tt class="py-name">grad_tol</tt><tt class="py-op">,</tt> <tt class="py-name">max_iterations</tt><tt class="py-op">=</tt><tt class="py-name">max_iterations</tt><tt class="py-op">,</tt> <tt class="py-name">constraints</tt><tt class="py-op">=</tt><tt class="py-name">constraints</tt><tt class="py-op">,</tt> <tt class="py-name">scaling_matrix</tt><tt class="py-op">=</tt><tt class="py-name">scaling_matrix</tt><tt class="py-op">[</tt><tt class="py-name">model_index</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt id="link-382" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-382', 'verbosity', 'link-337');">verbosity</a></tt><tt class="py-op">=</tt><tt id="link-383" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-383', 'verbosity', 'link-337');">verbosity</a></tt><tt class="py-op">,</tt> <tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">,</tt> <tt class="py-name">lower</tt><tt class="py-op">=</tt><tt class="py-name">lower_i</tt><tt class="py-op">,</tt> <tt class="py-name">upper</tt><tt class="py-op">=</tt><tt class="py-name">upper_i</tt><tt class="py-op">,</tt> <tt class="py-name">inc</tt><tt class="py-op">=</tt><tt class="py-name">inc_i</tt><tt class="py-op">)</tt> </tt>
<a name="L814"></a><tt class="py-lineno"> 814</tt>  <tt class="py-line"> </tt>
<a name="L815"></a><tt class="py-lineno"> 815</tt>  <tt class="py-line">                <tt class="py-comment"># Skip the rest.</tt> </tt>
<a name="L816"></a><tt class="py-lineno"> 816</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L817"></a><tt class="py-lineno"> 817</tt>  <tt class="py-line"> </tt>
<a name="L818"></a><tt class="py-lineno"> 818</tt>  <tt class="py-line">            <tt class="py-comment"># Set up the slave command object.</tt> </tt>
<a name="L819"></a><tt class="py-lineno"> 819</tt>  <tt class="py-line">            <tt id="link-384" class="py-name" targets="Function pipe_control.molmol.command()=pipe_control.molmol-module.html#command,Function pipe_control.pymol_control.command()=pipe_control.pymol_control-module.html#command,Module prompt.command=prompt.command-module.html"><a title="pipe_control.molmol.command
pipe_control.pymol_control.command
prompt.command" class="py-name" href="#" onclick="return doclink('link-384', 'command', 'link-384');">command</a></tt> <tt class="py-op">=</tt> <tt id="link-385" class="py-name"><a title="specific_analyses.relax_disp.optimisation.Disp_minimise_command" class="py-name" href="#" onclick="return doclink('link-385', 'Disp_minimise_command', 'link-85');">Disp_minimise_command</a></tt><tt class="py-op">(</tt><tt class="py-name">spins</tt><tt class="py-op">=</tt><tt class="py-name">spins</tt><tt class="py-op">,</tt> <tt class="py-name">spin_ids</tt><tt class="py-op">=</tt><tt class="py-name">spin_ids</tt><tt class="py-op">,</tt> <tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">,</tt> <tt class="py-name">scaling_matrix</tt><tt class="py-op">=</tt><tt class="py-name">scaling_matrix</tt><tt class="py-op">[</tt><tt class="py-name">model_index</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">min_algor</tt><tt class="py-op">=</tt><tt class="py-name">min_algor</tt><tt class="py-op">,</tt> <tt class="py-name">min_options</tt><tt class="py-op">=</tt><tt class="py-name">min_options</tt><tt class="py-op">,</tt> <tt class="py-name">func_tol</tt><tt class="py-op">=</tt><tt class="py-name">func_tol</tt><tt class="py-op">,</tt> <tt class="py-name">grad_tol</tt><tt class="py-op">=</tt><tt class="py-name">grad_tol</tt><tt class="py-op">,</tt> <tt class="py-name">max_iterations</tt><tt class="py-op">=</tt><tt class="py-name">max_iterations</tt><tt class="py-op">,</tt> <tt class="py-name">constraints</tt><tt class="py-op">=</tt><tt class="py-name">constraints</tt><tt class="py-op">,</tt> <tt id="link-386" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-386', 'verbosity', 'link-337');">verbosity</a></tt><tt class="py-op">=</tt><tt id="link-387" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-387', 'verbosity', 'link-337');">verbosity</a></tt><tt class="py-op">,</tt> <tt class="py-name">lower</tt><tt class="py-op">=</tt><tt class="py-name">lower_i</tt><tt class="py-op">,</tt> <tt class="py-name">upper</tt><tt class="py-op">=</tt><tt class="py-name">upper_i</tt><tt class="py-op">,</tt> <tt class="py-name">inc</tt><tt class="py-op">=</tt><tt class="py-name">inc_i</tt><tt class="py-op">,</tt> <tt class="py-name">fields</tt><tt class="py-op">=</tt><tt class="py-name">fields</tt><tt class="py-op">,</tt> <tt class="py-name">param_names</tt><tt class="py-op">=</tt><tt id="link-388" class="py-name"><a title="specific_analyses.api_base.API_base.get_param_names
specific_analyses.consistency_tests.api.Consistency_tests.get_param_names
specific_analyses.frame_order.api.Frame_order.get_param_names
specific_analyses.jw_mapping.api.Jw_mapping.get_param_names
specific_analyses.model_free.api.Model_free.get_param_names
specific_analyses.n_state_model.api.N_state_model.get_param_names
specific_analyses.noe.api.Noe.get_param_names
specific_analyses.relax_disp.api.Relax_disp.get_param_names
specific_analyses.relax_disp.parameters.get_param_names
specific_analyses.relax_fit.api.Relax_fit.get_param_names" class="py-name" href="#" onclick="return doclink('link-388', 'get_param_names', 'link-97');">get_param_names</a></tt><tt class="py-op">(</tt><tt class="py-name">spins</tt><tt class="py-op">=</tt><tt class="py-name">spins</tt><tt class="py-op">,</tt> <tt class="py-name">full</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L820"></a><tt class="py-lineno"> 820</tt>  <tt class="py-line"> </tt>
<a name="L821"></a><tt class="py-lineno"> 821</tt>  <tt class="py-line">            <tt class="py-comment"># Set up the memo.</tt> </tt>
<a name="L822"></a><tt class="py-lineno"> 822</tt>  <tt class="py-line">            <tt id="link-389" class="py-name" targets="Module multi.memo=multi.memo-module.html"><a title="multi.memo" class="py-name" href="#" onclick="return doclink('link-389', 'memo', 'link-389');">memo</a></tt> <tt class="py-op">=</tt> <tt id="link-390" class="py-name"><a title="specific_analyses.relax_disp.optimisation.Disp_memo" class="py-name" href="#" onclick="return doclink('link-390', 'Disp_memo', 'link-84');">Disp_memo</a></tt><tt class="py-op">(</tt><tt class="py-name">spins</tt><tt class="py-op">=</tt><tt class="py-name">spins</tt><tt class="py-op">,</tt> <tt class="py-name">spin_ids</tt><tt class="py-op">=</tt><tt class="py-name">spin_ids</tt><tt class="py-op">,</tt> <tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">,</tt> <tt class="py-name">scaling_matrix</tt><tt class="py-op">=</tt><tt class="py-name">scaling_matrix</tt><tt class="py-op">[</tt><tt class="py-name">model_index</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt id="link-391" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-391', 'verbosity', 'link-337');">verbosity</a></tt><tt class="py-op">=</tt><tt id="link-392" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-392', 'verbosity', 'link-337');">verbosity</a></tt><tt class="py-op">)</tt> </tt>
<a name="L823"></a><tt class="py-lineno"> 823</tt>  <tt class="py-line"> </tt>
<a name="L824"></a><tt class="py-lineno"> 824</tt>  <tt class="py-line">            <tt class="py-comment"># Add the slave command and memo to the processor queue.</tt> </tt>
<a name="L825"></a><tt class="py-lineno"> 825</tt>  <tt class="py-line">            <tt id="link-393" class="py-name"><a title="multi.processor" class="py-name" href="#" onclick="return doclink('link-393', 'processor', 'link-370');">processor</a></tt><tt class="py-op">.</tt><tt id="link-394" class="py-name" targets="Method multi.multi_processor_base.Multi_processor.add_to_queue()=multi.multi_processor_base.Multi_processor-class.html#add_to_queue,Method multi.processor.Processor.add_to_queue()=multi.processor.Processor-class.html#add_to_queue,Method multi.uni_processor.Uni_processor.add_to_queue()=multi.uni_processor.Uni_processor-class.html#add_to_queue"><a title="multi.multi_processor_base.Multi_processor.add_to_queue
multi.processor.Processor.add_to_queue
multi.uni_processor.Uni_processor.add_to_queue" class="py-name" href="#" onclick="return doclink('link-394', 'add_to_queue', 'link-394');">add_to_queue</a></tt><tt class="py-op">(</tt><tt id="link-395" class="py-name"><a title="pipe_control.molmol.command
pipe_control.pymol_control.command
prompt.command" class="py-name" href="#" onclick="return doclink('link-395', 'command', 'link-384');">command</a></tt><tt class="py-op">,</tt> <tt id="link-396" class="py-name"><a title="multi.memo" class="py-name" href="#" onclick="return doclink('link-396', 'memo', 'link-389');">memo</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L826"></a><tt class="py-lineno"> 826</tt>  <tt class="py-line"> </tt>
<a name="L827"></a><tt class="py-lineno"> 827</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.model_desc"></a><div id="Relax_disp.model_desc-def"><a name="L828"></a><tt class="py-lineno"> 828</tt> <a class="py-toggle" href="#" id="Relax_disp.model_desc-toggle" onclick="return toggle('Relax_disp.model_desc');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#model_desc">model_desc</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">model_info</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.model_desc-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.model_desc-expanded"><a name="L829"></a><tt class="py-lineno"> 829</tt>  <tt class="py-line">        <tt class="py-docstring">"""Return a description of the model.</tt> </tt>
<a name="L830"></a><tt class="py-lineno"> 830</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L831"></a><tt class="py-lineno"> 831</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword model_info:    The list of spins and spin IDs per cluster originating from model_loop().</tt> </tt>
<a name="L832"></a><tt class="py-lineno"> 832</tt>  <tt class="py-line"><tt class="py-docstring">        @type model_info:       list of SpinContainer instances, list of str</tt> </tt>
<a name="L833"></a><tt class="py-lineno"> 833</tt>  <tt class="py-line"><tt class="py-docstring">        @return:                The model description.</tt> </tt>
<a name="L834"></a><tt class="py-lineno"> 834</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:                 str</tt> </tt>
<a name="L835"></a><tt class="py-lineno"> 835</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L836"></a><tt class="py-lineno"> 836</tt>  <tt class="py-line"> </tt>
<a name="L837"></a><tt class="py-lineno"> 837</tt>  <tt class="py-line">        <tt class="py-comment"># The model loop is over the spin clusters, so return a description of the cluster.</tt> </tt>
<a name="L838"></a><tt class="py-lineno"> 838</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-string">"The spin cluster %s."</tt> <tt class="py-op">%</tt> <tt class="py-name">model_info</tt> </tt>
</div><a name="L839"></a><tt class="py-lineno"> 839</tt>  <tt class="py-line"> </tt>
<a name="L840"></a><tt class="py-lineno"> 840</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.model_loop"></a><div id="Relax_disp.model_loop-def"><a name="L841"></a><tt class="py-lineno"> 841</tt> <a class="py-toggle" href="#" id="Relax_disp.model_loop-toggle" onclick="return toggle('Relax_disp.model_loop');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#model_loop">model_loop</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.model_loop-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.model_loop-expanded"><a name="L842"></a><tt class="py-lineno"> 842</tt>  <tt class="py-line">        <tt class="py-docstring">"""Loop over the spin groupings for one model applied to multiple spins.</tt> </tt>
<a name="L843"></a><tt class="py-lineno"> 843</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L844"></a><tt class="py-lineno"> 844</tt>  <tt class="py-line"><tt class="py-docstring">        @return:    The list of spins per block will be yielded, as well as the list of spin IDs.</tt> </tt>
<a name="L845"></a><tt class="py-lineno"> 845</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:     tuple of list of SpinContainer instances and list of str</tt> </tt>
<a name="L846"></a><tt class="py-lineno"> 846</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L847"></a><tt class="py-lineno"> 847</tt>  <tt class="py-line"> </tt>
<a name="L848"></a><tt class="py-lineno"> 848</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over individual spins for the R2eff model.</tt> </tt>
<a name="L849"></a><tt class="py-lineno"> 849</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'model_type'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-397" class="py-name"><a title="specific_analyses.api_base.API_base.model_type
specific_analyses.hybrid.Hybrid.model_type
specific_analyses.model_free.api.Model_free.model_type" class="py-name" href="#" onclick="return doclink('link-397', 'model_type', 'link-106');">model_type</a></tt> <tt class="py-op">==</tt> <tt id="link-398" class="py-name"><a title="lib.dispersion.variables.MODEL_R2EFF" class="py-name" href="#" onclick="return doclink('link-398', 'MODEL_R2EFF', 'link-14');">MODEL_R2EFF</a></tt><tt class="py-op">:</tt> </tt>
<a name="L850"></a><tt class="py-lineno"> 850</tt>  <tt class="py-line">            <tt class="py-comment"># The spin loop.</tt> </tt>
<a name="L851"></a><tt class="py-lineno"> 851</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-399" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-399', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt id="link-400" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-400', 'spin_id', 'link-126');">spin_id</a></tt> <tt class="py-keyword">in</tt> <tt id="link-401" class="py-name"><a title="pipe_control.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-401', 'spin_loop', 'link-45');">spin_loop</a></tt><tt class="py-op">(</tt><tt class="py-name">return_id</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L852"></a><tt class="py-lineno"> 852</tt>  <tt class="py-line">                <tt class="py-comment"># Skip deselected spins</tt> </tt>
<a name="L853"></a><tt class="py-lineno"> 853</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-402" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-402', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-403" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-403', 'select', 'link-118');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L854"></a><tt class="py-lineno"> 854</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L855"></a><tt class="py-lineno"> 855</tt>  <tt class="py-line"> </tt>
<a name="L856"></a><tt class="py-lineno"> 856</tt>  <tt class="py-line">                <tt class="py-comment"># Yield the spin ID as a list.</tt> </tt>
<a name="L857"></a><tt class="py-lineno"> 857</tt>  <tt class="py-line">                <tt class="py-keyword">yield</tt> <tt class="py-op">[</tt><tt id="link-404" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-404', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">]</tt> </tt>
<a name="L858"></a><tt class="py-lineno"> 858</tt>  <tt class="py-line"> </tt>
<a name="L859"></a><tt class="py-lineno"> 859</tt>  <tt class="py-line">         <tt class="py-comment"># The cluster loop.</tt> </tt>
<a name="L860"></a><tt class="py-lineno"> 860</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L861"></a><tt class="py-lineno"> 861</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">spin_ids</tt> <tt class="py-keyword">in</tt> <tt id="link-405" class="py-name"><a title="specific_analyses.relax_disp.data.loop_cluster" class="py-name" href="#" onclick="return doclink('link-405', 'loop_cluster', 'link-74');">loop_cluster</a></tt><tt class="py-op">(</tt><tt class="py-name">skip_desel</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L862"></a><tt class="py-lineno"> 862</tt>  <tt class="py-line">                <tt class="py-keyword">yield</tt> <tt class="py-name">spin_ids</tt> </tt>
</div><a name="L863"></a><tt class="py-lineno"> 863</tt>  <tt class="py-line"> </tt>
<a name="L864"></a><tt class="py-lineno"> 864</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.model_statistics"></a><div id="Relax_disp.model_statistics-def"><a name="L865"></a><tt class="py-lineno"> 865</tt> <a class="py-toggle" href="#" id="Relax_disp.model_statistics-toggle" onclick="return toggle('Relax_disp.model_statistics');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#model_statistics">model_statistics</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">model_info</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">spin_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">global_stats</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.model_statistics-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.model_statistics-expanded"><a name="L866"></a><tt class="py-lineno"> 866</tt>  <tt class="py-line">        <tt class="py-docstring">"""Return the k, n, and chi2 model statistics.</tt> </tt>
<a name="L867"></a><tt class="py-lineno"> 867</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L868"></a><tt class="py-lineno"> 868</tt>  <tt class="py-line"><tt class="py-docstring">        k - number of parameters.</tt> </tt>
<a name="L869"></a><tt class="py-lineno"> 869</tt>  <tt class="py-line"><tt class="py-docstring">        n - number of data points.</tt> </tt>
<a name="L870"></a><tt class="py-lineno"> 870</tt>  <tt class="py-line"><tt class="py-docstring">        chi2 - the chi-squared value.</tt> </tt>
<a name="L871"></a><tt class="py-lineno"> 871</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L872"></a><tt class="py-lineno"> 872</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L873"></a><tt class="py-lineno"> 873</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword model_info:    The list of spins and spin IDs per cluster originating from model_loop().</tt> </tt>
<a name="L874"></a><tt class="py-lineno"> 874</tt>  <tt class="py-line"><tt class="py-docstring">        @type model_info:       list of SpinContainer instances, list of str</tt> </tt>
<a name="L875"></a><tt class="py-lineno"> 875</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword spin_id:       The spin ID string to override the model_info argument.  This is ignored in the N-state model.</tt> </tt>
<a name="L876"></a><tt class="py-lineno"> 876</tt>  <tt class="py-line"><tt class="py-docstring">        @type spin_id:          None or str</tt> </tt>
<a name="L877"></a><tt class="py-lineno"> 877</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword global_stats:  A parameter which determines if global or local statistics are returned.  For the N-state model, this argument is ignored.</tt> </tt>
<a name="L878"></a><tt class="py-lineno"> 878</tt>  <tt class="py-line"><tt class="py-docstring">        @type global_stats:     None or bool</tt> </tt>
<a name="L879"></a><tt class="py-lineno"> 879</tt>  <tt class="py-line"><tt class="py-docstring">        @return:                The optimisation statistics, in tuple format, of the number of parameters (k), the number of data points (n), and the chi-squared value (chi2).</tt> </tt>
<a name="L880"></a><tt class="py-lineno"> 880</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:                 tuple of (int, int, float)</tt> </tt>
<a name="L881"></a><tt class="py-lineno"> 881</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L882"></a><tt class="py-lineno"> 882</tt>  <tt class="py-line"> </tt>
<a name="L883"></a><tt class="py-lineno"> 883</tt>  <tt class="py-line">        <tt class="py-comment"># Get the spin containers (the spin ID overrides the model info).</tt> </tt>
<a name="L884"></a><tt class="py-lineno"> 884</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-406" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-406', 'spin_id', 'link-126');">spin_id</a></tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L885"></a><tt class="py-lineno"> 885</tt>  <tt class="py-line">            <tt class="py-name">spins</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt id="link-407" class="py-name"><a title="pipe_control.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-407', 'return_spin', 'link-44');">return_spin</a></tt><tt class="py-op">(</tt><tt id="link-408" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-408', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">)</tt><tt class="py-op">]</tt> </tt>
<a name="L886"></a><tt class="py-lineno"> 886</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L887"></a><tt class="py-lineno"> 887</tt>  <tt class="py-line">            <tt class="py-name">spins</tt> <tt class="py-op">=</tt> <tt id="link-409" class="py-name"><a title="specific_analyses.relax_disp.data.spin_ids_to_containers" class="py-name" href="#" onclick="return doclink('link-409', 'spin_ids_to_containers', 'link-80');">spin_ids_to_containers</a></tt><tt class="py-op">(</tt><tt class="py-name">model_info</tt><tt class="py-op">)</tt> </tt>
<a name="L888"></a><tt class="py-lineno"> 888</tt>  <tt class="py-line"> </tt>
<a name="L889"></a><tt class="py-lineno"> 889</tt>  <tt class="py-line">        <tt class="py-comment"># The number of parameters for the cluster.</tt> </tt>
<a name="L890"></a><tt class="py-lineno"> 890</tt>  <tt class="py-line">        <tt class="py-name">k</tt> <tt class="py-op">=</tt> <tt id="link-410" class="py-name"><a title="specific_analyses.frame_order.parameters.param_num
specific_analyses.n_state_model.parameters.param_num
specific_analyses.relax_disp.parameters.param_num" class="py-name" href="#" onclick="return doclink('link-410', 'param_num', 'link-101');">param_num</a></tt><tt class="py-op">(</tt><tt class="py-name">spins</tt><tt class="py-op">=</tt><tt class="py-name">spins</tt><tt class="py-op">)</tt> </tt>
<a name="L891"></a><tt class="py-lineno"> 891</tt>  <tt class="py-line"> </tt>
<a name="L892"></a><tt class="py-lineno"> 892</tt>  <tt class="py-line">        <tt class="py-comment"># The number of points from all spins.</tt> </tt>
<a name="L893"></a><tt class="py-lineno"> 893</tt>  <tt class="py-line">        <tt class="py-name">n</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L894"></a><tt class="py-lineno"> 894</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-411" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-411', 'spin', 'link-115');">spin</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">spins</tt><tt class="py-op">:</tt> </tt>
<a name="L895"></a><tt class="py-lineno"> 895</tt>  <tt class="py-line">            <tt class="py-comment"># Skip deselected spins.</tt> </tt>
<a name="L896"></a><tt class="py-lineno"> 896</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-412" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-412', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-413" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-413', 'select', 'link-118');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L897"></a><tt class="py-lineno"> 897</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L898"></a><tt class="py-lineno"> 898</tt>  <tt class="py-line"> </tt>
<a name="L899"></a><tt class="py-lineno"> 899</tt>  <tt class="py-line">            <tt class="py-name">n</tt> <tt class="py-op">+=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-414" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-414', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-415" class="py-name"><a title="lib.text.gui.r2eff" class="py-name" href="#" onclick="return doclink('link-415', 'r2eff', 'link-263');">r2eff</a></tt><tt class="py-op">)</tt> </tt>
<a name="L900"></a><tt class="py-lineno"> 900</tt>  <tt class="py-line"> </tt>
<a name="L901"></a><tt class="py-lineno"> 901</tt>  <tt class="py-line">        <tt class="py-comment"># Take the chi-squared from the first spin of the cluster (which has a value).</tt> </tt>
<a name="L902"></a><tt class="py-lineno"> 902</tt>  <tt class="py-line">        <tt id="link-416" class="py-name"><a title="target_functions.chi2
target_functions.chi2.chi2" class="py-name" href="#" onclick="return doclink('link-416', 'chi2', 'link-194');">chi2</a></tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L903"></a><tt class="py-lineno"> 903</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-417" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-417', 'spin', 'link-115');">spin</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">spins</tt><tt class="py-op">:</tt> </tt>
<a name="L904"></a><tt class="py-lineno"> 904</tt>  <tt class="py-line">            <tt class="py-comment"># Skip deselected spins.</tt> </tt>
<a name="L905"></a><tt class="py-lineno"> 905</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-418" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-418', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-419" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-419', 'select', 'link-118');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L906"></a><tt class="py-lineno"> 906</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L907"></a><tt class="py-lineno"> 907</tt>  <tt class="py-line"> </tt>
<a name="L908"></a><tt class="py-lineno"> 908</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-420" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-420', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'chi2'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L909"></a><tt class="py-lineno"> 909</tt>  <tt class="py-line">                <tt id="link-421" class="py-name"><a title="target_functions.chi2
target_functions.chi2.chi2" class="py-name" href="#" onclick="return doclink('link-421', 'chi2', 'link-194');">chi2</a></tt> <tt class="py-op">=</tt> <tt id="link-422" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-422', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-423" class="py-name"><a title="target_functions.chi2
target_functions.chi2.chi2" class="py-name" href="#" onclick="return doclink('link-423', 'chi2', 'link-194');">chi2</a></tt> </tt>
<a name="L910"></a><tt class="py-lineno"> 910</tt>  <tt class="py-line">                <tt class="py-keyword">break</tt> </tt>
<a name="L911"></a><tt class="py-lineno"> 911</tt>  <tt class="py-line"> </tt>
<a name="L912"></a><tt class="py-lineno"> 912</tt>  <tt class="py-line">        <tt class="py-comment"># Return the values.</tt> </tt>
<a name="L913"></a><tt class="py-lineno"> 913</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">k</tt><tt class="py-op">,</tt> <tt class="py-name">n</tt><tt class="py-op">,</tt> <tt id="link-424" class="py-name"><a title="target_functions.chi2
target_functions.chi2.chi2" class="py-name" href="#" onclick="return doclink('link-424', 'chi2', 'link-194');">chi2</a></tt> </tt>
</div><a name="L914"></a><tt class="py-lineno"> 914</tt>  <tt class="py-line"> </tt>
<a name="L915"></a><tt class="py-lineno"> 915</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.overfit_deselect"></a><div id="Relax_disp.overfit_deselect-def"><a name="L916"></a><tt class="py-lineno"> 916</tt> <a class="py-toggle" href="#" id="Relax_disp.overfit_deselect-toggle" onclick="return toggle('Relax_disp.overfit_deselect');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#overfit_deselect">overfit_deselect</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">data_check</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-param">verbose</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.overfit_deselect-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.overfit_deselect-expanded"><a name="L917"></a><tt class="py-lineno"> 917</tt>  <tt class="py-line">        <tt class="py-docstring">"""Deselect spins which have insufficient data to support minimisation.</tt> </tt>
<a name="L918"></a><tt class="py-lineno"> 918</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L919"></a><tt class="py-lineno"> 919</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword data_check:    A flag to signal if the presence of base data is to be checked for.</tt> </tt>
<a name="L920"></a><tt class="py-lineno"> 920</tt>  <tt class="py-line"><tt class="py-docstring">        @type data_check:       bool</tt> </tt>
<a name="L921"></a><tt class="py-lineno"> 921</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword verbose:       A flag which if True will allow printouts.</tt> </tt>
<a name="L922"></a><tt class="py-lineno"> 922</tt>  <tt class="py-line"><tt class="py-docstring">        @type verbose:          bool</tt> </tt>
<a name="L923"></a><tt class="py-lineno"> 923</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L924"></a><tt class="py-lineno"> 924</tt>  <tt class="py-line"> </tt>
<a name="L925"></a><tt class="py-lineno"> 925</tt>  <tt class="py-line">        <tt class="py-comment"># Test the sequence data exists and the model is setup.</tt> </tt>
<a name="L926"></a><tt class="py-lineno"> 926</tt>  <tt class="py-line">        <tt id="link-425" class="py-name"><a title="pipe_control.mol_res_spin.check_mol_res_spin_data" class="py-name" href="#" onclick="return doclink('link-425', 'check_mol_res_spin_data', 'link-42');">check_mol_res_spin_data</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L927"></a><tt class="py-lineno"> 927</tt>  <tt class="py-line">        <tt id="link-426" class="py-name"><a title="specific_analyses.relax_disp.checks.check_model_type" class="py-name" href="#" onclick="return doclink('link-426', 'check_model_type', 'link-64');">check_model_type</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L928"></a><tt class="py-lineno"> 928</tt>  <tt class="py-line"> </tt>
<a name="L929"></a><tt class="py-lineno"> 929</tt>  <tt class="py-line">        <tt class="py-comment"># 1H MMQ flag.</tt> </tt>
<a name="L930"></a><tt class="py-lineno"> 930</tt>  <tt class="py-line">        <tt class="py-name">proton_mmq_flag</tt> <tt class="py-op">=</tt> <tt id="link-427" class="py-name"><a title="specific_analyses.relax_disp.data.has_proton_mmq_cpmg" class="py-name" href="#" onclick="return doclink('link-427', 'has_proton_mmq_cpmg', 'link-73');">has_proton_mmq_cpmg</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L931"></a><tt class="py-lineno"> 931</tt>  <tt class="py-line"> </tt>
<a name="L932"></a><tt class="py-lineno"> 932</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over spin data.</tt> </tt>
<a name="L933"></a><tt class="py-lineno"> 933</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-428" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-428', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt id="link-429" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-429', 'spin_id', 'link-126');">spin_id</a></tt> <tt class="py-keyword">in</tt> <tt id="link-430" class="py-name"><a title="pipe_control.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-430', 'spin_loop', 'link-45');">spin_loop</a></tt><tt class="py-op">(</tt><tt class="py-name">return_id</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-name">skip_desel</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L934"></a><tt class="py-lineno"> 934</tt>  <tt class="py-line">            <tt class="py-comment"># Skip protons for MMQ data.</tt> </tt>
<a name="L935"></a><tt class="py-lineno"> 935</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-431" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-431', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-432" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-432', 'model', 'link-131');">model</a></tt> <tt class="py-keyword">in</tt> <tt id="link-433" class="py-name"><a title="lib.dispersion.variables.MODEL_LIST_MMQ" class="py-name" href="#" onclick="return doclink('link-433', 'MODEL_LIST_MMQ', 'link-13');">MODEL_LIST_MMQ</a></tt> <tt class="py-keyword">and</tt> <tt id="link-434" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-434', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">isotope</tt> <tt class="py-op">==</tt> <tt class="py-string">'1H'</tt><tt class="py-op">:</tt> </tt>
<a name="L936"></a><tt class="py-lineno"> 936</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L937"></a><tt class="py-lineno"> 937</tt>  <tt class="py-line"> </tt>
<a name="L938"></a><tt class="py-lineno"> 938</tt>  <tt class="py-line">            <tt class="py-comment"># Get the attached proton.</tt> </tt>
<a name="L939"></a><tt class="py-lineno"> 939</tt>  <tt class="py-line">            <tt class="py-name">proton</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L940"></a><tt class="py-lineno"> 940</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">proton_mmq_flag</tt><tt class="py-op">:</tt> </tt>
<a name="L941"></a><tt class="py-lineno"> 941</tt>  <tt class="py-line">                <tt class="py-comment"># Get all protons.</tt> </tt>
<a name="L942"></a><tt class="py-lineno"> 942</tt>  <tt class="py-line">                <tt class="py-name">proton_spins</tt> <tt class="py-op">=</tt> <tt id="link-435" class="py-name"><a title="pipe_control.sequence.return_attached_protons" class="py-name" href="#" onclick="return doclink('link-435', 'return_attached_protons', 'link-54');">return_attached_protons</a></tt><tt class="py-op">(</tt><tt id="link-436" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-436', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L943"></a><tt class="py-lineno"> 943</tt>  <tt class="py-line"> </tt>
<a name="L944"></a><tt class="py-lineno"> 944</tt>  <tt class="py-line">                <tt class="py-comment"># Only one allowed.</tt> </tt>
<a name="L945"></a><tt class="py-lineno"> 945</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">proton_spins</tt><tt class="py-op">)</tt> <tt class="py-op">&gt;</tt> <tt class="py-number">1</tt><tt class="py-op">:</tt> </tt>
<a name="L946"></a><tt class="py-lineno"> 946</tt>  <tt class="py-line">                    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Multiple protons attached to the spin '%s', but one one attached proton is supported for the MMQ-type models."</tt> <tt class="py-op">%</tt> <tt id="link-437" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-437', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L947"></a><tt class="py-lineno"> 947</tt>  <tt class="py-line">                    <tt id="link-438" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-438', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-439" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-439', 'select', 'link-118');">select</a></tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L948"></a><tt class="py-lineno"> 948</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L949"></a><tt class="py-lineno"> 949</tt>  <tt class="py-line"> </tt>
<a name="L950"></a><tt class="py-lineno"> 950</tt>  <tt class="py-line">                <tt class="py-comment"># Alias the single proton.</tt> </tt>
<a name="L951"></a><tt class="py-lineno"> 951</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">proton_spins</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L952"></a><tt class="py-lineno"> 952</tt>  <tt class="py-line">                    <tt class="py-name">proton</tt> <tt class="py-op">=</tt> <tt class="py-name">proton_spins</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L953"></a><tt class="py-lineno"> 953</tt>  <tt class="py-line"> </tt>
<a name="L954"></a><tt class="py-lineno"> 954</tt>  <tt class="py-line">            <tt class="py-comment"># Check if data exists.</tt> </tt>
<a name="L955"></a><tt class="py-lineno"> 955</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-440" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-440', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'r2eff'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">proton</tt><tt class="py-op">,</tt> <tt class="py-string">'r2eff'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L956"></a><tt class="py-lineno"> 956</tt>  <tt class="py-line">                <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"No R2eff data could be found, deselecting the '%s' spin."</tt> <tt class="py-op">%</tt> <tt id="link-441" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-441', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L957"></a><tt class="py-lineno"> 957</tt>  <tt class="py-line">                <tt id="link-442" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-442', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-443" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-443', 'select', 'link-118');">select</a></tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L958"></a><tt class="py-lineno"> 958</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
</div><a name="L959"></a><tt class="py-lineno"> 959</tt>  <tt class="py-line"> </tt>
<a name="L960"></a><tt class="py-lineno"> 960</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.print_model_title"></a><div id="Relax_disp.print_model_title-def"><a name="L961"></a><tt class="py-lineno"> 961</tt> <a class="py-toggle" href="#" id="Relax_disp.print_model_title-toggle" onclick="return toggle('Relax_disp.print_model_title');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#print_model_title">print_model_title</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">prefix</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">model_info</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.print_model_title-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.print_model_title-expanded"><a name="L962"></a><tt class="py-lineno"> 962</tt>  <tt class="py-line">        <tt class="py-docstring">"""Print out the model title.</tt> </tt>
<a name="L963"></a><tt class="py-lineno"> 963</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L964"></a><tt class="py-lineno"> 964</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword prefix:        The starting text of the title.  This should be printed out first, followed by the model information text.</tt> </tt>
<a name="L965"></a><tt class="py-lineno"> 965</tt>  <tt class="py-line"><tt class="py-docstring">        @type prefix:           str</tt> </tt>
<a name="L966"></a><tt class="py-lineno"> 966</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword model_info:    The list of spins and spin IDs per cluster originating from model_loop().</tt> </tt>
<a name="L967"></a><tt class="py-lineno"> 967</tt>  <tt class="py-line"><tt class="py-docstring">        @type model_info:       list of SpinContainer instances, list of str</tt> </tt>
<a name="L968"></a><tt class="py-lineno"> 968</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L969"></a><tt class="py-lineno"> 969</tt>  <tt class="py-line"> </tt>
<a name="L970"></a><tt class="py-lineno"> 970</tt>  <tt class="py-line">        <tt class="py-comment"># The printout.</tt> </tt>
<a name="L971"></a><tt class="py-lineno"> 971</tt>  <tt class="py-line">        <tt id="link-444" class="py-name"><a title="lib.text.sectioning.subsection" class="py-name" href="#" onclick="return doclink('link-444', 'subsection', 'link-27');">subsection</a></tt><tt class="py-op">(</tt><tt id="link-445" class="py-name" targets="Variable dep_check.file=dep_check-module.html#file,Module gui.input_elements.file=gui.input_elements.file-module.html"><a title="dep_check.file
gui.input_elements.file" class="py-name" href="#" onclick="return doclink('link-445', 'file', 'link-445');">file</a></tt><tt class="py-op">=</tt><tt class="py-name">sys</tt><tt class="py-op">.</tt><tt class="py-name">stdout</tt><tt class="py-op">,</tt> <tt id="link-446" class="py-name"><a title="lib.text
prompt.help._Helper.text
prompt.help._Helper_python.text
user_functions.molecule.text" class="py-name" href="#" onclick="return doclink('link-446', 'text', 'link-25');">text</a></tt><tt class="py-op">=</tt><tt class="py-name">prefix</tt><tt class="py-op">+</tt><tt class="py-string">"the spin block %s"</tt><tt class="py-op">%</tt><tt class="py-name">model_info</tt><tt class="py-op">,</tt> <tt class="py-name">prespace</tt><tt class="py-op">=</tt><tt class="py-number">2</tt><tt class="py-op">)</tt> </tt>
</div><a name="L972"></a><tt class="py-lineno"> 972</tt>  <tt class="py-line"> </tt>
<a name="L973"></a><tt class="py-lineno"> 973</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.return_data"></a><div id="Relax_disp.return_data-def"><a name="L974"></a><tt class="py-lineno"> 974</tt> <a class="py-toggle" href="#" id="Relax_disp.return_data-toggle" onclick="return toggle('Relax_disp.return_data');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#return_data">return_data</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">data_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.return_data-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.return_data-expanded"><a name="L975"></a><tt class="py-lineno"> 975</tt>  <tt class="py-line">        <tt class="py-docstring">"""Return the peak intensity data structure.</tt> </tt>
<a name="L976"></a><tt class="py-lineno"> 976</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L977"></a><tt class="py-lineno"> 977</tt>  <tt class="py-line"><tt class="py-docstring">        @param data_id: The spin ID string, as yielded by the base_data_loop() generator method.</tt> </tt>
<a name="L978"></a><tt class="py-lineno"> 978</tt>  <tt class="py-line"><tt class="py-docstring">        @type data_id:  str</tt> </tt>
<a name="L979"></a><tt class="py-lineno"> 979</tt>  <tt class="py-line"><tt class="py-docstring">        @return:        The peak intensity data structure.</tt> </tt>
<a name="L980"></a><tt class="py-lineno"> 980</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:         list of float</tt> </tt>
<a name="L981"></a><tt class="py-lineno"> 981</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L982"></a><tt class="py-lineno"> 982</tt>  <tt class="py-line"> </tt>
<a name="L983"></a><tt class="py-lineno"> 983</tt>  <tt class="py-line">        <tt class="py-comment"># The R2eff model.</tt> </tt>
<a name="L984"></a><tt class="py-lineno"> 984</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-447" class="py-name"><a title="specific_analyses.api_base.API_base.model_type
specific_analyses.hybrid.Hybrid.model_type
specific_analyses.model_free.api.Model_free.model_type" class="py-name" href="#" onclick="return doclink('link-447', 'model_type', 'link-106');">model_type</a></tt> <tt class="py-op">==</tt> <tt id="link-448" class="py-name"><a title="lib.dispersion.variables.MODEL_R2EFF" class="py-name" href="#" onclick="return doclink('link-448', 'MODEL_R2EFF', 'link-14');">MODEL_R2EFF</a></tt><tt class="py-op">:</tt> </tt>
<a name="L985"></a><tt class="py-lineno"> 985</tt>  <tt class="py-line">            <tt class="py-comment"># Unpack the data.</tt> </tt>
<a name="L986"></a><tt class="py-lineno"> 986</tt>  <tt class="py-line">            <tt id="link-449" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-449', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">exp_type</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt><tt class="py-op">,</tt> <tt id="link-450" class="py-name"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-450', 'offset', 'link-120');">offset</a></tt><tt class="py-op">,</tt> <tt class="py-name">point</tt> <tt class="py-op">=</tt> <tt class="py-name">data_id</tt> </tt>
<a name="L987"></a><tt class="py-lineno"> 987</tt>  <tt class="py-line"> </tt>
<a name="L988"></a><tt class="py-lineno"> 988</tt>  <tt class="py-line">            <tt class="py-comment"># Return the data.</tt> </tt>
<a name="L989"></a><tt class="py-lineno"> 989</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt id="link-451" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-451', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-452" class="py-name" targets="Module gui.wizards.peak_intensity=gui.wizards.peak_intensity-module.html"><a title="gui.wizards.peak_intensity" class="py-name" href="#" onclick="return doclink('link-452', 'peak_intensity', 'link-452');">peak_intensity</a></tt> </tt>
<a name="L990"></a><tt class="py-lineno"> 990</tt>  <tt class="py-line"> </tt>
<a name="L991"></a><tt class="py-lineno"> 991</tt>  <tt class="py-line">        <tt class="py-comment"># All other models.</tt> </tt>
<a name="L992"></a><tt class="py-lineno"> 992</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L993"></a><tt class="py-lineno"> 993</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-453" class="py-name"><a title="lib.errors.RelaxImplementError" class="py-name" href="#" onclick="return doclink('link-453', 'RelaxImplementError', 'link-19');">RelaxImplementError</a></tt> </tt>
</div><a name="L994"></a><tt class="py-lineno"> 994</tt>  <tt class="py-line"> </tt>
<a name="L995"></a><tt class="py-lineno"> 995</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.return_error"></a><div id="Relax_disp.return_error-def"><a name="L996"></a><tt class="py-lineno"> 996</tt> <a class="py-toggle" href="#" id="Relax_disp.return_error-toggle" onclick="return toggle('Relax_disp.return_error');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#return_error">return_error</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">data_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.return_error-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.return_error-expanded"><a name="L997"></a><tt class="py-lineno"> 997</tt>  <tt class="py-line">        <tt class="py-docstring">"""Return the standard deviation data structure.</tt> </tt>
<a name="L998"></a><tt class="py-lineno"> 998</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L999"></a><tt class="py-lineno"> 999</tt>  <tt class="py-line"><tt class="py-docstring">        @param data_id: The tuple of the spin container and the exponential curve identifying key, as yielded by the base_data_loop() generator method.</tt> </tt>
<a name="L1000"></a><tt class="py-lineno">1000</tt>  <tt class="py-line"><tt class="py-docstring">        @type data_id:  SpinContainer instance and float</tt> </tt>
<a name="L1001"></a><tt class="py-lineno">1001</tt>  <tt class="py-line"><tt class="py-docstring">        @return:        The standard deviation data structure.</tt> </tt>
<a name="L1002"></a><tt class="py-lineno">1002</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:         list of float</tt> </tt>
<a name="L1003"></a><tt class="py-lineno">1003</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L1004"></a><tt class="py-lineno">1004</tt>  <tt class="py-line"> </tt>
<a name="L1005"></a><tt class="py-lineno">1005</tt>  <tt class="py-line">        <tt class="py-comment"># The R2eff model.</tt> </tt>
<a name="L1006"></a><tt class="py-lineno">1006</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-454" class="py-name"><a title="specific_analyses.api_base.API_base.model_type
specific_analyses.hybrid.Hybrid.model_type
specific_analyses.model_free.api.Model_free.model_type" class="py-name" href="#" onclick="return doclink('link-454', 'model_type', 'link-106');">model_type</a></tt> <tt class="py-op">==</tt> <tt id="link-455" class="py-name"><a title="lib.dispersion.variables.MODEL_R2EFF" class="py-name" href="#" onclick="return doclink('link-455', 'MODEL_R2EFF', 'link-14');">MODEL_R2EFF</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1007"></a><tt class="py-lineno">1007</tt>  <tt class="py-line">            <tt class="py-comment"># Unpack the data.</tt> </tt>
<a name="L1008"></a><tt class="py-lineno">1008</tt>  <tt class="py-line">            <tt id="link-456" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-456', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">exp_type</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt><tt class="py-op">,</tt> <tt id="link-457" class="py-name"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-457', 'offset', 'link-120');">offset</a></tt><tt class="py-op">,</tt> <tt class="py-name">point</tt> <tt class="py-op">=</tt> <tt class="py-name">data_id</tt> </tt>
<a name="L1009"></a><tt class="py-lineno">1009</tt>  <tt class="py-line"> </tt>
<a name="L1010"></a><tt class="py-lineno">1010</tt>  <tt class="py-line">            <tt class="py-comment"># Generate the data structure to return.</tt> </tt>
<a name="L1011"></a><tt class="py-lineno">1011</tt>  <tt class="py-line">            <tt id="link-458" class="py-name"><a title="gui.errors
lib.errors
minfx.errors" class="py-name" href="#" onclick="return doclink('link-458', 'errors', 'link-17');">errors</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L1012"></a><tt class="py-lineno">1012</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">time</tt> <tt class="py-keyword">in</tt> <tt id="link-459" class="py-name"><a title="specific_analyses.relax_disp.data.loop_time" class="py-name" href="#" onclick="return doclink('link-459', 'loop_time', 'link-77');">loop_time</a></tt><tt class="py-op">(</tt><tt class="py-name">exp_type</tt><tt class="py-op">=</tt><tt class="py-name">exp_type</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt><tt class="py-op">=</tt><tt class="py-name">frq</tt><tt class="py-op">,</tt> <tt id="link-460" class="py-name"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-460', 'offset', 'link-120');">offset</a></tt><tt class="py-op">=</tt><tt id="link-461" class="py-name"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-461', 'offset', 'link-120');">offset</a></tt><tt class="py-op">,</tt> <tt class="py-name">point</tt><tt class="py-op">=</tt><tt class="py-name">point</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1013"></a><tt class="py-lineno">1013</tt>  <tt class="py-line">                <tt id="link-462" class="py-name"><a title="gui.errors
lib.errors
minfx.errors" class="py-name" href="#" onclick="return doclink('link-462', 'errors', 'link-17');">errors</a></tt><tt class="py-op">.</tt><tt id="link-463" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-463', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt id="link-464" class="py-name"><a title="specific_analyses.relax_disp.data.average_intensity" class="py-name" href="#" onclick="return doclink('link-464', 'average_intensity', 'link-68');">average_intensity</a></tt><tt class="py-op">(</tt><tt id="link-465" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-465', 'spin', 'link-115');">spin</a></tt><tt class="py-op">=</tt><tt id="link-466" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-466', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">exp_type</tt><tt class="py-op">=</tt><tt class="py-name">exp_type</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt><tt class="py-op">=</tt><tt class="py-name">frq</tt><tt class="py-op">,</tt> <tt id="link-467" class="py-name"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-467', 'offset', 'link-120');">offset</a></tt><tt class="py-op">=</tt><tt id="link-468" class="py-name"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-468', 'offset', 'link-120');">offset</a></tt><tt class="py-op">,</tt> <tt class="py-name">point</tt><tt class="py-op">=</tt><tt class="py-name">point</tt><tt class="py-op">,</tt> <tt class="py-name">time</tt><tt class="py-op">=</tt><tt class="py-name">time</tt><tt class="py-op">,</tt> <tt id="link-469" class="py-name" targets="Method relax.RelaxParser.error()=relax.RelaxParser-class.html#error"><a title="relax.RelaxParser.error" class="py-name" href="#" onclick="return doclink('link-469', 'error', 'link-469');">error</a></tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1014"></a><tt class="py-lineno">1014</tt>  <tt class="py-line"> </tt>
<a name="L1015"></a><tt class="py-lineno">1015</tt>  <tt class="py-line">        <tt class="py-comment"># All other models.</tt> </tt>
<a name="L1016"></a><tt class="py-lineno">1016</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1017"></a><tt class="py-lineno">1017</tt>  <tt class="py-line">            <tt class="py-comment"># Unpack the data.</tt> </tt>
<a name="L1018"></a><tt class="py-lineno">1018</tt>  <tt class="py-line">            <tt id="link-470" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-470', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt id="link-471" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-471', 'spin_id', 'link-126');">spin_id</a></tt> <tt class="py-op">=</tt> <tt class="py-name">data_id</tt> </tt>
<a name="L1019"></a><tt class="py-lineno">1019</tt>  <tt class="py-line"> </tt>
<a name="L1020"></a><tt class="py-lineno">1020</tt>  <tt class="py-line">            <tt class="py-comment"># 1H MMQ flag.</tt> </tt>
<a name="L1021"></a><tt class="py-lineno">1021</tt>  <tt class="py-line">            <tt class="py-name">proton_mmq_flag</tt> <tt class="py-op">=</tt> <tt id="link-472" class="py-name"><a title="specific_analyses.relax_disp.data.has_proton_mmq_cpmg" class="py-name" href="#" onclick="return doclink('link-472', 'has_proton_mmq_cpmg', 'link-73');">has_proton_mmq_cpmg</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1022"></a><tt class="py-lineno">1022</tt>  <tt class="py-line"> </tt>
<a name="L1023"></a><tt class="py-lineno">1023</tt>  <tt class="py-line">            <tt class="py-comment"># Get the attached proton.</tt> </tt>
<a name="L1024"></a><tt class="py-lineno">1024</tt>  <tt class="py-line">            <tt class="py-name">proton</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L1025"></a><tt class="py-lineno">1025</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">proton_mmq_flag</tt><tt class="py-op">:</tt> </tt>
<a name="L1026"></a><tt class="py-lineno">1026</tt>  <tt class="py-line">                <tt class="py-name">proton</tt> <tt class="py-op">=</tt> <tt id="link-473" class="py-name"><a title="pipe_control.sequence.return_attached_protons" class="py-name" href="#" onclick="return doclink('link-473', 'return_attached_protons', 'link-54');">return_attached_protons</a></tt><tt class="py-op">(</tt><tt id="link-474" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-474', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">)</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L1027"></a><tt class="py-lineno">1027</tt>  <tt class="py-line"> </tt>
<a name="L1028"></a><tt class="py-lineno">1028</tt>  <tt class="py-line">            <tt class="py-comment"># The errors.</tt> </tt>
<a name="L1029"></a><tt class="py-lineno">1029</tt>  <tt class="py-line">            <tt class="py-name">r2eff_err</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L1030"></a><tt class="py-lineno">1030</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-475" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-475', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'r2eff_err'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1031"></a><tt class="py-lineno">1031</tt>  <tt class="py-line">                <tt class="py-name">r2eff_err</tt><tt class="py-op">.</tt><tt id="link-476" class="py-name" targets="Method gui.spin_viewer.tree.Mol_res_spin_tree.update()=gui.spin_viewer.tree.Mol_res_spin_tree-class.html#update,Method minfx.base_classes.Conjugate_gradient.update()=minfx.base_classes.Conjugate_gradient-class.html#update,Method minfx.base_classes.Min.update()=minfx.base_classes.Min-class.html#update,Method minfx.cauchy_point.Cauchy_point.update()=minfx.cauchy_point.Cauchy_point-class.html#update,Method minfx.coordinate_descent.Coordinate_descent.update()=minfx.coordinate_descent.Coordinate_descent-class.html#update,Method minfx.dogleg.Dogleg.update()=minfx.dogleg.Dogleg-class.html#update,Method minfx.exact_trust_region.Exact_trust_region.update()=minfx.exact_trust_region.Exact_trust_region-class.html#update,Method minfx.levenberg_marquardt.Levenberg_marquardt.update()=minfx.levenberg_marquardt.Levenberg_marquardt-class.html#update,Function minfx.line_search.more_thuente.update()=minfx.line_search.more_thuente-module.html#update,Method minfx.ncg.Ncg.update()=minfx.ncg.Ncg-class.html#update,Method minfx.simplex.Simplex.update()=minfx.simplex.Simplex-class.html#update,Method minfx.steepest_descent.Steepest_descent.update()=minfx.steepest_descent.Steepest_descent-class.html#update,Method minfx.steihaug_cg.Steihaug.update()=minfx.steihaug_cg.Steihaug-class.html#update"><a title="gui.spin_viewer.tree.Mol_res_spin_tree.update
minfx.base_classes.Conjugate_gradient.update
minfx.base_classes.Min.update
minfx.cauchy_point.Cauchy_point.update
minfx.coordinate_descent.Coordinate_descent.update
minfx.dogleg.Dogleg.update
minfx.exact_trust_region.Exact_trust_region.update
minfx.levenberg_marquardt.Levenberg_marquardt.update
minfx.line_search.more_thuente.update
minfx.ncg.Ncg.update
minfx.simplex.Simplex.update
minfx.steepest_descent.Steepest_descent.update
minfx.steihaug_cg.Steihaug.update" class="py-name" href="#" onclick="return doclink('link-476', 'update', 'link-476');">update</a></tt><tt class="py-op">(</tt><tt id="link-477" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-477', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">r2eff_err</tt><tt class="py-op">)</tt> </tt>
<a name="L1032"></a><tt class="py-lineno">1032</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">proton</tt><tt class="py-op">,</tt> <tt class="py-string">'r2eff_err'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1033"></a><tt class="py-lineno">1033</tt>  <tt class="py-line">                <tt class="py-name">r2eff_err</tt><tt class="py-op">.</tt><tt id="link-478" class="py-name"><a title="gui.spin_viewer.tree.Mol_res_spin_tree.update
minfx.base_classes.Conjugate_gradient.update
minfx.base_classes.Min.update
minfx.cauchy_point.Cauchy_point.update
minfx.coordinate_descent.Coordinate_descent.update
minfx.dogleg.Dogleg.update
minfx.exact_trust_region.Exact_trust_region.update
minfx.levenberg_marquardt.Levenberg_marquardt.update
minfx.line_search.more_thuente.update
minfx.ncg.Ncg.update
minfx.simplex.Simplex.update
minfx.steepest_descent.Steepest_descent.update
minfx.steihaug_cg.Steihaug.update" class="py-name" href="#" onclick="return doclink('link-478', 'update', 'link-476');">update</a></tt><tt class="py-op">(</tt><tt class="py-name">proton</tt><tt class="py-op">.</tt><tt class="py-name">r2eff_err</tt><tt class="py-op">)</tt> </tt>
<a name="L1034"></a><tt class="py-lineno">1034</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">r2eff_err</tt> </tt>
<a name="L1035"></a><tt class="py-lineno">1035</tt>  <tt class="py-line"> </tt>
<a name="L1036"></a><tt class="py-lineno">1036</tt>  <tt class="py-line">        <tt class="py-comment"># Return the error list.</tt> </tt>
<a name="L1037"></a><tt class="py-lineno">1037</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt id="link-479" class="py-name"><a title="gui.errors
lib.errors
minfx.errors" class="py-name" href="#" onclick="return doclink('link-479', 'errors', 'link-17');">errors</a></tt> </tt>
</div><a name="L1038"></a><tt class="py-lineno">1038</tt>  <tt class="py-line"> </tt>
<a name="L1039"></a><tt class="py-lineno">1039</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.return_value"></a><div id="Relax_disp.return_value-def"><a name="L1040"></a><tt class="py-lineno">1040</tt> <a class="py-toggle" href="#" id="Relax_disp.return_value-toggle" onclick="return toggle('Relax_disp.return_value');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#return_value">return_value</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">spin</tt><tt class="py-op">,</tt> <tt class="py-param">param</tt><tt class="py-op">,</tt> <tt class="py-param">sim</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">bc</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.return_value-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.return_value-expanded"><a name="L1041"></a><tt class="py-lineno">1041</tt>  <tt class="py-line">        <tt class="py-docstring">"""Return the value and error corresponding to the parameter.</tt> </tt>
<a name="L1042"></a><tt class="py-lineno">1042</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1043"></a><tt class="py-lineno">1043</tt>  <tt class="py-line"><tt class="py-docstring">        If sim is set to an integer, return the value of the simulation and None.</tt> </tt>
<a name="L1044"></a><tt class="py-lineno">1044</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1045"></a><tt class="py-lineno">1045</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1046"></a><tt class="py-lineno">1046</tt>  <tt class="py-line"><tt class="py-docstring">        @param spin:    The SpinContainer object.</tt> </tt>
<a name="L1047"></a><tt class="py-lineno">1047</tt>  <tt class="py-line"><tt class="py-docstring">        @type spin:     SpinContainer</tt> </tt>
<a name="L1048"></a><tt class="py-lineno">1048</tt>  <tt class="py-line"><tt class="py-docstring">        @param param:   The name of the parameter to return values for.</tt> </tt>
<a name="L1049"></a><tt class="py-lineno">1049</tt>  <tt class="py-line"><tt class="py-docstring">        @type param:    str</tt> </tt>
<a name="L1050"></a><tt class="py-lineno">1050</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword sim:   The Monte Carlo simulation index.</tt> </tt>
<a name="L1051"></a><tt class="py-lineno">1051</tt>  <tt class="py-line"><tt class="py-docstring">        @type sim:      None or int</tt> </tt>
<a name="L1052"></a><tt class="py-lineno">1052</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword bc:    The back-calculated data flag.  If True, then the back-calculated data will be returned rather than the actual data.</tt> </tt>
<a name="L1053"></a><tt class="py-lineno">1053</tt>  <tt class="py-line"><tt class="py-docstring">        @type bc:       bool</tt> </tt>
<a name="L1054"></a><tt class="py-lineno">1054</tt>  <tt class="py-line"><tt class="py-docstring">        @return:        The value and error corresponding to</tt> </tt>
<a name="L1055"></a><tt class="py-lineno">1055</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:         tuple of length 2 of floats or None</tt> </tt>
<a name="L1056"></a><tt class="py-lineno">1056</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L1057"></a><tt class="py-lineno">1057</tt>  <tt class="py-line"> </tt>
<a name="L1058"></a><tt class="py-lineno">1058</tt>  <tt class="py-line">        <tt class="py-comment"># Define list of special parameters.</tt> </tt>
<a name="L1059"></a><tt class="py-lineno">1059</tt>  <tt class="py-line">        <tt class="py-name">special_parameters</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-string">'theta'</tt><tt class="py-op">,</tt> <tt class="py-string">'w_eff'</tt><tt class="py-op">]</tt> </tt>
<a name="L1060"></a><tt class="py-lineno">1060</tt>  <tt class="py-line"> </tt>
<a name="L1061"></a><tt class="py-lineno">1061</tt>  <tt class="py-line">        <tt class="py-comment"># Use api_common function for paramets not defined in special_parameters.</tt> </tt>
<a name="L1062"></a><tt class="py-lineno">1062</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">param</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt class="py-name">special_parameters</tt><tt class="py-op">:</tt> </tt>
<a name="L1063"></a><tt class="py-lineno">1063</tt>  <tt class="py-line">            <tt class="py-name">returnval</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-480" class="py-name" targets="Method specific_analyses.api_common.API_common._return_value_general()=specific_analyses.api_common.API_common-class.html#_return_value_general"><a title="specific_analyses.api_common.API_common._return_value_general" class="py-name" href="#" onclick="return doclink('link-480', '_return_value_general', 'link-480');">_return_value_general</a></tt><tt class="py-op">(</tt><tt id="link-481" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-481', 'spin', 'link-115');">spin</a></tt><tt class="py-op">=</tt><tt id="link-482" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-482', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">param</tt><tt class="py-op">=</tt><tt class="py-name">param</tt><tt class="py-op">,</tt> <tt class="py-name">sim</tt><tt class="py-op">=</tt><tt class="py-name">sim</tt><tt class="py-op">,</tt> <tt class="py-name">bc</tt><tt class="py-op">=</tt><tt class="py-name">bc</tt><tt class="py-op">)</tt> </tt>
<a name="L1064"></a><tt class="py-lineno">1064</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">returnval</tt> </tt>
<a name="L1065"></a><tt class="py-lineno">1065</tt>  <tt class="py-line"> </tt>
<a name="L1066"></a><tt class="py-lineno">1066</tt>  <tt class="py-line">        <tt class="py-comment"># If parameter in special_parameters, the do the following.</tt> </tt>
<a name="L1067"></a><tt class="py-lineno">1067</tt>  <tt class="py-line"> </tt>
<a name="L1068"></a><tt class="py-lineno">1068</tt>  <tt class="py-line">        <tt class="py-comment"># Initial values.</tt> </tt>
<a name="L1069"></a><tt class="py-lineno">1069</tt>  <tt class="py-line">        <tt id="link-483" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-483', 'value', 'link-309');">value</a></tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L1070"></a><tt class="py-lineno">1070</tt>  <tt class="py-line">        <tt id="link-484" class="py-name"><a title="relax.RelaxParser.error" class="py-name" href="#" onclick="return doclink('link-484', 'error', 'link-469');">error</a></tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L1071"></a><tt class="py-lineno">1071</tt>  <tt class="py-line"> </tt>
<a name="L1072"></a><tt class="py-lineno">1072</tt>  <tt class="py-line">        <tt class="py-comment"># Return the data</tt> </tt>
<a name="L1073"></a><tt class="py-lineno">1073</tt>  <tt class="py-line">        <tt class="py-name">theta_spin_dic</tt><tt class="py-op">,</tt> <tt class="py-name">Domega_spin_dic</tt><tt class="py-op">,</tt> <tt class="py-name">w_eff_spin_dic</tt><tt class="py-op">,</tt> <tt class="py-name">dic_key_list</tt> <tt class="py-op">=</tt> <tt id="link-485" class="py-name"><a title="specific_analyses.relax_disp.data.calc_rotating_frame_params" class="py-name" href="#" onclick="return doclink('link-485', 'calc_rotating_frame_params', 'link-69');">calc_rotating_frame_params</a></tt><tt class="py-op">(</tt><tt id="link-486" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-486', 'spin', 'link-115');">spin</a></tt><tt class="py-op">=</tt><tt id="link-487" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-487', 'spin', 'link-115');">spin</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1074"></a><tt class="py-lineno">1074</tt>  <tt class="py-line"> </tt>
<a name="L1075"></a><tt class="py-lineno">1075</tt>  <tt class="py-line">        <tt class="py-comment"># Return for parameter theta</tt> </tt>
<a name="L1076"></a><tt class="py-lineno">1076</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">param</tt> <tt class="py-op">==</tt> <tt class="py-string">"theta"</tt><tt class="py-op">:</tt> </tt>
<a name="L1077"></a><tt class="py-lineno">1077</tt>  <tt class="py-line">            <tt id="link-488" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-488', 'value', 'link-309');">value</a></tt> <tt class="py-op">=</tt> <tt class="py-name">theta_spin_dic</tt> </tt>
<a name="L1078"></a><tt class="py-lineno">1078</tt>  <tt class="py-line"> </tt>
<a name="L1079"></a><tt class="py-lineno">1079</tt>  <tt class="py-line">        <tt class="py-comment"># Return for parameter theta</tt> </tt>
<a name="L1080"></a><tt class="py-lineno">1080</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">param</tt> <tt class="py-op">==</tt> <tt class="py-string">"w_eff"</tt><tt class="py-op">:</tt> </tt>
<a name="L1081"></a><tt class="py-lineno">1081</tt>  <tt class="py-line">            <tt id="link-489" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-489', 'value', 'link-309');">value</a></tt> <tt class="py-op">=</tt> <tt class="py-name">w_eff_spin_dic</tt> </tt>
<a name="L1082"></a><tt class="py-lineno">1082</tt>  <tt class="py-line"> </tt>
<a name="L1083"></a><tt class="py-lineno">1083</tt>  <tt class="py-line">        <tt class="py-comment"># Return the data.</tt> </tt>
<a name="L1084"></a><tt class="py-lineno">1084</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt id="link-490" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-490', 'value', 'link-309');">value</a></tt><tt class="py-op">,</tt> <tt id="link-491" class="py-name"><a title="relax.RelaxParser.error" class="py-name" href="#" onclick="return doclink('link-491', 'error', 'link-469');">error</a></tt> </tt>
</div><a name="L1085"></a><tt class="py-lineno">1085</tt>  <tt class="py-line"> </tt>
<a name="L1086"></a><tt class="py-lineno">1086</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.set_error"></a><div id="Relax_disp.set_error-def"><a name="L1087"></a><tt class="py-lineno">1087</tt> <a class="py-toggle" href="#" id="Relax_disp.set_error-toggle" onclick="return toggle('Relax_disp.set_error');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#set_error">set_error</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">index</tt><tt class="py-op">,</tt> <tt class="py-param">error</tt><tt class="py-op">,</tt> <tt class="py-param">model_info</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.set_error-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.set_error-expanded"><a name="L1088"></a><tt class="py-lineno">1088</tt>  <tt class="py-line">        <tt class="py-docstring">"""Set the parameter errors.</tt> </tt>
<a name="L1089"></a><tt class="py-lineno">1089</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1090"></a><tt class="py-lineno">1090</tt>  <tt class="py-line"><tt class="py-docstring">        @param index:           The index of the parameter to set the errors for.</tt> </tt>
<a name="L1091"></a><tt class="py-lineno">1091</tt>  <tt class="py-line"><tt class="py-docstring">        @type index:            int</tt> </tt>
<a name="L1092"></a><tt class="py-lineno">1092</tt>  <tt class="py-line"><tt class="py-docstring">        @param error:           The error value.</tt> </tt>
<a name="L1093"></a><tt class="py-lineno">1093</tt>  <tt class="py-line"><tt class="py-docstring">        @type error:            float</tt> </tt>
<a name="L1094"></a><tt class="py-lineno">1094</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword model_info:    The list of spins and spin IDs per cluster originating from model_loop().</tt> </tt>
<a name="L1095"></a><tt class="py-lineno">1095</tt>  <tt class="py-line"><tt class="py-docstring">        @type model_info:       list of SpinContainer instances, list of str</tt> </tt>
<a name="L1096"></a><tt class="py-lineno">1096</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L1097"></a><tt class="py-lineno">1097</tt>  <tt class="py-line"> </tt>
<a name="L1098"></a><tt class="py-lineno">1098</tt>  <tt class="py-line">        <tt class="py-comment"># Unpack the data.</tt> </tt>
<a name="L1099"></a><tt class="py-lineno">1099</tt>  <tt class="py-line">        <tt class="py-name">spin_ids</tt> <tt class="py-op">=</tt> <tt class="py-name">model_info</tt> </tt>
<a name="L1100"></a><tt class="py-lineno">1100</tt>  <tt class="py-line">        <tt class="py-name">spins</tt> <tt class="py-op">=</tt> <tt id="link-492" class="py-name"><a title="specific_analyses.relax_disp.data.spin_ids_to_containers" class="py-name" href="#" onclick="return doclink('link-492', 'spin_ids_to_containers', 'link-80');">spin_ids_to_containers</a></tt><tt class="py-op">(</tt><tt class="py-name">spin_ids</tt><tt class="py-op">)</tt> </tt>
<a name="L1101"></a><tt class="py-lineno">1101</tt>  <tt class="py-line"> </tt>
<a name="L1102"></a><tt class="py-lineno">1102</tt>  <tt class="py-line">        <tt class="py-comment"># The number of parameters.</tt> </tt>
<a name="L1103"></a><tt class="py-lineno">1103</tt>  <tt class="py-line">        <tt class="py-name">total_param_num</tt> <tt class="py-op">=</tt> <tt id="link-493" class="py-name"><a title="specific_analyses.frame_order.parameters.param_num
specific_analyses.n_state_model.parameters.param_num
specific_analyses.relax_disp.parameters.param_num" class="py-name" href="#" onclick="return doclink('link-493', 'param_num', 'link-101');">param_num</a></tt><tt class="py-op">(</tt><tt class="py-name">spins</tt><tt class="py-op">=</tt><tt class="py-name">spins</tt><tt class="py-op">)</tt> </tt>
<a name="L1104"></a><tt class="py-lineno">1104</tt>  <tt class="py-line"> </tt>
<a name="L1105"></a><tt class="py-lineno">1105</tt>  <tt class="py-line">        <tt class="py-comment"># No more model parameters.</tt> </tt>
<a name="L1106"></a><tt class="py-lineno">1106</tt>  <tt class="py-line">        <tt class="py-name">model_param</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L1107"></a><tt class="py-lineno">1107</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">index</tt> <tt class="py-op">&gt;=</tt> <tt class="py-name">total_param_num</tt><tt class="py-op">:</tt> </tt>
<a name="L1108"></a><tt class="py-lineno">1108</tt>  <tt class="py-line">            <tt class="py-name">model_param</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L1109"></a><tt class="py-lineno">1109</tt>  <tt class="py-line"> </tt>
<a name="L1110"></a><tt class="py-lineno">1110</tt>  <tt class="py-line">        <tt class="py-comment"># The auxiliary cluster parameters.</tt> </tt>
<a name="L1111"></a><tt class="py-lineno">1111</tt>  <tt class="py-line">        <tt class="py-name">aux_params</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L1112"></a><tt class="py-lineno">1112</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-string">'pA'</tt> <tt class="py-keyword">in</tt> <tt class="py-name">spins</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-494" class="py-name" targets="Variable gui.analyses.auto_model_free.Local_tm_list.params=gui.analyses.auto_model_free.Local_tm_list-class.html#params,Variable gui.analyses.auto_model_free.Mf_list.params=gui.analyses.auto_model_free.Mf_list-class.html#params,Variable gui.analyses.auto_relax_disp.Disp_model_list.params=gui.analyses.auto_relax_disp.Disp_model_list-class.html#params,Variable gui.analyses.elements.model_list.Model_list.params=gui.analyses.elements.model_list.Model_list-class.html#params"><a title="gui.analyses.auto_model_free.Local_tm_list.params
gui.analyses.auto_model_free.Mf_list.params
gui.analyses.auto_relax_disp.Disp_model_list.params
gui.analyses.elements.model_list.Model_list.params" class="py-name" href="#" onclick="return doclink('link-494', 'params', 'link-494');">params</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1113"></a><tt class="py-lineno">1113</tt>  <tt class="py-line">            <tt class="py-name">aux_params</tt><tt class="py-op">.</tt><tt id="link-495" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-495', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt class="py-string">'pB'</tt><tt class="py-op">)</tt> </tt>
<a name="L1114"></a><tt class="py-lineno">1114</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-string">'pB'</tt> <tt class="py-keyword">in</tt> <tt class="py-name">spins</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-496" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.params
gui.analyses.auto_model_free.Mf_list.params
gui.analyses.auto_relax_disp.Disp_model_list.params
gui.analyses.elements.model_list.Model_list.params" class="py-name" href="#" onclick="return doclink('link-496', 'params', 'link-494');">params</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1115"></a><tt class="py-lineno">1115</tt>  <tt class="py-line">            <tt class="py-name">aux_params</tt><tt class="py-op">.</tt><tt id="link-497" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-497', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt class="py-string">'pA'</tt><tt class="py-op">)</tt> </tt>
<a name="L1116"></a><tt class="py-lineno">1116</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-string">'kex'</tt> <tt class="py-keyword">in</tt> <tt class="py-name">spins</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-498" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.params
gui.analyses.auto_model_free.Mf_list.params
gui.analyses.auto_relax_disp.Disp_model_list.params
gui.analyses.elements.model_list.Model_list.params" class="py-name" href="#" onclick="return doclink('link-498', 'params', 'link-494');">params</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1117"></a><tt class="py-lineno">1117</tt>  <tt class="py-line">            <tt class="py-name">aux_params</tt><tt class="py-op">.</tt><tt id="link-499" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-499', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt class="py-string">'tex'</tt><tt class="py-op">)</tt> </tt>
<a name="L1118"></a><tt class="py-lineno">1118</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-string">'tex'</tt> <tt class="py-keyword">in</tt> <tt class="py-name">spins</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-500" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.params
gui.analyses.auto_model_free.Mf_list.params
gui.analyses.auto_relax_disp.Disp_model_list.params
gui.analyses.elements.model_list.Model_list.params" class="py-name" href="#" onclick="return doclink('link-500', 'params', 'link-494');">params</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1119"></a><tt class="py-lineno">1119</tt>  <tt class="py-line">            <tt class="py-name">aux_params</tt><tt class="py-op">.</tt><tt id="link-501" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-501', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt class="py-string">'kex'</tt><tt class="py-op">)</tt> </tt>
<a name="L1120"></a><tt class="py-lineno">1120</tt>  <tt class="py-line"> </tt>
<a name="L1121"></a><tt class="py-lineno">1121</tt>  <tt class="py-line">        <tt class="py-comment"># Convert the parameter index.</tt> </tt>
<a name="L1122"></a><tt class="py-lineno">1122</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">model_param</tt><tt class="py-op">:</tt> </tt>
<a name="L1123"></a><tt class="py-lineno">1123</tt>  <tt class="py-line">            <tt class="py-name">param_name</tt><tt class="py-op">,</tt> <tt class="py-name">si</tt><tt class="py-op">,</tt> <tt class="py-name">mi</tt> <tt class="py-op">=</tt> <tt id="link-502" class="py-name"><a title="specific_analyses.relax_disp.parameters.param_index_to_param_info" class="py-name" href="#" onclick="return doclink('link-502', 'param_index_to_param_info', 'link-100');">param_index_to_param_info</a></tt><tt class="py-op">(</tt><tt class="py-name">index</tt><tt class="py-op">=</tt><tt class="py-name">index</tt><tt class="py-op">,</tt> <tt class="py-name">spins</tt><tt class="py-op">=</tt><tt class="py-name">spins</tt><tt class="py-op">)</tt> </tt>
<a name="L1124"></a><tt class="py-lineno">1124</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1125"></a><tt class="py-lineno">1125</tt>  <tt class="py-line">            <tt class="py-name">param_name</tt> <tt class="py-op">=</tt> <tt class="py-name">aux_params</tt><tt class="py-op">[</tt><tt class="py-name">index</tt> <tt class="py-op">-</tt> <tt class="py-name">total_param_num</tt><tt class="py-op">]</tt> </tt>
<a name="L1126"></a><tt class="py-lineno">1126</tt>  <tt class="py-line">            <tt class="py-name">si</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L1127"></a><tt class="py-lineno">1127</tt>  <tt class="py-line">            <tt class="py-name">mi</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L1128"></a><tt class="py-lineno">1128</tt>  <tt class="py-line"> </tt>
<a name="L1129"></a><tt class="py-lineno">1129</tt>  <tt class="py-line">        <tt class="py-comment"># The parameter error name.</tt> </tt>
<a name="L1130"></a><tt class="py-lineno">1130</tt>  <tt class="py-line">        <tt class="py-name">err_name</tt> <tt class="py-op">=</tt> <tt class="py-name">param_name</tt> <tt class="py-op">+</tt> <tt class="py-string">"_err"</tt> </tt>
<a name="L1131"></a><tt class="py-lineno">1131</tt>  <tt class="py-line"> </tt>
<a name="L1132"></a><tt class="py-lineno">1132</tt>  <tt class="py-line">        <tt class="py-comment"># The exponential curve parameters.</tt> </tt>
<a name="L1133"></a><tt class="py-lineno">1133</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">param_name</tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt class="py-string">'r2eff'</tt><tt class="py-op">,</tt> <tt class="py-string">'i0'</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L1134"></a><tt class="py-lineno">1134</tt>  <tt class="py-line">            <tt class="py-comment"># Initialise if needed.</tt> </tt>
<a name="L1135"></a><tt class="py-lineno">1135</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">spins</tt><tt class="py-op">[</tt><tt class="py-name">si</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">err_name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1136"></a><tt class="py-lineno">1136</tt>  <tt class="py-line">                <tt class="py-name">setattr</tt><tt class="py-op">(</tt><tt class="py-name">spins</tt><tt class="py-op">[</tt><tt class="py-name">si</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">err_name</tt><tt class="py-op">,</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt><tt class="py-op">)</tt> </tt>
<a name="L1137"></a><tt class="py-lineno">1137</tt>  <tt class="py-line"> </tt>
<a name="L1138"></a><tt class="py-lineno">1138</tt>  <tt class="py-line">            <tt class="py-comment"># Set the value.</tt> </tt>
<a name="L1139"></a><tt class="py-lineno">1139</tt>  <tt class="py-line">            <tt class="py-name">setattr</tt><tt class="py-op">(</tt><tt class="py-name">spins</tt><tt class="py-op">[</tt><tt class="py-name">si</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">err_name</tt><tt class="py-op">,</tt> <tt id="link-503" class="py-name"><a title="relax.RelaxParser.error" class="py-name" href="#" onclick="return doclink('link-503', 'error', 'link-469');">error</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1140"></a><tt class="py-lineno">1140</tt>  <tt class="py-line"> </tt>
<a name="L1141"></a><tt class="py-lineno">1141</tt>  <tt class="py-line">        <tt class="py-comment"># Model and auxiliary parameters.</tt> </tt>
<a name="L1142"></a><tt class="py-lineno">1142</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1143"></a><tt class="py-lineno">1143</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-504" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-504', 'spin', 'link-115');">spin</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">spins</tt><tt class="py-op">:</tt> </tt>
<a name="L1144"></a><tt class="py-lineno">1144</tt>  <tt class="py-line">                <tt class="py-name">setattr</tt><tt class="py-op">(</tt><tt id="link-505" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-505', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">err_name</tt><tt class="py-op">,</tt> <tt id="link-506" class="py-name"><a title="relax.RelaxParser.error" class="py-name" href="#" onclick="return doclink('link-506', 'error', 'link-469');">error</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L1145"></a><tt class="py-lineno">1145</tt>  <tt class="py-line"> </tt>
<a name="L1146"></a><tt class="py-lineno">1146</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.set_param_values"></a><div id="Relax_disp.set_param_values-def"><a name="L1147"></a><tt class="py-lineno">1147</tt> <a class="py-toggle" href="#" id="Relax_disp.set_param_values-toggle" onclick="return toggle('Relax_disp.set_param_values');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#set_param_values">set_param_values</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">param</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">value</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">index</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">spin_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">error</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">,</tt> <tt class="py-param">force</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.set_param_values-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.set_param_values-expanded"><a name="L1148"></a><tt class="py-lineno">1148</tt>  <tt class="py-line">        <tt class="py-docstring">"""Set the spin specific parameter values.</tt> </tt>
<a name="L1149"></a><tt class="py-lineno">1149</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1150"></a><tt class="py-lineno">1150</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword param:     The parameter name list.</tt> </tt>
<a name="L1151"></a><tt class="py-lineno">1151</tt>  <tt class="py-line"><tt class="py-docstring">        @type param:        list of str</tt> </tt>
<a name="L1152"></a><tt class="py-lineno">1152</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword value:     The parameter value list.</tt> </tt>
<a name="L1153"></a><tt class="py-lineno">1153</tt>  <tt class="py-line"><tt class="py-docstring">        @type value:        list</tt> </tt>
<a name="L1154"></a><tt class="py-lineno">1154</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword index:     The index for parameters which are of the list-type.</tt> </tt>
<a name="L1155"></a><tt class="py-lineno">1155</tt>  <tt class="py-line"><tt class="py-docstring">        @type index:        None or int</tt> </tt>
<a name="L1156"></a><tt class="py-lineno">1156</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword spin_id:   The spin identification string, only used for spin specific parameters.</tt> </tt>
<a name="L1157"></a><tt class="py-lineno">1157</tt>  <tt class="py-line"><tt class="py-docstring">        @type spin_id:      None or str</tt> </tt>
<a name="L1158"></a><tt class="py-lineno">1158</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword error:     A flag which if True will allow the parameter errors to be set instead of the values.</tt> </tt>
<a name="L1159"></a><tt class="py-lineno">1159</tt>  <tt class="py-line"><tt class="py-docstring">        @type error:        bool</tt> </tt>
<a name="L1160"></a><tt class="py-lineno">1160</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword force:     A flag which if True will cause current values to be overwritten.  If False, a RelaxError will raised if the parameter value is already set.</tt> </tt>
<a name="L1161"></a><tt class="py-lineno">1161</tt>  <tt class="py-line"><tt class="py-docstring">        @type force:        bool</tt> </tt>
<a name="L1162"></a><tt class="py-lineno">1162</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L1163"></a><tt class="py-lineno">1163</tt>  <tt class="py-line"> </tt>
<a name="L1164"></a><tt class="py-lineno">1164</tt>  <tt class="py-line">        <tt class="py-comment"># Checks.</tt> </tt>
<a name="L1165"></a><tt class="py-lineno">1165</tt>  <tt class="py-line">        <tt id="link-507" class="py-name"><a title="lib.arg_check.is_str_list" class="py-name" href="#" onclick="return doclink('link-507', 'is_str_list', 'link-7');">is_str_list</a></tt><tt class="py-op">(</tt><tt class="py-name">param</tt><tt class="py-op">,</tt> <tt class="py-string">'parameter name'</tt><tt class="py-op">)</tt> </tt>
<a name="L1166"></a><tt class="py-lineno">1166</tt>  <tt class="py-line">        <tt id="link-508" class="py-name"><a title="lib.arg_check.is_list
lib.check_types.is_list" class="py-name" href="#" onclick="return doclink('link-508', 'is_list', 'link-6');">is_list</a></tt><tt class="py-op">(</tt><tt id="link-509" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-509', 'value', 'link-309');">value</a></tt><tt class="py-op">,</tt> <tt class="py-string">'parameter value'</tt><tt class="py-op">)</tt> </tt>
<a name="L1167"></a><tt class="py-lineno">1167</tt>  <tt class="py-line"> </tt>
<a name="L1168"></a><tt class="py-lineno">1168</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the spin blocks.</tt> </tt>
<a name="L1169"></a><tt class="py-lineno">1169</tt>  <tt class="py-line">        <tt class="py-name">model_index</tt> <tt class="py-op">=</tt> <tt class="py-op">-</tt><tt class="py-number">1</tt> </tt>
<a name="L1170"></a><tt class="py-lineno">1170</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">spin_ids</tt> <tt class="py-keyword">in</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-510" class="py-name"><a title="lib.structure.internal.object.Internal.model_loop
specific_analyses.api_base.API_base.model_loop
specific_analyses.hybrid.Hybrid.model_loop
specific_analyses.model_free.api.Model_free.model_loop
specific_analyses.relax_disp.api.Relax_disp.model_loop" class="py-name" href="#" onclick="return doclink('link-510', 'model_loop', 'link-215');">model_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1171"></a><tt class="py-lineno">1171</tt>  <tt class="py-line">            <tt class="py-comment"># Increment the model index.</tt> </tt>
<a name="L1172"></a><tt class="py-lineno">1172</tt>  <tt class="py-line">            <tt class="py-name">model_index</tt> <tt class="py-op">+=</tt> <tt class="py-number">1</tt> </tt>
<a name="L1173"></a><tt class="py-lineno">1173</tt>  <tt class="py-line"> </tt>
<a name="L1174"></a><tt class="py-lineno">1174</tt>  <tt class="py-line">            <tt class="py-comment"># The spin containers.</tt> </tt>
<a name="L1175"></a><tt class="py-lineno">1175</tt>  <tt class="py-line">            <tt class="py-name">spins</tt> <tt class="py-op">=</tt> <tt id="link-511" class="py-name"><a title="specific_analyses.relax_disp.data.spin_ids_to_containers" class="py-name" href="#" onclick="return doclink('link-511', 'spin_ids_to_containers', 'link-80');">spin_ids_to_containers</a></tt><tt class="py-op">(</tt><tt class="py-name">spin_ids</tt><tt class="py-op">)</tt> </tt>
<a name="L1176"></a><tt class="py-lineno">1176</tt>  <tt class="py-line"> </tt>
<a name="L1177"></a><tt class="py-lineno">1177</tt>  <tt class="py-line">            <tt class="py-comment"># Skip deselected clusters.</tt> </tt>
<a name="L1178"></a><tt class="py-lineno">1178</tt>  <tt class="py-line">            <tt class="py-name">skip</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L1179"></a><tt class="py-lineno">1179</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-512" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-512', 'spin', 'link-115');">spin</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">spins</tt><tt class="py-op">:</tt> </tt>
<a name="L1180"></a><tt class="py-lineno">1180</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt id="link-513" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-513', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-514" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-514', 'select', 'link-118');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1181"></a><tt class="py-lineno">1181</tt>  <tt class="py-line">                    <tt class="py-name">skip</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L1182"></a><tt class="py-lineno">1182</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">skip</tt><tt class="py-op">:</tt> </tt>
<a name="L1183"></a><tt class="py-lineno">1183</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L1184"></a><tt class="py-lineno">1184</tt>  <tt class="py-line"> </tt>
<a name="L1185"></a><tt class="py-lineno">1185</tt>  <tt class="py-line">            <tt class="py-comment"># Loop over the parameters.</tt> </tt>
<a name="L1186"></a><tt class="py-lineno">1186</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-515" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-515', 'i', 'link-201');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">param</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1187"></a><tt class="py-lineno">1187</tt>  <tt class="py-line">                <tt class="py-name">param_i</tt> <tt class="py-op">=</tt> <tt class="py-name">param</tt><tt class="py-op">[</tt><tt id="link-516" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-516', 'i', 'link-201');">i</a></tt><tt class="py-op">]</tt> </tt>
<a name="L1188"></a><tt class="py-lineno">1188</tt>  <tt class="py-line">                <tt class="py-name">value_i</tt> <tt class="py-op">=</tt> <tt id="link-517" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-517', 'value', 'link-309');">value</a></tt><tt class="py-op">[</tt><tt id="link-518" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-518', 'i', 'link-201');">i</a></tt><tt class="py-op">]</tt> </tt>
<a name="L1189"></a><tt class="py-lineno">1189</tt>  <tt class="py-line"> </tt>
<a name="L1190"></a><tt class="py-lineno">1190</tt>  <tt class="py-line">                <tt class="py-comment"># Is the parameter is valid?</tt> </tt>
<a name="L1191"></a><tt class="py-lineno">1191</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_PARAMS</tt><tt class="py-op">.</tt><tt id="link-519" class="py-name"><a title="specific_analyses.parameter_object.Param_list.contains" class="py-name" href="#" onclick="return doclink('link-519', 'contains', 'link-339');">contains</a></tt><tt class="py-op">(</tt><tt class="py-name">param_i</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1192"></a><tt class="py-lineno">1192</tt>  <tt class="py-line">                    <tt class="py-keyword">raise</tt> <tt id="link-520" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-520', 'RelaxError', 'link-18');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The parameter '%s' is not valid for this data pipe type."</tt> <tt class="py-op">%</tt> <tt class="py-name">param_i</tt><tt class="py-op">)</tt> </tt>
<a name="L1193"></a><tt class="py-lineno">1193</tt>  <tt class="py-line"> </tt>
<a name="L1194"></a><tt class="py-lineno">1194</tt>  <tt class="py-line">                <tt class="py-comment"># If the parameter is a global parameter, then change for all spins part of the cluster.</tt> </tt>
<a name="L1195"></a><tt class="py-lineno">1195</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">param_i</tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt class="py-string">'pA'</tt><tt class="py-op">,</tt> <tt class="py-string">'pB'</tt><tt class="py-op">,</tt> <tt class="py-string">'pC'</tt><tt class="py-op">,</tt> <tt class="py-string">'kex'</tt><tt class="py-op">,</tt> <tt class="py-string">'k_AB'</tt><tt class="py-op">,</tt> <tt class="py-string">'k_BC'</tt><tt class="py-op">,</tt> <tt class="py-string">'k_AC'</tt><tt class="py-op">,</tt> <tt class="py-string">'tex'</tt><tt class="py-op">,</tt> <tt class="py-string">'kB'</tt><tt class="py-op">,</tt> <tt class="py-string">'kC'</tt><tt class="py-op">,</tt> <tt class="py-string">'kex_AB'</tt><tt class="py-op">,</tt> <tt class="py-string">'kex_BC'</tt><tt class="py-op">,</tt> <tt class="py-string">'kex_AC'</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L1196"></a><tt class="py-lineno">1196</tt>  <tt class="py-line">                    <tt class="py-name">selection_list</tt> <tt class="py-op">=</tt> <tt class="py-name">spin_ids</tt> </tt>
<a name="L1197"></a><tt class="py-lineno">1197</tt>  <tt class="py-line">                <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1198"></a><tt class="py-lineno">1198</tt>  <tt class="py-line">                    <tt class="py-name">selection_list</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt id="link-521" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-521', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">]</tt> </tt>
<a name="L1199"></a><tt class="py-lineno">1199</tt>  <tt class="py-line"> </tt>
<a name="L1200"></a><tt class="py-lineno">1200</tt>  <tt class="py-line">                <tt class="py-comment"># Now loop over selections in the list.</tt> </tt>
<a name="L1201"></a><tt class="py-lineno">1201</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt id="link-522" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-522', 'selection', 'link-21');">selection</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">selection_list</tt><tt class="py-op">:</tt> </tt>
<a name="L1202"></a><tt class="py-lineno">1202</tt>  <tt class="py-line">                    <tt class="py-comment"># Spin loop.</tt> </tt>
<a name="L1203"></a><tt class="py-lineno">1203</tt>  <tt class="py-line">                    <tt class="py-keyword">for</tt> <tt id="link-523" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-523', 'spin', 'link-115');">spin</a></tt> <tt class="py-keyword">in</tt> <tt id="link-524" class="py-name"><a title="pipe_control.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-524', 'spin_loop', 'link-45');">spin_loop</a></tt><tt class="py-op">(</tt><tt id="link-525" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-525', 'selection', 'link-21');">selection</a></tt><tt class="py-op">=</tt><tt id="link-526" class="py-name"><a title="lib.selection
lib.structure.internal.object.Internal.selection
lib.structure.internal.selection
pipe_control.selection
test_suite.system_tests.selection" class="py-name" href="#" onclick="return doclink('link-526', 'selection', 'link-21');">selection</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1204"></a><tt class="py-lineno">1204</tt>  <tt class="py-line">                        <tt class="py-comment"># The object name.</tt> </tt>
<a name="L1205"></a><tt class="py-lineno">1205</tt>  <tt class="py-line">                        <tt class="py-name">obj_name</tt> <tt class="py-op">=</tt> <tt class="py-name">param_i</tt> </tt>
<a name="L1206"></a><tt class="py-lineno">1206</tt>  <tt class="py-line">                        <tt class="py-keyword">if</tt> <tt id="link-527" class="py-name"><a title="relax.RelaxParser.error" class="py-name" href="#" onclick="return doclink('link-527', 'error', 'link-469');">error</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1207"></a><tt class="py-lineno">1207</tt>  <tt class="py-line">                            <tt class="py-name">obj_name</tt> <tt class="py-op">+=</tt> <tt class="py-string">'_err'</tt> </tt>
<a name="L1208"></a><tt class="py-lineno">1208</tt>  <tt class="py-line">         </tt>
<a name="L1209"></a><tt class="py-lineno">1209</tt>  <tt class="py-line">                        <tt class="py-comment"># Handle the R10 parameters.</tt> </tt>
<a name="L1210"></a><tt class="py-lineno">1210</tt>  <tt class="py-line">                        <tt class="py-keyword">if</tt> <tt class="py-name">param_i</tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt class="py-string">'r1'</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L1211"></a><tt class="py-lineno">1211</tt>  <tt class="py-line">                            <tt class="py-comment"># Loop over the current keys.</tt> </tt>
<a name="L1212"></a><tt class="py-lineno">1212</tt>  <tt class="py-line">                            <tt class="py-keyword">for</tt> <tt class="py-name">exp_type</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt><tt class="py-op">,</tt> <tt class="py-name">ei</tt><tt class="py-op">,</tt> <tt class="py-name">mi</tt> <tt class="py-keyword">in</tt> <tt id="link-528" class="py-name"><a title="specific_analyses.relax_disp.data.loop_exp_frq" class="py-name" href="#" onclick="return doclink('link-528', 'loop_exp_frq', 'link-75');">loop_exp_frq</a></tt><tt class="py-op">(</tt><tt class="py-name">return_indices</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1213"></a><tt class="py-lineno">1213</tt>  <tt class="py-line">                                <tt class="py-comment"># The parameter key.</tt> </tt>
<a name="L1214"></a><tt class="py-lineno">1214</tt>  <tt class="py-line">                                <tt class="py-name">key</tt> <tt class="py-op">=</tt> <tt id="link-529" class="py-name"><a title="specific_analyses.relax_disp.data.generate_r20_key" class="py-name" href="#" onclick="return doclink('link-529', 'generate_r20_key', 'link-71');">generate_r20_key</a></tt><tt class="py-op">(</tt><tt class="py-name">exp_type</tt><tt class="py-op">=</tt><tt class="py-name">exp_type</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt><tt class="py-op">=</tt><tt class="py-name">frq</tt><tt class="py-op">)</tt> </tt>
<a name="L1215"></a><tt class="py-lineno">1215</tt>  <tt class="py-line">         </tt>
<a name="L1216"></a><tt class="py-lineno">1216</tt>  <tt class="py-line">                                <tt class="py-comment"># Initialise the structure if needed.</tt> </tt>
<a name="L1217"></a><tt class="py-lineno">1217</tt>  <tt class="py-line">                                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-530" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-530', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">obj_name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1218"></a><tt class="py-lineno">1218</tt>  <tt class="py-line">                                    <tt class="py-name">setattr</tt><tt class="py-op">(</tt><tt id="link-531" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-531', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">obj_name</tt><tt class="py-op">,</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt><tt class="py-op">)</tt> </tt>
<a name="L1219"></a><tt class="py-lineno">1219</tt>  <tt class="py-line">         </tt>
<a name="L1220"></a><tt class="py-lineno">1220</tt>  <tt class="py-line">                                <tt class="py-comment"># Set the value.</tt> </tt>
<a name="L1221"></a><tt class="py-lineno">1221</tt>  <tt class="py-line">                                <tt class="py-keyword">if</tt> <tt class="py-name">index</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L1222"></a><tt class="py-lineno">1222</tt>  <tt class="py-line">                                    <tt class="py-name">obj</tt> <tt class="py-op">=</tt> <tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt id="link-532" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-532', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">obj_name</tt><tt class="py-op">)</tt> </tt>
<a name="L1223"></a><tt class="py-lineno">1223</tt>  <tt class="py-line">                                    <tt class="py-name">obj</tt><tt class="py-op">[</tt><tt class="py-name">key</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">value_i</tt> </tt>
<a name="L1224"></a><tt class="py-lineno">1224</tt>  <tt class="py-line">         </tt>
<a name="L1225"></a><tt class="py-lineno">1225</tt>  <tt class="py-line">                                <tt class="py-comment"># If the index is specified, let it match the frequency index</tt> </tt>
<a name="L1226"></a><tt class="py-lineno">1226</tt>  <tt class="py-line">                                <tt class="py-keyword">elif</tt> <tt class="py-name">mi</tt> <tt class="py-op">==</tt> <tt class="py-name">index</tt><tt class="py-op">:</tt> </tt>
<a name="L1227"></a><tt class="py-lineno">1227</tt>  <tt class="py-line">                                    <tt class="py-name">obj</tt> <tt class="py-op">=</tt> <tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt id="link-533" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-533', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">obj_name</tt><tt class="py-op">)</tt> </tt>
<a name="L1228"></a><tt class="py-lineno">1228</tt>  <tt class="py-line">                                    <tt class="py-name">obj</tt><tt class="py-op">[</tt><tt class="py-name">key</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">value_i</tt> </tt>
<a name="L1229"></a><tt class="py-lineno">1229</tt>  <tt class="py-line">         </tt>
<a name="L1230"></a><tt class="py-lineno">1230</tt>  <tt class="py-line">                        <tt class="py-comment"># Handle the R20 parameters.</tt> </tt>
<a name="L1231"></a><tt class="py-lineno">1231</tt>  <tt class="py-line">                        <tt class="py-keyword">elif</tt> <tt class="py-name">param_i</tt> <tt class="py-keyword">in</tt> <tt id="link-534" class="py-name"><a title="lib.dispersion.variables.PARAMS_R20" class="py-name" href="#" onclick="return doclink('link-534', 'PARAMS_R20', 'link-15');">PARAMS_R20</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1232"></a><tt class="py-lineno">1232</tt>  <tt class="py-line">                            <tt class="py-comment"># Loop over the current keys.</tt> </tt>
<a name="L1233"></a><tt class="py-lineno">1233</tt>  <tt class="py-line">                            <tt class="py-keyword">for</tt> <tt class="py-name">exp_type</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt><tt class="py-op">,</tt> <tt class="py-name">ei</tt><tt class="py-op">,</tt> <tt class="py-name">mi</tt> <tt class="py-keyword">in</tt> <tt id="link-535" class="py-name"><a title="specific_analyses.relax_disp.data.loop_exp_frq" class="py-name" href="#" onclick="return doclink('link-535', 'loop_exp_frq', 'link-75');">loop_exp_frq</a></tt><tt class="py-op">(</tt><tt class="py-name">return_indices</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1234"></a><tt class="py-lineno">1234</tt>  <tt class="py-line">                                <tt class="py-comment"># The parameter key.</tt> </tt>
<a name="L1235"></a><tt class="py-lineno">1235</tt>  <tt class="py-line">                                <tt class="py-name">key</tt> <tt class="py-op">=</tt> <tt id="link-536" class="py-name"><a title="specific_analyses.relax_disp.data.generate_r20_key" class="py-name" href="#" onclick="return doclink('link-536', 'generate_r20_key', 'link-71');">generate_r20_key</a></tt><tt class="py-op">(</tt><tt class="py-name">exp_type</tt><tt class="py-op">=</tt><tt class="py-name">exp_type</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt><tt class="py-op">=</tt><tt class="py-name">frq</tt><tt class="py-op">)</tt> </tt>
<a name="L1236"></a><tt class="py-lineno">1236</tt>  <tt class="py-line">         </tt>
<a name="L1237"></a><tt class="py-lineno">1237</tt>  <tt class="py-line">                                <tt class="py-comment"># Initialise the structure if needed.</tt> </tt>
<a name="L1238"></a><tt class="py-lineno">1238</tt>  <tt class="py-line">                                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-537" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-537', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">obj_name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1239"></a><tt class="py-lineno">1239</tt>  <tt class="py-line">                                    <tt class="py-name">setattr</tt><tt class="py-op">(</tt><tt id="link-538" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-538', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">obj_name</tt><tt class="py-op">,</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt><tt class="py-op">)</tt> </tt>
<a name="L1240"></a><tt class="py-lineno">1240</tt>  <tt class="py-line">         </tt>
<a name="L1241"></a><tt class="py-lineno">1241</tt>  <tt class="py-line">                                <tt class="py-comment"># Set the value.</tt> </tt>
<a name="L1242"></a><tt class="py-lineno">1242</tt>  <tt class="py-line">                                <tt class="py-keyword">if</tt> <tt class="py-name">index</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L1243"></a><tt class="py-lineno">1243</tt>  <tt class="py-line">                                    <tt class="py-name">obj</tt> <tt class="py-op">=</tt> <tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt id="link-539" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-539', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">obj_name</tt><tt class="py-op">)</tt> </tt>
<a name="L1244"></a><tt class="py-lineno">1244</tt>  <tt class="py-line">                                    <tt class="py-name">obj</tt><tt class="py-op">[</tt><tt class="py-name">key</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">value_i</tt> </tt>
<a name="L1245"></a><tt class="py-lineno">1245</tt>  <tt class="py-line">         </tt>
<a name="L1246"></a><tt class="py-lineno">1246</tt>  <tt class="py-line">                                <tt class="py-comment"># If the index is specified, let it match the frequency index</tt> </tt>
<a name="L1247"></a><tt class="py-lineno">1247</tt>  <tt class="py-line">                                <tt class="py-keyword">elif</tt> <tt class="py-name">mi</tt> <tt class="py-op">==</tt> <tt class="py-name">index</tt><tt class="py-op">:</tt> </tt>
<a name="L1248"></a><tt class="py-lineno">1248</tt>  <tt class="py-line">                                    <tt class="py-name">obj</tt> <tt class="py-op">=</tt> <tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt id="link-540" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-540', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">obj_name</tt><tt class="py-op">)</tt> </tt>
<a name="L1249"></a><tt class="py-lineno">1249</tt>  <tt class="py-line">                                    <tt class="py-name">obj</tt><tt class="py-op">[</tt><tt class="py-name">key</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">value_i</tt> </tt>
<a name="L1250"></a><tt class="py-lineno">1250</tt>  <tt class="py-line">         </tt>
<a name="L1251"></a><tt class="py-lineno">1251</tt>  <tt class="py-line">                        <tt class="py-comment"># Handle the R2eff and I0 parameters.</tt> </tt>
<a name="L1252"></a><tt class="py-lineno">1252</tt>  <tt class="py-line">                        <tt class="py-keyword">elif</tt> <tt class="py-name">param_i</tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt class="py-string">'r2eff'</tt><tt class="py-op">,</tt> <tt class="py-string">'i0'</tt><tt class="py-op">]</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">isinstance</tt><tt class="py-op">(</tt><tt class="py-name">value_i</tt><tt class="py-op">,</tt> <tt class="py-name">dict</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1253"></a><tt class="py-lineno">1253</tt>  <tt class="py-line">                            <tt class="py-comment"># Loop over all the data.</tt> </tt>
<a name="L1254"></a><tt class="py-lineno">1254</tt>  <tt class="py-line">                            <tt class="py-keyword">for</tt> <tt class="py-name">exp_type</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt><tt class="py-op">,</tt> <tt id="link-541" class="py-name"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-541', 'offset', 'link-120');">offset</a></tt><tt class="py-op">,</tt> <tt class="py-name">point</tt> <tt class="py-keyword">in</tt> <tt id="link-542" class="py-name"><a title="specific_analyses.relax_disp.data.loop_exp_frq_offset_point" class="py-name" href="#" onclick="return doclink('link-542', 'loop_exp_frq_offset_point', 'link-76');">loop_exp_frq_offset_point</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1255"></a><tt class="py-lineno">1255</tt>  <tt class="py-line">                                <tt class="py-comment"># The parameter key.</tt> </tt>
<a name="L1256"></a><tt class="py-lineno">1256</tt>  <tt class="py-line">                                <tt class="py-name">key</tt> <tt class="py-op">=</tt> <tt id="link-543" class="py-name"><a title="specific_analyses.relax_disp.data.return_param_key_from_data" class="py-name" href="#" onclick="return doclink('link-543', 'return_param_key_from_data', 'link-79');">return_param_key_from_data</a></tt><tt class="py-op">(</tt><tt class="py-name">exp_type</tt><tt class="py-op">=</tt><tt class="py-name">exp_type</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt><tt class="py-op">=</tt><tt class="py-name">frq</tt><tt class="py-op">,</tt> <tt id="link-544" class="py-name"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-544', 'offset', 'link-120');">offset</a></tt><tt class="py-op">=</tt><tt id="link-545" class="py-name"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-545', 'offset', 'link-120');">offset</a></tt><tt class="py-op">,</tt> <tt class="py-name">point</tt><tt class="py-op">=</tt><tt class="py-name">point</tt><tt class="py-op">)</tt> </tt>
<a name="L1257"></a><tt class="py-lineno">1257</tt>  <tt class="py-line">         </tt>
<a name="L1258"></a><tt class="py-lineno">1258</tt>  <tt class="py-line">                                <tt class="py-comment"># Initialise the structure if needed.</tt> </tt>
<a name="L1259"></a><tt class="py-lineno">1259</tt>  <tt class="py-line">                                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-546" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-546', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">obj_name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1260"></a><tt class="py-lineno">1260</tt>  <tt class="py-line">                                    <tt class="py-name">setattr</tt><tt class="py-op">(</tt><tt id="link-547" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-547', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">obj_name</tt><tt class="py-op">,</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt><tt class="py-op">)</tt> </tt>
<a name="L1261"></a><tt class="py-lineno">1261</tt>  <tt class="py-line">         </tt>
<a name="L1262"></a><tt class="py-lineno">1262</tt>  <tt class="py-line">                                <tt class="py-comment"># Set the value.</tt> </tt>
<a name="L1263"></a><tt class="py-lineno">1263</tt>  <tt class="py-line">                                <tt class="py-name">obj</tt> <tt class="py-op">=</tt> <tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt id="link-548" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-548', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">obj_name</tt><tt class="py-op">)</tt> </tt>
<a name="L1264"></a><tt class="py-lineno">1264</tt>  <tt class="py-line">                                <tt class="py-name">obj</tt><tt class="py-op">[</tt><tt class="py-name">key</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">value_i</tt> </tt>
<a name="L1265"></a><tt class="py-lineno">1265</tt>  <tt class="py-line">         </tt>
<a name="L1266"></a><tt class="py-lineno">1266</tt>  <tt class="py-line">                        <tt class="py-comment"># Set the other parameters.</tt> </tt>
<a name="L1267"></a><tt class="py-lineno">1267</tt>  <tt class="py-line">                        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1268"></a><tt class="py-lineno">1268</tt>  <tt class="py-line">                            <tt class="py-name">setattr</tt><tt class="py-op">(</tt><tt id="link-549" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-549', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">obj_name</tt><tt class="py-op">,</tt> <tt class="py-name">value_i</tt><tt class="py-op">)</tt> </tt>
</div><a name="L1269"></a><tt class="py-lineno">1269</tt>  <tt class="py-line"> </tt>
<a name="L1270"></a><tt class="py-lineno">1270</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.set_selected_sim"></a><div id="Relax_disp.set_selected_sim-def"><a name="L1271"></a><tt class="py-lineno">1271</tt> <a class="py-toggle" href="#" id="Relax_disp.set_selected_sim-toggle" onclick="return toggle('Relax_disp.set_selected_sim');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#set_selected_sim">set_selected_sim</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">select_sim</tt><tt class="py-op">,</tt> <tt class="py-param">model_info</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.set_selected_sim-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.set_selected_sim-expanded"><a name="L1272"></a><tt class="py-lineno">1272</tt>  <tt class="py-line">        <tt class="py-docstring">"""Set the simulation selection flag.</tt> </tt>
<a name="L1273"></a><tt class="py-lineno">1273</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1274"></a><tt class="py-lineno">1274</tt>  <tt class="py-line"><tt class="py-docstring">        @param select_sim:      The selection flag for the simulations.</tt> </tt>
<a name="L1275"></a><tt class="py-lineno">1275</tt>  <tt class="py-line"><tt class="py-docstring">        @type select_sim:       bool</tt> </tt>
<a name="L1276"></a><tt class="py-lineno">1276</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword model_info:    The list of spins and spin IDs per cluster originating from model_loop().</tt> </tt>
<a name="L1277"></a><tt class="py-lineno">1277</tt>  <tt class="py-line"><tt class="py-docstring">        @type model_info:       list of SpinContainer instances, list of str</tt> </tt>
<a name="L1278"></a><tt class="py-lineno">1278</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L1279"></a><tt class="py-lineno">1279</tt>  <tt class="py-line"> </tt>
<a name="L1280"></a><tt class="py-lineno">1280</tt>  <tt class="py-line">        <tt class="py-comment"># Unpack the data.</tt> </tt>
<a name="L1281"></a><tt class="py-lineno">1281</tt>  <tt class="py-line">        <tt class="py-name">spin_ids</tt> <tt class="py-op">=</tt> <tt class="py-name">model_info</tt> </tt>
<a name="L1282"></a><tt class="py-lineno">1282</tt>  <tt class="py-line">        <tt class="py-name">spins</tt> <tt class="py-op">=</tt> <tt id="link-550" class="py-name"><a title="specific_analyses.relax_disp.data.spin_ids_to_containers" class="py-name" href="#" onclick="return doclink('link-550', 'spin_ids_to_containers', 'link-80');">spin_ids_to_containers</a></tt><tt class="py-op">(</tt><tt class="py-name">spin_ids</tt><tt class="py-op">)</tt> </tt>
<a name="L1283"></a><tt class="py-lineno">1283</tt>  <tt class="py-line"> </tt>
<a name="L1284"></a><tt class="py-lineno">1284</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the spins, storing the structure for each spin.</tt> </tt>
<a name="L1285"></a><tt class="py-lineno">1285</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-551" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-551', 'spin', 'link-115');">spin</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">spins</tt><tt class="py-op">:</tt> </tt>
<a name="L1286"></a><tt class="py-lineno">1286</tt>  <tt class="py-line">            <tt id="link-552" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-552', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">select_sim</tt> <tt class="py-op">=</tt> <tt class="py-name">deepcopy</tt><tt class="py-op">(</tt><tt class="py-name">select_sim</tt><tt class="py-op">)</tt> </tt>
</div><a name="L1287"></a><tt class="py-lineno">1287</tt>  <tt class="py-line"> </tt>
<a name="L1288"></a><tt class="py-lineno">1288</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.sim_init_values"></a><div id="Relax_disp.sim_init_values-def"><a name="L1289"></a><tt class="py-lineno">1289</tt> <a class="py-toggle" href="#" id="Relax_disp.sim_init_values-toggle" onclick="return toggle('Relax_disp.sim_init_values');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#sim_init_values">sim_init_values</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.sim_init_values-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.sim_init_values-expanded"><a name="L1290"></a><tt class="py-lineno">1290</tt>  <tt class="py-line">        <tt class="py-docstring">"""Initialise the Monte Carlo parameter values."""</tt> </tt>
<a name="L1291"></a><tt class="py-lineno">1291</tt>  <tt class="py-line"> </tt>
<a name="L1292"></a><tt class="py-lineno">1292</tt>  <tt class="py-line">        <tt class="py-comment"># Get the parameter object names.</tt> </tt>
<a name="L1293"></a><tt class="py-lineno">1293</tt>  <tt class="py-line">        <tt class="py-name">param_names</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-553" class="py-name" targets="Function pipe_control.diffusion_tensor.data_names()=pipe_control.diffusion_tensor-module.html#data_names,Method specific_analyses.api_base.API_base.data_names()=specific_analyses.api_base.API_base-class.html#data_names,Method specific_analyses.hybrid.Hybrid.data_names()=specific_analyses.hybrid.Hybrid-class.html#data_names,Method specific_analyses.parameter_object.Param_list.data_names()=specific_analyses.parameter_object.Param_list-class.html#data_names"><a title="pipe_control.diffusion_tensor.data_names
specific_analyses.api_base.API_base.data_names
specific_analyses.hybrid.Hybrid.data_names
specific_analyses.parameter_object.Param_list.data_names" class="py-name" href="#" onclick="return doclink('link-553', 'data_names', 'link-553');">data_names</a></tt><tt class="py-op">(</tt><tt id="link-554" class="py-name" targets="Method data_store.align_tensor.AlignTensorData.set()=data_store.align_tensor.AlignTensorData-class.html#set,Method data_store.diff_tensor.DiffTensorData.set()=data_store.diff_tensor.DiffTensorData-class.html#set,Method multi.misc.Verbosity.set()=multi.misc.Verbosity-class.html#set,Function pipe_control.align_tensor.set()=pipe_control.align_tensor-module.html#set,Function pipe_control.diffusion_tensor.set()=pipe_control.diffusion_tensor-module.html#set,Function pipe_control.minimise.set()=pipe_control.minimise-module.html#set,Function pipe_control.value.set()=pipe_control.value-module.html#set,Method specific_analyses.parameter_object.Param_list.set()=specific_analyses.parameter_object.Param_list-class.html#set"><a title="data_store.align_tensor.AlignTensorData.set
data_store.diff_tensor.DiffTensorData.set
multi.misc.Verbosity.set
pipe_control.align_tensor.set
pipe_control.diffusion_tensor.set
pipe_control.minimise.set
pipe_control.value.set
specific_analyses.parameter_object.Param_list.set" class="py-name" href="#" onclick="return doclink('link-554', 'set', 'link-554');">set</a></tt><tt class="py-op">=</tt><tt class="py-string">'params'</tt><tt class="py-op">)</tt> </tt>
<a name="L1294"></a><tt class="py-lineno">1294</tt>  <tt class="py-line"> </tt>
<a name="L1295"></a><tt class="py-lineno">1295</tt>  <tt class="py-line">        <tt class="py-comment"># Add the names of kex-tex pair.</tt> </tt>
<a name="L1296"></a><tt class="py-lineno">1296</tt>  <tt class="py-line">        <tt class="py-name">pairs</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L1297"></a><tt class="py-lineno">1297</tt>  <tt class="py-line">        <tt class="py-name">pairs</tt><tt class="py-op">[</tt><tt class="py-string">'kex'</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-string">'tex'</tt> </tt>
<a name="L1298"></a><tt class="py-lineno">1298</tt>  <tt class="py-line">        <tt class="py-name">pairs</tt><tt class="py-op">[</tt><tt class="py-string">'tex'</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-string">'kex'</tt> </tt>
<a name="L1299"></a><tt class="py-lineno">1299</tt>  <tt class="py-line"> </tt>
<a name="L1300"></a><tt class="py-lineno">1300</tt>  <tt class="py-line">        <tt class="py-comment"># Add the names of pA-pB pair.</tt> </tt>
<a name="L1301"></a><tt class="py-lineno">1301</tt>  <tt class="py-line">        <tt class="py-name">pairs</tt><tt class="py-op">[</tt><tt class="py-string">'pA'</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-string">'pB'</tt> </tt>
<a name="L1302"></a><tt class="py-lineno">1302</tt>  <tt class="py-line">        <tt class="py-name">pairs</tt><tt class="py-op">[</tt><tt class="py-string">'pB'</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-string">'pA'</tt> </tt>
<a name="L1303"></a><tt class="py-lineno">1303</tt>  <tt class="py-line"> </tt>
<a name="L1304"></a><tt class="py-lineno">1304</tt>  <tt class="py-line">        <tt class="py-comment"># Add the names of kex-k_AB pair and kex-k_BA pair.</tt> </tt>
<a name="L1305"></a><tt class="py-lineno">1305</tt>  <tt class="py-line">        <tt class="py-name">pairs</tt><tt class="py-op">[</tt><tt class="py-string">'k_AB'</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-string">'kex'</tt> </tt>
<a name="L1306"></a><tt class="py-lineno">1306</tt>  <tt class="py-line">        <tt class="py-name">pairs</tt><tt class="py-op">[</tt><tt class="py-string">'k_BA'</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-string">'kex'</tt> </tt>
<a name="L1307"></a><tt class="py-lineno">1307</tt>  <tt class="py-line"> </tt>
<a name="L1308"></a><tt class="py-lineno">1308</tt>  <tt class="py-line">        <tt class="py-comment"># Get the minimisation statistic object names.</tt> </tt>
<a name="L1309"></a><tt class="py-lineno">1309</tt>  <tt class="py-line">        <tt class="py-name">min_names</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-555" class="py-name"><a title="pipe_control.diffusion_tensor.data_names
specific_analyses.api_base.API_base.data_names
specific_analyses.hybrid.Hybrid.data_names
specific_analyses.parameter_object.Param_list.data_names" class="py-name" href="#" onclick="return doclink('link-555', 'data_names', 'link-553');">data_names</a></tt><tt class="py-op">(</tt><tt id="link-556" class="py-name"><a title="data_store.align_tensor.AlignTensorData.set
data_store.diff_tensor.DiffTensorData.set
multi.misc.Verbosity.set
pipe_control.align_tensor.set
pipe_control.diffusion_tensor.set
pipe_control.minimise.set
pipe_control.value.set
specific_analyses.parameter_object.Param_list.set" class="py-name" href="#" onclick="return doclink('link-556', 'set', 'link-554');">set</a></tt><tt class="py-op">=</tt><tt class="py-string">'min'</tt><tt class="py-op">)</tt> </tt>
<a name="L1310"></a><tt class="py-lineno">1310</tt>  <tt class="py-line"> </tt>
<a name="L1311"></a><tt class="py-lineno">1311</tt>  <tt class="py-line"> </tt>
<a name="L1312"></a><tt class="py-lineno">1312</tt>  <tt class="py-line">        <tt class="py-comment"># Test if Monte Carlo parameter values have already been set.</tt> </tt>
<a name="L1313"></a><tt class="py-lineno">1313</tt>  <tt class="py-line">        <tt class="py-comment">#############################################################</tt> </tt>
<a name="L1314"></a><tt class="py-lineno">1314</tt>  <tt class="py-line"> </tt>
<a name="L1315"></a><tt class="py-lineno">1315</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the spins.</tt> </tt>
<a name="L1316"></a><tt class="py-lineno">1316</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-557" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-557', 'spin', 'link-115');">spin</a></tt> <tt class="py-keyword">in</tt> <tt id="link-558" class="py-name"><a title="pipe_control.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-558', 'spin_loop', 'link-45');">spin_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1317"></a><tt class="py-lineno">1317</tt>  <tt class="py-line">            <tt class="py-comment"># Skip deselected spins.</tt> </tt>
<a name="L1318"></a><tt class="py-lineno">1318</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-559" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-559', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-560" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-560', 'select', 'link-118');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1319"></a><tt class="py-lineno">1319</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L1320"></a><tt class="py-lineno">1320</tt>  <tt class="py-line"> </tt>
<a name="L1321"></a><tt class="py-lineno">1321</tt>  <tt class="py-line">            <tt class="py-comment"># Loop over all the parameter names.</tt> </tt>
<a name="L1322"></a><tt class="py-lineno">1322</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">object_name</tt> <tt class="py-keyword">in</tt> <tt class="py-name">param_names</tt><tt class="py-op">:</tt> </tt>
<a name="L1323"></a><tt class="py-lineno">1323</tt>  <tt class="py-line">                <tt class="py-comment"># Name for the simulation object.</tt> </tt>
<a name="L1324"></a><tt class="py-lineno">1324</tt>  <tt class="py-line">                <tt class="py-name">sim_object_name</tt> <tt class="py-op">=</tt> <tt class="py-name">object_name</tt> <tt class="py-op">+</tt> <tt class="py-string">'_sim'</tt> </tt>
<a name="L1325"></a><tt class="py-lineno">1325</tt>  <tt class="py-line"> </tt>
<a name="L1326"></a><tt class="py-lineno">1326</tt>  <tt class="py-line"> </tt>
<a name="L1327"></a><tt class="py-lineno">1327</tt>  <tt class="py-line">        <tt class="py-comment"># Set the Monte Carlo parameter values.</tt> </tt>
<a name="L1328"></a><tt class="py-lineno">1328</tt>  <tt class="py-line">        <tt class="py-comment">#######################################</tt> </tt>
<a name="L1329"></a><tt class="py-lineno">1329</tt>  <tt class="py-line"> </tt>
<a name="L1330"></a><tt class="py-lineno">1330</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the spins.</tt> </tt>
<a name="L1331"></a><tt class="py-lineno">1331</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-561" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-561', 'spin', 'link-115');">spin</a></tt> <tt class="py-keyword">in</tt> <tt id="link-562" class="py-name"><a title="pipe_control.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-562', 'spin_loop', 'link-45');">spin_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1332"></a><tt class="py-lineno">1332</tt>  <tt class="py-line">            <tt class="py-comment"># Skip deselected spins.</tt> </tt>
<a name="L1333"></a><tt class="py-lineno">1333</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-563" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-563', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-564" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-564', 'select', 'link-118');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1334"></a><tt class="py-lineno">1334</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L1335"></a><tt class="py-lineno">1335</tt>  <tt class="py-line"> </tt>
<a name="L1336"></a><tt class="py-lineno">1336</tt>  <tt class="py-line">            <tt class="py-comment"># Skip protons for MMQ data.</tt> </tt>
<a name="L1337"></a><tt class="py-lineno">1337</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-565" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-565', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-566" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model
specific_analyses.model_free.model
specific_analyses.relax_disp.model" class="py-name" href="#" onclick="return doclink('link-566', 'model', 'link-131');">model</a></tt> <tt class="py-keyword">in</tt> <tt id="link-567" class="py-name"><a title="lib.dispersion.variables.MODEL_LIST_MMQ" class="py-name" href="#" onclick="return doclink('link-567', 'MODEL_LIST_MMQ', 'link-13');">MODEL_LIST_MMQ</a></tt> <tt class="py-keyword">and</tt> <tt id="link-568" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-568', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">isotope</tt> <tt class="py-op">==</tt> <tt class="py-string">'1H'</tt><tt class="py-op">:</tt> </tt>
<a name="L1338"></a><tt class="py-lineno">1338</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L1339"></a><tt class="py-lineno">1339</tt>  <tt class="py-line"> </tt>
<a name="L1340"></a><tt class="py-lineno">1340</tt>  <tt class="py-line">            <tt class="py-comment"># Loop over all the data names.</tt> </tt>
<a name="L1341"></a><tt class="py-lineno">1341</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">object_name</tt> <tt class="py-keyword">in</tt> <tt class="py-name">param_names</tt><tt class="py-op">:</tt> </tt>
<a name="L1342"></a><tt class="py-lineno">1342</tt>  <tt class="py-line">                <tt class="py-comment"># Not a parameter of the model.</tt> </tt>
<a name="L1343"></a><tt class="py-lineno">1343</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-op">(</tt><tt class="py-name">object_name</tt> <tt class="py-keyword">in</tt> <tt id="link-569" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-569', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-570" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.params
gui.analyses.auto_model_free.Mf_list.params
gui.analyses.auto_relax_disp.Disp_model_list.params
gui.analyses.elements.model_list.Model_list.params" class="py-name" href="#" onclick="return doclink('link-570', 'params', 'link-494');">params</a></tt> <tt class="py-keyword">or</tt> <tt class="py-op">(</tt><tt class="py-name">object_name</tt> <tt class="py-keyword">in</tt> <tt class="py-name">pairs</tt> <tt class="py-keyword">and</tt> <tt class="py-name">pairs</tt><tt class="py-op">[</tt><tt class="py-name">object_name</tt><tt class="py-op">]</tt> <tt class="py-keyword">in</tt> <tt id="link-571" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-571', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-572" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.params
gui.analyses.auto_model_free.Mf_list.params
gui.analyses.auto_relax_disp.Disp_model_list.params
gui.analyses.elements.model_list.Model_list.params" class="py-name" href="#" onclick="return doclink('link-572', 'params', 'link-494');">params</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1344"></a><tt class="py-lineno">1344</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L1345"></a><tt class="py-lineno">1345</tt>  <tt class="py-line"> </tt>
<a name="L1346"></a><tt class="py-lineno">1346</tt>  <tt class="py-line">                <tt class="py-comment"># Name for the simulation object.</tt> </tt>
<a name="L1347"></a><tt class="py-lineno">1347</tt>  <tt class="py-line">                <tt class="py-name">sim_object_name</tt> <tt class="py-op">=</tt> <tt class="py-name">object_name</tt> <tt class="py-op">+</tt> <tt class="py-string">'_sim'</tt> </tt>
<a name="L1348"></a><tt class="py-lineno">1348</tt>  <tt class="py-line"> </tt>
<a name="L1349"></a><tt class="py-lineno">1349</tt>  <tt class="py-line">                <tt class="py-comment"># Create the simulation object.</tt> </tt>
<a name="L1350"></a><tt class="py-lineno">1350</tt>  <tt class="py-line">                <tt class="py-name">setattr</tt><tt class="py-op">(</tt><tt id="link-573" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-573', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">sim_object_name</tt><tt class="py-op">,</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1351"></a><tt class="py-lineno">1351</tt>  <tt class="py-line"> </tt>
<a name="L1352"></a><tt class="py-lineno">1352</tt>  <tt class="py-line">                <tt class="py-comment"># Get the simulation object.</tt> </tt>
<a name="L1353"></a><tt class="py-lineno">1353</tt>  <tt class="py-line">                <tt class="py-name">sim_object</tt> <tt class="py-op">=</tt> <tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt id="link-574" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-574', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">sim_object_name</tt><tt class="py-op">)</tt> </tt>
<a name="L1354"></a><tt class="py-lineno">1354</tt>  <tt class="py-line"> </tt>
<a name="L1355"></a><tt class="py-lineno">1355</tt>  <tt class="py-line">                <tt class="py-comment"># Loop over the simulations.</tt> </tt>
<a name="L1356"></a><tt class="py-lineno">1356</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">j</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">sim_number</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1357"></a><tt class="py-lineno">1357</tt>  <tt class="py-line">                    <tt class="py-comment"># The non-simulation value.</tt> </tt>
<a name="L1358"></a><tt class="py-lineno">1358</tt>  <tt class="py-line">                    <tt class="py-keyword">if</tt> <tt class="py-name">object_name</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt id="link-575" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-575', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-576" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.params
gui.analyses.auto_model_free.Mf_list.params
gui.analyses.auto_relax_disp.Disp_model_list.params
gui.analyses.elements.model_list.Model_list.params" class="py-name" href="#" onclick="return doclink('link-576', 'params', 'link-494');">params</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1359"></a><tt class="py-lineno">1359</tt>  <tt class="py-line">                        <tt id="link-577" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-577', 'value', 'link-309');">value</a></tt> <tt class="py-op">=</tt> <tt class="py-name">deepcopy</tt><tt class="py-op">(</tt><tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt id="link-578" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-578', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">pairs</tt><tt class="py-op">[</tt><tt class="py-name">object_name</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1360"></a><tt class="py-lineno">1360</tt>  <tt class="py-line">                    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1361"></a><tt class="py-lineno">1361</tt>  <tt class="py-line">                        <tt id="link-579" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-579', 'value', 'link-309');">value</a></tt> <tt class="py-op">=</tt> <tt class="py-name">deepcopy</tt><tt class="py-op">(</tt><tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt id="link-580" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-580', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">object_name</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1362"></a><tt class="py-lineno">1362</tt>  <tt class="py-line"> </tt>
<a name="L1363"></a><tt class="py-lineno">1363</tt>  <tt class="py-line">                    <tt class="py-comment"># Copy and append the data.</tt> </tt>
<a name="L1364"></a><tt class="py-lineno">1364</tt>  <tt class="py-line">                    <tt class="py-name">sim_object</tt><tt class="py-op">.</tt><tt id="link-581" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-581', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt id="link-582" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-582', 'value', 'link-309');">value</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1365"></a><tt class="py-lineno">1365</tt>  <tt class="py-line"> </tt>
<a name="L1366"></a><tt class="py-lineno">1366</tt>  <tt class="py-line">            <tt class="py-comment"># Loop over all the minimisation object names.</tt> </tt>
<a name="L1367"></a><tt class="py-lineno">1367</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">object_name</tt> <tt class="py-keyword">in</tt> <tt class="py-name">min_names</tt><tt class="py-op">:</tt> </tt>
<a name="L1368"></a><tt class="py-lineno">1368</tt>  <tt class="py-line">                <tt class="py-comment"># Name for the simulation object.</tt> </tt>
<a name="L1369"></a><tt class="py-lineno">1369</tt>  <tt class="py-line">                <tt class="py-name">sim_object_name</tt> <tt class="py-op">=</tt> <tt class="py-name">object_name</tt> <tt class="py-op">+</tt> <tt class="py-string">'_sim'</tt> </tt>
<a name="L1370"></a><tt class="py-lineno">1370</tt>  <tt class="py-line"> </tt>
<a name="L1371"></a><tt class="py-lineno">1371</tt>  <tt class="py-line">                <tt class="py-comment"># Create the simulation object.</tt> </tt>
<a name="L1372"></a><tt class="py-lineno">1372</tt>  <tt class="py-line">                <tt class="py-name">setattr</tt><tt class="py-op">(</tt><tt id="link-583" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-583', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">sim_object_name</tt><tt class="py-op">,</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1373"></a><tt class="py-lineno">1373</tt>  <tt class="py-line"> </tt>
<a name="L1374"></a><tt class="py-lineno">1374</tt>  <tt class="py-line">                <tt class="py-comment"># Get the simulation object.</tt> </tt>
<a name="L1375"></a><tt class="py-lineno">1375</tt>  <tt class="py-line">                <tt class="py-name">sim_object</tt> <tt class="py-op">=</tt> <tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt id="link-584" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-584', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">sim_object_name</tt><tt class="py-op">)</tt> </tt>
<a name="L1376"></a><tt class="py-lineno">1376</tt>  <tt class="py-line"> </tt>
<a name="L1377"></a><tt class="py-lineno">1377</tt>  <tt class="py-line">                <tt class="py-comment"># Loop over the simulations.</tt> </tt>
<a name="L1378"></a><tt class="py-lineno">1378</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">j</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">sim_number</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1379"></a><tt class="py-lineno">1379</tt>  <tt class="py-line">                    <tt class="py-comment"># Copy and append the data.</tt> </tt>
<a name="L1380"></a><tt class="py-lineno">1380</tt>  <tt class="py-line">                    <tt class="py-name">sim_object</tt><tt class="py-op">.</tt><tt id="link-585" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-585', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">deepcopy</tt><tt class="py-op">(</tt><tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt id="link-586" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-586', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">object_name</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
</div><a name="L1381"></a><tt class="py-lineno">1381</tt>  <tt class="py-line"> </tt>
<a name="L1382"></a><tt class="py-lineno">1382</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.sim_pack_data"></a><div id="Relax_disp.sim_pack_data-def"><a name="L1383"></a><tt class="py-lineno">1383</tt> <a class="py-toggle" href="#" id="Relax_disp.sim_pack_data-toggle" onclick="return toggle('Relax_disp.sim_pack_data');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#sim_pack_data">sim_pack_data</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">data_id</tt><tt class="py-op">,</tt> <tt class="py-param">sim_data</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.sim_pack_data-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.sim_pack_data-expanded"><a name="L1384"></a><tt class="py-lineno">1384</tt>  <tt class="py-line">        <tt class="py-docstring">"""Pack the Monte Carlo simulation data.</tt> </tt>
<a name="L1385"></a><tt class="py-lineno">1385</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1386"></a><tt class="py-lineno">1386</tt>  <tt class="py-line"><tt class="py-docstring">        @param data_id:     The tuple of the spin container and the exponential curve identifying key, as yielded by the base_data_loop() generator method.</tt> </tt>
<a name="L1387"></a><tt class="py-lineno">1387</tt>  <tt class="py-line"><tt class="py-docstring">        @type data_id:      SpinContainer instance and float</tt> </tt>
<a name="L1388"></a><tt class="py-lineno">1388</tt>  <tt class="py-line"><tt class="py-docstring">        @param sim_data:    The Monte Carlo simulation data.</tt> </tt>
<a name="L1389"></a><tt class="py-lineno">1389</tt>  <tt class="py-line"><tt class="py-docstring">        @type sim_data:     list of float</tt> </tt>
<a name="L1390"></a><tt class="py-lineno">1390</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L1391"></a><tt class="py-lineno">1391</tt>  <tt class="py-line"> </tt>
<a name="L1392"></a><tt class="py-lineno">1392</tt>  <tt class="py-line">        <tt class="py-comment"># The R2eff model (with peak intensity base data).</tt> </tt>
<a name="L1393"></a><tt class="py-lineno">1393</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-587" class="py-name"><a title="specific_analyses.api_base.API_base.model_type
specific_analyses.hybrid.Hybrid.model_type
specific_analyses.model_free.api.Model_free.model_type" class="py-name" href="#" onclick="return doclink('link-587', 'model_type', 'link-106');">model_type</a></tt> <tt class="py-op">==</tt> <tt id="link-588" class="py-name"><a title="lib.dispersion.variables.MODEL_R2EFF" class="py-name" href="#" onclick="return doclink('link-588', 'MODEL_R2EFF', 'link-14');">MODEL_R2EFF</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1394"></a><tt class="py-lineno">1394</tt>  <tt class="py-line">            <tt class="py-comment"># Unpack the data.</tt> </tt>
<a name="L1395"></a><tt class="py-lineno">1395</tt>  <tt class="py-line">            <tt id="link-589" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-589', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">exp_type</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt><tt class="py-op">,</tt> <tt id="link-590" class="py-name"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-590', 'offset', 'link-120');">offset</a></tt><tt class="py-op">,</tt> <tt class="py-name">point</tt> <tt class="py-op">=</tt> <tt class="py-name">data_id</tt> </tt>
<a name="L1396"></a><tt class="py-lineno">1396</tt>  <tt class="py-line"> </tt>
<a name="L1397"></a><tt class="py-lineno">1397</tt>  <tt class="py-line">            <tt class="py-comment"># Initialise the data structure if needed.</tt> </tt>
<a name="L1398"></a><tt class="py-lineno">1398</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-591" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-591', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'peak_intensity_sim'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1399"></a><tt class="py-lineno">1399</tt>  <tt class="py-line">                <tt id="link-592" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-592', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">peak_intensity_sim</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L1400"></a><tt class="py-lineno">1400</tt>  <tt class="py-line"> </tt>
<a name="L1401"></a><tt class="py-lineno">1401</tt>  <tt class="py-line">            <tt class="py-comment"># Loop over each time point.</tt> </tt>
<a name="L1402"></a><tt class="py-lineno">1402</tt>  <tt class="py-line">            <tt class="py-name">ti</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L1403"></a><tt class="py-lineno">1403</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">time</tt> <tt class="py-keyword">in</tt> <tt id="link-593" class="py-name"><a title="specific_analyses.relax_disp.data.loop_time" class="py-name" href="#" onclick="return doclink('link-593', 'loop_time', 'link-77');">loop_time</a></tt><tt class="py-op">(</tt><tt class="py-name">exp_type</tt><tt class="py-op">=</tt><tt class="py-name">exp_type</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt><tt class="py-op">=</tt><tt class="py-name">frq</tt><tt class="py-op">,</tt> <tt id="link-594" class="py-name"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-594', 'offset', 'link-120');">offset</a></tt><tt class="py-op">=</tt><tt id="link-595" class="py-name"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-595', 'offset', 'link-120');">offset</a></tt><tt class="py-op">,</tt> <tt class="py-name">point</tt><tt class="py-op">=</tt><tt class="py-name">point</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1404"></a><tt class="py-lineno">1404</tt>  <tt class="py-line">                <tt class="py-comment"># Get the intensity keys.</tt> </tt>
<a name="L1405"></a><tt class="py-lineno">1405</tt>  <tt class="py-line">                <tt class="py-name">int_keys</tt> <tt class="py-op">=</tt> <tt id="link-596" class="py-name"><a title="specific_analyses.relax_disp.data.find_intensity_keys" class="py-name" href="#" onclick="return doclink('link-596', 'find_intensity_keys', 'link-70');">find_intensity_keys</a></tt><tt class="py-op">(</tt><tt class="py-name">exp_type</tt><tt class="py-op">=</tt><tt class="py-name">exp_type</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt><tt class="py-op">=</tt><tt class="py-name">frq</tt><tt class="py-op">,</tt> <tt id="link-597" class="py-name"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-597', 'offset', 'link-120');">offset</a></tt><tt class="py-op">=</tt><tt id="link-598" class="py-name"><a title="gui.about.About_base.offset" class="py-name" href="#" onclick="return doclink('link-598', 'offset', 'link-120');">offset</a></tt><tt class="py-op">,</tt> <tt class="py-name">point</tt><tt class="py-op">=</tt><tt class="py-name">point</tt><tt class="py-op">,</tt> <tt class="py-name">time</tt><tt class="py-op">=</tt><tt class="py-name">time</tt><tt class="py-op">)</tt> </tt>
<a name="L1406"></a><tt class="py-lineno">1406</tt>  <tt class="py-line"> </tt>
<a name="L1407"></a><tt class="py-lineno">1407</tt>  <tt class="py-line">                <tt class="py-comment"># Loop over the intensity keys.</tt> </tt>
<a name="L1408"></a><tt class="py-lineno">1408</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">int_key</tt> <tt class="py-keyword">in</tt> <tt class="py-name">int_keys</tt><tt class="py-op">:</tt> </tt>
<a name="L1409"></a><tt class="py-lineno">1409</tt>  <tt class="py-line">                    <tt class="py-comment"># Test if the simulation data point already exists.</tt> </tt>
<a name="L1410"></a><tt class="py-lineno">1410</tt>  <tt class="py-line">                    <tt class="py-keyword">if</tt> <tt class="py-name">int_key</tt> <tt class="py-keyword">in</tt> <tt id="link-599" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-599', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">peak_intensity_sim</tt><tt class="py-op">:</tt> </tt>
<a name="L1411"></a><tt class="py-lineno">1411</tt>  <tt class="py-line">                        <tt class="py-keyword">raise</tt> <tt id="link-600" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-600', 'RelaxError', 'link-18');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Monte Carlo simulation data for the key '%s' already exists."</tt> <tt class="py-op">%</tt> <tt class="py-name">int_key</tt><tt class="py-op">)</tt> </tt>
<a name="L1412"></a><tt class="py-lineno">1412</tt>  <tt class="py-line"> </tt>
<a name="L1413"></a><tt class="py-lineno">1413</tt>  <tt class="py-line">                    <tt class="py-comment"># Initialise the list.</tt> </tt>
<a name="L1414"></a><tt class="py-lineno">1414</tt>  <tt class="py-line">                    <tt id="link-601" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-601', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">peak_intensity_sim</tt><tt class="py-op">[</tt><tt class="py-name">int_key</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L1415"></a><tt class="py-lineno">1415</tt>  <tt class="py-line"> </tt>
<a name="L1416"></a><tt class="py-lineno">1416</tt>  <tt class="py-line">                    <tt class="py-comment"># Loop over the simulations, appending the corresponding data.</tt> </tt>
<a name="L1417"></a><tt class="py-lineno">1417</tt>  <tt class="py-line">                    <tt class="py-keyword">for</tt> <tt id="link-602" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-602', 'i', 'link-201');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">sim_number</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1418"></a><tt class="py-lineno">1418</tt>  <tt class="py-line">                        <tt id="link-603" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-603', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">peak_intensity_sim</tt><tt class="py-op">[</tt><tt class="py-name">int_key</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-604" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-604', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">sim_data</tt><tt class="py-op">[</tt><tt id="link-605" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-605', 'i', 'link-201');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-name">ti</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1419"></a><tt class="py-lineno">1419</tt>  <tt class="py-line"> </tt>
<a name="L1420"></a><tt class="py-lineno">1420</tt>  <tt class="py-line">                <tt class="py-comment"># Increment the time index.</tt> </tt>
<a name="L1421"></a><tt class="py-lineno">1421</tt>  <tt class="py-line">                <tt class="py-name">ti</tt> <tt class="py-op">+=</tt> <tt class="py-number">1</tt> </tt>
<a name="L1422"></a><tt class="py-lineno">1422</tt>  <tt class="py-line"> </tt>
<a name="L1423"></a><tt class="py-lineno">1423</tt>  <tt class="py-line">        <tt class="py-comment"># All other models (with R2eff/R1rho base data).</tt> </tt>
<a name="L1424"></a><tt class="py-lineno">1424</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1425"></a><tt class="py-lineno">1425</tt>  <tt class="py-line">            <tt class="py-comment"># Unpack the data.</tt> </tt>
<a name="L1426"></a><tt class="py-lineno">1426</tt>  <tt class="py-line">            <tt id="link-606" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-606', 'spin', 'link-115');">spin</a></tt><tt class="py-op">,</tt> <tt id="link-607" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-607', 'spin_id', 'link-126');">spin_id</a></tt> <tt class="py-op">=</tt> <tt class="py-name">data_id</tt> </tt>
<a name="L1427"></a><tt class="py-lineno">1427</tt>  <tt class="py-line"> </tt>
<a name="L1428"></a><tt class="py-lineno">1428</tt>  <tt class="py-line">            <tt class="py-comment"># 1H MMQ flag.</tt> </tt>
<a name="L1429"></a><tt class="py-lineno">1429</tt>  <tt class="py-line">            <tt class="py-name">proton_mmq_flag</tt> <tt class="py-op">=</tt> <tt id="link-608" class="py-name"><a title="specific_analyses.relax_disp.data.has_proton_mmq_cpmg" class="py-name" href="#" onclick="return doclink('link-608', 'has_proton_mmq_cpmg', 'link-73');">has_proton_mmq_cpmg</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1430"></a><tt class="py-lineno">1430</tt>  <tt class="py-line"> </tt>
<a name="L1431"></a><tt class="py-lineno">1431</tt>  <tt class="py-line">            <tt class="py-comment"># Get the attached proton.</tt> </tt>
<a name="L1432"></a><tt class="py-lineno">1432</tt>  <tt class="py-line">            <tt class="py-name">proton</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L1433"></a><tt class="py-lineno">1433</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">proton_mmq_flag</tt><tt class="py-op">:</tt> </tt>
<a name="L1434"></a><tt class="py-lineno">1434</tt>  <tt class="py-line">                <tt class="py-name">proton</tt> <tt class="py-op">=</tt> <tt id="link-609" class="py-name"><a title="pipe_control.sequence.return_attached_protons" class="py-name" href="#" onclick="return doclink('link-609', 'return_attached_protons', 'link-54');">return_attached_protons</a></tt><tt class="py-op">(</tt><tt id="link-610" class="py-name"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-610', 'spin_id', 'link-126');">spin_id</a></tt><tt class="py-op">)</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L1435"></a><tt class="py-lineno">1435</tt>  <tt class="py-line"> </tt>
<a name="L1436"></a><tt class="py-lineno">1436</tt>  <tt class="py-line">            <tt class="py-comment"># Pack the data.</tt> </tt>
<a name="L1437"></a><tt class="py-lineno">1437</tt>  <tt class="py-line">            <tt id="link-611" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-611', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">r2eff_sim</tt> <tt class="py-op">=</tt> <tt class="py-name">sim_data</tt> </tt>
<a name="L1438"></a><tt class="py-lineno">1438</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">proton</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L1439"></a><tt class="py-lineno">1439</tt>  <tt class="py-line">                <tt class="py-name">proton</tt><tt class="py-op">.</tt><tt class="py-name">r2eff_sim</tt> <tt class="py-op">=</tt> <tt class="py-name">sim_data</tt> </tt>
</div><a name="L1440"></a><tt class="py-lineno">1440</tt>  <tt class="py-line"> </tt>
<a name="L1441"></a><tt class="py-lineno">1441</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.sim_return_param"></a><div id="Relax_disp.sim_return_param-def"><a name="L1442"></a><tt class="py-lineno">1442</tt> <a class="py-toggle" href="#" id="Relax_disp.sim_return_param-toggle" onclick="return toggle('Relax_disp.sim_return_param');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#sim_return_param">sim_return_param</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">index</tt><tt class="py-op">,</tt> <tt class="py-param">model_info</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.sim_return_param-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.sim_return_param-expanded"><a name="L1443"></a><tt class="py-lineno">1443</tt>  <tt class="py-line">        <tt class="py-docstring">"""Return the array of simulation parameter values.</tt> </tt>
<a name="L1444"></a><tt class="py-lineno">1444</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1445"></a><tt class="py-lineno">1445</tt>  <tt class="py-line"><tt class="py-docstring">        @param index:           The index of the parameter to return the array of values for.</tt> </tt>
<a name="L1446"></a><tt class="py-lineno">1446</tt>  <tt class="py-line"><tt class="py-docstring">        @type index:            int</tt> </tt>
<a name="L1447"></a><tt class="py-lineno">1447</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword model_info:    The list of spins and spin IDs per cluster originating from model_loop().</tt> </tt>
<a name="L1448"></a><tt class="py-lineno">1448</tt>  <tt class="py-line"><tt class="py-docstring">        @type model_info:       list of SpinContainer instances, list of str</tt> </tt>
<a name="L1449"></a><tt class="py-lineno">1449</tt>  <tt class="py-line"><tt class="py-docstring">        @return:                The array of simulation parameter values.</tt> </tt>
<a name="L1450"></a><tt class="py-lineno">1450</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:                 list of float</tt> </tt>
<a name="L1451"></a><tt class="py-lineno">1451</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L1452"></a><tt class="py-lineno">1452</tt>  <tt class="py-line"> </tt>
<a name="L1453"></a><tt class="py-lineno">1453</tt>  <tt class="py-line">        <tt class="py-comment"># Unpack the data.</tt> </tt>
<a name="L1454"></a><tt class="py-lineno">1454</tt>  <tt class="py-line">        <tt class="py-name">spin_ids</tt> <tt class="py-op">=</tt> <tt class="py-name">model_info</tt> </tt>
<a name="L1455"></a><tt class="py-lineno">1455</tt>  <tt class="py-line">        <tt class="py-name">spins</tt> <tt class="py-op">=</tt> <tt id="link-612" class="py-name"><a title="specific_analyses.relax_disp.data.spin_ids_to_containers" class="py-name" href="#" onclick="return doclink('link-612', 'spin_ids_to_containers', 'link-80');">spin_ids_to_containers</a></tt><tt class="py-op">(</tt><tt class="py-name">spin_ids</tt><tt class="py-op">)</tt> </tt>
<a name="L1456"></a><tt class="py-lineno">1456</tt>  <tt class="py-line"> </tt>
<a name="L1457"></a><tt class="py-lineno">1457</tt>  <tt class="py-line">        <tt class="py-comment"># The number of parameters.</tt> </tt>
<a name="L1458"></a><tt class="py-lineno">1458</tt>  <tt class="py-line">        <tt class="py-name">total_param_num</tt> <tt class="py-op">=</tt> <tt id="link-613" class="py-name"><a title="specific_analyses.frame_order.parameters.param_num
specific_analyses.n_state_model.parameters.param_num
specific_analyses.relax_disp.parameters.param_num" class="py-name" href="#" onclick="return doclink('link-613', 'param_num', 'link-101');">param_num</a></tt><tt class="py-op">(</tt><tt class="py-name">spins</tt><tt class="py-op">=</tt><tt class="py-name">spins</tt><tt class="py-op">)</tt> </tt>
<a name="L1459"></a><tt class="py-lineno">1459</tt>  <tt class="py-line"> </tt>
<a name="L1460"></a><tt class="py-lineno">1460</tt>  <tt class="py-line">        <tt class="py-comment"># No more model parameters.</tt> </tt>
<a name="L1461"></a><tt class="py-lineno">1461</tt>  <tt class="py-line">        <tt class="py-name">model_param</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L1462"></a><tt class="py-lineno">1462</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">index</tt> <tt class="py-op">&gt;=</tt> <tt class="py-name">total_param_num</tt><tt class="py-op">:</tt> </tt>
<a name="L1463"></a><tt class="py-lineno">1463</tt>  <tt class="py-line">            <tt class="py-name">model_param</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L1464"></a><tt class="py-lineno">1464</tt>  <tt class="py-line"> </tt>
<a name="L1465"></a><tt class="py-lineno">1465</tt>  <tt class="py-line">        <tt class="py-comment"># The auxiliary cluster parameters.</tt> </tt>
<a name="L1466"></a><tt class="py-lineno">1466</tt>  <tt class="py-line">        <tt class="py-name">aux_params</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L1467"></a><tt class="py-lineno">1467</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-614" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-614', 'spin', 'link-115');">spin</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">spins</tt><tt class="py-op">:</tt> </tt>
<a name="L1468"></a><tt class="py-lineno">1468</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-615" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-615', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-616" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-616', 'select', 'link-118');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1469"></a><tt class="py-lineno">1469</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L1470"></a><tt class="py-lineno">1470</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-string">'pA'</tt> <tt class="py-keyword">in</tt> <tt id="link-617" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-617', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-618" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.params
gui.analyses.auto_model_free.Mf_list.params
gui.analyses.auto_relax_disp.Disp_model_list.params
gui.analyses.elements.model_list.Model_list.params" class="py-name" href="#" onclick="return doclink('link-618', 'params', 'link-494');">params</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1471"></a><tt class="py-lineno">1471</tt>  <tt class="py-line">                <tt class="py-name">aux_params</tt><tt class="py-op">.</tt><tt id="link-619" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-619', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt class="py-string">'pB'</tt><tt class="py-op">)</tt> </tt>
<a name="L1472"></a><tt class="py-lineno">1472</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-string">'pB'</tt> <tt class="py-keyword">in</tt> <tt id="link-620" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-620', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-621" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.params
gui.analyses.auto_model_free.Mf_list.params
gui.analyses.auto_relax_disp.Disp_model_list.params
gui.analyses.elements.model_list.Model_list.params" class="py-name" href="#" onclick="return doclink('link-621', 'params', 'link-494');">params</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1473"></a><tt class="py-lineno">1473</tt>  <tt class="py-line">                <tt class="py-name">aux_params</tt><tt class="py-op">.</tt><tt id="link-622" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-622', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt class="py-string">'pA'</tt><tt class="py-op">)</tt> </tt>
<a name="L1474"></a><tt class="py-lineno">1474</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-string">'kex'</tt> <tt class="py-keyword">in</tt> <tt id="link-623" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-623', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-624" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.params
gui.analyses.auto_model_free.Mf_list.params
gui.analyses.auto_relax_disp.Disp_model_list.params
gui.analyses.elements.model_list.Model_list.params" class="py-name" href="#" onclick="return doclink('link-624', 'params', 'link-494');">params</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1475"></a><tt class="py-lineno">1475</tt>  <tt class="py-line">                <tt class="py-name">aux_params</tt><tt class="py-op">.</tt><tt id="link-625" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-625', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt class="py-string">'tex'</tt><tt class="py-op">)</tt> </tt>
<a name="L1476"></a><tt class="py-lineno">1476</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-string">'tex'</tt> <tt class="py-keyword">in</tt> <tt id="link-626" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-626', 'spin', 'link-115');">spin</a></tt><tt class="py-op">.</tt><tt id="link-627" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.params
gui.analyses.auto_model_free.Mf_list.params
gui.analyses.auto_relax_disp.Disp_model_list.params
gui.analyses.elements.model_list.Model_list.params" class="py-name" href="#" onclick="return doclink('link-627', 'params', 'link-494');">params</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1477"></a><tt class="py-lineno">1477</tt>  <tt class="py-line">                <tt class="py-name">aux_params</tt><tt class="py-op">.</tt><tt id="link-628" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-628', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt class="py-string">'kex'</tt><tt class="py-op">)</tt> </tt>
<a name="L1478"></a><tt class="py-lineno">1478</tt>  <tt class="py-line">            <tt class="py-keyword">break</tt> </tt>
<a name="L1479"></a><tt class="py-lineno">1479</tt>  <tt class="py-line"> </tt>
<a name="L1480"></a><tt class="py-lineno">1480</tt>  <tt class="py-line">        <tt class="py-comment"># No more auxiliary parameters.</tt> </tt>
<a name="L1481"></a><tt class="py-lineno">1481</tt>  <tt class="py-line">        <tt class="py-name">total_aux_num</tt> <tt class="py-op">=</tt> <tt class="py-name">total_param_num</tt> <tt class="py-op">+</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">aux_params</tt><tt class="py-op">)</tt> </tt>
<a name="L1482"></a><tt class="py-lineno">1482</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">index</tt> <tt class="py-op">&gt;=</tt> <tt class="py-name">total_aux_num</tt><tt class="py-op">:</tt> </tt>
<a name="L1483"></a><tt class="py-lineno">1483</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
<a name="L1484"></a><tt class="py-lineno">1484</tt>  <tt class="py-line"> </tt>
<a name="L1485"></a><tt class="py-lineno">1485</tt>  <tt class="py-line">        <tt class="py-comment"># Convert the parameter index.</tt> </tt>
<a name="L1486"></a><tt class="py-lineno">1486</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">model_param</tt><tt class="py-op">:</tt> </tt>
<a name="L1487"></a><tt class="py-lineno">1487</tt>  <tt class="py-line">            <tt class="py-name">param_name</tt><tt class="py-op">,</tt> <tt class="py-name">si</tt><tt class="py-op">,</tt> <tt class="py-name">mi</tt> <tt class="py-op">=</tt> <tt id="link-629" class="py-name"><a title="specific_analyses.relax_disp.parameters.param_index_to_param_info" class="py-name" href="#" onclick="return doclink('link-629', 'param_index_to_param_info', 'link-100');">param_index_to_param_info</a></tt><tt class="py-op">(</tt><tt class="py-name">index</tt><tt class="py-op">=</tt><tt class="py-name">index</tt><tt class="py-op">,</tt> <tt class="py-name">spins</tt><tt class="py-op">=</tt><tt class="py-name">spins</tt><tt class="py-op">)</tt> </tt>
<a name="L1488"></a><tt class="py-lineno">1488</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">param_name</tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt class="py-string">'r2eff'</tt><tt class="py-op">,</tt> <tt class="py-string">'i0'</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L1489"></a><tt class="py-lineno">1489</tt>  <tt class="py-line">                <tt class="py-name">si</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L1490"></a><tt class="py-lineno">1490</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1491"></a><tt class="py-lineno">1491</tt>  <tt class="py-line">            <tt class="py-name">param_name</tt> <tt class="py-op">=</tt> <tt class="py-name">aux_params</tt><tt class="py-op">[</tt><tt class="py-name">index</tt> <tt class="py-op">-</tt> <tt class="py-name">total_param_num</tt><tt class="py-op">]</tt> </tt>
<a name="L1492"></a><tt class="py-lineno">1492</tt>  <tt class="py-line">            <tt class="py-name">si</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L1493"></a><tt class="py-lineno">1493</tt>  <tt class="py-line">            <tt class="py-name">mi</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L1494"></a><tt class="py-lineno">1494</tt>  <tt class="py-line"> </tt>
<a name="L1495"></a><tt class="py-lineno">1495</tt>  <tt class="py-line">        <tt class="py-comment"># The exponential curve parameters.</tt> </tt>
<a name="L1496"></a><tt class="py-lineno">1496</tt>  <tt class="py-line">        <tt class="py-name">sim_data</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L1497"></a><tt class="py-lineno">1497</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">param_name</tt> <tt class="py-op">==</tt> <tt class="py-string">'r2eff'</tt><tt class="py-op">:</tt> </tt>
<a name="L1498"></a><tt class="py-lineno">1498</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-630" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-630', 'i', 'link-201');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">sim_number</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1499"></a><tt class="py-lineno">1499</tt>  <tt class="py-line">                <tt class="py-name">sim_data</tt><tt class="py-op">.</tt><tt id="link-631" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-631', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">spins</tt><tt class="py-op">[</tt><tt class="py-name">si</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">r2eff_sim</tt><tt class="py-op">[</tt><tt id="link-632" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-632', 'i', 'link-201');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1500"></a><tt class="py-lineno">1500</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">param_name</tt> <tt class="py-op">==</tt> <tt class="py-string">'i0'</tt><tt class="py-op">:</tt> </tt>
<a name="L1501"></a><tt class="py-lineno">1501</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-633" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-633', 'i', 'link-201');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">sim_number</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1502"></a><tt class="py-lineno">1502</tt>  <tt class="py-line">                <tt class="py-name">sim_data</tt><tt class="py-op">.</tt><tt id="link-634" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-634', 'append', 'link-174');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">spins</tt><tt class="py-op">[</tt><tt class="py-name">si</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">i0_sim</tt><tt class="py-op">[</tt><tt id="link-635" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-635', 'i', 'link-201');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1503"></a><tt class="py-lineno">1503</tt>  <tt class="py-line"> </tt>
<a name="L1504"></a><tt class="py-lineno">1504</tt>  <tt class="py-line">        <tt class="py-comment"># Model and auxiliary parameters.</tt> </tt>
<a name="L1505"></a><tt class="py-lineno">1505</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1506"></a><tt class="py-lineno">1506</tt>  <tt class="py-line">            <tt class="py-name">sim_data</tt> <tt class="py-op">=</tt> <tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt class="py-name">spins</tt><tt class="py-op">[</tt><tt class="py-name">si</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">param_name</tt> <tt class="py-op">+</tt> <tt class="py-string">"_sim"</tt><tt class="py-op">)</tt> </tt>
<a name="L1507"></a><tt class="py-lineno">1507</tt>  <tt class="py-line"> </tt>
<a name="L1508"></a><tt class="py-lineno">1508</tt>  <tt class="py-line">        <tt class="py-comment"># Set the sim data to None if empty.</tt> </tt>
<a name="L1509"></a><tt class="py-lineno">1509</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">sim_data</tt> <tt class="py-op">==</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L1510"></a><tt class="py-lineno">1510</tt>  <tt class="py-line">            <tt class="py-name">sim_data</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L1511"></a><tt class="py-lineno">1511</tt>  <tt class="py-line"> </tt>
<a name="L1512"></a><tt class="py-lineno">1512</tt>  <tt class="py-line">        <tt class="py-comment"># Return the object.</tt> </tt>
<a name="L1513"></a><tt class="py-lineno">1513</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">sim_data</tt> </tt>
</div><a name="L1514"></a><tt class="py-lineno">1514</tt>  <tt class="py-line"> </tt>
<a name="L1515"></a><tt class="py-lineno">1515</tt>  <tt class="py-line"> </tt>
<a name="Relax_disp.sim_return_selected"></a><div id="Relax_disp.sim_return_selected-def"><a name="L1516"></a><tt class="py-lineno">1516</tt> <a class="py-toggle" href="#" id="Relax_disp.sim_return_selected-toggle" onclick="return toggle('Relax_disp.sim_return_selected');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.relax_disp.api.Relax_disp-class.html#sim_return_selected">sim_return_selected</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">model_info</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Relax_disp.sim_return_selected-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Relax_disp.sim_return_selected-expanded"><a name="L1517"></a><tt class="py-lineno">1517</tt>  <tt class="py-line">        <tt class="py-docstring">"""Return the array of selected simulation flags.</tt> </tt>
<a name="L1518"></a><tt class="py-lineno">1518</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1519"></a><tt class="py-lineno">1519</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword model_info:    The list of spins and spin IDs per cluster originating from model_loop().</tt> </tt>
<a name="L1520"></a><tt class="py-lineno">1520</tt>  <tt class="py-line"><tt class="py-docstring">        @type model_info:       list of SpinContainer instances, list of str</tt> </tt>
<a name="L1521"></a><tt class="py-lineno">1521</tt>  <tt class="py-line"><tt class="py-docstring">        @return:                The array of selected simulation flags.</tt> </tt>
<a name="L1522"></a><tt class="py-lineno">1522</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:                 list of int</tt> </tt>
<a name="L1523"></a><tt class="py-lineno">1523</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L1524"></a><tt class="py-lineno">1524</tt>  <tt class="py-line"> </tt>
<a name="L1525"></a><tt class="py-lineno">1525</tt>  <tt class="py-line">        <tt class="py-comment"># Unpack the data.</tt> </tt>
<a name="L1526"></a><tt class="py-lineno">1526</tt>  <tt class="py-line">        <tt class="py-name">spin_ids</tt> <tt class="py-op">=</tt> <tt class="py-name">model_info</tt> </tt>
<a name="L1527"></a><tt class="py-lineno">1527</tt>  <tt class="py-line">        <tt class="py-name">spins</tt> <tt class="py-op">=</tt> <tt id="link-636" class="py-name"><a title="specific_analyses.relax_disp.data.spin_ids_to_containers" class="py-name" href="#" onclick="return doclink('link-636', 'spin_ids_to_containers', 'link-80');">spin_ids_to_containers</a></tt><tt class="py-op">(</tt><tt class="py-name">spin_ids</tt><tt class="py-op">)</tt> </tt>
<a name="L1528"></a><tt class="py-lineno">1528</tt>  <tt class="py-line"> </tt>
<a name="L1529"></a><tt class="py-lineno">1529</tt>  <tt class="py-line">        <tt class="py-comment"># Return the array from the first spin, as this array will be identical for all spins in the cluster.</tt> </tt>
<a name="L1530"></a><tt class="py-lineno">1530</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">spins</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">select_sim</tt> </tt>
</div></div><a name="L1531"></a><tt class="py-lineno">1531</tt>  <tt class="py-line"> </tt><script type="text/javascript">
<!--
expandto(location.href);
// -->
</script>
</pre>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://www.nmr-relax.com">relax</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Wed Dec  3 18:49:18 2014
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
