<!-- MHonArc v2.6.16 -->
<!--X-Subject: [bug #12573] FAIL: Model&#45;free optimisation {S2=0.970,	te=2048 Rex=0.149} -->
<!--X-From-R13: Sqjneq q  Ohiretar <@A&#45;DSBZK.W@HOZWR&#45;ORRDSEENtan.bet> -->
<!--X-Date: Thu, 11 Dec 2008 17:13:31 +0100 -->
<!--X-Message-Id: 20081211&#45;161330.sv2782.22542@gna.org -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20081106&#45;015247.sv13259.5623@gna.org -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>[bug #12573] FAIL: Model-free optimisation {S2=0.970,	te=2048 Rex=0.149} -- December 11, 2008 - 17:13</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />[bug #12573] FAIL: Model-free optimisation {S2=0.970,	te=2048 Rex=0.149}</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00037" class="tabs">Index by Date</a> | <a href="threads.html#00037" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00036.html">Date Prev</a>] [<a href="msg00038.html">Date Next</a>] [<a href="msg00036.html">Thread Prev</a>] [<a href="msg00038.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Edward d  Auvergne &lt;edward@xxxxxxxxxxxxx&gt;,	Jack Howarth &lt;jhowarth@xxxxxxxxxxxx&gt;, relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Date</em>: Thu, 11 Dec 2008 17:13:30 +0100</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00037.html">20081211-161330.sv2782.22542@gna.org</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;20081106-015247.sv13259.5623@xxxxxxx&gt;</li>
<li class="menuitem">
<em>User-agent</em>: Mozilla/5.0 (X11; U; Linux x86_64; en-US;	rv:1.9.0.1) Gecko/2008072403 Mandriva/3.0.1-1mdv2008.1 (2008.1)	Firefox/3.0.1</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d Auvergne</strong> on December 11, 2008 - 17:13:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">

Update of bug #12573 (project relax):

             Assigned to:                    None =&gt; bugman                 
                 Summary: FAIL: Constrained BFGS opt, backtracking line
search {S2=0.970, te=2048 Rex=0.149} =&gt; FAIL: Model-free optimisation
{S2=0.970, te=2048 Rex=0.149}

    _______________________________________________________

Follow-up Comment #1:

The bug found in the test suite is actually not as stated.  The print out
actually after the failure message.  This bug has also been expanded to all
the optimisation failures on the PowerPC.  The print outs are from Jack's
email at <a  rel="nofollow" href="/mail.gna.org/public/relax-users/2008-10/msg00089.html">https://mail.gna.org/public/relax-users/2008-10/msg00089.html</a>
(Message-id: &lt;20081024141150.GA879@xxxxxxxxxxxxxxxxx&gt;):


======================================================================
FAIL: Constrained BFGS opt, backtracking line search {S2=0.970, te=2048,
Rex=0.149}
----------------------------------------------------------------------

relax&gt; pipe.create(pipe_name='mf', pipe_type='mf')

relax&gt; sequence.read(file='noe.500.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/noe.500.out'
for reading.
Mol_name   Res_num    Res_name   Spin_num   Spin_name
None       1          GLY        None       None
None       2          ALA        None       None

relax&gt; relax_data.read(ri_label='R1', frq_label='600', frq=600000000.0,
file='r1.600.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/r1.600.out'
for reading.

relax&gt; relax_data.read(ri_label='R2', frq_label='600', frq=600000000.0,
file='r2.600.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/r2.600.out'
for reading.

relax&gt; relax_data.read(ri_label='NOE', frq_label='600', frq=600000000.0,
file='noe.600.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/noe.600.out'
for reading.

relax&gt; relax_data.read(ri_label='R1', frq_label='500', frq=500000000.0,
file='r1.500.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/r1.500.out'
for reading.

relax&gt; relax_data.read(ri_label='R2', frq_label='500', frq=500000000.0,
file='r2.500.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/r2.500.out'
for reading.

relax&gt; relax_data.read(ri_label='NOE', frq_label='500', frq=500000000.0,
file='noe.500.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/noe.500.out'
for reading.

relax&gt; diffusion_tensor.init(params=1e-08, time_scale=1.0, d_scale=1.0,
angle_units='deg', param_types=0, spheroid_type=None, fixed=True)

relax&gt; value.set(val=1.0200000000000001e-10, param='bond_length',
spin_id=None)

relax&gt; value.set(val=-0.00015999999999999999, param='csa', spin_id=None)

relax&gt; value.set(val='15N', param='heteronucleus', spin_id=None)

relax&gt; value.set(val='1H', param='proton', spin_id=None)

relax&gt; model_free.select_model(model='m4', spin_id=None)

relax&gt; value.set(val=[1.0, 0.0, 0.0], param=['S2', 'te', 'Rex'],
spin_id=None)

relax&gt; minimise(*args=('bfgs', 'back'), func_tol=1e-25,
max_iterations=10000000, constraints=True, scaling=True, verbosity=1)
Only the model-free parameters for single spins will be used.


Fitting to spin ':2&amp;:ALA'
~~~~~~~~~~~~~~~~~~~~~~~~


Method of Multipliers
~~~~~~~~~~~~~~~~~~~~

k: 0       xk: array([ 1.,  0.,  0.])                                        
  fk: 3.9844117908982288
Entering sub-algorithm.

       Quasi-Newton BFGS minimisation
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
       Line search:  Backtracking line search.

       k: 0       xk: array([ 1.,  0.,  0.])                                 
          fk: 3.9844117908982288

       Parameter values: array([  0.90905502,  74.36929555,   1.22310091])
       Function value:   -1447.7789206950388
       Iterations:       37
       Function calls:   93
       Gradient calls:   38
       Hessian calls:    0
       Warning:          None


k: 1       xk: array([  0.90905502,  74.36929555,   1.22310091])             
  fk: 48.121412825285702
Entering sub-algorithm.

       Quasi-Newton BFGS minimisation
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
       Line search:  Backtracking line search.

       k: 0       xk: array([  0.90905502,  74.36929555,   1.22310091])      
          fk: 46.071579585447914

       Parameter values: array([  9.89561039e-01,   4.08922110e+02,  
1.27899123e-01])
       Function value:   1.5767185057428068
       Iterations:       38
       Function calls:   259
       Gradient calls:   39
       Hessian calls:    0
       Warning:          None


k: 2       xk: array([  9.89561039e-01,   4.08922110e+02,   1.27899123e-01]) 
  fk: 3.626551745580596
Entering sub-algorithm.

       Quasi-Newton BFGS minimisation
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
       Line search:  Backtracking line search.

       k: 0       xk: array([  9.89561039e-01,   4.08922110e+02,  
1.27899123e-01])     fk: 3.626551745580596

       Parameter values: array([  9.74034731e-01,   8.37698106e+02,  
1.23106917e-01])
       Function value:   2.1800782005407622
       Iterations:       31
       Function calls:   201
       Gradient calls:   32
       Hessian calls:    0
       Warning:          None


k: 3       xk: array([  9.74034731e-01,   8.37698106e+02,   1.23106917e-01]) 
  fk: 2.1800782005407622
Entering sub-algorithm.

       Quasi-Newton BFGS minimisation
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
       Line search:  Backtracking line search.

       k: 0       xk: array([  9.74034731e-01,   8.37698106e+02,  
1.23106917e-01])     fk: 2.1800782005407622

       Parameter values: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])
       Function value:   7.5991121570503778e-22
       Iterations:       42
       Function calls:   98
       Gradient calls:   43
       Hessian calls:    0
       Warning:          None


k: 4       xk: array([  9.70000000e-01,   2.04800000e+03,   1.49000000e-01]) 
  fk: 7.5991121570503778e-22
Entering sub-algorithm.

       Quasi-Newton BFGS minimisation
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
       Line search:  Backtracking line search.

       k: 0       xk: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])     fk: 7.5991121570503778e-22

       Parameter values: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])
       Function value:   1.9022883080402212e-24
       Iterations:       6
       Function calls:   26
       Gradient calls:   7
       Hessian calls:    0
       Warning:          None


k: 5       xk: array([  9.70000000e-01,   2.04800000e+03,   1.49000000e-01]) 
  fk: 1.9022883080402212e-24
Entering sub-algorithm.

       Quasi-Newton BFGS minimisation
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
       Line search:  Backtracking line search.

       k: 0       xk: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])     fk: 1.9022883080402212e-24

       Parameter values: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])
       Function value:   1.8533903598853284e-24
       Iterations:       2
       Function calls:   18
       Gradient calls:   3
       Hessian calls:    0
       Warning:          None


Parameter values: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])
Function value:   1.8533903598853284e-24
Iterations:       156
Function calls:   695
Gradient calls:   162
Hessian calls:    0
Warning:          None

Traceback (most recent call last):
 File &quot;/sw/lib/relax-py25/test_suite/system_tests/model_free.py&quot;, line 301,
in test_opt_constr_bfgs_back_S2_0_970_te_2048_Rex_0_149
   self.value_test(spin, select, s2, te, rex, chi2, iter, f_count, g_count,
h_count, warning)
 File &quot;/sw/lib/relax-py25/test_suite/system_tests/model_free.py&quot;, line 1046,
in value_test
   self.assertEqual(spin.iter, iter, msg=mesg)
AssertionError: Optimisation failure.

System: Darwin
Release: 9.5.0
Version: Darwin Kernel Version 9.5.0: Wed Sep  3 11:31:44 PDT 2008;
root:xnu-1228.7.58~1/RELEASE_PPC
Win32 version:
Distribution:
Architecture: 32bit
Machine: Power Macintosh
Processor: powerpc
Python version: 2.5.2
numpy version: 1.1.1


s2:       0.9699999999999861
te:       2047.9999999978033
rex:      0.14900000000028032
chi2:     1.8533903598853284e-24
iter:     156
f_count:  695
g_count:  162
h_count:  0
warning:  None

======================================================================
FAIL: Constrained BFGS opt, More and Thuente line search {S2=0.970, te=2048,
Rex=0.149}
----------------------------------------------------------------------

relax&gt; pipe.create(pipe_name='mf', pipe_type='mf')

relax&gt; sequence.read(file='noe.500.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/noe.500.out'
for reading.
Mol_name   Res_num    Res_name   Spin_num   Spin_name
None       1          GLY        None       None
None       2          ALA        None       None

relax&gt; relax_data.read(ri_label='R1', frq_label='600', frq=600000000.0,
file='r1.600.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/r1.600.out'
for reading.

relax&gt; relax_data.read(ri_label='R2', frq_label='600', frq=600000000.0,
file='r2.600.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/r2.600.out'
for reading.

relax&gt; relax_data.read(ri_label='NOE', frq_label='600', frq=600000000.0,
file='noe.600.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/noe.600.out'
for reading.

relax&gt; relax_data.read(ri_label='R1', frq_label='500', frq=500000000.0,
file='r1.500.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/r1.500.out'
for reading.

relax&gt; relax_data.read(ri_label='R2', frq_label='500', frq=500000000.0,
file='r2.500.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/r2.500.out'
for reading.

relax&gt; relax_data.read(ri_label='NOE', frq_label='500', frq=500000000.0,
file='noe.500.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/noe.500.out'
for reading.

relax&gt; diffusion_tensor.init(params=1e-08, time_scale=1.0, d_scale=1.0,
angle_units='deg', param_types=0, spheroid_type=None, fixed=True)

relax&gt; value.set(val=1.0200000000000001e-10, param='bond_length',
spin_id=None)

relax&gt; value.set(val=-0.00015999999999999999, param='csa', spin_id=None)

relax&gt; value.set(val='15N', param='heteronucleus', spin_id=None)

relax&gt; value.set(val='1H', param='proton', spin_id=None)

relax&gt; model_free.select_model(model='m4', spin_id=None)

relax&gt; value.set(val=[1.0, 0.0, 0.0], param=['S2', 'te', 'Rex'],
spin_id=None)

relax&gt; minimise(*args=('bfgs', 'mt'), func_tol=1e-25,
max_iterations=10000000, constraints=True, scaling=True, verbosity=1)
Only the model-free parameters for single spins will be used.


Fitting to spin ':2&amp;:ALA'
~~~~~~~~~~~~~~~~~~~~~~~~


Method of Multipliers
~~~~~~~~~~~~~~~~~~~~

k: 0       xk: array([ 1.,  0.,  0.])                                        
  fk: 3.9844117908982288
Entering sub-algorithm.

       Quasi-Newton BFGS minimisation
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
       Line search:  More and Thuente line search.

       k: 0       xk: array([ 1.,  0.,  0.])                                 
          fk: 3.9844117908982288

       Parameter values: array([  0.90905506,  74.36943011,   1.22310156])
       Function value:   -1447.7789206948671
       Iterations:       22
       Function calls:   50
       Gradient calls:   50
       Hessian calls:    0
       Warning:          None


k: 1       xk: array([  0.90905506,  74.36943011,   1.22310156])             
  fk: 48.121371716752257
Entering sub-algorithm.

       Quasi-Newton BFGS minimisation
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
       Line search:  More and Thuente line search.

       k: 0       xk: array([  0.90905506,  74.36943011,   1.22310156])      
          fk: 46.071517922561874

       Parameter values: array([  9.94936631e-01,   8.81385060e+01, 
-3.79281070e-05])
       Function value:   1.9644199905707935
       Iterations:       38
       Function calls:   128
       Gradient calls:   128
       Hessian calls:    0
       Warning:          The gradient at point 0 of this line search is
positive, ie p is not a descent direction and the line search will not work.
(fatal minimisation error).


k: 2       xk: array([  9.94936631e-01,   8.81385060e+01,  -3.79281070e-05]) 
  fk: 144.63923664803443
Entering sub-algorithm.

       Quasi-Newton BFGS minimisation
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
       Line search:  More and Thuente line search.

       k: 0       xk: array([  9.94936631e-01,   8.81385060e+01, 
-3.79281070e-05])     fk: 4.0147053471508878

       Parameter values: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])
       Function value:   -7.1927064951510456e-05
       Iterations:       56
       Function calls:   129
       Gradient calls:   129
       Hessian calls:    0
       Warning:          None


k: 3       xk: array([  9.70000000e-01,   2.04800000e+03,   1.49000000e-01]) 
  fk: 1.6264773549380294e-20
Entering sub-algorithm.

       Quasi-Newton BFGS minimisation
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
       Line search:  More and Thuente line search.

       k: 0       xk: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])     fk: 1.6264773549380294e-20

       Parameter values: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])
       Function value:   2.6808864830250424e-21
       Iterations:       1
       Function calls:   4
       Gradient calls:   4
       Hessian calls:    0
       Warning:          None


k: 4       xk: array([  9.70000000e-01,   2.04800000e+03,   1.49000000e-01]) 
  fk: 2.6808864830250424e-21
Entering sub-algorithm.

       Quasi-Newton BFGS minimisation
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
       Line search:  More and Thuente line search.

       k: 0       xk: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])     fk: 2.6808864830250424e-21

       Parameter values: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])
       Function value:   4.8056261450870388e-23
       Iterations:       2
       Function calls:   7
       Gradient calls:   7
       Hessian calls:    0
       Warning:          None


k: 5       xk: array([  9.70000000e-01,   2.04800000e+03,   1.49000000e-01]) 
  fk: 4.8056261450870388e-23
Entering sub-algorithm.

       Quasi-Newton BFGS minimisation
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
       Line search:  More and Thuente line search.

       k: 0       xk: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])     fk: 4.8056261450870388e-23

       Parameter values: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])
       Function value:   4.8056261450870388e-23
       Iterations:       1
       Function calls:   59
       Gradient calls:   59
       Hessian calls:    0
       Warning:          None


Parameter values: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])
Function value:   4.8056261450870388e-23
Iterations:       120
Function calls:   377
Gradient calls:   377
Hessian calls:    0
Warning:          None

Traceback (most recent call last):
 File &quot;/sw/lib/relax-py25/test_suite/system_tests/model_free.py&quot;, line 355,
in test_opt_constr_bfgs_mt_S2_0_970_te_2048_Rex_0_149
   self.value_test(spin, select, s2, te, rex, chi2, iter, f_count, g_count,
h_count, warning)
 File &quot;/sw/lib/relax-py25/test_suite/system_tests/model_free.py&quot;, line 1047,
in value_test
   self.assertEqual(spin.f_count, f_count, msg=mesg)
AssertionError: Optimisation failure.

System: Darwin
Release: 9.5.0
Version: Darwin Kernel Version 9.5.0: Wed Sep  3 11:31:44 PDT 2008;
root:xnu-1228.7.58~1/RELEASE_PPC
Win32 version:
Distribution:
Architecture: 32bit
Machine: Power Macintosh
Processor: powerpc
Python version: 2.5.2
numpy version: 1.1.1


s2:       0.9700000000000607
te:       2048.0000000115510
rex:      0.14899999999885080
chi2:     4.8056261450870388e-23
iter:     120
f_count:  377
g_count:  377
h_count:  0
warning:  None

======================================================================
FAIL: Constrained coordinate descent opt, More and Thuente line search
{S2=0.970, te=2048, Rex=0.149}
----------------------------------------------------------------------

relax&gt; pipe.create(pipe_name='mf', pipe_type='mf')

relax&gt; sequence.read(file='noe.500.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/noe.500.out'
for reading.
Mol_name   Res_num    Res_name   Spin_num   Spin_name
None       1          GLY        None       None
None       2          ALA        None       None

relax&gt; relax_data.read(ri_label='R1', frq_label='600', frq=600000000.0,
file='r1.600.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/r1.600.out'
for reading.

relax&gt; relax_data.read(ri_label='R2', frq_label='600', frq=600000000.0,
file='r2.600.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/r2.600.out'
for reading.

relax&gt; relax_data.read(ri_label='NOE', frq_label='600', frq=600000000.0,
file='noe.600.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/noe.600.out'
for reading.

relax&gt; relax_data.read(ri_label='R1', frq_label='500', frq=500000000.0,
file='r1.500.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/r1.500.out'
for reading.

relax&gt; relax_data.read(ri_label='R2', frq_label='500', frq=500000000.0,
file='r2.500.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/r2.500.out'
for reading.

relax&gt; relax_data.read(ri_label='NOE', frq_label='500', frq=500000000.0,
file='noe.500.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/noe.500.out'
for reading.

relax&gt; diffusion_tensor.init(params=1e-08, time_scale=1.0, d_scale=1.0,
angle_units='deg', param_types=0, spheroid_type=None, fixed=True)

relax&gt; value.set(val=1.0200000000000001e-10, param='bond_length',
spin_id=None)

relax&gt; value.set(val=-0.00015999999999999999, param='csa', spin_id=None)

relax&gt; value.set(val='15N', param='heteronucleus', spin_id=None)

relax&gt; value.set(val='1H', param='proton', spin_id=None)

relax&gt; model_free.select_model(model='m4', spin_id=None)

relax&gt; value.set(val=[1.0, 0.0, 0.0], param=['S2', 'te', 'Rex'],
spin_id=None)

relax&gt; minimise(*args=('cd', 'mt'), func_tol=1e-25, max_iterations=10000000,
constraints=True, scaling=True, verbosity=1)
Only the model-free parameters for single spins will be used.


Fitting to spin ':2&amp;:ALA'
~~~~~~~~~~~~~~~~~~~~~~~~


Method of Multipliers
~~~~~~~~~~~~~~~~~~~~

k: 0       xk: array([ 1.,  0.,  0.])                                        
  fk: 3.9844117908982288
Entering sub-algorithm.

       Back-and-forth coordinate descent minimisation
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
       Line search:  More and Thuente line search.

       k: 0       xk: array([ 1.,  0.,  0.])                                 
          fk: 3.9844117908982288

       Parameter values: array([  0.90905609,  74.37463254,   1.22289922])
       Function value:   -1447.7789199590425
       Iterations:       25
       Function calls:   75
       Gradient calls:   75
       Hessian calls:    0
       Warning:          None


k: 1       xk: array([  0.90905609,  74.37463254,   1.22289922])             
  fk: 48.120438129522014
Entering sub-algorithm.

       Back-and-forth coordinate descent minimisation
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
       Line search:  More and Thuente line search.

       k: 0       xk: array([  0.90905609,  74.37463254,   1.22289922])      
          fk: 46.070117173804164

       Parameter values: array([  9.70000218e-01,   2.04801529e+03,  
1.48994731e-01])
       Function value:   -2.0503209554858945
       Iterations:       89
       Function calls:   284
       Gradient calls:   284
       Hessian calls:    0
       Warning:          None


k: 2       xk: array([  9.70000218e-01,   2.04801529e+03,   1.48994731e-01]) 
  fk: 2.3195995262977486e-10
Entering sub-algorithm.

       Back-and-forth coordinate descent minimisation
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
       Line search:  More and Thuente line search.

       k: 0       xk: array([  9.70000218e-01,   2.04801529e+03,  
1.48994731e-01])     fk: 2.3195995262977486e-10

       Parameter values: array([  9.70000218e-01,   2.04800873e+03,  
1.48997054e-01])
       Function value:   1.2998777447179547e-10
       Iterations:       18
       Function calls:   136
       Gradient calls:   136
       Hessian calls:    0
       Warning:          None


k: 3       xk: array([  9.70000218e-01,   2.04800873e+03,   1.48997054e-01]) 
  fk: 1.2998777447179547e-10
Entering sub-algorithm.

       Back-and-forth coordinate descent minimisation
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
       Line search:  More and Thuente line search.

       k: 0       xk: array([  9.70000218e-01,   2.04800873e+03,  
1.48997054e-01])     fk: 1.2998777447179547e-10

       Parameter values: array([  9.70000000e-01,   2.04800000e+03,  
1.48999999e-01])
       Function value:   2.3477234248531005e-18
       Iterations:       65
       Function calls:   184
       Gradient calls:   184
       Hessian calls:    0
       Warning:          None


k: 4       xk: array([  9.70000000e-01,   2.04800000e+03,   1.48999999e-01]) 
  fk: 2.3477234248531005e-18
Entering sub-algorithm.

       Back-and-forth coordinate descent minimisation
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
       Line search:  More and Thuente line search.

       k: 0       xk: array([  9.70000000e-01,   2.04800000e+03,  
1.48999999e-01])     fk: 2.3477234248531005e-18

       Parameter values: array([  9.70000000e-01,   2.04800000e+03,  
1.48999999e-01])
       Function value:   2.3477234248531005e-18
       Iterations:       1
       Function calls:   78
       Gradient calls:   78
       Hessian calls:    0
       Warning:          None


Parameter values: array([  9.70000000e-01,   2.04800000e+03,  
1.48999999e-01])
Function value:   2.3477234248531005e-18
Iterations:       198
Function calls:   757
Gradient calls:   757
Hessian calls:    0
Warning:          None

Traceback (most recent call last):
 File &quot;/sw/lib/relax-py25/test_suite/system_tests/model_free.py&quot;, line 452,
in test_opt_constr_cd_mt_S2_0_970_te_2048_Rex_0_149
   self.value_test(spin, select, s2, te, rex, chi2, iter, f_count, g_count,
h_count, warning)
 File &quot;/sw/lib/relax-py25/test_suite/system_tests/model_free.py&quot;, line 1047,
in value_test
   self.assertEqual(spin.f_count, f_count, msg=mesg)
AssertionError: Optimisation failure.

System: Darwin
Release: 9.5.0
Version: Darwin Kernel Version 9.5.0: Wed Sep  3 11:31:44 PDT 2008;
root:xnu-1228.7.58~1/RELEASE_PPC
Win32 version:
Distribution:
Architecture: 32bit
Machine: Power Macintosh
Processor: powerpc
Python version: 2.5.2
numpy version: 1.1.1


s2:       0.9700000000219674
te:       2048.0000015341870
rex:      0.14899999946977982
chi2:     2.3477234248531005e-18
iter:     198
f_count:  757
g_count:  757
h_count:  0
warning:  None

======================================================================
FAIL: Constrained Newton opt, GMW Hessian mod, backtracking line search
{S2=0.970, te=2048, Rex=0.149}
----------------------------------------------------------------------

relax&gt; pipe.create(pipe_name='mf', pipe_type='mf')

relax&gt; sequence.read(file='noe.500.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/noe.500.out'
for reading.
Mol_name   Res_num    Res_name   Spin_num   Spin_name
None       1          GLY        None       None
None       2          ALA        None       None

relax&gt; relax_data.read(ri_label='R1', frq_label='600', frq=600000000.0,
file='r1.600.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/r1.600.out'
for reading.

relax&gt; relax_data.read(ri_label='R2', frq_label='600', frq=600000000.0,
file='r2.600.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/r2.600.out'
for reading.

relax&gt; relax_data.read(ri_label='NOE', frq_label='600', frq=600000000.0,
file='noe.600.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/noe.600.out'
for reading.

relax&gt; relax_data.read(ri_label='R1', frq_label='500', frq=500000000.0,
file='r1.500.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/r1.500.out'
for reading.

relax&gt; relax_data.read(ri_label='R2', frq_label='500', frq=500000000.0,
file='r2.500.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/r2.500.out'
for reading.

relax&gt; relax_data.read(ri_label='NOE', frq_label='500', frq=500000000.0,
file='noe.500.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/noe.500.out'
for reading.

relax&gt; diffusion_tensor.init(params=1e-08, time_scale=1.0, d_scale=1.0,
angle_units='deg', param_types=0, spheroid_type=None, fixed=True)

relax&gt; value.set(val=1.0200000000000001e-10, param='bond_length',
spin_id=None)

relax&gt; value.set(val=-0.00015999999999999999, param='csa', spin_id=None)

relax&gt; value.set(val='15N', param='heteronucleus', spin_id=None)

relax&gt; value.set(val='1H', param='proton', spin_id=None)

relax&gt; model_free.select_model(model='m4', spin_id=None)

relax&gt; value.set(val=[1.0, 0.0, 0.0], param=['S2', 'te', 'Rex'],
spin_id=None)

relax&gt; minimise(*args=('newton', 'gmw', 'back'), func_tol=1e-25,
max_iterations=10000000, constraints=True, scaling=True, verbosity=1)
Only the model-free parameters for single spins will be used.


Fitting to spin ':2&amp;:ALA'
~~~~~~~~~~~~~~~~~~~~~~~~


Method of Multipliers
~~~~~~~~~~~~~~~~~~~~

k: 0       xk: array([ 1.,  0.,  0.])                                        
  fk: 3.9844117908982288
Entering sub-algorithm.

       Newton minimisation
       ~~~~~~~~~~~~~~~~~~~
       Line search:  Backtracking line search.
       Hessian modification:  The Gill, Murray, and Wright modified Cholesky
algorithm.

       k: 0       xk: array([ 1.,  0.,  0.])                                 
          fk: 3.9844117908982288

       Parameter values: array([  0.90905499,  74.36909171,   1.22310096])
       Function value:   -1447.7789206948949
       Iterations:       4
       Function calls:   9
       Gradient calls:   5
       Hessian calls:    4
       Warning:          None


k: 1       xk: array([  0.90905499,  74.36909171,   1.22310096])             
  fk: 48.121433050621448
Entering sub-algorithm.

       Newton minimisation
       ~~~~~~~~~~~~~~~~~~~
       Line search:  Backtracking line search.
       Hessian modification:  The Gill, Murray, and Wright modified Cholesky
algorithm.

       k: 0       xk: array([  0.90905499,  74.36909171,   1.22310096])      
          fk: 46.071609923379611

       Parameter values: array([  9.69999986e-01,   2.04799695e+03,  
1.49000257e-01])
       Function value:   -2.0498231272384211
       Iterations:       11
       Function calls:   37
       Gradient calls:   12
       Hessian calls:    11
       Warning:          None


k: 2       xk: array([  9.69999986e-01,   2.04799695e+03,   1.49000257e-01]) 
  fk: 3.414668279588586e-12
Entering sub-algorithm.

       Newton minimisation
       ~~~~~~~~~~~~~~~~~~~
       Line search:  Backtracking line search.
       Hessian modification:  The Gill, Murray, and Wright modified Cholesky
algorithm.

       k: 0       xk: array([  9.69999986e-01,   2.04799695e+03,  
1.49000257e-01])     fk: 3.414668279588586e-12

       Parameter values: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])
       Function value:   1.2385186715645527e-22
       Iterations:       1
       Function calls:   3
       Gradient calls:   2
       Hessian calls:    1
       Warning:          None


k: 3       xk: array([  9.70000000e-01,   2.04800000e+03,   1.49000000e-01]) 
  fk: 1.2385186715645527e-22
Entering sub-algorithm.

       Newton minimisation
       ~~~~~~~~~~~~~~~~~~~
       Line search:  Backtracking line search.
       Hessian modification:  The Gill, Murray, and Wright modified Cholesky
algorithm.

       k: 0       xk: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])     fk: 1.2385186715645527e-22

       Parameter values: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])
       Function value:   5.7085251917483392e-28
       Iterations:       1
       Function calls:   3
       Gradient calls:   2
       Hessian calls:    1
       Warning:          None


k: 4       xk: array([  9.70000000e-01,   2.04800000e+03,   1.49000000e-01]) 
  fk: 5.7085251917483392e-28
Entering sub-algorithm.

       Newton minimisation
       ~~~~~~~~~~~~~~~~~~~
       Line search:  Backtracking line search.
       Hessian modification:  The Gill, Murray, and Wright modified Cholesky
algorithm.

       k: 0       xk: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])     fk: 5.7085251917483392e-28

       Parameter values: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])
       Function value:   5.7085251917483392e-28
       Iterations:       1
       Function calls:   42
       Gradient calls:   2
       Hessian calls:    1
       Warning:          None


Parameter values: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])
Function value:   5.7085251917483392e-28
Iterations:       18
Function calls:   94
Gradient calls:   23
Hessian calls:    18
Warning:          None

Traceback (most recent call last):
 File &quot;/sw/lib/relax-py25/test_suite/system_tests/model_free.py&quot;, line 499,
in test_opt_constr_newton_gmw_back_S2_0_970_te_2048_Rex_0_149
   self.value_test(spin, select, s2, te, rex, chi2, iter, f_count, g_count,
h_count, warning)
 File &quot;/sw/lib/relax-py25/test_suite/system_tests/model_free.py&quot;, line 1047,
in value_test
   self.assertEqual(spin.f_count, f_count, msg=mesg)
AssertionError: Optimisation failure.

System: Darwin
Release: 9.5.0
Version: Darwin Kernel Version 9.5.0: Wed Sep  3 11:31:44 PDT 2008;
root:xnu-1228.7.58~1/RELEASE_PPC
Win32 version:
Distribution:
Architecture: 32bit
Machine: Power Macintosh
Processor: powerpc
Python version: 2.5.2
numpy version: 1.1.1


s2:       0.9699999999999993
te:       2048.0000000000427
rex:      0.14900000000002098
chi2:     5.7085251917483392e-28
iter:     18
f_count:  94
g_count:  23
h_count:  18
warning:  None

======================================================================
FAIL: Constrained Newton opt, GMW Hessian mod, More and Thuente line search
{S2=0.970, te=2048, Rex=0.149}
----------------------------------------------------------------------

relax&gt; pipe.create(pipe_name='mf', pipe_type='mf')

relax&gt; sequence.read(file='noe.500.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/noe.500.out'
for reading.
Mol_name   Res_num    Res_name   Spin_num   Spin_name
None       1          GLY        None       None
None       2          ALA        None       None

relax&gt; relax_data.read(ri_label='R1', frq_label='600', frq=600000000.0,
file='r1.600.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/r1.600.out'
for reading.

relax&gt; relax_data.read(ri_label='R2', frq_label='600', frq=600000000.0,
file='r2.600.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/r2.600.out'
for reading.

relax&gt; relax_data.read(ri_label='NOE', frq_label='600', frq=600000000.0,
file='noe.600.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/noe.600.out'
for reading.

relax&gt; relax_data.read(ri_label='R1', frq_label='500', frq=500000000.0,
file='r1.500.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/r1.500.out'
for reading.

relax&gt; relax_data.read(ri_label='R2', frq_label='500', frq=500000000.0,
file='r2.500.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/r2.500.out'
for reading.

relax&gt; relax_data.read(ri_label='NOE', frq_label='500', frq=500000000.0,
file='noe.500.out',
dir='/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149',
mol_name_col=None, res_num_col=0, res_name_col=1, spin_num_col=None,
spin_name_col=None, data_col=2, error_col=3, sep=None)
Opening the file
'/sw/lib/relax-py25/test_suite/shared_data/model_free/S2_0.970_te_2048_Rex_0.149/noe.500.out'
for reading.

relax&gt; diffusion_tensor.init(params=1e-08, time_scale=1.0, d_scale=1.0,
angle_units='deg', param_types=0, spheroid_type=None, fixed=True)

relax&gt; value.set(val=1.0200000000000001e-10, param='bond_length',
spin_id=None)

relax&gt; value.set(val=-0.00015999999999999999, param='csa', spin_id=None)

relax&gt; value.set(val='15N', param='heteronucleus', spin_id=None)

relax&gt; value.set(val='1H', param='proton', spin_id=None)

relax&gt; model_free.select_model(model='m4', spin_id=None)

relax&gt; value.set(val=[1.0, 0.0, 0.0], param=['S2', 'te', 'Rex'],
spin_id=None)

relax&gt; minimise(*args=('newton', 'gmw', 'mt'), func_tol=1e-25,
max_iterations=10000000, constraints=True, scaling=True, verbosity=1)
Only the model-free parameters for single spins will be used.


Fitting to spin ':2&amp;:ALA'
~~~~~~~~~~~~~~~~~~~~~~~~


Method of Multipliers
~~~~~~~~~~~~~~~~~~~~

k: 0       xk: array([ 1.,  0.,  0.])                                        
  fk: 3.9844117908982288
Entering sub-algorithm.

       Newton minimisation
       ~~~~~~~~~~~~~~~~~~~
       Line search:  More and Thuente line search.
       Hessian modification:  The Gill, Murray, and Wright modified Cholesky
algorithm.

       k: 0       xk: array([ 1.,  0.,  0.])                                 
          fk: 3.9844117908982288

       Parameter values: array([  0.90905499,  74.36909171,   1.22310096])
       Function value:   -1447.7789206948949
       Iterations:       4
       Function calls:   9
       Gradient calls:   9
       Hessian calls:    4
       Warning:          None


k: 1       xk: array([  0.90905499,  74.36909171,   1.22310096])             
  fk: 48.121433050621448
Entering sub-algorithm.

       Newton minimisation
       ~~~~~~~~~~~~~~~~~~~
       Line search:  More and Thuente line search.
       Hessian modification:  The Gill, Murray, and Wright modified Cholesky
algorithm.

       k: 0       xk: array([  0.90905499,  74.36909171,   1.22310096])      
          fk: 46.071609923379611

       Parameter values: array([  9.69999996e-01,   2.04799919e+03,  
1.49000073e-01])
       Function value:   -2.0498231272415968
       Iterations:       15
       Function calls:   73
       Gradient calls:   73
       Hessian calls:    15
       Warning:          None


k: 2       xk: array([  9.69999996e-01,   2.04799919e+03,   1.49000073e-01]) 
  fk: 2.3886846326646765e-13
Entering sub-algorithm.

       Newton minimisation
       ~~~~~~~~~~~~~~~~~~~
       Line search:  More and Thuente line search.
       Hessian modification:  The Gill, Murray, and Wright modified Cholesky
algorithm.

       k: 0       xk: array([  9.69999996e-01,   2.04799919e+03,  
1.49000073e-01])     fk: 2.3886846326646765e-13

       Parameter values: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])
       Function value:   6.1070040854035286e-25
       Iterations:       1
       Function calls:   3
       Gradient calls:   3
       Hessian calls:    1
       Warning:          None


k: 3       xk: array([  9.70000000e-01,   2.04800000e+03,   1.49000000e-01]) 
  fk: 6.1070040854035286e-25
Entering sub-algorithm.

       Newton minimisation
       ~~~~~~~~~~~~~~~~~~~
       Line search:  More and Thuente line search.
       Hessian modification:  The Gill, Murray, and Wright modified Cholesky
algorithm.

       k: 0       xk: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])     fk: 6.1070040854035286e-25

       Parameter values: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])
       Function value:   6.8756889983348349e-28
       Iterations:       1
       Function calls:   3
       Gradient calls:   3
       Hessian calls:    1
       Warning:          None


k: 4       xk: array([  9.70000000e-01,   2.04800000e+03,   1.49000000e-01]) 
  fk: 6.8756889983348349e-28
Entering sub-algorithm.

       Newton minimisation
       ~~~~~~~~~~~~~~~~~~~
       Line search:  More and Thuente line search.
       Hessian modification:  The Gill, Murray, and Wright modified Cholesky
algorithm.

       k: 0       xk: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])     fk: 6.8756889983348349e-28

       Parameter values: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])
       Function value:   6.8756889983348349e-28
       Iterations:       1
       Function calls:   72
       Gradient calls:   72
       Hessian calls:    1
       Warning:          None


Parameter values: array([  9.70000000e-01,   2.04800000e+03,  
1.49000000e-01])
Function value:   6.8756889983348349e-28
Iterations:       22
Function calls:   160
Gradient calls:   160
Hessian calls:    22
Warning:          None

Traceback (most recent call last):
 File &quot;/sw/lib/relax-py25/test_suite/system_tests/model_free.py&quot;, line 554,
in test_opt_constr_newton_gmw_mt_S2_0_970_te_2048_Rex_0_149
   self.value_test(spin, select, s2, te, rex, chi2, iter, f_count, g_count,
h_count, warning)
 File &quot;/sw/lib/relax-py25/test_suite/system_tests/model_free.py&quot;, line 1047,
in value_test
   self.assertEqual(spin.f_count, f_count, msg=mesg)
AssertionError: Optimisation failure.

System: Darwin
Release: 9.5.0
Version: Darwin Kernel Version 9.5.0: Wed Sep  3 11:31:44 PDT 2008;
root:xnu-1228.7.58~1/RELEASE_PPC
Win32 version:
Distribution:
Architecture: 32bit
Machine: Power Macintosh
Processor: powerpc
Python version: 2.5.2
numpy version: 1.1.1


s2:       0.9699999999999993
te:       2048.0000000000409
rex:      0.14900000000002178
chi2:     6.8756889983348349e-28
iter:     22
f_count:  160
g_count:  160
h_count:  22
warning:  None

----------------------------------------------------------------------

    _______________________________________________________

Reply to this item at:

  &lt;<a  rel="nofollow" href="http://gna.org/bugs/?12573">http://gna.org/bugs/?12573</a>&gt;

_______________________________________________
  Message sent via/by Gna!
  <a  rel="nofollow" href="http://gna.org/">http://gna.org/</a>



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00038" href="msg00038.html">[bug #12573] FAIL: Model-free optimisation {S2=0.970,	te=2048 Rex=0.149}</a></strong>
<ul><li><em>From:</em> Edward d Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Wed Dec 17 10:40:19 2008</div>  
</body>
</html>
