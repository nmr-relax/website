<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>specific_analyses.n_state_model</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
  <!--Google analytics JS-->
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30096326-1']);
    _gaq.push(['_setDomainName', 'nmr-relax.com']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://www.nmr-relax.com">relax</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="specific_analyses-module.html">Package&nbsp;specific_analyses</a> ::
        Package&nbsp;n_state_model
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="specific_analyses.n_state_model-pysrc.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<h1 class="epydoc">Source Code for <a href="specific_analyses.n_state_model-module.html">Package specific_analyses.n_state_model</a></h1>
<pre class="py-src">
<a name="L1"></a><tt class="py-lineno">   1</tt>  <tt class="py-line"><tt class="py-comment">###############################################################################</tt> </tt>
<a name="L2"></a><tt class="py-lineno">   2</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L3"></a><tt class="py-lineno">   3</tt>  <tt class="py-line"><tt class="py-comment"># Copyright (C) 2007-2013 Edward d'Auvergne                                   #</tt> </tt>
<a name="L4"></a><tt class="py-lineno">   4</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L5"></a><tt class="py-lineno">   5</tt>  <tt class="py-line"><tt class="py-comment"># This file is part of the program relax (http://www.nmr-relax.com).          #</tt> </tt>
<a name="L6"></a><tt class="py-lineno">   6</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L7"></a><tt class="py-lineno">   7</tt>  <tt class="py-line"><tt class="py-comment"># This program is free software: you can redistribute it and/or modify        #</tt> </tt>
<a name="L8"></a><tt class="py-lineno">   8</tt>  <tt class="py-line"><tt class="py-comment"># it under the terms of the GNU General Public License as published by        #</tt> </tt>
<a name="L9"></a><tt class="py-lineno">   9</tt>  <tt class="py-line"><tt class="py-comment"># the Free Software Foundation, either version 3 of the License, or           #</tt> </tt>
<a name="L10"></a><tt class="py-lineno">  10</tt>  <tt class="py-line"><tt class="py-comment"># (at your option) any later version.                                         #</tt> </tt>
<a name="L11"></a><tt class="py-lineno">  11</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L12"></a><tt class="py-lineno">  12</tt>  <tt class="py-line"><tt class="py-comment"># This program is distributed in the hope that it will be useful,             #</tt> </tt>
<a name="L13"></a><tt class="py-lineno">  13</tt>  <tt class="py-line"><tt class="py-comment"># but WITHOUT ANY WARRANTY; without even the implied warranty of              #</tt> </tt>
<a name="L14"></a><tt class="py-lineno">  14</tt>  <tt class="py-line"><tt class="py-comment"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the               #</tt> </tt>
<a name="L15"></a><tt class="py-lineno">  15</tt>  <tt class="py-line"><tt class="py-comment"># GNU General Public License for more details.                                #</tt> </tt>
<a name="L16"></a><tt class="py-lineno">  16</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L17"></a><tt class="py-lineno">  17</tt>  <tt class="py-line"><tt class="py-comment"># You should have received a copy of the GNU General Public License           #</tt> </tt>
<a name="L18"></a><tt class="py-lineno">  18</tt>  <tt class="py-line"><tt class="py-comment"># along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.       #</tt> </tt>
<a name="L19"></a><tt class="py-lineno">  19</tt>  <tt class="py-line"><tt class="py-comment">#                                                                             #</tt> </tt>
<a name="L20"></a><tt class="py-lineno">  20</tt>  <tt class="py-line"><tt class="py-comment">###############################################################################</tt> </tt>
<a name="L21"></a><tt class="py-lineno">  21</tt>  <tt class="py-line"> </tt>
<a name="L22"></a><tt class="py-lineno">  22</tt>  <tt class="py-line"><tt class="py-comment"># Package docstring.</tt> </tt>
<a name="L23"></a><tt class="py-lineno">  23</tt>  <tt class="py-line"><tt class="py-docstring">"""The N-state model or structural ensemble analysis."""</tt> </tt>
<a name="L24"></a><tt class="py-lineno">  24</tt>  <tt class="py-line"> </tt>
<a name="L25"></a><tt class="py-lineno">  25</tt>  <tt class="py-line"><tt class="py-comment"># The available modules.</tt> </tt>
<a name="L26"></a><tt class="py-lineno">  26</tt>  <tt class="py-line"><tt class="py-name">__all__</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt> </tt>
<a name="L27"></a><tt class="py-lineno">  27</tt>  <tt class="py-line">    <tt class="py-string">'data'</tt><tt class="py-op">,</tt> </tt>
<a name="L28"></a><tt class="py-lineno">  28</tt>  <tt class="py-line">    <tt class="py-string">'parameters'</tt> </tt>
<a name="L29"></a><tt class="py-lineno">  29</tt>  <tt class="py-line"><tt class="py-op">]</tt> </tt>
<a name="L30"></a><tt class="py-lineno">  30</tt>  <tt class="py-line"> </tt>
<a name="L31"></a><tt class="py-lineno">  31</tt>  <tt class="py-line"><tt class="py-comment"># Python module imports.</tt> </tt>
<a name="L32"></a><tt class="py-lineno">  32</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-0" class="py-name" targets="Function pipe_control.align_tensor.copy()=pipe_control.align_tensor-module.html#copy,Function pipe_control.diffusion_tensor.copy()=pipe_control.diffusion_tensor-module.html#copy,Function pipe_control.interatomic.copy()=pipe_control.interatomic-module.html#copy,Function pipe_control.j_coupling.copy()=pipe_control.j_coupling-module.html#copy,Function pipe_control.pcs.copy()=pipe_control.pcs-module.html#copy,Function pipe_control.pipes.copy()=pipe_control.pipes-module.html#copy,Function pipe_control.rdc.copy()=pipe_control.rdc-module.html#copy,Function pipe_control.relax_data.copy()=pipe_control.relax_data-module.html#copy,Function pipe_control.sequence.copy()=pipe_control.sequence-module.html#copy,Function pipe_control.value.copy()=pipe_control.value-module.html#copy"><a title="pipe_control.align_tensor.copy
pipe_control.diffusion_tensor.copy
pipe_control.interatomic.copy
pipe_control.j_coupling.copy
pipe_control.pcs.copy
pipe_control.pipes.copy
pipe_control.rdc.copy
pipe_control.relax_data.copy
pipe_control.sequence.copy
pipe_control.value.copy" class="py-name" href="#" onclick="return doclink('link-0', 'copy', 'link-0');">copy</a></tt> <tt class="py-keyword">import</tt> <tt class="py-name">deepcopy</tt> </tt>
<a name="L33"></a><tt class="py-lineno">  33</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">math</tt> <tt class="py-keyword">import</tt> <tt class="py-name">acos</tt><tt class="py-op">,</tt> <tt class="py-name">cos</tt><tt class="py-op">,</tt> <tt class="py-name">pi</tt><tt class="py-op">,</tt> <tt class="py-name">sqrt</tt> </tt>
<a name="L34"></a><tt class="py-lineno">  34</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-1" class="py-name" targets="Package minfx=minfx-module.html"><a title="minfx" class="py-name" href="#" onclick="return doclink('link-1', 'minfx', 'link-1');">minfx</a></tt><tt class="py-op">.</tt><tt id="link-2" class="py-name" targets="Module minfx.generic=minfx.generic-module.html,Module test_suite.system_tests.generic=test_suite.system_tests.generic-module.html"><a title="minfx.generic
test_suite.system_tests.generic" class="py-name" href="#" onclick="return doclink('link-2', 'generic', 'link-2');">generic</a></tt> <tt class="py-keyword">import</tt> <tt id="link-3" class="py-name" targets="Function minfx.generic.generic_minimise()=minfx.generic-module.html#generic_minimise"><a title="minfx.generic.generic_minimise" class="py-name" href="#" onclick="return doclink('link-3', 'generic_minimise', 'link-3');">generic_minimise</a></tt> </tt>
<a name="L35"></a><tt class="py-lineno">  35</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-4" class="py-name"><a title="minfx" class="py-name" href="#" onclick="return doclink('link-4', 'minfx', 'link-1');">minfx</a></tt><tt class="py-op">.</tt><tt id="link-5" class="py-name" targets="Module gui.components.grid=gui.components.grid-module.html,Module minfx.grid=minfx.grid-module.html,Function minfx.grid.grid()=minfx.grid-module.html#grid"><a title="gui.components.grid
minfx.grid
minfx.grid.grid" class="py-name" href="#" onclick="return doclink('link-5', 'grid', 'link-5');">grid</a></tt> <tt class="py-keyword">import</tt> <tt id="link-6" class="py-name"><a title="gui.components.grid
minfx.grid
minfx.grid.grid" class="py-name" href="#" onclick="return doclink('link-6', 'grid', 'link-5');">grid</a></tt> </tt>
<a name="L36"></a><tt class="py-lineno">  36</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">numpy</tt> <tt class="py-keyword">import</tt> <tt class="py-name">array</tt><tt class="py-op">,</tt> <tt class="py-name">dot</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">,</tt> <tt class="py-name">ones</tt><tt class="py-op">,</tt> <tt class="py-name">zeros</tt> </tt>
<a name="L37"></a><tt class="py-lineno">  37</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">numpy</tt><tt class="py-op">.</tt><tt class="py-name">linalg</tt> <tt class="py-keyword">import</tt> <tt class="py-name">inv</tt><tt class="py-op">,</tt> <tt class="py-name">norm</tt> </tt>
<a name="L38"></a><tt class="py-lineno">  38</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">re</tt> <tt class="py-keyword">import</tt> <tt id="link-7" class="py-name" targets="Function lib.regex.search()=lib.regex-module.html#search"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-7', 'search', 'link-7');">search</a></tt> </tt>
<a name="L39"></a><tt class="py-lineno">  39</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-8" class="py-name" targets="Module lib.warnings=lib.warnings-module.html"><a title="lib.warnings" class="py-name" href="#" onclick="return doclink('link-8', 'warnings', 'link-8');">warnings</a></tt> <tt class="py-keyword">import</tt> <tt class="py-name">warn</tt> </tt>
<a name="L40"></a><tt class="py-lineno">  40</tt>  <tt class="py-line"> </tt>
<a name="L41"></a><tt class="py-lineno">  41</tt>  <tt class="py-line"><tt class="py-comment"># relax module imports.</tt> </tt>
<a name="L42"></a><tt class="py-lineno">  42</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt id="link-9" class="py-name" targets="Package lib=lib-module.html"><a title="lib" class="py-name" href="#" onclick="return doclink('link-9', 'lib', 'link-9');">lib</a></tt><tt class="py-op">.</tt><tt id="link-10" class="py-name" targets="Module lib.arg_check=lib.arg_check-module.html"><a title="lib.arg_check" class="py-name" href="#" onclick="return doclink('link-10', 'arg_check', 'link-10');">arg_check</a></tt> </tt>
<a name="L43"></a><tt class="py-lineno">  43</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-11" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-11', 'lib', 'link-9');">lib</a></tt><tt class="py-op">.</tt><tt id="link-12" class="py-name" targets="Module gui.errors=gui.errors-module.html,Module lib.errors=lib.errors-module.html,Module minfx.errors=minfx.errors-module.html"><a title="gui.errors
lib.errors
minfx.errors" class="py-name" href="#" onclick="return doclink('link-12', 'errors', 'link-12');">errors</a></tt> <tt class="py-keyword">import</tt> <tt id="link-13" class="py-name" targets="Class lib.errors.RelaxError=lib.errors.RelaxError-class.html"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-13', 'RelaxError', 'link-13');">RelaxError</a></tt><tt class="py-op">,</tt> <tt id="link-14" class="py-name" targets="Class lib.errors.RelaxInfError=lib.errors.RelaxInfError-class.html"><a title="lib.errors.RelaxInfError" class="py-name" href="#" onclick="return doclink('link-14', 'RelaxInfError', 'link-14');">RelaxInfError</a></tt><tt class="py-op">,</tt> <tt id="link-15" class="py-name" targets="Class lib.errors.RelaxNaNError=lib.errors.RelaxNaNError-class.html"><a title="lib.errors.RelaxNaNError" class="py-name" href="#" onclick="return doclink('link-15', 'RelaxNaNError', 'link-15');">RelaxNaNError</a></tt><tt class="py-op">,</tt> <tt id="link-16" class="py-name" targets="Class lib.errors.RelaxNoModelError=lib.errors.RelaxNoModelError-class.html"><a title="lib.errors.RelaxNoModelError" class="py-name" href="#" onclick="return doclink('link-16', 'RelaxNoModelError', 'link-16');">RelaxNoModelError</a></tt><tt class="py-op">,</tt> <tt id="link-17" class="py-name" targets="Class lib.errors.RelaxNoValueError=lib.errors.RelaxNoValueError-class.html"><a title="lib.errors.RelaxNoValueError" class="py-name" href="#" onclick="return doclink('link-17', 'RelaxNoValueError', 'link-17');">RelaxNoValueError</a></tt><tt class="py-op">,</tt> <tt id="link-18" class="py-name" targets="Class lib.errors.RelaxSpinTypeError=lib.errors.RelaxSpinTypeError-class.html"><a title="lib.errors.RelaxSpinTypeError" class="py-name" href="#" onclick="return doclink('link-18', 'RelaxSpinTypeError', 'link-18');">RelaxSpinTypeError</a></tt> </tt>
<a name="L44"></a><tt class="py-lineno">  44</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-19" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-19', 'lib', 'link-9');">lib</a></tt><tt class="py-op">.</tt><tt id="link-20" class="py-name" targets="Module lib.float=lib.float-module.html"><a title="lib.float" class="py-name" href="#" onclick="return doclink('link-20', 'float', 'link-20');">float</a></tt> <tt class="py-keyword">import</tt> <tt id="link-21" class="py-name" targets="Function lib.float.isNaN()=lib.float-module.html#isNaN"><a title="lib.float.isNaN" class="py-name" href="#" onclick="return doclink('link-21', 'isNaN', 'link-21');">isNaN</a></tt><tt class="py-op">,</tt> <tt id="link-22" class="py-name" targets="Function lib.float.isInf()=lib.float-module.html#isInf"><a title="lib.float.isInf" class="py-name" href="#" onclick="return doclink('link-22', 'isInf', 'link-22');">isInf</a></tt> </tt>
<a name="L45"></a><tt class="py-lineno">  45</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-23" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-23', 'lib', 'link-9');">lib</a></tt><tt class="py-op">.</tt><tt id="link-24" class="py-name" targets="Package lib.geometry=lib.geometry-module.html"><a title="lib.geometry" class="py-name" href="#" onclick="return doclink('link-24', 'geometry', 'link-24');">geometry</a></tt><tt class="py-op">.</tt><tt id="link-25" class="py-name" targets="Module lib.geometry.rotations=lib.geometry.rotations-module.html"><a title="lib.geometry.rotations" class="py-name" href="#" onclick="return doclink('link-25', 'rotations', 'link-25');">rotations</a></tt> <tt class="py-keyword">import</tt> <tt id="link-26" class="py-name" targets="Function lib.geometry.rotations.euler_to_R_zyz()=lib.geometry.rotations-module.html#euler_to_R_zyz"><a title="lib.geometry.rotations.euler_to_R_zyz" class="py-name" href="#" onclick="return doclink('link-26', 'euler_to_R_zyz', 'link-26');">euler_to_R_zyz</a></tt><tt class="py-op">,</tt> <tt id="link-27" class="py-name" targets="Function lib.geometry.rotations.two_vect_to_R()=lib.geometry.rotations-module.html#two_vect_to_R"><a title="lib.geometry.rotations.two_vect_to_R" class="py-name" href="#" onclick="return doclink('link-27', 'two_vect_to_R', 'link-27');">two_vect_to_R</a></tt> </tt>
<a name="L46"></a><tt class="py-lineno">  46</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-28" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-28', 'lib', 'link-9');">lib</a></tt><tt class="py-op">.</tt><tt id="link-29" class="py-name" targets="Module lib.io=lib.io-module.html"><a title="lib.io" class="py-name" href="#" onclick="return doclink('link-29', 'io', 'link-29');">io</a></tt> <tt class="py-keyword">import</tt> <tt id="link-30" class="py-name" targets="Function lib.io.open_write_file()=lib.io-module.html#open_write_file"><a title="lib.io.open_write_file" class="py-name" href="#" onclick="return doclink('link-30', 'open_write_file', 'link-30');">open_write_file</a></tt> </tt>
<a name="L47"></a><tt class="py-lineno">  47</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-31" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-31', 'lib', 'link-9');">lib</a></tt><tt class="py-op">.</tt><tt id="link-32" class="py-name" targets="Module lib.physical_constants=lib.physical_constants-module.html"><a title="lib.physical_constants" class="py-name" href="#" onclick="return doclink('link-32', 'physical_constants', 'link-32');">physical_constants</a></tt> <tt class="py-keyword">import</tt> <tt id="link-33" class="py-name" targets="Function lib.physical_constants.dipolar_constant()=lib.physical_constants-module.html#dipolar_constant"><a title="lib.physical_constants.dipolar_constant" class="py-name" href="#" onclick="return doclink('link-33', 'dipolar_constant', 'link-33');">dipolar_constant</a></tt><tt class="py-op">,</tt> <tt id="link-34" class="py-name" targets="Variable lib.physical_constants.g1H=lib.physical_constants-module.html#g1H"><a title="lib.physical_constants.g1H" class="py-name" href="#" onclick="return doclink('link-34', 'g1H', 'link-34');">g1H</a></tt><tt class="py-op">,</tt> <tt id="link-35" class="py-name" targets="Function lib.physical_constants.return_gyromagnetic_ratio()=lib.physical_constants-module.html#return_gyromagnetic_ratio"><a title="lib.physical_constants.return_gyromagnetic_ratio" class="py-name" href="#" onclick="return doclink('link-35', 'return_gyromagnetic_ratio', 'link-35');">return_gyromagnetic_ratio</a></tt> </tt>
<a name="L48"></a><tt class="py-lineno">  48</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-36" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-36', 'lib', 'link-9');">lib</a></tt><tt class="py-op">.</tt><tt id="link-37" class="py-name" targets="Package bmrblib.structure=bmrblib.structure-module.html,Package lib.structure=lib.structure-module.html,Package pipe_control.structure=pipe_control.structure-module.html,Module test_suite.system_tests.structure=test_suite.system_tests.structure-module.html,Module user_functions.structure=user_functions.structure-module.html"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-37', 'structure', 'link-37');">structure</a></tt><tt class="py-op">.</tt><tt id="link-38" class="py-name" targets="Module lib.structure.cones=lib.structure.cones-module.html"><a title="lib.structure.cones" class="py-name" href="#" onclick="return doclink('link-38', 'cones', 'link-38');">cones</a></tt> <tt class="py-keyword">import</tt> <tt id="link-39" class="py-name" targets="Class lib.structure.cones.Iso_cone=lib.structure.cones.Iso_cone-class.html"><a title="lib.structure.cones.Iso_cone" class="py-name" href="#" onclick="return doclink('link-39', 'Iso_cone', 'link-39');">Iso_cone</a></tt> </tt>
<a name="L49"></a><tt class="py-lineno">  49</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-40" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-40', 'lib', 'link-9');">lib</a></tt><tt class="py-op">.</tt><tt id="link-41" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-41', 'structure', 'link-37');">structure</a></tt><tt class="py-op">.</tt><tt id="link-42" class="py-name" targets="Package lib.structure.represent=lib.structure.represent-module.html"><a title="lib.structure.represent" class="py-name" href="#" onclick="return doclink('link-42', 'represent', 'link-42');">represent</a></tt><tt class="py-op">.</tt><tt id="link-43" class="py-name" targets="Module lib.structure.represent.cone=lib.structure.represent.cone-module.html,Function lib.structure.represent.cone.cone()=lib.structure.represent.cone-module.html#cone"><a title="lib.structure.represent.cone
lib.structure.represent.cone.cone" class="py-name" href="#" onclick="return doclink('link-43', 'cone', 'link-43');">cone</a></tt> <tt class="py-keyword">import</tt> <tt id="link-44" class="py-name" targets="Function lib.structure.represent.cone.cone_edge()=lib.structure.represent.cone-module.html#cone_edge"><a title="lib.structure.represent.cone.cone_edge" class="py-name" href="#" onclick="return doclink('link-44', 'cone_edge', 'link-44');">cone_edge</a></tt><tt class="py-op">,</tt> <tt id="link-45" class="py-name" targets="Function lib.structure.represent.cone.stitch_cone_to_edge()=lib.structure.represent.cone-module.html#stitch_cone_to_edge"><a title="lib.structure.represent.cone.stitch_cone_to_edge" class="py-name" href="#" onclick="return doclink('link-45', 'stitch_cone_to_edge', 'link-45');">stitch_cone_to_edge</a></tt> </tt>
<a name="L50"></a><tt class="py-lineno">  50</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-46" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-46', 'lib', 'link-9');">lib</a></tt><tt class="py-op">.</tt><tt id="link-47" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-47', 'structure', 'link-37');">structure</a></tt><tt class="py-op">.</tt><tt id="link-48" class="py-name" targets="Package lib.structure.internal=lib.structure.internal-module.html"><a title="lib.structure.internal" class="py-name" href="#" onclick="return doclink('link-48', 'internal', 'link-48');">internal</a></tt><tt class="py-op">.</tt><tt id="link-49" class="py-name" targets="Module lib.structure.internal.object=lib.structure.internal.object-module.html"><a title="lib.structure.internal.object" class="py-name" href="#" onclick="return doclink('link-49', 'object', 'link-49');">object</a></tt> <tt class="py-keyword">import</tt> <tt id="link-50" class="py-name" targets="Class lib.structure.internal.object.Internal=lib.structure.internal.object.Internal-class.html"><a title="lib.structure.internal.object.Internal" class="py-name" href="#" onclick="return doclink('link-50', 'Internal', 'link-50');">Internal</a></tt> </tt>
<a name="L51"></a><tt class="py-lineno">  51</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-51" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-51', 'lib', 'link-9');">lib</a></tt><tt class="py-op">.</tt><tt id="link-52" class="py-name"><a title="lib.warnings" class="py-name" href="#" onclick="return doclink('link-52', 'warnings', 'link-8');">warnings</a></tt> <tt class="py-keyword">import</tt> <tt id="link-53" class="py-name" targets="Class lib.warnings.RelaxWarning=lib.warnings.RelaxWarning-class.html"><a title="lib.warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-53', 'RelaxWarning', 'link-53');">RelaxWarning</a></tt> </tt>
<a name="L52"></a><tt class="py-lineno">  52</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-54" class="py-name" targets="Package pipe_control=pipe_control-module.html"><a title="pipe_control" class="py-name" href="#" onclick="return doclink('link-54', 'pipe_control', 'link-54');">pipe_control</a></tt> <tt class="py-keyword">import</tt> <tt id="link-55" class="py-name" targets="Module data_store.align_tensor=data_store.align_tensor-module.html,Module pipe_control.align_tensor=pipe_control.align_tensor-module.html,Module test_suite.system_tests.align_tensor=test_suite.system_tests.align_tensor-module.html,Module user_functions.align_tensor=user_functions.align_tensor-module.html"><a title="data_store.align_tensor
pipe_control.align_tensor
test_suite.system_tests.align_tensor
user_functions.align_tensor" class="py-name" href="#" onclick="return doclink('link-55', 'align_tensor', 'link-55');">align_tensor</a></tt><tt class="py-op">,</tt> <tt id="link-56" class="py-name" targets="Module lib.alignment.pcs=lib.alignment.pcs-module.html,Module pipe_control.pcs=pipe_control.pcs-module.html,Module test_suite.system_tests.pcs=test_suite.system_tests.pcs-module.html,Module user_functions.pcs=user_functions.pcs-module.html"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-56', 'pcs', 'link-56');">pcs</a></tt><tt class="py-op">,</tt> <tt id="link-57" class="py-name" targets="Module pipe_control.pipes=pipe_control.pipes-module.html,Module test_suite.gui_tests.pipes=test_suite.gui_tests.pipes-module.html,Module test_suite.system_tests.pipes=test_suite.system_tests.pipes-module.html"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-57', 'pipes', 'link-57');">pipes</a></tt><tt class="py-op">,</tt> <tt id="link-58" class="py-name" targets="Module lib.alignment.rdc=lib.alignment.rdc-module.html,Module pipe_control.rdc=pipe_control.rdc-module.html,Module test_suite.system_tests.rdc=test_suite.system_tests.rdc-module.html,Module user_functions.rdc=user_functions.rdc-module.html"><a title="lib.alignment.rdc
pipe_control.rdc
test_suite.system_tests.rdc
user_functions.rdc" class="py-name" href="#" onclick="return doclink('link-58', 'rdc', 'link-58');">rdc</a></tt> </tt>
<a name="L53"></a><tt class="py-lineno">  53</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-59" class="py-name"><a title="pipe_control" class="py-name" href="#" onclick="return doclink('link-59', 'pipe_control', 'link-54');">pipe_control</a></tt><tt class="py-op">.</tt><tt id="link-60" class="py-name" targets="Module data_store.interatomic=data_store.interatomic-module.html,Module pipe_control.interatomic=pipe_control.interatomic-module.html,Module test_suite.gui_tests.interatomic=test_suite.gui_tests.interatomic-module.html,Module test_suite.system_tests.interatomic=test_suite.system_tests.interatomic-module.html"><a title="data_store.interatomic
pipe_control.interatomic
test_suite.gui_tests.interatomic
test_suite.system_tests.interatomic" class="py-name" href="#" onclick="return doclink('link-60', 'interatomic', 'link-60');">interatomic</a></tt> <tt class="py-keyword">import</tt> <tt id="link-61" class="py-name" targets="Function pipe_control.interatomic.interatomic_loop()=pipe_control.interatomic-module.html#interatomic_loop"><a title="pipe_control.interatomic.interatomic_loop" class="py-name" href="#" onclick="return doclink('link-61', 'interatomic_loop', 'link-61');">interatomic_loop</a></tt> </tt>
<a name="L54"></a><tt class="py-lineno">  54</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-62" class="py-name"><a title="pipe_control" class="py-name" href="#" onclick="return doclink('link-62', 'pipe_control', 'link-54');">pipe_control</a></tt><tt class="py-op">.</tt><tt id="link-63" class="py-name" targets="Module data_store.mol_res_spin=data_store.mol_res_spin-module.html,Module pipe_control.mol_res_spin=pipe_control.mol_res_spin-module.html,Module test_suite.system_tests.mol_res_spin=test_suite.system_tests.mol_res_spin-module.html"><a title="data_store.mol_res_spin
pipe_control.mol_res_spin
test_suite.system_tests.mol_res_spin" class="py-name" href="#" onclick="return doclink('link-63', 'mol_res_spin', 'link-63');">mol_res_spin</a></tt> <tt class="py-keyword">import</tt> <tt id="link-64" class="py-name" targets="Function pipe_control.mol_res_spin.return_spin()=pipe_control.mol_res_spin-module.html#return_spin"><a title="pipe_control.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-64', 'return_spin', 'link-64');">return_spin</a></tt><tt class="py-op">,</tt> <tt id="link-65" class="py-name" targets="Function pipe_control.mol_res_spin.spin_loop()=pipe_control.mol_res_spin-module.html#spin_loop"><a title="pipe_control.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-65', 'spin_loop', 'link-65');">spin_loop</a></tt> </tt>
<a name="L55"></a><tt class="py-lineno">  55</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-66" class="py-name"><a title="pipe_control" class="py-name" href="#" onclick="return doclink('link-66', 'pipe_control', 'link-54');">pipe_control</a></tt><tt class="py-op">.</tt><tt id="link-67" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-67', 'structure', 'link-37');">structure</a></tt> <tt class="py-keyword">import</tt> <tt id="link-68" class="py-name" targets="Module pipe_control.structure.geometric=pipe_control.structure.geometric-module.html"><a title="pipe_control.structure.geometric" class="py-name" href="#" onclick="return doclink('link-68', 'geometric', 'link-68');">geometric</a></tt> </tt>
<a name="L56"></a><tt class="py-lineno">  56</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-69" class="py-name"><a title="pipe_control" class="py-name" href="#" onclick="return doclink('link-69', 'pipe_control', 'link-54');">pipe_control</a></tt><tt class="py-op">.</tt><tt id="link-70" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-70', 'structure', 'link-37');">structure</a></tt><tt class="py-op">.</tt><tt id="link-71" class="py-name" targets="Module lib.structure.mass=lib.structure.mass-module.html,Module pipe_control.structure.mass=pipe_control.structure.mass-module.html"><a title="lib.structure.mass
pipe_control.structure.mass" class="py-name" href="#" onclick="return doclink('link-71', 'mass', 'link-71');">mass</a></tt> <tt class="py-keyword">import</tt> <tt id="link-72" class="py-name" targets="Function lib.structure.mass.centre_of_mass()=lib.structure.mass-module.html#centre_of_mass"><a title="lib.structure.mass.centre_of_mass" class="py-name" href="#" onclick="return doclink('link-72', 'centre_of_mass', 'link-72');">centre_of_mass</a></tt> </tt>
<a name="L57"></a><tt class="py-lineno">  57</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-73" class="py-name" targets="Package specific_analyses=specific_analyses-module.html"><a title="specific_analyses" class="py-name" href="#" onclick="return doclink('link-73', 'specific_analyses', 'link-73');">specific_analyses</a></tt><tt class="py-op">.</tt><tt id="link-74" class="py-name" targets="Module specific_analyses.api_base=specific_analyses.api_base-module.html"><a title="specific_analyses.api_base" class="py-name" href="#" onclick="return doclink('link-74', 'api_base', 'link-74');">api_base</a></tt> <tt class="py-keyword">import</tt> <tt id="link-75" class="py-name" targets="Class specific_analyses.api_base.API_base=specific_analyses.api_base.API_base-class.html"><a title="specific_analyses.api_base.API_base" class="py-name" href="#" onclick="return doclink('link-75', 'API_base', 'link-75');">API_base</a></tt> </tt>
<a name="L58"></a><tt class="py-lineno">  58</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-76" class="py-name"><a title="specific_analyses" class="py-name" href="#" onclick="return doclink('link-76', 'specific_analyses', 'link-73');">specific_analyses</a></tt><tt class="py-op">.</tt><tt id="link-77" class="py-name" targets="Module specific_analyses.api_common=specific_analyses.api_common-module.html"><a title="specific_analyses.api_common" class="py-name" href="#" onclick="return doclink('link-77', 'api_common', 'link-77');">api_common</a></tt> <tt class="py-keyword">import</tt> <tt id="link-78" class="py-name" targets="Class specific_analyses.api_common.API_common=specific_analyses.api_common.API_common-class.html"><a title="specific_analyses.api_common.API_common" class="py-name" href="#" onclick="return doclink('link-78', 'API_common', 'link-78');">API_common</a></tt> </tt>
<a name="L59"></a><tt class="py-lineno">  59</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-79" class="py-name"><a title="specific_analyses" class="py-name" href="#" onclick="return doclink('link-79', 'specific_analyses', 'link-73');">specific_analyses</a></tt><tt class="py-op">.</tt><tt id="link-80" class="py-name" targets="Package specific_analyses.n_state_model=specific_analyses.n_state_model-module.html,Module target_functions.n_state_model=target_functions.n_state_model-module.html,Module test_suite.gui_tests.n_state_model=test_suite.gui_tests.n_state_model-module.html,Module test_suite.system_tests.n_state_model=test_suite.system_tests.n_state_model-module.html,Module user_functions.n_state_model=user_functions.n_state_model-module.html"><a title="specific_analyses.n_state_model
target_functions.n_state_model
test_suite.gui_tests.n_state_model
test_suite.system_tests.n_state_model
user_functions.n_state_model" class="py-name" href="#" onclick="return doclink('link-80', 'n_state_model', 'link-80');">n_state_model</a></tt><tt class="py-op">.</tt><tt id="link-81" class="py-name" targets="Module specific_analyses.n_state_model.data=specific_analyses.n_state_model.data-module.html,Module user_functions.data=user_functions.data-module.html"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-81', 'data', 'link-81');">data</a></tt> <tt class="py-keyword">import</tt> <tt id="link-82" class="py-name" targets="Function specific_analyses.n_state_model.data.base_data_types()=specific_analyses.n_state_model.data-module.html#base_data_types"><a title="specific_analyses.n_state_model.data.base_data_types" class="py-name" href="#" onclick="return doclink('link-82', 'base_data_types', 'link-82');">base_data_types</a></tt><tt class="py-op">,</tt> <tt id="link-83" class="py-name" targets="Function specific_analyses.n_state_model.data.calc_ave_dist()=specific_analyses.n_state_model.data-module.html#calc_ave_dist"><a title="specific_analyses.n_state_model.data.calc_ave_dist" class="py-name" href="#" onclick="return doclink('link-83', 'calc_ave_dist', 'link-83');">calc_ave_dist</a></tt><tt class="py-op">,</tt> <tt id="link-84" class="py-name" targets="Function specific_analyses.n_state_model.data.check_rdcs()=specific_analyses.n_state_model.data-module.html#check_rdcs"><a title="specific_analyses.n_state_model.data.check_rdcs" class="py-name" href="#" onclick="return doclink('link-84', 'check_rdcs', 'link-84');">check_rdcs</a></tt><tt class="py-op">,</tt> <tt id="link-85" class="py-name" targets="Function specific_analyses.n_state_model.data.num_data_points()=specific_analyses.n_state_model.data-module.html#num_data_points"><a title="specific_analyses.n_state_model.data.num_data_points" class="py-name" href="#" onclick="return doclink('link-85', 'num_data_points', 'link-85');">num_data_points</a></tt><tt class="py-op">,</tt> <tt id="link-86" class="py-name" targets="Function specific_analyses.n_state_model.data.opt_tensor()=specific_analyses.n_state_model.data-module.html#opt_tensor"><a title="specific_analyses.n_state_model.data.opt_tensor" class="py-name" href="#" onclick="return doclink('link-86', 'opt_tensor', 'link-86');">opt_tensor</a></tt><tt class="py-op">,</tt> <tt id="link-87" class="py-name" targets="Function specific_analyses.n_state_model.data.opt_uses_align_data()=specific_analyses.n_state_model.data-module.html#opt_uses_align_data"><a title="specific_analyses.n_state_model.data.opt_uses_align_data" class="py-name" href="#" onclick="return doclink('link-87', 'opt_uses_align_data', 'link-87');">opt_uses_align_data</a></tt><tt class="py-op">,</tt> <tt id="link-88" class="py-name" targets="Function specific_analyses.n_state_model.data.opt_uses_j_couplings()=specific_analyses.n_state_model.data-module.html#opt_uses_j_couplings"><a title="specific_analyses.n_state_model.data.opt_uses_j_couplings" class="py-name" href="#" onclick="return doclink('link-88', 'opt_uses_j_couplings', 'link-88');">opt_uses_j_couplings</a></tt><tt class="py-op">,</tt> <tt id="link-89" class="py-name" targets="Function specific_analyses.n_state_model.data.tensor_loop()=specific_analyses.n_state_model.data-module.html#tensor_loop"><a title="specific_analyses.n_state_model.data.tensor_loop" class="py-name" href="#" onclick="return doclink('link-89', 'tensor_loop', 'link-89');">tensor_loop</a></tt> </tt>
<a name="L60"></a><tt class="py-lineno">  60</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-90" class="py-name"><a title="specific_analyses" class="py-name" href="#" onclick="return doclink('link-90', 'specific_analyses', 'link-73');">specific_analyses</a></tt><tt class="py-op">.</tt><tt id="link-91" class="py-name"><a title="specific_analyses.n_state_model
target_functions.n_state_model
test_suite.gui_tests.n_state_model
test_suite.system_tests.n_state_model
user_functions.n_state_model" class="py-name" href="#" onclick="return doclink('link-91', 'n_state_model', 'link-80');">n_state_model</a></tt><tt class="py-op">.</tt><tt id="link-92" class="py-name" targets="Module specific_analyses.n_state_model.parameters=specific_analyses.n_state_model.parameters-module.html"><a title="specific_analyses.n_state_model.parameters" class="py-name" href="#" onclick="return doclink('link-92', 'parameters', 'link-92');">parameters</a></tt> <tt class="py-keyword">import</tt> <tt id="link-93" class="py-name" targets="Function specific_analyses.n_state_model.parameters.assemble_param_vector()=specific_analyses.n_state_model.parameters-module.html#assemble_param_vector"><a title="specific_analyses.n_state_model.parameters.assemble_param_vector" class="py-name" href="#" onclick="return doclink('link-93', 'assemble_param_vector', 'link-93');">assemble_param_vector</a></tt><tt class="py-op">,</tt> <tt id="link-94" class="py-name" targets="Function specific_analyses.n_state_model.parameters.assemble_scaling_matrix()=specific_analyses.n_state_model.parameters-module.html#assemble_scaling_matrix"><a title="specific_analyses.n_state_model.parameters.assemble_scaling_matrix" class="py-name" href="#" onclick="return doclink('link-94', 'assemble_scaling_matrix', 'link-94');">assemble_scaling_matrix</a></tt><tt class="py-op">,</tt> <tt id="link-95" class="py-name" targets="Function specific_analyses.n_state_model.parameters.disassemble_param_vector()=specific_analyses.n_state_model.parameters-module.html#disassemble_param_vector"><a title="specific_analyses.n_state_model.parameters.disassemble_param_vector" class="py-name" href="#" onclick="return doclink('link-95', 'disassemble_param_vector', 'link-95');">disassemble_param_vector</a></tt><tt class="py-op">,</tt> <tt id="link-96" class="py-name" targets="Function specific_analyses.n_state_model.parameters.linear_constraints()=specific_analyses.n_state_model.parameters-module.html#linear_constraints"><a title="specific_analyses.n_state_model.parameters.linear_constraints" class="py-name" href="#" onclick="return doclink('link-96', 'linear_constraints', 'link-96');">linear_constraints</a></tt><tt class="py-op">,</tt> <tt id="link-97" class="py-name" targets="Function specific_analyses.n_state_model.parameters.param_model_index()=specific_analyses.n_state_model.parameters-module.html#param_model_index"><a title="specific_analyses.n_state_model.parameters.param_model_index" class="py-name" href="#" onclick="return doclink('link-97', 'param_model_index', 'link-97');">param_model_index</a></tt><tt class="py-op">,</tt> <tt id="link-98" class="py-name" targets="Function specific_analyses.n_state_model.parameters.param_num()=specific_analyses.n_state_model.parameters-module.html#param_num"><a title="specific_analyses.n_state_model.parameters.param_num" class="py-name" href="#" onclick="return doclink('link-98', 'param_num', 'link-98');">param_num</a></tt><tt class="py-op">,</tt> <tt id="link-99" class="py-name" targets="Function specific_analyses.n_state_model.parameters.update_model()=specific_analyses.n_state_model.parameters-module.html#update_model"><a title="specific_analyses.n_state_model.parameters.update_model" class="py-name" href="#" onclick="return doclink('link-99', 'update_model', 'link-99');">update_model</a></tt> </tt>
<a name="L61"></a><tt class="py-lineno">  61</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-100" class="py-name" targets="Package target_functions=target_functions-module.html"><a title="target_functions" class="py-name" href="#" onclick="return doclink('link-100', 'target_functions', 'link-100');">target_functions</a></tt><tt class="py-op">.</tt><tt id="link-101" class="py-name"><a title="specific_analyses.n_state_model
target_functions.n_state_model
test_suite.gui_tests.n_state_model
test_suite.system_tests.n_state_model
user_functions.n_state_model" class="py-name" href="#" onclick="return doclink('link-101', 'n_state_model', 'link-80');">n_state_model</a></tt> <tt class="py-keyword">import</tt> <tt id="link-102" class="py-name" targets="Class target_functions.n_state_model.N_state_opt=target_functions.n_state_model.N_state_opt-class.html"><a title="target_functions.n_state_model.N_state_opt" class="py-name" href="#" onclick="return doclink('link-102', 'N_state_opt', 'link-102');">N_state_opt</a></tt> </tt>
<a name="L62"></a><tt class="py-lineno">  62</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-103" class="py-name"><a title="target_functions" class="py-name" href="#" onclick="return doclink('link-103', 'target_functions', 'link-100');">target_functions</a></tt><tt class="py-op">.</tt><tt id="link-104" class="py-name" targets="Module target_functions.potential=target_functions.potential-module.html"><a title="target_functions.potential" class="py-name" href="#" onclick="return doclink('link-104', 'potential', 'link-104');">potential</a></tt> <tt class="py-keyword">import</tt> <tt id="link-105" class="py-name" targets="Function target_functions.potential.quad_pot()=target_functions.potential-module.html#quad_pot"><a title="target_functions.potential.quad_pot" class="py-name" href="#" onclick="return doclink('link-105', 'quad_pot', 'link-105');">quad_pot</a></tt> </tt>
<a name="L63"></a><tt class="py-lineno">  63</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-106" class="py-name" targets="Package user_functions=user_functions-module.html"><a title="user_functions" class="py-name" href="#" onclick="return doclink('link-106', 'user_functions', 'link-106');">user_functions</a></tt><tt class="py-op">.</tt><tt id="link-107" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-107', 'data', 'link-81');">data</a></tt> <tt class="py-keyword">import</tt> <tt id="link-108" class="py-name" targets="Class user_functions.data.Uf_tables=user_functions.data.Uf_tables-class.html"><a title="user_functions.data.Uf_tables" class="py-name" href="#" onclick="return doclink('link-108', 'Uf_tables', 'link-108');">Uf_tables</a></tt><tt class="py-op">;</tt> <tt id="link-109" class="py-name" targets="Variable colour.uf_tables=colour-module.html#uf_tables,Variable docs.latex.fetch_docstrings.uf_tables=docs.latex.fetch_docstrings-module.html#uf_tables,Variable gui.uf_objects.uf_tables=gui.uf_objects-module.html#uf_tables,Variable gui.wizards.peak_intensity.uf_tables=gui.wizards.peak_intensity-module.html#uf_tables,Variable pipe_control.diffusion_tensor.uf_tables=pipe_control.diffusion_tensor-module.html#uf_tables,Variable pipe_control.minimise.uf_tables=pipe_control.minimise-module.html#uf_tables,Variable pipe_control.selection.uf_tables=pipe_control.selection-module.html#uf_tables,Variable prompt.uf_docstring.uf_tables=prompt.uf_docstring-module.html#uf_tables,Variable specific_analyses.consistency_tests.uf_tables=specific_analyses.consistency_tests-module.html#uf_tables,Variable specific_analyses.jw_mapping.uf_tables=specific_analyses.jw_mapping-module.html#uf_tables,Variable specific_analyses.model_free.macro_base.uf_tables=specific_analyses.model_free.macro_base-module.html#uf_tables,Variable specific_analyses.model_free.main.uf_tables=specific_analyses.model_free.main-module.html#uf_tables,Variable specific_analyses.n_state_model.uf_tables=specific_analyses.n_state_model-module.html#uf_tables,Variable specific_analyses.noe.main.uf_tables=specific_analyses.noe.main-module.html#uf_tables,Variable specific_analyses.relax_fit.uf_tables=specific_analyses.relax_fit-module.html#uf_tables,Variable user_functions.dx.uf_tables=user_functions.dx-module.html#uf_tables,Variable user_functions.minimisation.uf_tables=user_functions.minimisation-module.html#uf_tables,Variable user_functions.spectrum.uf_tables=user_functions.spectrum-module.html#uf_tables,Variable user_functions.structure.uf_tables=user_functions.structure-module.html#uf_tables,Variable user_functions.value.uf_tables=user_functions.value-module.html#uf_tables"><a title="colour.uf_tables
docs.latex.fetch_docstrings.uf_tables
gui.uf_objects.uf_tables
gui.wizards.peak_intensity.uf_tables
pipe_control.diffusion_tensor.uf_tables
pipe_control.minimise.uf_tables
pipe_control.selection.uf_tables
prompt.uf_docstring.uf_tables
specific_analyses.consistency_tests.uf_tables
specific_analyses.jw_mapping.uf_tables
specific_analyses.model_free.macro_base.uf_tables
specific_analyses.model_free.main.uf_tables
specific_analyses.n_state_model.uf_tables
specific_analyses.noe.main.uf_tables
specific_analyses.relax_fit.uf_tables
user_functions.dx.uf_tables
user_functions.minimisation.uf_tables
user_functions.spectrum.uf_tables
user_functions.structure.uf_tables
user_functions.value.uf_tables" class="py-name" href="#" onclick="return doclink('link-109', 'uf_tables', 'link-109');">uf_tables</a></tt> <tt class="py-op">=</tt> <tt id="link-110" class="py-name"><a title="user_functions.data.Uf_tables" class="py-name" href="#" onclick="return doclink('link-110', 'Uf_tables', 'link-108');">Uf_tables</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L64"></a><tt class="py-lineno">  64</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-111" class="py-name"><a title="user_functions" class="py-name" href="#" onclick="return doclink('link-111', 'user_functions', 'link-106');">user_functions</a></tt><tt class="py-op">.</tt><tt id="link-112" class="py-name" targets="Module lib.spectrum.objects=lib.spectrum.objects-module.html,Module user_functions.objects=user_functions.objects-module.html"><a title="lib.spectrum.objects
user_functions.objects" class="py-name" href="#" onclick="return doclink('link-112', 'objects', 'link-112');">objects</a></tt> <tt class="py-keyword">import</tt> <tt id="link-113" class="py-name" targets="Class user_functions.objects.Desc_container=user_functions.objects.Desc_container-class.html"><a title="user_functions.objects.Desc_container" class="py-name" href="#" onclick="return doclink('link-113', 'Desc_container', 'link-113');">Desc_container</a></tt> </tt>
<a name="L65"></a><tt class="py-lineno">  65</tt>  <tt class="py-line"> </tt>
<a name="L66"></a><tt class="py-lineno">  66</tt>  <tt class="py-line"> </tt>
<a name="N_state_model"></a><div id="N_state_model-def"><a name="L67"></a><tt class="py-lineno">  67</tt> <a class="py-toggle" href="#" id="N_state_model-toggle" onclick="return toggle('N_state_model');">-</a><tt class="py-line"><tt class="py-keyword">class</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html">N_state_model</a><tt class="py-op">(</tt><tt class="py-base-class">API_base</tt><tt class="py-op">,</tt> <tt class="py-base-class">API_common</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="N_state_model-expanded"><a name="L68"></a><tt class="py-lineno">  68</tt>  <tt class="py-line">    <tt class="py-docstring">"""Class containing functions for the N-state model."""</tt> </tt>
<a name="L69"></a><tt class="py-lineno">  69</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.__init__"></a><div id="N_state_model.__init__-def"><a name="L70"></a><tt class="py-lineno">  70</tt> <a class="py-toggle" href="#" id="N_state_model.__init__-toggle" onclick="return toggle('N_state_model.__init__');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#__init__">__init__</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.__init__-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model.__init__-expanded"><a name="L71"></a><tt class="py-lineno">  71</tt>  <tt class="py-line">        <tt class="py-docstring">"""Initialise the class by placing API_common methods into the API."""</tt> </tt>
<a name="L72"></a><tt class="py-lineno">  72</tt>  <tt class="py-line"> </tt>
<a name="L73"></a><tt class="py-lineno">  73</tt>  <tt class="py-line">        <tt class="py-comment"># Execute the base class __init__ method.</tt> </tt>
<a name="L74"></a><tt class="py-lineno">  74</tt>  <tt class="py-line">        <tt class="py-name">super</tt><tt class="py-op">(</tt><tt id="link-114" class="py-name" targets="Class specific_analyses.n_state_model.N_state_model=specific_analyses.n_state_model.N_state_model-class.html,Class test_suite.gui_tests.n_state_model.N_state_model=test_suite.gui_tests.n_state_model.N_state_model-class.html,Class test_suite.system_tests.n_state_model.N_state_model=test_suite.system_tests.n_state_model.N_state_model-class.html"><a title="specific_analyses.n_state_model.N_state_model
test_suite.gui_tests.n_state_model.N_state_model
test_suite.system_tests.n_state_model.N_state_model" class="py-name" href="#" onclick="return doclink('link-114', 'N_state_model', 'link-114');">N_state_model</a></tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt id="link-115" class="py-name" targets="Method auto_analyses.dauvergne_protocol.dAuvergne_protocol.__init__()=auto_analyses.dauvergne_protocol.dAuvergne_protocol-class.html#__init__,Method auto_analyses.frame_order.Frame_order_analysis.__init__()=auto_analyses.frame_order.Frame_order_analysis-class.html#__init__,Method auto_analyses.noe.NOE_calc.__init__()=auto_analyses.noe.NOE_calc-class.html#__init__,Method auto_analyses.relax_fit.Relax_fit.__init__()=auto_analyses.relax_fit.Relax_fit-class.html#__init__,Method auto_analyses.stereochem_analysis.Stereochem_analysis.__init__()=auto_analyses.stereochem_analysis.Stereochem_analysis-class.html#__init__,Method bmrblib.NMR_parameters.chem_shift_anisotropy.CSAnisotropy.__init__()=bmrblib.NMR_parameters.chem_shift_anisotropy.CSAnisotropy-class.html#__init__,Method bmrblib.NMR_parameters.chem_shift_anisotropy.CSAnisotropyExperiment.__init__()=bmrblib.NMR_parameters.chem_shift_anisotropy.CSAnisotropyExperiment-class.html#__init__,Method bmrblib.NMR_parameters.chem_shift_anisotropy.ChemShiftAnisotropy.__init__()=bmrblib.NMR_parameters.chem_shift_anisotropy.ChemShiftAnisotropy-class.html#__init__,Method bmrblib.NMR_parameters.chem_shift_anisotropy_v3_1.CSAnisotropyExperiment_v3_1.__init__()=bmrblib.NMR_parameters.chem_shift_anisotropy_v3_1.CSAnisotropyExperiment_v3_1-class.html#__init__,Method bmrblib.NMR_parameters.chem_shift_anisotropy_v3_1.CSAnisotropySoftware_v3_1.__init__()=bmrblib.NMR_parameters.chem_shift_anisotropy_v3_1.CSAnisotropySoftware_v3_1-class.html#__init__,Method bmrblib.NMR_parameters.chem_shift_anisotropy_v3_1.CSAnisotropy_v3_1.__init__()=bmrblib.NMR_parameters.chem_shift_anisotropy_v3_1.CSAnisotropy_v3_1-class.html#__init__,Method bmrblib.NMR_parameters.chem_shift_anisotropy_v3_1.ChemShiftAnisotropy_v3_1.__init__()=bmrblib.NMR_parameters.chem_shift_anisotropy_v3_1.ChemShiftAnisotropy_v3_1-class.html#__init__,Method bmrblib.assembly_supercategory.entity.Entity.__init__()=bmrblib.assembly_supercategory.entity.Entity-class.html#__init__,Method bmrblib.assembly_supercategory.entity.EntityCompIndex.__init__()=bmrblib.assembly_supercategory.entity.EntityCompIndex-class.html#__init__,Method bmrblib.assembly_supercategory.entity_v2_1.EntityCompIndex_v2_1.__init__()=bmrblib.assembly_supercategory.entity_v2_1.EntityCompIndex_v2_1-class.html#__init__,Method bmrblib.assembly_supercategory.entity_v2_1.Entity_v2_1.__init__()=bmrblib.assembly_supercategory.entity_v2_1.Entity_v2_1-class.html#__init__,Method bmrblib.assembly_supercategory.entity_v3_1.EntityCompIndex_v3_1.__init__()=bmrblib.assembly_supercategory.entity_v3_1.EntityCompIndex_v3_1-class.html#__init__,Method bmrblib.assembly_supercategory.entity_v3_1.Entity_v3_1.__init__()=bmrblib.assembly_supercategory.entity_v3_1.Entity_v3_1-class.html#__init__,Method bmrblib.base_classes.BaseSaveframe.__init__()=bmrblib.base_classes.BaseSaveframe-class.html#__init__,Method bmrblib.base_classes.MissingSaveframe.__init__()=bmrblib.base_classes.MissingSaveframe-class.html#__init__,Method bmrblib.base_classes.TagCategory.__init__()=bmrblib.base_classes.TagCategory-class.html#__init__,Method bmrblib.base_classes.TagCategoryFree.__init__()=bmrblib.base_classes.TagCategoryFree-class.html#__init__,Method bmrblib.base_classes.TagObject.__init__()=bmrblib.base_classes.TagObject-class.html#__init__,Method bmrblib.base_classes.TagTranslationTable.__init__()=bmrblib.base_classes.TagTranslationTable-class.html#__init__,Method bmrblib.citations.citations.Citations.__init__()=bmrblib.citations.citations.Citations-class.html#__init__,Method bmrblib.citations.citations.CitationsAuthor.__init__()=bmrblib.citations.citations.CitationsAuthor-class.html#__init__,Method bmrblib.citations.citations_v3_1.CitationsAuthor_v3_1.__init__()=bmrblib.citations.citations_v3_1.CitationsAuthor_v3_1-class.html#__init__,Method bmrblib.citations.citations_v3_1.Citations_v3_1.__init__()=bmrblib.citations.citations_v3_1.Citations_v3_1-class.html#__init__,Method bmrblib.experimental_details.experiment.Experiment.__init__()=bmrblib.experimental_details.experiment.Experiment-class.html#__init__,Method bmrblib.experimental_details.experiment.ExperimentList.__init__()=bmrblib.experimental_details.experiment.ExperimentList-class.html#__init__,Method bmrblib.experimental_details.experiment_v3_1.ExperimentList_v3_1.__init__()=bmrblib.experimental_details.experiment_v3_1.ExperimentList_v3_1-class.html#__init__,Method bmrblib.experimental_details.experiment_v3_1.Experiment_v3_1.__init__()=bmrblib.experimental_details.experiment_v3_1.Experiment_v3_1-class.html#__init__,Method bmrblib.experimental_details.method.Method.__init__()=bmrblib.experimental_details.method.Method-class.html#__init__,Method bmrblib.experimental_details.method.MethodCitation.__init__()=bmrblib.experimental_details.method.MethodCitation-class.html#__init__,Method bmrblib.experimental_details.method.MethodFile.__init__()=bmrblib.experimental_details.method.MethodFile-class.html#__init__,Method bmrblib.experimental_details.method.MethodParam.__init__()=bmrblib.experimental_details.method.MethodParam-class.html#__init__,Method bmrblib.experimental_details.method_v3_1.MethodCitation_v3_1.__init__()=bmrblib.experimental_details.method_v3_1.MethodCitation_v3_1-class.html#__init__,Method bmrblib.experimental_details.method_v3_1.MethodFile_v3_1.__init__()=bmrblib.experimental_details.method_v3_1.MethodFile_v3_1-class.html#__init__,Method bmrblib.experimental_details.method_v3_1.MethodParam_v3_1.__init__()=bmrblib.experimental_details.method_v3_1.MethodParam_v3_1-class.html#__init__,Method bmrblib.experimental_details.method_v3_1.Method_v3_1.__init__()=bmrblib.experimental_details.method_v3_1.Method_v3_1-class.html#__init__,Method bmrblib.experimental_details.nmr_spectrometer.NMRSpectrometer.__init__()=bmrblib.experimental_details.nmr_spectrometer.NMRSpectrometer-class.html#__init__,Method bmrblib.experimental_details.nmr_spectrometer_v3_1.NMRSpectrometer_v3_1.__init__()=bmrblib.experimental_details.nmr_spectrometer_v3_1.NMRSpectrometer_v3_1-class.html#__init__,Method bmrblib.experimental_details.sample_conditions.SampleConditionCitation.__init__()=bmrblib.experimental_details.sample_conditions.SampleConditionCitation-class.html#__init__,Method bmrblib.experimental_details.sample_conditions.SampleConditionList.__init__()=bmrblib.experimental_details.sample_conditions.SampleConditionList-class.html#__init__,Method bmrblib.experimental_details.sample_conditions.SampleConditionVariable.__init__()=bmrblib.experimental_details.sample_conditions.SampleConditionVariable-class.html#__init__,Method bmrblib.experimental_details.sample_conditions_v2_1.SampleConditionList_v2_1.__init__()=bmrblib.experimental_details.sample_conditions_v2_1.SampleConditionList_v2_1-class.html#__init__,Method bmrblib.experimental_details.sample_conditions_v2_1.SampleConditionVariable_v2_1.__init__()=bmrblib.experimental_details.sample_conditions_v2_1.SampleConditionVariable_v2_1-class.html#__init__,Method bmrblib.experimental_details.sample_conditions_v3_1.SampleConditionCitation_v3_1.__init__()=bmrblib.experimental_details.sample_conditions_v3_1.SampleConditionCitation_v3_1-class.html#__init__,Method bmrblib.experimental_details.sample_conditions_v3_1.SampleConditionList_v3_1.__init__()=bmrblib.experimental_details.sample_conditions_v3_1.SampleConditionList_v3_1-class.html#__init__,Method bmrblib.experimental_details.sample_conditions_v3_1.SampleConditionVariable_v3_1.__init__()=bmrblib.experimental_details.sample_conditions_v3_1.SampleConditionVariable_v3_1-class.html#__init__,Method bmrblib.experimental_details.software.Software.__init__()=bmrblib.experimental_details.software.Software-class.html#__init__,Method bmrblib.experimental_details.software.SoftwareCitation.__init__()=bmrblib.experimental_details.software.SoftwareCitation-class.html#__init__,Method bmrblib.experimental_details.software.Task.__init__()=bmrblib.experimental_details.software.Task-class.html#__init__,Method bmrblib.experimental_details.software.Vendor.__init__()=bmrblib.experimental_details.software.Vendor-class.html#__init__,Method bmrblib.experimental_details.software_v3_1.SoftwareCitation_v3_1.__init__()=bmrblib.experimental_details.software_v3_1.SoftwareCitation_v3_1-class.html#__init__,Method bmrblib.experimental_details.software_v3_1.Software_v3_1.__init__()=bmrblib.experimental_details.software_v3_1.Software_v3_1-class.html#__init__,Method bmrblib.experimental_details.software_v3_1.Task_v3_1.__init__()=bmrblib.experimental_details.software_v3_1.Task_v3_1-class.html#__init__,Method bmrblib.experimental_details.software_v3_1.Vendor_v3_1.__init__()=bmrblib.experimental_details.software_v3_1.Vendor_v3_1-class.html#__init__,Method bmrblib.kinetics.auto_relaxation.AutoRelaxation.__init__()=bmrblib.kinetics.auto_relaxation.AutoRelaxation-class.html#__init__,Method bmrblib.kinetics.auto_relaxation.AutoRelaxationExperiment.__init__()=bmrblib.kinetics.auto_relaxation.AutoRelaxationExperiment-class.html#__init__,Method bmrblib.kinetics.auto_relaxation.AutoRelaxationList.__init__()=bmrblib.kinetics.auto_relaxation.AutoRelaxationList-class.html#__init__,Method bmrblib.kinetics.auto_relaxation.AutoRelaxationSoftware.__init__()=bmrblib.kinetics.auto_relaxation.AutoRelaxationSoftware-class.html#__init__,Method bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationExperiment_v3_1.__init__()=bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationExperiment_v3_1-class.html#__init__,Method bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationList_v3_1.__init__()=bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationList_v3_1-class.html#__init__,Method bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSoftware_v3_1.__init__()=bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSoftware_v3_1-class.html#__init__,Method bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxation_v3_1.__init__()=bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxation_v3_1-class.html#__init__,Method bmrblib.kinetics.heteronucl_NOEs.HeteronuclNOE.__init__()=bmrblib.kinetics.heteronucl_NOEs.HeteronuclNOE-class.html#__init__,Method bmrblib.kinetics.heteronucl_NOEs.HeteronuclNOEExperiment.__init__()=bmrblib.kinetics.heteronucl_NOEs.HeteronuclNOEExperiment-class.html#__init__,Method bmrblib.kinetics.heteronucl_NOEs.HeteronuclNOEList.__init__()=bmrblib.kinetics.heteronucl_NOEs.HeteronuclNOEList-class.html#__init__,Method bmrblib.kinetics.heteronucl_NOEs.HeteronuclNOESoftware.__init__()=bmrblib.kinetics.heteronucl_NOEs.HeteronuclNOESoftware-class.html#__init__,Method bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOEExperiment_v2_1.__init__()=bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOEExperiment_v2_1-class.html#__init__,Method bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOEList_v2_1.__init__()=bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOEList_v2_1-class.html#__init__,Method bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESoftware_v2_1.__init__()=bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESoftware_v2_1-class.html#__init__,Method bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOE_v2_1.__init__()=bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOE_v2_1-class.html#__init__,Method bmrblib.kinetics.heteronucl_NOEs_v3_1.HeteronuclNOEExperiment_v3_1.__init__()=bmrblib.kinetics.heteronucl_NOEs_v3_1.HeteronuclNOEExperiment_v3_1-class.html#__init__,Method bmrblib.kinetics.heteronucl_NOEs_v3_1.HeteronuclNOEList_v3_1.__init__()=bmrblib.kinetics.heteronucl_NOEs_v3_1.HeteronuclNOEList_v3_1-class.html#__init__,Method bmrblib.kinetics.heteronucl_NOEs_v3_1.HeteronuclNOESoftware_v3_1.__init__()=bmrblib.kinetics.heteronucl_NOEs_v3_1.HeteronuclNOESoftware_v3_1-class.html#__init__,Method bmrblib.kinetics.heteronucl_NOEs_v3_1.HeteronuclNOE_v3_1.__init__()=bmrblib.kinetics.heteronucl_NOEs_v3_1.HeteronuclNOE_v3_1-class.html#__init__,Method bmrblib.kinetics.heteronucl_T1_relaxation.HeteronuclT1Experiment.__init__()=bmrblib.kinetics.heteronucl_T1_relaxation.HeteronuclT1Experiment-class.html#__init__,Method bmrblib.kinetics.heteronucl_T1_relaxation.HeteronuclT1List.__init__()=bmrblib.kinetics.heteronucl_T1_relaxation.HeteronuclT1List-class.html#__init__,Method bmrblib.kinetics.heteronucl_T1_relaxation.HeteronuclT1Software.__init__()=bmrblib.kinetics.heteronucl_T1_relaxation.HeteronuclT1Software-class.html#__init__,Method bmrblib.kinetics.heteronucl_T1_relaxation.T1.__init__()=bmrblib.kinetics.heteronucl_T1_relaxation.T1-class.html#__init__,Method bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Experiment_v2_1.__init__()=bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Experiment_v2_1-class.html#__init__,Method bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1List_v2_1.__init__()=bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1List_v2_1-class.html#__init__,Method bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Software_v2_1.__init__()=bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Software_v2_1-class.html#__init__,Method bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.T1_v2_1.__init__()=bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.T1_v2_1-class.html#__init__,Method bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Experiment_v3_1.__init__()=bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Experiment_v3_1-class.html#__init__,Method bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1List_v3_1.__init__()=bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1List_v3_1-class.html#__init__,Method bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Software_v3_1.__init__()=bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Software_v3_1-class.html#__init__,Method bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.T1_v3_1.__init__()=bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.T1_v3_1-class.html#__init__,Method bmrblib.kinetics.heteronucl_T2_relaxation.HeteronuclT2Experiment.__init__()=bmrblib.kinetics.heteronucl_T2_relaxation.HeteronuclT2Experiment-class.html#__init__,Method bmrblib.kinetics.heteronucl_T2_relaxation.HeteronuclT2List.__init__()=bmrblib.kinetics.heteronucl_T2_relaxation.HeteronuclT2List-class.html#__init__,Method bmrblib.kinetics.heteronucl_T2_relaxation.HeteronuclT2Software.__init__()=bmrblib.kinetics.heteronucl_T2_relaxation.HeteronuclT2Software-class.html#__init__,Method bmrblib.kinetics.heteronucl_T2_relaxation.T2.__init__()=bmrblib.kinetics.heteronucl_T2_relaxation.T2-class.html#__init__,Method bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Experiment_v2_1.__init__()=bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Experiment_v2_1-class.html#__init__,Method bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2List_v2_1.__init__()=bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2List_v2_1-class.html#__init__,Method bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Software_v2_1.__init__()=bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Software_v2_1-class.html#__init__,Method bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.T2_v2_1.__init__()=bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.T2_v2_1-class.html#__init__,Method bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Experiment_v3_1.__init__()=bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Experiment_v3_1-class.html#__init__,Method bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2List_v3_1.__init__()=bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2List_v3_1-class.html#__init__,Method bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Software_v3_1.__init__()=bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Software_v3_1-class.html#__init__,Method bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.T2_v3_1.__init__()=bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.T2_v3_1-class.html#__init__,Method bmrblib.kinetics.relaxation.Relaxation_v2_1.__init__()=bmrblib.kinetics.relaxation.Relaxation_v2_1-class.html#__init__,Method bmrblib.kinetics.relaxation.Relaxation_v3_0.__init__()=bmrblib.kinetics.relaxation.Relaxation_v3_0-class.html#__init__,Method bmrblib.kinetics.relaxation.Relaxation_v3_1.__init__()=bmrblib.kinetics.relaxation.Relaxation_v3_1-class.html#__init__,Method bmrblib.nmr_star_dict.NMR_STAR.__init__()=bmrblib.nmr_star_dict.NMR_STAR-class.html#__init__,Method bmrblib.pystarlib.File.File.__init__()=bmrblib.pystarlib.File.File-class.html#__init__,Method bmrblib.pystarlib.SaveFrame.SaveFrame.__init__()=bmrblib.pystarlib.SaveFrame.SaveFrame-class.html#__init__,Method bmrblib.pystarlib.TagTable.TagTable.__init__()=bmrblib.pystarlib.TagTable.TagTable-class.html#__init__,Method bmrblib.structure.tensor.Tensor.__init__()=bmrblib.structure.tensor.Tensor-class.html#__init__,Method bmrblib.structure.tensor.TensorList.__init__()=bmrblib.structure.tensor.TensorList-class.html#__init__,Method bmrblib.thermodynamics.model_free.ModelFree.__init__()=bmrblib.thermodynamics.model_free.ModelFree-class.html#__init__,Method bmrblib.thermodynamics.model_free.ModelFreeExperiment.__init__()=bmrblib.thermodynamics.model_free.ModelFreeExperiment-class.html#__init__,Method bmrblib.thermodynamics.model_free.ModelFreeList.__init__()=bmrblib.thermodynamics.model_free.ModelFreeList-class.html#__init__,Method bmrblib.thermodynamics.model_free.ModelFreeSoftware.__init__()=bmrblib.thermodynamics.model_free.ModelFreeSoftware-class.html#__init__,Method bmrblib.thermodynamics.model_free_v3_1.ModelFreeExperiment_v3_1.__init__()=bmrblib.thermodynamics.model_free_v3_1.ModelFreeExperiment_v3_1-class.html#__init__,Method bmrblib.thermodynamics.model_free_v3_1.ModelFreeList_v3_1.__init__()=bmrblib.thermodynamics.model_free_v3_1.ModelFreeList_v3_1-class.html#__init__,Method bmrblib.thermodynamics.model_free_v3_1.ModelFreeSoftware_v3_1.__init__()=bmrblib.thermodynamics.model_free_v3_1.ModelFreeSoftware_v3_1-class.html#__init__,Method bmrblib.thermodynamics.model_free_v3_1.ModelFree_v3_1.__init__()=bmrblib.thermodynamics.model_free_v3_1.ModelFree_v3_1-class.html#__init__,Method compat.TaskQueue.__init__()=compat.TaskQueue-class.html#__init__,Method data_store.align_tensor.AlignTensorData.__init__()=data_store.align_tensor.AlignTensorData-class.html#__init__,Method data_store.align_tensor.AlignTensorSimList.__init__()=data_store.align_tensor.AlignTensorSimList-class.html#__init__,Method data_store.data_classes.Element.__init__()=data_store.data_classes.Element-class.html#__init__,Method data_store.data_classes.RelaxListType.__init__()=data_store.data_classes.RelaxListType-class.html#__init__,Method data_store.diff_tensor.DiffTensorData.__init__()=data_store.diff_tensor.DiffTensorData-class.html#__init__,Method data_store.diff_tensor.DiffTensorSimList.__init__()=data_store.diff_tensor.DiffTensorSimList-class.html#__init__,Method data_store.exp_info.ExpInfo.__init__()=data_store.exp_info.ExpInfo-class.html#__init__,Method data_store.gui.Analyses.__init__()=data_store.gui.Analyses-class.html#__init__,Method data_store.gui.Free_file_format.__init__()=data_store.gui.Free_file_format-class.html#__init__,Method data_store.gui.Gui.__init__()=data_store.gui.Gui-class.html#__init__,Method data_store.interatomic.InteratomContainer.__init__()=data_store.interatomic.InteratomContainer-class.html#__init__,Method data_store.mol_res_spin.MoleculeContainer.__init__()=data_store.mol_res_spin.MoleculeContainer-class.html#__init__,Method data_store.mol_res_spin.MoleculeList.__init__()=data_store.mol_res_spin.MoleculeList-class.html#__init__,Method data_store.mol_res_spin.ResidueContainer.__init__()=data_store.mol_res_spin.ResidueContainer-class.html#__init__,Method data_store.mol_res_spin.ResidueList.__init__()=data_store.mol_res_spin.ResidueList-class.html#__init__,Method data_store.mol_res_spin.SpinContainer.__init__()=data_store.mol_res_spin.SpinContainer-class.html#__init__,Method data_store.mol_res_spin.SpinList.__init__()=data_store.mol_res_spin.SpinList-class.html#__init__,Method data_store.pipe_container.PipeContainer.__init__()=data_store.pipe_container.PipeContainer-class.html#__init__,Method docs.latex.fetch_docstrings.Fetch_docstrings.__init__()=docs.latex.fetch_docstrings.Fetch_docstrings-class.html#__init__,Method gui.App.__init__()=gui.App-class.html#__init__,Method gui.about.About_base.__init__()=gui.about.About_base-class.html#__init__,Method gui.about.About_relax.__init__()=gui.about.About_relax-class.html#__init__,Method gui.analyses.Analysis_controller.__init__()=gui.analyses.Analysis_controller-class.html#__init__,Method gui.analyses.auto_model_free.About_window.__init__()=gui.analyses.auto_model_free.About_window-class.html#__init__,Method gui.analyses.auto_model_free.Auto_model_free.__init__()=gui.analyses.auto_model_free.Auto_model_free-class.html#__init__,Method gui.analyses.auto_model_free.Protocol_mode_sel_window.__init__()=gui.analyses.auto_model_free.Protocol_mode_sel_window-class.html#__init__,Method gui.analyses.auto_noe.Auto_noe.__init__()=gui.analyses.auto_noe.Auto_noe-class.html#__init__,Method gui.analyses.auto_rx_base.Auto_rx.__init__()=gui.analyses.auto_rx_base.Auto_rx-class.html#__init__,Method gui.analyses.base.Base_analysis.__init__()=gui.analyses.base.Base_analysis-class.html#__init__,Method gui.analyses.elements.bool_element.Boolean_ctrl.__init__()=gui.analyses.elements.bool_element.Boolean_ctrl-class.html#__init__,Method gui.analyses.elements.model_list.ModelSelListCtrl.__init__()=gui.analyses.elements.model_list.ModelSelListCtrl-class.html#__init__,Method gui.analyses.elements.model_list.Model_list.__init__()=gui.analyses.elements.model_list.Model_list-class.html#__init__,Method gui.analyses.elements.model_list.Model_sel_window.__init__()=gui.analyses.elements.model_list.Model_sel_window-class.html#__init__,Method gui.analyses.elements.spin_element.Spin_ctrl.__init__()=gui.analyses.elements.spin_element.Spin_ctrl-class.html#__init__,Method gui.analyses.elements.text_element.Text_ctrl.__init__()=gui.analyses.elements.text_element.Text_ctrl-class.html#__init__,Method gui.analyses.execute.Execute.__init__()=gui.analyses.execute.Execute-class.html#__init__,Method gui.components.base_list.Base_list.__init__()=gui.components.base_list.Base_list-class.html#__init__,Method gui.components.free_file_format.Free_file_format.__init__()=gui.components.free_file_format.Free_file_format-class.html#__init__,Method gui.components.free_file_format.Free_file_format_window.__init__()=gui.components.free_file_format.Free_file_format_window-class.html#__init__,Method gui.components.grid.Delay_num_cell_editor.__init__()=gui.components.grid.Delay_num_cell_editor-class.html#__init__,Method gui.components.grid.Grid_base.__init__()=gui.components.grid.Grid_base-class.html#__init__,Method gui.components.relax_data.Metadata_window.__init__()=gui.components.relax_data.Metadata_window-class.html#__init__,Method gui.components.spectrum.Spectra_list.__init__()=gui.components.spectrum.Spectra_list-class.html#__init__,Method gui.controller.Controller.__init__()=gui.controller.Controller-class.html#__init__,Method gui.controller.LogCtrl.__init__()=gui.controller.LogCtrl-class.html#__init__,Method gui.controller.Redirect_text.__init__()=gui.controller.Redirect_text-class.html#__init__,Method gui.export_bmrb.Export_bmrb_window.__init__()=gui.export_bmrb.Export_bmrb_window-class.html#__init__,Method gui.filedialog.RelaxDirDialog.__init__()=gui.filedialog.RelaxDirDialog-class.html#__init__,Method gui.filedialog.RelaxFileDialog.__init__()=gui.filedialog.RelaxFileDialog-class.html#__init__,Method gui.icons.Relax_task_bar_icon.__init__()=gui.icons.Relax_task_bar_icon-class.html#__init__,Method gui.input_elements.bool.Selector_bool.__init__()=gui.input_elements.bool.Selector_bool-class.html#__init__,Method gui.input_elements.combo_list.Combo_list.__init__()=gui.input_elements.combo_list.Combo_list-class.html#__init__,Method gui.input_elements.dir.Selector_dir.__init__()=gui.input_elements.dir.Selector_dir-class.html#__init__,Method gui.input_elements.file.Selector_file.__init__()=gui.input_elements.file.Selector_file-class.html#__init__,Method gui.input_elements.sequence.Sequence.__init__()=gui.input_elements.sequence.Sequence-class.html#__init__,Method gui.input_elements.sequence.Sequence_list_ctrl.__init__()=gui.input_elements.sequence.Sequence_list_ctrl-class.html#__init__,Method gui.input_elements.sequence.Sequence_window.__init__()=gui.input_elements.sequence.Sequence_window-class.html#__init__,Method gui.input_elements.sequence_2D.Sequence_2D.__init__()=gui.input_elements.sequence_2D.Sequence_2D-class.html#__init__,Method gui.input_elements.sequence_2D.Sequence_window_2D.__init__()=gui.input_elements.sequence_2D.Sequence_window_2D-class.html#__init__,Method gui.input_elements.spin_id.Spin_id.__init__()=gui.input_elements.spin_id.Spin_id-class.html#__init__,Method gui.input_elements.value.Value.__init__()=gui.input_elements.value.Value-class.html#__init__,Method gui.interpreter.Interpreter_thread.__init__()=gui.interpreter.Interpreter_thread-class.html#__init__,Method gui.menu.Menu.__init__()=gui.menu.Menu-class.html#__init__,Method gui.message.Missing_data.__init__()=gui.message.Missing_data-class.html#__init__,Method gui.message.Question.__init__()=gui.message.Question-class.html#__init__,Method gui.paths.I16x16.__init__()=gui.paths.I16x16-class.html#__init__,Method gui.paths.I22x22.__init__()=gui.paths.I22x22-class.html#__init__,Method gui.paths.I32x32.__init__()=gui.paths.I32x32-class.html#__init__,Method gui.paths.I48x48.__init__()=gui.paths.I48x48-class.html#__init__,Method gui.pipe_editor.Pipe_editor.__init__()=gui.pipe_editor.Pipe_editor-class.html#__init__,Method gui.references.References.__init__()=gui.references.References-class.html#__init__,Method gui.relax_gui.Main.__init__()=gui.relax_gui.Main-class.html#__init__,Method gui.relax_prompt.InterpClass.__init__()=gui.relax_prompt.InterpClass-class.html#__init__,Method gui.relax_prompt.Prompt.__init__()=gui.relax_prompt.Prompt-class.html#__init__,Method gui.relax_prompt._Exit.__init__()=gui.relax_prompt._Exit-class.html#__init__,Method gui.results_viewer.Results_viewer.__init__()=gui.results_viewer.Results_viewer-class.html#__init__,Method gui.spin_viewer.containers.Container.__init__()=gui.spin_viewer.containers.Container-class.html#__init__,Method gui.spin_viewer.containers.Molecule.__init__()=gui.spin_viewer.containers.Molecule-class.html#__init__,Method gui.spin_viewer.containers.Residue.__init__()=gui.spin_viewer.containers.Residue-class.html#__init__,Method gui.spin_viewer.containers.Root.__init__()=gui.spin_viewer.containers.Root-class.html#__init__,Method gui.spin_viewer.containers.Spin.__init__()=gui.spin_viewer.containers.Spin-class.html#__init__,Method gui.spin_viewer.frame.Spin_view_window.__init__()=gui.spin_viewer.frame.Spin_view_window-class.html#__init__,Method gui.spin_viewer.splitter.Tree_splitter.__init__()=gui.spin_viewer.splitter.Tree_splitter-class.html#__init__,Method gui.spin_viewer.tree.Mol_res_spin_tree.__init__()=gui.spin_viewer.tree.Mol_res_spin_tree-class.html#__init__,Method gui.uf_objects.Force_true.__init__()=gui.uf_objects.Force_true-class.html#__init__,Method gui.uf_objects.Uf_object.__init__()=gui.uf_objects.Uf_object-class.html#__init__,Method gui.uf_objects.Uf_page.__init__()=gui.uf_objects.Uf_page-class.html#__init__,Method gui.wizards.peak_intensity.Peak_intensity_wizard.__init__()=gui.wizards.peak_intensity.Peak_intensity_wizard-class.html#__init__,Method gui.wizards.wiz_objects.Wiz_page.__init__()=gui.wizards.wiz_objects.Wiz_page-class.html#__init__,Method gui.wizards.wiz_objects.Wiz_window.__init__()=gui.wizards.wiz_objects.Wiz_window-class.html#__init__,Method info.Info_box.__init__()=info.Info_box-class.html#__init__,Method info.MemoryStatusEx.__init__()=info.MemoryStatusEx-class.html#__init__,Method lib.errors.BaseArgError.__init__()=lib.errors.BaseArgError-class.html#__init__,Method lib.errors.RelaxAlignError.__init__()=lib.errors.RelaxAlignError-class.html#__init__,Method lib.errors.RelaxArgNotInListError.__init__()=lib.errors.RelaxArgNotInListError-class.html#__init__,Method lib.errors.RelaxArgNotNoneError.__init__()=lib.errors.RelaxArgNotNoneError-class.html#__init__,Method lib.errors.RelaxBundleError.__init__()=lib.errors.RelaxBundleError-class.html#__init__,Method lib.errors.RelaxDiffMolNumError.__init__()=lib.errors.RelaxDiffMolNumError-class.html#__init__,Method lib.errors.RelaxDiffResNumError.__init__()=lib.errors.RelaxDiffResNumError-class.html#__init__,Method lib.errors.RelaxDiffSeqError.__init__()=lib.errors.RelaxDiffSeqError-class.html#__init__,Method lib.errors.RelaxDiffSpinNumError.__init__()=lib.errors.RelaxDiffSpinNumError-class.html#__init__,Method lib.errors.RelaxDirError.__init__()=lib.errors.RelaxDirError-class.html#__init__,Method lib.errors.RelaxError.__init__()=lib.errors.RelaxError-class.html#__init__,Method lib.errors.RelaxFault.__init__()=lib.errors.RelaxFault-class.html#__init__,Method lib.errors.RelaxFileEmptyError.__init__()=lib.errors.RelaxFileEmptyError-class.html#__init__,Method lib.errors.RelaxFileError.__init__()=lib.errors.RelaxFileError-class.html#__init__,Method lib.errors.RelaxFileOverwriteError.__init__()=lib.errors.RelaxFileOverwriteError-class.html#__init__,Method lib.errors.RelaxFromXMLNotEmptyError.__init__()=lib.errors.RelaxFromXMLNotEmptyError-class.html#__init__,Method lib.errors.RelaxFuncSetupError.__init__()=lib.errors.RelaxFuncSetupError-class.html#__init__,Method lib.errors.RelaxImplementError.__init__()=lib.errors.RelaxImplementError-class.html#__init__,Method lib.errors.RelaxInfError.__init__()=lib.errors.RelaxInfError-class.html#__init__,Method lib.errors.RelaxInteratomError.__init__()=lib.errors.RelaxInteratomError-class.html#__init__,Method lib.errors.RelaxInteratomInconsistentError.__init__()=lib.errors.RelaxInteratomInconsistentError-class.html#__init__,Method lib.errors.RelaxInvalidColourError.__init__()=lib.errors.RelaxInvalidColourError-class.html#__init__,Method lib.errors.RelaxInvalidDataError.__init__()=lib.errors.RelaxInvalidDataError-class.html#__init__,Method lib.errors.RelaxInvalidError.__init__()=lib.errors.RelaxInvalidError-class.html#__init__,Method lib.errors.RelaxInvalidSeqError.__init__()=lib.errors.RelaxInvalidSeqError-class.html#__init__,Method lib.errors.RelaxJError.__init__()=lib.errors.RelaxJError-class.html#__init__,Method lib.errors.RelaxLenError.__init__()=lib.errors.RelaxLenError-class.html#__init__,Method lib.errors.RelaxMfError.__init__()=lib.errors.RelaxMfError-class.html#__init__,Method lib.errors.RelaxMissingBinaryError.__init__()=lib.errors.RelaxMissingBinaryError-class.html#__init__,Method lib.errors.RelaxModelError.__init__()=lib.errors.RelaxModelError-class.html#__init__,Method lib.errors.RelaxMolSelectDisallowError.__init__()=lib.errors.RelaxMolSelectDisallowError-class.html#__init__,Method lib.errors.RelaxMultiMolIDError.__init__()=lib.errors.RelaxMultiMolIDError-class.html#__init__,Method lib.errors.RelaxMultiResIDError.__init__()=lib.errors.RelaxMultiResIDError-class.html#__init__,Method lib.errors.RelaxMultiSpinIDError.__init__()=lib.errors.RelaxMultiSpinIDError-class.html#__init__,Method lib.errors.RelaxMultiVectorError.__init__()=lib.errors.RelaxMultiVectorError-class.html#__init__,Method lib.errors.RelaxNaNError.__init__()=lib.errors.RelaxNaNError-class.html#__init__,Method lib.errors.RelaxNoAlignError.__init__()=lib.errors.RelaxNoAlignError-class.html#__init__,Method lib.errors.RelaxNoBundleError.__init__()=lib.errors.RelaxNoBundleError-class.html#__init__,Method lib.errors.RelaxNoDomainError.__init__()=lib.errors.RelaxNoDomainError-class.html#__init__,Method lib.errors.RelaxNoFrqError.__init__()=lib.errors.RelaxNoFrqError-class.html#__init__,Method lib.errors.RelaxNoInPathError.__init__()=lib.errors.RelaxNoInPathError-class.html#__init__,Method lib.errors.RelaxNoInteratomError.__init__()=lib.errors.RelaxNoInteratomError-class.html#__init__,Method lib.errors.RelaxNoJError.__init__()=lib.errors.RelaxNoJError-class.html#__init__,Method lib.errors.RelaxNoModelError.__init__()=lib.errors.RelaxNoModelError-class.html#__init__,Method lib.errors.RelaxNoModuleInstallError.__init__()=lib.errors.RelaxNoModuleInstallError-class.html#__init__,Method lib.errors.RelaxNoPCSError.__init__()=lib.errors.RelaxNoPCSError-class.html#__init__,Method lib.errors.RelaxNoPdbChainError.__init__()=lib.errors.RelaxNoPdbChainError-class.html#__init__,Method lib.errors.RelaxNoPdbError.__init__()=lib.errors.RelaxNoPdbError-class.html#__init__,Method lib.errors.RelaxNoPeakIntensityError.__init__()=lib.errors.RelaxNoPeakIntensityError-class.html#__init__,Method lib.errors.RelaxNoPipeError.__init__()=lib.errors.RelaxNoPipeError-class.html#__init__,Method lib.errors.RelaxNoRDCError.__init__()=lib.errors.RelaxNoRDCError-class.html#__init__,Method lib.errors.RelaxNoResError.__init__()=lib.errors.RelaxNoResError-class.html#__init__,Method lib.errors.RelaxNoRiError.__init__()=lib.errors.RelaxNoRiError-class.html#__init__,Method lib.errors.RelaxNoSequenceError.__init__()=lib.errors.RelaxNoSequenceError-class.html#__init__,Method lib.errors.RelaxNoSimError.__init__()=lib.errors.RelaxNoSimError-class.html#__init__,Method lib.errors.RelaxNoSpectraError.__init__()=lib.errors.RelaxNoSpectraError-class.html#__init__,Method lib.errors.RelaxNoSpinError.__init__()=lib.errors.RelaxNoSpinError-class.html#__init__,Method lib.errors.RelaxNoSpinSpecError.__init__()=lib.errors.RelaxNoSpinSpecError-class.html#__init__,Method lib.errors.RelaxNoTensorError.__init__()=lib.errors.RelaxNoTensorError-class.html#__init__,Method lib.errors.RelaxNoValueError.__init__()=lib.errors.RelaxNoValueError-class.html#__init__,Method lib.errors.RelaxNoVectorsError.__init__()=lib.errors.RelaxNoVectorsError-class.html#__init__,Method lib.errors.RelaxNonExecError.__init__()=lib.errors.RelaxNonExecError-class.html#__init__,Method lib.errors.RelaxNoneError.__init__()=lib.errors.RelaxNoneError-class.html#__init__,Method lib.errors.RelaxNucleusError.__init__()=lib.errors.RelaxNucleusError-class.html#__init__,Method lib.errors.RelaxPCSError.__init__()=lib.errors.RelaxPCSError-class.html#__init__,Method lib.errors.RelaxParamSetError.__init__()=lib.errors.RelaxParamSetError-class.html#__init__,Method lib.errors.RelaxPdbError.__init__()=lib.errors.RelaxPdbError-class.html#__init__,Method lib.errors.RelaxPdbLoadError.__init__()=lib.errors.RelaxPdbLoadError-class.html#__init__,Method lib.errors.RelaxPipeError.__init__()=lib.errors.RelaxPipeError-class.html#__init__,Method lib.errors.RelaxProgError.__init__()=lib.errors.RelaxProgError-class.html#__init__,Method lib.errors.RelaxProgFailError.__init__()=lib.errors.RelaxProgFailError-class.html#__init__,Method lib.errors.RelaxRDCError.__init__()=lib.errors.RelaxRDCError-class.html#__init__,Method lib.errors.RelaxRegExpError.__init__()=lib.errors.RelaxRegExpError-class.html#__init__,Method lib.errors.RelaxResSelectDisallowError.__init__()=lib.errors.RelaxResSelectDisallowError-class.html#__init__,Method lib.errors.RelaxRiError.__init__()=lib.errors.RelaxRiError-class.html#__init__,Method lib.errors.RelaxSequenceError.__init__()=lib.errors.RelaxSequenceError-class.html#__init__,Method lib.errors.RelaxSpectraError.__init__()=lib.errors.RelaxSpectraError-class.html#__init__,Method lib.errors.RelaxSpinSelectDisallowError.__init__()=lib.errors.RelaxSpinSelectDisallowError-class.html#__init__,Method lib.errors.RelaxSpinTypeError.__init__()=lib.errors.RelaxSpinTypeError-class.html#__init__,Method lib.errors.RelaxSpinsNotLoadedError.__init__()=lib.errors.RelaxSpinsNotLoadedError-class.html#__init__,Method lib.errors.RelaxStyleError.__init__()=lib.errors.RelaxStyleError-class.html#__init__,Method lib.errors.RelaxTensorError.__init__()=lib.errors.RelaxTensorError-class.html#__init__,Method lib.errors.RelaxUnknownDataTypeError.__init__()=lib.errors.RelaxUnknownDataTypeError-class.html#__init__,Method lib.errors.RelaxUnknownParamCombError.__init__()=lib.errors.RelaxUnknownParamCombError-class.html#__init__,Method lib.errors.RelaxUnknownParamError.__init__()=lib.errors.RelaxUnknownParamError-class.html#__init__,Method lib.errors.RelaxValueError.__init__()=lib.errors.RelaxValueError-class.html#__init__,Method lib.io.DummyFileObject.__init__()=lib.io.DummyFileObject-class.html#__init__,Method lib.io.SplitIO.__init__()=lib.io.SplitIO-class.html#__init__,Method lib.selection.Selection.__init__()=lib.selection.Selection-class.html#__init__,Method lib.spectrum.objects.Peak_list.__init__()=lib.spectrum.objects.Peak_list-class.html#__init__,Method lib.structure.cones.Base.__init__()=lib.structure.cones.Base-class.html#__init__,Method lib.structure.cones.Cosine.__init__()=lib.structure.cones.Cosine-class.html#__init__,Method lib.structure.cones.Iso_cone.__init__()=lib.structure.cones.Iso_cone-class.html#__init__,Method lib.structure.cones.Zig_zag.__init__()=lib.structure.cones.Zig_zag-class.html#__init__,Method lib.structure.internal.displacements.Displacements.__init__()=lib.structure.internal.displacements.Displacements-class.html#__init__,Method lib.structure.internal.models.ModelContainer.__init__()=lib.structure.internal.models.ModelContainer-class.html#__init__,Method lib.structure.internal.molecules.MolContainer.__init__()=lib.structure.internal.molecules.MolContainer-class.html#__init__,Method lib.structure.internal.object.Internal.__init__()=lib.structure.internal.object.Internal-class.html#__init__,Method lib.warnings.RelaxDeselectWarning.__init__()=lib.warnings.RelaxDeselectWarning-class.html#__init__,Method lib.warnings.RelaxFileEmptyWarning.__init__()=lib.warnings.RelaxFileEmptyWarning-class.html#__init__,Method lib.warnings.RelaxNoAtomWarning.__init__()=lib.warnings.RelaxNoAtomWarning-class.html#__init__,Method lib.warnings.RelaxNoPDBFileWarning.__init__()=lib.warnings.RelaxNoPDBFileWarning-class.html#__init__,Method lib.warnings.RelaxNoSpinWarning.__init__()=lib.warnings.RelaxNoSpinWarning-class.html#__init__,Method lib.warnings.RelaxWarning.__init__()=lib.warnings.RelaxWarning-class.html#__init__,Method lib.warnings.RelaxZeroVectorWarning.__init__()=lib.warnings.RelaxZeroVectorWarning-class.html#__init__,Method minfx.base_classes.Conjugate_gradient.__init__()=minfx.base_classes.Conjugate_gradient-class.html#__init__,Method minfx.base_classes.Hessian_mods.__init__()=minfx.base_classes.Hessian_mods-class.html#__init__,Method minfx.base_classes.Line_search.__init__()=minfx.base_classes.Line_search-class.html#__init__,Method minfx.base_classes.Min.__init__()=minfx.base_classes.Min-class.html#__init__,Method minfx.base_classes.Trust_region.__init__()=minfx.base_classes.Trust_region-class.html#__init__,Method minfx.bfgs.Bfgs.__init__()=minfx.bfgs.Bfgs-class.html#__init__,Method minfx.cauchy_point.Cauchy_point.__init__()=minfx.cauchy_point.Cauchy_point-class.html#__init__,Method minfx.constraint_linear.Constraint_linear.__init__()=minfx.constraint_linear.Constraint_linear-class.html#__init__,Method minfx.coordinate_descent.Coordinate_descent.__init__()=minfx.coordinate_descent.Coordinate_descent-class.html#__init__,Method minfx.dogleg.Dogleg.__init__()=minfx.dogleg.Dogleg-class.html#__init__,Method minfx.errors.MinfxError.__init__()=minfx.errors.MinfxError-class.html#__init__,Method minfx.exact_trust_region.Exact_trust_region.__init__()=minfx.exact_trust_region.Exact_trust_region-class.html#__init__,Method minfx.fletcher_reeves_cg.Fletcher_reeves.__init__()=minfx.fletcher_reeves_cg.Fletcher_reeves-class.html#__init__,Method minfx.hestenes_stiefel_cg.Hestenes_stiefel.__init__()=minfx.hestenes_stiefel_cg.Hestenes_stiefel-class.html#__init__,Method minfx.levenberg_marquardt.Levenberg_marquardt.__init__()=minfx.levenberg_marquardt.Levenberg_marquardt-class.html#__init__,Method minfx.log_barrier_function.Log_barrier_function.__init__()=minfx.log_barrier_function.Log_barrier_function-class.html#__init__,Method minfx.method_of_multipliers.Method_of_multipliers.__init__()=minfx.method_of_multipliers.Method_of_multipliers-class.html#__init__,Method minfx.ncg.Ncg.__init__()=minfx.ncg.Ncg-class.html#__init__,Method minfx.newton.Newton.__init__()=minfx.newton.Newton-class.html#__init__,Method minfx.polak_ribiere_cg.Polak_ribiere.__init__()=minfx.polak_ribiere_cg.Polak_ribiere-class.html#__init__,Method minfx.polak_ribiere_plus_cg.Polak_ribiere_plus.__init__()=minfx.polak_ribiere_plus_cg.Polak_ribiere_plus-class.html#__init__,Method minfx.simplex.Simplex.__init__()=minfx.simplex.Simplex-class.html#__init__,Method minfx.steepest_descent.Steepest_descent.__init__()=minfx.steepest_descent.Steepest_descent-class.html#__init__,Method minfx.steihaug_cg.Steihaug.__init__()=minfx.steihaug_cg.Steihaug-class.html#__init__,Method multi.Application_callback.__init__()=multi.Application_callback-class.html#__init__,Method multi.misc.Capturing_exception.__init__()=multi.misc.Capturing_exception-class.html#__init__,Method multi.misc.Result.__init__()=multi.misc.Result-class.html#__init__,Method multi.misc.Result_string.__init__()=multi.misc.Result_string-class.html#__init__,Method multi.mpi4py_processor.Mpi4py_processor.__init__()=multi.mpi4py_processor.Mpi4py_processor-class.html#__init__,Method multi.multi_processor_base.Multi_processor.__init__()=multi.multi_processor_base.Multi_processor-class.html#__init__,Method multi.multi_processor_base.Too_few_slaves_exception.__init__()=multi.multi_processor_base.Too_few_slaves_exception-class.html#__init__,Method multi.processor.Processor.__init__()=multi.processor.Processor-class.html#__init__,Method multi.processor_io.Redirect_text.__init__()=multi.processor_io.Redirect_text-class.html#__init__,Method multi.result_commands.Batched_result_command.__init__()=multi.result_commands.Batched_result_command-class.html#__init__,Method multi.result_commands.Null_result_command.__init__()=multi.result_commands.Null_result_command-class.html#__init__,Method multi.result_commands.Result_command.__init__()=multi.result_commands.Result_command-class.html#__init__,Method multi.result_commands.Result_exception.__init__()=multi.result_commands.Result_exception-class.html#__init__,Method multi.result_queue.Exit_queue_result_command.__init__()=multi.result_queue.Exit_queue_result_command-class.html#__init__,Method multi.result_queue.Result_queue.__init__()=multi.result_queue.Result_queue-class.html#__init__,Method multi.result_queue.Threaded_result_queue.__init__()=multi.result_queue.Threaded_result_queue-class.html#__init__,Method multi.slave_commands.Slave_command.__init__()=multi.slave_commands.Slave_command-class.html#__init__,Method multi.slave_commands.Slave_storage_command.__init__()=multi.slave_commands.Slave_storage_command-class.html#__init__,Method multi.uni_processor.Uni_processor.__init__()=multi.uni_processor.Uni_processor-class.html#__init__,Method pipe_control.exp_info.Software_store.__init__()=pipe_control.exp_info.Software_store-class.html#__init__,Method pipe_control.molmol.Molmol.__init__()=pipe_control.molmol.Molmol-class.html#__init__,Method pipe_control.opendx.Map.__init__()=pipe_control.opendx.Map-class.html#__init__,Method pipe_control.pymol_control.Pymol.__init__()=pipe_control.pymol_control.Pymol-class.html#__init__,Method prompt.interpreter.Interpreter.__init__()=prompt.interpreter.Interpreter-class.html#__init__,Method prompt.tab_completion.Tab_completion.__init__()=prompt.tab_completion.Tab_completion-class.html#__init__,Method prompt.uf_objects.Class_container.__init__()=prompt.uf_objects.Class_container-class.html#__init__,Method prompt.uf_objects.Uf_object.__init__()=prompt.uf_objects.Uf_object-class.html#__init__,Method relax.Relax.__init__()=relax.Relax-class.html#__init__,Method relax.RelaxParser.__init__()=relax.RelaxParser-class.html#__init__,Method script-sconstruct.Main.__init__()=script-sconstruct.Main-class.html#__init__,Method setup.Setup.__init__()=setup.Setup-class.html#__init__,Method specific_analyses.api_base.API_base.__init__()=specific_analyses.api_base.API_base-class.html#__init__,Method specific_analyses.api_objects.Param_list.__init__()=specific_analyses.api_objects.Param_list-class.html#__init__,Method specific_analyses.consistency_tests.Consistency_tests.__init__()=specific_analyses.consistency_tests.Consistency_tests-class.html#__init__,Method specific_analyses.frame_order.Frame_order.__init__()=specific_analyses.frame_order.Frame_order-class.html#__init__,Method specific_analyses.jw_mapping.Jw_mapping.__init__()=specific_analyses.jw_mapping.Jw_mapping-class.html#__init__,Method specific_analyses.model_free.Model_free.__init__()=specific_analyses.model_free.Model_free-class.html#__init__,Method specific_analyses.model_free.multi_processor_commands.MF_grid_command.__init__()=specific_analyses.model_free.multi_processor_commands.MF_grid_command-class.html#__init__,Method specific_analyses.model_free.multi_processor_commands.MF_memo.__init__()=specific_analyses.model_free.multi_processor_commands.MF_memo-class.html#__init__,Method specific_analyses.model_free.multi_processor_commands.MF_minimise_command.__init__()=specific_analyses.model_free.multi_processor_commands.MF_minimise_command-class.html#__init__,Method specific_analyses.model_free.multi_processor_commands.MF_result_command.__init__()=specific_analyses.model_free.multi_processor_commands.MF_result_command-class.html#__init__,Method specific_analyses.n_state_model.N_state_model.__init__()=specific_analyses.n_state_model.N_state_model-class.html#__init__,Method specific_analyses.noe.Noe.__init__()=specific_analyses.noe.Noe-class.html#__init__,Method specific_analyses.relax_fit.Relax_fit.__init__()=specific_analyses.relax_fit.Relax_fit-class.html#__init__,Method status.Auto_analysis.__init__()=status.Auto_analysis-class.html#__init__,Method status.Exec_lock.__init__()=status.Exec_lock-class.html#__init__,Method status.Observer.__init__()=status.Observer-class.html#__init__,Method status.Relax_lock.__init__()=status.Relax_lock-class.html#__init__,Method target_functions.consistency_tests.Consistency.__init__()=target_functions.consistency_tests.Consistency-class.html#__init__,Method target_functions.consistency_tests.Data.__init__()=target_functions.consistency_tests.Data-class.html#__init__,Method target_functions.ens_pivot_finder.Pivot_finder.__init__()=target_functions.ens_pivot_finder.Pivot_finder-class.html#__init__,Method target_functions.frame_order.Frame_order.__init__()=target_functions.frame_order.Frame_order-class.html#__init__,Method target_functions.jw_mapping.Data.__init__()=target_functions.jw_mapping.Data-class.html#__init__,Method target_functions.jw_mapping.Mapping.__init__()=target_functions.jw_mapping.Mapping-class.html#__init__,Method target_functions.mf.Data.__init__()=target_functions.mf.Data-class.html#__init__,Method target_functions.mf.Mf.__init__()=target_functions.mf.Mf-class.html#__init__,Method target_functions.n_state_model.N_state_opt.__init__()=target_functions.n_state_model.N_state_opt-class.html#__init__,Method test_suite.gui_tests.base_classes.GuiTestCase.__init__()=test_suite.gui_tests.base_classes.GuiTestCase-class.html#__init__,Method test_suite.gui_tests.bmrb.Bmrb.__init__()=test_suite.gui_tests.bmrb.Bmrb-class.html#__init__,Method test_suite.gui_tests.bruker.Bruker.__init__()=test_suite.gui_tests.bruker.Bruker-class.html#__init__,Method test_suite.gui_tests.consistency_tests.Ct.__init__()=test_suite.gui_tests.consistency_tests.Ct-class.html#__init__,Method test_suite.gui_tests.frame_order.Frame_order.__init__()=test_suite.gui_tests.frame_order.Frame_order-class.html#__init__,Method test_suite.gui_tests.interatomic.Interatomic.__init__()=test_suite.gui_tests.interatomic.Interatomic-class.html#__init__,Method test_suite.gui_tests.jw_mapping.Jw_mapping.__init__()=test_suite.gui_tests.jw_mapping.Jw_mapping-class.html#__init__,Method test_suite.gui_tests.n_state_model.N_state_model.__init__()=test_suite.gui_tests.n_state_model.N_state_model-class.html#__init__,Method test_suite.gui_tests.pipes.Pipes.__init__()=test_suite.gui_tests.pipes.Pipes-class.html#__init__,Method test_suite.gui_tests.rx.Rx.__init__()=test_suite.gui_tests.rx.Rx-class.html#__init__,Method test_suite.gui_tests.state.State.__init__()=test_suite.gui_tests.state.State-class.html#__init__,Method test_suite.relax_test_runner.GuiTestRunner.__init__()=test_suite.relax_test_runner.GuiTestRunner-class.html#__init__,Method test_suite.relax_test_runner.RelaxTestResult.__init__()=test_suite.relax_test_runner.RelaxTestResult-class.html#__init__,Method test_suite.relax_test_runner.RelaxTestRunner.__init__()=test_suite.relax_test_runner.RelaxTestRunner-class.html#__init__,Method test_suite.system_tests.base_classes.SystemTestCase.__init__()=test_suite.system_tests.base_classes.SystemTestCase-class.html#__init__,Method test_suite.system_tests.bmrb.Bmrb.__init__()=test_suite.system_tests.bmrb.Bmrb-class.html#__init__,Method test_suite.system_tests.dasha.Dasha.__init__()=test_suite.system_tests.dasha.Dasha-class.html#__init__,Method test_suite.system_tests.frame_order.Frame_order.__init__()=test_suite.system_tests.frame_order.Frame_order-class.html#__init__,Method test_suite.system_tests.n_state_model.N_state_model.__init__()=test_suite.system_tests.n_state_model.N_state_model-class.html#__init__,Method test_suite.system_tests.palmer.Palmer.__init__()=test_suite.system_tests.palmer.Palmer-class.html#__init__,Method test_suite.system_tests.peak_lists.Peak_lists.__init__()=test_suite.system_tests.peak_lists.Peak_lists-class.html#__init__,Method test_suite.system_tests.pipes.Pipes.__init__()=test_suite.system_tests.pipes.Pipes-class.html#__init__,Method test_suite.system_tests.relax_fit.Relax_fit.__init__()=test_suite.system_tests.relax_fit.Relax_fit-class.html#__init__,Method test_suite.system_tests.state.State.__init__()=test_suite.system_tests.state.State-class.html#__init__,Method test_suite.test_suite_runner.Test_suite_runner.__init__()=test_suite.test_suite_runner.Test_suite_runner-class.html#__init__,Method test_suite.unit_tests._lib._frame_order.test_matrix_ops.Test_matrix_ops.__init__()=test_suite.unit_tests._lib._frame_order.test_matrix_ops.Test_matrix_ops-class.html#__init__,Method test_suite.unit_tests._prompt.test_align_tensor.Test_align_tensor.__init__()=test_suite.unit_tests._prompt.test_align_tensor.Test_align_tensor-class.html#__init__,Method test_suite.unit_tests._prompt.test_dasha.Test_dasha.__init__()=test_suite.unit_tests._prompt.test_dasha.Test_dasha-class.html#__init__,Method test_suite.unit_tests._prompt.test_deselect.Test_deselect.__init__()=test_suite.unit_tests._prompt.test_deselect.Test_deselect-class.html#__init__,Method test_suite.unit_tests._prompt.test_diffusion_tensor.Test_diffusion_tensor.__init__()=test_suite.unit_tests._prompt.test_diffusion_tensor.Test_diffusion_tensor-class.html#__init__,Method test_suite.unit_tests._prompt.test_eliminate.Test_eliminate.__init__()=test_suite.unit_tests._prompt.test_eliminate.Test_eliminate-class.html#__init__,Method test_suite.unit_tests._prompt.test_minimisation.Test_minimisation.__init__()=test_suite.unit_tests._prompt.test_minimisation.Test_minimisation-class.html#__init__,Method test_suite.unit_tests._prompt.test_model_free.Test_model_free.__init__()=test_suite.unit_tests._prompt.test_model_free.Test_model_free-class.html#__init__,Method test_suite.unit_tests._prompt.test_molecule.Test_molecule.__init__()=test_suite.unit_tests._prompt.test_molecule.Test_molecule-class.html#__init__,Method test_suite.unit_tests._prompt.test_molmol.Test_molmol.__init__()=test_suite.unit_tests._prompt.test_molmol.Test_molmol-class.html#__init__,Method test_suite.unit_tests._prompt.test_n_state_model.Test_n_state_model.__init__()=test_suite.unit_tests._prompt.test_n_state_model.Test_n_state_model-class.html#__init__,Method test_suite.unit_tests._prompt.test_noe.Test_noe.__init__()=test_suite.unit_tests._prompt.test_noe.Test_noe-class.html#__init__,Method test_suite.unit_tests._prompt.test_pymol.Test_pymol.__init__()=test_suite.unit_tests._prompt.test_pymol.Test_pymol-class.html#__init__,Method test_suite.unit_tests._prompt.test_relax_data.Test_relax_data.__init__()=test_suite.unit_tests._prompt.test_relax_data.Test_relax_data-class.html#__init__,Method test_suite.unit_tests._prompt.test_relax_fit.Test_relax_fit.__init__()=test_suite.unit_tests._prompt.test_relax_fit.Test_relax_fit-class.html#__init__,Method test_suite.unit_tests._prompt.test_residue.Test_residue.__init__()=test_suite.unit_tests._prompt.test_residue.Test_residue-class.html#__init__,Method test_suite.unit_tests._prompt.test_select.Test_select.__init__()=test_suite.unit_tests._prompt.test_select.Test_select-class.html#__init__,Method test_suite.unit_tests._prompt.test_sequence.Test_sequence.__init__()=test_suite.unit_tests._prompt.test_sequence.Test_sequence-class.html#__init__,Method test_suite.unit_tests._prompt.test_spectrum.Test_spectrum.__init__()=test_suite.unit_tests._prompt.test_spectrum.Test_spectrum-class.html#__init__,Method test_suite.unit_tests._prompt.test_spin.Test_spin.__init__()=test_suite.unit_tests._prompt.test_spin.Test_spin-class.html#__init__,Method test_suite.unit_tests._prompt.test_state.Test_state.__init__()=test_suite.unit_tests._prompt.test_state.Test_state-class.html#__init__,Method test_suite.unit_tests._prompt.test_structure.Test_structure.__init__()=test_suite.unit_tests._prompt.test_structure.Test_structure-class.html#__init__,Method test_suite.unit_tests._prompt.test_value.Test_value.__init__()=test_suite.unit_tests._prompt.test_value.Test_value-class.html#__init__,Method test_suite.unit_tests.unit_test_runner.ImportErrorTestCase.__init__()=test_suite.unit_tests.unit_test_runner.ImportErrorTestCase-class.html#__init__,Method test_suite.unit_tests.unit_test_runner.Test_finder.__init__()=test_suite.unit_tests.unit_test_runner.Test_finder-class.html#__init__,Method test_suite.unit_tests.unit_test_runner.Unit_test_runner.__init__()=test_suite.unit_tests.unit_test_runner.Unit_test_runner-class.html#__init__,Method user_functions.objects.Class_container.__init__()=user_functions.objects.Class_container-class.html#__init__,Method user_functions.objects.Desc_container.__init__()=user_functions.objects.Desc_container-class.html#__init__,Method user_functions.objects.Table.__init__()=user_functions.objects.Table-class.html#__init__,Method user_functions.objects.Uf_container.__init__()=user_functions.objects.Uf_container-class.html#__init__"><a title="auto_analyses.dauvergne_protocol.dAuvergne_protocol.__init__
auto_analyses.frame_order.Frame_order_analysis.__init__
auto_analyses.noe.NOE_calc.__init__
auto_analyses.relax_fit.Relax_fit.__init__
auto_analyses.stereochem_analysis.Stereochem_analysis.__init__
bmrblib.NMR_parameters.chem_shift_anisotropy.CSAnisotropy.__init__
bmrblib.NMR_parameters.chem_shift_anisotropy.CSAnisotropyExperiment.__init__
bmrblib.NMR_parameters.chem_shift_anisotropy.ChemShiftAnisotropy.__init__
bmrblib.NMR_parameters.chem_shift_anisotropy_v3_1.CSAnisotropyExperiment_v3_1.__init__
bmrblib.NMR_parameters.chem_shift_anisotropy_v3_1.CSAnisotropySoftware_v3_1.__init__
bmrblib.NMR_parameters.chem_shift_anisotropy_v3_1.CSAnisotropy_v3_1.__init__
bmrblib.NMR_parameters.chem_shift_anisotropy_v3_1.ChemShiftAnisotropy_v3_1.__init__
bmrblib.assembly_supercategory.entity.Entity.__init__
bmrblib.assembly_supercategory.entity.EntityCompIndex.__init__
bmrblib.assembly_supercategory.entity_v2_1.EntityCompIndex_v2_1.__init__
bmrblib.assembly_supercategory.entity_v2_1.Entity_v2_1.__init__
bmrblib.assembly_supercategory.entity_v3_1.EntityCompIndex_v3_1.__init__
bmrblib.assembly_supercategory.entity_v3_1.Entity_v3_1.__init__
bmrblib.base_classes.BaseSaveframe.__init__
bmrblib.base_classes.MissingSaveframe.__init__
bmrblib.base_classes.TagCategory.__init__
bmrblib.base_classes.TagCategoryFree.__init__
bmrblib.base_classes.TagObject.__init__
bmrblib.base_classes.TagTranslationTable.__init__
bmrblib.citations.citations.Citations.__init__
bmrblib.citations.citations.CitationsAuthor.__init__
bmrblib.citations.citations_v3_1.CitationsAuthor_v3_1.__init__
bmrblib.citations.citations_v3_1.Citations_v3_1.__init__
bmrblib.experimental_details.experiment.Experiment.__init__
bmrblib.experimental_details.experiment.ExperimentList.__init__
bmrblib.experimental_details.experiment_v3_1.ExperimentList_v3_1.__init__
bmrblib.experimental_details.experiment_v3_1.Experiment_v3_1.__init__
bmrblib.experimental_details.method.Method.__init__
bmrblib.experimental_details.method.MethodCitation.__init__
bmrblib.experimental_details.method.MethodFile.__init__
bmrblib.experimental_details.method.MethodParam.__init__
bmrblib.experimental_details.method_v3_1.MethodCitation_v3_1.__init__
bmrblib.experimental_details.method_v3_1.MethodFile_v3_1.__init__
bmrblib.experimental_details.method_v3_1.MethodParam_v3_1.__init__
bmrblib.experimental_details.method_v3_1.Method_v3_1.__init__
bmrblib.experimental_details.nmr_spectrometer.NMRSpectrometer.__init__
bmrblib.experimental_details.nmr_spectrometer_v3_1.NMRSpectrometer_v3_1.__init__
bmrblib.experimental_details.sample_conditions.SampleConditionCitation.__init__
bmrblib.experimental_details.sample_conditions.SampleConditionList.__init__
bmrblib.experimental_details.sample_conditions.SampleConditionVariable.__init__
bmrblib.experimental_details.sample_conditions_v2_1.SampleConditionList_v2_1.__init__
bmrblib.experimental_details.sample_conditions_v2_1.SampleConditionVariable_v2_1.__init__
bmrblib.experimental_details.sample_conditions_v3_1.SampleConditionCitation_v3_1.__init__
bmrblib.experimental_details.sample_conditions_v3_1.SampleConditionList_v3_1.__init__
bmrblib.experimental_details.sample_conditions_v3_1.SampleConditionVariable_v3_1.__init__
bmrblib.experimental_details.software.Software.__init__
bmrblib.experimental_details.software.SoftwareCitation.__init__
bmrblib.experimental_details.software.Task.__init__
bmrblib.experimental_details.software.Vendor.__init__
bmrblib.experimental_details.software_v3_1.SoftwareCitation_v3_1.__init__
bmrblib.experimental_details.software_v3_1.Software_v3_1.__init__
bmrblib.experimental_details.software_v3_1.Task_v3_1.__init__
bmrblib.experimental_details.software_v3_1.Vendor_v3_1.__init__
bmrblib.kinetics.auto_relaxation.AutoRelaxation.__init__
bmrblib.kinetics.auto_relaxation.AutoRelaxationExperiment.__init__
bmrblib.kinetics.auto_relaxation.AutoRelaxationList.__init__
bmrblib.kinetics.auto_relaxation.AutoRelaxationSoftware.__init__
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationExperiment_v3_1.__init__
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationList_v3_1.__init__
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSoftware_v3_1.__init__
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxation_v3_1.__init__
bmrblib.kinetics.heteronucl_NOEs.HeteronuclNOE.__init__
bmrblib.kinetics.heteronucl_NOEs.HeteronuclNOEExperiment.__init__
bmrblib.kinetics.heteronucl_NOEs.HeteronuclNOEList.__init__
bmrblib.kinetics.heteronucl_NOEs.HeteronuclNOESoftware.__init__
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOEExperiment_v2_1.__init__
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOEList_v2_1.__init__
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESoftware_v2_1.__init__
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOE_v2_1.__init__
bmrblib.kinetics.heteronucl_NOEs_v3_1.HeteronuclNOEExperiment_v3_1.__init__
bmrblib.kinetics.heteronucl_NOEs_v3_1.HeteronuclNOEList_v3_1.__init__
bmrblib.kinetics.heteronucl_NOEs_v3_1.HeteronuclNOESoftware_v3_1.__init__
bmrblib.kinetics.heteronucl_NOEs_v3_1.HeteronuclNOE_v3_1.__init__
bmrblib.kinetics.heteronucl_T1_relaxation.HeteronuclT1Experiment.__init__
bmrblib.kinetics.heteronucl_T1_relaxation.HeteronuclT1List.__init__
bmrblib.kinetics.heteronucl_T1_relaxation.HeteronuclT1Software.__init__
bmrblib.kinetics.heteronucl_T1_relaxation.T1.__init__
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Experiment_v2_1.__init__
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1List_v2_1.__init__
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Software_v2_1.__init__
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.T1_v2_1.__init__
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Experiment_v3_1.__init__
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1List_v3_1.__init__
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Software_v3_1.__init__
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.T1_v3_1.__init__
bmrblib.kinetics.heteronucl_T2_relaxation.HeteronuclT2Experiment.__init__
bmrblib.kinetics.heteronucl_T2_relaxation.HeteronuclT2List.__init__
bmrblib.kinetics.heteronucl_T2_relaxation.HeteronuclT2Software.__init__
bmrblib.kinetics.heteronucl_T2_relaxation.T2.__init__
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Experiment_v2_1.__init__
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2List_v2_1.__init__
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Software_v2_1.__init__
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.T2_v2_1.__init__
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Experiment_v3_1.__init__
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2List_v3_1.__init__
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Software_v3_1.__init__
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.T2_v3_1.__init__
bmrblib.kinetics.relaxation.Relaxation_v2_1.__init__
bmrblib.kinetics.relaxation.Relaxation_v3_0.__init__
bmrblib.kinetics.relaxation.Relaxation_v3_1.__init__
bmrblib.nmr_star_dict.NMR_STAR.__init__
bmrblib.pystarlib.File.File.__init__
bmrblib.pystarlib.SaveFrame.SaveFrame.__init__
bmrblib.pystarlib.TagTable.TagTable.__init__
bmrblib.structure.tensor.Tensor.__init__
bmrblib.structure.tensor.TensorList.__init__
bmrblib.thermodynamics.model_free.ModelFree.__init__
bmrblib.thermodynamics.model_free.ModelFreeExperiment.__init__
bmrblib.thermodynamics.model_free.ModelFreeList.__init__
bmrblib.thermodynamics.model_free.ModelFreeSoftware.__init__
bmrblib.thermodynamics.model_free_v3_1.ModelFreeExperiment_v3_1.__init__
bmrblib.thermodynamics.model_free_v3_1.ModelFreeList_v3_1.__init__
bmrblib.thermodynamics.model_free_v3_1.ModelFreeSoftware_v3_1.__init__
bmrblib.thermodynamics.model_free_v3_1.ModelFree_v3_1.__init__
compat.TaskQueue.__init__
data_store.align_tensor.AlignTensorData.__init__
data_store.align_tensor.AlignTensorSimList.__init__
data_store.data_classes.Element.__init__
data_store.data_classes.RelaxListType.__init__
data_store.diff_tensor.DiffTensorData.__init__
data_store.diff_tensor.DiffTensorSimList.__init__
data_store.exp_info.ExpInfo.__init__
data_store.gui.Analyses.__init__
data_store.gui.Free_file_format.__init__
data_store.gui.Gui.__init__
data_store.interatomic.InteratomContainer.__init__
data_store.mol_res_spin.MoleculeContainer.__init__
data_store.mol_res_spin.MoleculeList.__init__
data_store.mol_res_spin.ResidueContainer.__init__
data_store.mol_res_spin.ResidueList.__init__
data_store.mol_res_spin.SpinContainer.__init__
data_store.mol_res_spin.SpinList.__init__
data_store.pipe_container.PipeContainer.__init__
docs.latex.fetch_docstrings.Fetch_docstrings.__init__
gui.App.__init__
gui.about.About_base.__init__
gui.about.About_relax.__init__
gui.analyses.Analysis_controller.__init__
gui.analyses.auto_model_free.About_window.__init__
gui.analyses.auto_model_free.Auto_model_free.__init__
gui.analyses.auto_model_free.Protocol_mode_sel_window.__init__
gui.analyses.auto_noe.Auto_noe.__init__
gui.analyses.auto_rx_base.Auto_rx.__init__
gui.analyses.base.Base_analysis.__init__
gui.analyses.elements.bool_element.Boolean_ctrl.__init__
gui.analyses.elements.model_list.ModelSelListCtrl.__init__
gui.analyses.elements.model_list.Model_list.__init__
gui.analyses.elements.model_list.Model_sel_window.__init__
gui.analyses.elements.spin_element.Spin_ctrl.__init__
gui.analyses.elements.text_element.Text_ctrl.__init__
gui.analyses.execute.Execute.__init__
gui.components.base_list.Base_list.__init__
gui.components.free_file_format.Free_file_format.__init__
gui.components.free_file_format.Free_file_format_window.__init__
gui.components.grid.Delay_num_cell_editor.__init__
gui.components.grid.Grid_base.__init__
gui.components.relax_data.Metadata_window.__init__
gui.components.spectrum.Spectra_list.__init__
gui.controller.Controller.__init__
gui.controller.LogCtrl.__init__
gui.controller.Redirect_text.__init__
gui.export_bmrb.Export_bmrb_window.__init__
gui.filedialog.RelaxDirDialog.__init__
gui.filedialog.RelaxFileDialog.__init__
gui.icons.Relax_task_bar_icon.__init__
gui.input_elements.bool.Selector_bool.__init__
gui.input_elements.combo_list.Combo_list.__init__
gui.input_elements.dir.Selector_dir.__init__
gui.input_elements.file.Selector_file.__init__
gui.input_elements.sequence.Sequence.__init__
gui.input_elements.sequence.Sequence_list_ctrl.__init__
gui.input_elements.sequence.Sequence_window.__init__
gui.input_elements.sequence_2D.Sequence_2D.__init__
gui.input_elements.sequence_2D.Sequence_window_2D.__init__
gui.input_elements.spin_id.Spin_id.__init__
gui.input_elements.value.Value.__init__
gui.interpreter.Interpreter_thread.__init__
gui.menu.Menu.__init__
gui.message.Missing_data.__init__
gui.message.Question.__init__
gui.paths.I16x16.__init__
gui.paths.I22x22.__init__
gui.paths.I32x32.__init__
gui.paths.I48x48.__init__
gui.pipe_editor.Pipe_editor.__init__
gui.references.References.__init__
gui.relax_gui.Main.__init__
gui.relax_prompt.InterpClass.__init__
gui.relax_prompt.Prompt.__init__
gui.relax_prompt._Exit.__init__
gui.results_viewer.Results_viewer.__init__
gui.spin_viewer.containers.Container.__init__
gui.spin_viewer.containers.Molecule.__init__
gui.spin_viewer.containers.Residue.__init__
gui.spin_viewer.containers.Root.__init__
gui.spin_viewer.containers.Spin.__init__
gui.spin_viewer.frame.Spin_view_window.__init__
gui.spin_viewer.splitter.Tree_splitter.__init__
gui.spin_viewer.tree.Mol_res_spin_tree.__init__
gui.uf_objects.Force_true.__init__
gui.uf_objects.Uf_object.__init__
gui.uf_objects.Uf_page.__init__
gui.wizards.peak_intensity.Peak_intensity_wizard.__init__
gui.wizards.wiz_objects.Wiz_page.__init__
gui.wizards.wiz_objects.Wiz_window.__init__
info.Info_box.__init__
info.MemoryStatusEx.__init__
lib.errors.BaseArgError.__init__
lib.errors.RelaxAlignError.__init__
lib.errors.RelaxArgNotInListError.__init__
lib.errors.RelaxArgNotNoneError.__init__
lib.errors.RelaxBundleError.__init__
lib.errors.RelaxDiffMolNumError.__init__
lib.errors.RelaxDiffResNumError.__init__
lib.errors.RelaxDiffSeqError.__init__
lib.errors.RelaxDiffSpinNumError.__init__
lib.errors.RelaxDirError.__init__
lib.errors.RelaxError.__init__
lib.errors.RelaxFault.__init__
lib.errors.RelaxFileEmptyError.__init__
lib.errors.RelaxFileError.__init__
lib.errors.RelaxFileOverwriteError.__init__
lib.errors.RelaxFromXMLNotEmptyError.__init__
lib.errors.RelaxFuncSetupError.__init__
lib.errors.RelaxImplementError.__init__
lib.errors.RelaxInfError.__init__
lib.errors.RelaxInteratomError.__init__
lib.errors.RelaxInteratomInconsistentError.__init__
lib.errors.RelaxInvalidColourError.__init__
lib.errors.RelaxInvalidDataError.__init__
lib.errors.RelaxInvalidError.__init__
lib.errors.RelaxInvalidSeqError.__init__
lib.errors.RelaxJError.__init__
lib.errors.RelaxLenError.__init__
lib.errors.RelaxMfError.__init__
lib.errors.RelaxMissingBinaryError.__init__
lib.errors.RelaxModelError.__init__
lib.errors.RelaxMolSelectDisallowError.__init__
lib.errors.RelaxMultiMolIDError.__init__
lib.errors.RelaxMultiResIDError.__init__
lib.errors.RelaxMultiSpinIDError.__init__
lib.errors.RelaxMultiVectorError.__init__
lib.errors.RelaxNaNError.__init__
lib.errors.RelaxNoAlignError.__init__
lib.errors.RelaxNoBundleError.__init__
lib.errors.RelaxNoDomainError.__init__
lib.errors.RelaxNoFrqError.__init__
lib.errors.RelaxNoInPathError.__init__
lib.errors.RelaxNoInteratomError.__init__
lib.errors.RelaxNoJError.__init__
lib.errors.RelaxNoModelError.__init__
lib.errors.RelaxNoModuleInstallError.__init__
lib.errors.RelaxNoPCSError.__init__
lib.errors.RelaxNoPdbChainError.__init__
lib.errors.RelaxNoPdbError.__init__
lib.errors.RelaxNoPeakIntensityError.__init__
lib.errors.RelaxNoPipeError.__init__
lib.errors.RelaxNoRDCError.__init__
lib.errors.RelaxNoResError.__init__
lib.errors.RelaxNoRiError.__init__
lib.errors.RelaxNoSequenceError.__init__
lib.errors.RelaxNoSimError.__init__
lib.errors.RelaxNoSpectraError.__init__
lib.errors.RelaxNoSpinError.__init__
lib.errors.RelaxNoSpinSpecError.__init__
lib.errors.RelaxNoTensorError.__init__
lib.errors.RelaxNoValueError.__init__
lib.errors.RelaxNoVectorsError.__init__
lib.errors.RelaxNonExecError.__init__
lib.errors.RelaxNoneError.__init__
lib.errors.RelaxNucleusError.__init__
lib.errors.RelaxPCSError.__init__
lib.errors.RelaxParamSetError.__init__
lib.errors.RelaxPdbError.__init__
lib.errors.RelaxPdbLoadError.__init__
lib.errors.RelaxPipeError.__init__
lib.errors.RelaxProgError.__init__
lib.errors.RelaxProgFailError.__init__
lib.errors.RelaxRDCError.__init__
lib.errors.RelaxRegExpError.__init__
lib.errors.RelaxResSelectDisallowError.__init__
lib.errors.RelaxRiError.__init__
lib.errors.RelaxSequenceError.__init__
lib.errors.RelaxSpectraError.__init__
lib.errors.RelaxSpinSelectDisallowError.__init__
lib.errors.RelaxSpinTypeError.__init__
lib.errors.RelaxSpinsNotLoadedError.__init__
lib.errors.RelaxStyleError.__init__
lib.errors.RelaxTensorError.__init__
lib.errors.RelaxUnknownDataTypeError.__init__
lib.errors.RelaxUnknownParamCombError.__init__
lib.errors.RelaxUnknownParamError.__init__
lib.errors.RelaxValueError.__init__
lib.io.DummyFileObject.__init__
lib.io.SplitIO.__init__
lib.selection.Selection.__init__
lib.spectrum.objects.Peak_list.__init__
lib.structure.cones.Base.__init__
lib.structure.cones.Cosine.__init__
lib.structure.cones.Iso_cone.__init__
lib.structure.cones.Zig_zag.__init__
lib.structure.internal.displacements.Displacements.__init__
lib.structure.internal.models.ModelContainer.__init__
lib.structure.internal.molecules.MolContainer.__init__
lib.structure.internal.object.Internal.__init__
lib.warnings.RelaxDeselectWarning.__init__
lib.warnings.RelaxFileEmptyWarning.__init__
lib.warnings.RelaxNoAtomWarning.__init__
lib.warnings.RelaxNoPDBFileWarning.__init__
lib.warnings.RelaxNoSpinWarning.__init__
lib.warnings.RelaxWarning.__init__
lib.warnings.RelaxZeroVectorWarning.__init__
minfx.base_classes.Conjugate_gradient.__init__
minfx.base_classes.Hessian_mods.__init__
minfx.base_classes.Line_search.__init__
minfx.base_classes.Min.__init__
minfx.base_classes.Trust_region.__init__
minfx.bfgs.Bfgs.__init__
minfx.cauchy_point.Cauchy_point.__init__
minfx.constraint_linear.Constraint_linear.__init__
minfx.coordinate_descent.Coordinate_descent.__init__
minfx.dogleg.Dogleg.__init__
minfx.errors.MinfxError.__init__
minfx.exact_trust_region.Exact_trust_region.__init__
minfx.fletcher_reeves_cg.Fletcher_reeves.__init__
minfx.hestenes_stiefel_cg.Hestenes_stiefel.__init__
minfx.levenberg_marquardt.Levenberg_marquardt.__init__
minfx.log_barrier_function.Log_barrier_function.__init__
minfx.method_of_multipliers.Method_of_multipliers.__init__
minfx.ncg.Ncg.__init__
minfx.newton.Newton.__init__
minfx.polak_ribiere_cg.Polak_ribiere.__init__
minfx.polak_ribiere_plus_cg.Polak_ribiere_plus.__init__
minfx.simplex.Simplex.__init__
minfx.steepest_descent.Steepest_descent.__init__
minfx.steihaug_cg.Steihaug.__init__
multi.Application_callback.__init__
multi.misc.Capturing_exception.__init__
multi.misc.Result.__init__
multi.misc.Result_string.__init__
multi.mpi4py_processor.Mpi4py_processor.__init__
multi.multi_processor_base.Multi_processor.__init__
multi.multi_processor_base.Too_few_slaves_exception.__init__
multi.processor.Processor.__init__
multi.processor_io.Redirect_text.__init__
multi.result_commands.Batched_result_command.__init__
multi.result_commands.Null_result_command.__init__
multi.result_commands.Result_command.__init__
multi.result_commands.Result_exception.__init__
multi.result_queue.Exit_queue_result_command.__init__
multi.result_queue.Result_queue.__init__
multi.result_queue.Threaded_result_queue.__init__
multi.slave_commands.Slave_command.__init__
multi.slave_commands.Slave_storage_command.__init__
multi.uni_processor.Uni_processor.__init__
pipe_control.exp_info.Software_store.__init__
pipe_control.molmol.Molmol.__init__
pipe_control.opendx.Map.__init__
pipe_control.pymol_control.Pymol.__init__
prompt.interpreter.Interpreter.__init__
prompt.tab_completion.Tab_completion.__init__
prompt.uf_objects.Class_container.__init__
prompt.uf_objects.Uf_object.__init__
relax.Relax.__init__
relax.RelaxParser.__init__
script-sconstruct.Main.__init__
setup.Setup.__init__
specific_analyses.api_base.API_base.__init__
specific_analyses.api_objects.Param_list.__init__
specific_analyses.consistency_tests.Consistency_tests.__init__
specific_analyses.frame_order.Frame_order.__init__
specific_analyses.jw_mapping.Jw_mapping.__init__
specific_analyses.model_free.Model_free.__init__
specific_analyses.model_free.multi_processor_commands.MF_grid_command.__init__
specific_analyses.model_free.multi_processor_commands.MF_memo.__init__
specific_analyses.model_free.multi_processor_commands.MF_minimise_command.__init__
specific_analyses.model_free.multi_processor_commands.MF_result_command.__init__
specific_analyses.n_state_model.N_state_model.__init__
specific_analyses.noe.Noe.__init__
specific_analyses.relax_fit.Relax_fit.__init__
status.Auto_analysis.__init__
status.Exec_lock.__init__
status.Observer.__init__
status.Relax_lock.__init__
target_functions.consistency_tests.Consistency.__init__
target_functions.consistency_tests.Data.__init__
target_functions.ens_pivot_finder.Pivot_finder.__init__
target_functions.frame_order.Frame_order.__init__
target_functions.jw_mapping.Data.__init__
target_functions.jw_mapping.Mapping.__init__
target_functions.mf.Data.__init__
target_functions.mf.Mf.__init__
target_functions.n_state_model.N_state_opt.__init__
test_suite.gui_tests.base_classes.GuiTestCase.__init__
test_suite.gui_tests.bmrb.Bmrb.__init__
test_suite.gui_tests.bruker.Bruker.__init__
test_suite.gui_tests.consistency_tests.Ct.__init__
test_suite.gui_tests.frame_order.Frame_order.__init__
test_suite.gui_tests.interatomic.Interatomic.__init__
test_suite.gui_tests.jw_mapping.Jw_mapping.__init__
test_suite.gui_tests.n_state_model.N_state_model.__init__
test_suite.gui_tests.pipes.Pipes.__init__
test_suite.gui_tests.rx.Rx.__init__
test_suite.gui_tests.state.State.__init__
test_suite.relax_test_runner.GuiTestRunner.__init__
test_suite.relax_test_runner.RelaxTestResult.__init__
test_suite.relax_test_runner.RelaxTestRunner.__init__
test_suite.system_tests.base_classes.SystemTestCase.__init__
test_suite.system_tests.bmrb.Bmrb.__init__
test_suite.system_tests.dasha.Dasha.__init__
test_suite.system_tests.frame_order.Frame_order.__init__
test_suite.system_tests.n_state_model.N_state_model.__init__
test_suite.system_tests.palmer.Palmer.__init__
test_suite.system_tests.peak_lists.Peak_lists.__init__
test_suite.system_tests.pipes.Pipes.__init__
test_suite.system_tests.relax_fit.Relax_fit.__init__
test_suite.system_tests.state.State.__init__
test_suite.test_suite_runner.Test_suite_runner.__init__
test_suite.unit_tests._lib._frame_order.test_matrix_ops.Test_matrix_ops.__init__
test_suite.unit_tests._prompt.test_align_tensor.Test_align_tensor.__init__
test_suite.unit_tests._prompt.test_dasha.Test_dasha.__init__
test_suite.unit_tests._prompt.test_deselect.Test_deselect.__init__
test_suite.unit_tests._prompt.test_diffusion_tensor.Test_diffusion_tensor.__init__
test_suite.unit_tests._prompt.test_eliminate.Test_eliminate.__init__
test_suite.unit_tests._prompt.test_minimisation.Test_minimisation.__init__
test_suite.unit_tests._prompt.test_model_free.Test_model_free.__init__
test_suite.unit_tests._prompt.test_molecule.Test_molecule.__init__
test_suite.unit_tests._prompt.test_molmol.Test_molmol.__init__
test_suite.unit_tests._prompt.test_n_state_model.Test_n_state_model.__init__
test_suite.unit_tests._prompt.test_noe.Test_noe.__init__
test_suite.unit_tests._prompt.test_pymol.Test_pymol.__init__
test_suite.unit_tests._prompt.test_relax_data.Test_relax_data.__init__
test_suite.unit_tests._prompt.test_relax_fit.Test_relax_fit.__init__
test_suite.unit_tests._prompt.test_residue.Test_residue.__init__
test_suite.unit_tests._prompt.test_select.Test_select.__init__
test_suite.unit_tests._prompt.test_sequence.Test_sequence.__init__
test_suite.unit_tests._prompt.test_spectrum.Test_spectrum.__init__
test_suite.unit_tests._prompt.test_spin.Test_spin.__init__
test_suite.unit_tests._prompt.test_state.Test_state.__init__
test_suite.unit_tests._prompt.test_structure.Test_structure.__init__
test_suite.unit_tests._prompt.test_value.Test_value.__init__
test_suite.unit_tests.unit_test_runner.ImportErrorTestCase.__init__
test_suite.unit_tests.unit_test_runner.Test_finder.__init__
test_suite.unit_tests.unit_test_runner.Unit_test_runner.__init__
user_functions.objects.Class_container.__init__
user_functions.objects.Desc_container.__init__
user_functions.objects.Table.__init__
user_functions.objects.Uf_container.__init__" class="py-name" href="#" onclick="return doclink('link-115', '__init__', 'link-115');">__init__</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L75"></a><tt class="py-lineno">  75</tt>  <tt class="py-line"> </tt>
<a name="L76"></a><tt class="py-lineno">  76</tt>  <tt class="py-line">        <tt class="py-comment"># Place methods into the API.</tt> </tt>
<a name="L77"></a><tt class="py-lineno">  77</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-116" class="py-name" targets="Method lib.structure.internal.object.Internal.model_loop()=lib.structure.internal.object.Internal-class.html#model_loop,Method specific_analyses.api_base.API_base.model_loop()=specific_analyses.api_base.API_base-class.html#model_loop,Method specific_analyses.frame_order.Frame_order.model_loop()=specific_analyses.frame_order.Frame_order-class.html#model_loop,Method specific_analyses.hybrid.Hybrid.model_loop()=specific_analyses.hybrid.Hybrid-class.html#model_loop,Method specific_analyses.model_free.main.Model_free_main.model_loop()=specific_analyses.model_free.main.Model_free_main-class.html#model_loop"><a title="lib.structure.internal.object.Internal.model_loop
specific_analyses.api_base.API_base.model_loop
specific_analyses.frame_order.Frame_order.model_loop
specific_analyses.hybrid.Hybrid.model_loop
specific_analyses.model_free.main.Model_free_main.model_loop" class="py-name" href="#" onclick="return doclink('link-116', 'model_loop', 'link-116');">model_loop</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-117" class="py-name" targets="Method specific_analyses.api_common.API_common._model_loop_single_global()=specific_analyses.api_common.API_common-class.html#_model_loop_single_global"><a title="specific_analyses.api_common.API_common._model_loop_single_global" class="py-name" href="#" onclick="return doclink('link-117', '_model_loop_single_global', 'link-117');">_model_loop_single_global</a></tt> </tt>
<a name="L78"></a><tt class="py-lineno">  78</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-118" class="py-name" targets="Method specific_analyses.api_base.API_base.overfit_deselect()=specific_analyses.api_base.API_base-class.html#overfit_deselect,Method specific_analyses.consistency_tests.Consistency_tests.overfit_deselect()=specific_analyses.consistency_tests.Consistency_tests-class.html#overfit_deselect,Method specific_analyses.jw_mapping.Jw_mapping.overfit_deselect()=specific_analyses.jw_mapping.Jw_mapping-class.html#overfit_deselect,Method specific_analyses.model_free.main.Model_free_main.overfit_deselect()=specific_analyses.model_free.main.Model_free_main-class.html#overfit_deselect,Method specific_analyses.noe.main.Noe_main.overfit_deselect()=specific_analyses.noe.main.Noe_main-class.html#overfit_deselect,Method specific_analyses.relax_fit.Relax_fit.overfit_deselect()=specific_analyses.relax_fit.Relax_fit-class.html#overfit_deselect"><a title="specific_analyses.api_base.API_base.overfit_deselect
specific_analyses.consistency_tests.Consistency_tests.overfit_deselect
specific_analyses.jw_mapping.Jw_mapping.overfit_deselect
specific_analyses.model_free.main.Model_free_main.overfit_deselect
specific_analyses.noe.main.Noe_main.overfit_deselect
specific_analyses.relax_fit.Relax_fit.overfit_deselect" class="py-name" href="#" onclick="return doclink('link-118', 'overfit_deselect', 'link-118');">overfit_deselect</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-119" class="py-name" targets="Method specific_analyses.api_common.API_common._overfit_deselect_dummy()=specific_analyses.api_common.API_common-class.html#_overfit_deselect_dummy"><a title="specific_analyses.api_common.API_common._overfit_deselect_dummy" class="py-name" href="#" onclick="return doclink('link-119', '_overfit_deselect_dummy', 'link-119');">_overfit_deselect_dummy</a></tt> </tt>
<a name="L79"></a><tt class="py-lineno">  79</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-120" class="py-name" targets="Function pipe_control.align_tensor.return_conversion_factor()=pipe_control.align_tensor-module.html#return_conversion_factor,Function pipe_control.diffusion_tensor.return_conversion_factor()=pipe_control.diffusion_tensor-module.html#return_conversion_factor,Function pipe_control.minimise.return_conversion_factor()=pipe_control.minimise-module.html#return_conversion_factor,Method specific_analyses.api_base.API_base.return_conversion_factor()=specific_analyses.api_base.API_base-class.html#return_conversion_factor"><a title="pipe_control.align_tensor.return_conversion_factor
pipe_control.diffusion_tensor.return_conversion_factor
pipe_control.minimise.return_conversion_factor
specific_analyses.api_base.API_base.return_conversion_factor" class="py-name" href="#" onclick="return doclink('link-120', 'return_conversion_factor', 'link-120');">return_conversion_factor</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-121" class="py-name" targets="Method specific_analyses.api_common.API_common._return_no_conversion_factor()=specific_analyses.api_common.API_common-class.html#_return_no_conversion_factor"><a title="specific_analyses.api_common.API_common._return_no_conversion_factor" class="py-name" href="#" onclick="return doclink('link-121', '_return_no_conversion_factor', 'link-121');">_return_no_conversion_factor</a></tt> </tt>
<a name="L80"></a><tt class="py-lineno">  80</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-122" class="py-name" targets="Method specific_analyses.api_base.API_base.set_selected_sim()=specific_analyses.api_base.API_base-class.html#set_selected_sim,Method specific_analyses.frame_order.Frame_order.set_selected_sim()=specific_analyses.frame_order.Frame_order-class.html#set_selected_sim,Method specific_analyses.model_free.main.Model_free_main.set_selected_sim()=specific_analyses.model_free.main.Model_free_main-class.html#set_selected_sim"><a title="specific_analyses.api_base.API_base.set_selected_sim
specific_analyses.frame_order.Frame_order.set_selected_sim
specific_analyses.model_free.main.Model_free_main.set_selected_sim" class="py-name" href="#" onclick="return doclink('link-122', 'set_selected_sim', 'link-122');">set_selected_sim</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-123" class="py-name" targets="Method specific_analyses.api_common.API_common._set_selected_sim_global()=specific_analyses.api_common.API_common-class.html#_set_selected_sim_global"><a title="specific_analyses.api_common.API_common._set_selected_sim_global" class="py-name" href="#" onclick="return doclink('link-123', '_set_selected_sim_global', 'link-123');">_set_selected_sim_global</a></tt> </tt>
<a name="L81"></a><tt class="py-lineno">  81</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-124" class="py-name" targets="Method specific_analyses.api_base.API_base.sim_return_selected()=specific_analyses.api_base.API_base-class.html#sim_return_selected,Method specific_analyses.consistency_tests.Consistency_tests.sim_return_selected()=specific_analyses.consistency_tests.Consistency_tests-class.html#sim_return_selected,Method specific_analyses.frame_order.Frame_order.sim_return_selected()=specific_analyses.frame_order.Frame_order-class.html#sim_return_selected,Method specific_analyses.jw_mapping.Jw_mapping.sim_return_selected()=specific_analyses.jw_mapping.Jw_mapping-class.html#sim_return_selected,Method specific_analyses.model_free.main.Model_free_main.sim_return_selected()=specific_analyses.model_free.main.Model_free_main-class.html#sim_return_selected"><a title="specific_analyses.api_base.API_base.sim_return_selected
specific_analyses.consistency_tests.Consistency_tests.sim_return_selected
specific_analyses.frame_order.Frame_order.sim_return_selected
specific_analyses.jw_mapping.Jw_mapping.sim_return_selected
specific_analyses.model_free.main.Model_free_main.sim_return_selected" class="py-name" href="#" onclick="return doclink('link-124', 'sim_return_selected', 'link-124');">sim_return_selected</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-125" class="py-name" targets="Method specific_analyses.api_common.API_common._sim_return_selected_global()=specific_analyses.api_common.API_common-class.html#_sim_return_selected_global"><a title="specific_analyses.api_common.API_common._sim_return_selected_global" class="py-name" href="#" onclick="return doclink('link-125', '_sim_return_selected_global', 'link-125');">_sim_return_selected_global</a></tt> </tt>
<a name="L82"></a><tt class="py-lineno">  82</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-126" class="py-name" targets="Method specific_analyses.api_base.API_base.test_grid_ops()=specific_analyses.api_base.API_base-class.html#test_grid_ops"><a title="specific_analyses.api_base.API_base.test_grid_ops" class="py-name" href="#" onclick="return doclink('link-126', 'test_grid_ops', 'link-126');">test_grid_ops</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-127" class="py-name" targets="Method specific_analyses.api_common.API_common._test_grid_ops_general()=specific_analyses.api_common.API_common-class.html#_test_grid_ops_general"><a title="specific_analyses.api_common.API_common._test_grid_ops_general" class="py-name" href="#" onclick="return doclink('link-127', '_test_grid_ops_general', 'link-127');">_test_grid_ops_general</a></tt> </tt>
<a name="L83"></a><tt class="py-lineno">  83</tt>  <tt class="py-line"> </tt>
<a name="L84"></a><tt class="py-lineno">  84</tt>  <tt class="py-line">        <tt class="py-comment"># Set up the spin parameters.</tt> </tt>
<a name="L85"></a><tt class="py-lineno">  85</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">PARAMS</tt><tt class="py-op">.</tt><tt id="link-128" class="py-name" targets="Method bmrblib.base_classes.BaseSaveframe.add()=bmrblib.base_classes.BaseSaveframe-class.html#add,Method bmrblib.base_classes.MissingSaveframe.add()=bmrblib.base_classes.MissingSaveframe-class.html#add,Method bmrblib.base_classes.TagTranslationTable.add()=bmrblib.base_classes.TagTranslationTable-class.html#add,Method bmrblib.kinetics.relaxation.Relaxation_v2_1.add()=bmrblib.kinetics.relaxation.Relaxation_v2_1-class.html#add,Method bmrblib.kinetics.relaxation.Relaxation_v3_1.add()=bmrblib.kinetics.relaxation.Relaxation_v3_1-class.html#add,Method data_store.Relax_data_store.add()=data_store.Relax_data_store-class.html#add,Method data_store.gui.Analyses.add()=data_store.gui.Analyses-class.html#add,Method lib.spectrum.objects.Peak_list.add()=lib.spectrum.objects.Peak_list-class.html#add,Method multi.slave_commands.Slave_storage_command.add()=multi.slave_commands.Slave_storage_command-class.html#add,Method specific_analyses.api_objects.Param_list.add()=specific_analyses.api_objects.Param_list-class.html#add"><a title="bmrblib.base_classes.BaseSaveframe.add
bmrblib.base_classes.MissingSaveframe.add
bmrblib.base_classes.TagTranslationTable.add
bmrblib.kinetics.relaxation.Relaxation_v2_1.add
bmrblib.kinetics.relaxation.Relaxation_v3_1.add
data_store.Relax_data_store.add
data_store.gui.Analyses.add
lib.spectrum.objects.Peak_list.add
multi.slave_commands.Slave_storage_command.add
specific_analyses.api_objects.Param_list.add" class="py-name" href="#" onclick="return doclink('link-128', 'add', 'link-128');">add</a></tt><tt class="py-op">(</tt><tt class="py-string">'csa'</tt><tt class="py-op">,</tt> <tt class="py-name">scope</tt><tt class="py-op">=</tt><tt class="py-string">'spin'</tt><tt class="py-op">,</tt> <tt class="py-name">units</tt><tt class="py-op">=</tt><tt class="py-string">'ppm'</tt><tt class="py-op">,</tt> <tt id="link-129" class="py-name" targets="Variable gui.analyses.auto_model_free.Local_tm_list.desc=gui.analyses.auto_model_free.Local_tm_list-class.html#desc,Variable gui.analyses.auto_model_free.Mf_list.desc=gui.analyses.auto_model_free.Mf_list-class.html#desc,Variable gui.analyses.elements.model_list.Model_list.desc=gui.analyses.elements.model_list.Model_list-class.html#desc"><a title="gui.analyses.auto_model_free.Local_tm_list.desc
gui.analyses.auto_model_free.Mf_list.desc
gui.analyses.elements.model_list.Model_list.desc" class="py-name" href="#" onclick="return doclink('link-129', 'desc', 'link-129');">desc</a></tt><tt class="py-op">=</tt><tt class="py-string">'CSA value'</tt><tt class="py-op">,</tt> <tt class="py-name">py_type</tt><tt class="py-op">=</tt><tt id="link-130" class="py-name"><a title="lib.float" class="py-name" href="#" onclick="return doclink('link-130', 'float', 'link-20');">float</a></tt><tt class="py-op">,</tt> <tt class="py-name">grace_string</tt><tt class="py-op">=</tt><tt class="py-string">'\\qCSA\\Q'</tt><tt class="py-op">)</tt> </tt>
<a name="L86"></a><tt class="py-lineno">  86</tt>  <tt class="py-line"> </tt>
<a name="L87"></a><tt class="py-lineno">  87</tt>  <tt class="py-line">        <tt class="py-comment"># Add the minimisation data.</tt> </tt>
<a name="L88"></a><tt class="py-lineno">  88</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">PARAMS</tt><tt class="py-op">.</tt><tt id="link-131" class="py-name" targets="Method specific_analyses.api_objects.Param_list.add_min_data()=specific_analyses.api_objects.Param_list-class.html#add_min_data"><a title="specific_analyses.api_objects.Param_list.add_min_data" class="py-name" href="#" onclick="return doclink('link-131', 'add_min_data', 'link-131');">add_min_data</a></tt><tt class="py-op">(</tt><tt class="py-name">min_stats_global</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">,</tt> <tt class="py-name">min_stats_spin</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
</div><a name="L89"></a><tt class="py-lineno">  89</tt>  <tt class="py-line"> </tt>
<a name="L90"></a><tt class="py-lineno">  90</tt>  <tt class="py-line"> </tt>
<a name="N_state_model._CoM"></a><div id="N_state_model._CoM-def"><a name="L91"></a><tt class="py-lineno">  91</tt> <a class="py-toggle" href="#" id="N_state_model._CoM-toggle" onclick="return toggle('N_state_model._CoM');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#_CoM">_CoM</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">pivot_point</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">centre</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model._CoM-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model._CoM-expanded"><a name="L92"></a><tt class="py-lineno">  92</tt>  <tt class="py-line">        <tt class="py-docstring">"""Centre of mass analysis.</tt> </tt>
<a name="L93"></a><tt class="py-lineno">  93</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L94"></a><tt class="py-lineno">  94</tt>  <tt class="py-line"><tt class="py-docstring">        This function does an analysis of the centre of mass (CoM) of the N states.  This includes</tt> </tt>
<a name="L95"></a><tt class="py-lineno">  95</tt>  <tt class="py-line"><tt class="py-docstring">        calculating the order parameter associated with the pivot-CoM vector, and the associated</tt> </tt>
<a name="L96"></a><tt class="py-lineno">  96</tt>  <tt class="py-line"><tt class="py-docstring">        cone of motions.  The pivot_point argument must be supplied.  If centre is None, then the</tt> </tt>
<a name="L97"></a><tt class="py-lineno">  97</tt>  <tt class="py-line"><tt class="py-docstring">        CoM will be calculated from the selected parts of the loaded structure.  Otherwise it will</tt> </tt>
<a name="L98"></a><tt class="py-lineno">  98</tt>  <tt class="py-line"><tt class="py-docstring">        be set to the centre arg.</tt> </tt>
<a name="L99"></a><tt class="py-lineno">  99</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L100"></a><tt class="py-lineno"> 100</tt>  <tt class="py-line"><tt class="py-docstring">        @param pivot_point: The pivot point in the structural file(s).</tt> </tt>
<a name="L101"></a><tt class="py-lineno"> 101</tt>  <tt class="py-line"><tt class="py-docstring">        @type pivot_point:  list of float of length 3</tt> </tt>
<a name="L102"></a><tt class="py-lineno"> 102</tt>  <tt class="py-line"><tt class="py-docstring">        @param centre:      The optional centre of mass vector.</tt> </tt>
<a name="L103"></a><tt class="py-lineno"> 103</tt>  <tt class="py-line"><tt class="py-docstring">        @type centre:       list of float of length 3</tt> </tt>
<a name="L104"></a><tt class="py-lineno"> 104</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L105"></a><tt class="py-lineno"> 105</tt>  <tt class="py-line"> </tt>
<a name="L106"></a><tt class="py-lineno"> 106</tt>  <tt class="py-line">        <tt class="py-comment"># Test if the current data pipe exists.</tt> </tt>
<a name="L107"></a><tt class="py-lineno"> 107</tt>  <tt class="py-line">        <tt id="link-132" class="py-name"><a title="pipe_control.pipes
test_suite.gui_tests.pipes
test_suite.system_tests.pipes" class="py-name" href="#" onclick="return doclink('link-132', 'pipes', 'link-57');">pipes</a></tt><tt class="py-op">.</tt><tt id="link-133" class="py-name" targets="Method bmrblib.pystarlib.TextTest.AllChecks.test()=bmrblib.pystarlib.TextTest.AllChecks-class.html#test,Method bmrblib.pystarlib.UtilsTest.AllChecks.test()=bmrblib.pystarlib.UtilsTest.AllChecks-class.html#test,Function pipe_control.pipes.test()=pipe_control.pipes-module.html#test"><a title="bmrblib.pystarlib.TextTest.AllChecks.test
bmrblib.pystarlib.UtilsTest.AllChecks.test
pipe_control.pipes.test" class="py-name" href="#" onclick="return doclink('link-133', 'test', 'link-133');">test</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L108"></a><tt class="py-lineno"> 108</tt>  <tt class="py-line"> </tt>
<a name="L109"></a><tt class="py-lineno"> 109</tt>  <tt class="py-line">        <tt class="py-comment"># Set the pivot point.</tt> </tt>
<a name="L110"></a><tt class="py-lineno"> 110</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pivot_point</tt> <tt class="py-op">=</tt> <tt class="py-name">pivot_point</tt> </tt>
<a name="L111"></a><tt class="py-lineno"> 111</tt>  <tt class="py-line"> </tt>
<a name="L112"></a><tt class="py-lineno"> 112</tt>  <tt class="py-line">        <tt class="py-comment"># The centre has been supplied.</tt> </tt>
<a name="L113"></a><tt class="py-lineno"> 113</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-134" class="py-name" targets="Method info.Info_box.centre()=info.Info_box-class.html#centre,Function pipe_control.paramag.centre()=pipe_control.paramag-module.html#centre,Function pipe_control.pcs.centre()=pipe_control.pcs-module.html#centre"><a title="info.Info_box.centre
pipe_control.paramag.centre
pipe_control.pcs.centre" class="py-name" href="#" onclick="return doclink('link-134', 'centre', 'link-134');">centre</a></tt><tt class="py-op">:</tt> </tt>
<a name="L114"></a><tt class="py-lineno"> 114</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">CoM</tt> <tt class="py-op">=</tt> <tt id="link-135" class="py-name"><a title="info.Info_box.centre
pipe_control.paramag.centre
pipe_control.pcs.centre" class="py-name" href="#" onclick="return doclink('link-135', 'centre', 'link-134');">centre</a></tt> </tt>
<a name="L115"></a><tt class="py-lineno"> 115</tt>  <tt class="py-line"> </tt>
<a name="L116"></a><tt class="py-lineno"> 116</tt>  <tt class="py-line">        <tt class="py-comment"># Calculate from the structure file.</tt> </tt>
<a name="L117"></a><tt class="py-lineno"> 117</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L118"></a><tt class="py-lineno"> 118</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">CoM</tt> <tt class="py-op">=</tt> <tt id="link-136" class="py-name"><a title="lib.structure.mass.centre_of_mass" class="py-name" href="#" onclick="return doclink('link-136', 'centre_of_mass', 'link-72');">centre_of_mass</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L119"></a><tt class="py-lineno"> 119</tt>  <tt class="py-line"> </tt>
<a name="L120"></a><tt class="py-lineno"> 120</tt>  <tt class="py-line">        <tt class="py-comment"># Calculate the vector between the pivot and CoM points.</tt> </tt>
<a name="L121"></a><tt class="py-lineno"> 121</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pivot_CoM</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">CoM</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> <tt class="py-op">-</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pivot_point</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L122"></a><tt class="py-lineno"> 122</tt>  <tt class="py-line"> </tt>
<a name="L123"></a><tt class="py-lineno"> 123</tt>  <tt class="py-line">        <tt class="py-comment"># Calculate the unit vector between the pivot and CoM points.</tt> </tt>
<a name="L124"></a><tt class="py-lineno"> 124</tt>  <tt class="py-line">        <tt class="py-name">unit_vect</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pivot_CoM</tt> <tt class="py-op">/</tt> <tt class="py-name">norm</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pivot_CoM</tt><tt class="py-op">)</tt> </tt>
<a name="L125"></a><tt class="py-lineno"> 125</tt>  <tt class="py-line"> </tt>
<a name="L126"></a><tt class="py-lineno"> 126</tt>  <tt class="py-line">        <tt class="py-comment"># Initilise some data structures.</tt> </tt>
<a name="L127"></a><tt class="py-lineno"> 127</tt>  <tt class="py-line">        <tt id="link-137" class="py-name" targets="Variable test_suite.unit_tests._lib._geometry.test_rotations.R=test_suite.unit_tests._lib._geometry.test_rotations-module.html#R"><a title="test_suite.unit_tests._lib._geometry.test_rotations.R" class="py-name" href="#" onclick="return doclink('link-137', 'R', 'link-137');">R</a></tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-number">3</tt><tt class="py-op">,</tt> <tt class="py-number">3</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L128"></a><tt class="py-lineno"> 128</tt>  <tt class="py-line">        <tt id="link-138" class="py-name" targets="Module lib.geometry.vectors=lib.geometry.vectors-module.html,Function pipe_control.structure.main.vectors()=pipe_control.structure.main-module.html#vectors"><a title="lib.geometry.vectors
pipe_control.structure.main.vectors" class="py-name" href="#" onclick="return doclink('link-138', 'vectors', 'link-138');">vectors</a></tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">N</tt><tt class="py-op">,</tt> <tt class="py-number">3</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L129"></a><tt class="py-lineno"> 129</tt>  <tt class="py-line"> </tt>
<a name="L130"></a><tt class="py-lineno"> 130</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the N states.</tt> </tt>
<a name="L131"></a><tt class="py-lineno"> 131</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">c</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">N</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L132"></a><tt class="py-lineno"> 132</tt>  <tt class="py-line">            <tt class="py-comment"># Generate the rotation matrix.</tt> </tt>
<a name="L133"></a><tt class="py-lineno"> 133</tt>  <tt class="py-line">            <tt id="link-139" class="py-name"><a title="lib.geometry.rotations.euler_to_R_zyz" class="py-name" href="#" onclick="return doclink('link-139', 'euler_to_R_zyz', 'link-26');">euler_to_R_zyz</a></tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">alpha</tt><tt class="py-op">[</tt><tt class="py-name">c</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">beta</tt><tt class="py-op">[</tt><tt class="py-name">c</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">gamma</tt><tt class="py-op">[</tt><tt class="py-name">c</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt id="link-140" class="py-name"><a title="test_suite.unit_tests._lib._geometry.test_rotations.R" class="py-name" href="#" onclick="return doclink('link-140', 'R', 'link-137');">R</a></tt><tt class="py-op">)</tt> </tt>
<a name="L134"></a><tt class="py-lineno"> 134</tt>  <tt class="py-line"> </tt>
<a name="L135"></a><tt class="py-lineno"> 135</tt>  <tt class="py-line">            <tt class="py-comment"># Rotate the unit vector.</tt> </tt>
<a name="L136"></a><tt class="py-lineno"> 136</tt>  <tt class="py-line">            <tt id="link-141" class="py-name"><a title="lib.geometry.vectors
pipe_control.structure.main.vectors" class="py-name" href="#" onclick="return doclink('link-141', 'vectors', 'link-138');">vectors</a></tt><tt class="py-op">[</tt><tt class="py-name">c</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">dot</tt><tt class="py-op">(</tt><tt id="link-142" class="py-name"><a title="test_suite.unit_tests._lib._geometry.test_rotations.R" class="py-name" href="#" onclick="return doclink('link-142', 'R', 'link-137');">R</a></tt><tt class="py-op">,</tt> <tt class="py-name">unit_vect</tt><tt class="py-op">)</tt> </tt>
<a name="L137"></a><tt class="py-lineno"> 137</tt>  <tt class="py-line"> </tt>
<a name="L138"></a><tt class="py-lineno"> 138</tt>  <tt class="py-line">            <tt class="py-comment"># Multiply by the probability.</tt> </tt>
<a name="L139"></a><tt class="py-lineno"> 139</tt>  <tt class="py-line">            <tt id="link-143" class="py-name"><a title="lib.geometry.vectors
pipe_control.structure.main.vectors" class="py-name" href="#" onclick="return doclink('link-143', 'vectors', 'link-138');">vectors</a></tt><tt class="py-op">[</tt><tt class="py-name">c</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-144" class="py-name"><a title="lib.geometry.vectors
pipe_control.structure.main.vectors" class="py-name" href="#" onclick="return doclink('link-144', 'vectors', 'link-138');">vectors</a></tt><tt class="py-op">[</tt><tt class="py-name">c</tt><tt class="py-op">]</tt> <tt class="py-op">*</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">probs</tt><tt class="py-op">[</tt><tt class="py-name">c</tt><tt class="py-op">]</tt> </tt>
<a name="L140"></a><tt class="py-lineno"> 140</tt>  <tt class="py-line"> </tt>
<a name="L141"></a><tt class="py-lineno"> 141</tt>  <tt class="py-line">        <tt class="py-comment"># Average of the unit vectors.</tt> </tt>
<a name="L142"></a><tt class="py-lineno"> 142</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">ave_unit_pivot_CoM</tt> <tt class="py-op">=</tt> <tt class="py-name">sum</tt><tt class="py-op">(</tt><tt id="link-145" class="py-name"><a title="lib.geometry.vectors
pipe_control.structure.main.vectors" class="py-name" href="#" onclick="return doclink('link-145', 'vectors', 'link-138');">vectors</a></tt><tt class="py-op">)</tt> </tt>
<a name="L143"></a><tt class="py-lineno"> 143</tt>  <tt class="py-line"> </tt>
<a name="L144"></a><tt class="py-lineno"> 144</tt>  <tt class="py-line">        <tt class="py-comment"># The length reduction.</tt> </tt>
<a name="L145"></a><tt class="py-lineno"> 145</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">ave_pivot_CoM_red</tt> <tt class="py-op">=</tt> <tt class="py-name">norm</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">ave_unit_pivot_CoM</tt><tt class="py-op">)</tt> </tt>
<a name="L146"></a><tt class="py-lineno"> 146</tt>  <tt class="py-line"> </tt>
<a name="L147"></a><tt class="py-lineno"> 147</tt>  <tt class="py-line">        <tt class="py-comment"># The aveage pivot-CoM vector.</tt> </tt>
<a name="L148"></a><tt class="py-lineno"> 148</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">ave_pivot_CoM</tt> <tt class="py-op">=</tt> <tt class="py-name">norm</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pivot_CoM</tt><tt class="py-op">)</tt> <tt class="py-op">*</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">ave_unit_pivot_CoM</tt> </tt>
<a name="L149"></a><tt class="py-lineno"> 149</tt>  <tt class="py-line"> </tt>
<a name="L150"></a><tt class="py-lineno"> 150</tt>  <tt class="py-line">        <tt class="py-comment"># The full length rotated pivot-CoM vector.</tt> </tt>
<a name="L151"></a><tt class="py-lineno"> 151</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">full_ave_pivot_CoM</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">ave_pivot_CoM</tt> <tt class="py-op">/</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">ave_pivot_CoM_red</tt> </tt>
<a name="L152"></a><tt class="py-lineno"> 152</tt>  <tt class="py-line"> </tt>
<a name="L153"></a><tt class="py-lineno"> 153</tt>  <tt class="py-line">        <tt class="py-comment"># The cone angle for diffusion on an axially symmetric cone.</tt> </tt>
<a name="L154"></a><tt class="py-lineno"> 154</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">theta_diff_on_cone</tt> <tt class="py-op">=</tt> <tt class="py-name">acos</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">ave_pivot_CoM_red</tt><tt class="py-op">)</tt> </tt>
<a name="L155"></a><tt class="py-lineno"> 155</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">S_diff_on_cone</tt> <tt class="py-op">=</tt> <tt class="py-op">(</tt><tt class="py-number">3.0</tt><tt class="py-op">*</tt><tt class="py-name">cos</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">theta_diff_on_cone</tt><tt class="py-op">)</tt><tt class="py-op">**</tt><tt class="py-number">2</tt> <tt class="py-op">-</tt> <tt class="py-number">1.0</tt><tt class="py-op">)</tt> <tt class="py-op">/</tt> <tt class="py-number">2.0</tt> </tt>
<a name="L156"></a><tt class="py-lineno"> 156</tt>  <tt class="py-line"> </tt>
<a name="L157"></a><tt class="py-lineno"> 157</tt>  <tt class="py-line">        <tt class="py-comment"># The cone angle and order parameter for diffusion in an axially symmetric cone.</tt> </tt>
<a name="L158"></a><tt class="py-lineno"> 158</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">theta_diff_in_cone</tt> <tt class="py-op">=</tt> <tt class="py-name">acos</tt><tt class="py-op">(</tt><tt class="py-number">2.</tt><tt class="py-op">*</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">ave_pivot_CoM_red</tt> <tt class="py-op">-</tt> <tt class="py-number">1.</tt><tt class="py-op">)</tt> </tt>
<a name="L159"></a><tt class="py-lineno"> 159</tt>  <tt class="py-line">        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">S_diff_in_cone</tt> <tt class="py-op">=</tt> <tt class="py-name">cos</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">theta_diff_in_cone</tt><tt class="py-op">)</tt> <tt class="py-op">*</tt> <tt class="py-op">(</tt><tt class="py-number">1</tt> <tt class="py-op">+</tt> <tt class="py-name">cos</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">theta_diff_in_cone</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> <tt class="py-op">/</tt> <tt class="py-number">2.0</tt> </tt>
<a name="L160"></a><tt class="py-lineno"> 160</tt>  <tt class="py-line"> </tt>
<a name="L161"></a><tt class="py-lineno"> 161</tt>  <tt class="py-line">        <tt class="py-comment"># Print out.</tt> </tt>
<a name="L162"></a><tt class="py-lineno"> 162</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\n%-40s %-20s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">"Pivot point:"</tt><tt class="py-op">,</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pivot_point</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L163"></a><tt class="py-lineno"> 163</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%-40s %-20s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">"Moving domain CoM (prior to rotation):"</tt><tt class="py-op">,</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">CoM</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L164"></a><tt class="py-lineno"> 164</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%-40s %-20s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">"Pivot-CoM vector"</tt><tt class="py-op">,</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pivot_CoM</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L165"></a><tt class="py-lineno"> 165</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%-40s %-20s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">"Pivot-CoM unit vector:"</tt><tt class="py-op">,</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">unit_vect</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L166"></a><tt class="py-lineno"> 166</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%-40s %-20s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">"Average of the unit pivot-CoM vectors:"</tt><tt class="py-op">,</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">ave_unit_pivot_CoM</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L167"></a><tt class="py-lineno"> 167</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%-40s %-20s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">"Average of the pivot-CoM vector:"</tt><tt class="py-op">,</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">ave_pivot_CoM</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L168"></a><tt class="py-lineno"> 168</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%-40s %-20s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">"Full length rotated pivot-CoM vector:"</tt><tt class="py-op">,</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">full_ave_pivot_CoM</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L169"></a><tt class="py-lineno"> 169</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%-40s %-20s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">"Length reduction from unity:"</tt><tt class="py-op">,</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">ave_pivot_CoM_red</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L170"></a><tt class="py-lineno"> 170</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%-40s %.5f rad (%.5f deg)"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">"Cone angle (diffusion on a cone)"</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">theta_diff_on_cone</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">theta_diff_on_cone</tt> <tt class="py-op">/</tt> <tt class="py-op">(</tt><tt class="py-number">2</tt><tt class="py-op">*</tt><tt class="py-name">pi</tt><tt class="py-op">)</tt> <tt class="py-op">*</tt><tt class="py-number">360.</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L171"></a><tt class="py-lineno"> 171</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%-40s S_cone = %.5f (S^2 = %.5f)"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">"S_cone (diffusion on a cone)"</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">S_diff_on_cone</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">S_diff_on_cone</tt><tt class="py-op">**</tt><tt class="py-number">2</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L172"></a><tt class="py-lineno"> 172</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%-40s %.5f rad (%.5f deg)"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">"Cone angle (diffusion in a cone)"</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">theta_diff_in_cone</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">theta_diff_in_cone</tt> <tt class="py-op">/</tt> <tt class="py-op">(</tt><tt class="py-number">2</tt><tt class="py-op">*</tt><tt class="py-name">pi</tt><tt class="py-op">)</tt> <tt class="py-op">*</tt><tt class="py-number">360.</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L173"></a><tt class="py-lineno"> 173</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"%-40s S_cone = %.5f (S^2 = %.5f)"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-string">"S_cone (diffusion in a cone)"</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">S_diff_in_cone</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">S_diff_in_cone</tt><tt class="py-op">**</tt><tt class="py-number">2</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L174"></a><tt class="py-lineno"> 174</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\n\n"</tt><tt class="py-op">)</tt> </tt>
</div><a name="L175"></a><tt class="py-lineno"> 175</tt>  <tt class="py-line"> </tt>
<a name="L176"></a><tt class="py-lineno"> 176</tt>  <tt class="py-line"> </tt>
<a name="N_state_model._cone_pdb"></a><div id="N_state_model._cone_pdb-def"><a name="L177"></a><tt class="py-lineno"> 177</tt> <a class="py-toggle" href="#" id="N_state_model._cone_pdb-toggle" onclick="return toggle('N_state_model._cone_pdb');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#_cone_pdb">_cone_pdb</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">cone_type</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">scale</tt><tt class="py-op">=</tt><tt class="py-number">1.0</tt><tt class="py-op">,</tt> <tt class="py-param">file</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">dir</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">force</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model._cone_pdb-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model._cone_pdb-expanded"><a name="L178"></a><tt class="py-lineno"> 178</tt>  <tt class="py-line">        <tt class="py-docstring">"""Create a PDB file containing a geometric object representing the various cone models.</tt> </tt>
<a name="L179"></a><tt class="py-lineno"> 179</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L180"></a><tt class="py-lineno"> 180</tt>  <tt class="py-line"><tt class="py-docstring">        Currently the only cone types supported are 'diff in cone' and 'diff on cone'.</tt> </tt>
<a name="L181"></a><tt class="py-lineno"> 181</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L182"></a><tt class="py-lineno"> 182</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L183"></a><tt class="py-lineno"> 183</tt>  <tt class="py-line"><tt class="py-docstring">        @param cone_type:   The type of cone model to represent.</tt> </tt>
<a name="L184"></a><tt class="py-lineno"> 184</tt>  <tt class="py-line"><tt class="py-docstring">        @type cone_type:    str</tt> </tt>
<a name="L185"></a><tt class="py-lineno"> 185</tt>  <tt class="py-line"><tt class="py-docstring">        @param scale:       The size of the geometric object is eqaul to the average pivot-CoM</tt> </tt>
<a name="L186"></a><tt class="py-lineno"> 186</tt>  <tt class="py-line"><tt class="py-docstring">                            vector length multiplied by this scaling factor.</tt> </tt>
<a name="L187"></a><tt class="py-lineno"> 187</tt>  <tt class="py-line"><tt class="py-docstring">        @type scale:        float</tt> </tt>
<a name="L188"></a><tt class="py-lineno"> 188</tt>  <tt class="py-line"><tt class="py-docstring">        @param file:        The name of the PDB file to create.</tt> </tt>
<a name="L189"></a><tt class="py-lineno"> 189</tt>  <tt class="py-line"><tt class="py-docstring">        @type file:         str</tt> </tt>
<a name="L190"></a><tt class="py-lineno"> 190</tt>  <tt class="py-line"><tt class="py-docstring">        @param dir:         The name of the directory to place the PDB file into.</tt> </tt>
<a name="L191"></a><tt class="py-lineno"> 191</tt>  <tt class="py-line"><tt class="py-docstring">        @type dir:          str</tt> </tt>
<a name="L192"></a><tt class="py-lineno"> 192</tt>  <tt class="py-line"><tt class="py-docstring">        @param force:       Flag which if set to True will cause any pre-existing file to be</tt> </tt>
<a name="L193"></a><tt class="py-lineno"> 193</tt>  <tt class="py-line"><tt class="py-docstring">                            overwritten.</tt> </tt>
<a name="L194"></a><tt class="py-lineno"> 194</tt>  <tt class="py-line"><tt class="py-docstring">        @type force:        int</tt> </tt>
<a name="L195"></a><tt class="py-lineno"> 195</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L196"></a><tt class="py-lineno"> 196</tt>  <tt class="py-line"> </tt>
<a name="L197"></a><tt class="py-lineno"> 197</tt>  <tt class="py-line">        <tt class="py-comment"># Test if the cone models have been determined.</tt> </tt>
<a name="L198"></a><tt class="py-lineno"> 198</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">cone_type</tt> <tt class="py-op">==</tt> <tt class="py-string">'diff in cone'</tt><tt class="py-op">:</tt> </tt>
<a name="L199"></a><tt class="py-lineno"> 199</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'S_diff_in_cone'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L200"></a><tt class="py-lineno"> 200</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-146" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-146', 'RelaxError', 'link-13');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The diffusion in a cone model has not yet been determined."</tt><tt class="py-op">)</tt> </tt>
<a name="L201"></a><tt class="py-lineno"> 201</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">cone_type</tt> <tt class="py-op">==</tt> <tt class="py-string">'diff on cone'</tt><tt class="py-op">:</tt> </tt>
<a name="L202"></a><tt class="py-lineno"> 202</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'S_diff_on_cone'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L203"></a><tt class="py-lineno"> 203</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-147" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-147', 'RelaxError', 'link-13');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The diffusion on a cone model has not yet been determined."</tt><tt class="py-op">)</tt> </tt>
<a name="L204"></a><tt class="py-lineno"> 204</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L205"></a><tt class="py-lineno"> 205</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-148" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-148', 'RelaxError', 'link-13');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The cone type "</tt> <tt class="py-op">+</tt> <tt class="py-name">repr</tt><tt class="py-op">(</tt><tt class="py-name">cone_type</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">" is unknown."</tt><tt class="py-op">)</tt> </tt>
<a name="L206"></a><tt class="py-lineno"> 206</tt>  <tt class="py-line"> </tt>
<a name="L207"></a><tt class="py-lineno"> 207</tt>  <tt class="py-line">        <tt class="py-comment"># The number of increments for the filling of the cone objects.</tt> </tt>
<a name="L208"></a><tt class="py-lineno"> 208</tt>  <tt class="py-line">        <tt class="py-name">inc</tt> <tt class="py-op">=</tt> <tt class="py-number">20</tt> </tt>
<a name="L209"></a><tt class="py-lineno"> 209</tt>  <tt class="py-line"> </tt>
<a name="L210"></a><tt class="py-lineno"> 210</tt>  <tt class="py-line">        <tt class="py-comment"># The rotation matrix.</tt> </tt>
<a name="L211"></a><tt class="py-lineno"> 211</tt>  <tt class="py-line">        <tt id="link-149" class="py-name"><a title="test_suite.unit_tests._lib._geometry.test_rotations.R" class="py-name" href="#" onclick="return doclink('link-149', 'R', 'link-137');">R</a></tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-number">3</tt><tt class="py-op">,</tt> <tt class="py-number">3</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L212"></a><tt class="py-lineno"> 212</tt>  <tt class="py-line">        <tt id="link-150" class="py-name"><a title="lib.geometry.rotations.two_vect_to_R" class="py-name" href="#" onclick="return doclink('link-150', 'two_vect_to_R', 'link-27');">two_vect_to_R</a></tt><tt class="py-op">(</tt><tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">ave_pivot_CoM</tt><tt class="py-op">/</tt><tt class="py-name">norm</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">ave_pivot_CoM</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt id="link-151" class="py-name"><a title="test_suite.unit_tests._lib._geometry.test_rotations.R" class="py-name" href="#" onclick="return doclink('link-151', 'R', 'link-137');">R</a></tt><tt class="py-op">)</tt> </tt>
<a name="L213"></a><tt class="py-lineno"> 213</tt>  <tt class="py-line"> </tt>
<a name="L214"></a><tt class="py-lineno"> 214</tt>  <tt class="py-line">        <tt class="py-comment"># The isotropic cone object.</tt> </tt>
<a name="L215"></a><tt class="py-lineno"> 215</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">cone_type</tt> <tt class="py-op">==</tt> <tt class="py-string">'diff in cone'</tt><tt class="py-op">:</tt> </tt>
<a name="L216"></a><tt class="py-lineno"> 216</tt>  <tt class="py-line">            <tt class="py-name">angle</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">theta_diff_in_cone</tt> </tt>
<a name="L217"></a><tt class="py-lineno"> 217</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">cone_type</tt> <tt class="py-op">==</tt> <tt class="py-string">'diff on cone'</tt><tt class="py-op">:</tt> </tt>
<a name="L218"></a><tt class="py-lineno"> 218</tt>  <tt class="py-line">            <tt class="py-name">angle</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">theta_diff_on_cone</tt> </tt>
<a name="L219"></a><tt class="py-lineno"> 219</tt>  <tt class="py-line">        <tt id="link-152" class="py-name"><a title="lib.structure.represent.cone
lib.structure.represent.cone.cone" class="py-name" href="#" onclick="return doclink('link-152', 'cone', 'link-43');">cone</a></tt> <tt class="py-op">=</tt> <tt id="link-153" class="py-name"><a title="lib.structure.cones.Iso_cone" class="py-name" href="#" onclick="return doclink('link-153', 'Iso_cone', 'link-39');">Iso_cone</a></tt><tt class="py-op">(</tt><tt class="py-name">angle</tt><tt class="py-op">)</tt> </tt>
<a name="L220"></a><tt class="py-lineno"> 220</tt>  <tt class="py-line"> </tt>
<a name="L221"></a><tt class="py-lineno"> 221</tt>  <tt class="py-line">        <tt class="py-comment"># Create the structural object.</tt> </tt>
<a name="L222"></a><tt class="py-lineno"> 222</tt>  <tt class="py-line">        <tt id="link-154" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-154', 'structure', 'link-37');">structure</a></tt> <tt class="py-op">=</tt> <tt id="link-155" class="py-name"><a title="lib.structure.internal.object.Internal" class="py-name" href="#" onclick="return doclink('link-155', 'Internal', 'link-50');">Internal</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L223"></a><tt class="py-lineno"> 223</tt>  <tt class="py-line"> </tt>
<a name="L224"></a><tt class="py-lineno"> 224</tt>  <tt class="py-line">        <tt class="py-comment"># Add a structure.</tt> </tt>
<a name="L225"></a><tt class="py-lineno"> 225</tt>  <tt class="py-line">        <tt id="link-156" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-156', 'structure', 'link-37');">structure</a></tt><tt class="py-op">.</tt><tt id="link-157" class="py-name" targets="Method lib.structure.internal.object.Internal.add_molecule()=lib.structure.internal.object.Internal-class.html#add_molecule"><a title="lib.structure.internal.object.Internal.add_molecule" class="py-name" href="#" onclick="return doclink('link-157', 'add_molecule', 'link-157');">add_molecule</a></tt><tt class="py-op">(</tt><tt id="link-158" class="py-name" targets="Variable bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name=bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe-class.html#name,Variable bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name=bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1-class.html#name,Variable bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name=bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name=bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name=bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name=bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1-class.html#name,Variable bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name=bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1-class.html#name,Variable pipe_control.pipes.name=pipe_control.pipes-module.html#name,Variable user_functions.pipe.name=user_functions.pipe-module.html#name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-158', 'name', 'link-158');">name</a></tt><tt class="py-op">=</tt><tt class="py-string">'cone'</tt><tt class="py-op">)</tt> </tt>
<a name="L226"></a><tt class="py-lineno"> 226</tt>  <tt class="py-line"> </tt>
<a name="L227"></a><tt class="py-lineno"> 227</tt>  <tt class="py-line">        <tt class="py-comment"># Alias the single molecule from the single model.</tt> </tt>
<a name="L228"></a><tt class="py-lineno"> 228</tt>  <tt class="py-line">        <tt class="py-name">mol</tt> <tt class="py-op">=</tt> <tt id="link-159" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-159', 'structure', 'link-37');">structure</a></tt><tt class="py-op">.</tt><tt class="py-name">structural_data</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">mol</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L229"></a><tt class="py-lineno"> 229</tt>  <tt class="py-line"> </tt>
<a name="L230"></a><tt class="py-lineno"> 230</tt>  <tt class="py-line">        <tt class="py-comment"># Add the pivot point.</tt> </tt>
<a name="L231"></a><tt class="py-lineno"> 231</tt>  <tt class="py-line">        <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt id="link-160" class="py-name" targets="Method lib.structure.internal.molecules.MolContainer.atom_add()=lib.structure.internal.molecules.MolContainer-class.html#atom_add"><a title="lib.structure.internal.molecules.MolContainer.atom_add" class="py-name" href="#" onclick="return doclink('link-160', 'atom_add', 'link-160');">atom_add</a></tt><tt class="py-op">(</tt><tt class="py-name">pdb_record</tt><tt class="py-op">=</tt><tt class="py-string">'HETATM'</tt><tt class="py-op">,</tt> <tt class="py-name">atom_num</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt class="py-string">'R'</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-string">'PIV'</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">pos</tt><tt class="py-op">=</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pivot_point</tt><tt class="py-op">,</tt> <tt class="py-name">element</tt><tt class="py-op">=</tt><tt class="py-string">'C'</tt><tt class="py-op">)</tt> </tt>
<a name="L232"></a><tt class="py-lineno"> 232</tt>  <tt class="py-line"> </tt>
<a name="L233"></a><tt class="py-lineno"> 233</tt>  <tt class="py-line">        <tt class="py-comment"># Generate the average pivot-CoM vectors.</tt> </tt>
<a name="L234"></a><tt class="py-lineno"> 234</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\nGenerating the average pivot-CoM vectors."</tt><tt class="py-op">)</tt> </tt>
<a name="L235"></a><tt class="py-lineno"> 235</tt>  <tt class="py-line">        <tt class="py-name">sim_vectors</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L236"></a><tt class="py-lineno"> 236</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'ave_pivot_CoM_sim'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L237"></a><tt class="py-lineno"> 237</tt>  <tt class="py-line">            <tt class="py-name">sim_vectors</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">ave_pivot_CoM_sim</tt> </tt>
<a name="L238"></a><tt class="py-lineno"> 238</tt>  <tt class="py-line">        <tt class="py-name">res_num</tt> <tt class="py-op">=</tt> <tt id="link-161" class="py-name"><a title="pipe_control.structure.geometric" class="py-name" href="#" onclick="return doclink('link-161', 'geometric', 'link-68');">geometric</a></tt><tt class="py-op">.</tt><tt id="link-162" class="py-name" targets="Function pipe_control.structure.geometric.generate_vector_residues()=pipe_control.structure.geometric-module.html#generate_vector_residues"><a title="pipe_control.structure.geometric.generate_vector_residues" class="py-name" href="#" onclick="return doclink('link-162', 'generate_vector_residues', 'link-162');">generate_vector_residues</a></tt><tt class="py-op">(</tt><tt class="py-name">mol</tt><tt class="py-op">=</tt><tt class="py-name">mol</tt><tt class="py-op">,</tt> <tt class="py-name">vector</tt><tt class="py-op">=</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">ave_pivot_CoM</tt><tt class="py-op">,</tt> <tt class="py-name">atom_name</tt><tt class="py-op">=</tt><tt class="py-string">'Ave'</tt><tt class="py-op">,</tt> <tt class="py-name">res_name_vect</tt><tt class="py-op">=</tt><tt class="py-string">'AVE'</tt><tt class="py-op">,</tt> <tt class="py-name">sim_vectors</tt><tt class="py-op">=</tt><tt class="py-name">sim_vectors</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-number">2</tt><tt class="py-op">,</tt> <tt class="py-name">origin</tt><tt class="py-op">=</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pivot_point</tt><tt class="py-op">,</tt> <tt id="link-163" class="py-name" targets="Function pipe_control.value.scale()=pipe_control.value-module.html#scale"><a title="pipe_control.value.scale" class="py-name" href="#" onclick="return doclink('link-163', 'scale', 'link-163');">scale</a></tt><tt class="py-op">=</tt><tt id="link-164" class="py-name"><a title="pipe_control.value.scale" class="py-name" href="#" onclick="return doclink('link-164', 'scale', 'link-163');">scale</a></tt><tt class="py-op">)</tt> </tt>
<a name="L239"></a><tt class="py-lineno"> 239</tt>  <tt class="py-line"> </tt>
<a name="L240"></a><tt class="py-lineno"> 240</tt>  <tt class="py-line">        <tt class="py-comment"># Generate the cone outer edge.</tt> </tt>
<a name="L241"></a><tt class="py-lineno"> 241</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\nGenerating the cone outer edge."</tt><tt class="py-op">)</tt> </tt>
<a name="L242"></a><tt class="py-lineno"> 242</tt>  <tt class="py-line">        <tt class="py-name">cap_start_atom</tt> <tt class="py-op">=</tt> <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt class="py-name">atom_num</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">+</tt><tt class="py-number">1</tt> </tt>
<a name="L243"></a><tt class="py-lineno"> 243</tt>  <tt class="py-line">        <tt id="link-165" class="py-name"><a title="lib.structure.represent.cone.cone_edge" class="py-name" href="#" onclick="return doclink('link-165', 'cone_edge', 'link-44');">cone_edge</a></tt><tt class="py-op">(</tt><tt class="py-name">mol</tt><tt class="py-op">=</tt><tt class="py-name">mol</tt><tt class="py-op">,</tt> <tt id="link-166" class="py-name"><a title="lib.structure.represent.cone
lib.structure.represent.cone.cone" class="py-name" href="#" onclick="return doclink('link-166', 'cone', 'link-43');">cone</a></tt><tt class="py-op">=</tt><tt id="link-167" class="py-name"><a title="lib.structure.represent.cone
lib.structure.represent.cone.cone" class="py-name" href="#" onclick="return doclink('link-167', 'cone', 'link-43');">cone</a></tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-string">'CON'</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-number">3</tt><tt class="py-op">,</tt> <tt class="py-name">apex</tt><tt class="py-op">=</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pivot_point</tt><tt class="py-op">,</tt> <tt id="link-168" class="py-name"><a title="test_suite.unit_tests._lib._geometry.test_rotations.R" class="py-name" href="#" onclick="return doclink('link-168', 'R', 'link-137');">R</a></tt><tt class="py-op">=</tt><tt id="link-169" class="py-name"><a title="test_suite.unit_tests._lib._geometry.test_rotations.R" class="py-name" href="#" onclick="return doclink('link-169', 'R', 'link-137');">R</a></tt><tt class="py-op">,</tt> <tt id="link-170" class="py-name"><a title="pipe_control.value.scale" class="py-name" href="#" onclick="return doclink('link-170', 'scale', 'link-163');">scale</a></tt><tt class="py-op">=</tt><tt class="py-name">norm</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pivot_CoM</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">inc</tt><tt class="py-op">=</tt><tt class="py-name">inc</tt><tt class="py-op">)</tt> </tt>
<a name="L244"></a><tt class="py-lineno"> 244</tt>  <tt class="py-line"> </tt>
<a name="L245"></a><tt class="py-lineno"> 245</tt>  <tt class="py-line">        <tt class="py-comment"># Generate the cone cap, and stitch it to the cone edge.</tt> </tt>
<a name="L246"></a><tt class="py-lineno"> 246</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">cone_type</tt> <tt class="py-op">==</tt> <tt class="py-string">'diff in cone'</tt><tt class="py-op">:</tt> </tt>
<a name="L247"></a><tt class="py-lineno"> 247</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\nGenerating the cone cap."</tt><tt class="py-op">)</tt> </tt>
<a name="L248"></a><tt class="py-lineno"> 248</tt>  <tt class="py-line">            <tt class="py-name">cone_start_atom</tt> <tt class="py-op">=</tt> <tt class="py-name">mol</tt><tt class="py-op">.</tt><tt class="py-name">atom_num</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">+</tt><tt class="py-number">1</tt> </tt>
<a name="L249"></a><tt class="py-lineno"> 249</tt>  <tt class="py-line">            <tt id="link-171" class="py-name"><a title="pipe_control.structure.geometric" class="py-name" href="#" onclick="return doclink('link-171', 'geometric', 'link-68');">geometric</a></tt><tt class="py-op">.</tt><tt id="link-172" class="py-name" targets="Function pipe_control.structure.geometric.generate_vector_dist()=pipe_control.structure.geometric-module.html#generate_vector_dist"><a title="pipe_control.structure.geometric.generate_vector_dist" class="py-name" href="#" onclick="return doclink('link-172', 'generate_vector_dist', 'link-172');">generate_vector_dist</a></tt><tt class="py-op">(</tt><tt class="py-name">mol</tt><tt class="py-op">=</tt><tt class="py-name">mol</tt><tt class="py-op">,</tt> <tt class="py-name">res_name</tt><tt class="py-op">=</tt><tt class="py-string">'CON'</tt><tt class="py-op">,</tt> <tt class="py-name">res_num</tt><tt class="py-op">=</tt><tt class="py-number">3</tt><tt class="py-op">,</tt> <tt id="link-173" class="py-name"><a title="info.Info_box.centre
pipe_control.paramag.centre
pipe_control.pcs.centre" class="py-name" href="#" onclick="return doclink('link-173', 'centre', 'link-134');">centre</a></tt><tt class="py-op">=</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pivot_point</tt><tt class="py-op">,</tt> <tt id="link-174" class="py-name"><a title="test_suite.unit_tests._lib._geometry.test_rotations.R" class="py-name" href="#" onclick="return doclink('link-174', 'R', 'link-137');">R</a></tt><tt class="py-op">=</tt><tt id="link-175" class="py-name"><a title="test_suite.unit_tests._lib._geometry.test_rotations.R" class="py-name" href="#" onclick="return doclink('link-175', 'R', 'link-137');">R</a></tt><tt class="py-op">,</tt> <tt id="link-176" class="py-name" targets="Method lib.structure.cones.Base.limit_check()=lib.structure.cones.Base-class.html#limit_check"><a title="lib.structure.cones.Base.limit_check" class="py-name" href="#" onclick="return doclink('link-176', 'limit_check', 'link-176');">limit_check</a></tt><tt class="py-op">=</tt><tt id="link-177" class="py-name"><a title="lib.structure.represent.cone
lib.structure.represent.cone.cone" class="py-name" href="#" onclick="return doclink('link-177', 'cone', 'link-43');">cone</a></tt><tt class="py-op">.</tt><tt id="link-178" class="py-name"><a title="lib.structure.cones.Base.limit_check" class="py-name" href="#" onclick="return doclink('link-178', 'limit_check', 'link-176');">limit_check</a></tt><tt class="py-op">,</tt> <tt id="link-179" class="py-name"><a title="pipe_control.value.scale" class="py-name" href="#" onclick="return doclink('link-179', 'scale', 'link-163');">scale</a></tt><tt class="py-op">=</tt><tt class="py-name">norm</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pivot_CoM</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">inc</tt><tt class="py-op">=</tt><tt class="py-name">inc</tt><tt class="py-op">)</tt> </tt>
<a name="L250"></a><tt class="py-lineno"> 250</tt>  <tt class="py-line">            <tt id="link-180" class="py-name"><a title="lib.structure.represent.cone.stitch_cone_to_edge" class="py-name" href="#" onclick="return doclink('link-180', 'stitch_cone_to_edge', 'link-45');">stitch_cone_to_edge</a></tt><tt class="py-op">(</tt><tt class="py-name">mol</tt><tt class="py-op">=</tt><tt class="py-name">mol</tt><tt class="py-op">,</tt> <tt id="link-181" class="py-name"><a title="lib.structure.represent.cone
lib.structure.represent.cone.cone" class="py-name" href="#" onclick="return doclink('link-181', 'cone', 'link-43');">cone</a></tt><tt class="py-op">=</tt><tt id="link-182" class="py-name"><a title="lib.structure.represent.cone
lib.structure.represent.cone.cone" class="py-name" href="#" onclick="return doclink('link-182', 'cone', 'link-43');">cone</a></tt><tt class="py-op">,</tt> <tt class="py-name">dome_start</tt><tt class="py-op">=</tt><tt class="py-name">cone_start_atom</tt><tt class="py-op">,</tt> <tt class="py-name">edge_start</tt><tt class="py-op">=</tt><tt class="py-name">cap_start_atom</tt><tt class="py-op">+</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">inc</tt><tt class="py-op">=</tt><tt class="py-name">inc</tt><tt class="py-op">)</tt> </tt>
<a name="L251"></a><tt class="py-lineno"> 251</tt>  <tt class="py-line"> </tt>
<a name="L252"></a><tt class="py-lineno"> 252</tt>  <tt class="py-line">        <tt class="py-comment"># Create the PDB file.</tt> </tt>
<a name="L253"></a><tt class="py-lineno"> 253</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"\nGenerating the PDB file."</tt><tt class="py-op">)</tt> </tt>
<a name="L254"></a><tt class="py-lineno"> 254</tt>  <tt class="py-line">        <tt class="py-name">pdb_file</tt> <tt class="py-op">=</tt> <tt id="link-183" class="py-name"><a title="lib.io.open_write_file" class="py-name" href="#" onclick="return doclink('link-183', 'open_write_file', 'link-30');">open_write_file</a></tt><tt class="py-op">(</tt><tt id="link-184" class="py-name" targets="Variable dep_check.file=dep_check-module.html#file,Module gui.input_elements.file=gui.input_elements.file-module.html,Variable lib.check_types.file=lib.check_types-module.html#file"><a title="dep_check.file
gui.input_elements.file
lib.check_types.file" class="py-name" href="#" onclick="return doclink('link-184', 'file', 'link-184');">file</a></tt><tt class="py-op">,</tt> <tt id="link-185" class="py-name" targets="Module gui.input_elements.dir=gui.input_elements.dir-module.html"><a title="gui.input_elements.dir" class="py-name" href="#" onclick="return doclink('link-185', 'dir', 'link-185');">dir</a></tt><tt class="py-op">,</tt> <tt class="py-name">force</tt><tt class="py-op">=</tt><tt class="py-name">force</tt><tt class="py-op">)</tt> </tt>
<a name="L255"></a><tt class="py-lineno"> 255</tt>  <tt class="py-line">        <tt id="link-186" class="py-name"><a title="bmrblib.structure
lib.structure
pipe_control.structure
test_suite.system_tests.structure
user_functions.structure" class="py-name" href="#" onclick="return doclink('link-186', 'structure', 'link-37');">structure</a></tt><tt class="py-op">.</tt><tt id="link-187" class="py-name" targets="Method lib.structure.internal.object.Internal.write_pdb()=lib.structure.internal.object.Internal-class.html#write_pdb,Function pipe_control.structure.main.write_pdb()=pipe_control.structure.main-module.html#write_pdb"><a title="lib.structure.internal.object.Internal.write_pdb
pipe_control.structure.main.write_pdb" class="py-name" href="#" onclick="return doclink('link-187', 'write_pdb', 'link-187');">write_pdb</a></tt><tt class="py-op">(</tt><tt class="py-name">pdb_file</tt><tt class="py-op">)</tt> </tt>
<a name="L256"></a><tt class="py-lineno"> 256</tt>  <tt class="py-line">        <tt class="py-name">pdb_file</tt><tt class="py-op">.</tt><tt id="link-188" class="py-name" targets="Method gui.input_elements.sequence.Sequence_window.close()=gui.input_elements.sequence.Sequence_window-class.html#close,Method lib.io.DummyFileObject.close()=lib.io.DummyFileObject-class.html#close"><a title="gui.input_elements.sequence.Sequence_window.close
lib.io.DummyFileObject.close" class="py-name" href="#" onclick="return doclink('link-188', 'close', 'link-188');">close</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
</div><a name="L257"></a><tt class="py-lineno"> 257</tt>  <tt class="py-line"> </tt>
<a name="L258"></a><tt class="py-lineno"> 258</tt>  <tt class="py-line"> </tt>
<a name="N_state_model._minimise_bc_data"></a><div id="N_state_model._minimise_bc_data-def"><a name="L259"></a><tt class="py-lineno"> 259</tt> <a class="py-toggle" href="#" id="N_state_model._minimise_bc_data-toggle" onclick="return toggle('N_state_model._minimise_bc_data');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#_minimise_bc_data">_minimise_bc_data</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">model</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model._minimise_bc_data-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model._minimise_bc_data-expanded"><a name="L260"></a><tt class="py-lineno"> 260</tt>  <tt class="py-line">        <tt class="py-docstring">"""Extract and unpack the back calculated data.</tt> </tt>
<a name="L261"></a><tt class="py-lineno"> 261</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L262"></a><tt class="py-lineno"> 262</tt>  <tt class="py-line"><tt class="py-docstring">        @param model:   The instantiated class containing the target function.</tt> </tt>
<a name="L263"></a><tt class="py-lineno"> 263</tt>  <tt class="py-line"><tt class="py-docstring">        @type model:    class instance</tt> </tt>
<a name="L264"></a><tt class="py-lineno"> 264</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L265"></a><tt class="py-lineno"> 265</tt>  <tt class="py-line"> </tt>
<a name="L266"></a><tt class="py-lineno"> 266</tt>  <tt class="py-line">        <tt class="py-comment"># No alignment tensors, so nothing to do.</tt> </tt>
<a name="L267"></a><tt class="py-lineno"> 267</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'align_tensors'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L268"></a><tt class="py-lineno"> 268</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
<a name="L269"></a><tt class="py-lineno"> 269</tt>  <tt class="py-line"> </tt>
<a name="L270"></a><tt class="py-lineno"> 270</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over each alignment.</tt> </tt>
<a name="L271"></a><tt class="py-lineno"> 271</tt>  <tt class="py-line">        <tt class="py-name">align_index</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L272"></a><tt class="py-lineno"> 272</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-189" class="py-name" targets="Variable user_functions.molecule.i=user_functions.molecule-module.html#i"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-189', 'i', 'link-189');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L273"></a><tt class="py-lineno"> 273</tt>  <tt class="py-line">            <tt class="py-comment"># Skip non-optimised tensors.</tt> </tt>
<a name="L274"></a><tt class="py-lineno"> 274</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-190" class="py-name"><a title="specific_analyses.n_state_model.data.opt_tensor" class="py-name" href="#" onclick="return doclink('link-190', 'opt_tensor', 'link-86');">opt_tensor</a></tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">[</tt><tt id="link-191" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-191', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L275"></a><tt class="py-lineno"> 275</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L276"></a><tt class="py-lineno"> 276</tt>  <tt class="py-line"> </tt>
<a name="L277"></a><tt class="py-lineno"> 277</tt>  <tt class="py-line">            <tt class="py-comment"># The alignment ID.</tt> </tt>
<a name="L278"></a><tt class="py-lineno"> 278</tt>  <tt class="py-line">            <tt class="py-name">align_id</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt><tt class="py-op">[</tt><tt id="link-192" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-192', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt> </tt>
<a name="L279"></a><tt class="py-lineno"> 279</tt>  <tt class="py-line"> </tt>
<a name="L280"></a><tt class="py-lineno"> 280</tt>  <tt class="py-line">            <tt class="py-comment"># Data flags</tt> </tt>
<a name="L281"></a><tt class="py-lineno"> 281</tt>  <tt class="py-line">            <tt class="py-name">rdc_flag</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L282"></a><tt class="py-lineno"> 282</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'rdc_ids'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">rdc_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L283"></a><tt class="py-lineno"> 283</tt>  <tt class="py-line">                <tt class="py-name">rdc_flag</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L284"></a><tt class="py-lineno"> 284</tt>  <tt class="py-line">            <tt class="py-name">pcs_flag</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L285"></a><tt class="py-lineno"> 285</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_ids'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pcs_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L286"></a><tt class="py-lineno"> 286</tt>  <tt class="py-line">                <tt class="py-name">pcs_flag</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L287"></a><tt class="py-lineno"> 287</tt>  <tt class="py-line"> </tt>
<a name="L288"></a><tt class="py-lineno"> 288</tt>  <tt class="py-line">            <tt class="py-comment"># Spin loop.</tt> </tt>
<a name="L289"></a><tt class="py-lineno"> 289</tt>  <tt class="py-line">            <tt class="py-name">pcs_index</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L290"></a><tt class="py-lineno"> 290</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-193" class="py-name" targets="Module test_suite.unit_tests._pipe_control.spin=test_suite.unit_tests._pipe_control.spin-module.html,Module user_functions.spin=user_functions.spin-module.html"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-193', 'spin', 'link-193');">spin</a></tt> <tt class="py-keyword">in</tt> <tt id="link-194" class="py-name"><a title="pipe_control.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-194', 'spin_loop', 'link-65');">spin_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L291"></a><tt class="py-lineno"> 291</tt>  <tt class="py-line">                <tt class="py-comment"># Skip deselected spins.</tt> </tt>
<a name="L292"></a><tt class="py-lineno"> 292</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-195" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-195', 'spin', 'link-193');">spin</a></tt><tt class="py-op">.</tt><tt id="link-196" class="py-name" targets="Function pipe_control.model_selection.select()=pipe_control.model_selection-module.html#select,Module user_functions.select=user_functions.select-module.html"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-196', 'select', 'link-196');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L293"></a><tt class="py-lineno"> 293</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L294"></a><tt class="py-lineno"> 294</tt>  <tt class="py-line"> </tt>
<a name="L295"></a><tt class="py-lineno"> 295</tt>  <tt class="py-line">                <tt class="py-comment"># Spins with PCS data.</tt> </tt>
<a name="L296"></a><tt class="py-lineno"> 296</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">pcs_flag</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-197" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-197', 'spin', 'link-193');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L297"></a><tt class="py-lineno"> 297</tt>  <tt class="py-line">                    <tt class="py-comment"># Initialise the data structure if necessary.</tt> </tt>
<a name="L298"></a><tt class="py-lineno"> 298</tt>  <tt class="py-line">                    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-198" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-198', 'spin', 'link-193');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_bc'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L299"></a><tt class="py-lineno"> 299</tt>  <tt class="py-line">                        <tt id="link-199" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-199', 'spin', 'link-193');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_bc</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L300"></a><tt class="py-lineno"> 300</tt>  <tt class="py-line"> </tt>
<a name="L301"></a><tt class="py-lineno"> 301</tt>  <tt class="py-line">                    <tt class="py-comment"># Add the back calculated PCS (in ppm).</tt> </tt>
<a name="L302"></a><tt class="py-lineno"> 302</tt>  <tt class="py-line">                    <tt id="link-200" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-200', 'spin', 'link-193');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_bc</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-201" class="py-name" targets="Function lib.structure.pdb_read.model()=lib.structure.pdb_read-module.html#model,Function lib.structure.pdb_write.model()=lib.structure.pdb_write-module.html#model"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model" class="py-name" href="#" onclick="return doclink('link-201', 'model', 'link-201');">model</a></tt><tt class="py-op">.</tt><tt class="py-name">deltaij_theta</tt><tt class="py-op">[</tt><tt class="py-name">align_index</tt><tt class="py-op">,</tt> <tt class="py-name">pcs_index</tt><tt class="py-op">]</tt> <tt class="py-op">*</tt> <tt class="py-number">1e6</tt> </tt>
<a name="L303"></a><tt class="py-lineno"> 303</tt>  <tt class="py-line"> </tt>
<a name="L304"></a><tt class="py-lineno"> 304</tt>  <tt class="py-line">                    <tt class="py-comment"># Increment the data index if the spin container has data.</tt> </tt>
<a name="L305"></a><tt class="py-lineno"> 305</tt>  <tt class="py-line">                    <tt class="py-name">pcs_index</tt> <tt class="py-op">=</tt> <tt class="py-name">pcs_index</tt> <tt class="py-op">+</tt> <tt class="py-number">1</tt> </tt>
<a name="L306"></a><tt class="py-lineno"> 306</tt>  <tt class="py-line"> </tt>
<a name="L307"></a><tt class="py-lineno"> 307</tt>  <tt class="py-line">            <tt class="py-comment"># Interatomic data container loop.</tt> </tt>
<a name="L308"></a><tt class="py-lineno"> 308</tt>  <tt class="py-line">            <tt class="py-name">rdc_index</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L309"></a><tt class="py-lineno"> 309</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-202" class="py-name" targets="Module user_functions.interatom=user_functions.interatom-module.html"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-202', 'interatom', 'link-202');">interatom</a></tt> <tt class="py-keyword">in</tt> <tt id="link-203" class="py-name"><a title="pipe_control.interatomic.interatomic_loop" class="py-name" href="#" onclick="return doclink('link-203', 'interatomic_loop', 'link-61');">interatomic_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L310"></a><tt class="py-lineno"> 310</tt>  <tt class="py-line">                <tt class="py-comment"># Get the spins.</tt> </tt>
<a name="L311"></a><tt class="py-lineno"> 311</tt>  <tt class="py-line">                <tt class="py-name">spin1</tt> <tt class="py-op">=</tt> <tt id="link-204" class="py-name"><a title="pipe_control.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-204', 'return_spin', 'link-64');">return_spin</a></tt><tt class="py-op">(</tt><tt id="link-205" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-205', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">spin_id1</tt><tt class="py-op">)</tt> </tt>
<a name="L312"></a><tt class="py-lineno"> 312</tt>  <tt class="py-line">                <tt class="py-name">spin2</tt> <tt class="py-op">=</tt> <tt id="link-206" class="py-name"><a title="pipe_control.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-206', 'return_spin', 'link-64');">return_spin</a></tt><tt class="py-op">(</tt><tt id="link-207" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-207', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">spin_id2</tt><tt class="py-op">)</tt> </tt>
<a name="L313"></a><tt class="py-lineno"> 313</tt>  <tt class="py-line"> </tt>
<a name="L314"></a><tt class="py-lineno"> 314</tt>  <tt class="py-line">                <tt class="py-comment"># RDC checks.</tt> </tt>
<a name="L315"></a><tt class="py-lineno"> 315</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-208" class="py-name"><a title="specific_analyses.n_state_model.data.check_rdcs" class="py-name" href="#" onclick="return doclink('link-208', 'check_rdcs', 'link-84');">check_rdcs</a></tt><tt class="py-op">(</tt><tt id="link-209" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-209', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">,</tt> <tt class="py-name">spin1</tt><tt class="py-op">,</tt> <tt class="py-name">spin2</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L316"></a><tt class="py-lineno"> 316</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L317"></a><tt class="py-lineno"> 317</tt>  <tt class="py-line"> </tt>
<a name="L318"></a><tt class="py-lineno"> 318</tt>  <tt class="py-line">                <tt class="py-comment"># Containers with RDC data.</tt> </tt>
<a name="L319"></a><tt class="py-lineno"> 319</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">rdc_flag</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-210" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-210', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">,</tt> <tt class="py-string">'rdc'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L320"></a><tt class="py-lineno"> 320</tt>  <tt class="py-line">                    <tt class="py-comment"># Initialise the data structure if necessary.</tt> </tt>
<a name="L321"></a><tt class="py-lineno"> 321</tt>  <tt class="py-line">                    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-211" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-211', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">,</tt> <tt class="py-string">'rdc_bc'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L322"></a><tt class="py-lineno"> 322</tt>  <tt class="py-line">                        <tt id="link-212" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-212', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_bc</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L323"></a><tt class="py-lineno"> 323</tt>  <tt class="py-line"> </tt>
<a name="L324"></a><tt class="py-lineno"> 324</tt>  <tt class="py-line">                    <tt class="py-comment"># Append the back calculated PCS.</tt> </tt>
<a name="L325"></a><tt class="py-lineno"> 325</tt>  <tt class="py-line">                    <tt id="link-213" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-213', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_bc</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-214" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model" class="py-name" href="#" onclick="return doclink('link-214', 'model', 'link-201');">model</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_theta</tt><tt class="py-op">[</tt><tt class="py-name">align_index</tt><tt class="py-op">,</tt> <tt class="py-name">rdc_index</tt><tt class="py-op">]</tt> </tt>
<a name="L326"></a><tt class="py-lineno"> 326</tt>  <tt class="py-line"> </tt>
<a name="L327"></a><tt class="py-lineno"> 327</tt>  <tt class="py-line">                    <tt class="py-comment"># Increment the data index if the interatom container has data.</tt> </tt>
<a name="L328"></a><tt class="py-lineno"> 328</tt>  <tt class="py-line">                    <tt class="py-name">rdc_index</tt> <tt class="py-op">=</tt> <tt class="py-name">rdc_index</tt> <tt class="py-op">+</tt> <tt class="py-number">1</tt> </tt>
<a name="L329"></a><tt class="py-lineno"> 329</tt>  <tt class="py-line"> </tt>
<a name="L330"></a><tt class="py-lineno"> 330</tt>  <tt class="py-line">            <tt class="py-comment"># Increment the alignment index (for the optimised tensors).</tt> </tt>
<a name="L331"></a><tt class="py-lineno"> 331</tt>  <tt class="py-line">            <tt class="py-name">align_index</tt> <tt class="py-op">+=</tt> <tt class="py-number">1</tt> </tt>
</div><a name="L332"></a><tt class="py-lineno"> 332</tt>  <tt class="py-line"> </tt>
<a name="L333"></a><tt class="py-lineno"> 333</tt>  <tt class="py-line"> </tt>
<a name="N_state_model._minimise_setup_atomic_pos"></a><div id="N_state_model._minimise_setup_atomic_pos-def"><a name="L334"></a><tt class="py-lineno"> 334</tt> <a class="py-toggle" href="#" id="N_state_model._minimise_setup_atomic_pos-toggle" onclick="return toggle('N_state_model._minimise_setup_atomic_pos');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#_minimise_setup_atomic_pos">_minimise_setup_atomic_pos</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model._minimise_setup_atomic_pos-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model._minimise_setup_atomic_pos-expanded"><a name="L335"></a><tt class="py-lineno"> 335</tt>  <tt class="py-line">        <tt class="py-docstring">"""Set up the atomic position data structures for optimisation using PCSs and PREs as base data sets.</tt> </tt>
<a name="L336"></a><tt class="py-lineno"> 336</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L337"></a><tt class="py-lineno"> 337</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword sim_index: The index of the simulation to optimise.  This should be None if normal optimisation is desired.</tt> </tt>
<a name="L338"></a><tt class="py-lineno"> 338</tt>  <tt class="py-line"><tt class="py-docstring">        @type sim_index:    None or int</tt> </tt>
<a name="L339"></a><tt class="py-lineno"> 339</tt>  <tt class="py-line"><tt class="py-docstring">        @return:            The atomic positions (the first index is the spins, the second is the structures, and the third is the atomic coordinates) and the paramagnetic centre.</tt> </tt>
<a name="L340"></a><tt class="py-lineno"> 340</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:             numpy rank-3 array, numpy rank-1 array.</tt> </tt>
<a name="L341"></a><tt class="py-lineno"> 341</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L342"></a><tt class="py-lineno"> 342</tt>  <tt class="py-line"> </tt>
<a name="L343"></a><tt class="py-lineno"> 343</tt>  <tt class="py-line">        <tt class="py-comment"># Initialise.</tt> </tt>
<a name="L344"></a><tt class="py-lineno"> 344</tt>  <tt class="py-line">        <tt class="py-name">atomic_pos</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L345"></a><tt class="py-lineno"> 345</tt>  <tt class="py-line"> </tt>
<a name="L346"></a><tt class="py-lineno"> 346</tt>  <tt class="py-line">        <tt class="py-comment"># Store the atomic positions.</tt> </tt>
<a name="L347"></a><tt class="py-lineno"> 347</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-215" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-215', 'spin', 'link-193');">spin</a></tt> <tt class="py-keyword">in</tt> <tt id="link-216" class="py-name"><a title="pipe_control.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-216', 'spin_loop', 'link-65');">spin_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L348"></a><tt class="py-lineno"> 348</tt>  <tt class="py-line">            <tt class="py-comment"># Skip deselected spins.</tt> </tt>
<a name="L349"></a><tt class="py-lineno"> 349</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-217" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-217', 'spin', 'link-193');">spin</a></tt><tt class="py-op">.</tt><tt id="link-218" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-218', 'select', 'link-196');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L350"></a><tt class="py-lineno"> 350</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L351"></a><tt class="py-lineno"> 351</tt>  <tt class="py-line"> </tt>
<a name="L352"></a><tt class="py-lineno"> 352</tt>  <tt class="py-line">            <tt class="py-comment"># Only use spins with alignment/paramagnetic data.</tt> </tt>
<a name="L353"></a><tt class="py-lineno"> 353</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-219" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-219', 'spin', 'link-193');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-220" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-220', 'spin', 'link-193');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pre'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L354"></a><tt class="py-lineno"> 354</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L355"></a><tt class="py-lineno"> 355</tt>  <tt class="py-line"> </tt>
<a name="L356"></a><tt class="py-lineno"> 356</tt>  <tt class="py-line">            <tt class="py-comment"># The position list.</tt> </tt>
<a name="L357"></a><tt class="py-lineno"> 357</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-221" class="py-name" targets="Variable info.Bieri11.type=info.Bieri11-class.html#type,Variable info.Clore90.type=info.Clore90-class.html#type,Variable info.Delaglio95.type=info.Delaglio95-class.html#type,Variable info.GoddardKneller.type=info.GoddardKneller-class.html#type,Variable info.LipariSzabo82a.type=info.LipariSzabo82a-class.html#type,Variable info.LipariSzabo82b.type=info.LipariSzabo82b-class.html#type,Variable info.Ref.type=info.Ref-class.html#type,Variable info.dAuvergne06.type=info.dAuvergne06-class.html#type,Variable info.dAuvergneGooley03.type=info.dAuvergneGooley03-class.html#type,Variable info.dAuvergneGooley06.type=info.dAuvergneGooley06-class.html#type,Variable info.dAuvergneGooley07.type=info.dAuvergneGooley07-class.html#type,Variable info.dAuvergneGooley08a.type=info.dAuvergneGooley08a-class.html#type,Variable info.dAuvergneGooley08b.type=info.dAuvergneGooley08b-class.html#type,Function pipe_control.relax_data.type()=pipe_control.relax_data-module.html#type"><a title="info.Bieri11.type
info.Clore90.type
info.Delaglio95.type
info.GoddardKneller.type
info.LipariSzabo82a.type
info.LipariSzabo82b.type
info.Ref.type
info.dAuvergne06.type
info.dAuvergneGooley03.type
info.dAuvergneGooley06.type
info.dAuvergneGooley07.type
info.dAuvergneGooley08a.type
info.dAuvergneGooley08b.type
pipe_control.relax_data.type" class="py-name" href="#" onclick="return doclink('link-221', 'type', 'link-221');">type</a></tt><tt class="py-op">(</tt><tt id="link-222" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-222', 'spin', 'link-193');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pos</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt id="link-223" class="py-name"><a title="lib.float" class="py-name" href="#" onclick="return doclink('link-223', 'float', 'link-20');">float</a></tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L358"></a><tt class="py-lineno"> 358</tt>  <tt class="py-line">                <tt class="py-name">atomic_pos</tt><tt class="py-op">.</tt><tt id="link-224" class="py-name" targets="Method data_store.align_tensor.AlignTensorSimList.append()=data_store.align_tensor.AlignTensorSimList-class.html#append,Method data_store.diff_tensor.DiffTensorSimList.append()=data_store.diff_tensor.DiffTensorSimList-class.html#append"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-224', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt id="link-225" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-225', 'spin', 'link-193');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pos</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L359"></a><tt class="py-lineno"> 359</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L360"></a><tt class="py-lineno"> 360</tt>  <tt class="py-line">                <tt class="py-name">atomic_pos</tt><tt class="py-op">.</tt><tt id="link-226" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-226', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt id="link-227" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-227', 'spin', 'link-193');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pos</tt><tt class="py-op">)</tt> </tt>
<a name="L361"></a><tt class="py-lineno"> 361</tt>  <tt class="py-line"> </tt>
<a name="L362"></a><tt class="py-lineno"> 362</tt>  <tt class="py-line">        <tt class="py-comment"># Convert to numpy objects.</tt> </tt>
<a name="L363"></a><tt class="py-lineno"> 363</tt>  <tt class="py-line">        <tt class="py-name">atomic_pos</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">atomic_pos</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L364"></a><tt class="py-lineno"> 364</tt>  <tt class="py-line"> </tt>
<a name="L365"></a><tt class="py-lineno"> 365</tt>  <tt class="py-line">        <tt class="py-comment"># The paramagnetic centre.</tt> </tt>
<a name="L366"></a><tt class="py-lineno"> 366</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'paramagnetic_centre'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L367"></a><tt class="py-lineno"> 367</tt>  <tt class="py-line">            <tt id="link-228" class="py-name" targets="Module lib.alignment.paramag_centre=lib.alignment.paramag_centre-module.html"><a title="lib.alignment.paramag_centre" class="py-name" href="#" onclick="return doclink('link-228', 'paramag_centre', 'link-228');">paramag_centre</a></tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-number">3</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L368"></a><tt class="py-lineno"> 368</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">sim_index</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramag_centre_fixed</tt><tt class="py-op">:</tt> </tt>
<a name="L369"></a><tt class="py-lineno"> 369</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'paramagnetic_centre_sim'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramagnetic_centre_sim</tt><tt class="py-op">[</tt><tt class="py-name">sim_index</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L370"></a><tt class="py-lineno"> 370</tt>  <tt class="py-line">                <tt id="link-229" class="py-name"><a title="lib.alignment.paramag_centre" class="py-name" href="#" onclick="return doclink('link-229', 'paramag_centre', 'link-228');">paramag_centre</a></tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-number">3</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L371"></a><tt class="py-lineno"> 371</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L372"></a><tt class="py-lineno"> 372</tt>  <tt class="py-line">                <tt id="link-230" class="py-name"><a title="lib.alignment.paramag_centre" class="py-name" href="#" onclick="return doclink('link-230', 'paramag_centre', 'link-228');">paramag_centre</a></tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramagnetic_centre_sim</tt><tt class="py-op">[</tt><tt class="py-name">sim_index</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L373"></a><tt class="py-lineno"> 373</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L374"></a><tt class="py-lineno"> 374</tt>  <tt class="py-line">            <tt id="link-231" class="py-name"><a title="lib.alignment.paramag_centre" class="py-name" href="#" onclick="return doclink('link-231', 'paramag_centre', 'link-228');">paramag_centre</a></tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramagnetic_centre</tt><tt class="py-op">)</tt> </tt>
<a name="L375"></a><tt class="py-lineno"> 375</tt>  <tt class="py-line"> </tt>
<a name="L376"></a><tt class="py-lineno"> 376</tt>  <tt class="py-line">        <tt class="py-comment"># Return the data structures.</tt> </tt>
<a name="L377"></a><tt class="py-lineno"> 377</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">atomic_pos</tt><tt class="py-op">,</tt> <tt id="link-232" class="py-name"><a title="lib.alignment.paramag_centre" class="py-name" href="#" onclick="return doclink('link-232', 'paramag_centre', 'link-228');">paramag_centre</a></tt> </tt>
</div><a name="L378"></a><tt class="py-lineno"> 378</tt>  <tt class="py-line"> </tt>
<a name="L379"></a><tt class="py-lineno"> 379</tt>  <tt class="py-line"> </tt>
<a name="N_state_model._minimise_setup_pcs"></a><div id="N_state_model._minimise_setup_pcs-def"><a name="L380"></a><tt class="py-lineno"> 380</tt> <a class="py-toggle" href="#" id="N_state_model._minimise_setup_pcs-toggle" onclick="return toggle('N_state_model._minimise_setup_pcs');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#_minimise_setup_pcs">_minimise_setup_pcs</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model._minimise_setup_pcs-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model._minimise_setup_pcs-expanded"><a name="L381"></a><tt class="py-lineno"> 381</tt>  <tt class="py-line">        <tt class="py-docstring">"""Set up the data structures for optimisation using PCSs as base data sets.</tt> </tt>
<a name="L382"></a><tt class="py-lineno"> 382</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L383"></a><tt class="py-lineno"> 383</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword sim_index: The index of the simulation to optimise.  This should be None if normal optimisation is desired.</tt> </tt>
<a name="L384"></a><tt class="py-lineno"> 384</tt>  <tt class="py-line"><tt class="py-docstring">        @type sim_index:    None or int</tt> </tt>
<a name="L385"></a><tt class="py-lineno"> 385</tt>  <tt class="py-line"><tt class="py-docstring">        @return:            The assembled data structures for using PCSs as the base data for optimisation.  These include:</tt> </tt>
<a name="L386"></a><tt class="py-lineno"> 386</tt>  <tt class="py-line"><tt class="py-docstring">                                - the PCS values.</tt> </tt>
<a name="L387"></a><tt class="py-lineno"> 387</tt>  <tt class="py-line"><tt class="py-docstring">                                - the unit vectors connecting the paramagnetic centre (the electron spin) to</tt> </tt>
<a name="L388"></a><tt class="py-lineno"> 388</tt>  <tt class="py-line"><tt class="py-docstring">                                - the PCS weight.</tt> </tt>
<a name="L389"></a><tt class="py-lineno"> 389</tt>  <tt class="py-line"><tt class="py-docstring">                                - the nuclear spin.</tt> </tt>
<a name="L390"></a><tt class="py-lineno"> 390</tt>  <tt class="py-line"><tt class="py-docstring">                                - the pseudocontact shift constants.</tt> </tt>
<a name="L391"></a><tt class="py-lineno"> 391</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:             tuple of (numpy rank-2 array, numpy rank-2 array, numpy rank-2 array, numpy rank-1 array, numpy rank-1 array)</tt> </tt>
<a name="L392"></a><tt class="py-lineno"> 392</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L393"></a><tt class="py-lineno"> 393</tt>  <tt class="py-line"> </tt>
<a name="L394"></a><tt class="py-lineno"> 394</tt>  <tt class="py-line">        <tt class="py-comment"># Data setup tests.</tt> </tt>
<a name="L395"></a><tt class="py-lineno"> 395</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'paramagnetic_centre'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-op">(</tt><tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'paramag_centre_fixed'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramag_centre_fixed</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L396"></a><tt class="py-lineno"> 396</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-233" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-233', 'RelaxError', 'link-13');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The paramagnetic centre has not yet been specified."</tt><tt class="py-op">)</tt> </tt>
<a name="L397"></a><tt class="py-lineno"> 397</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'temperature'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L398"></a><tt class="py-lineno"> 398</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-234" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-234', 'RelaxError', 'link-13');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The experimental temperatures have not been set."</tt><tt class="py-op">)</tt> </tt>
<a name="L399"></a><tt class="py-lineno"> 399</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'spectrometer_frq'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L400"></a><tt class="py-lineno"> 400</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-235" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-235', 'RelaxError', 'link-13');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The spectrometer frequencies of the experiments have not been set."</tt><tt class="py-op">)</tt> </tt>
<a name="L401"></a><tt class="py-lineno"> 401</tt>  <tt class="py-line"> </tt>
<a name="L402"></a><tt class="py-lineno"> 402</tt>  <tt class="py-line">        <tt class="py-comment"># Initialise.</tt> </tt>
<a name="L403"></a><tt class="py-lineno"> 403</tt>  <tt class="py-line">        <tt id="link-236" class="py-name"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-236', 'pcs', 'link-56');">pcs</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L404"></a><tt class="py-lineno"> 404</tt>  <tt class="py-line">        <tt class="py-name">pcs_err</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L405"></a><tt class="py-lineno"> 405</tt>  <tt class="py-line">        <tt class="py-name">pcs_weight</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L406"></a><tt class="py-lineno"> 406</tt>  <tt class="py-line">        <tt class="py-name">temp</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L407"></a><tt class="py-lineno"> 407</tt>  <tt class="py-line">        <tt class="py-name">frq</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L408"></a><tt class="py-lineno"> 408</tt>  <tt class="py-line"> </tt>
<a name="L409"></a><tt class="py-lineno"> 409</tt>  <tt class="py-line">        <tt class="py-comment"># The PCS data.</tt> </tt>
<a name="L410"></a><tt class="py-lineno"> 410</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-237" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-237', 'i', 'link-189');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L411"></a><tt class="py-lineno"> 411</tt>  <tt class="py-line">            <tt class="py-comment"># Alias the ID.</tt> </tt>
<a name="L412"></a><tt class="py-lineno"> 412</tt>  <tt class="py-line">            <tt class="py-name">align_id</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt><tt class="py-op">[</tt><tt id="link-238" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-238', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt> </tt>
<a name="L413"></a><tt class="py-lineno"> 413</tt>  <tt class="py-line"> </tt>
<a name="L414"></a><tt class="py-lineno"> 414</tt>  <tt class="py-line">            <tt class="py-comment"># Skip non-optimised data.</tt> </tt>
<a name="L415"></a><tt class="py-lineno"> 415</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-239" class="py-name"><a title="specific_analyses.n_state_model.data.opt_uses_align_data" class="py-name" href="#" onclick="return doclink('link-239', 'opt_uses_align_data', 'link-87');">opt_uses_align_data</a></tt><tt class="py-op">(</tt><tt class="py-name">align_id</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L416"></a><tt class="py-lineno"> 416</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L417"></a><tt class="py-lineno"> 417</tt>  <tt class="py-line"> </tt>
<a name="L418"></a><tt class="py-lineno"> 418</tt>  <tt class="py-line">            <tt class="py-comment"># Append empty arrays to the PCS structures.</tt> </tt>
<a name="L419"></a><tt class="py-lineno"> 419</tt>  <tt class="py-line">            <tt id="link-240" class="py-name"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-240', 'pcs', 'link-56');">pcs</a></tt><tt class="py-op">.</tt><tt id="link-241" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-241', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L420"></a><tt class="py-lineno"> 420</tt>  <tt class="py-line">            <tt class="py-name">pcs_err</tt><tt class="py-op">.</tt><tt id="link-242" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-242', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L421"></a><tt class="py-lineno"> 421</tt>  <tt class="py-line">            <tt class="py-name">pcs_weight</tt><tt class="py-op">.</tt><tt id="link-243" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-243', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L422"></a><tt class="py-lineno"> 422</tt>  <tt class="py-line"> </tt>
<a name="L423"></a><tt class="py-lineno"> 423</tt>  <tt class="py-line">            <tt class="py-comment"># Get the temperature for the PCS constant.</tt> </tt>
<a name="L424"></a><tt class="py-lineno"> 424</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">temperature</tt><tt class="py-op">:</tt> </tt>
<a name="L425"></a><tt class="py-lineno"> 425</tt>  <tt class="py-line">                <tt class="py-name">temp</tt><tt class="py-op">.</tt><tt id="link-244" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-244', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">temperature</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L426"></a><tt class="py-lineno"> 426</tt>  <tt class="py-line"> </tt>
<a name="L427"></a><tt class="py-lineno"> 427</tt>  <tt class="py-line">            <tt class="py-comment"># The temperature must be given!</tt> </tt>
<a name="L428"></a><tt class="py-lineno"> 428</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L429"></a><tt class="py-lineno"> 429</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-245" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-245', 'RelaxError', 'link-13');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The experimental temperature for the alignment ID '%s' has not been set."</tt> <tt class="py-op">%</tt> <tt class="py-name">align_id</tt><tt class="py-op">)</tt> </tt>
<a name="L430"></a><tt class="py-lineno"> 430</tt>  <tt class="py-line"> </tt>
<a name="L431"></a><tt class="py-lineno"> 431</tt>  <tt class="py-line">            <tt class="py-comment"># Get the spectrometer frequency in Tesla units for the PCS constant.</tt> </tt>
<a name="L432"></a><tt class="py-lineno"> 432</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">spectrometer_frq</tt><tt class="py-op">:</tt> </tt>
<a name="L433"></a><tt class="py-lineno"> 433</tt>  <tt class="py-line">                <tt class="py-name">frq</tt><tt class="py-op">.</tt><tt id="link-246" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-246', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">spectrometer_frq</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt> <tt class="py-op">*</tt> <tt class="py-number">2.0</tt> <tt class="py-op">*</tt> <tt class="py-name">pi</tt> <tt class="py-op">/</tt> <tt id="link-247" class="py-name"><a title="lib.physical_constants.g1H" class="py-name" href="#" onclick="return doclink('link-247', 'g1H', 'link-34');">g1H</a></tt><tt class="py-op">)</tt> </tt>
<a name="L434"></a><tt class="py-lineno"> 434</tt>  <tt class="py-line"> </tt>
<a name="L435"></a><tt class="py-lineno"> 435</tt>  <tt class="py-line">            <tt class="py-comment"># The frequency must be given!</tt> </tt>
<a name="L436"></a><tt class="py-lineno"> 436</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L437"></a><tt class="py-lineno"> 437</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-248" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-248', 'RelaxError', 'link-13');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The spectrometer frequency for the alignment ID '%s' has not been set."</tt> <tt class="py-op">%</tt> <tt class="py-name">align_id</tt><tt class="py-op">)</tt> </tt>
<a name="L438"></a><tt class="py-lineno"> 438</tt>  <tt class="py-line"> </tt>
<a name="L439"></a><tt class="py-lineno"> 439</tt>  <tt class="py-line">            <tt class="py-comment"># Spin loop.</tt> </tt>
<a name="L440"></a><tt class="py-lineno"> 440</tt>  <tt class="py-line">            <tt class="py-name">j</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L441"></a><tt class="py-lineno"> 441</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-249" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-249', 'spin', 'link-193');">spin</a></tt> <tt class="py-keyword">in</tt> <tt id="link-250" class="py-name"><a title="pipe_control.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-250', 'spin_loop', 'link-65');">spin_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L442"></a><tt class="py-lineno"> 442</tt>  <tt class="py-line">                <tt class="py-comment"># Skip deselected spins.</tt> </tt>
<a name="L443"></a><tt class="py-lineno"> 443</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-251" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-251', 'spin', 'link-193');">spin</a></tt><tt class="py-op">.</tt><tt id="link-252" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-252', 'select', 'link-196');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L444"></a><tt class="py-lineno"> 444</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L445"></a><tt class="py-lineno"> 445</tt>  <tt class="py-line"> </tt>
<a name="L446"></a><tt class="py-lineno"> 446</tt>  <tt class="py-line">                <tt class="py-comment"># Skip spins without PCS data.</tt> </tt>
<a name="L447"></a><tt class="py-lineno"> 447</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-253" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-253', 'spin', 'link-193');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L448"></a><tt class="py-lineno"> 448</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L449"></a><tt class="py-lineno"> 449</tt>  <tt class="py-line"> </tt>
<a name="L450"></a><tt class="py-lineno"> 450</tt>  <tt class="py-line">                <tt class="py-comment"># Append the PCSs to the list.</tt> </tt>
<a name="L451"></a><tt class="py-lineno"> 451</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt id="link-254" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-254', 'spin', 'link-193');">spin</a></tt><tt class="py-op">.</tt><tt id="link-255" class="py-name"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-255', 'pcs', 'link-56');">pcs</a></tt><tt class="py-op">.</tt><tt class="py-name">keys</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L452"></a><tt class="py-lineno"> 452</tt>  <tt class="py-line">                    <tt class="py-keyword">if</tt> <tt class="py-name">sim_index</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L453"></a><tt class="py-lineno"> 453</tt>  <tt class="py-line">                        <tt id="link-256" class="py-name"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-256', 'pcs', 'link-56');">pcs</a></tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-257" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-257', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt id="link-258" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-258', 'spin', 'link-193');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_sim</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-name">sim_index</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L454"></a><tt class="py-lineno"> 454</tt>  <tt class="py-line">                    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L455"></a><tt class="py-lineno"> 455</tt>  <tt class="py-line">                        <tt id="link-259" class="py-name"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-259', 'pcs', 'link-56');">pcs</a></tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-260" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-260', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt id="link-261" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-261', 'spin', 'link-193');">spin</a></tt><tt class="py-op">.</tt><tt id="link-262" class="py-name"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-262', 'pcs', 'link-56');">pcs</a></tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L456"></a><tt class="py-lineno"> 456</tt>  <tt class="py-line">                <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L457"></a><tt class="py-lineno"> 457</tt>  <tt class="py-line">                    <tt id="link-263" class="py-name"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-263', 'pcs', 'link-56');">pcs</a></tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-264" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-264', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">None</tt><tt class="py-op">)</tt> </tt>
<a name="L458"></a><tt class="py-lineno"> 458</tt>  <tt class="py-line"> </tt>
<a name="L459"></a><tt class="py-lineno"> 459</tt>  <tt class="py-line">                <tt class="py-comment"># Append the PCS errors.</tt> </tt>
<a name="L460"></a><tt class="py-lineno"> 460</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-265" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-265', 'spin', 'link-193');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_err'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt id="link-266" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-266', 'spin', 'link-193');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt><tt class="py-op">.</tt><tt class="py-name">keys</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L461"></a><tt class="py-lineno"> 461</tt>  <tt class="py-line">                    <tt class="py-name">pcs_err</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-267" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-267', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt id="link-268" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-268', 'spin', 'link-193');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L462"></a><tt class="py-lineno"> 462</tt>  <tt class="py-line">                <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L463"></a><tt class="py-lineno"> 463</tt>  <tt class="py-line">                    <tt class="py-name">pcs_err</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-269" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-269', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">None</tt><tt class="py-op">)</tt> </tt>
<a name="L464"></a><tt class="py-lineno"> 464</tt>  <tt class="py-line"> </tt>
<a name="L465"></a><tt class="py-lineno"> 465</tt>  <tt class="py-line">                <tt class="py-comment"># Append the weight.</tt> </tt>
<a name="L466"></a><tt class="py-lineno"> 466</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-270" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-270', 'spin', 'link-193');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_weight'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt id="link-271" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-271', 'spin', 'link-193');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_weight</tt><tt class="py-op">.</tt><tt class="py-name">keys</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L467"></a><tt class="py-lineno"> 467</tt>  <tt class="py-line">                    <tt class="py-name">pcs_weight</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-272" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-272', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt id="link-273" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-273', 'spin', 'link-193');">spin</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_weight</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L468"></a><tt class="py-lineno"> 468</tt>  <tt class="py-line">                <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L469"></a><tt class="py-lineno"> 469</tt>  <tt class="py-line">                    <tt class="py-name">pcs_weight</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-274" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-274', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-number">1.0</tt><tt class="py-op">)</tt> </tt>
<a name="L470"></a><tt class="py-lineno"> 470</tt>  <tt class="py-line"> </tt>
<a name="L471"></a><tt class="py-lineno"> 471</tt>  <tt class="py-line">                <tt class="py-comment"># Spin index.</tt> </tt>
<a name="L472"></a><tt class="py-lineno"> 472</tt>  <tt class="py-line">                <tt class="py-name">j</tt> <tt class="py-op">=</tt> <tt class="py-name">j</tt> <tt class="py-op">+</tt> <tt class="py-number">1</tt> </tt>
<a name="L473"></a><tt class="py-lineno"> 473</tt>  <tt class="py-line"> </tt>
<a name="L474"></a><tt class="py-lineno"> 474</tt>  <tt class="py-line">        <tt class="py-comment"># Convert to numpy objects.</tt> </tt>
<a name="L475"></a><tt class="py-lineno"> 475</tt>  <tt class="py-line">        <tt id="link-275" class="py-name"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-275', 'pcs', 'link-56');">pcs</a></tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt id="link-276" class="py-name"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-276', 'pcs', 'link-56');">pcs</a></tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L476"></a><tt class="py-lineno"> 476</tt>  <tt class="py-line">        <tt class="py-name">pcs_err</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">pcs_err</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L477"></a><tt class="py-lineno"> 477</tt>  <tt class="py-line">        <tt class="py-name">pcs_weight</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">pcs_weight</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L478"></a><tt class="py-lineno"> 478</tt>  <tt class="py-line"> </tt>
<a name="L479"></a><tt class="py-lineno"> 479</tt>  <tt class="py-line">        <tt class="py-comment"># Convert the PCS from ppm to no units.</tt> </tt>
<a name="L480"></a><tt class="py-lineno"> 480</tt>  <tt class="py-line">        <tt id="link-277" class="py-name"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-277', 'pcs', 'link-56');">pcs</a></tt> <tt class="py-op">=</tt> <tt id="link-278" class="py-name"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-278', 'pcs', 'link-56');">pcs</a></tt> <tt class="py-op">*</tt> <tt class="py-number">1e-6</tt> </tt>
<a name="L481"></a><tt class="py-lineno"> 481</tt>  <tt class="py-line">        <tt class="py-name">pcs_err</tt> <tt class="py-op">=</tt> <tt class="py-name">pcs_err</tt> <tt class="py-op">*</tt> <tt class="py-number">1e-6</tt> </tt>
<a name="L482"></a><tt class="py-lineno"> 482</tt>  <tt class="py-line"> </tt>
<a name="L483"></a><tt class="py-lineno"> 483</tt>  <tt class="py-line">        <tt class="py-comment"># Return the data structures.</tt> </tt>
<a name="L484"></a><tt class="py-lineno"> 484</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt id="link-279" class="py-name"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-279', 'pcs', 'link-56');">pcs</a></tt><tt class="py-op">,</tt> <tt class="py-name">pcs_err</tt><tt class="py-op">,</tt> <tt class="py-name">pcs_weight</tt><tt class="py-op">,</tt> <tt class="py-name">temp</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt> </tt>
</div><a name="L485"></a><tt class="py-lineno"> 485</tt>  <tt class="py-line"> </tt>
<a name="L486"></a><tt class="py-lineno"> 486</tt>  <tt class="py-line"> </tt>
<a name="N_state_model._minimise_setup_rdcs"></a><div id="N_state_model._minimise_setup_rdcs-def"><a name="L487"></a><tt class="py-lineno"> 487</tt> <a class="py-toggle" href="#" id="N_state_model._minimise_setup_rdcs-toggle" onclick="return toggle('N_state_model._minimise_setup_rdcs');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#_minimise_setup_rdcs">_minimise_setup_rdcs</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model._minimise_setup_rdcs-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model._minimise_setup_rdcs-expanded"><a name="L488"></a><tt class="py-lineno"> 488</tt>  <tt class="py-line">        <tt class="py-docstring">"""Set up the data structures for optimisation using RDCs as base data sets.</tt> </tt>
<a name="L489"></a><tt class="py-lineno"> 489</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L490"></a><tt class="py-lineno"> 490</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword sim_index: The index of the simulation to optimise.  This should be None if normal optimisation is desired.</tt> </tt>
<a name="L491"></a><tt class="py-lineno"> 491</tt>  <tt class="py-line"><tt class="py-docstring">        @type sim_index:    None or int</tt> </tt>
<a name="L492"></a><tt class="py-lineno"> 492</tt>  <tt class="py-line"><tt class="py-docstring">        @return:            The assembled data structures for using RDCs as the base data for optimisation.  These include:</tt> </tt>
<a name="L493"></a><tt class="py-lineno"> 493</tt>  <tt class="py-line"><tt class="py-docstring">                                - rdc, the RDC values.</tt> </tt>
<a name="L494"></a><tt class="py-lineno"> 494</tt>  <tt class="py-line"><tt class="py-docstring">                                - rdc_err, the RDC errors.</tt> </tt>
<a name="L495"></a><tt class="py-lineno"> 495</tt>  <tt class="py-line"><tt class="py-docstring">                                - rdc_weight, the RDC weights.</tt> </tt>
<a name="L496"></a><tt class="py-lineno"> 496</tt>  <tt class="py-line"><tt class="py-docstring">                                - vectors, the interatomic vectors.</tt> </tt>
<a name="L497"></a><tt class="py-lineno"> 497</tt>  <tt class="py-line"><tt class="py-docstring">                                - rdc_const, the dipolar constants.</tt> </tt>
<a name="L498"></a><tt class="py-lineno"> 498</tt>  <tt class="py-line"><tt class="py-docstring">                                - absolute, the absolute value flags (as 1's and 0's).</tt> </tt>
<a name="L499"></a><tt class="py-lineno"> 499</tt>  <tt class="py-line"><tt class="py-docstring">                                - T_flags, the flags for T = J+D type data (as 1's and 0's).</tt> </tt>
<a name="L500"></a><tt class="py-lineno"> 500</tt>  <tt class="py-line"><tt class="py-docstring">                                - j_couplings, the J coupling values if the RDC data type is set to T = J+D.</tt> </tt>
<a name="L501"></a><tt class="py-lineno"> 501</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:             tuple of (numpy rank-2 array, numpy rank-2 array, numpy rank-2 array, numpy rank-3 array, numpy rank-2 array, numpy rank-2 array)</tt> </tt>
<a name="L502"></a><tt class="py-lineno"> 502</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L503"></a><tt class="py-lineno"> 503</tt>  <tt class="py-line"> </tt>
<a name="L504"></a><tt class="py-lineno"> 504</tt>  <tt class="py-line">        <tt class="py-comment"># Initialise.</tt> </tt>
<a name="L505"></a><tt class="py-lineno"> 505</tt>  <tt class="py-line">        <tt id="link-280" class="py-name"><a title="lib.alignment.rdc
pipe_control.rdc
test_suite.system_tests.rdc
user_functions.rdc" class="py-name" href="#" onclick="return doclink('link-280', 'rdc', 'link-58');">rdc</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L506"></a><tt class="py-lineno"> 506</tt>  <tt class="py-line">        <tt class="py-name">rdc_err</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L507"></a><tt class="py-lineno"> 507</tt>  <tt class="py-line">        <tt class="py-name">rdc_weight</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L508"></a><tt class="py-lineno"> 508</tt>  <tt class="py-line">        <tt class="py-name">unit_vect</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L509"></a><tt class="py-lineno"> 509</tt>  <tt class="py-line">        <tt class="py-name">rdc_const</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L510"></a><tt class="py-lineno"> 510</tt>  <tt class="py-line">        <tt class="py-name">absolute</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L511"></a><tt class="py-lineno"> 511</tt>  <tt class="py-line">        <tt class="py-name">T_flags</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L512"></a><tt class="py-lineno"> 512</tt>  <tt class="py-line">        <tt class="py-name">j_couplings</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L513"></a><tt class="py-lineno"> 513</tt>  <tt class="py-line"> </tt>
<a name="L514"></a><tt class="py-lineno"> 514</tt>  <tt class="py-line">        <tt class="py-comment"># The unit vectors, RDC constants, and J couplings.</tt> </tt>
<a name="L515"></a><tt class="py-lineno"> 515</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-281" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-281', 'interatom', 'link-202');">interatom</a></tt> <tt class="py-keyword">in</tt> <tt id="link-282" class="py-name"><a title="pipe_control.interatomic.interatomic_loop" class="py-name" href="#" onclick="return doclink('link-282', 'interatomic_loop', 'link-61');">interatomic_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L516"></a><tt class="py-lineno"> 516</tt>  <tt class="py-line">            <tt class="py-comment"># Get the spins.</tt> </tt>
<a name="L517"></a><tt class="py-lineno"> 517</tt>  <tt class="py-line">            <tt class="py-name">spin1</tt> <tt class="py-op">=</tt> <tt id="link-283" class="py-name"><a title="pipe_control.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-283', 'return_spin', 'link-64');">return_spin</a></tt><tt class="py-op">(</tt><tt id="link-284" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-284', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">spin_id1</tt><tt class="py-op">)</tt> </tt>
<a name="L518"></a><tt class="py-lineno"> 518</tt>  <tt class="py-line">            <tt class="py-name">spin2</tt> <tt class="py-op">=</tt> <tt id="link-285" class="py-name"><a title="pipe_control.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-285', 'return_spin', 'link-64');">return_spin</a></tt><tt class="py-op">(</tt><tt id="link-286" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-286', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">spin_id2</tt><tt class="py-op">)</tt> </tt>
<a name="L519"></a><tt class="py-lineno"> 519</tt>  <tt class="py-line"> </tt>
<a name="L520"></a><tt class="py-lineno"> 520</tt>  <tt class="py-line">            <tt class="py-comment"># RDC checks.</tt> </tt>
<a name="L521"></a><tt class="py-lineno"> 521</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-287" class="py-name"><a title="specific_analyses.n_state_model.data.check_rdcs" class="py-name" href="#" onclick="return doclink('link-287', 'check_rdcs', 'link-84');">check_rdcs</a></tt><tt class="py-op">(</tt><tt id="link-288" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-288', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">,</tt> <tt class="py-name">spin1</tt><tt class="py-op">,</tt> <tt class="py-name">spin2</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L522"></a><tt class="py-lineno"> 522</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L523"></a><tt class="py-lineno"> 523</tt>  <tt class="py-line"> </tt>
<a name="L524"></a><tt class="py-lineno"> 524</tt>  <tt class="py-line">            <tt class="py-comment"># Add the vectors.</tt> </tt>
<a name="L525"></a><tt class="py-lineno"> 525</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-289" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-289', 'lib', 'link-9');">lib</a></tt><tt class="py-op">.</tt><tt id="link-290" class="py-name"><a title="lib.arg_check" class="py-name" href="#" onclick="return doclink('link-290', 'arg_check', 'link-10');">arg_check</a></tt><tt class="py-op">.</tt><tt id="link-291" class="py-name" targets="Function lib.arg_check.is_float()=lib.arg_check-module.html#is_float,Function lib.check_types.is_float()=lib.check_types-module.html#is_float"><a title="lib.arg_check.is_float
lib.check_types.is_float" class="py-name" href="#" onclick="return doclink('link-291', 'is_float', 'link-291');">is_float</a></tt><tt class="py-op">(</tt><tt id="link-292" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-292', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">vector</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">raise_error</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L526"></a><tt class="py-lineno"> 526</tt>  <tt class="py-line">                <tt class="py-name">unit_vect</tt><tt class="py-op">.</tt><tt id="link-293" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-293', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt id="link-294" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-294', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">vector</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L527"></a><tt class="py-lineno"> 527</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L528"></a><tt class="py-lineno"> 528</tt>  <tt class="py-line">                <tt class="py-name">unit_vect</tt><tt class="py-op">.</tt><tt id="link-295" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-295', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt id="link-296" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-296', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">vector</tt><tt class="py-op">)</tt> </tt>
<a name="L529"></a><tt class="py-lineno"> 529</tt>  <tt class="py-line"> </tt>
<a name="L530"></a><tt class="py-lineno"> 530</tt>  <tt class="py-line">            <tt class="py-comment"># Gyromagnetic ratios.</tt> </tt>
<a name="L531"></a><tt class="py-lineno"> 531</tt>  <tt class="py-line">            <tt class="py-name">g1</tt> <tt class="py-op">=</tt> <tt id="link-297" class="py-name"><a title="lib.physical_constants.return_gyromagnetic_ratio" class="py-name" href="#" onclick="return doclink('link-297', 'return_gyromagnetic_ratio', 'link-35');">return_gyromagnetic_ratio</a></tt><tt class="py-op">(</tt><tt class="py-name">spin1</tt><tt class="py-op">.</tt><tt class="py-name">isotope</tt><tt class="py-op">)</tt> </tt>
<a name="L532"></a><tt class="py-lineno"> 532</tt>  <tt class="py-line">            <tt class="py-name">g2</tt> <tt class="py-op">=</tt> <tt id="link-298" class="py-name"><a title="lib.physical_constants.return_gyromagnetic_ratio" class="py-name" href="#" onclick="return doclink('link-298', 'return_gyromagnetic_ratio', 'link-35');">return_gyromagnetic_ratio</a></tt><tt class="py-op">(</tt><tt class="py-name">spin2</tt><tt class="py-op">.</tt><tt class="py-name">isotope</tt><tt class="py-op">)</tt> </tt>
<a name="L533"></a><tt class="py-lineno"> 533</tt>  <tt class="py-line"> </tt>
<a name="L534"></a><tt class="py-lineno"> 534</tt>  <tt class="py-line">            <tt class="py-comment"># Calculate the RDC dipolar constant (in Hertz, and the 3 comes from the alignment tensor), and append it to the list.</tt> </tt>
<a name="L535"></a><tt class="py-lineno"> 535</tt>  <tt class="py-line">            <tt class="py-name">rdc_const</tt><tt class="py-op">.</tt><tt id="link-299" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-299', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-number">3.0</tt><tt class="py-op">/</tt><tt class="py-op">(</tt><tt class="py-number">2.0</tt><tt class="py-op">*</tt><tt class="py-name">pi</tt><tt class="py-op">)</tt> <tt class="py-op">*</tt> <tt id="link-300" class="py-name"><a title="lib.physical_constants.dipolar_constant" class="py-name" href="#" onclick="return doclink('link-300', 'dipolar_constant', 'link-33');">dipolar_constant</a></tt><tt class="py-op">(</tt><tt class="py-name">g1</tt><tt class="py-op">,</tt> <tt class="py-name">g2</tt><tt class="py-op">,</tt> <tt id="link-301" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-301', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt id="link-302" class="py-name" targets="Variable lib.text.gui.r=lib.text.gui-module.html#r"><a title="lib.text.gui.r" class="py-name" href="#" onclick="return doclink('link-302', 'r', 'link-302');">r</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L536"></a><tt class="py-lineno"> 536</tt>  <tt class="py-line"> </tt>
<a name="L537"></a><tt class="py-lineno"> 537</tt>  <tt class="py-line">            <tt class="py-comment"># Store the J coupling.</tt> </tt>
<a name="L538"></a><tt class="py-lineno"> 538</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-303" class="py-name"><a title="specific_analyses.n_state_model.data.opt_uses_j_couplings" class="py-name" href="#" onclick="return doclink('link-303', 'opt_uses_j_couplings', 'link-88');">opt_uses_j_couplings</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L539"></a><tt class="py-lineno"> 539</tt>  <tt class="py-line">                <tt class="py-name">j_couplings</tt><tt class="py-op">.</tt><tt id="link-304" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-304', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt id="link-305" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-305', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt id="link-306" class="py-name" targets="Module pipe_control.j_coupling=pipe_control.j_coupling-module.html,Module user_functions.j_coupling=user_functions.j_coupling-module.html"><a title="pipe_control.j_coupling
user_functions.j_coupling" class="py-name" href="#" onclick="return doclink('link-306', 'j_coupling', 'link-306');">j_coupling</a></tt><tt class="py-op">)</tt> </tt>
<a name="L540"></a><tt class="py-lineno"> 540</tt>  <tt class="py-line"> </tt>
<a name="L541"></a><tt class="py-lineno"> 541</tt>  <tt class="py-line">        <tt class="py-comment"># Fix the unit vector data structure.</tt> </tt>
<a name="L542"></a><tt class="py-lineno"> 542</tt>  <tt class="py-line">        <tt class="py-name">num</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L543"></a><tt class="py-lineno"> 543</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">rdc_index</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">unit_vect</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L544"></a><tt class="py-lineno"> 544</tt>  <tt class="py-line">            <tt class="py-comment"># Number of vectors.</tt> </tt>
<a name="L545"></a><tt class="py-lineno"> 545</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">num</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L546"></a><tt class="py-lineno"> 546</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">unit_vect</tt><tt class="py-op">[</tt><tt class="py-name">rdc_index</tt><tt class="py-op">]</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L547"></a><tt class="py-lineno"> 547</tt>  <tt class="py-line">                    <tt class="py-name">num</tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">unit_vect</tt><tt class="py-op">[</tt><tt class="py-name">rdc_index</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L548"></a><tt class="py-lineno"> 548</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L549"></a><tt class="py-lineno"> 549</tt>  <tt class="py-line"> </tt>
<a name="L550"></a><tt class="py-lineno"> 550</tt>  <tt class="py-line">            <tt class="py-comment"># Check.</tt> </tt>
<a name="L551"></a><tt class="py-lineno"> 551</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">unit_vect</tt><tt class="py-op">[</tt><tt class="py-name">rdc_index</tt><tt class="py-op">]</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt> <tt class="py-keyword">and</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">unit_vect</tt><tt class="py-op">[</tt><tt class="py-name">rdc_index</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> <tt class="py-op">!=</tt> <tt class="py-name">num</tt><tt class="py-op">:</tt> </tt>
<a name="L552"></a><tt class="py-lineno"> 552</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-307" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-307', 'RelaxError', 'link-13');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The number of interatomic vectors for all no match:\n%s"</tt> <tt class="py-op">%</tt> <tt class="py-name">unit_vect</tt><tt class="py-op">)</tt> </tt>
<a name="L553"></a><tt class="py-lineno"> 553</tt>  <tt class="py-line"> </tt>
<a name="L554"></a><tt class="py-lineno"> 554</tt>  <tt class="py-line">        <tt class="py-comment"># Missing unit vectors.</tt> </tt>
<a name="L555"></a><tt class="py-lineno"> 555</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">num</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L556"></a><tt class="py-lineno"> 556</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-308" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-308', 'RelaxError', 'link-13');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"No interatomic vectors could be found."</tt><tt class="py-op">)</tt> </tt>
<a name="L557"></a><tt class="py-lineno"> 557</tt>  <tt class="py-line"> </tt>
<a name="L558"></a><tt class="py-lineno"> 558</tt>  <tt class="py-line">        <tt class="py-comment"># Update None entries.</tt> </tt>
<a name="L559"></a><tt class="py-lineno"> 559</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-309" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-309', 'i', 'link-189');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">unit_vect</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L560"></a><tt class="py-lineno"> 560</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">unit_vect</tt><tt class="py-op">[</tt><tt id="link-310" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-310', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L561"></a><tt class="py-lineno"> 561</tt>  <tt class="py-line">                <tt class="py-name">unit_vect</tt><tt class="py-op">[</tt><tt id="link-311" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-311', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">[</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">]</tt><tt class="py-op">]</tt><tt class="py-op">*</tt><tt class="py-name">num</tt> </tt>
<a name="L562"></a><tt class="py-lineno"> 562</tt>  <tt class="py-line"> </tt>
<a name="L563"></a><tt class="py-lineno"> 563</tt>  <tt class="py-line">        <tt class="py-comment"># The RDC data.</tt> </tt>
<a name="L564"></a><tt class="py-lineno"> 564</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-312" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-312', 'i', 'link-189');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L565"></a><tt class="py-lineno"> 565</tt>  <tt class="py-line">            <tt class="py-comment"># Alias the ID.</tt> </tt>
<a name="L566"></a><tt class="py-lineno"> 566</tt>  <tt class="py-line">            <tt class="py-name">align_id</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt><tt class="py-op">[</tt><tt id="link-313" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-313', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt> </tt>
<a name="L567"></a><tt class="py-lineno"> 567</tt>  <tt class="py-line"> </tt>
<a name="L568"></a><tt class="py-lineno"> 568</tt>  <tt class="py-line">            <tt class="py-comment"># Skip non-optimised data.</tt> </tt>
<a name="L569"></a><tt class="py-lineno"> 569</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-314" class="py-name"><a title="specific_analyses.n_state_model.data.opt_uses_align_data" class="py-name" href="#" onclick="return doclink('link-314', 'opt_uses_align_data', 'link-87');">opt_uses_align_data</a></tt><tt class="py-op">(</tt><tt class="py-name">align_id</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L570"></a><tt class="py-lineno"> 570</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L571"></a><tt class="py-lineno"> 571</tt>  <tt class="py-line"> </tt>
<a name="L572"></a><tt class="py-lineno"> 572</tt>  <tt class="py-line">            <tt class="py-comment"># Append empty arrays to the RDC structures.</tt> </tt>
<a name="L573"></a><tt class="py-lineno"> 573</tt>  <tt class="py-line">            <tt id="link-315" class="py-name"><a title="lib.alignment.rdc
pipe_control.rdc
test_suite.system_tests.rdc
user_functions.rdc" class="py-name" href="#" onclick="return doclink('link-315', 'rdc', 'link-58');">rdc</a></tt><tt class="py-op">.</tt><tt id="link-316" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-316', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L574"></a><tt class="py-lineno"> 574</tt>  <tt class="py-line">            <tt class="py-name">rdc_err</tt><tt class="py-op">.</tt><tt id="link-317" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-317', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L575"></a><tt class="py-lineno"> 575</tt>  <tt class="py-line">            <tt class="py-name">rdc_weight</tt><tt class="py-op">.</tt><tt id="link-318" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-318', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L576"></a><tt class="py-lineno"> 576</tt>  <tt class="py-line">            <tt class="py-name">absolute</tt><tt class="py-op">.</tt><tt id="link-319" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-319', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L577"></a><tt class="py-lineno"> 577</tt>  <tt class="py-line">            <tt class="py-name">T_flags</tt><tt class="py-op">.</tt><tt id="link-320" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-320', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L578"></a><tt class="py-lineno"> 578</tt>  <tt class="py-line"> </tt>
<a name="L579"></a><tt class="py-lineno"> 579</tt>  <tt class="py-line">            <tt class="py-comment"># Interatom loop.</tt> </tt>
<a name="L580"></a><tt class="py-lineno"> 580</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-321" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-321', 'interatom', 'link-202');">interatom</a></tt> <tt class="py-keyword">in</tt> <tt id="link-322" class="py-name"><a title="pipe_control.interatomic.interatomic_loop" class="py-name" href="#" onclick="return doclink('link-322', 'interatomic_loop', 'link-61');">interatomic_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L581"></a><tt class="py-lineno"> 581</tt>  <tt class="py-line">                <tt class="py-comment"># Get the spins.</tt> </tt>
<a name="L582"></a><tt class="py-lineno"> 582</tt>  <tt class="py-line">                <tt class="py-name">spin1</tt> <tt class="py-op">=</tt> <tt id="link-323" class="py-name"><a title="pipe_control.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-323', 'return_spin', 'link-64');">return_spin</a></tt><tt class="py-op">(</tt><tt id="link-324" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-324', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">spin_id1</tt><tt class="py-op">)</tt> </tt>
<a name="L583"></a><tt class="py-lineno"> 583</tt>  <tt class="py-line">                <tt class="py-name">spin2</tt> <tt class="py-op">=</tt> <tt id="link-325" class="py-name"><a title="pipe_control.mol_res_spin.return_spin" class="py-name" href="#" onclick="return doclink('link-325', 'return_spin', 'link-64');">return_spin</a></tt><tt class="py-op">(</tt><tt id="link-326" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-326', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">spin_id2</tt><tt class="py-op">)</tt> </tt>
<a name="L584"></a><tt class="py-lineno"> 584</tt>  <tt class="py-line"> </tt>
<a name="L585"></a><tt class="py-lineno"> 585</tt>  <tt class="py-line">                <tt class="py-comment"># Skip deselected spins.</tt> </tt>
<a name="L586"></a><tt class="py-lineno"> 586</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">spin1</tt><tt class="py-op">.</tt><tt id="link-327" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-327', 'select', 'link-196');">select</a></tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">spin2</tt><tt class="py-op">.</tt><tt id="link-328" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-328', 'select', 'link-196');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L587"></a><tt class="py-lineno"> 587</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L588"></a><tt class="py-lineno"> 588</tt>  <tt class="py-line"> </tt>
<a name="L589"></a><tt class="py-lineno"> 589</tt>  <tt class="py-line">                <tt class="py-comment"># Only use interatomic data containers with RDC and vector data.</tt> </tt>
<a name="L590"></a><tt class="py-lineno"> 590</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-329" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-329', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">,</tt> <tt class="py-string">'rdc'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-330" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-330', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">,</tt> <tt class="py-string">'vector'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L591"></a><tt class="py-lineno"> 591</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L592"></a><tt class="py-lineno"> 592</tt>  <tt class="py-line"> </tt>
<a name="L593"></a><tt class="py-lineno"> 593</tt>  <tt class="py-line">                <tt class="py-comment"># T-type data.</tt> </tt>
<a name="L594"></a><tt class="py-lineno"> 594</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt id="link-331" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-331', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_data_types</tt> <tt class="py-keyword">and</tt> <tt id="link-332" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-332', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_data_types</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'T'</tt><tt class="py-op">:</tt> </tt>
<a name="L595"></a><tt class="py-lineno"> 595</tt>  <tt class="py-line">                    <tt class="py-name">T_flags</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-333" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-333', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L596"></a><tt class="py-lineno"> 596</tt>  <tt class="py-line">                <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L597"></a><tt class="py-lineno"> 597</tt>  <tt class="py-line">                    <tt class="py-name">T_flags</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-334" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-334', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">False</tt><tt class="py-op">)</tt> </tt>
<a name="L598"></a><tt class="py-lineno"> 598</tt>  <tt class="py-line"> </tt>
<a name="L599"></a><tt class="py-lineno"> 599</tt>  <tt class="py-line">                <tt class="py-comment"># Check for J couplings if the RDC data type is T = J+D.</tt> </tt>
<a name="L600"></a><tt class="py-lineno"> 600</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">T_flags</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-335" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-335', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">,</tt> <tt class="py-string">'j_coupling'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L601"></a><tt class="py-lineno"> 601</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L602"></a><tt class="py-lineno"> 602</tt>  <tt class="py-line"> </tt>
<a name="L603"></a><tt class="py-lineno"> 603</tt>  <tt class="py-line">                <tt class="py-comment"># Defaults of None.</tt> </tt>
<a name="L604"></a><tt class="py-lineno"> 604</tt>  <tt class="py-line">                <tt id="link-336" class="py-name" targets="Module gui.input_elements.value=gui.input_elements.value-module.html,Module pipe_control.value=pipe_control.value-module.html,Module test_suite.system_tests.value=test_suite.system_tests.value-module.html,Module user_functions.value=user_functions.value-module.html"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-336', 'value', 'link-336');">value</a></tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L605"></a><tt class="py-lineno"> 605</tt>  <tt class="py-line">                <tt id="link-337" class="py-name" targets="Method relax.RelaxParser.error()=relax.RelaxParser-class.html#error"><a title="relax.RelaxParser.error" class="py-name" href="#" onclick="return doclink('link-337', 'error', 'link-337');">error</a></tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L606"></a><tt class="py-lineno"> 606</tt>  <tt class="py-line"> </tt>
<a name="L607"></a><tt class="py-lineno"> 607</tt>  <tt class="py-line">                <tt class="py-comment"># Pseudo-atom set up.</tt> </tt>
<a name="L608"></a><tt class="py-lineno"> 608</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-op">(</tt><tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">spin1</tt><tt class="py-op">,</tt> <tt class="py-string">'members'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">spin2</tt><tt class="py-op">,</tt> <tt class="py-string">'members'</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt id="link-338" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-338', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt id="link-339" class="py-name"><a title="lib.alignment.rdc
pipe_control.rdc
test_suite.system_tests.rdc
user_functions.rdc" class="py-name" href="#" onclick="return doclink('link-339', 'rdc', 'link-58');">rdc</a></tt><tt class="py-op">.</tt><tt class="py-name">keys</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L609"></a><tt class="py-lineno"> 609</tt>  <tt class="py-line">                    <tt class="py-comment"># Skip non-Me groups.</tt> </tt>
<a name="L610"></a><tt class="py-lineno"> 610</tt>  <tt class="py-line">                    <tt class="py-keyword">if</tt> <tt class="py-op">(</tt><tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">spin1</tt><tt class="py-op">,</tt> <tt class="py-string">'members'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">spin1</tt><tt class="py-op">.</tt><tt class="py-name">members</tt><tt class="py-op">)</tt> <tt class="py-op">!=</tt> <tt class="py-number">3</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-op">(</tt><tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">spin2</tt><tt class="py-op">,</tt> <tt class="py-string">'members'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">spin2</tt><tt class="py-op">.</tt><tt class="py-name">members</tt><tt class="py-op">)</tt> <tt class="py-op">!=</tt> <tt class="py-number">3</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L611"></a><tt class="py-lineno"> 611</tt>  <tt class="py-line">                        <tt class="py-keyword">continue</tt> </tt>
<a name="L612"></a><tt class="py-lineno"> 612</tt>  <tt class="py-line"> </tt>
<a name="L613"></a><tt class="py-lineno"> 613</tt>  <tt class="py-line">                    <tt class="py-comment"># The RDC for the Me-pseudo spin where:</tt> </tt>
<a name="L614"></a><tt class="py-lineno"> 614</tt>  <tt class="py-line">                    <tt class="py-comment">#     &lt;D&gt; = -1/3 Dpar.</tt> </tt>
<a name="L615"></a><tt class="py-lineno"> 615</tt>  <tt class="py-line">                    <tt class="py-comment"># See Verdier, et al., JMR, 2003, 163, 353-359.</tt> </tt>
<a name="L616"></a><tt class="py-lineno"> 616</tt>  <tt class="py-line">                    <tt class="py-keyword">if</tt> <tt class="py-name">sim_index</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L617"></a><tt class="py-lineno"> 617</tt>  <tt class="py-line">                        <tt id="link-340" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-340', 'value', 'link-336');">value</a></tt> <tt class="py-op">=</tt> <tt class="py-op">-</tt><tt class="py-number">3.0</tt> <tt class="py-op">*</tt> <tt id="link-341" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-341', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_sim</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-name">sim_index</tt><tt class="py-op">]</tt> </tt>
<a name="L618"></a><tt class="py-lineno"> 618</tt>  <tt class="py-line">                    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L619"></a><tt class="py-lineno"> 619</tt>  <tt class="py-line">                        <tt id="link-342" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-342', 'value', 'link-336');">value</a></tt> <tt class="py-op">=</tt> <tt class="py-op">-</tt><tt class="py-number">3.0</tt> <tt class="py-op">*</tt> <tt id="link-343" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-343', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt id="link-344" class="py-name"><a title="lib.alignment.rdc
pipe_control.rdc
test_suite.system_tests.rdc
user_functions.rdc" class="py-name" href="#" onclick="return doclink('link-344', 'rdc', 'link-58');">rdc</a></tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt> </tt>
<a name="L620"></a><tt class="py-lineno"> 620</tt>  <tt class="py-line"> </tt>
<a name="L621"></a><tt class="py-lineno"> 621</tt>  <tt class="py-line">                    <tt class="py-comment"># The error.</tt> </tt>
<a name="L622"></a><tt class="py-lineno"> 622</tt>  <tt class="py-line">                    <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-345" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-345', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">,</tt> <tt class="py-string">'rdc_err'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt id="link-346" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-346', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_err</tt><tt class="py-op">.</tt><tt class="py-name">keys</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L623"></a><tt class="py-lineno"> 623</tt>  <tt class="py-line">                        <tt class="py-comment"># T values.</tt> </tt>
<a name="L624"></a><tt class="py-lineno"> 624</tt>  <tt class="py-line">                        <tt class="py-keyword">if</tt> <tt class="py-name">T_flags</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L625"></a><tt class="py-lineno"> 625</tt>  <tt class="py-line">                            <tt id="link-347" class="py-name"><a title="relax.RelaxParser.error" class="py-name" href="#" onclick="return doclink('link-347', 'error', 'link-337');">error</a></tt> <tt class="py-op">=</tt> <tt class="py-op">-</tt><tt class="py-number">3.0</tt> <tt class="py-op">*</tt> <tt class="py-name">sqrt</tt><tt class="py-op">(</tt><tt id="link-348" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-348', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_err</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt><tt class="py-op">**</tt><tt class="py-number">2</tt> <tt class="py-op">+</tt> <tt id="link-349" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-349', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">j_coupling_err</tt><tt class="py-op">**</tt><tt class="py-number">2</tt><tt class="py-op">)</tt> </tt>
<a name="L626"></a><tt class="py-lineno"> 626</tt>  <tt class="py-line"> </tt>
<a name="L627"></a><tt class="py-lineno"> 627</tt>  <tt class="py-line">                        <tt class="py-comment"># D values.</tt> </tt>
<a name="L628"></a><tt class="py-lineno"> 628</tt>  <tt class="py-line">                        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L629"></a><tt class="py-lineno"> 629</tt>  <tt class="py-line">                            <tt id="link-350" class="py-name"><a title="relax.RelaxParser.error" class="py-name" href="#" onclick="return doclink('link-350', 'error', 'link-337');">error</a></tt> <tt class="py-op">=</tt> <tt class="py-op">-</tt><tt class="py-number">3.0</tt> <tt class="py-op">*</tt> <tt id="link-351" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-351', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_err</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt> </tt>
<a name="L630"></a><tt class="py-lineno"> 630</tt>  <tt class="py-line"> </tt>
<a name="L631"></a><tt class="py-lineno"> 631</tt>  <tt class="py-line">                <tt class="py-comment"># Normal set up.</tt> </tt>
<a name="L632"></a><tt class="py-lineno"> 632</tt>  <tt class="py-line">                <tt class="py-keyword">elif</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt id="link-352" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-352', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt id="link-353" class="py-name"><a title="lib.alignment.rdc
pipe_control.rdc
test_suite.system_tests.rdc
user_functions.rdc" class="py-name" href="#" onclick="return doclink('link-353', 'rdc', 'link-58');">rdc</a></tt><tt class="py-op">.</tt><tt class="py-name">keys</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L633"></a><tt class="py-lineno"> 633</tt>  <tt class="py-line">                    <tt class="py-comment"># The RDC.</tt> </tt>
<a name="L634"></a><tt class="py-lineno"> 634</tt>  <tt class="py-line">                    <tt class="py-keyword">if</tt> <tt class="py-name">sim_index</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L635"></a><tt class="py-lineno"> 635</tt>  <tt class="py-line">                        <tt id="link-354" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-354', 'value', 'link-336');">value</a></tt> <tt class="py-op">=</tt> <tt id="link-355" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-355', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_sim</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-name">sim_index</tt><tt class="py-op">]</tt> </tt>
<a name="L636"></a><tt class="py-lineno"> 636</tt>  <tt class="py-line">                    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L637"></a><tt class="py-lineno"> 637</tt>  <tt class="py-line">                        <tt id="link-356" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-356', 'value', 'link-336');">value</a></tt> <tt class="py-op">=</tt> <tt id="link-357" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-357', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt id="link-358" class="py-name"><a title="lib.alignment.rdc
pipe_control.rdc
test_suite.system_tests.rdc
user_functions.rdc" class="py-name" href="#" onclick="return doclink('link-358', 'rdc', 'link-58');">rdc</a></tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt> </tt>
<a name="L638"></a><tt class="py-lineno"> 638</tt>  <tt class="py-line"> </tt>
<a name="L639"></a><tt class="py-lineno"> 639</tt>  <tt class="py-line">                    <tt class="py-comment"># The error.</tt> </tt>
<a name="L640"></a><tt class="py-lineno"> 640</tt>  <tt class="py-line">                    <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-359" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-359', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">,</tt> <tt class="py-string">'rdc_err'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt id="link-360" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-360', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_err</tt><tt class="py-op">.</tt><tt class="py-name">keys</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L641"></a><tt class="py-lineno"> 641</tt>  <tt class="py-line">                        <tt class="py-comment"># T values.</tt> </tt>
<a name="L642"></a><tt class="py-lineno"> 642</tt>  <tt class="py-line">                        <tt class="py-keyword">if</tt> <tt class="py-name">T_flags</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L643"></a><tt class="py-lineno"> 643</tt>  <tt class="py-line">                            <tt id="link-361" class="py-name"><a title="relax.RelaxParser.error" class="py-name" href="#" onclick="return doclink('link-361', 'error', 'link-337');">error</a></tt> <tt class="py-op">=</tt> <tt class="py-name">sqrt</tt><tt class="py-op">(</tt><tt id="link-362" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-362', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_err</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt><tt class="py-op">**</tt><tt class="py-number">2</tt> <tt class="py-op">+</tt> <tt id="link-363" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-363', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">j_coupling_err</tt><tt class="py-op">**</tt><tt class="py-number">2</tt><tt class="py-op">)</tt> </tt>
<a name="L644"></a><tt class="py-lineno"> 644</tt>  <tt class="py-line"> </tt>
<a name="L645"></a><tt class="py-lineno"> 645</tt>  <tt class="py-line">                        <tt class="py-comment"># D values.</tt> </tt>
<a name="L646"></a><tt class="py-lineno"> 646</tt>  <tt class="py-line">                        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L647"></a><tt class="py-lineno"> 647</tt>  <tt class="py-line">                            <tt id="link-364" class="py-name"><a title="relax.RelaxParser.error" class="py-name" href="#" onclick="return doclink('link-364', 'error', 'link-337');">error</a></tt> <tt class="py-op">=</tt> <tt id="link-365" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-365', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_err</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt> </tt>
<a name="L648"></a><tt class="py-lineno"> 648</tt>  <tt class="py-line"> </tt>
<a name="L649"></a><tt class="py-lineno"> 649</tt>  <tt class="py-line">                <tt class="py-comment"># Append the RDCs to the list.</tt> </tt>
<a name="L650"></a><tt class="py-lineno"> 650</tt>  <tt class="py-line">                <tt id="link-366" class="py-name"><a title="lib.alignment.rdc
pipe_control.rdc
test_suite.system_tests.rdc
user_functions.rdc" class="py-name" href="#" onclick="return doclink('link-366', 'rdc', 'link-58');">rdc</a></tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-367" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-367', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt id="link-368" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-368', 'value', 'link-336');">value</a></tt><tt class="py-op">)</tt> </tt>
<a name="L651"></a><tt class="py-lineno"> 651</tt>  <tt class="py-line"> </tt>
<a name="L652"></a><tt class="py-lineno"> 652</tt>  <tt class="py-line">                <tt class="py-comment"># Append the RDC errors.</tt> </tt>
<a name="L653"></a><tt class="py-lineno"> 653</tt>  <tt class="py-line">                <tt class="py-name">rdc_err</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-369" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-369', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt id="link-370" class="py-name"><a title="relax.RelaxParser.error" class="py-name" href="#" onclick="return doclink('link-370', 'error', 'link-337');">error</a></tt><tt class="py-op">)</tt> </tt>
<a name="L654"></a><tt class="py-lineno"> 654</tt>  <tt class="py-line"> </tt>
<a name="L655"></a><tt class="py-lineno"> 655</tt>  <tt class="py-line">                <tt class="py-comment"># Append the weight.</tt> </tt>
<a name="L656"></a><tt class="py-lineno"> 656</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-371" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-371', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">,</tt> <tt class="py-string">'rdc_weight'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt id="link-372" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-372', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_weight</tt><tt class="py-op">.</tt><tt class="py-name">keys</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L657"></a><tt class="py-lineno"> 657</tt>  <tt class="py-line">                    <tt class="py-name">rdc_weight</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-373" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-373', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt id="link-374" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-374', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_weight</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L658"></a><tt class="py-lineno"> 658</tt>  <tt class="py-line">                <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L659"></a><tt class="py-lineno"> 659</tt>  <tt class="py-line">                    <tt class="py-name">rdc_weight</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-375" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-375', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-number">1.0</tt><tt class="py-op">)</tt> </tt>
<a name="L660"></a><tt class="py-lineno"> 660</tt>  <tt class="py-line"> </tt>
<a name="L661"></a><tt class="py-lineno"> 661</tt>  <tt class="py-line">                <tt class="py-comment"># Append the absolute value flag.</tt> </tt>
<a name="L662"></a><tt class="py-lineno"> 662</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-376" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-376', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">,</tt> <tt class="py-string">'absolute_rdc'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">in</tt> <tt id="link-377" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-377', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">absolute_rdc</tt><tt class="py-op">.</tt><tt class="py-name">keys</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L663"></a><tt class="py-lineno"> 663</tt>  <tt class="py-line">                    <tt class="py-name">absolute</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-378" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-378', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt id="link-379" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-379', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt class="py-name">absolute_rdc</tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L664"></a><tt class="py-lineno"> 664</tt>  <tt class="py-line">                <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L665"></a><tt class="py-lineno"> 665</tt>  <tt class="py-line">                    <tt class="py-name">absolute</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-380" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-380', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">False</tt><tt class="py-op">)</tt> </tt>
<a name="L666"></a><tt class="py-lineno"> 666</tt>  <tt class="py-line"> </tt>
<a name="L667"></a><tt class="py-lineno"> 667</tt>  <tt class="py-line">        <tt class="py-comment"># Convert to numpy objects.</tt> </tt>
<a name="L668"></a><tt class="py-lineno"> 668</tt>  <tt class="py-line">        <tt id="link-381" class="py-name"><a title="lib.alignment.rdc
pipe_control.rdc
test_suite.system_tests.rdc
user_functions.rdc" class="py-name" href="#" onclick="return doclink('link-381', 'rdc', 'link-58');">rdc</a></tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt id="link-382" class="py-name"><a title="lib.alignment.rdc
pipe_control.rdc
test_suite.system_tests.rdc
user_functions.rdc" class="py-name" href="#" onclick="return doclink('link-382', 'rdc', 'link-58');">rdc</a></tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L669"></a><tt class="py-lineno"> 669</tt>  <tt class="py-line">        <tt class="py-name">rdc_err</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">rdc_err</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L670"></a><tt class="py-lineno"> 670</tt>  <tt class="py-line">        <tt class="py-name">rdc_weight</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">rdc_weight</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L671"></a><tt class="py-lineno"> 671</tt>  <tt class="py-line">        <tt class="py-name">unit_vect</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">unit_vect</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L672"></a><tt class="py-lineno"> 672</tt>  <tt class="py-line">        <tt class="py-name">rdc_const</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">rdc_const</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L673"></a><tt class="py-lineno"> 673</tt>  <tt class="py-line">        <tt class="py-name">absolute</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">absolute</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L674"></a><tt class="py-lineno"> 674</tt>  <tt class="py-line">        <tt class="py-name">T_flags</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">T_flags</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L675"></a><tt class="py-lineno"> 675</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-383" class="py-name"><a title="specific_analyses.n_state_model.data.opt_uses_j_couplings" class="py-name" href="#" onclick="return doclink('link-383', 'opt_uses_j_couplings', 'link-88');">opt_uses_j_couplings</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L676"></a><tt class="py-lineno"> 676</tt>  <tt class="py-line">            <tt class="py-name">j_couplings</tt> <tt class="py-op">=</tt> <tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-name">j_couplings</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L677"></a><tt class="py-lineno"> 677</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L678"></a><tt class="py-lineno"> 678</tt>  <tt class="py-line">            <tt class="py-name">j_couplings</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L679"></a><tt class="py-lineno"> 679</tt>  <tt class="py-line"> </tt>
<a name="L680"></a><tt class="py-lineno"> 680</tt>  <tt class="py-line">        <tt class="py-comment"># Return the data structures.</tt> </tt>
<a name="L681"></a><tt class="py-lineno"> 681</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt id="link-384" class="py-name"><a title="lib.alignment.rdc
pipe_control.rdc
test_suite.system_tests.rdc
user_functions.rdc" class="py-name" href="#" onclick="return doclink('link-384', 'rdc', 'link-58');">rdc</a></tt><tt class="py-op">,</tt> <tt class="py-name">rdc_err</tt><tt class="py-op">,</tt> <tt class="py-name">rdc_weight</tt><tt class="py-op">,</tt> <tt class="py-name">unit_vect</tt><tt class="py-op">,</tt> <tt class="py-name">rdc_const</tt><tt class="py-op">,</tt> <tt class="py-name">absolute</tt><tt class="py-op">,</tt> <tt class="py-name">T_flags</tt><tt class="py-op">,</tt> <tt class="py-name">j_couplings</tt> </tt>
</div><a name="L682"></a><tt class="py-lineno"> 682</tt>  <tt class="py-line"> </tt>
<a name="L683"></a><tt class="py-lineno"> 683</tt>  <tt class="py-line"> </tt>
<a name="N_state_model._minimise_setup_tensors"></a><div id="N_state_model._minimise_setup_tensors-def"><a name="L684"></a><tt class="py-lineno"> 684</tt> <a class="py-toggle" href="#" id="N_state_model._minimise_setup_tensors-toggle" onclick="return toggle('N_state_model._minimise_setup_tensors');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#_minimise_setup_tensors">_minimise_setup_tensors</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model._minimise_setup_tensors-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model._minimise_setup_tensors-expanded"><a name="L685"></a><tt class="py-lineno"> 685</tt>  <tt class="py-line">        <tt class="py-docstring">"""Set up the data structures for optimisation using alignment tensors as base data sets.</tt> </tt>
<a name="L686"></a><tt class="py-lineno"> 686</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L687"></a><tt class="py-lineno"> 687</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword sim_index: The index of the simulation to optimise.  This should be None if</tt> </tt>
<a name="L688"></a><tt class="py-lineno"> 688</tt>  <tt class="py-line"><tt class="py-docstring">                            normal optimisation is desired.</tt> </tt>
<a name="L689"></a><tt class="py-lineno"> 689</tt>  <tt class="py-line"><tt class="py-docstring">        @type sim_index:    None or int</tt> </tt>
<a name="L690"></a><tt class="py-lineno"> 690</tt>  <tt class="py-line"><tt class="py-docstring">        @return:            The assembled data structures for using alignment tensors as the base</tt> </tt>
<a name="L691"></a><tt class="py-lineno"> 691</tt>  <tt class="py-line"><tt class="py-docstring">                            data for optimisation.  These include:</tt> </tt>
<a name="L692"></a><tt class="py-lineno"> 692</tt>  <tt class="py-line"><tt class="py-docstring">                                - full_tensors, the data of the full alignment tensors.</tt> </tt>
<a name="L693"></a><tt class="py-lineno"> 693</tt>  <tt class="py-line"><tt class="py-docstring">                                - red_tensor_elem, the tensors as concatenated rank-1 5D arrays.</tt> </tt>
<a name="L694"></a><tt class="py-lineno"> 694</tt>  <tt class="py-line"><tt class="py-docstring">                                - red_tensor_err, the tensor errors as concatenated rank-1 5D</tt> </tt>
<a name="L695"></a><tt class="py-lineno"> 695</tt>  <tt class="py-line"><tt class="py-docstring">                                arrays.</tt> </tt>
<a name="L696"></a><tt class="py-lineno"> 696</tt>  <tt class="py-line"><tt class="py-docstring">                                - full_in_ref_frame, flags specifying if the tensor in the reference</tt> </tt>
<a name="L697"></a><tt class="py-lineno"> 697</tt>  <tt class="py-line"><tt class="py-docstring">                                frame is the full or reduced tensor.</tt> </tt>
<a name="L698"></a><tt class="py-lineno"> 698</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:             tuple of (list, numpy rank-1 array, numpy rank-1 array, numpy rank-1</tt> </tt>
<a name="L699"></a><tt class="py-lineno"> 699</tt>  <tt class="py-line"><tt class="py-docstring">                            array)</tt> </tt>
<a name="L700"></a><tt class="py-lineno"> 700</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L701"></a><tt class="py-lineno"> 701</tt>  <tt class="py-line"> </tt>
<a name="L702"></a><tt class="py-lineno"> 702</tt>  <tt class="py-line">        <tt class="py-comment"># Initialise.</tt> </tt>
<a name="L703"></a><tt class="py-lineno"> 703</tt>  <tt class="py-line">        <tt class="py-name">n</tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">.</tt><tt id="link-385" class="py-name" targets="Function pipe_control.align_tensor.reduction()=pipe_control.align_tensor-module.html#reduction"><a title="pipe_control.align_tensor.reduction" class="py-name" href="#" onclick="return doclink('link-385', 'reduction', 'link-385');">reduction</a></tt><tt class="py-op">)</tt> </tt>
<a name="L704"></a><tt class="py-lineno"> 704</tt>  <tt class="py-line">        <tt class="py-name">full_tensors</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">n</tt><tt class="py-op">*</tt><tt class="py-number">5</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L705"></a><tt class="py-lineno"> 705</tt>  <tt class="py-line">        <tt class="py-name">red_tensors</tt>  <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">n</tt><tt class="py-op">*</tt><tt class="py-number">5</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L706"></a><tt class="py-lineno"> 706</tt>  <tt class="py-line">        <tt class="py-name">red_err</tt> <tt class="py-op">=</tt> <tt class="py-name">ones</tt><tt class="py-op">(</tt><tt class="py-name">n</tt><tt class="py-op">*</tt><tt class="py-number">5</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> <tt class="py-op">*</tt> <tt class="py-number">1e-5</tt> </tt>
<a name="L707"></a><tt class="py-lineno"> 707</tt>  <tt class="py-line">        <tt class="py-name">full_in_ref_frame</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">n</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L708"></a><tt class="py-lineno"> 708</tt>  <tt class="py-line"> </tt>
<a name="L709"></a><tt class="py-lineno"> 709</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the full tensors.</tt> </tt>
<a name="L710"></a><tt class="py-lineno"> 710</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-386" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-386', 'i', 'link-189');">i</a></tt><tt class="py-op">,</tt> <tt id="link-387" class="py-name" targets="Module bmrblib.structure.tensor=bmrblib.structure.tensor-module.html"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-387', 'tensor', 'link-387');">tensor</a></tt> <tt class="py-keyword">in</tt> <tt id="link-388" class="py-name"><a title="specific_analyses.n_state_model.data.tensor_loop" class="py-name" href="#" onclick="return doclink('link-388', 'tensor_loop', 'link-89');">tensor_loop</a></tt><tt class="py-op">(</tt><tt class="py-name">red</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L711"></a><tt class="py-lineno"> 711</tt>  <tt class="py-line">            <tt class="py-comment"># The full tensor.</tt> </tt>
<a name="L712"></a><tt class="py-lineno"> 712</tt>  <tt class="py-line">            <tt class="py-name">full_tensors</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt id="link-389" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-389', 'i', 'link-189');">i</a></tt> <tt class="py-op">+</tt> <tt class="py-number">0</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-390" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-390', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Axx</tt> </tt>
<a name="L713"></a><tt class="py-lineno"> 713</tt>  <tt class="py-line">            <tt class="py-name">full_tensors</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt id="link-391" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-391', 'i', 'link-189');">i</a></tt> <tt class="py-op">+</tt> <tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-392" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-392', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Ayy</tt> </tt>
<a name="L714"></a><tt class="py-lineno"> 714</tt>  <tt class="py-line">            <tt class="py-name">full_tensors</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt id="link-393" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-393', 'i', 'link-189');">i</a></tt> <tt class="py-op">+</tt> <tt class="py-number">2</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-394" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-394', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Axy</tt> </tt>
<a name="L715"></a><tt class="py-lineno"> 715</tt>  <tt class="py-line">            <tt class="py-name">full_tensors</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt id="link-395" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-395', 'i', 'link-189');">i</a></tt> <tt class="py-op">+</tt> <tt class="py-number">3</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-396" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-396', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Axz</tt> </tt>
<a name="L716"></a><tt class="py-lineno"> 716</tt>  <tt class="py-line">            <tt class="py-name">full_tensors</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt id="link-397" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-397', 'i', 'link-189');">i</a></tt> <tt class="py-op">+</tt> <tt class="py-number">4</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-398" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-398', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Ayz</tt> </tt>
<a name="L717"></a><tt class="py-lineno"> 717</tt>  <tt class="py-line"> </tt>
<a name="L718"></a><tt class="py-lineno"> 718</tt>  <tt class="py-line">            <tt class="py-comment"># The full tensor corresponds to the frame of reference.</tt> </tt>
<a name="L719"></a><tt class="py-lineno"> 719</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-399" class="py-name" targets="Function specific_analyses.n_state_model.parameters.ref_domain()=specific_analyses.n_state_model.parameters-module.html#ref_domain"><a title="specific_analyses.n_state_model.parameters.ref_domain" class="py-name" href="#" onclick="return doclink('link-399', 'ref_domain', 'link-399');">ref_domain</a></tt> <tt class="py-op">==</tt> <tt id="link-400" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-400', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt id="link-401" class="py-name" targets="Module pipe_control.domain=pipe_control.domain-module.html,Module user_functions.domain=user_functions.domain-module.html"><a title="pipe_control.domain
user_functions.domain" class="py-name" href="#" onclick="return doclink('link-401', 'domain', 'link-401');">domain</a></tt><tt class="py-op">:</tt> </tt>
<a name="L720"></a><tt class="py-lineno"> 720</tt>  <tt class="py-line">                <tt class="py-name">full_in_ref_frame</tt><tt class="py-op">[</tt><tt id="link-402" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-402', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-number">1</tt> </tt>
<a name="L721"></a><tt class="py-lineno"> 721</tt>  <tt class="py-line"> </tt>
<a name="L722"></a><tt class="py-lineno"> 722</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the reduced tensors.</tt> </tt>
<a name="L723"></a><tt class="py-lineno"> 723</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-403" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-403', 'i', 'link-189');">i</a></tt><tt class="py-op">,</tt> <tt id="link-404" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-404', 'tensor', 'link-387');">tensor</a></tt> <tt class="py-keyword">in</tt> <tt id="link-405" class="py-name"><a title="specific_analyses.n_state_model.data.tensor_loop" class="py-name" href="#" onclick="return doclink('link-405', 'tensor_loop', 'link-89');">tensor_loop</a></tt><tt class="py-op">(</tt><tt class="py-name">red</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L724"></a><tt class="py-lineno"> 724</tt>  <tt class="py-line">            <tt class="py-comment"># The reduced tensor (simulation data).</tt> </tt>
<a name="L725"></a><tt class="py-lineno"> 725</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">sim_index</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L726"></a><tt class="py-lineno"> 726</tt>  <tt class="py-line">                <tt class="py-name">red_tensors</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt id="link-406" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-406', 'i', 'link-189');">i</a></tt> <tt class="py-op">+</tt> <tt class="py-number">0</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-407" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-407', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Axx_sim</tt><tt class="py-op">[</tt><tt class="py-name">sim_index</tt><tt class="py-op">]</tt> </tt>
<a name="L727"></a><tt class="py-lineno"> 727</tt>  <tt class="py-line">                <tt class="py-name">red_tensors</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt id="link-408" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-408', 'i', 'link-189');">i</a></tt> <tt class="py-op">+</tt> <tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-409" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-409', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Ayy_sim</tt><tt class="py-op">[</tt><tt class="py-name">sim_index</tt><tt class="py-op">]</tt> </tt>
<a name="L728"></a><tt class="py-lineno"> 728</tt>  <tt class="py-line">                <tt class="py-name">red_tensors</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt id="link-410" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-410', 'i', 'link-189');">i</a></tt> <tt class="py-op">+</tt> <tt class="py-number">2</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-411" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-411', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Axy_sim</tt><tt class="py-op">[</tt><tt class="py-name">sim_index</tt><tt class="py-op">]</tt> </tt>
<a name="L729"></a><tt class="py-lineno"> 729</tt>  <tt class="py-line">                <tt class="py-name">red_tensors</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt id="link-412" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-412', 'i', 'link-189');">i</a></tt> <tt class="py-op">+</tt> <tt class="py-number">3</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-413" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-413', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Axz_sim</tt><tt class="py-op">[</tt><tt class="py-name">sim_index</tt><tt class="py-op">]</tt> </tt>
<a name="L730"></a><tt class="py-lineno"> 730</tt>  <tt class="py-line">                <tt class="py-name">red_tensors</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt id="link-414" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-414', 'i', 'link-189');">i</a></tt> <tt class="py-op">+</tt> <tt class="py-number">4</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-415" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-415', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Ayz_sim</tt><tt class="py-op">[</tt><tt class="py-name">sim_index</tt><tt class="py-op">]</tt> </tt>
<a name="L731"></a><tt class="py-lineno"> 731</tt>  <tt class="py-line"> </tt>
<a name="L732"></a><tt class="py-lineno"> 732</tt>  <tt class="py-line">            <tt class="py-comment"># The reduced tensor.</tt> </tt>
<a name="L733"></a><tt class="py-lineno"> 733</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L734"></a><tt class="py-lineno"> 734</tt>  <tt class="py-line">                <tt class="py-name">red_tensors</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt id="link-416" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-416', 'i', 'link-189');">i</a></tt> <tt class="py-op">+</tt> <tt class="py-number">0</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-417" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-417', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Axx</tt> </tt>
<a name="L735"></a><tt class="py-lineno"> 735</tt>  <tt class="py-line">                <tt class="py-name">red_tensors</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt id="link-418" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-418', 'i', 'link-189');">i</a></tt> <tt class="py-op">+</tt> <tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-419" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-419', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Ayy</tt> </tt>
<a name="L736"></a><tt class="py-lineno"> 736</tt>  <tt class="py-line">                <tt class="py-name">red_tensors</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt id="link-420" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-420', 'i', 'link-189');">i</a></tt> <tt class="py-op">+</tt> <tt class="py-number">2</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-421" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-421', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Axy</tt> </tt>
<a name="L737"></a><tt class="py-lineno"> 737</tt>  <tt class="py-line">                <tt class="py-name">red_tensors</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt id="link-422" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-422', 'i', 'link-189');">i</a></tt> <tt class="py-op">+</tt> <tt class="py-number">3</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-423" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-423', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Axz</tt> </tt>
<a name="L738"></a><tt class="py-lineno"> 738</tt>  <tt class="py-line">                <tt class="py-name">red_tensors</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt id="link-424" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-424', 'i', 'link-189');">i</a></tt> <tt class="py-op">+</tt> <tt class="py-number">4</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-425" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-425', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Ayz</tt> </tt>
<a name="L739"></a><tt class="py-lineno"> 739</tt>  <tt class="py-line"> </tt>
<a name="L740"></a><tt class="py-lineno"> 740</tt>  <tt class="py-line">            <tt class="py-comment"># The reduced tensor errors.</tt> </tt>
<a name="L741"></a><tt class="py-lineno"> 741</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-426" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-426', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">,</tt> <tt class="py-string">'Axx_err'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L742"></a><tt class="py-lineno"> 742</tt>  <tt class="py-line">                <tt class="py-name">red_err</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt id="link-427" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-427', 'i', 'link-189');">i</a></tt> <tt class="py-op">+</tt> <tt class="py-number">0</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-428" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-428', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Axx_err</tt> </tt>
<a name="L743"></a><tt class="py-lineno"> 743</tt>  <tt class="py-line">                <tt class="py-name">red_err</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt id="link-429" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-429', 'i', 'link-189');">i</a></tt> <tt class="py-op">+</tt> <tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-430" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-430', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Ayy_err</tt> </tt>
<a name="L744"></a><tt class="py-lineno"> 744</tt>  <tt class="py-line">                <tt class="py-name">red_err</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt id="link-431" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-431', 'i', 'link-189');">i</a></tt> <tt class="py-op">+</tt> <tt class="py-number">2</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-432" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-432', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Axy_err</tt> </tt>
<a name="L745"></a><tt class="py-lineno"> 745</tt>  <tt class="py-line">                <tt class="py-name">red_err</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt id="link-433" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-433', 'i', 'link-189');">i</a></tt> <tt class="py-op">+</tt> <tt class="py-number">3</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-434" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-434', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Axz_err</tt> </tt>
<a name="L746"></a><tt class="py-lineno"> 746</tt>  <tt class="py-line">                <tt class="py-name">red_err</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt id="link-435" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-435', 'i', 'link-189');">i</a></tt> <tt class="py-op">+</tt> <tt class="py-number">4</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-436" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-436', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">Ayz_err</tt> </tt>
<a name="L747"></a><tt class="py-lineno"> 747</tt>  <tt class="py-line"> </tt>
<a name="L748"></a><tt class="py-lineno"> 748</tt>  <tt class="py-line">        <tt class="py-comment"># Return the data structures.</tt> </tt>
<a name="L749"></a><tt class="py-lineno"> 749</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">full_tensors</tt><tt class="py-op">,</tt> <tt class="py-name">red_tensors</tt><tt class="py-op">,</tt> <tt class="py-name">red_err</tt><tt class="py-op">,</tt> <tt class="py-name">full_in_ref_frame</tt> </tt>
</div><a name="L750"></a><tt class="py-lineno"> 750</tt>  <tt class="py-line"> </tt>
<a name="L751"></a><tt class="py-lineno"> 751</tt>  <tt class="py-line"> </tt>
<a name="N_state_model._minimise_setup_fixed_tensors"></a><div id="N_state_model._minimise_setup_fixed_tensors-def"><a name="L752"></a><tt class="py-lineno"> 752</tt> <a class="py-toggle" href="#" id="N_state_model._minimise_setup_fixed_tensors-toggle" onclick="return toggle('N_state_model._minimise_setup_fixed_tensors');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#_minimise_setup_fixed_tensors">_minimise_setup_fixed_tensors</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model._minimise_setup_fixed_tensors-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model._minimise_setup_fixed_tensors-expanded"><a name="L753"></a><tt class="py-lineno"> 753</tt>  <tt class="py-line">        <tt class="py-docstring">"""Set up the data structures for the fixed alignment tensors.</tt> </tt>
<a name="L754"></a><tt class="py-lineno"> 754</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L755"></a><tt class="py-lineno"> 755</tt>  <tt class="py-line"><tt class="py-docstring">        @return:            The assembled data structures for the fixed alignment tensors.</tt> </tt>
<a name="L756"></a><tt class="py-lineno"> 756</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:             numpy rank-1 array.</tt> </tt>
<a name="L757"></a><tt class="py-lineno"> 757</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L758"></a><tt class="py-lineno"> 758</tt>  <tt class="py-line"> </tt>
<a name="L759"></a><tt class="py-lineno"> 759</tt>  <tt class="py-line">        <tt class="py-comment"># Initialise.</tt> </tt>
<a name="L760"></a><tt class="py-lineno"> 760</tt>  <tt class="py-line">        <tt class="py-name">n</tt> <tt class="py-op">=</tt> <tt id="link-437" class="py-name"><a title="data_store.align_tensor
pipe_control.align_tensor
test_suite.system_tests.align_tensor
user_functions.align_tensor" class="py-name" href="#" onclick="return doclink('link-437', 'align_tensor', 'link-55');">align_tensor</a></tt><tt class="py-op">.</tt><tt id="link-438" class="py-name" targets="Function pipe_control.align_tensor.num_tensors()=pipe_control.align_tensor-module.html#num_tensors"><a title="pipe_control.align_tensor.num_tensors" class="py-name" href="#" onclick="return doclink('link-438', 'num_tensors', 'link-438');">num_tensors</a></tt><tt class="py-op">(</tt><tt class="py-name">skip_fixed</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt> <tt class="py-op">-</tt> <tt id="link-439" class="py-name"><a title="data_store.align_tensor
pipe_control.align_tensor
test_suite.system_tests.align_tensor
user_functions.align_tensor" class="py-name" href="#" onclick="return doclink('link-439', 'align_tensor', 'link-55');">align_tensor</a></tt><tt class="py-op">.</tt><tt id="link-440" class="py-name"><a title="pipe_control.align_tensor.num_tensors" class="py-name" href="#" onclick="return doclink('link-440', 'num_tensors', 'link-438');">num_tensors</a></tt><tt class="py-op">(</tt><tt class="py-name">skip_fixed</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L761"></a><tt class="py-lineno"> 761</tt>  <tt class="py-line">        <tt class="py-name">tensors</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">n</tt><tt class="py-op">*</tt><tt class="py-number">5</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L762"></a><tt class="py-lineno"> 762</tt>  <tt class="py-line"> </tt>
<a name="L763"></a><tt class="py-lineno"> 763</tt>  <tt class="py-line">        <tt class="py-comment"># Nothing to do.</tt> </tt>
<a name="L764"></a><tt class="py-lineno"> 764</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">n</tt> <tt class="py-op">==</tt> <tt class="py-number">0</tt><tt class="py-op">:</tt> </tt>
<a name="L765"></a><tt class="py-lineno"> 765</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">None</tt> </tt>
<a name="L766"></a><tt class="py-lineno"> 766</tt>  <tt class="py-line"> </tt>
<a name="L767"></a><tt class="py-lineno"> 767</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the tensors.</tt> </tt>
<a name="L768"></a><tt class="py-lineno"> 768</tt>  <tt class="py-line">        <tt class="py-name">index</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L769"></a><tt class="py-lineno"> 769</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-441" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-441', 'i', 'link-189');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L770"></a><tt class="py-lineno"> 770</tt>  <tt class="py-line">            <tt class="py-comment"># Skip non-optimised data.</tt> </tt>
<a name="L771"></a><tt class="py-lineno"> 771</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-442" class="py-name"><a title="specific_analyses.n_state_model.data.opt_uses_align_data" class="py-name" href="#" onclick="return doclink('link-442', 'opt_uses_align_data', 'link-87');">opt_uses_align_data</a></tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">[</tt><tt id="link-443" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-443', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-444" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-444', 'name', 'link-158');">name</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L772"></a><tt class="py-lineno"> 772</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L773"></a><tt class="py-lineno"> 773</tt>  <tt class="py-line"> </tt>
<a name="L774"></a><tt class="py-lineno"> 774</tt>  <tt class="py-line">            <tt class="py-comment"># The real tensors.</tt> </tt>
<a name="L775"></a><tt class="py-lineno"> 775</tt>  <tt class="py-line">            <tt class="py-name">tensors</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt class="py-name">index</tt> <tt class="py-op">+</tt> <tt class="py-number">0</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">[</tt><tt id="link-445" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-445', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">Axx</tt> </tt>
<a name="L776"></a><tt class="py-lineno"> 776</tt>  <tt class="py-line">            <tt class="py-name">tensors</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt class="py-name">index</tt> <tt class="py-op">+</tt> <tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">[</tt><tt id="link-446" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-446', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">Ayy</tt> </tt>
<a name="L777"></a><tt class="py-lineno"> 777</tt>  <tt class="py-line">            <tt class="py-name">tensors</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt class="py-name">index</tt> <tt class="py-op">+</tt> <tt class="py-number">2</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">[</tt><tt id="link-447" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-447', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">Axy</tt> </tt>
<a name="L778"></a><tt class="py-lineno"> 778</tt>  <tt class="py-line">            <tt class="py-name">tensors</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt class="py-name">index</tt> <tt class="py-op">+</tt> <tt class="py-number">3</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">[</tt><tt id="link-448" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-448', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">Axz</tt> </tt>
<a name="L779"></a><tt class="py-lineno"> 779</tt>  <tt class="py-line">            <tt class="py-name">tensors</tt><tt class="py-op">[</tt><tt class="py-number">5</tt><tt class="py-op">*</tt><tt class="py-name">index</tt> <tt class="py-op">+</tt> <tt class="py-number">4</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">[</tt><tt id="link-449" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-449', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">Ayz</tt> </tt>
<a name="L780"></a><tt class="py-lineno"> 780</tt>  <tt class="py-line"> </tt>
<a name="L781"></a><tt class="py-lineno"> 781</tt>  <tt class="py-line">            <tt class="py-comment"># Increment the index.</tt> </tt>
<a name="L782"></a><tt class="py-lineno"> 782</tt>  <tt class="py-line">            <tt class="py-name">index</tt> <tt class="py-op">+=</tt> <tt class="py-number">1</tt> </tt>
<a name="L783"></a><tt class="py-lineno"> 783</tt>  <tt class="py-line"> </tt>
<a name="L784"></a><tt class="py-lineno"> 784</tt>  <tt class="py-line">        <tt class="py-comment"># Return the data structure.</tt> </tt>
<a name="L785"></a><tt class="py-lineno"> 785</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">tensors</tt> </tt>
</div><a name="L786"></a><tt class="py-lineno"> 786</tt>  <tt class="py-line"> </tt>
<a name="L787"></a><tt class="py-lineno"> 787</tt>  <tt class="py-line"> </tt>
<a name="N_state_model._target_fn_setup"></a><div id="N_state_model._target_fn_setup-def"><a name="L788"></a><tt class="py-lineno"> 788</tt> <a class="py-toggle" href="#" id="N_state_model._target_fn_setup-toggle" onclick="return toggle('N_state_model._target_fn_setup');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#_target_fn_setup">_target_fn_setup</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">scaling</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model._target_fn_setup-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model._target_fn_setup-expanded"><a name="L789"></a><tt class="py-lineno"> 789</tt>  <tt class="py-line">        <tt class="py-docstring">"""Initialise the target function for optimisation or direct calculation.</tt> </tt>
<a name="L790"></a><tt class="py-lineno"> 790</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L791"></a><tt class="py-lineno"> 791</tt>  <tt class="py-line"><tt class="py-docstring">        @param sim_index:       The index of the simulation to optimise.  This should be None if normal optimisation is desired.</tt> </tt>
<a name="L792"></a><tt class="py-lineno"> 792</tt>  <tt class="py-line"><tt class="py-docstring">        @type sim_index:        None or int</tt> </tt>
<a name="L793"></a><tt class="py-lineno"> 793</tt>  <tt class="py-line"><tt class="py-docstring">        @param scaling:         If True, diagonal scaling is enabled during optimisation to allow the problem to be better conditioned.</tt> </tt>
<a name="L794"></a><tt class="py-lineno"> 794</tt>  <tt class="py-line"><tt class="py-docstring">        @type scaling:          bool</tt> </tt>
<a name="L795"></a><tt class="py-lineno"> 795</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L796"></a><tt class="py-lineno"> 796</tt>  <tt class="py-line"> </tt>
<a name="L797"></a><tt class="py-lineno"> 797</tt>  <tt class="py-line">        <tt class="py-comment"># Test if the N-state model has been set up.</tt> </tt>
<a name="L798"></a><tt class="py-lineno"> 798</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'model'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L799"></a><tt class="py-lineno"> 799</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-450" class="py-name"><a title="lib.errors.RelaxNoModelError" class="py-name" href="#" onclick="return doclink('link-450', 'RelaxNoModelError', 'link-16');">RelaxNoModelError</a></tt><tt class="py-op">(</tt><tt class="py-string">'N-state'</tt><tt class="py-op">)</tt> </tt>
<a name="L800"></a><tt class="py-lineno"> 800</tt>  <tt class="py-line"> </tt>
<a name="L801"></a><tt class="py-lineno"> 801</tt>  <tt class="py-line">        <tt class="py-comment"># '2-domain' model setup tests.</tt> </tt>
<a name="L802"></a><tt class="py-lineno"> 802</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-451" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model" class="py-name" href="#" onclick="return doclink('link-451', 'model', 'link-201');">model</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'2-domain'</tt><tt class="py-op">:</tt> </tt>
<a name="L803"></a><tt class="py-lineno"> 803</tt>  <tt class="py-line">            <tt class="py-comment"># The number of states.</tt> </tt>
<a name="L804"></a><tt class="py-lineno"> 804</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'N'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L805"></a><tt class="py-lineno"> 805</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-452" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-452', 'RelaxError', 'link-13');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The number of states has not been set."</tt><tt class="py-op">)</tt> </tt>
<a name="L806"></a><tt class="py-lineno"> 806</tt>  <tt class="py-line"> </tt>
<a name="L807"></a><tt class="py-lineno"> 807</tt>  <tt class="py-line">            <tt class="py-comment"># The reference domain.</tt> </tt>
<a name="L808"></a><tt class="py-lineno"> 808</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'ref_domain'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L809"></a><tt class="py-lineno"> 809</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-453" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-453', 'RelaxError', 'link-13');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The reference domain has not been set."</tt><tt class="py-op">)</tt> </tt>
<a name="L810"></a><tt class="py-lineno"> 810</tt>  <tt class="py-line"> </tt>
<a name="L811"></a><tt class="py-lineno"> 811</tt>  <tt class="py-line">        <tt class="py-comment"># Update the model parameters if necessary.</tt> </tt>
<a name="L812"></a><tt class="py-lineno"> 812</tt>  <tt class="py-line">        <tt id="link-454" class="py-name"><a title="specific_analyses.n_state_model.parameters.update_model" class="py-name" href="#" onclick="return doclink('link-454', 'update_model', 'link-99');">update_model</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L813"></a><tt class="py-lineno"> 813</tt>  <tt class="py-line"> </tt>
<a name="L814"></a><tt class="py-lineno"> 814</tt>  <tt class="py-line">        <tt class="py-comment"># Create the initial parameter vector.</tt> </tt>
<a name="L815"></a><tt class="py-lineno"> 815</tt>  <tt class="py-line">        <tt class="py-name">param_vector</tt> <tt class="py-op">=</tt> <tt id="link-455" class="py-name"><a title="specific_analyses.n_state_model.parameters.assemble_param_vector" class="py-name" href="#" onclick="return doclink('link-455', 'assemble_param_vector', 'link-93');">assemble_param_vector</a></tt><tt class="py-op">(</tt><tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">)</tt> </tt>
<a name="L816"></a><tt class="py-lineno"> 816</tt>  <tt class="py-line"> </tt>
<a name="L817"></a><tt class="py-lineno"> 817</tt>  <tt class="py-line">        <tt class="py-comment"># Determine if alignment tensors or RDCs are to be used.</tt> </tt>
<a name="L818"></a><tt class="py-lineno"> 818</tt>  <tt class="py-line">        <tt id="link-456" class="py-name" targets="Module test_suite.unit_tests._prompt.data_types=test_suite.unit_tests._prompt.data_types-module.html"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-456', 'data_types', 'link-456');">data_types</a></tt> <tt class="py-op">=</tt> <tt id="link-457" class="py-name"><a title="specific_analyses.n_state_model.data.base_data_types" class="py-name" href="#" onclick="return doclink('link-457', 'base_data_types', 'link-82');">base_data_types</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L819"></a><tt class="py-lineno"> 819</tt>  <tt class="py-line"> </tt>
<a name="L820"></a><tt class="py-lineno"> 820</tt>  <tt class="py-line">        <tt class="py-comment"># The probabilities.</tt> </tt>
<a name="L821"></a><tt class="py-lineno"> 821</tt>  <tt class="py-line">        <tt class="py-name">probs</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L822"></a><tt class="py-lineno"> 822</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'probs'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">probs</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">probs</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L823"></a><tt class="py-lineno"> 823</tt>  <tt class="py-line">            <tt class="py-name">probs</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">probs</tt> </tt>
<a name="L824"></a><tt class="py-lineno"> 824</tt>  <tt class="py-line"> </tt>
<a name="L825"></a><tt class="py-lineno"> 825</tt>  <tt class="py-line">        <tt class="py-comment"># Diagonal scaling.</tt> </tt>
<a name="L826"></a><tt class="py-lineno"> 826</tt>  <tt class="py-line">        <tt class="py-name">scaling_matrix</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L827"></a><tt class="py-lineno"> 827</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">param_vector</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L828"></a><tt class="py-lineno"> 828</tt>  <tt class="py-line">            <tt class="py-name">scaling_matrix</tt> <tt class="py-op">=</tt> <tt id="link-458" class="py-name"><a title="specific_analyses.n_state_model.parameters.assemble_scaling_matrix" class="py-name" href="#" onclick="return doclink('link-458', 'assemble_scaling_matrix', 'link-94');">assemble_scaling_matrix</a></tt><tt class="py-op">(</tt><tt id="link-459" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-459', 'data_types', 'link-456');">data_types</a></tt><tt class="py-op">=</tt><tt id="link-460" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-460', 'data_types', 'link-456');">data_types</a></tt><tt class="py-op">,</tt> <tt class="py-name">scaling</tt><tt class="py-op">=</tt><tt class="py-name">scaling</tt><tt class="py-op">)</tt> </tt>
<a name="L829"></a><tt class="py-lineno"> 829</tt>  <tt class="py-line">            <tt class="py-name">param_vector</tt> <tt class="py-op">=</tt> <tt class="py-name">dot</tt><tt class="py-op">(</tt><tt class="py-name">inv</tt><tt class="py-op">(</tt><tt class="py-name">scaling_matrix</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">param_vector</tt><tt class="py-op">)</tt> </tt>
<a name="L830"></a><tt class="py-lineno"> 830</tt>  <tt class="py-line"> </tt>
<a name="L831"></a><tt class="py-lineno"> 831</tt>  <tt class="py-line">        <tt class="py-comment"># Get the data structures for optimisation using the tensors as base data sets.</tt> </tt>
<a name="L832"></a><tt class="py-lineno"> 832</tt>  <tt class="py-line">        <tt class="py-name">full_tensors</tt><tt class="py-op">,</tt> <tt class="py-name">red_tensor_elem</tt><tt class="py-op">,</tt> <tt class="py-name">red_tensor_err</tt><tt class="py-op">,</tt> <tt class="py-name">full_in_ref_frame</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt> </tt>
<a name="L833"></a><tt class="py-lineno"> 833</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-string">'tensor'</tt> <tt class="py-keyword">in</tt> <tt id="link-461" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-461', 'data_types', 'link-456');">data_types</a></tt><tt class="py-op">:</tt> </tt>
<a name="L834"></a><tt class="py-lineno"> 834</tt>  <tt class="py-line">            <tt class="py-name">full_tensors</tt><tt class="py-op">,</tt> <tt class="py-name">red_tensor_elem</tt><tt class="py-op">,</tt> <tt class="py-name">red_tensor_err</tt><tt class="py-op">,</tt> <tt class="py-name">full_in_ref_frame</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-462" class="py-name" targets="Method specific_analyses.frame_order.Frame_order._minimise_setup_tensors()=specific_analyses.frame_order.Frame_order-class.html#_minimise_setup_tensors,Method specific_analyses.n_state_model.N_state_model._minimise_setup_tensors()=specific_analyses.n_state_model.N_state_model-class.html#_minimise_setup_tensors"><a title="specific_analyses.frame_order.Frame_order._minimise_setup_tensors
specific_analyses.n_state_model.N_state_model._minimise_setup_tensors" class="py-name" href="#" onclick="return doclink('link-462', '_minimise_setup_tensors', 'link-462');">_minimise_setup_tensors</a></tt><tt class="py-op">(</tt><tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">)</tt> </tt>
<a name="L835"></a><tt class="py-lineno"> 835</tt>  <tt class="py-line"> </tt>
<a name="L836"></a><tt class="py-lineno"> 836</tt>  <tt class="py-line">        <tt class="py-comment"># Get the data structures for optimisation using PCSs as base data sets.</tt> </tt>
<a name="L837"></a><tt class="py-lineno"> 837</tt>  <tt class="py-line">        <tt id="link-463" class="py-name"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-463', 'pcs', 'link-56');">pcs</a></tt><tt class="py-op">,</tt> <tt class="py-name">pcs_err</tt><tt class="py-op">,</tt> <tt class="py-name">pcs_weight</tt><tt class="py-op">,</tt> <tt class="py-name">temp</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt> </tt>
<a name="L838"></a><tt class="py-lineno"> 838</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-string">'pcs'</tt> <tt class="py-keyword">in</tt> <tt id="link-464" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-464', 'data_types', 'link-456');">data_types</a></tt><tt class="py-op">:</tt> </tt>
<a name="L839"></a><tt class="py-lineno"> 839</tt>  <tt class="py-line">            <tt id="link-465" class="py-name"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-465', 'pcs', 'link-56');">pcs</a></tt><tt class="py-op">,</tt> <tt class="py-name">pcs_err</tt><tt class="py-op">,</tt> <tt class="py-name">pcs_weight</tt><tt class="py-op">,</tt> <tt class="py-name">temp</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-466" class="py-name" targets="Method specific_analyses.frame_order.Frame_order._minimise_setup_pcs()=specific_analyses.frame_order.Frame_order-class.html#_minimise_setup_pcs,Method specific_analyses.n_state_model.N_state_model._minimise_setup_pcs()=specific_analyses.n_state_model.N_state_model-class.html#_minimise_setup_pcs"><a title="specific_analyses.frame_order.Frame_order._minimise_setup_pcs
specific_analyses.n_state_model.N_state_model._minimise_setup_pcs" class="py-name" href="#" onclick="return doclink('link-466', '_minimise_setup_pcs', 'link-466');">_minimise_setup_pcs</a></tt><tt class="py-op">(</tt><tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">)</tt> </tt>
<a name="L840"></a><tt class="py-lineno"> 840</tt>  <tt class="py-line"> </tt>
<a name="L841"></a><tt class="py-lineno"> 841</tt>  <tt class="py-line">        <tt class="py-comment"># Get the data structures for optimisation using RDCs as base data sets.</tt> </tt>
<a name="L842"></a><tt class="py-lineno"> 842</tt>  <tt class="py-line">        <tt class="py-name">rdcs</tt><tt class="py-op">,</tt> <tt class="py-name">rdc_err</tt><tt class="py-op">,</tt> <tt class="py-name">rdc_weight</tt><tt class="py-op">,</tt> <tt class="py-name">rdc_vector</tt><tt class="py-op">,</tt> <tt class="py-name">rdc_dj</tt><tt class="py-op">,</tt> <tt class="py-name">absolute_rdc</tt><tt class="py-op">,</tt> <tt class="py-name">T_flags</tt><tt class="py-op">,</tt> <tt class="py-name">j_couplings</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt> </tt>
<a name="L843"></a><tt class="py-lineno"> 843</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-string">'rdc'</tt> <tt class="py-keyword">in</tt> <tt id="link-467" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-467', 'data_types', 'link-456');">data_types</a></tt><tt class="py-op">:</tt> </tt>
<a name="L844"></a><tt class="py-lineno"> 844</tt>  <tt class="py-line">            <tt class="py-name">rdcs</tt><tt class="py-op">,</tt> <tt class="py-name">rdc_err</tt><tt class="py-op">,</tt> <tt class="py-name">rdc_weight</tt><tt class="py-op">,</tt> <tt class="py-name">rdc_vector</tt><tt class="py-op">,</tt> <tt class="py-name">rdc_dj</tt><tt class="py-op">,</tt> <tt class="py-name">absolute_rdc</tt><tt class="py-op">,</tt> <tt class="py-name">T_flags</tt><tt class="py-op">,</tt> <tt class="py-name">j_couplings</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-468" class="py-name" targets="Method specific_analyses.frame_order.Frame_order._minimise_setup_rdcs()=specific_analyses.frame_order.Frame_order-class.html#_minimise_setup_rdcs,Method specific_analyses.n_state_model.N_state_model._minimise_setup_rdcs()=specific_analyses.n_state_model.N_state_model-class.html#_minimise_setup_rdcs"><a title="specific_analyses.frame_order.Frame_order._minimise_setup_rdcs
specific_analyses.n_state_model.N_state_model._minimise_setup_rdcs" class="py-name" href="#" onclick="return doclink('link-468', '_minimise_setup_rdcs', 'link-468');">_minimise_setup_rdcs</a></tt><tt class="py-op">(</tt><tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">)</tt> </tt>
<a name="L845"></a><tt class="py-lineno"> 845</tt>  <tt class="py-line"> </tt>
<a name="L846"></a><tt class="py-lineno"> 846</tt>  <tt class="py-line">        <tt class="py-comment"># Get the fixed tensors.</tt> </tt>
<a name="L847"></a><tt class="py-lineno"> 847</tt>  <tt class="py-line">        <tt class="py-name">fixed_tensors</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L848"></a><tt class="py-lineno"> 848</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-string">'rdc'</tt> <tt class="py-keyword">in</tt> <tt id="link-469" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-469', 'data_types', 'link-456');">data_types</a></tt> <tt class="py-keyword">or</tt> <tt class="py-string">'pcs'</tt> <tt class="py-keyword">in</tt> <tt id="link-470" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-470', 'data_types', 'link-456');">data_types</a></tt><tt class="py-op">:</tt> </tt>
<a name="L849"></a><tt class="py-lineno"> 849</tt>  <tt class="py-line">            <tt class="py-name">full_tensors</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-471" class="py-name" targets="Method specific_analyses.n_state_model.N_state_model._minimise_setup_fixed_tensors()=specific_analyses.n_state_model.N_state_model-class.html#_minimise_setup_fixed_tensors"><a title="specific_analyses.n_state_model.N_state_model._minimise_setup_fixed_tensors" class="py-name" href="#" onclick="return doclink('link-471', '_minimise_setup_fixed_tensors', 'link-471');">_minimise_setup_fixed_tensors</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L850"></a><tt class="py-lineno"> 850</tt>  <tt class="py-line"> </tt>
<a name="L851"></a><tt class="py-lineno"> 851</tt>  <tt class="py-line">            <tt class="py-comment"># The flag list.</tt> </tt>
<a name="L852"></a><tt class="py-lineno"> 852</tt>  <tt class="py-line">            <tt class="py-name">fixed_tensors</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L853"></a><tt class="py-lineno"> 853</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-472" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-472', 'i', 'link-189');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L854"></a><tt class="py-lineno"> 854</tt>  <tt class="py-line">                <tt class="py-comment"># Skip non-optimised data.</tt> </tt>
<a name="L855"></a><tt class="py-lineno"> 855</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-473" class="py-name"><a title="specific_analyses.n_state_model.data.opt_uses_align_data" class="py-name" href="#" onclick="return doclink('link-473', 'opt_uses_align_data', 'link-87');">opt_uses_align_data</a></tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">[</tt><tt id="link-474" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-474', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-475" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-475', 'name', 'link-158');">name</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L856"></a><tt class="py-lineno"> 856</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L857"></a><tt class="py-lineno"> 857</tt>  <tt class="py-line"> </tt>
<a name="L858"></a><tt class="py-lineno"> 858</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">[</tt><tt id="link-476" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-476', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">fixed</tt><tt class="py-op">:</tt> </tt>
<a name="L859"></a><tt class="py-lineno"> 859</tt>  <tt class="py-line">                    <tt class="py-name">fixed_tensors</tt><tt class="py-op">.</tt><tt id="link-477" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-477', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L860"></a><tt class="py-lineno"> 860</tt>  <tt class="py-line">                <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L861"></a><tt class="py-lineno"> 861</tt>  <tt class="py-line">                    <tt class="py-name">fixed_tensors</tt><tt class="py-op">.</tt><tt id="link-478" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-478', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">False</tt><tt class="py-op">)</tt> </tt>
<a name="L862"></a><tt class="py-lineno"> 862</tt>  <tt class="py-line"> </tt>
<a name="L863"></a><tt class="py-lineno"> 863</tt>  <tt class="py-line">        <tt class="py-comment"># Get the atomic_positions.</tt> </tt>
<a name="L864"></a><tt class="py-lineno"> 864</tt>  <tt class="py-line">        <tt class="py-name">atomic_pos</tt><tt class="py-op">,</tt> <tt id="link-479" class="py-name"><a title="lib.alignment.paramag_centre" class="py-name" href="#" onclick="return doclink('link-479', 'paramag_centre', 'link-228');">paramag_centre</a></tt><tt class="py-op">,</tt> <tt class="py-name">centre_fixed</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">True</tt> </tt>
<a name="L865"></a><tt class="py-lineno"> 865</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-string">'pcs'</tt> <tt class="py-keyword">in</tt> <tt id="link-480" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-480', 'data_types', 'link-456');">data_types</a></tt> <tt class="py-keyword">or</tt> <tt class="py-string">'pre'</tt> <tt class="py-keyword">in</tt> <tt id="link-481" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-481', 'data_types', 'link-456');">data_types</a></tt><tt class="py-op">:</tt> </tt>
<a name="L866"></a><tt class="py-lineno"> 866</tt>  <tt class="py-line">            <tt class="py-name">atomic_pos</tt><tt class="py-op">,</tt> <tt id="link-482" class="py-name"><a title="lib.alignment.paramag_centre" class="py-name" href="#" onclick="return doclink('link-482', 'paramag_centre', 'link-228');">paramag_centre</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-483" class="py-name" targets="Method specific_analyses.frame_order.Frame_order._minimise_setup_atomic_pos()=specific_analyses.frame_order.Frame_order-class.html#_minimise_setup_atomic_pos,Method specific_analyses.n_state_model.N_state_model._minimise_setup_atomic_pos()=specific_analyses.n_state_model.N_state_model-class.html#_minimise_setup_atomic_pos"><a title="specific_analyses.frame_order.Frame_order._minimise_setup_atomic_pos
specific_analyses.n_state_model.N_state_model._minimise_setup_atomic_pos" class="py-name" href="#" onclick="return doclink('link-483', '_minimise_setup_atomic_pos', 'link-483');">_minimise_setup_atomic_pos</a></tt><tt class="py-op">(</tt><tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">)</tt> </tt>
<a name="L867"></a><tt class="py-lineno"> 867</tt>  <tt class="py-line"> </tt>
<a name="L868"></a><tt class="py-lineno"> 868</tt>  <tt class="py-line">            <tt class="py-comment"># Optimisation of the centre.</tt> </tt>
<a name="L869"></a><tt class="py-lineno"> 869</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'paramag_centre_fixed'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L870"></a><tt class="py-lineno"> 870</tt>  <tt class="py-line">                <tt class="py-name">centre_fixed</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramag_centre_fixed</tt> </tt>
<a name="L871"></a><tt class="py-lineno"> 871</tt>  <tt class="py-line"> </tt>
<a name="L872"></a><tt class="py-lineno"> 872</tt>  <tt class="py-line">        <tt class="py-comment"># Set up the class instance containing the target function.</tt> </tt>
<a name="L873"></a><tt class="py-lineno"> 873</tt>  <tt class="py-line">        <tt id="link-484" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model" class="py-name" href="#" onclick="return doclink('link-484', 'model', 'link-201');">model</a></tt> <tt class="py-op">=</tt> <tt id="link-485" class="py-name"><a title="target_functions.n_state_model.N_state_opt" class="py-name" href="#" onclick="return doclink('link-485', 'N_state_opt', 'link-102');">N_state_opt</a></tt><tt class="py-op">(</tt><tt id="link-486" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model" class="py-name" href="#" onclick="return doclink('link-486', 'model', 'link-201');">model</a></tt><tt class="py-op">=</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-487" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model" class="py-name" href="#" onclick="return doclink('link-487', 'model', 'link-201');">model</a></tt><tt class="py-op">,</tt> <tt class="py-name">N</tt><tt class="py-op">=</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">N</tt><tt class="py-op">,</tt> <tt class="py-name">init_params</tt><tt class="py-op">=</tt><tt class="py-name">param_vector</tt><tt class="py-op">,</tt> <tt class="py-name">probs</tt><tt class="py-op">=</tt><tt class="py-name">probs</tt><tt class="py-op">,</tt> <tt class="py-name">full_tensors</tt><tt class="py-op">=</tt><tt class="py-name">full_tensors</tt><tt class="py-op">,</tt> <tt class="py-name">red_data</tt><tt class="py-op">=</tt><tt class="py-name">red_tensor_elem</tt><tt class="py-op">,</tt> <tt class="py-name">red_errors</tt><tt class="py-op">=</tt><tt class="py-name">red_tensor_err</tt><tt class="py-op">,</tt> <tt class="py-name">full_in_ref_frame</tt><tt class="py-op">=</tt><tt class="py-name">full_in_ref_frame</tt><tt class="py-op">,</tt> <tt class="py-name">fixed_tensors</tt><tt class="py-op">=</tt><tt class="py-name">fixed_tensors</tt><tt class="py-op">,</tt> <tt id="link-488" class="py-name"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-488', 'pcs', 'link-56');">pcs</a></tt><tt class="py-op">=</tt><tt id="link-489" class="py-name"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-489', 'pcs', 'link-56');">pcs</a></tt><tt class="py-op">,</tt> <tt class="py-name">rdcs</tt><tt class="py-op">=</tt><tt class="py-name">rdcs</tt><tt class="py-op">,</tt> <tt class="py-name">pcs_errors</tt><tt class="py-op">=</tt><tt class="py-name">pcs_err</tt><tt class="py-op">,</tt> <tt class="py-name">rdc_errors</tt><tt class="py-op">=</tt><tt class="py-name">rdc_err</tt><tt class="py-op">,</tt> <tt class="py-name">T_flags</tt><tt class="py-op">=</tt><tt class="py-name">T_flags</tt><tt class="py-op">,</tt> <tt class="py-name">j_couplings</tt><tt class="py-op">=</tt><tt class="py-name">j_couplings</tt><tt class="py-op">,</tt> <tt class="py-name">pcs_weights</tt><tt class="py-op">=</tt><tt class="py-name">pcs_weight</tt><tt class="py-op">,</tt> <tt class="py-name">rdc_weights</tt><tt class="py-op">=</tt><tt class="py-name">rdc_weight</tt><tt class="py-op">,</tt> <tt class="py-name">rdc_vect</tt><tt class="py-op">=</tt><tt class="py-name">rdc_vector</tt><tt class="py-op">,</tt> <tt class="py-name">temp</tt><tt class="py-op">=</tt><tt class="py-name">temp</tt><tt class="py-op">,</tt> <tt class="py-name">frq</tt><tt class="py-op">=</tt><tt class="py-name">frq</tt><tt class="py-op">,</tt> <tt class="py-name">dip_const</tt><tt class="py-op">=</tt><tt class="py-name">rdc_dj</tt><tt class="py-op">,</tt> <tt class="py-name">absolute_rdc</tt><tt class="py-op">=</tt><tt class="py-name">absolute_rdc</tt><tt class="py-op">,</tt> <tt class="py-name">atomic_pos</tt><tt class="py-op">=</tt><tt class="py-name">atomic_pos</tt><tt class="py-op">,</tt> <tt id="link-490" class="py-name"><a title="lib.alignment.paramag_centre" class="py-name" href="#" onclick="return doclink('link-490', 'paramag_centre', 'link-228');">paramag_centre</a></tt><tt class="py-op">=</tt><tt id="link-491" class="py-name"><a title="lib.alignment.paramag_centre" class="py-name" href="#" onclick="return doclink('link-491', 'paramag_centre', 'link-228');">paramag_centre</a></tt><tt class="py-op">,</tt> <tt class="py-name">scaling_matrix</tt><tt class="py-op">=</tt><tt class="py-name">scaling_matrix</tt><tt class="py-op">,</tt> <tt class="py-name">centre_fixed</tt><tt class="py-op">=</tt><tt class="py-name">centre_fixed</tt><tt class="py-op">)</tt> </tt>
<a name="L874"></a><tt class="py-lineno"> 874</tt>  <tt class="py-line"> </tt>
<a name="L875"></a><tt class="py-lineno"> 875</tt>  <tt class="py-line">        <tt class="py-comment"># Return the data.</tt> </tt>
<a name="L876"></a><tt class="py-lineno"> 876</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt id="link-492" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model" class="py-name" href="#" onclick="return doclink('link-492', 'model', 'link-201');">model</a></tt><tt class="py-op">,</tt> <tt class="py-name">param_vector</tt><tt class="py-op">,</tt> <tt id="link-493" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-493', 'data_types', 'link-456');">data_types</a></tt><tt class="py-op">,</tt> <tt class="py-name">scaling_matrix</tt> </tt>
</div><a name="L877"></a><tt class="py-lineno"> 877</tt>  <tt class="py-line"> </tt>
<a name="L878"></a><tt class="py-lineno"> 878</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.base_data_loop"></a><div id="N_state_model.base_data_loop-def"><a name="L879"></a><tt class="py-lineno"> 879</tt> <a class="py-toggle" href="#" id="N_state_model.base_data_loop-toggle" onclick="return toggle('N_state_model.base_data_loop');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#base_data_loop">base_data_loop</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.base_data_loop-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model.base_data_loop-expanded"><a name="L880"></a><tt class="py-lineno"> 880</tt>  <tt class="py-line">        <tt class="py-docstring">"""Loop over the base data of the spins - RDCs, PCSs, and NOESY data.</tt> </tt>
<a name="L881"></a><tt class="py-lineno"> 881</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L882"></a><tt class="py-lineno"> 882</tt>  <tt class="py-line"><tt class="py-docstring">        This loop iterates for each data point (RDC, PCS, NOESY) for each spin or interatomic data container, returning the identification information.</tt> </tt>
<a name="L883"></a><tt class="py-lineno"> 883</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L884"></a><tt class="py-lineno"> 884</tt>  <tt class="py-line"><tt class="py-docstring">        @return:            A list of the spin or interatomic data container, the data type ('rdc', 'pcs', 'noesy'), and the alignment ID if required.</tt> </tt>
<a name="L885"></a><tt class="py-lineno"> 885</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:             list of [SpinContainer instance, str, str] or [InteratomContainer instance, str, str]</tt> </tt>
<a name="L886"></a><tt class="py-lineno"> 886</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L887"></a><tt class="py-lineno"> 887</tt>  <tt class="py-line"> </tt>
<a name="L888"></a><tt class="py-lineno"> 888</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the interatomic data containers.</tt> </tt>
<a name="L889"></a><tt class="py-lineno"> 889</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-494" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-494', 'interatom', 'link-202');">interatom</a></tt> <tt class="py-keyword">in</tt> <tt id="link-495" class="py-name"><a title="pipe_control.interatomic.interatomic_loop" class="py-name" href="#" onclick="return doclink('link-495', 'interatomic_loop', 'link-61');">interatomic_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L890"></a><tt class="py-lineno"> 890</tt>  <tt class="py-line">            <tt class="py-comment"># Skip deselected data.</tt> </tt>
<a name="L891"></a><tt class="py-lineno"> 891</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-496" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-496', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">.</tt><tt id="link-497" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-497', 'select', 'link-196');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L892"></a><tt class="py-lineno"> 892</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L893"></a><tt class="py-lineno"> 893</tt>  <tt class="py-line"> </tt>
<a name="L894"></a><tt class="py-lineno"> 894</tt>  <tt class="py-line">            <tt class="py-comment"># Re-initialise the data structure.</tt> </tt>
<a name="L895"></a><tt class="py-lineno"> 895</tt>  <tt class="py-line">            <tt id="link-498" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-498', 'data', 'link-81');">data</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt id="link-499" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-499', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">]</tt> </tt>
<a name="L896"></a><tt class="py-lineno"> 896</tt>  <tt class="py-line"> </tt>
<a name="L897"></a><tt class="py-lineno"> 897</tt>  <tt class="py-line">            <tt class="py-comment"># RDC data.</tt> </tt>
<a name="L898"></a><tt class="py-lineno"> 898</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-500" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-500', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">,</tt> <tt class="py-string">'rdc'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L899"></a><tt class="py-lineno"> 899</tt>  <tt class="py-line">                <tt id="link-501" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-501', 'data', 'link-81');">data</a></tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-string">'rdc'</tt> </tt>
<a name="L900"></a><tt class="py-lineno"> 900</tt>  <tt class="py-line"> </tt>
<a name="L901"></a><tt class="py-lineno"> 901</tt>  <tt class="py-line">                <tt class="py-comment"># Loop over the alignment IDs.</tt> </tt>
<a name="L902"></a><tt class="py-lineno"> 902</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">id</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">rdc_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L903"></a><tt class="py-lineno"> 903</tt>  <tt class="py-line">                    <tt class="py-comment"># Add the ID.</tt> </tt>
<a name="L904"></a><tt class="py-lineno"> 904</tt>  <tt class="py-line">                    <tt id="link-502" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-502', 'data', 'link-81');">data</a></tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">id</tt> </tt>
<a name="L905"></a><tt class="py-lineno"> 905</tt>  <tt class="py-line"> </tt>
<a name="L906"></a><tt class="py-lineno"> 906</tt>  <tt class="py-line">                    <tt class="py-comment"># Yield the set.</tt> </tt>
<a name="L907"></a><tt class="py-lineno"> 907</tt>  <tt class="py-line">                    <tt class="py-keyword">yield</tt> <tt id="link-503" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-503', 'data', 'link-81');">data</a></tt> </tt>
<a name="L908"></a><tt class="py-lineno"> 908</tt>  <tt class="py-line"> </tt>
<a name="L909"></a><tt class="py-lineno"> 909</tt>  <tt class="py-line">            <tt class="py-comment"># NOESY data.</tt> </tt>
<a name="L910"></a><tt class="py-lineno"> 910</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-504" class="py-name"><a title="user_functions.interatom" class="py-name" href="#" onclick="return doclink('link-504', 'interatom', 'link-202');">interatom</a></tt><tt class="py-op">,</tt> <tt class="py-string">'noesy'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L911"></a><tt class="py-lineno"> 911</tt>  <tt class="py-line">                <tt id="link-505" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-505', 'data', 'link-81');">data</a></tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-string">'noesy'</tt> </tt>
<a name="L912"></a><tt class="py-lineno"> 912</tt>  <tt class="py-line"> </tt>
<a name="L913"></a><tt class="py-lineno"> 913</tt>  <tt class="py-line">                <tt class="py-comment"># Loop over the alignment IDs.</tt> </tt>
<a name="L914"></a><tt class="py-lineno"> 914</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">id</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">noesy_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L915"></a><tt class="py-lineno"> 915</tt>  <tt class="py-line">                    <tt class="py-comment"># Add the ID.</tt> </tt>
<a name="L916"></a><tt class="py-lineno"> 916</tt>  <tt class="py-line">                    <tt id="link-506" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-506', 'data', 'link-81');">data</a></tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">id</tt> </tt>
<a name="L917"></a><tt class="py-lineno"> 917</tt>  <tt class="py-line"> </tt>
<a name="L918"></a><tt class="py-lineno"> 918</tt>  <tt class="py-line">                    <tt class="py-comment"># Yield the set.</tt> </tt>
<a name="L919"></a><tt class="py-lineno"> 919</tt>  <tt class="py-line">                    <tt class="py-keyword">yield</tt> <tt id="link-507" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-507', 'data', 'link-81');">data</a></tt> </tt>
<a name="L920"></a><tt class="py-lineno"> 920</tt>  <tt class="py-line"> </tt>
<a name="L921"></a><tt class="py-lineno"> 921</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the spins.</tt> </tt>
<a name="L922"></a><tt class="py-lineno"> 922</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-508" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-508', 'spin', 'link-193');">spin</a></tt> <tt class="py-keyword">in</tt> <tt id="link-509" class="py-name"><a title="pipe_control.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-509', 'spin_loop', 'link-65');">spin_loop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L923"></a><tt class="py-lineno"> 923</tt>  <tt class="py-line">            <tt class="py-comment"># Skip deselected data.</tt> </tt>
<a name="L924"></a><tt class="py-lineno"> 924</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-510" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-510', 'spin', 'link-193');">spin</a></tt><tt class="py-op">.</tt><tt id="link-511" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-511', 'select', 'link-196');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L925"></a><tt class="py-lineno"> 925</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L926"></a><tt class="py-lineno"> 926</tt>  <tt class="py-line"> </tt>
<a name="L927"></a><tt class="py-lineno"> 927</tt>  <tt class="py-line">            <tt class="py-comment"># Re-initialise the data structure.</tt> </tt>
<a name="L928"></a><tt class="py-lineno"> 928</tt>  <tt class="py-line">            <tt id="link-512" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-512', 'data', 'link-81');">data</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt id="link-513" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-513', 'spin', 'link-193');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">]</tt> </tt>
<a name="L929"></a><tt class="py-lineno"> 929</tt>  <tt class="py-line"> </tt>
<a name="L930"></a><tt class="py-lineno"> 930</tt>  <tt class="py-line">            <tt class="py-comment"># PCS data.</tt> </tt>
<a name="L931"></a><tt class="py-lineno"> 931</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-514" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-514', 'spin', 'link-193');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L932"></a><tt class="py-lineno"> 932</tt>  <tt class="py-line">                <tt id="link-515" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-515', 'data', 'link-81');">data</a></tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-string">'pcs'</tt> </tt>
<a name="L933"></a><tt class="py-lineno"> 933</tt>  <tt class="py-line"> </tt>
<a name="L934"></a><tt class="py-lineno"> 934</tt>  <tt class="py-line">                <tt class="py-comment"># Loop over the alignment IDs.</tt> </tt>
<a name="L935"></a><tt class="py-lineno"> 935</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">id</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">pcs_ids</tt><tt class="py-op">:</tt> </tt>
<a name="L936"></a><tt class="py-lineno"> 936</tt>  <tt class="py-line">                    <tt class="py-comment"># Add the ID.</tt> </tt>
<a name="L937"></a><tt class="py-lineno"> 937</tt>  <tt class="py-line">                    <tt id="link-516" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-516', 'data', 'link-81');">data</a></tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">id</tt> </tt>
<a name="L938"></a><tt class="py-lineno"> 938</tt>  <tt class="py-line"> </tt>
<a name="L939"></a><tt class="py-lineno"> 939</tt>  <tt class="py-line">                    <tt class="py-comment"># Yield the set.</tt> </tt>
<a name="L940"></a><tt class="py-lineno"> 940</tt>  <tt class="py-line">                    <tt class="py-keyword">yield</tt> <tt id="link-517" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-517', 'data', 'link-81');">data</a></tt> </tt>
</div><a name="L941"></a><tt class="py-lineno"> 941</tt>  <tt class="py-line"> </tt>
<a name="L942"></a><tt class="py-lineno"> 942</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.calculate"></a><div id="N_state_model.calculate-def"><a name="L943"></a><tt class="py-lineno"> 943</tt> <a class="py-toggle" href="#" id="N_state_model.calculate-toggle" onclick="return toggle('N_state_model.calculate');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#calculate">calculate</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">spin_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">verbosity</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-param">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.calculate-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model.calculate-expanded"><a name="L944"></a><tt class="py-lineno"> 944</tt>  <tt class="py-line">        <tt class="py-docstring">"""Calculation function.</tt> </tt>
<a name="L945"></a><tt class="py-lineno"> 945</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L946"></a><tt class="py-lineno"> 946</tt>  <tt class="py-line"><tt class="py-docstring">        Currently this function simply calculates the NOESY flat-bottom quadratic energy potential,</tt> </tt>
<a name="L947"></a><tt class="py-lineno"> 947</tt>  <tt class="py-line"><tt class="py-docstring">        if NOE restraints are available.</tt> </tt>
<a name="L948"></a><tt class="py-lineno"> 948</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L949"></a><tt class="py-lineno"> 949</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword spin_id:   The spin identification string (unused).</tt> </tt>
<a name="L950"></a><tt class="py-lineno"> 950</tt>  <tt class="py-line"><tt class="py-docstring">        @type spin_id:      None or str</tt> </tt>
<a name="L951"></a><tt class="py-lineno"> 951</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword verbosity: The amount of information to print.  The higher the value, the greater the verbosity.</tt> </tt>
<a name="L952"></a><tt class="py-lineno"> 952</tt>  <tt class="py-line"><tt class="py-docstring">        @type verbosity:    int</tt> </tt>
<a name="L953"></a><tt class="py-lineno"> 953</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword sim_index: The MC simulation index (unused).</tt> </tt>
<a name="L954"></a><tt class="py-lineno"> 954</tt>  <tt class="py-line"><tt class="py-docstring">        @type sim_index:    None</tt> </tt>
<a name="L955"></a><tt class="py-lineno"> 955</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L956"></a><tt class="py-lineno"> 956</tt>  <tt class="py-line"> </tt>
<a name="L957"></a><tt class="py-lineno"> 957</tt>  <tt class="py-line">        <tt class="py-comment"># Set up the target function for direct calculation.</tt> </tt>
<a name="L958"></a><tt class="py-lineno"> 958</tt>  <tt class="py-line">        <tt id="link-518" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model" class="py-name" href="#" onclick="return doclink('link-518', 'model', 'link-201');">model</a></tt><tt class="py-op">,</tt> <tt class="py-name">param_vector</tt><tt class="py-op">,</tt> <tt id="link-519" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-519', 'data_types', 'link-456');">data_types</a></tt><tt class="py-op">,</tt> <tt class="py-name">scaling_matrix</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-520" class="py-name" targets="Method specific_analyses.frame_order.Frame_order._target_fn_setup()=specific_analyses.frame_order.Frame_order-class.html#_target_fn_setup,Method specific_analyses.n_state_model.N_state_model._target_fn_setup()=specific_analyses.n_state_model.N_state_model-class.html#_target_fn_setup"><a title="specific_analyses.frame_order.Frame_order._target_fn_setup
specific_analyses.n_state_model.N_state_model._target_fn_setup" class="py-name" href="#" onclick="return doclink('link-520', '_target_fn_setup', 'link-520');">_target_fn_setup</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L959"></a><tt class="py-lineno"> 959</tt>  <tt class="py-line"> </tt>
<a name="L960"></a><tt class="py-lineno"> 960</tt>  <tt class="py-line">        <tt class="py-comment"># Calculate the chi-squared value.</tt> </tt>
<a name="L961"></a><tt class="py-lineno"> 961</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-521" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model" class="py-name" href="#" onclick="return doclink('link-521', 'model', 'link-201');">model</a></tt><tt class="py-op">:</tt> </tt>
<a name="L962"></a><tt class="py-lineno"> 962</tt>  <tt class="py-line">            <tt class="py-comment"># Make a function call.</tt> </tt>
<a name="L963"></a><tt class="py-lineno"> 963</tt>  <tt class="py-line">            <tt id="link-522" class="py-name" targets="Module target_functions.chi2=target_functions.chi2-module.html,Function target_functions.chi2.chi2()=target_functions.chi2-module.html#chi2"><a title="target_functions.chi2
target_functions.chi2.chi2" class="py-name" href="#" onclick="return doclink('link-522', 'chi2', 'link-522');">chi2</a></tt> <tt class="py-op">=</tt> <tt id="link-523" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model" class="py-name" href="#" onclick="return doclink('link-523', 'model', 'link-201');">model</a></tt><tt class="py-op">.</tt><tt id="link-524" class="py-name" targets="Method minfx.constraint_linear.Constraint_linear.func()=minfx.constraint_linear.Constraint_linear-class.html#func,Method target_functions.consistency_tests.Consistency.func()=target_functions.consistency_tests.Consistency-class.html#func,Method target_functions.ens_pivot_finder.Pivot_finder.func()=target_functions.ens_pivot_finder.Pivot_finder-class.html#func,Method target_functions.jw_mapping.Mapping.func()=target_functions.jw_mapping.Mapping-class.html#func,Function target_functions.relax_fit.func()=target_functions.relax_fit-module.html#func"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func
target_functions.relax_fit.func" class="py-name" href="#" onclick="return doclink('link-524', 'func', 'link-524');">func</a></tt><tt class="py-op">(</tt><tt class="py-name">param_vector</tt><tt class="py-op">)</tt> </tt>
<a name="L964"></a><tt class="py-lineno"> 964</tt>  <tt class="py-line"> </tt>
<a name="L965"></a><tt class="py-lineno"> 965</tt>  <tt class="py-line">            <tt class="py-comment"># Store the global chi-squared value.</tt> </tt>
<a name="L966"></a><tt class="py-lineno"> 966</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-525" class="py-name"><a title="target_functions.chi2
target_functions.chi2.chi2" class="py-name" href="#" onclick="return doclink('link-525', 'chi2', 'link-522');">chi2</a></tt> <tt class="py-op">=</tt> <tt id="link-526" class="py-name"><a title="target_functions.chi2
target_functions.chi2.chi2" class="py-name" href="#" onclick="return doclink('link-526', 'chi2', 'link-522');">chi2</a></tt> </tt>
<a name="L967"></a><tt class="py-lineno"> 967</tt>  <tt class="py-line"> </tt>
<a name="L968"></a><tt class="py-lineno"> 968</tt>  <tt class="py-line">            <tt class="py-comment"># Store the back-calculated data.</tt> </tt>
<a name="L969"></a><tt class="py-lineno"> 969</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-527" class="py-name" targets="Method specific_analyses.n_state_model.N_state_model._minimise_bc_data()=specific_analyses.n_state_model.N_state_model-class.html#_minimise_bc_data"><a title="specific_analyses.n_state_model.N_state_model._minimise_bc_data" class="py-name" href="#" onclick="return doclink('link-527', '_minimise_bc_data', 'link-527');">_minimise_bc_data</a></tt><tt class="py-op">(</tt><tt id="link-528" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model" class="py-name" href="#" onclick="return doclink('link-528', 'model', 'link-201');">model</a></tt><tt class="py-op">)</tt> </tt>
<a name="L970"></a><tt class="py-lineno"> 970</tt>  <tt class="py-line"> </tt>
<a name="L971"></a><tt class="py-lineno"> 971</tt>  <tt class="py-line">            <tt class="py-comment"># Calculate the RDC Q-factors.</tt> </tt>
<a name="L972"></a><tt class="py-lineno"> 972</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-string">'rdc'</tt> <tt class="py-keyword">in</tt> <tt id="link-529" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-529', 'data_types', 'link-456');">data_types</a></tt><tt class="py-op">:</tt> </tt>
<a name="L973"></a><tt class="py-lineno"> 973</tt>  <tt class="py-line">                <tt id="link-530" class="py-name"><a title="lib.alignment.rdc
pipe_control.rdc
test_suite.system_tests.rdc
user_functions.rdc" class="py-name" href="#" onclick="return doclink('link-530', 'rdc', 'link-58');">rdc</a></tt><tt class="py-op">.</tt><tt id="link-531" class="py-name" targets="Function pipe_control.pcs.q_factors()=pipe_control.pcs-module.html#q_factors,Function pipe_control.rdc.q_factors()=pipe_control.rdc-module.html#q_factors"><a title="pipe_control.pcs.q_factors
pipe_control.rdc.q_factors" class="py-name" href="#" onclick="return doclink('link-531', 'q_factors', 'link-531');">q_factors</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L974"></a><tt class="py-lineno"> 974</tt>  <tt class="py-line"> </tt>
<a name="L975"></a><tt class="py-lineno"> 975</tt>  <tt class="py-line">            <tt class="py-comment"># Calculate the PCS Q-factors.</tt> </tt>
<a name="L976"></a><tt class="py-lineno"> 976</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-string">'pcs'</tt> <tt class="py-keyword">in</tt> <tt id="link-532" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-532', 'data_types', 'link-456');">data_types</a></tt><tt class="py-op">:</tt> </tt>
<a name="L977"></a><tt class="py-lineno"> 977</tt>  <tt class="py-line">                <tt id="link-533" class="py-name"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-533', 'pcs', 'link-56');">pcs</a></tt><tt class="py-op">.</tt><tt id="link-534" class="py-name"><a title="pipe_control.pcs.q_factors
pipe_control.rdc.q_factors" class="py-name" href="#" onclick="return doclink('link-534', 'q_factors', 'link-531');">q_factors</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L978"></a><tt class="py-lineno"> 978</tt>  <tt class="py-line"> </tt>
<a name="L979"></a><tt class="py-lineno"> 979</tt>  <tt class="py-line">        <tt class="py-comment"># NOE potential.</tt> </tt>
<a name="L980"></a><tt class="py-lineno"> 980</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'noe_restraints'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L981"></a><tt class="py-lineno"> 981</tt>  <tt class="py-line">            <tt class="py-comment"># Init some numpy arrays.</tt> </tt>
<a name="L982"></a><tt class="py-lineno"> 982</tt>  <tt class="py-line">            <tt class="py-name">num_restraints</tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-535" class="py-name" targets="Module test_suite.system_tests.noe_restraints=test_suite.system_tests.noe_restraints-module.html"><a title="test_suite.system_tests.noe_restraints" class="py-name" href="#" onclick="return doclink('link-535', 'noe_restraints', 'link-535');">noe_restraints</a></tt><tt class="py-op">)</tt> </tt>
<a name="L983"></a><tt class="py-lineno"> 983</tt>  <tt class="py-line">            <tt class="py-name">dist</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">num_restraints</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L984"></a><tt class="py-lineno"> 984</tt>  <tt class="py-line">            <tt class="py-name">pot</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">num_restraints</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L985"></a><tt class="py-lineno"> 985</tt>  <tt class="py-line">            <tt class="py-name">lower</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">num_restraints</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L986"></a><tt class="py-lineno"> 986</tt>  <tt class="py-line">            <tt class="py-name">upper</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">num_restraints</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L987"></a><tt class="py-lineno"> 987</tt>  <tt class="py-line"> </tt>
<a name="L988"></a><tt class="py-lineno"> 988</tt>  <tt class="py-line">            <tt class="py-comment"># Loop over the NOEs.</tt> </tt>
<a name="L989"></a><tt class="py-lineno"> 989</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-536" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-536', 'i', 'link-189');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">num_restraints</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L990"></a><tt class="py-lineno"> 990</tt>  <tt class="py-line">                <tt class="py-comment"># Create arrays of the NOEs.</tt> </tt>
<a name="L991"></a><tt class="py-lineno"> 991</tt>  <tt class="py-line">                <tt class="py-name">lower</tt><tt class="py-op">[</tt><tt id="link-537" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-537', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-538" class="py-name"><a title="test_suite.system_tests.noe_restraints" class="py-name" href="#" onclick="return doclink('link-538', 'noe_restraints', 'link-535');">noe_restraints</a></tt><tt class="py-op">[</tt><tt id="link-539" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-539', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt> </tt>
<a name="L992"></a><tt class="py-lineno"> 992</tt>  <tt class="py-line">                <tt class="py-name">upper</tt><tt class="py-op">[</tt><tt id="link-540" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-540', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-541" class="py-name"><a title="test_suite.system_tests.noe_restraints" class="py-name" href="#" onclick="return doclink('link-541', 'noe_restraints', 'link-535');">noe_restraints</a></tt><tt class="py-op">[</tt><tt id="link-542" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-542', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">3</tt><tt class="py-op">]</tt> </tt>
<a name="L993"></a><tt class="py-lineno"> 993</tt>  <tt class="py-line"> </tt>
<a name="L994"></a><tt class="py-lineno"> 994</tt>  <tt class="py-line">                <tt class="py-comment"># Calculate the average distances, using -6 power averaging.</tt> </tt>
<a name="L995"></a><tt class="py-lineno"> 995</tt>  <tt class="py-line">                <tt class="py-name">dist</tt><tt class="py-op">[</tt><tt id="link-543" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-543', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-544" class="py-name"><a title="specific_analyses.n_state_model.data.calc_ave_dist" class="py-name" href="#" onclick="return doclink('link-544', 'calc_ave_dist', 'link-83');">calc_ave_dist</a></tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-545" class="py-name"><a title="test_suite.system_tests.noe_restraints" class="py-name" href="#" onclick="return doclink('link-545', 'noe_restraints', 'link-535');">noe_restraints</a></tt><tt class="py-op">[</tt><tt id="link-546" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-546', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-547" class="py-name"><a title="test_suite.system_tests.noe_restraints" class="py-name" href="#" onclick="return doclink('link-547', 'noe_restraints', 'link-535');">noe_restraints</a></tt><tt class="py-op">[</tt><tt id="link-548" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-548', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">exp</tt><tt class="py-op">=</tt><tt class="py-op">-</tt><tt class="py-number">6</tt><tt class="py-op">)</tt> </tt>
<a name="L996"></a><tt class="py-lineno"> 996</tt>  <tt class="py-line"> </tt>
<a name="L997"></a><tt class="py-lineno"> 997</tt>  <tt class="py-line">            <tt class="py-comment"># Calculate the quadratic potential.</tt> </tt>
<a name="L998"></a><tt class="py-lineno"> 998</tt>  <tt class="py-line">            <tt id="link-549" class="py-name"><a title="target_functions.potential.quad_pot" class="py-name" href="#" onclick="return doclink('link-549', 'quad_pot', 'link-105');">quad_pot</a></tt><tt class="py-op">(</tt><tt class="py-name">dist</tt><tt class="py-op">,</tt> <tt class="py-name">pot</tt><tt class="py-op">,</tt> <tt class="py-name">lower</tt><tt class="py-op">,</tt> <tt class="py-name">upper</tt><tt class="py-op">)</tt> </tt>
<a name="L999"></a><tt class="py-lineno"> 999</tt>  <tt class="py-line"> </tt>
<a name="L1000"></a><tt class="py-lineno">1000</tt>  <tt class="py-line">            <tt class="py-comment"># Store the distance and potential information.</tt> </tt>
<a name="L1001"></a><tt class="py-lineno">1001</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">ave_dist</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L1002"></a><tt class="py-lineno">1002</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-550" class="py-name"><a title="target_functions.potential.quad_pot" class="py-name" href="#" onclick="return doclink('link-550', 'quad_pot', 'link-105');">quad_pot</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L1003"></a><tt class="py-lineno">1003</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-551" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-551', 'i', 'link-189');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">num_restraints</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1004"></a><tt class="py-lineno">1004</tt>  <tt class="py-line">                <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">ave_dist</tt><tt class="py-op">.</tt><tt id="link-552" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-552', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-553" class="py-name"><a title="test_suite.system_tests.noe_restraints" class="py-name" href="#" onclick="return doclink('link-553', 'noe_restraints', 'link-535');">noe_restraints</a></tt><tt class="py-op">[</tt><tt id="link-554" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-554', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-555" class="py-name"><a title="test_suite.system_tests.noe_restraints" class="py-name" href="#" onclick="return doclink('link-555', 'noe_restraints', 'link-535');">noe_restraints</a></tt><tt class="py-op">[</tt><tt id="link-556" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-556', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">dist</tt><tt class="py-op">[</tt><tt id="link-557" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-557', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1005"></a><tt class="py-lineno">1005</tt>  <tt class="py-line">                <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-558" class="py-name"><a title="target_functions.potential.quad_pot" class="py-name" href="#" onclick="return doclink('link-558', 'quad_pot', 'link-105');">quad_pot</a></tt><tt class="py-op">.</tt><tt id="link-559" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-559', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-560" class="py-name"><a title="test_suite.system_tests.noe_restraints" class="py-name" href="#" onclick="return doclink('link-560', 'noe_restraints', 'link-535');">noe_restraints</a></tt><tt class="py-op">[</tt><tt id="link-561" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-561', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-562" class="py-name"><a title="test_suite.system_tests.noe_restraints" class="py-name" href="#" onclick="return doclink('link-562', 'noe_restraints', 'link-535');">noe_restraints</a></tt><tt class="py-op">[</tt><tt id="link-563" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-563', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">pot</tt><tt class="py-op">[</tt><tt id="link-564" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-564', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
</div><a name="L1006"></a><tt class="py-lineno">1006</tt>  <tt class="py-line"> </tt>
<a name="L1007"></a><tt class="py-lineno">1007</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.create_mc_data"></a><div id="N_state_model.create_mc_data-def"><a name="L1008"></a><tt class="py-lineno">1008</tt> <a class="py-toggle" href="#" id="N_state_model.create_mc_data-toggle" onclick="return toggle('N_state_model.create_mc_data');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#create_mc_data">create_mc_data</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">data_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.create_mc_data-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model.create_mc_data-expanded"><a name="L1009"></a><tt class="py-lineno">1009</tt>  <tt class="py-line">        <tt class="py-docstring">"""Create the Monte Carlo data by back-calculation.</tt> </tt>
<a name="L1010"></a><tt class="py-lineno">1010</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1011"></a><tt class="py-lineno">1011</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword data_id:   The list of spin ID, data type, and alignment ID, as yielded by the base_data_loop() generator method.</tt> </tt>
<a name="L1012"></a><tt class="py-lineno">1012</tt>  <tt class="py-line"><tt class="py-docstring">        @type data_id:      str</tt> </tt>
<a name="L1013"></a><tt class="py-lineno">1013</tt>  <tt class="py-line"><tt class="py-docstring">        @return:            The Monte Carlo Ri data.</tt> </tt>
<a name="L1014"></a><tt class="py-lineno">1014</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:             list of floats</tt> </tt>
<a name="L1015"></a><tt class="py-lineno">1015</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L1016"></a><tt class="py-lineno">1016</tt>  <tt class="py-line"> </tt>
<a name="L1017"></a><tt class="py-lineno">1017</tt>  <tt class="py-line">        <tt class="py-comment"># Initialise the MC data structure.</tt> </tt>
<a name="L1018"></a><tt class="py-lineno">1018</tt>  <tt class="py-line">        <tt class="py-name">mc_data</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L1019"></a><tt class="py-lineno">1019</tt>  <tt class="py-line"> </tt>
<a name="L1020"></a><tt class="py-lineno">1020</tt>  <tt class="py-line">        <tt class="py-comment"># Alias the spin or interatomic data container.</tt> </tt>
<a name="L1021"></a><tt class="py-lineno">1021</tt>  <tt class="py-line">        <tt id="link-565" class="py-name" targets="Module test_suite.unit_tests._prompt.container=test_suite.unit_tests._prompt.container-module.html"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-565', 'container', 'link-565');">container</a></tt> <tt class="py-op">=</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L1022"></a><tt class="py-lineno">1022</tt>  <tt class="py-line"> </tt>
<a name="L1023"></a><tt class="py-lineno">1023</tt>  <tt class="py-line">        <tt class="py-comment"># RDC data.</tt> </tt>
<a name="L1024"></a><tt class="py-lineno">1024</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'rdc'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-566" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-566', 'container', 'link-565');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'rdc'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1025"></a><tt class="py-lineno">1025</tt>  <tt class="py-line">            <tt class="py-comment"># Does back-calculated data exist?</tt> </tt>
<a name="L1026"></a><tt class="py-lineno">1026</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-567" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-567', 'container', 'link-565');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'rdc_bc'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1027"></a><tt class="py-lineno">1027</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-568" class="py-name" targets="Method specific_analyses.api_base.API_base.calculate()=specific_analyses.api_base.API_base-class.html#calculate,Method specific_analyses.consistency_tests.Consistency_tests.calculate()=specific_analyses.consistency_tests.Consistency_tests-class.html#calculate,Method specific_analyses.frame_order.Frame_order.calculate()=specific_analyses.frame_order.Frame_order-class.html#calculate,Method specific_analyses.jw_mapping.Jw_mapping.calculate()=specific_analyses.jw_mapping.Jw_mapping-class.html#calculate,Method specific_analyses.model_free.mf_minimise.Mf_minimise.calculate()=specific_analyses.model_free.mf_minimise.Mf_minimise-class.html#calculate,Method specific_analyses.n_state_model.N_state_model.calculate()=specific_analyses.n_state_model.N_state_model-class.html#calculate,Method specific_analyses.noe.main.Noe_main.calculate()=specific_analyses.noe.main.Noe_main-class.html#calculate"><a title="specific_analyses.api_base.API_base.calculate
specific_analyses.consistency_tests.Consistency_tests.calculate
specific_analyses.frame_order.Frame_order.calculate
specific_analyses.jw_mapping.Jw_mapping.calculate
specific_analyses.model_free.mf_minimise.Mf_minimise.calculate
specific_analyses.n_state_model.N_state_model.calculate
specific_analyses.noe.main.Noe_main.calculate" class="py-name" href="#" onclick="return doclink('link-568', 'calculate', 'link-568');">calculate</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1028"></a><tt class="py-lineno">1028</tt>  <tt class="py-line"> </tt>
<a name="L1029"></a><tt class="py-lineno">1029</tt>  <tt class="py-line">            <tt class="py-comment"># The data.</tt> </tt>
<a name="L1030"></a><tt class="py-lineno">1030</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-569" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-569', 'container', 'link-565');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'rdc_bc'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt> <tt class="py-keyword">in</tt> <tt id="link-570" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-570', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_bc</tt><tt class="py-op">:</tt> </tt>
<a name="L1031"></a><tt class="py-lineno">1031</tt>  <tt class="py-line">                <tt id="link-571" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-571', 'data', 'link-81');">data</a></tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L1032"></a><tt class="py-lineno">1032</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1033"></a><tt class="py-lineno">1033</tt>  <tt class="py-line">                <tt id="link-572" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-572', 'data', 'link-81');">data</a></tt> <tt class="py-op">=</tt> <tt id="link-573" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-573', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_bc</tt><tt class="py-op">[</tt><tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">]</tt> </tt>
<a name="L1034"></a><tt class="py-lineno">1034</tt>  <tt class="py-line"> </tt>
<a name="L1035"></a><tt class="py-lineno">1035</tt>  <tt class="py-line">            <tt class="py-comment"># Append the data.</tt> </tt>
<a name="L1036"></a><tt class="py-lineno">1036</tt>  <tt class="py-line">            <tt class="py-name">mc_data</tt><tt class="py-op">.</tt><tt id="link-574" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-574', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt id="link-575" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-575', 'data', 'link-81');">data</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1037"></a><tt class="py-lineno">1037</tt>  <tt class="py-line"> </tt>
<a name="L1038"></a><tt class="py-lineno">1038</tt>  <tt class="py-line">        <tt class="py-comment"># NOESY data.</tt> </tt>
<a name="L1039"></a><tt class="py-lineno">1039</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'noesy'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-576" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-576', 'container', 'link-565');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'noesy'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1040"></a><tt class="py-lineno">1040</tt>  <tt class="py-line">            <tt class="py-comment"># Does back-calculated data exist?</tt> </tt>
<a name="L1041"></a><tt class="py-lineno">1041</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-577" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-577', 'container', 'link-565');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'noesy_bc'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1042"></a><tt class="py-lineno">1042</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-578" class="py-name"><a title="specific_analyses.api_base.API_base.calculate
specific_analyses.consistency_tests.Consistency_tests.calculate
specific_analyses.frame_order.Frame_order.calculate
specific_analyses.jw_mapping.Jw_mapping.calculate
specific_analyses.model_free.mf_minimise.Mf_minimise.calculate
specific_analyses.n_state_model.N_state_model.calculate
specific_analyses.noe.main.Noe_main.calculate" class="py-name" href="#" onclick="return doclink('link-578', 'calculate', 'link-568');">calculate</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1043"></a><tt class="py-lineno">1043</tt>  <tt class="py-line"> </tt>
<a name="L1044"></a><tt class="py-lineno">1044</tt>  <tt class="py-line">            <tt class="py-comment"># Append the data.</tt> </tt>
<a name="L1045"></a><tt class="py-lineno">1045</tt>  <tt class="py-line">            <tt class="py-name">mc_data</tt><tt class="py-op">.</tt><tt id="link-579" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-579', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt id="link-580" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-580', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">noesy_bc</tt><tt class="py-op">)</tt> </tt>
<a name="L1046"></a><tt class="py-lineno">1046</tt>  <tt class="py-line"> </tt>
<a name="L1047"></a><tt class="py-lineno">1047</tt>  <tt class="py-line">        <tt class="py-comment"># PCS data.</tt> </tt>
<a name="L1048"></a><tt class="py-lineno">1048</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'pcs'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-581" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-581', 'container', 'link-565');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1049"></a><tt class="py-lineno">1049</tt>  <tt class="py-line">            <tt class="py-comment"># Does back-calculated data exist?</tt> </tt>
<a name="L1050"></a><tt class="py-lineno">1050</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-582" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-582', 'container', 'link-565');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_bc'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1051"></a><tt class="py-lineno">1051</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-583" class="py-name"><a title="specific_analyses.api_base.API_base.calculate
specific_analyses.consistency_tests.Consistency_tests.calculate
specific_analyses.frame_order.Frame_order.calculate
specific_analyses.jw_mapping.Jw_mapping.calculate
specific_analyses.model_free.mf_minimise.Mf_minimise.calculate
specific_analyses.n_state_model.N_state_model.calculate
specific_analyses.noe.main.Noe_main.calculate" class="py-name" href="#" onclick="return doclink('link-583', 'calculate', 'link-568');">calculate</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1052"></a><tt class="py-lineno">1052</tt>  <tt class="py-line"> </tt>
<a name="L1053"></a><tt class="py-lineno">1053</tt>  <tt class="py-line">            <tt class="py-comment"># The data.</tt> </tt>
<a name="L1054"></a><tt class="py-lineno">1054</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-584" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-584', 'container', 'link-565');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_bc'</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt> <tt class="py-keyword">in</tt> <tt id="link-585" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-585', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_bc</tt><tt class="py-op">:</tt> </tt>
<a name="L1055"></a><tt class="py-lineno">1055</tt>  <tt class="py-line">                <tt id="link-586" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-586', 'data', 'link-81');">data</a></tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L1056"></a><tt class="py-lineno">1056</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1057"></a><tt class="py-lineno">1057</tt>  <tt class="py-line">                <tt id="link-587" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-587', 'data', 'link-81');">data</a></tt> <tt class="py-op">=</tt> <tt id="link-588" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-588', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_bc</tt><tt class="py-op">[</tt><tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">]</tt> </tt>
<a name="L1058"></a><tt class="py-lineno">1058</tt>  <tt class="py-line"> </tt>
<a name="L1059"></a><tt class="py-lineno">1059</tt>  <tt class="py-line">            <tt class="py-comment"># Append the data.</tt> </tt>
<a name="L1060"></a><tt class="py-lineno">1060</tt>  <tt class="py-line">            <tt class="py-name">mc_data</tt><tt class="py-op">.</tt><tt id="link-589" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-589', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt id="link-590" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-590', 'data', 'link-81');">data</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1061"></a><tt class="py-lineno">1061</tt>  <tt class="py-line"> </tt>
<a name="L1062"></a><tt class="py-lineno">1062</tt>  <tt class="py-line">        <tt class="py-comment"># Return the data.</tt> </tt>
<a name="L1063"></a><tt class="py-lineno">1063</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">mc_data</tt> </tt>
</div><a name="L1064"></a><tt class="py-lineno">1064</tt>  <tt class="py-line"> </tt>
<a name="L1065"></a><tt class="py-lineno">1065</tt>  <tt class="py-line"> </tt>
<a name="L1066"></a><tt class="py-lineno">1066</tt>  <tt class="py-line">    <tt id="link-591" class="py-name" targets="Variable specific_analyses.api_base.API_base.default_value_doc=specific_analyses.api_base.API_base-class.html#default_value_doc,Variable specific_analyses.consistency_tests.Consistency_tests.default_value_doc=specific_analyses.consistency_tests.Consistency_tests-class.html#default_value_doc,Variable specific_analyses.jw_mapping.Jw_mapping.default_value_doc=specific_analyses.jw_mapping.Jw_mapping-class.html#default_value_doc,Variable specific_analyses.model_free.main.Model_free_main.default_value_doc=specific_analyses.model_free.main.Model_free_main-class.html#default_value_doc,Variable specific_analyses.n_state_model.N_state_model.default_value_doc=specific_analyses.n_state_model.N_state_model-class.html#default_value_doc,Variable specific_analyses.relax_fit.Relax_fit.default_value_doc=specific_analyses.relax_fit.Relax_fit-class.html#default_value_doc"><a title="specific_analyses.api_base.API_base.default_value_doc
specific_analyses.consistency_tests.Consistency_tests.default_value_doc
specific_analyses.jw_mapping.Jw_mapping.default_value_doc
specific_analyses.model_free.main.Model_free_main.default_value_doc
specific_analyses.n_state_model.N_state_model.default_value_doc
specific_analyses.relax_fit.Relax_fit.default_value_doc" class="py-name" href="#" onclick="return doclink('link-591', 'default_value_doc', 'link-591');">default_value_doc</a></tt> <tt class="py-op">=</tt> <tt id="link-592" class="py-name"><a title="user_functions.objects.Desc_container" class="py-name" href="#" onclick="return doclink('link-592', 'Desc_container', 'link-113');">Desc_container</a></tt><tt class="py-op">(</tt><tt class="py-string">"N-state model default values"</tt><tt class="py-op">)</tt> </tt>
<a name="L1067"></a><tt class="py-lineno">1067</tt>  <tt class="py-line">    <tt id="link-593" class="py-name" targets="Variable specific_analyses.consistency_tests.Consistency_tests._table=specific_analyses.consistency_tests.Consistency_tests-class.html#_table,Variable specific_analyses.jw_mapping.Jw_mapping._table=specific_analyses.jw_mapping.Jw_mapping-class.html#_table,Variable specific_analyses.model_free.main.Model_free_main._table=specific_analyses.model_free.main.Model_free_main-class.html#_table,Variable specific_analyses.n_state_model.N_state_model._table=specific_analyses.n_state_model.N_state_model-class.html#_table,Variable specific_analyses.noe.main.Noe_main._table=specific_analyses.noe.main.Noe_main-class.html#_table,Variable specific_analyses.relax_fit.Relax_fit._table=specific_analyses.relax_fit.Relax_fit-class.html#_table"><a title="specific_analyses.consistency_tests.Consistency_tests._table
specific_analyses.jw_mapping.Jw_mapping._table
specific_analyses.model_free.main.Model_free_main._table
specific_analyses.n_state_model.N_state_model._table
specific_analyses.noe.main.Noe_main._table
specific_analyses.relax_fit.Relax_fit._table" class="py-name" href="#" onclick="return doclink('link-593', '_table', 'link-593');">_table</a></tt> <tt class="py-op">=</tt> <tt id="link-594" class="py-name"><a title="colour.uf_tables
docs.latex.fetch_docstrings.uf_tables
gui.uf_objects.uf_tables
gui.wizards.peak_intensity.uf_tables
pipe_control.diffusion_tensor.uf_tables
pipe_control.minimise.uf_tables
pipe_control.selection.uf_tables
prompt.uf_docstring.uf_tables
specific_analyses.consistency_tests.uf_tables
specific_analyses.jw_mapping.uf_tables
specific_analyses.model_free.macro_base.uf_tables
specific_analyses.model_free.main.uf_tables
specific_analyses.n_state_model.uf_tables
specific_analyses.noe.main.uf_tables
specific_analyses.relax_fit.uf_tables
user_functions.dx.uf_tables
user_functions.minimisation.uf_tables
user_functions.spectrum.uf_tables
user_functions.structure.uf_tables
user_functions.value.uf_tables" class="py-name" href="#" onclick="return doclink('link-594', 'uf_tables', 'link-109');">uf_tables</a></tt><tt class="py-op">.</tt><tt id="link-595" class="py-name" targets="Method gui.pipe_editor.Pipe_editor.add_table()=gui.pipe_editor.Pipe_editor-class.html#add_table,Method user_functions.data.Uf_tables.add_table()=user_functions.data.Uf_tables-class.html#add_table,Method user_functions.objects.Desc_container.add_table()=user_functions.objects.Desc_container-class.html#add_table"><a title="gui.pipe_editor.Pipe_editor.add_table
user_functions.data.Uf_tables.add_table
user_functions.objects.Desc_container.add_table" class="py-name" href="#" onclick="return doclink('link-595', 'add_table', 'link-595');">add_table</a></tt><tt class="py-op">(</tt><tt id="link-596" class="py-name" targets="Variable bmrblib.assembly_supercategory.entity.EntitySaveframe.label=bmrblib.assembly_supercategory.entity.EntitySaveframe-class.html#label,Variable bmrblib.citations.citations.CitationsSaveframe.label=bmrblib.citations.citations.CitationsSaveframe-class.html#label,Variable bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.label=bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1-class.html#label,Variable bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.label=bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1-class.html#label,Variable bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.label=bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1-class.html#label,Variable bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.label=bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1-class.html#label,Variable bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.label=bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1-class.html#label,Variable gui.analyses.auto_noe.Auto_noe.label=gui.analyses.auto_noe.Auto_noe-class.html#label,Variable gui.analyses.auto_r1.Auto_r1.label=gui.analyses.auto_r1.Auto_r1-class.html#label,Variable gui.analyses.auto_r2.Auto_r2.label=gui.analyses.auto_r2.Auto_r2-class.html#label,Variable gui.analyses.auto_rx_base.Auto_rx.label=gui.analyses.auto_rx_base.Auto_rx-class.html#label"><a title="bmrblib.assembly_supercategory.entity.EntitySaveframe.label
bmrblib.citations.citations.CitationsSaveframe.label
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.label
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.label
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.label
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.label
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.label
gui.analyses.auto_noe.Auto_noe.label
gui.analyses.auto_r1.Auto_r1.label
gui.analyses.auto_r2.Auto_r2.label
gui.analyses.auto_rx_base.Auto_rx.label" class="py-name" href="#" onclick="return doclink('link-596', 'label', 'link-596');">label</a></tt><tt class="py-op">=</tt><tt class="py-string">"table: N-state default values"</tt><tt class="py-op">,</tt> <tt class="py-name">caption</tt><tt class="py-op">=</tt><tt class="py-string">"N-state model default values."</tt><tt class="py-op">)</tt> </tt>
<a name="L1068"></a><tt class="py-lineno">1068</tt>  <tt class="py-line">    <tt id="link-597" class="py-name"><a title="specific_analyses.consistency_tests.Consistency_tests._table
specific_analyses.jw_mapping.Jw_mapping._table
specific_analyses.model_free.main.Model_free_main._table
specific_analyses.n_state_model.N_state_model._table
specific_analyses.noe.main.Noe_main._table
specific_analyses.relax_fit.Relax_fit._table" class="py-name" href="#" onclick="return doclink('link-597', '_table', 'link-593');">_table</a></tt><tt class="py-op">.</tt><tt id="link-598" class="py-name" targets="Method user_functions.objects.Table.add_headings()=user_functions.objects.Table-class.html#add_headings"><a title="user_functions.objects.Table.add_headings" class="py-name" href="#" onclick="return doclink('link-598', 'add_headings', 'link-598');">add_headings</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-string">"Data type"</tt><tt class="py-op">,</tt> <tt class="py-string">"Object name"</tt><tt class="py-op">,</tt> <tt class="py-string">"Value"</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1069"></a><tt class="py-lineno">1069</tt>  <tt class="py-line">    <tt id="link-599" class="py-name"><a title="specific_analyses.consistency_tests.Consistency_tests._table
specific_analyses.jw_mapping.Jw_mapping._table
specific_analyses.model_free.main.Model_free_main._table
specific_analyses.n_state_model.N_state_model._table
specific_analyses.noe.main.Noe_main._table
specific_analyses.relax_fit.Relax_fit._table" class="py-name" href="#" onclick="return doclink('link-599', '_table', 'link-593');">_table</a></tt><tt class="py-op">.</tt><tt id="link-600" class="py-name" targets="Method user_functions.objects.Table.add_row()=user_functions.objects.Table-class.html#add_row"><a title="user_functions.objects.Table.add_row" class="py-name" href="#" onclick="return doclink('link-600', 'add_row', 'link-600');">add_row</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-string">"Probabilities"</tt><tt class="py-op">,</tt> <tt class="py-string">"'p0', 'p1', 'p2', ..., 'pN'"</tt><tt class="py-op">,</tt> <tt class="py-string">"1/N"</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1070"></a><tt class="py-lineno">1070</tt>  <tt class="py-line">    <tt id="link-601" class="py-name"><a title="specific_analyses.consistency_tests.Consistency_tests._table
specific_analyses.jw_mapping.Jw_mapping._table
specific_analyses.model_free.main.Model_free_main._table
specific_analyses.n_state_model.N_state_model._table
specific_analyses.noe.main.Noe_main._table
specific_analyses.relax_fit.Relax_fit._table" class="py-name" href="#" onclick="return doclink('link-601', '_table', 'link-593');">_table</a></tt><tt class="py-op">.</tt><tt id="link-602" class="py-name"><a title="user_functions.objects.Table.add_row" class="py-name" href="#" onclick="return doclink('link-602', 'add_row', 'link-600');">add_row</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-string">"Euler angle alpha"</tt><tt class="py-op">,</tt> <tt class="py-string">"'alpha0', 'alpha1', ..."</tt><tt class="py-op">,</tt> <tt class="py-string">"(c+1) * pi / (N+1)"</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1071"></a><tt class="py-lineno">1071</tt>  <tt class="py-line">    <tt id="link-603" class="py-name"><a title="specific_analyses.consistency_tests.Consistency_tests._table
specific_analyses.jw_mapping.Jw_mapping._table
specific_analyses.model_free.main.Model_free_main._table
specific_analyses.n_state_model.N_state_model._table
specific_analyses.noe.main.Noe_main._table
specific_analyses.relax_fit.Relax_fit._table" class="py-name" href="#" onclick="return doclink('link-603', '_table', 'link-593');">_table</a></tt><tt class="py-op">.</tt><tt id="link-604" class="py-name"><a title="user_functions.objects.Table.add_row" class="py-name" href="#" onclick="return doclink('link-604', 'add_row', 'link-600');">add_row</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-string">"Euler angle beta"</tt><tt class="py-op">,</tt> <tt class="py-string">"'beta0', 'beta1', ..."</tt><tt class="py-op">,</tt> <tt class="py-string">"(c+1) * pi / (N+1)"</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1072"></a><tt class="py-lineno">1072</tt>  <tt class="py-line">    <tt id="link-605" class="py-name"><a title="specific_analyses.consistency_tests.Consistency_tests._table
specific_analyses.jw_mapping.Jw_mapping._table
specific_analyses.model_free.main.Model_free_main._table
specific_analyses.n_state_model.N_state_model._table
specific_analyses.noe.main.Noe_main._table
specific_analyses.relax_fit.Relax_fit._table" class="py-name" href="#" onclick="return doclink('link-605', '_table', 'link-593');">_table</a></tt><tt class="py-op">.</tt><tt id="link-606" class="py-name"><a title="user_functions.objects.Table.add_row" class="py-name" href="#" onclick="return doclink('link-606', 'add_row', 'link-600');">add_row</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-string">"Euler angle gamma"</tt><tt class="py-op">,</tt> <tt class="py-string">"'gamma0', 'gamma1', ..."</tt><tt class="py-op">,</tt> <tt class="py-string">"(c+1) * pi / (N+1)"</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1073"></a><tt class="py-lineno">1073</tt>  <tt class="py-line">    <tt id="link-607" class="py-name"><a title="specific_analyses.api_base.API_base.default_value_doc
specific_analyses.consistency_tests.Consistency_tests.default_value_doc
specific_analyses.jw_mapping.Jw_mapping.default_value_doc
specific_analyses.model_free.main.Model_free_main.default_value_doc
specific_analyses.n_state_model.N_state_model.default_value_doc
specific_analyses.relax_fit.Relax_fit.default_value_doc" class="py-name" href="#" onclick="return doclink('link-607', 'default_value_doc', 'link-591');">default_value_doc</a></tt><tt class="py-op">.</tt><tt id="link-608" class="py-name"><a title="gui.pipe_editor.Pipe_editor.add_table
user_functions.data.Uf_tables.add_table
user_functions.objects.Desc_container.add_table" class="py-name" href="#" onclick="return doclink('link-608', 'add_table', 'link-595');">add_table</a></tt><tt class="py-op">(</tt><tt id="link-609" class="py-name"><a title="specific_analyses.consistency_tests.Consistency_tests._table
specific_analyses.jw_mapping.Jw_mapping._table
specific_analyses.model_free.main.Model_free_main._table
specific_analyses.n_state_model.N_state_model._table
specific_analyses.noe.main.Noe_main._table
specific_analyses.relax_fit.Relax_fit._table" class="py-name" href="#" onclick="return doclink('link-609', '_table', 'link-593');">_table</a></tt><tt class="py-op">.</tt><tt id="link-610" class="py-name"><a title="bmrblib.assembly_supercategory.entity.EntitySaveframe.label
bmrblib.citations.citations.CitationsSaveframe.label
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.label
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.label
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.label
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.label
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.label
gui.analyses.auto_noe.Auto_noe.label
gui.analyses.auto_r1.Auto_r1.label
gui.analyses.auto_r2.Auto_r2.label
gui.analyses.auto_rx_base.Auto_rx.label" class="py-name" href="#" onclick="return doclink('link-610', 'label', 'link-596');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1074"></a><tt class="py-lineno">1074</tt>  <tt class="py-line">    <tt id="link-611" class="py-name"><a title="specific_analyses.api_base.API_base.default_value_doc
specific_analyses.consistency_tests.Consistency_tests.default_value_doc
specific_analyses.jw_mapping.Jw_mapping.default_value_doc
specific_analyses.model_free.main.Model_free_main.default_value_doc
specific_analyses.n_state_model.N_state_model.default_value_doc
specific_analyses.relax_fit.Relax_fit.default_value_doc" class="py-name" href="#" onclick="return doclink('link-611', 'default_value_doc', 'link-591');">default_value_doc</a></tt><tt class="py-op">.</tt><tt id="link-612" class="py-name" targets="Method user_functions.objects.Desc_container.add_paragraph()=user_functions.objects.Desc_container-class.html#add_paragraph"><a title="user_functions.objects.Desc_container.add_paragraph" class="py-name" href="#" onclick="return doclink('link-612', 'add_paragraph', 'link-612');">add_paragraph</a></tt><tt class="py-op">(</tt><tt class="py-string">"In this table, N is the total number of states and c is the index of a given state ranging from 0 to N-1.  The default probabilities are all set to be equal whereas the angles are given a range of values so that no 2 states are equal at the start of optimisation."</tt><tt class="py-op">)</tt> </tt>
<a name="L1075"></a><tt class="py-lineno">1075</tt>  <tt class="py-line">    <tt id="link-613" class="py-name"><a title="specific_analyses.api_base.API_base.default_value_doc
specific_analyses.consistency_tests.Consistency_tests.default_value_doc
specific_analyses.jw_mapping.Jw_mapping.default_value_doc
specific_analyses.model_free.main.Model_free_main.default_value_doc
specific_analyses.n_state_model.N_state_model.default_value_doc
specific_analyses.relax_fit.Relax_fit.default_value_doc" class="py-name" href="#" onclick="return doclink('link-613', 'default_value_doc', 'link-591');">default_value_doc</a></tt><tt class="py-op">.</tt><tt id="link-614" class="py-name"><a title="user_functions.objects.Desc_container.add_paragraph" class="py-name" href="#" onclick="return doclink('link-614', 'add_paragraph', 'link-612');">add_paragraph</a></tt><tt class="py-op">(</tt><tt class="py-string">"Note that setting the probability for state N will do nothing as it is equal to one minus all the other probabilities."</tt><tt class="py-op">)</tt> </tt>
<a name="L1076"></a><tt class="py-lineno">1076</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.default_value"></a><div id="N_state_model.default_value-def"><a name="L1077"></a><tt class="py-lineno">1077</tt> <a class="py-toggle" href="#" id="N_state_model.default_value-toggle" onclick="return toggle('N_state_model.default_value');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#default_value">default_value</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">param</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.default_value-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model.default_value-expanded"><a name="L1078"></a><tt class="py-lineno">1078</tt>  <tt class="py-line">        <tt class="py-docstring">"""The default N-state model parameter values.</tt> </tt>
<a name="L1079"></a><tt class="py-lineno">1079</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1080"></a><tt class="py-lineno">1080</tt>  <tt class="py-line"><tt class="py-docstring">        @param param:   The N-state model parameter.</tt> </tt>
<a name="L1081"></a><tt class="py-lineno">1081</tt>  <tt class="py-line"><tt class="py-docstring">        @type param:    str</tt> </tt>
<a name="L1082"></a><tt class="py-lineno">1082</tt>  <tt class="py-line"><tt class="py-docstring">        @return:        The default value.</tt> </tt>
<a name="L1083"></a><tt class="py-lineno">1083</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:         float</tt> </tt>
<a name="L1084"></a><tt class="py-lineno">1084</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L1085"></a><tt class="py-lineno">1085</tt>  <tt class="py-line"> </tt>
<a name="L1086"></a><tt class="py-lineno">1086</tt>  <tt class="py-line">        <tt class="py-comment"># Split the parameter into its base name and index.</tt> </tt>
<a name="L1087"></a><tt class="py-lineno">1087</tt>  <tt class="py-line">        <tt id="link-615" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-615', 'name', 'link-158');">name</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-616" class="py-name" targets="Function pipe_control.align_tensor.return_data_name()=pipe_control.align_tensor-module.html#return_data_name,Function pipe_control.diffusion_tensor.return_data_name()=pipe_control.diffusion_tensor-module.html#return_data_name,Function pipe_control.minimise.return_data_name()=pipe_control.minimise-module.html#return_data_name,Method specific_analyses.api_base.API_base.return_data_name()=specific_analyses.api_base.API_base-class.html#return_data_name,Method specific_analyses.n_state_model.N_state_model.return_data_name()=specific_analyses.n_state_model.N_state_model-class.html#return_data_name"><a title="pipe_control.align_tensor.return_data_name
pipe_control.diffusion_tensor.return_data_name
pipe_control.minimise.return_data_name
specific_analyses.api_base.API_base.return_data_name
specific_analyses.n_state_model.N_state_model.return_data_name" class="py-name" href="#" onclick="return doclink('link-616', 'return_data_name', 'link-616');">return_data_name</a></tt><tt class="py-op">(</tt><tt class="py-name">param</tt><tt class="py-op">)</tt> </tt>
<a name="L1088"></a><tt class="py-lineno">1088</tt>  <tt class="py-line">        <tt class="py-name">index</tt> <tt class="py-op">=</tt> <tt id="link-617" class="py-name"><a title="specific_analyses.n_state_model.parameters.param_model_index" class="py-name" href="#" onclick="return doclink('link-617', 'param_model_index', 'link-97');">param_model_index</a></tt><tt class="py-op">(</tt><tt class="py-name">param</tt><tt class="py-op">)</tt> </tt>
<a name="L1089"></a><tt class="py-lineno">1089</tt>  <tt class="py-line"> </tt>
<a name="L1090"></a><tt class="py-lineno">1090</tt>  <tt class="py-line">        <tt class="py-comment"># The number of states as a float.</tt> </tt>
<a name="L1091"></a><tt class="py-lineno">1091</tt>  <tt class="py-line">        <tt class="py-name">N</tt> <tt class="py-op">=</tt> <tt id="link-618" class="py-name"><a title="lib.float" class="py-name" href="#" onclick="return doclink('link-618', 'float', 'link-20');">float</a></tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">N</tt><tt class="py-op">)</tt> </tt>
<a name="L1092"></a><tt class="py-lineno">1092</tt>  <tt class="py-line"> </tt>
<a name="L1093"></a><tt class="py-lineno">1093</tt>  <tt class="py-line">        <tt class="py-comment"># Probability.</tt> </tt>
<a name="L1094"></a><tt class="py-lineno">1094</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-619" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-619', 'name', 'link-158');">name</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'probs'</tt><tt class="py-op">:</tt> </tt>
<a name="L1095"></a><tt class="py-lineno">1095</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-number">1.0</tt> <tt class="py-op">/</tt> <tt class="py-name">N</tt> </tt>
<a name="L1096"></a><tt class="py-lineno">1096</tt>  <tt class="py-line"> </tt>
<a name="L1097"></a><tt class="py-lineno">1097</tt>  <tt class="py-line">        <tt class="py-comment"># Euler angles.</tt> </tt>
<a name="L1098"></a><tt class="py-lineno">1098</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt id="link-620" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-620', 'name', 'link-158');">name</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'alpha'</tt> <tt class="py-keyword">or</tt> <tt id="link-621" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-621', 'name', 'link-158');">name</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'beta'</tt> <tt class="py-keyword">or</tt> <tt id="link-622" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-622', 'name', 'link-158');">name</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'gamma'</tt><tt class="py-op">:</tt> </tt>
<a name="L1099"></a><tt class="py-lineno">1099</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-op">(</tt><tt id="link-623" class="py-name"><a title="lib.float" class="py-name" href="#" onclick="return doclink('link-623', 'float', 'link-20');">float</a></tt><tt class="py-op">(</tt><tt class="py-name">index</tt><tt class="py-op">)</tt><tt class="py-op">+</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> <tt class="py-op">*</tt> <tt class="py-name">pi</tt> <tt class="py-op">/</tt> <tt class="py-op">(</tt><tt class="py-name">N</tt><tt class="py-op">+</tt><tt class="py-number">1.0</tt><tt class="py-op">)</tt> </tt>
</div><a name="L1100"></a><tt class="py-lineno">1100</tt>  <tt class="py-line"> </tt>
<a name="L1101"></a><tt class="py-lineno">1101</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.grid_search"></a><div id="N_state_model.grid_search-def"><a name="L1102"></a><tt class="py-lineno">1102</tt> <a class="py-toggle" href="#" id="N_state_model.grid_search-toggle" onclick="return toggle('N_state_model.grid_search');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#grid_search">grid_search</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">lower</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">upper</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">inc</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">constraints</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">,</tt> <tt class="py-param">verbosity</tt><tt class="py-op">=</tt><tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-param">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.grid_search-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model.grid_search-expanded"><a name="L1103"></a><tt class="py-lineno">1103</tt>  <tt class="py-line">        <tt class="py-docstring">"""The grid search function.</tt> </tt>
<a name="L1104"></a><tt class="py-lineno">1104</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1105"></a><tt class="py-lineno">1105</tt>  <tt class="py-line"><tt class="py-docstring">        @param lower:       The lower bounds of the grid search which must be equal to the number of parameters in the model.</tt> </tt>
<a name="L1106"></a><tt class="py-lineno">1106</tt>  <tt class="py-line"><tt class="py-docstring">        @type lower:        array of numbers</tt> </tt>
<a name="L1107"></a><tt class="py-lineno">1107</tt>  <tt class="py-line"><tt class="py-docstring">        @param upper:       The upper bounds of the grid search which must be equal to the number of parameters in the model.</tt> </tt>
<a name="L1108"></a><tt class="py-lineno">1108</tt>  <tt class="py-line"><tt class="py-docstring">        @type upper:        array of numbers</tt> </tt>
<a name="L1109"></a><tt class="py-lineno">1109</tt>  <tt class="py-line"><tt class="py-docstring">        @param inc:         The increments for each dimension of the space for the grid search.  The number of elements in the array must equal to the number of parameters in the model.</tt> </tt>
<a name="L1110"></a><tt class="py-lineno">1110</tt>  <tt class="py-line"><tt class="py-docstring">        @type inc:          array of int</tt> </tt>
<a name="L1111"></a><tt class="py-lineno">1111</tt>  <tt class="py-line"><tt class="py-docstring">        @param constraints: If True, constraints are applied during the grid search (elinating parts of the grid).  If False, no constraints are used.</tt> </tt>
<a name="L1112"></a><tt class="py-lineno">1112</tt>  <tt class="py-line"><tt class="py-docstring">        @type constraints:  bool</tt> </tt>
<a name="L1113"></a><tt class="py-lineno">1113</tt>  <tt class="py-line"><tt class="py-docstring">        @param verbosity:   A flag specifying the amount of information to print.  The higher the value, the greater the verbosity.</tt> </tt>
<a name="L1114"></a><tt class="py-lineno">1114</tt>  <tt class="py-line"><tt class="py-docstring">        @type verbosity:    int</tt> </tt>
<a name="L1115"></a><tt class="py-lineno">1115</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L1116"></a><tt class="py-lineno">1116</tt>  <tt class="py-line"> </tt>
<a name="L1117"></a><tt class="py-lineno">1117</tt>  <tt class="py-line">        <tt class="py-comment"># Test if the N-state model has been set up.</tt> </tt>
<a name="L1118"></a><tt class="py-lineno">1118</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'model'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1119"></a><tt class="py-lineno">1119</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-624" class="py-name"><a title="lib.errors.RelaxNoModelError" class="py-name" href="#" onclick="return doclink('link-624', 'RelaxNoModelError', 'link-16');">RelaxNoModelError</a></tt><tt class="py-op">(</tt><tt class="py-string">'N-state'</tt><tt class="py-op">)</tt> </tt>
<a name="L1120"></a><tt class="py-lineno">1120</tt>  <tt class="py-line"> </tt>
<a name="L1121"></a><tt class="py-lineno">1121</tt>  <tt class="py-line">        <tt class="py-comment"># The number of parameters.</tt> </tt>
<a name="L1122"></a><tt class="py-lineno">1122</tt>  <tt class="py-line">        <tt class="py-name">n</tt> <tt class="py-op">=</tt> <tt id="link-625" class="py-name"><a title="specific_analyses.n_state_model.parameters.param_num" class="py-name" href="#" onclick="return doclink('link-625', 'param_num', 'link-98');">param_num</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1123"></a><tt class="py-lineno">1123</tt>  <tt class="py-line"> </tt>
<a name="L1124"></a><tt class="py-lineno">1124</tt>  <tt class="py-line">        <tt class="py-comment"># Make sure that the length of the parameter array is &gt; 0.</tt> </tt>
<a name="L1125"></a><tt class="py-lineno">1125</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">n</tt> <tt class="py-op">==</tt> <tt class="py-number">0</tt><tt class="py-op">:</tt> </tt>
<a name="L1126"></a><tt class="py-lineno">1126</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Cannot run a grid search on a model with zero parameters, skipping the grid search."</tt><tt class="py-op">)</tt> </tt>
<a name="L1127"></a><tt class="py-lineno">1127</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
<a name="L1128"></a><tt class="py-lineno">1128</tt>  <tt class="py-line"> </tt>
<a name="L1129"></a><tt class="py-lineno">1129</tt>  <tt class="py-line">        <tt class="py-comment"># Test the grid search options.</tt> </tt>
<a name="L1130"></a><tt class="py-lineno">1130</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-626" class="py-name"><a title="specific_analyses.api_base.API_base.test_grid_ops" class="py-name" href="#" onclick="return doclink('link-626', 'test_grid_ops', 'link-126');">test_grid_ops</a></tt><tt class="py-op">(</tt><tt class="py-name">lower</tt><tt class="py-op">=</tt><tt class="py-name">lower</tt><tt class="py-op">,</tt> <tt class="py-name">upper</tt><tt class="py-op">=</tt><tt class="py-name">upper</tt><tt class="py-op">,</tt> <tt class="py-name">inc</tt><tt class="py-op">=</tt><tt class="py-name">inc</tt><tt class="py-op">,</tt> <tt class="py-name">n</tt><tt class="py-op">=</tt><tt class="py-name">n</tt><tt class="py-op">)</tt> </tt>
<a name="L1131"></a><tt class="py-lineno">1131</tt>  <tt class="py-line"> </tt>
<a name="L1132"></a><tt class="py-lineno">1132</tt>  <tt class="py-line">        <tt class="py-comment"># If inc is a single int, convert it into an array of that value.</tt> </tt>
<a name="L1133"></a><tt class="py-lineno">1133</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">isinstance</tt><tt class="py-op">(</tt><tt class="py-name">inc</tt><tt class="py-op">,</tt> <tt class="py-name">int</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1134"></a><tt class="py-lineno">1134</tt>  <tt class="py-line">            <tt class="py-name">inc</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-name">inc</tt><tt class="py-op">]</tt><tt class="py-op">*</tt><tt class="py-name">n</tt> </tt>
<a name="L1135"></a><tt class="py-lineno">1135</tt>  <tt class="py-line"> </tt>
<a name="L1136"></a><tt class="py-lineno">1136</tt>  <tt class="py-line">        <tt class="py-comment"># Setup the default bounds.</tt> </tt>
<a name="L1137"></a><tt class="py-lineno">1137</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">lower</tt><tt class="py-op">:</tt> </tt>
<a name="L1138"></a><tt class="py-lineno">1138</tt>  <tt class="py-line">            <tt class="py-comment"># Init.</tt> </tt>
<a name="L1139"></a><tt class="py-lineno">1139</tt>  <tt class="py-line">            <tt class="py-name">lower</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L1140"></a><tt class="py-lineno">1140</tt>  <tt class="py-line">            <tt class="py-name">upper</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L1141"></a><tt class="py-lineno">1141</tt>  <tt class="py-line"> </tt>
<a name="L1142"></a><tt class="py-lineno">1142</tt>  <tt class="py-line">            <tt class="py-comment"># Loop over the parameters.</tt> </tt>
<a name="L1143"></a><tt class="py-lineno">1143</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-627" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-627', 'i', 'link-189');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">n</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1144"></a><tt class="py-lineno">1144</tt>  <tt class="py-line">                <tt class="py-comment"># i is in the parameter array.</tt> </tt>
<a name="L1145"></a><tt class="py-lineno">1145</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt id="link-628" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-628', 'i', 'link-189');">i</a></tt> <tt class="py-op">&lt;</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-629" class="py-name" targets="Variable gui.analyses.auto_model_free.Local_tm_list.params=gui.analyses.auto_model_free.Local_tm_list-class.html#params,Variable gui.analyses.auto_model_free.Mf_list.params=gui.analyses.auto_model_free.Mf_list-class.html#params,Variable gui.analyses.elements.model_list.Model_list.params=gui.analyses.elements.model_list.Model_list-class.html#params"><a title="gui.analyses.auto_model_free.Local_tm_list.params
gui.analyses.auto_model_free.Mf_list.params
gui.analyses.elements.model_list.Model_list.params" class="py-name" href="#" onclick="return doclink('link-629', 'params', 'link-629');">params</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1146"></a><tt class="py-lineno">1146</tt>  <tt class="py-line">                    <tt class="py-comment"># Probabilities (default values).</tt> </tt>
<a name="L1147"></a><tt class="py-lineno">1147</tt>  <tt class="py-line">                    <tt class="py-keyword">if</tt> <tt id="link-630" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-630', 'search', 'link-7');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'^p'</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-631" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.params
gui.analyses.auto_model_free.Mf_list.params
gui.analyses.elements.model_list.Model_list.params" class="py-name" href="#" onclick="return doclink('link-631', 'params', 'link-629');">params</a></tt><tt class="py-op">[</tt><tt id="link-632" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-632', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1148"></a><tt class="py-lineno">1148</tt>  <tt class="py-line">                        <tt class="py-name">lower</tt><tt class="py-op">.</tt><tt id="link-633" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-633', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-number">0.0</tt><tt class="py-op">)</tt> </tt>
<a name="L1149"></a><tt class="py-lineno">1149</tt>  <tt class="py-line">                        <tt class="py-name">upper</tt><tt class="py-op">.</tt><tt id="link-634" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-634', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-number">1.0</tt><tt class="py-op">)</tt> </tt>
<a name="L1150"></a><tt class="py-lineno">1150</tt>  <tt class="py-line"> </tt>
<a name="L1151"></a><tt class="py-lineno">1151</tt>  <tt class="py-line">                    <tt class="py-comment"># Angles (default values).</tt> </tt>
<a name="L1152"></a><tt class="py-lineno">1152</tt>  <tt class="py-line">                    <tt class="py-keyword">if</tt> <tt id="link-635" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-635', 'search', 'link-7');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'^alpha'</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-636" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.params
gui.analyses.auto_model_free.Mf_list.params
gui.analyses.elements.model_list.Model_list.params" class="py-name" href="#" onclick="return doclink('link-636', 'params', 'link-629');">params</a></tt><tt class="py-op">[</tt><tt id="link-637" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-637', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt id="link-638" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-638', 'search', 'link-7');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'^gamma'</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-639" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.params
gui.analyses.auto_model_free.Mf_list.params
gui.analyses.elements.model_list.Model_list.params" class="py-name" href="#" onclick="return doclink('link-639', 'params', 'link-629');">params</a></tt><tt class="py-op">[</tt><tt id="link-640" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-640', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1153"></a><tt class="py-lineno">1153</tt>  <tt class="py-line">                        <tt class="py-name">lower</tt><tt class="py-op">.</tt><tt id="link-641" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-641', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-number">0.0</tt><tt class="py-op">)</tt> </tt>
<a name="L1154"></a><tt class="py-lineno">1154</tt>  <tt class="py-line">                        <tt class="py-name">upper</tt><tt class="py-op">.</tt><tt id="link-642" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-642', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-number">2</tt><tt class="py-op">*</tt><tt class="py-name">pi</tt><tt class="py-op">)</tt> </tt>
<a name="L1155"></a><tt class="py-lineno">1155</tt>  <tt class="py-line">                    <tt class="py-keyword">elif</tt> <tt id="link-643" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-643', 'search', 'link-7');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'^beta'</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-644" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.params
gui.analyses.auto_model_free.Mf_list.params
gui.analyses.elements.model_list.Model_list.params" class="py-name" href="#" onclick="return doclink('link-644', 'params', 'link-629');">params</a></tt><tt class="py-op">[</tt><tt id="link-645" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-645', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1156"></a><tt class="py-lineno">1156</tt>  <tt class="py-line">                        <tt class="py-name">lower</tt><tt class="py-op">.</tt><tt id="link-646" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-646', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-number">0.0</tt><tt class="py-op">)</tt> </tt>
<a name="L1157"></a><tt class="py-lineno">1157</tt>  <tt class="py-line">                        <tt class="py-name">upper</tt><tt class="py-op">.</tt><tt id="link-647" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-647', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">pi</tt><tt class="py-op">)</tt> </tt>
<a name="L1158"></a><tt class="py-lineno">1158</tt>  <tt class="py-line"> </tt>
<a name="L1159"></a><tt class="py-lineno">1159</tt>  <tt class="py-line">                <tt class="py-comment"># The paramagnetic centre.</tt> </tt>
<a name="L1160"></a><tt class="py-lineno">1160</tt>  <tt class="py-line">                <tt class="py-keyword">elif</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'paramag_centre_fixed'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramag_centre_fixed</tt> <tt class="py-keyword">and</tt> <tt class="py-op">(</tt><tt class="py-name">n</tt> <tt class="py-op">-</tt> <tt id="link-648" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-648', 'i', 'link-189');">i</a></tt><tt class="py-op">)</tt> <tt class="py-op">&lt;=</tt> <tt class="py-number">3</tt><tt class="py-op">:</tt> </tt>
<a name="L1161"></a><tt class="py-lineno">1161</tt>  <tt class="py-line">                    <tt class="py-name">lower</tt><tt class="py-op">.</tt><tt id="link-649" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-649', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">-</tt><tt class="py-number">100</tt><tt class="py-op">)</tt> </tt>
<a name="L1162"></a><tt class="py-lineno">1162</tt>  <tt class="py-line">                    <tt class="py-name">upper</tt><tt class="py-op">.</tt><tt id="link-650" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-650', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-number">100</tt><tt class="py-op">)</tt> </tt>
<a name="L1163"></a><tt class="py-lineno">1163</tt>  <tt class="py-line"> </tt>
<a name="L1164"></a><tt class="py-lineno">1164</tt>  <tt class="py-line">                <tt class="py-comment"># Otherwise this must be an alignment tensor component.</tt> </tt>
<a name="L1165"></a><tt class="py-lineno">1165</tt>  <tt class="py-line">                <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1166"></a><tt class="py-lineno">1166</tt>  <tt class="py-line">                    <tt class="py-name">lower</tt><tt class="py-op">.</tt><tt id="link-651" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-651', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-op">-</tt><tt class="py-number">1e-3</tt><tt class="py-op">)</tt> </tt>
<a name="L1167"></a><tt class="py-lineno">1167</tt>  <tt class="py-line">                    <tt class="py-name">upper</tt><tt class="py-op">.</tt><tt id="link-652" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-652', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-number">1e-3</tt><tt class="py-op">)</tt> </tt>
<a name="L1168"></a><tt class="py-lineno">1168</tt>  <tt class="py-line"> </tt>
<a name="L1169"></a><tt class="py-lineno">1169</tt>  <tt class="py-line">        <tt class="py-comment"># Determine the data type.</tt> </tt>
<a name="L1170"></a><tt class="py-lineno">1170</tt>  <tt class="py-line">        <tt id="link-653" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-653', 'data_types', 'link-456');">data_types</a></tt> <tt class="py-op">=</tt> <tt id="link-654" class="py-name"><a title="specific_analyses.n_state_model.data.base_data_types" class="py-name" href="#" onclick="return doclink('link-654', 'base_data_types', 'link-82');">base_data_types</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1171"></a><tt class="py-lineno">1171</tt>  <tt class="py-line"> </tt>
<a name="L1172"></a><tt class="py-lineno">1172</tt>  <tt class="py-line">        <tt class="py-comment"># The number of tensors to optimise.</tt> </tt>
<a name="L1173"></a><tt class="py-lineno">1173</tt>  <tt class="py-line">        <tt class="py-name">tensor_num</tt> <tt class="py-op">=</tt> <tt id="link-655" class="py-name"><a title="data_store.align_tensor
pipe_control.align_tensor
test_suite.system_tests.align_tensor
user_functions.align_tensor" class="py-name" href="#" onclick="return doclink('link-655', 'align_tensor', 'link-55');">align_tensor</a></tt><tt class="py-op">.</tt><tt id="link-656" class="py-name"><a title="pipe_control.align_tensor.num_tensors" class="py-name" href="#" onclick="return doclink('link-656', 'num_tensors', 'link-438');">num_tensors</a></tt><tt class="py-op">(</tt><tt class="py-name">skip_fixed</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L1174"></a><tt class="py-lineno">1174</tt>  <tt class="py-line"> </tt>
<a name="L1175"></a><tt class="py-lineno">1175</tt>  <tt class="py-line">        <tt class="py-comment"># Custom sub-grid search for when only tensors are optimised (as each tensor is independent, the number of points collapses from inc**(5*N) to N*inc**5).</tt> </tt>
<a name="L1176"></a><tt class="py-lineno">1176</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-657" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model" class="py-name" href="#" onclick="return doclink('link-657', 'model', 'link-201');">model</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'fixed'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">tensor_num</tt> <tt class="py-op">&gt;</tt> <tt class="py-number">1</tt> <tt class="py-keyword">and</tt> <tt class="py-op">(</tt><tt class="py-string">'rdc'</tt> <tt class="py-keyword">in</tt> <tt id="link-658" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-658', 'data_types', 'link-456');">data_types</a></tt> <tt class="py-keyword">or</tt> <tt class="py-string">'pcs'</tt> <tt class="py-keyword">in</tt> <tt id="link-659" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-659', 'data_types', 'link-456');">data_types</a></tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt id="link-660" class="py-name"><a title="data_store.align_tensor
pipe_control.align_tensor
test_suite.system_tests.align_tensor
user_functions.align_tensor" class="py-name" href="#" onclick="return doclink('link-660', 'align_tensor', 'link-55');">align_tensor</a></tt><tt class="py-op">.</tt><tt id="link-661" class="py-name" targets="Function pipe_control.align_tensor.all_tensors_fixed()=pipe_control.align_tensor-module.html#all_tensors_fixed"><a title="pipe_control.align_tensor.all_tensors_fixed" class="py-name" href="#" onclick="return doclink('link-661', 'all_tensors_fixed', 'link-661');">all_tensors_fixed</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'paramag_centre_fixed'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramag_centre_fixed</tt><tt class="py-op">:</tt> </tt>
<a name="L1177"></a><tt class="py-lineno">1177</tt>  <tt class="py-line">            <tt class="py-comment"># Print out.</tt> </tt>
<a name="L1178"></a><tt class="py-lineno">1178</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">"Optimising each alignment tensor separately."</tt><tt class="py-op">)</tt> </tt>
<a name="L1179"></a><tt class="py-lineno">1179</tt>  <tt class="py-line"> </tt>
<a name="L1180"></a><tt class="py-lineno">1180</tt>  <tt class="py-line">            <tt class="py-comment"># Store the alignment tensor fixed flags.</tt> </tt>
<a name="L1181"></a><tt class="py-lineno">1181</tt>  <tt class="py-line">            <tt class="py-name">fixed_flags</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L1182"></a><tt class="py-lineno">1182</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-662" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-662', 'i', 'link-189');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1183"></a><tt class="py-lineno">1183</tt>  <tt class="py-line">                <tt class="py-comment"># Get the tensor object.</tt> </tt>
<a name="L1184"></a><tt class="py-lineno">1184</tt>  <tt class="py-line">                <tt id="link-663" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-663', 'tensor', 'link-387');">tensor</a></tt> <tt class="py-op">=</tt> <tt id="link-664" class="py-name"><a title="data_store.align_tensor
pipe_control.align_tensor
test_suite.system_tests.align_tensor
user_functions.align_tensor" class="py-name" href="#" onclick="return doclink('link-664', 'align_tensor', 'link-55');">align_tensor</a></tt><tt class="py-op">.</tt><tt id="link-665" class="py-name" targets="Function pipe_control.align_tensor.return_tensor()=pipe_control.align_tensor-module.html#return_tensor"><a title="pipe_control.align_tensor.return_tensor" class="py-name" href="#" onclick="return doclink('link-665', 'return_tensor', 'link-665');">return_tensor</a></tt><tt class="py-op">(</tt><tt class="py-name">index</tt><tt class="py-op">=</tt><tt id="link-666" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-666', 'i', 'link-189');">i</a></tt><tt class="py-op">,</tt> <tt class="py-name">skip_fixed</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt> </tt>
<a name="L1185"></a><tt class="py-lineno">1185</tt>  <tt class="py-line"> </tt>
<a name="L1186"></a><tt class="py-lineno">1186</tt>  <tt class="py-line">                <tt class="py-comment"># Store the flag.</tt> </tt>
<a name="L1187"></a><tt class="py-lineno">1187</tt>  <tt class="py-line">                <tt class="py-name">fixed_flags</tt><tt class="py-op">.</tt><tt id="link-667" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-667', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt id="link-668" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-668', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt class="py-name">fixed</tt><tt class="py-op">)</tt> </tt>
<a name="L1188"></a><tt class="py-lineno">1188</tt>  <tt class="py-line"> </tt>
<a name="L1189"></a><tt class="py-lineno">1189</tt>  <tt class="py-line">                <tt class="py-comment"># Fix the tensor.</tt> </tt>
<a name="L1190"></a><tt class="py-lineno">1190</tt>  <tt class="py-line">                <tt id="link-669" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-669', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt id="link-670" class="py-name" targets="Method data_store.align_tensor.AlignTensorData.set()=data_store.align_tensor.AlignTensorData-class.html#set,Method data_store.diff_tensor.DiffTensorData.set()=data_store.diff_tensor.DiffTensorData-class.html#set,Method multi.misc.Verbosity.set()=multi.misc.Verbosity-class.html#set,Function pipe_control.align_tensor.set()=pipe_control.align_tensor-module.html#set,Function pipe_control.diffusion_tensor.set()=pipe_control.diffusion_tensor-module.html#set,Function pipe_control.minimise.set()=pipe_control.minimise-module.html#set,Function pipe_control.value.set()=pipe_control.value-module.html#set"><a title="data_store.align_tensor.AlignTensorData.set
data_store.diff_tensor.DiffTensorData.set
multi.misc.Verbosity.set
pipe_control.align_tensor.set
pipe_control.diffusion_tensor.set
pipe_control.minimise.set
pipe_control.value.set" class="py-name" href="#" onclick="return doclink('link-670', 'set', 'link-670');">set</a></tt><tt class="py-op">(</tt><tt class="py-string">'fixed'</tt><tt class="py-op">,</tt> <tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L1191"></a><tt class="py-lineno">1191</tt>  <tt class="py-line"> </tt>
<a name="L1192"></a><tt class="py-lineno">1192</tt>  <tt class="py-line">            <tt class="py-comment"># Loop over each sub-grid.</tt> </tt>
<a name="L1193"></a><tt class="py-lineno">1193</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-671" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-671', 'i', 'link-189');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1194"></a><tt class="py-lineno">1194</tt>  <tt class="py-line">                <tt class="py-comment"># Skip the tensor if originally fixed.</tt> </tt>
<a name="L1195"></a><tt class="py-lineno">1195</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">fixed_flags</tt><tt class="py-op">[</tt><tt id="link-672" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-672', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L1196"></a><tt class="py-lineno">1196</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L1197"></a><tt class="py-lineno">1197</tt>  <tt class="py-line"> </tt>
<a name="L1198"></a><tt class="py-lineno">1198</tt>  <tt class="py-line">                <tt class="py-comment"># Get the tensor object.</tt> </tt>
<a name="L1199"></a><tt class="py-lineno">1199</tt>  <tt class="py-line">                <tt id="link-673" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-673', 'tensor', 'link-387');">tensor</a></tt> <tt class="py-op">=</tt> <tt id="link-674" class="py-name"><a title="data_store.align_tensor
pipe_control.align_tensor
test_suite.system_tests.align_tensor
user_functions.align_tensor" class="py-name" href="#" onclick="return doclink('link-674', 'align_tensor', 'link-55');">align_tensor</a></tt><tt class="py-op">.</tt><tt id="link-675" class="py-name"><a title="pipe_control.align_tensor.return_tensor" class="py-name" href="#" onclick="return doclink('link-675', 'return_tensor', 'link-665');">return_tensor</a></tt><tt class="py-op">(</tt><tt class="py-name">index</tt><tt class="py-op">=</tt><tt id="link-676" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-676', 'i', 'link-189');">i</a></tt><tt class="py-op">,</tt> <tt class="py-name">skip_fixed</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt> </tt>
<a name="L1200"></a><tt class="py-lineno">1200</tt>  <tt class="py-line"> </tt>
<a name="L1201"></a><tt class="py-lineno">1201</tt>  <tt class="py-line">                <tt class="py-comment"># Unfix the current tensor.</tt> </tt>
<a name="L1202"></a><tt class="py-lineno">1202</tt>  <tt class="py-line">                <tt id="link-677" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-677', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt id="link-678" class="py-name"><a title="data_store.align_tensor.AlignTensorData.set
data_store.diff_tensor.DiffTensorData.set
multi.misc.Verbosity.set
pipe_control.align_tensor.set
pipe_control.diffusion_tensor.set
pipe_control.minimise.set
pipe_control.value.set" class="py-name" href="#" onclick="return doclink('link-678', 'set', 'link-670');">set</a></tt><tt class="py-op">(</tt><tt class="py-string">'fixed'</tt><tt class="py-op">,</tt> <tt class="py-name">False</tt><tt class="py-op">)</tt> </tt>
<a name="L1203"></a><tt class="py-lineno">1203</tt>  <tt class="py-line"> </tt>
<a name="L1204"></a><tt class="py-lineno">1204</tt>  <tt class="py-line">                <tt class="py-comment"># Grid search parameter subsets.</tt> </tt>
<a name="L1205"></a><tt class="py-lineno">1205</tt>  <tt class="py-line">                <tt class="py-name">lower_sub</tt> <tt class="py-op">=</tt> <tt class="py-name">lower</tt><tt class="py-op">[</tt><tt id="link-679" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-679', 'i', 'link-189');">i</a></tt><tt class="py-op">*</tt><tt class="py-number">5</tt><tt class="py-op">:</tt><tt id="link-680" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-680', 'i', 'link-189');">i</a></tt><tt class="py-op">*</tt><tt class="py-number">5</tt><tt class="py-op">+</tt><tt class="py-number">5</tt><tt class="py-op">]</tt> </tt>
<a name="L1206"></a><tt class="py-lineno">1206</tt>  <tt class="py-line">                <tt class="py-name">upper_sub</tt> <tt class="py-op">=</tt> <tt class="py-name">upper</tt><tt class="py-op">[</tt><tt id="link-681" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-681', 'i', 'link-189');">i</a></tt><tt class="py-op">*</tt><tt class="py-number">5</tt><tt class="py-op">:</tt><tt id="link-682" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-682', 'i', 'link-189');">i</a></tt><tt class="py-op">*</tt><tt class="py-number">5</tt><tt class="py-op">+</tt><tt class="py-number">5</tt><tt class="py-op">]</tt> </tt>
<a name="L1207"></a><tt class="py-lineno">1207</tt>  <tt class="py-line">                <tt class="py-name">inc_sub</tt> <tt class="py-op">=</tt> <tt class="py-name">inc</tt><tt class="py-op">[</tt><tt id="link-683" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-683', 'i', 'link-189');">i</a></tt><tt class="py-op">*</tt><tt class="py-number">5</tt><tt class="py-op">:</tt><tt id="link-684" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-684', 'i', 'link-189');">i</a></tt><tt class="py-op">*</tt><tt class="py-number">5</tt><tt class="py-op">+</tt><tt class="py-number">5</tt><tt class="py-op">]</tt> </tt>
<a name="L1208"></a><tt class="py-lineno">1208</tt>  <tt class="py-line"> </tt>
<a name="L1209"></a><tt class="py-lineno">1209</tt>  <tt class="py-line">                <tt class="py-comment"># Minimisation of the sub-grid.</tt> </tt>
<a name="L1210"></a><tt class="py-lineno">1210</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-685" class="py-name" targets="Method minfx.base_classes.Min.minimise()=minfx.base_classes.Min-class.html#minimise,Method minfx.log_barrier_function.Log_barrier_function.minimise()=minfx.log_barrier_function.Log_barrier_function-class.html#minimise,Method minfx.method_of_multipliers.Method_of_multipliers.minimise()=minfx.method_of_multipliers.Method_of_multipliers-class.html#minimise,Module pipe_control.minimise=pipe_control.minimise-module.html,Function pipe_control.minimise.minimise()=pipe_control.minimise-module.html#minimise,Method specific_analyses.api_base.API_base.minimise()=specific_analyses.api_base.API_base-class.html#minimise,Method specific_analyses.frame_order.Frame_order.minimise()=specific_analyses.frame_order.Frame_order-class.html#minimise,Method specific_analyses.model_free.mf_minimise.Mf_minimise.minimise()=specific_analyses.model_free.mf_minimise.Mf_minimise-class.html#minimise,Method specific_analyses.n_state_model.N_state_model.minimise()=specific_analyses.n_state_model.N_state_model-class.html#minimise,Method specific_analyses.relax_fit.Relax_fit.minimise()=specific_analyses.relax_fit.Relax_fit-class.html#minimise"><a title="minfx.base_classes.Min.minimise
minfx.log_barrier_function.Log_barrier_function.minimise
minfx.method_of_multipliers.Method_of_multipliers.minimise
pipe_control.minimise
pipe_control.minimise.minimise
specific_analyses.api_base.API_base.minimise
specific_analyses.frame_order.Frame_order.minimise
specific_analyses.model_free.mf_minimise.Mf_minimise.minimise
specific_analyses.n_state_model.N_state_model.minimise
specific_analyses.relax_fit.Relax_fit.minimise" class="py-name" href="#" onclick="return doclink('link-685', 'minimise', 'link-685');">minimise</a></tt><tt class="py-op">(</tt><tt class="py-name">min_algor</tt><tt class="py-op">=</tt><tt class="py-string">'grid'</tt><tt class="py-op">,</tt> <tt class="py-name">lower</tt><tt class="py-op">=</tt><tt class="py-name">lower_sub</tt><tt class="py-op">,</tt> <tt class="py-name">upper</tt><tt class="py-op">=</tt><tt class="py-name">upper_sub</tt><tt class="py-op">,</tt> <tt class="py-name">inc</tt><tt class="py-op">=</tt><tt class="py-name">inc_sub</tt><tt class="py-op">,</tt> <tt class="py-name">constraints</tt><tt class="py-op">=</tt><tt class="py-name">constraints</tt><tt class="py-op">,</tt> <tt id="link-686" class="py-name" targets="Variable bmrblib.pystarlib.Text.verbosity=bmrblib.pystarlib.Text-module.html#verbosity,Variable bmrblib.pystarlib.verbosity=bmrblib.pystarlib-module.html#verbosity,Variable multi.multi_processor_base.verbosity=multi.multi_processor_base-module.html#verbosity,Variable multi.processor.verbosity=multi.processor-module.html#verbosity"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-686', 'verbosity', 'link-686');">verbosity</a></tt><tt class="py-op">=</tt><tt id="link-687" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-687', 'verbosity', 'link-686');">verbosity</a></tt><tt class="py-op">,</tt> <tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">)</tt> </tt>
<a name="L1211"></a><tt class="py-lineno">1211</tt>  <tt class="py-line"> </tt>
<a name="L1212"></a><tt class="py-lineno">1212</tt>  <tt class="py-line">                <tt class="py-comment"># Fix the tensor again.</tt> </tt>
<a name="L1213"></a><tt class="py-lineno">1213</tt>  <tt class="py-line">                <tt id="link-688" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-688', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt id="link-689" class="py-name"><a title="data_store.align_tensor.AlignTensorData.set
data_store.diff_tensor.DiffTensorData.set
multi.misc.Verbosity.set
pipe_control.align_tensor.set
pipe_control.diffusion_tensor.set
pipe_control.minimise.set
pipe_control.value.set" class="py-name" href="#" onclick="return doclink('link-689', 'set', 'link-670');">set</a></tt><tt class="py-op">(</tt><tt class="py-string">'fixed'</tt><tt class="py-op">,</tt> <tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L1214"></a><tt class="py-lineno">1214</tt>  <tt class="py-line"> </tt>
<a name="L1215"></a><tt class="py-lineno">1215</tt>  <tt class="py-line">            <tt class="py-comment"># Reset the state of the tensors.</tt> </tt>
<a name="L1216"></a><tt class="py-lineno">1216</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-690" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-690', 'i', 'link-189');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1217"></a><tt class="py-lineno">1217</tt>  <tt class="py-line">                <tt class="py-comment"># Get the tensor object.</tt> </tt>
<a name="L1218"></a><tt class="py-lineno">1218</tt>  <tt class="py-line">                <tt id="link-691" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-691', 'tensor', 'link-387');">tensor</a></tt> <tt class="py-op">=</tt> <tt id="link-692" class="py-name"><a title="data_store.align_tensor
pipe_control.align_tensor
test_suite.system_tests.align_tensor
user_functions.align_tensor" class="py-name" href="#" onclick="return doclink('link-692', 'align_tensor', 'link-55');">align_tensor</a></tt><tt class="py-op">.</tt><tt id="link-693" class="py-name"><a title="pipe_control.align_tensor.return_tensor" class="py-name" href="#" onclick="return doclink('link-693', 'return_tensor', 'link-665');">return_tensor</a></tt><tt class="py-op">(</tt><tt class="py-name">index</tt><tt class="py-op">=</tt><tt id="link-694" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-694', 'i', 'link-189');">i</a></tt><tt class="py-op">,</tt> <tt class="py-name">skip_fixed</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt> </tt>
<a name="L1219"></a><tt class="py-lineno">1219</tt>  <tt class="py-line"> </tt>
<a name="L1220"></a><tt class="py-lineno">1220</tt>  <tt class="py-line">                <tt class="py-comment"># Fix the tensor.</tt> </tt>
<a name="L1221"></a><tt class="py-lineno">1221</tt>  <tt class="py-line">                <tt id="link-695" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-695', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt id="link-696" class="py-name"><a title="data_store.align_tensor.AlignTensorData.set
data_store.diff_tensor.DiffTensorData.set
multi.misc.Verbosity.set
pipe_control.align_tensor.set
pipe_control.diffusion_tensor.set
pipe_control.minimise.set
pipe_control.value.set" class="py-name" href="#" onclick="return doclink('link-696', 'set', 'link-670');">set</a></tt><tt class="py-op">(</tt><tt class="py-string">'fixed'</tt><tt class="py-op">,</tt> <tt class="py-name">fixed_flags</tt><tt class="py-op">[</tt><tt id="link-697" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-697', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1222"></a><tt class="py-lineno">1222</tt>  <tt class="py-line"> </tt>
<a name="L1223"></a><tt class="py-lineno">1223</tt>  <tt class="py-line">        <tt class="py-comment"># All other minimisation.</tt> </tt>
<a name="L1224"></a><tt class="py-lineno">1224</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1225"></a><tt class="py-lineno">1225</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-698" class="py-name"><a title="minfx.base_classes.Min.minimise
minfx.log_barrier_function.Log_barrier_function.minimise
minfx.method_of_multipliers.Method_of_multipliers.minimise
pipe_control.minimise
pipe_control.minimise.minimise
specific_analyses.api_base.API_base.minimise
specific_analyses.frame_order.Frame_order.minimise
specific_analyses.model_free.mf_minimise.Mf_minimise.minimise
specific_analyses.n_state_model.N_state_model.minimise
specific_analyses.relax_fit.Relax_fit.minimise" class="py-name" href="#" onclick="return doclink('link-698', 'minimise', 'link-685');">minimise</a></tt><tt class="py-op">(</tt><tt class="py-name">min_algor</tt><tt class="py-op">=</tt><tt class="py-string">'grid'</tt><tt class="py-op">,</tt> <tt class="py-name">lower</tt><tt class="py-op">=</tt><tt class="py-name">lower</tt><tt class="py-op">,</tt> <tt class="py-name">upper</tt><tt class="py-op">=</tt><tt class="py-name">upper</tt><tt class="py-op">,</tt> <tt class="py-name">inc</tt><tt class="py-op">=</tt><tt class="py-name">inc</tt><tt class="py-op">,</tt> <tt class="py-name">constraints</tt><tt class="py-op">=</tt><tt class="py-name">constraints</tt><tt class="py-op">,</tt> <tt id="link-699" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-699', 'verbosity', 'link-686');">verbosity</a></tt><tt class="py-op">=</tt><tt id="link-700" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-700', 'verbosity', 'link-686');">verbosity</a></tt><tt class="py-op">,</tt> <tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">)</tt> </tt>
</div><a name="L1226"></a><tt class="py-lineno">1226</tt>  <tt class="py-line"> </tt>
<a name="L1227"></a><tt class="py-lineno">1227</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.is_spin_param"></a><div id="N_state_model.is_spin_param-def"><a name="L1228"></a><tt class="py-lineno">1228</tt> <a class="py-toggle" href="#" id="N_state_model.is_spin_param-toggle" onclick="return toggle('N_state_model.is_spin_param');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#is_spin_param">is_spin_param</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.is_spin_param-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model.is_spin_param-expanded"><a name="L1229"></a><tt class="py-lineno">1229</tt>  <tt class="py-line">        <tt class="py-docstring">"""Determine whether the given parameter is spin specific.</tt> </tt>
<a name="L1230"></a><tt class="py-lineno">1230</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1231"></a><tt class="py-lineno">1231</tt>  <tt class="py-line"><tt class="py-docstring">        @param name:    The name of the parameter.</tt> </tt>
<a name="L1232"></a><tt class="py-lineno">1232</tt>  <tt class="py-line"><tt class="py-docstring">        @type name:     str</tt> </tt>
<a name="L1233"></a><tt class="py-lineno">1233</tt>  <tt class="py-line"><tt class="py-docstring">        @return:        False</tt> </tt>
<a name="L1234"></a><tt class="py-lineno">1234</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:         bool</tt> </tt>
<a name="L1235"></a><tt class="py-lineno">1235</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L1236"></a><tt class="py-lineno">1236</tt>  <tt class="py-line"> </tt>
<a name="L1237"></a><tt class="py-lineno">1237</tt>  <tt class="py-line">        <tt class="py-comment"># Spin specific parameters.</tt> </tt>
<a name="L1238"></a><tt class="py-lineno">1238</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-701" class="py-name"><a title="bmrblib.kinetics.auto_relaxation.AutoRelaxationSaveframe.name
bmrblib.kinetics.auto_relaxation_v3_1.AutoRelaxationSaveframe_v3_1.name
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.name
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.name
pipe_control.pipes.name
user_functions.pipe.name" class="py-name" href="#" onclick="return doclink('link-701', 'name', 'link-158');">name</a></tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt class="py-string">'r'</tt><tt class="py-op">,</tt> <tt class="py-string">'heteronuc_type'</tt><tt class="py-op">,</tt> <tt class="py-string">'proton_type'</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L1239"></a><tt class="py-lineno">1239</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">True</tt> </tt>
<a name="L1240"></a><tt class="py-lineno">1240</tt>  <tt class="py-line"> </tt>
<a name="L1241"></a><tt class="py-lineno">1241</tt>  <tt class="py-line">        <tt class="py-comment"># All other parameters are global.</tt> </tt>
<a name="L1242"></a><tt class="py-lineno">1242</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">False</tt> </tt>
</div><a name="L1243"></a><tt class="py-lineno">1243</tt>  <tt class="py-line"> </tt>
<a name="L1244"></a><tt class="py-lineno">1244</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.map_bounds"></a><div id="N_state_model.map_bounds-def"><a name="L1245"></a><tt class="py-lineno">1245</tt> <a class="py-toggle" href="#" id="N_state_model.map_bounds-toggle" onclick="return toggle('N_state_model.map_bounds');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#map_bounds">map_bounds</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">param</tt><tt class="py-op">,</tt> <tt class="py-param">spin_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.map_bounds-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model.map_bounds-expanded"><a name="L1246"></a><tt class="py-lineno">1246</tt>  <tt class="py-line">        <tt class="py-docstring">"""Create bounds for the OpenDX mapping function.</tt> </tt>
<a name="L1247"></a><tt class="py-lineno">1247</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1248"></a><tt class="py-lineno">1248</tt>  <tt class="py-line"><tt class="py-docstring">        @param param:       The name of the parameter to return the lower and upper bounds of.</tt> </tt>
<a name="L1249"></a><tt class="py-lineno">1249</tt>  <tt class="py-line"><tt class="py-docstring">        @type param:        str</tt> </tt>
<a name="L1250"></a><tt class="py-lineno">1250</tt>  <tt class="py-line"><tt class="py-docstring">        @param spin_id:     The spin identification string (unused).</tt> </tt>
<a name="L1251"></a><tt class="py-lineno">1251</tt>  <tt class="py-line"><tt class="py-docstring">        @type spin_id:      None</tt> </tt>
<a name="L1252"></a><tt class="py-lineno">1252</tt>  <tt class="py-line"><tt class="py-docstring">        @return:            The upper and lower bounds of the parameter.</tt> </tt>
<a name="L1253"></a><tt class="py-lineno">1253</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:             list of float</tt> </tt>
<a name="L1254"></a><tt class="py-lineno">1254</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L1255"></a><tt class="py-lineno">1255</tt>  <tt class="py-line"> </tt>
<a name="L1256"></a><tt class="py-lineno">1256</tt>  <tt class="py-line">        <tt class="py-comment"># Paramagnetic centre.</tt> </tt>
<a name="L1257"></a><tt class="py-lineno">1257</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-702" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-702', 'search', 'link-7');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'^paramag_[xyz]$'</tt><tt class="py-op">,</tt> <tt class="py-name">param</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1258"></a><tt class="py-lineno">1258</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">100.0</tt><tt class="py-op">,</tt> <tt class="py-number">100.0</tt><tt class="py-op">]</tt> </tt>
</div><a name="L1259"></a><tt class="py-lineno">1259</tt>  <tt class="py-line"> </tt>
<a name="L1260"></a><tt class="py-lineno">1260</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.minimise"></a><div id="N_state_model.minimise-def"><a name="L1261"></a><tt class="py-lineno">1261</tt> <a class="py-toggle" href="#" id="N_state_model.minimise-toggle" onclick="return toggle('N_state_model.minimise');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#minimise">minimise</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">min_algor</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">min_options</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">func_tol</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">grad_tol</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">max_iterations</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">constraints</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">,</tt> <tt class="py-param">scaling</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-param">verbosity</tt><tt class="py-op">=</tt><tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-param">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">lower</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">upper</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">inc</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.minimise-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model.minimise-expanded"><a name="L1262"></a><tt class="py-lineno">1262</tt>  <tt class="py-line">        <tt class="py-docstring">"""Minimisation function.</tt> </tt>
<a name="L1263"></a><tt class="py-lineno">1263</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1264"></a><tt class="py-lineno">1264</tt>  <tt class="py-line"><tt class="py-docstring">        @param min_algor:       The minimisation algorithm to use.</tt> </tt>
<a name="L1265"></a><tt class="py-lineno">1265</tt>  <tt class="py-line"><tt class="py-docstring">        @type min_algor:        str</tt> </tt>
<a name="L1266"></a><tt class="py-lineno">1266</tt>  <tt class="py-line"><tt class="py-docstring">        @param min_options:     An array of options to be used by the minimisation algorithm.</tt> </tt>
<a name="L1267"></a><tt class="py-lineno">1267</tt>  <tt class="py-line"><tt class="py-docstring">        @type min_options:      array of str</tt> </tt>
<a name="L1268"></a><tt class="py-lineno">1268</tt>  <tt class="py-line"><tt class="py-docstring">        @param func_tol:        The function tolerance which, when reached, terminates optimisation. Setting this to None turns of the check.</tt> </tt>
<a name="L1269"></a><tt class="py-lineno">1269</tt>  <tt class="py-line"><tt class="py-docstring">        @type func_tol:         None or float</tt> </tt>
<a name="L1270"></a><tt class="py-lineno">1270</tt>  <tt class="py-line"><tt class="py-docstring">        @param grad_tol:        The gradient tolerance which, when reached, terminates optimisation. Setting this to None turns of the check.</tt> </tt>
<a name="L1271"></a><tt class="py-lineno">1271</tt>  <tt class="py-line"><tt class="py-docstring">        @type grad_tol:         None or float</tt> </tt>
<a name="L1272"></a><tt class="py-lineno">1272</tt>  <tt class="py-line"><tt class="py-docstring">        @param max_iterations:  The maximum number of iterations for the algorithm.</tt> </tt>
<a name="L1273"></a><tt class="py-lineno">1273</tt>  <tt class="py-line"><tt class="py-docstring">        @type max_iterations:   int</tt> </tt>
<a name="L1274"></a><tt class="py-lineno">1274</tt>  <tt class="py-line"><tt class="py-docstring">        @param constraints:     If True, constraints are used during optimisation.</tt> </tt>
<a name="L1275"></a><tt class="py-lineno">1275</tt>  <tt class="py-line"><tt class="py-docstring">        @type constraints:      bool</tt> </tt>
<a name="L1276"></a><tt class="py-lineno">1276</tt>  <tt class="py-line"><tt class="py-docstring">        @param scaling:         If True, diagonal scaling is enabled during optimisation to allow the problem to be better conditioned.</tt> </tt>
<a name="L1277"></a><tt class="py-lineno">1277</tt>  <tt class="py-line"><tt class="py-docstring">        @type scaling:          bool</tt> </tt>
<a name="L1278"></a><tt class="py-lineno">1278</tt>  <tt class="py-line"><tt class="py-docstring">        @param verbosity:       A flag specifying the amount of information to print.  The higher the value, the greater the verbosity.</tt> </tt>
<a name="L1279"></a><tt class="py-lineno">1279</tt>  <tt class="py-line"><tt class="py-docstring">        @type verbosity:        int</tt> </tt>
<a name="L1280"></a><tt class="py-lineno">1280</tt>  <tt class="py-line"><tt class="py-docstring">        @param sim_index:       The index of the simulation to optimise.  This should be None if normal optimisation is desired.</tt> </tt>
<a name="L1281"></a><tt class="py-lineno">1281</tt>  <tt class="py-line"><tt class="py-docstring">        @type sim_index:        None or int</tt> </tt>
<a name="L1282"></a><tt class="py-lineno">1282</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword lower:         The lower bounds of the grid search which must be equal to the number of parameters in the model.  This optional argument is only used when doing a grid search.</tt> </tt>
<a name="L1283"></a><tt class="py-lineno">1283</tt>  <tt class="py-line"><tt class="py-docstring">        @type lower:            array of numbers</tt> </tt>
<a name="L1284"></a><tt class="py-lineno">1284</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword upper:         The upper bounds of the grid search which must be equal to the number of parameters in the model.  This optional argument is only used when doing a grid search.</tt> </tt>
<a name="L1285"></a><tt class="py-lineno">1285</tt>  <tt class="py-line"><tt class="py-docstring">        @type upper:            array of numbers</tt> </tt>
<a name="L1286"></a><tt class="py-lineno">1286</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword inc:           The increments for each dimension of the space for the grid search.  The number of elements in the array must equal to the number of parameters in the model.  This argument is only used when doing a grid search.</tt> </tt>
<a name="L1287"></a><tt class="py-lineno">1287</tt>  <tt class="py-line"><tt class="py-docstring">        @type inc:              array of int</tt> </tt>
<a name="L1288"></a><tt class="py-lineno">1288</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L1289"></a><tt class="py-lineno">1289</tt>  <tt class="py-line"> </tt>
<a name="L1290"></a><tt class="py-lineno">1290</tt>  <tt class="py-line">        <tt class="py-comment"># Set up the target function for direct calculation.</tt> </tt>
<a name="L1291"></a><tt class="py-lineno">1291</tt>  <tt class="py-line">        <tt id="link-703" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model" class="py-name" href="#" onclick="return doclink('link-703', 'model', 'link-201');">model</a></tt><tt class="py-op">,</tt> <tt class="py-name">param_vector</tt><tt class="py-op">,</tt> <tt id="link-704" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-704', 'data_types', 'link-456');">data_types</a></tt><tt class="py-op">,</tt> <tt class="py-name">scaling_matrix</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-705" class="py-name"><a title="specific_analyses.frame_order.Frame_order._target_fn_setup
specific_analyses.n_state_model.N_state_model._target_fn_setup" class="py-name" href="#" onclick="return doclink('link-705', '_target_fn_setup', 'link-520');">_target_fn_setup</a></tt><tt class="py-op">(</tt><tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">,</tt> <tt class="py-name">scaling</tt><tt class="py-op">=</tt><tt class="py-name">scaling</tt><tt class="py-op">)</tt> </tt>
<a name="L1292"></a><tt class="py-lineno">1292</tt>  <tt class="py-line"> </tt>
<a name="L1293"></a><tt class="py-lineno">1293</tt>  <tt class="py-line">        <tt class="py-comment"># Nothing to do!</tt> </tt>
<a name="L1294"></a><tt class="py-lineno">1294</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">param_vector</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1295"></a><tt class="py-lineno">1295</tt>  <tt class="py-line">            <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-706" class="py-name"><a title="lib.warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-706', 'RelaxWarning', 'link-53');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"The model has no parameters, minimisation cannot be performed."</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1296"></a><tt class="py-lineno">1296</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
<a name="L1297"></a><tt class="py-lineno">1297</tt>  <tt class="py-line"> </tt>
<a name="L1298"></a><tt class="py-lineno">1298</tt>  <tt class="py-line">        <tt class="py-comment"># Right, constraints cannot be used for the 'fixed' model.</tt> </tt>
<a name="L1299"></a><tt class="py-lineno">1299</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">constraints</tt> <tt class="py-keyword">and</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-707" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model" class="py-name" href="#" onclick="return doclink('link-707', 'model', 'link-201');">model</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'fixed'</tt><tt class="py-op">:</tt> </tt>
<a name="L1300"></a><tt class="py-lineno">1300</tt>  <tt class="py-line">            <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-708" class="py-name"><a title="lib.warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-708', 'RelaxWarning', 'link-53');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"Turning constraints off.  These cannot be used for the 'fixed' model."</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1301"></a><tt class="py-lineno">1301</tt>  <tt class="py-line">            <tt class="py-name">constraints</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L1302"></a><tt class="py-lineno">1302</tt>  <tt class="py-line"> </tt>
<a name="L1303"></a><tt class="py-lineno">1303</tt>  <tt class="py-line">            <tt class="py-comment"># Pop out the Method of Multipliers algorithm.</tt> </tt>
<a name="L1304"></a><tt class="py-lineno">1304</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">min_algor</tt> <tt class="py-op">==</tt> <tt class="py-string">'Method of Multipliers'</tt><tt class="py-op">:</tt> </tt>
<a name="L1305"></a><tt class="py-lineno">1305</tt>  <tt class="py-line">                <tt class="py-name">min_algor</tt> <tt class="py-op">=</tt> <tt class="py-name">min_options</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L1306"></a><tt class="py-lineno">1306</tt>  <tt class="py-line">                <tt class="py-name">min_options</tt> <tt class="py-op">=</tt> <tt class="py-name">min_options</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">:</tt><tt class="py-op">]</tt> </tt>
<a name="L1307"></a><tt class="py-lineno">1307</tt>  <tt class="py-line"> </tt>
<a name="L1308"></a><tt class="py-lineno">1308</tt>  <tt class="py-line">        <tt class="py-comment"># And constraints absolutely must be used for the 'population' model.</tt> </tt>
<a name="L1309"></a><tt class="py-lineno">1309</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">constraints</tt> <tt class="py-keyword">and</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-709" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model" class="py-name" href="#" onclick="return doclink('link-709', 'model', 'link-201');">model</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'population'</tt><tt class="py-op">:</tt> </tt>
<a name="L1310"></a><tt class="py-lineno">1310</tt>  <tt class="py-line">            <tt class="py-name">warn</tt><tt class="py-op">(</tt><tt id="link-710" class="py-name"><a title="lib.warnings.RelaxWarning" class="py-name" href="#" onclick="return doclink('link-710', 'RelaxWarning', 'link-53');">RelaxWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"Turning constraints on.  These absolutely must be used for the 'population' model."</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1311"></a><tt class="py-lineno">1311</tt>  <tt class="py-line">            <tt class="py-name">constraints</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L1312"></a><tt class="py-lineno">1312</tt>  <tt class="py-line"> </tt>
<a name="L1313"></a><tt class="py-lineno">1313</tt>  <tt class="py-line">            <tt class="py-comment"># Add the Method of Multipliers algorithm.</tt> </tt>
<a name="L1314"></a><tt class="py-lineno">1314</tt>  <tt class="py-line">            <tt class="py-name">min_options</tt> <tt class="py-op">=</tt> <tt class="py-op">(</tt><tt class="py-name">min_algor</tt><tt class="py-op">,</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-name">min_options</tt> </tt>
<a name="L1315"></a><tt class="py-lineno">1315</tt>  <tt class="py-line">            <tt class="py-name">min_algor</tt> <tt class="py-op">=</tt> <tt class="py-string">'Method of Multipliers'</tt> </tt>
<a name="L1316"></a><tt class="py-lineno">1316</tt>  <tt class="py-line"> </tt>
<a name="L1317"></a><tt class="py-lineno">1317</tt>  <tt class="py-line">        <tt class="py-comment"># Disallow Newton optimisation and other Hessian optimisers for the paramagnetic centre position optimisation (the PCS Hessian is not yet implemented).</tt> </tt>
<a name="L1318"></a><tt class="py-lineno">1318</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'paramag_centre_fixed'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramag_centre_fixed</tt><tt class="py-op">:</tt> </tt>
<a name="L1319"></a><tt class="py-lineno">1319</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">min_algor</tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt class="py-string">'newton'</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L1320"></a><tt class="py-lineno">1320</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-711" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-711', 'RelaxError', 'link-13');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"For the paramagnetic centre position, as the Hessians are not yet implemented Newton optimisation cannot be performed."</tt><tt class="py-op">)</tt> </tt>
<a name="L1321"></a><tt class="py-lineno">1321</tt>  <tt class="py-line"> </tt>
<a name="L1322"></a><tt class="py-lineno">1322</tt>  <tt class="py-line">        <tt class="py-comment"># Linear constraints.</tt> </tt>
<a name="L1323"></a><tt class="py-lineno">1323</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">constraints</tt><tt class="py-op">:</tt> </tt>
<a name="L1324"></a><tt class="py-lineno">1324</tt>  <tt class="py-line">            <tt class="py-name">A</tt><tt class="py-op">,</tt> <tt class="py-name">b</tt> <tt class="py-op">=</tt> <tt id="link-712" class="py-name"><a title="specific_analyses.n_state_model.parameters.linear_constraints" class="py-name" href="#" onclick="return doclink('link-712', 'linear_constraints', 'link-96');">linear_constraints</a></tt><tt class="py-op">(</tt><tt id="link-713" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-713', 'data_types', 'link-456');">data_types</a></tt><tt class="py-op">=</tt><tt id="link-714" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-714', 'data_types', 'link-456');">data_types</a></tt><tt class="py-op">,</tt> <tt class="py-name">scaling_matrix</tt><tt class="py-op">=</tt><tt class="py-name">scaling_matrix</tt><tt class="py-op">)</tt> </tt>
<a name="L1325"></a><tt class="py-lineno">1325</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1326"></a><tt class="py-lineno">1326</tt>  <tt class="py-line">            <tt class="py-name">A</tt><tt class="py-op">,</tt> <tt class="py-name">b</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt> </tt>
<a name="L1327"></a><tt class="py-lineno">1327</tt>  <tt class="py-line"> </tt>
<a name="L1328"></a><tt class="py-lineno">1328</tt>  <tt class="py-line">        <tt class="py-comment"># Grid search.</tt> </tt>
<a name="L1329"></a><tt class="py-lineno">1329</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-715" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-715', 'search', 'link-7');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'^[Gg]rid'</tt><tt class="py-op">,</tt> <tt class="py-name">min_algor</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1330"></a><tt class="py-lineno">1330</tt>  <tt class="py-line">            <tt class="py-comment"># Scaling.</tt> </tt>
<a name="L1331"></a><tt class="py-lineno">1331</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">scaling</tt><tt class="py-op">:</tt> </tt>
<a name="L1332"></a><tt class="py-lineno">1332</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt id="link-716" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-716', 'i', 'link-189');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">param_vector</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1333"></a><tt class="py-lineno">1333</tt>  <tt class="py-line">                    <tt class="py-name">lower</tt><tt class="py-op">[</tt><tt id="link-717" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-717', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">lower</tt><tt class="py-op">[</tt><tt id="link-718" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-718', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">/</tt> <tt class="py-name">scaling_matrix</tt><tt class="py-op">[</tt><tt id="link-719" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-719', 'i', 'link-189');">i</a></tt><tt class="py-op">,</tt> <tt id="link-720" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-720', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt> </tt>
<a name="L1334"></a><tt class="py-lineno">1334</tt>  <tt class="py-line">                    <tt class="py-name">upper</tt><tt class="py-op">[</tt><tt id="link-721" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-721', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">upper</tt><tt class="py-op">[</tt><tt id="link-722" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-722', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">/</tt> <tt class="py-name">scaling_matrix</tt><tt class="py-op">[</tt><tt id="link-723" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-723', 'i', 'link-189');">i</a></tt><tt class="py-op">,</tt> <tt id="link-724" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-724', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt> </tt>
<a name="L1335"></a><tt class="py-lineno">1335</tt>  <tt class="py-line"> </tt>
<a name="L1336"></a><tt class="py-lineno">1336</tt>  <tt class="py-line">            <tt class="py-comment"># The search.</tt> </tt>
<a name="L1337"></a><tt class="py-lineno">1337</tt>  <tt class="py-line">            <tt id="link-725" class="py-name" targets="Module pipe_control.results=pipe_control.results-module.html,Module specific_analyses.model_free.results=specific_analyses.model_free.results-module.html,Module test_suite.system_tests.results=test_suite.system_tests.results-module.html,Module user_functions.results=user_functions.results-module.html"><a title="pipe_control.results
specific_analyses.model_free.results
test_suite.system_tests.results
user_functions.results" class="py-name" href="#" onclick="return doclink('link-725', 'results', 'link-725');">results</a></tt> <tt class="py-op">=</tt> <tt id="link-726" class="py-name"><a title="gui.components.grid
minfx.grid
minfx.grid.grid" class="py-name" href="#" onclick="return doclink('link-726', 'grid', 'link-5');">grid</a></tt><tt class="py-op">(</tt><tt id="link-727" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func
target_functions.relax_fit.func" class="py-name" href="#" onclick="return doclink('link-727', 'func', 'link-524');">func</a></tt><tt class="py-op">=</tt><tt id="link-728" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model" class="py-name" href="#" onclick="return doclink('link-728', 'model', 'link-201');">model</a></tt><tt class="py-op">.</tt><tt id="link-729" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func
target_functions.relax_fit.func" class="py-name" href="#" onclick="return doclink('link-729', 'func', 'link-524');">func</a></tt><tt class="py-op">,</tt> <tt class="py-name">args</tt><tt class="py-op">=</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">num_incs</tt><tt class="py-op">=</tt><tt class="py-name">inc</tt><tt class="py-op">,</tt> <tt class="py-name">lower</tt><tt class="py-op">=</tt><tt class="py-name">lower</tt><tt class="py-op">,</tt> <tt class="py-name">upper</tt><tt class="py-op">=</tt><tt class="py-name">upper</tt><tt class="py-op">,</tt> <tt class="py-name">A</tt><tt class="py-op">=</tt><tt class="py-name">A</tt><tt class="py-op">,</tt> <tt class="py-name">b</tt><tt class="py-op">=</tt><tt class="py-name">b</tt><tt class="py-op">,</tt> <tt id="link-730" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-730', 'verbosity', 'link-686');">verbosity</a></tt><tt class="py-op">=</tt><tt id="link-731" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-731', 'verbosity', 'link-686');">verbosity</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1338"></a><tt class="py-lineno">1338</tt>  <tt class="py-line"> </tt>
<a name="L1339"></a><tt class="py-lineno">1339</tt>  <tt class="py-line">            <tt class="py-comment"># Unpack the results.</tt> </tt>
<a name="L1340"></a><tt class="py-lineno">1340</tt>  <tt class="py-line">            <tt class="py-name">param_vector</tt><tt class="py-op">,</tt> <tt id="link-732" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func
target_functions.relax_fit.func" class="py-name" href="#" onclick="return doclink('link-732', 'func', 'link-524');">func</a></tt><tt class="py-op">,</tt> <tt class="py-name">iter_count</tt><tt class="py-op">,</tt> <tt id="link-733" class="py-name" targets="Variable gui.analyses.auto_model_free.Local_tm_list.warning=gui.analyses.auto_model_free.Local_tm_list-class.html#warning,Variable gui.analyses.auto_model_free.Mf_list.warning=gui.analyses.auto_model_free.Mf_list-class.html#warning,Variable gui.analyses.elements.model_list.Model_list.warning=gui.analyses.elements.model_list.Model_list-class.html#warning"><a title="gui.analyses.auto_model_free.Local_tm_list.warning
gui.analyses.auto_model_free.Mf_list.warning
gui.analyses.elements.model_list.Model_list.warning" class="py-name" href="#" onclick="return doclink('link-733', 'warning', 'link-733');">warning</a></tt> <tt class="py-op">=</tt> <tt id="link-734" class="py-name"><a title="pipe_control.results
specific_analyses.model_free.results
test_suite.system_tests.results
user_functions.results" class="py-name" href="#" onclick="return doclink('link-734', 'results', 'link-725');">results</a></tt> </tt>
<a name="L1341"></a><tt class="py-lineno">1341</tt>  <tt class="py-line">            <tt class="py-name">f_count</tt> <tt class="py-op">=</tt> <tt class="py-name">iter_count</tt> </tt>
<a name="L1342"></a><tt class="py-lineno">1342</tt>  <tt class="py-line">            <tt class="py-name">g_count</tt> <tt class="py-op">=</tt> <tt class="py-number">0.0</tt> </tt>
<a name="L1343"></a><tt class="py-lineno">1343</tt>  <tt class="py-line">            <tt class="py-name">h_count</tt> <tt class="py-op">=</tt> <tt class="py-number">0.0</tt> </tt>
<a name="L1344"></a><tt class="py-lineno">1344</tt>  <tt class="py-line"> </tt>
<a name="L1345"></a><tt class="py-lineno">1345</tt>  <tt class="py-line">        <tt class="py-comment"># Minimisation.</tt> </tt>
<a name="L1346"></a><tt class="py-lineno">1346</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1347"></a><tt class="py-lineno">1347</tt>  <tt class="py-line">            <tt id="link-735" class="py-name"><a title="pipe_control.results
specific_analyses.model_free.results
test_suite.system_tests.results
user_functions.results" class="py-name" href="#" onclick="return doclink('link-735', 'results', 'link-725');">results</a></tt> <tt class="py-op">=</tt> <tt id="link-736" class="py-name"><a title="minfx.generic.generic_minimise" class="py-name" href="#" onclick="return doclink('link-736', 'generic_minimise', 'link-3');">generic_minimise</a></tt><tt class="py-op">(</tt><tt id="link-737" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func
target_functions.relax_fit.func" class="py-name" href="#" onclick="return doclink('link-737', 'func', 'link-524');">func</a></tt><tt class="py-op">=</tt><tt id="link-738" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model" class="py-name" href="#" onclick="return doclink('link-738', 'model', 'link-201');">model</a></tt><tt class="py-op">.</tt><tt id="link-739" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func
target_functions.relax_fit.func" class="py-name" href="#" onclick="return doclink('link-739', 'func', 'link-524');">func</a></tt><tt class="py-op">,</tt> <tt id="link-740" class="py-name" targets="Method minfx.constraint_linear.Constraint_linear.dfunc()=minfx.constraint_linear.Constraint_linear-class.html#dfunc,Function target_functions.relax_fit.dfunc()=target_functions.relax_fit-module.html#dfunc"><a title="minfx.constraint_linear.Constraint_linear.dfunc
target_functions.relax_fit.dfunc" class="py-name" href="#" onclick="return doclink('link-740', 'dfunc', 'link-740');">dfunc</a></tt><tt class="py-op">=</tt><tt id="link-741" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model" class="py-name" href="#" onclick="return doclink('link-741', 'model', 'link-201');">model</a></tt><tt class="py-op">.</tt><tt id="link-742" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.dfunc
target_functions.relax_fit.dfunc" class="py-name" href="#" onclick="return doclink('link-742', 'dfunc', 'link-740');">dfunc</a></tt><tt class="py-op">,</tt> <tt id="link-743" class="py-name" targets="Function target_functions.relax_fit.d2func()=target_functions.relax_fit-module.html#d2func"><a title="target_functions.relax_fit.d2func" class="py-name" href="#" onclick="return doclink('link-743', 'd2func', 'link-743');">d2func</a></tt><tt class="py-op">=</tt><tt id="link-744" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model" class="py-name" href="#" onclick="return doclink('link-744', 'model', 'link-201');">model</a></tt><tt class="py-op">.</tt><tt id="link-745" class="py-name"><a title="target_functions.relax_fit.d2func" class="py-name" href="#" onclick="return doclink('link-745', 'd2func', 'link-743');">d2func</a></tt><tt class="py-op">,</tt> <tt class="py-name">args</tt><tt class="py-op">=</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">x0</tt><tt class="py-op">=</tt><tt class="py-name">param_vector</tt><tt class="py-op">,</tt> <tt class="py-name">min_algor</tt><tt class="py-op">=</tt><tt class="py-name">min_algor</tt><tt class="py-op">,</tt> <tt class="py-name">min_options</tt><tt class="py-op">=</tt><tt class="py-name">min_options</tt><tt class="py-op">,</tt> <tt class="py-name">func_tol</tt><tt class="py-op">=</tt><tt class="py-name">func_tol</tt><tt class="py-op">,</tt> <tt class="py-name">grad_tol</tt><tt class="py-op">=</tt><tt class="py-name">grad_tol</tt><tt class="py-op">,</tt> <tt class="py-name">maxiter</tt><tt class="py-op">=</tt><tt class="py-name">max_iterations</tt><tt class="py-op">,</tt> <tt class="py-name">A</tt><tt class="py-op">=</tt><tt class="py-name">A</tt><tt class="py-op">,</tt> <tt class="py-name">b</tt><tt class="py-op">=</tt><tt class="py-name">b</tt><tt class="py-op">,</tt> <tt class="py-name">full_output</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">print_flag</tt><tt class="py-op">=</tt><tt id="link-746" class="py-name"><a title="bmrblib.pystarlib.Text.verbosity
bmrblib.pystarlib.verbosity
multi.multi_processor_base.verbosity
multi.processor.verbosity" class="py-name" href="#" onclick="return doclink('link-746', 'verbosity', 'link-686');">verbosity</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1348"></a><tt class="py-lineno">1348</tt>  <tt class="py-line"> </tt>
<a name="L1349"></a><tt class="py-lineno">1349</tt>  <tt class="py-line">            <tt class="py-comment"># Unpack the results.</tt> </tt>
<a name="L1350"></a><tt class="py-lineno">1350</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-747" class="py-name"><a title="pipe_control.results
specific_analyses.model_free.results
test_suite.system_tests.results
user_functions.results" class="py-name" href="#" onclick="return doclink('link-747', 'results', 'link-725');">results</a></tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L1351"></a><tt class="py-lineno">1351</tt>  <tt class="py-line">                <tt class="py-keyword">return</tt> </tt>
<a name="L1352"></a><tt class="py-lineno">1352</tt>  <tt class="py-line">            <tt class="py-name">param_vector</tt><tt class="py-op">,</tt> <tt id="link-748" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func
target_functions.relax_fit.func" class="py-name" href="#" onclick="return doclink('link-748', 'func', 'link-524');">func</a></tt><tt class="py-op">,</tt> <tt class="py-name">iter_count</tt><tt class="py-op">,</tt> <tt class="py-name">f_count</tt><tt class="py-op">,</tt> <tt class="py-name">g_count</tt><tt class="py-op">,</tt> <tt class="py-name">h_count</tt><tt class="py-op">,</tt> <tt id="link-749" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.warning
gui.analyses.auto_model_free.Mf_list.warning
gui.analyses.elements.model_list.Model_list.warning" class="py-name" href="#" onclick="return doclink('link-749', 'warning', 'link-733');">warning</a></tt> <tt class="py-op">=</tt> <tt id="link-750" class="py-name"><a title="pipe_control.results
specific_analyses.model_free.results
test_suite.system_tests.results
user_functions.results" class="py-name" href="#" onclick="return doclink('link-750', 'results', 'link-725');">results</a></tt> </tt>
<a name="L1353"></a><tt class="py-lineno">1353</tt>  <tt class="py-line"> </tt>
<a name="L1354"></a><tt class="py-lineno">1354</tt>  <tt class="py-line">        <tt class="py-comment"># Catch infinite chi-squared values.</tt> </tt>
<a name="L1355"></a><tt class="py-lineno">1355</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-751" class="py-name"><a title="lib.float.isInf" class="py-name" href="#" onclick="return doclink('link-751', 'isInf', 'link-22');">isInf</a></tt><tt class="py-op">(</tt><tt id="link-752" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func
target_functions.relax_fit.func" class="py-name" href="#" onclick="return doclink('link-752', 'func', 'link-524');">func</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1356"></a><tt class="py-lineno">1356</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-753" class="py-name"><a title="lib.errors.RelaxInfError" class="py-name" href="#" onclick="return doclink('link-753', 'RelaxInfError', 'link-14');">RelaxInfError</a></tt><tt class="py-op">(</tt><tt class="py-string">'chi-squared'</tt><tt class="py-op">)</tt> </tt>
<a name="L1357"></a><tt class="py-lineno">1357</tt>  <tt class="py-line"> </tt>
<a name="L1358"></a><tt class="py-lineno">1358</tt>  <tt class="py-line">        <tt class="py-comment"># Catch chi-squared values of NaN.</tt> </tt>
<a name="L1359"></a><tt class="py-lineno">1359</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-754" class="py-name"><a title="lib.float.isNaN" class="py-name" href="#" onclick="return doclink('link-754', 'isNaN', 'link-21');">isNaN</a></tt><tt class="py-op">(</tt><tt id="link-755" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func
target_functions.relax_fit.func" class="py-name" href="#" onclick="return doclink('link-755', 'func', 'link-524');">func</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1360"></a><tt class="py-lineno">1360</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-756" class="py-name"><a title="lib.errors.RelaxNaNError" class="py-name" href="#" onclick="return doclink('link-756', 'RelaxNaNError', 'link-15');">RelaxNaNError</a></tt><tt class="py-op">(</tt><tt class="py-string">'chi-squared'</tt><tt class="py-op">)</tt> </tt>
<a name="L1361"></a><tt class="py-lineno">1361</tt>  <tt class="py-line"> </tt>
<a name="L1362"></a><tt class="py-lineno">1362</tt>  <tt class="py-line">        <tt class="py-comment"># Make a last function call to update the back-calculated RDC and PCS structures to the optimal values.</tt> </tt>
<a name="L1363"></a><tt class="py-lineno">1363</tt>  <tt class="py-line">        <tt id="link-757" class="py-name"><a title="target_functions.chi2
target_functions.chi2.chi2" class="py-name" href="#" onclick="return doclink('link-757', 'chi2', 'link-522');">chi2</a></tt> <tt class="py-op">=</tt> <tt id="link-758" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model" class="py-name" href="#" onclick="return doclink('link-758', 'model', 'link-201');">model</a></tt><tt class="py-op">.</tt><tt id="link-759" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func
target_functions.relax_fit.func" class="py-name" href="#" onclick="return doclink('link-759', 'func', 'link-524');">func</a></tt><tt class="py-op">(</tt><tt class="py-name">param_vector</tt><tt class="py-op">)</tt> </tt>
<a name="L1364"></a><tt class="py-lineno">1364</tt>  <tt class="py-line"> </tt>
<a name="L1365"></a><tt class="py-lineno">1365</tt>  <tt class="py-line">        <tt class="py-comment"># Scaling.</tt> </tt>
<a name="L1366"></a><tt class="py-lineno">1366</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">scaling</tt><tt class="py-op">:</tt> </tt>
<a name="L1367"></a><tt class="py-lineno">1367</tt>  <tt class="py-line">            <tt class="py-name">param_vector</tt> <tt class="py-op">=</tt> <tt class="py-name">dot</tt><tt class="py-op">(</tt><tt class="py-name">scaling_matrix</tt><tt class="py-op">,</tt> <tt class="py-name">param_vector</tt><tt class="py-op">)</tt> </tt>
<a name="L1368"></a><tt class="py-lineno">1368</tt>  <tt class="py-line"> </tt>
<a name="L1369"></a><tt class="py-lineno">1369</tt>  <tt class="py-line">        <tt class="py-comment"># Disassemble the parameter vector.</tt> </tt>
<a name="L1370"></a><tt class="py-lineno">1370</tt>  <tt class="py-line">        <tt id="link-760" class="py-name"><a title="specific_analyses.n_state_model.parameters.disassemble_param_vector" class="py-name" href="#" onclick="return doclink('link-760', 'disassemble_param_vector', 'link-95');">disassemble_param_vector</a></tt><tt class="py-op">(</tt><tt class="py-name">param_vector</tt><tt class="py-op">=</tt><tt class="py-name">param_vector</tt><tt class="py-op">,</tt> <tt id="link-761" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-761', 'data_types', 'link-456');">data_types</a></tt><tt class="py-op">=</tt><tt id="link-762" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-762', 'data_types', 'link-456');">data_types</a></tt><tt class="py-op">,</tt> <tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">sim_index</tt><tt class="py-op">)</tt> </tt>
<a name="L1371"></a><tt class="py-lineno">1371</tt>  <tt class="py-line"> </tt>
<a name="L1372"></a><tt class="py-lineno">1372</tt>  <tt class="py-line">        <tt class="py-comment"># Monte Carlo minimisation statistics.</tt> </tt>
<a name="L1373"></a><tt class="py-lineno">1373</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">sim_index</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L1374"></a><tt class="py-lineno">1374</tt>  <tt class="py-line">            <tt class="py-comment"># Chi-squared statistic.</tt> </tt>
<a name="L1375"></a><tt class="py-lineno">1375</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">chi2_sim</tt><tt class="py-op">[</tt><tt class="py-name">sim_index</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-763" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func
target_functions.relax_fit.func" class="py-name" href="#" onclick="return doclink('link-763', 'func', 'link-524');">func</a></tt> </tt>
<a name="L1376"></a><tt class="py-lineno">1376</tt>  <tt class="py-line"> </tt>
<a name="L1377"></a><tt class="py-lineno">1377</tt>  <tt class="py-line">            <tt class="py-comment"># Iterations.</tt> </tt>
<a name="L1378"></a><tt class="py-lineno">1378</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">iter_sim</tt><tt class="py-op">[</tt><tt class="py-name">sim_index</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">iter_count</tt> </tt>
<a name="L1379"></a><tt class="py-lineno">1379</tt>  <tt class="py-line"> </tt>
<a name="L1380"></a><tt class="py-lineno">1380</tt>  <tt class="py-line">            <tt class="py-comment"># Function evaluations.</tt> </tt>
<a name="L1381"></a><tt class="py-lineno">1381</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">f_count_sim</tt><tt class="py-op">[</tt><tt class="py-name">sim_index</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">f_count</tt> </tt>
<a name="L1382"></a><tt class="py-lineno">1382</tt>  <tt class="py-line"> </tt>
<a name="L1383"></a><tt class="py-lineno">1383</tt>  <tt class="py-line">            <tt class="py-comment"># Gradient evaluations.</tt> </tt>
<a name="L1384"></a><tt class="py-lineno">1384</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">g_count_sim</tt><tt class="py-op">[</tt><tt class="py-name">sim_index</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">g_count</tt> </tt>
<a name="L1385"></a><tt class="py-lineno">1385</tt>  <tt class="py-line"> </tt>
<a name="L1386"></a><tt class="py-lineno">1386</tt>  <tt class="py-line">            <tt class="py-comment"># Hessian evaluations.</tt> </tt>
<a name="L1387"></a><tt class="py-lineno">1387</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">h_count_sim</tt><tt class="py-op">[</tt><tt class="py-name">sim_index</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">h_count</tt> </tt>
<a name="L1388"></a><tt class="py-lineno">1388</tt>  <tt class="py-line"> </tt>
<a name="L1389"></a><tt class="py-lineno">1389</tt>  <tt class="py-line">            <tt class="py-comment"># Warning.</tt> </tt>
<a name="L1390"></a><tt class="py-lineno">1390</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">warning_sim</tt><tt class="py-op">[</tt><tt class="py-name">sim_index</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-764" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.warning
gui.analyses.auto_model_free.Mf_list.warning
gui.analyses.elements.model_list.Model_list.warning" class="py-name" href="#" onclick="return doclink('link-764', 'warning', 'link-733');">warning</a></tt> </tt>
<a name="L1391"></a><tt class="py-lineno">1391</tt>  <tt class="py-line"> </tt>
<a name="L1392"></a><tt class="py-lineno">1392</tt>  <tt class="py-line">        <tt class="py-comment"># Normal statistics.</tt> </tt>
<a name="L1393"></a><tt class="py-lineno">1393</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1394"></a><tt class="py-lineno">1394</tt>  <tt class="py-line">            <tt class="py-comment"># Chi-squared statistic.</tt> </tt>
<a name="L1395"></a><tt class="py-lineno">1395</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-765" class="py-name"><a title="target_functions.chi2
target_functions.chi2.chi2" class="py-name" href="#" onclick="return doclink('link-765', 'chi2', 'link-522');">chi2</a></tt> <tt class="py-op">=</tt> <tt id="link-766" class="py-name"><a title="minfx.constraint_linear.Constraint_linear.func
target_functions.consistency_tests.Consistency.func
target_functions.ens_pivot_finder.Pivot_finder.func
target_functions.jw_mapping.Mapping.func
target_functions.relax_fit.func" class="py-name" href="#" onclick="return doclink('link-766', 'func', 'link-524');">func</a></tt> </tt>
<a name="L1396"></a><tt class="py-lineno">1396</tt>  <tt class="py-line"> </tt>
<a name="L1397"></a><tt class="py-lineno">1397</tt>  <tt class="py-line">            <tt class="py-comment"># Iterations.</tt> </tt>
<a name="L1398"></a><tt class="py-lineno">1398</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">iter</tt> <tt class="py-op">=</tt> <tt class="py-name">iter_count</tt> </tt>
<a name="L1399"></a><tt class="py-lineno">1399</tt>  <tt class="py-line"> </tt>
<a name="L1400"></a><tt class="py-lineno">1400</tt>  <tt class="py-line">            <tt class="py-comment"># Function evaluations.</tt> </tt>
<a name="L1401"></a><tt class="py-lineno">1401</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">f_count</tt> <tt class="py-op">=</tt> <tt class="py-name">f_count</tt> </tt>
<a name="L1402"></a><tt class="py-lineno">1402</tt>  <tt class="py-line"> </tt>
<a name="L1403"></a><tt class="py-lineno">1403</tt>  <tt class="py-line">            <tt class="py-comment"># Gradient evaluations.</tt> </tt>
<a name="L1404"></a><tt class="py-lineno">1404</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">g_count</tt> <tt class="py-op">=</tt> <tt class="py-name">g_count</tt> </tt>
<a name="L1405"></a><tt class="py-lineno">1405</tt>  <tt class="py-line"> </tt>
<a name="L1406"></a><tt class="py-lineno">1406</tt>  <tt class="py-line">            <tt class="py-comment"># Hessian evaluations.</tt> </tt>
<a name="L1407"></a><tt class="py-lineno">1407</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">h_count</tt> <tt class="py-op">=</tt> <tt class="py-name">h_count</tt> </tt>
<a name="L1408"></a><tt class="py-lineno">1408</tt>  <tt class="py-line"> </tt>
<a name="L1409"></a><tt class="py-lineno">1409</tt>  <tt class="py-line">            <tt class="py-comment"># Warning.</tt> </tt>
<a name="L1410"></a><tt class="py-lineno">1410</tt>  <tt class="py-line">            <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-767" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.warning
gui.analyses.auto_model_free.Mf_list.warning
gui.analyses.elements.model_list.Model_list.warning" class="py-name" href="#" onclick="return doclink('link-767', 'warning', 'link-733');">warning</a></tt> <tt class="py-op">=</tt> <tt id="link-768" class="py-name"><a title="gui.analyses.auto_model_free.Local_tm_list.warning
gui.analyses.auto_model_free.Mf_list.warning
gui.analyses.elements.model_list.Model_list.warning" class="py-name" href="#" onclick="return doclink('link-768', 'warning', 'link-733');">warning</a></tt> </tt>
<a name="L1411"></a><tt class="py-lineno">1411</tt>  <tt class="py-line"> </tt>
<a name="L1412"></a><tt class="py-lineno">1412</tt>  <tt class="py-line">        <tt class="py-comment"># Statistical analysis.</tt> </tt>
<a name="L1413"></a><tt class="py-lineno">1413</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">sim_index</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt> <tt class="py-keyword">and</tt> <tt class="py-op">(</tt><tt class="py-string">'rdc'</tt> <tt class="py-keyword">in</tt> <tt id="link-769" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-769', 'data_types', 'link-456');">data_types</a></tt> <tt class="py-keyword">or</tt> <tt class="py-string">'pcs'</tt> <tt class="py-keyword">in</tt> <tt id="link-770" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-770', 'data_types', 'link-456');">data_types</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1414"></a><tt class="py-lineno">1414</tt>  <tt class="py-line">            <tt class="py-comment"># Get the final back calculated data (for the Q-factor and</tt> </tt>
<a name="L1415"></a><tt class="py-lineno">1415</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-771" class="py-name"><a title="specific_analyses.n_state_model.N_state_model._minimise_bc_data" class="py-name" href="#" onclick="return doclink('link-771', '_minimise_bc_data', 'link-527');">_minimise_bc_data</a></tt><tt class="py-op">(</tt><tt id="link-772" class="py-name"><a title="lib.structure.pdb_read.model
lib.structure.pdb_write.model" class="py-name" href="#" onclick="return doclink('link-772', 'model', 'link-201');">model</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1416"></a><tt class="py-lineno">1416</tt>  <tt class="py-line"> </tt>
<a name="L1417"></a><tt class="py-lineno">1417</tt>  <tt class="py-line">            <tt class="py-comment"># Calculate the RDC Q-factors.</tt> </tt>
<a name="L1418"></a><tt class="py-lineno">1418</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-string">'rdc'</tt> <tt class="py-keyword">in</tt> <tt id="link-773" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-773', 'data_types', 'link-456');">data_types</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1419"></a><tt class="py-lineno">1419</tt>  <tt class="py-line">                <tt id="link-774" class="py-name"><a title="lib.alignment.rdc
pipe_control.rdc
test_suite.system_tests.rdc
user_functions.rdc" class="py-name" href="#" onclick="return doclink('link-774', 'rdc', 'link-58');">rdc</a></tt><tt class="py-op">.</tt><tt id="link-775" class="py-name"><a title="pipe_control.pcs.q_factors
pipe_control.rdc.q_factors" class="py-name" href="#" onclick="return doclink('link-775', 'q_factors', 'link-531');">q_factors</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L1420"></a><tt class="py-lineno">1420</tt>  <tt class="py-line"> </tt>
<a name="L1421"></a><tt class="py-lineno">1421</tt>  <tt class="py-line">            <tt class="py-comment"># Calculate the PCS Q-factors.</tt> </tt>
<a name="L1422"></a><tt class="py-lineno">1422</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-string">'pcs'</tt> <tt class="py-keyword">in</tt> <tt id="link-776" class="py-name"><a title="test_suite.unit_tests._prompt.data_types" class="py-name" href="#" onclick="return doclink('link-776', 'data_types', 'link-456');">data_types</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1423"></a><tt class="py-lineno">1423</tt>  <tt class="py-line">                <tt id="link-777" class="py-name"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-777', 'pcs', 'link-56');">pcs</a></tt><tt class="py-op">.</tt><tt id="link-778" class="py-name"><a title="pipe_control.pcs.q_factors
pipe_control.rdc.q_factors" class="py-name" href="#" onclick="return doclink('link-778', 'q_factors', 'link-531');">q_factors</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
</div><a name="L1424"></a><tt class="py-lineno">1424</tt>  <tt class="py-line"> </tt>
<a name="L1425"></a><tt class="py-lineno">1425</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.model_statistics"></a><div id="N_state_model.model_statistics-def"><a name="L1426"></a><tt class="py-lineno">1426</tt> <a class="py-toggle" href="#" id="N_state_model.model_statistics-toggle" onclick="return toggle('N_state_model.model_statistics');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#model_statistics">model_statistics</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">model_info</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">spin_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">global_stats</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.model_statistics-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model.model_statistics-expanded"><a name="L1427"></a><tt class="py-lineno">1427</tt>  <tt class="py-line">        <tt class="py-docstring">"""Return the k, n, and chi2 model statistics.</tt> </tt>
<a name="L1428"></a><tt class="py-lineno">1428</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1429"></a><tt class="py-lineno">1429</tt>  <tt class="py-line"><tt class="py-docstring">        k - number of parameters.</tt> </tt>
<a name="L1430"></a><tt class="py-lineno">1430</tt>  <tt class="py-line"><tt class="py-docstring">        n - number of data points.</tt> </tt>
<a name="L1431"></a><tt class="py-lineno">1431</tt>  <tt class="py-line"><tt class="py-docstring">        chi2 - the chi-squared value.</tt> </tt>
<a name="L1432"></a><tt class="py-lineno">1432</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1433"></a><tt class="py-lineno">1433</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1434"></a><tt class="py-lineno">1434</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword model_info:    The data returned from model_loop() (unused).</tt> </tt>
<a name="L1435"></a><tt class="py-lineno">1435</tt>  <tt class="py-line"><tt class="py-docstring">        @type model_info:       None</tt> </tt>
<a name="L1436"></a><tt class="py-lineno">1436</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword spin_id:       The spin identification string.  This is ignored in the N-state model.</tt> </tt>
<a name="L1437"></a><tt class="py-lineno">1437</tt>  <tt class="py-line"><tt class="py-docstring">        @type spin_id:          None or str</tt> </tt>
<a name="L1438"></a><tt class="py-lineno">1438</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword global_stats:  A parameter which determines if global or local statistics are returned.  For the N-state model, this argument is ignored.</tt> </tt>
<a name="L1439"></a><tt class="py-lineno">1439</tt>  <tt class="py-line"><tt class="py-docstring">        @type global_stats:     None or bool</tt> </tt>
<a name="L1440"></a><tt class="py-lineno">1440</tt>  <tt class="py-line"><tt class="py-docstring">        @return:                The optimisation statistics, in tuple format, of the number of parameters (k), the number of data points (n), and the chi-squared value (chi2).</tt> </tt>
<a name="L1441"></a><tt class="py-lineno">1441</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:                 tuple of (int, int, float)</tt> </tt>
<a name="L1442"></a><tt class="py-lineno">1442</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L1443"></a><tt class="py-lineno">1443</tt>  <tt class="py-line"> </tt>
<a name="L1444"></a><tt class="py-lineno">1444</tt>  <tt class="py-line">        <tt class="py-comment"># Return the values.</tt> </tt>
<a name="L1445"></a><tt class="py-lineno">1445</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt id="link-779" class="py-name"><a title="specific_analyses.n_state_model.parameters.param_num" class="py-name" href="#" onclick="return doclink('link-779', 'param_num', 'link-98');">param_num</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt id="link-780" class="py-name"><a title="specific_analyses.n_state_model.data.num_data_points" class="py-name" href="#" onclick="return doclink('link-780', 'num_data_points', 'link-85');">num_data_points</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt id="link-781" class="py-name"><a title="target_functions.chi2
target_functions.chi2.chi2" class="py-name" href="#" onclick="return doclink('link-781', 'chi2', 'link-522');">chi2</a></tt> </tt>
</div><a name="L1446"></a><tt class="py-lineno">1446</tt>  <tt class="py-line"> </tt>
<a name="L1447"></a><tt class="py-lineno">1447</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.return_data"></a><div id="N_state_model.return_data-def"><a name="L1448"></a><tt class="py-lineno">1448</tt> <a class="py-toggle" href="#" id="N_state_model.return_data-toggle" onclick="return toggle('N_state_model.return_data');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#return_data">return_data</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">data_id</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.return_data-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model.return_data-expanded"><a name="L1449"></a><tt class="py-lineno">1449</tt>  <tt class="py-line">        <tt class="py-docstring">"""Return the base data for the given data ID.</tt> </tt>
<a name="L1450"></a><tt class="py-lineno">1450</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1451"></a><tt class="py-lineno">1451</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword data_id:   The list of spin ID, data type, and alignment ID, as yielded by the base_data_loop() generator method.</tt> </tt>
<a name="L1452"></a><tt class="py-lineno">1452</tt>  <tt class="py-line"><tt class="py-docstring">        @type data_id:      list of str</tt> </tt>
<a name="L1453"></a><tt class="py-lineno">1453</tt>  <tt class="py-line"><tt class="py-docstring">        @return:            The base data.</tt> </tt>
<a name="L1454"></a><tt class="py-lineno">1454</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:             list of (float or None)</tt> </tt>
<a name="L1455"></a><tt class="py-lineno">1455</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L1456"></a><tt class="py-lineno">1456</tt>  <tt class="py-line"> </tt>
<a name="L1457"></a><tt class="py-lineno">1457</tt>  <tt class="py-line">        <tt class="py-comment"># Alias the spin or interatomic data container, data type and alignment ID.</tt> </tt>
<a name="L1458"></a><tt class="py-lineno">1458</tt>  <tt class="py-line">        <tt id="link-782" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-782', 'container', 'link-565');">container</a></tt> <tt class="py-op">=</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L1459"></a><tt class="py-lineno">1459</tt>  <tt class="py-line">        <tt id="link-783" class="py-name" targets="Method specific_analyses.api_base.API_base.data_type()=specific_analyses.api_base.API_base-class.html#data_type,Method specific_analyses.model_free.main.Model_free_main.data_type()=specific_analyses.model_free.main.Model_free_main-class.html#data_type"><a title="specific_analyses.api_base.API_base.data_type
specific_analyses.model_free.main.Model_free_main.data_type" class="py-name" href="#" onclick="return doclink('link-783', 'data_type', 'link-783');">data_type</a></tt> <tt class="py-op">=</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> </tt>
<a name="L1460"></a><tt class="py-lineno">1460</tt>  <tt class="py-line">        <tt class="py-name">align_id</tt> <tt class="py-op">=</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt> </tt>
<a name="L1461"></a><tt class="py-lineno">1461</tt>  <tt class="py-line"> </tt>
<a name="L1462"></a><tt class="py-lineno">1462</tt>  <tt class="py-line">        <tt class="py-comment"># The data structure to return.</tt> </tt>
<a name="L1463"></a><tt class="py-lineno">1463</tt>  <tt class="py-line">        <tt id="link-784" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-784', 'data', 'link-81');">data</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L1464"></a><tt class="py-lineno">1464</tt>  <tt class="py-line"> </tt>
<a name="L1465"></a><tt class="py-lineno">1465</tt>  <tt class="py-line">        <tt class="py-comment"># Skip deselected spins.</tt> </tt>
<a name="L1466"></a><tt class="py-lineno">1466</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'pcs'</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt id="link-785" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-785', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt id="link-786" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-786', 'select', 'link-196');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1467"></a><tt class="py-lineno">1467</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
<a name="L1468"></a><tt class="py-lineno">1468</tt>  <tt class="py-line"> </tt>
<a name="L1469"></a><tt class="py-lineno">1469</tt>  <tt class="py-line">        <tt class="py-comment"># Return the RDC data.</tt> </tt>
<a name="L1470"></a><tt class="py-lineno">1470</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-787" class="py-name"><a title="specific_analyses.api_base.API_base.data_type
specific_analyses.model_free.main.Model_free_main.data_type" class="py-name" href="#" onclick="return doclink('link-787', 'data_type', 'link-783');">data_type</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'rdc'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-788" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-788', 'container', 'link-565');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'rdc'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1471"></a><tt class="py-lineno">1471</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt id="link-789" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-789', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt id="link-790" class="py-name"><a title="lib.alignment.rdc
pipe_control.rdc
test_suite.system_tests.rdc
user_functions.rdc" class="py-name" href="#" onclick="return doclink('link-790', 'rdc', 'link-58');">rdc</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1472"></a><tt class="py-lineno">1472</tt>  <tt class="py-line">                <tt id="link-791" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-791', 'data', 'link-81');">data</a></tt><tt class="py-op">.</tt><tt id="link-792" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-792', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">None</tt><tt class="py-op">)</tt> </tt>
<a name="L1473"></a><tt class="py-lineno">1473</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1474"></a><tt class="py-lineno">1474</tt>  <tt class="py-line">                <tt id="link-793" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-793', 'data', 'link-81');">data</a></tt><tt class="py-op">.</tt><tt id="link-794" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-794', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt id="link-795" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-795', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt id="link-796" class="py-name"><a title="lib.alignment.rdc
pipe_control.rdc
test_suite.system_tests.rdc
user_functions.rdc" class="py-name" href="#" onclick="return doclink('link-796', 'rdc', 'link-58');">rdc</a></tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1475"></a><tt class="py-lineno">1475</tt>  <tt class="py-line"> </tt>
<a name="L1476"></a><tt class="py-lineno">1476</tt>  <tt class="py-line">        <tt class="py-comment"># Return the NOESY data.</tt> </tt>
<a name="L1477"></a><tt class="py-lineno">1477</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt id="link-797" class="py-name"><a title="specific_analyses.api_base.API_base.data_type
specific_analyses.model_free.main.Model_free_main.data_type" class="py-name" href="#" onclick="return doclink('link-797', 'data_type', 'link-783');">data_type</a></tt> <tt class="py-op">==</tt> <tt class="py-string">'noesy'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-798" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-798', 'container', 'link-565');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'noesy'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1478"></a><tt class="py-lineno">1478</tt>  <tt class="py-line">            <tt id="link-799" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-799', 'data', 'link-81');">data</a></tt><tt class="py-op">.</tt><tt id="link-800" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-800', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt id="link-801" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-801', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt id="link-802" class="py-name" targets="Module pipe_control.noesy=pipe_control.noesy-module.html"><a title="pipe_control.noesy" class="py-name" href="#" onclick="return doclink('link-802', 'noesy', 'link-802');">noesy</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1479"></a><tt class="py-lineno">1479</tt>  <tt class="py-line"> </tt>
<a name="L1480"></a><tt class="py-lineno">1480</tt>  <tt class="py-line">        <tt class="py-comment"># Return the PCS data.</tt> </tt>
<a name="L1481"></a><tt class="py-lineno">1481</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'pcs'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-803" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-803', 'container', 'link-565');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1482"></a><tt class="py-lineno">1482</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">align_id</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt id="link-804" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-804', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt id="link-805" class="py-name"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-805', 'pcs', 'link-56');">pcs</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1483"></a><tt class="py-lineno">1483</tt>  <tt class="py-line">                <tt id="link-806" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-806', 'data', 'link-81');">data</a></tt><tt class="py-op">.</tt><tt id="link-807" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-807', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">None</tt><tt class="py-op">)</tt> </tt>
<a name="L1484"></a><tt class="py-lineno">1484</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1485"></a><tt class="py-lineno">1485</tt>  <tt class="py-line">                <tt id="link-808" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-808', 'data', 'link-81');">data</a></tt><tt class="py-op">.</tt><tt id="link-809" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-809', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt id="link-810" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-810', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt id="link-811" class="py-name"><a title="lib.alignment.pcs
pipe_control.pcs
test_suite.system_tests.pcs
user_functions.pcs" class="py-name" href="#" onclick="return doclink('link-811', 'pcs', 'link-56');">pcs</a></tt><tt class="py-op">[</tt><tt class="py-name">align_id</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1486"></a><tt class="py-lineno">1486</tt>  <tt class="py-line"> </tt>
<a name="L1487"></a><tt class="py-lineno">1487</tt>  <tt class="py-line">        <tt class="py-comment"># Return the data.</tt> </tt>
<a name="L1488"></a><tt class="py-lineno">1488</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt id="link-812" class="py-name"><a title="specific_analyses.n_state_model.data
user_functions.data" class="py-name" href="#" onclick="return doclink('link-812', 'data', 'link-81');">data</a></tt> </tt>
</div><a name="L1489"></a><tt class="py-lineno">1489</tt>  <tt class="py-line"> </tt>
<a name="L1490"></a><tt class="py-lineno">1490</tt>  <tt class="py-line"> </tt>
<a name="L1491"></a><tt class="py-lineno">1491</tt>  <tt class="py-line">    <tt id="link-813" class="py-name" targets="Variable pipe_control.minimise.return_data_name_doc=pipe_control.minimise-module.html#return_data_name_doc,Variable specific_analyses.api_base.API_base.return_data_name_doc=specific_analyses.api_base.API_base-class.html#return_data_name_doc,Variable specific_analyses.consistency_tests.Consistency_tests.return_data_name_doc=specific_analyses.consistency_tests.Consistency_tests-class.html#return_data_name_doc,Variable specific_analyses.jw_mapping.Jw_mapping.return_data_name_doc=specific_analyses.jw_mapping.Jw_mapping-class.html#return_data_name_doc,Variable specific_analyses.model_free.main.Model_free_main.return_data_name_doc=specific_analyses.model_free.main.Model_free_main-class.html#return_data_name_doc,Variable specific_analyses.n_state_model.N_state_model.return_data_name_doc=specific_analyses.n_state_model.N_state_model-class.html#return_data_name_doc,Variable specific_analyses.noe.main.Noe_main.return_data_name_doc=specific_analyses.noe.main.Noe_main-class.html#return_data_name_doc,Variable specific_analyses.relax_fit.Relax_fit.return_data_name_doc=specific_analyses.relax_fit.Relax_fit-class.html#return_data_name_doc"><a title="pipe_control.minimise.return_data_name_doc
specific_analyses.api_base.API_base.return_data_name_doc
specific_analyses.consistency_tests.Consistency_tests.return_data_name_doc
specific_analyses.jw_mapping.Jw_mapping.return_data_name_doc
specific_analyses.model_free.main.Model_free_main.return_data_name_doc
specific_analyses.n_state_model.N_state_model.return_data_name_doc
specific_analyses.noe.main.Noe_main.return_data_name_doc
specific_analyses.relax_fit.Relax_fit.return_data_name_doc" class="py-name" href="#" onclick="return doclink('link-813', 'return_data_name_doc', 'link-813');">return_data_name_doc</a></tt> <tt class="py-op">=</tt> <tt id="link-814" class="py-name"><a title="user_functions.objects.Desc_container" class="py-name" href="#" onclick="return doclink('link-814', 'Desc_container', 'link-113');">Desc_container</a></tt><tt class="py-op">(</tt><tt class="py-string">"N-state model data type string matching patterns"</tt><tt class="py-op">)</tt> </tt>
<a name="L1492"></a><tt class="py-lineno">1492</tt>  <tt class="py-line">    <tt id="link-815" class="py-name"><a title="specific_analyses.consistency_tests.Consistency_tests._table
specific_analyses.jw_mapping.Jw_mapping._table
specific_analyses.model_free.main.Model_free_main._table
specific_analyses.n_state_model.N_state_model._table
specific_analyses.noe.main.Noe_main._table
specific_analyses.relax_fit.Relax_fit._table" class="py-name" href="#" onclick="return doclink('link-815', '_table', 'link-593');">_table</a></tt> <tt class="py-op">=</tt> <tt id="link-816" class="py-name"><a title="colour.uf_tables
docs.latex.fetch_docstrings.uf_tables
gui.uf_objects.uf_tables
gui.wizards.peak_intensity.uf_tables
pipe_control.diffusion_tensor.uf_tables
pipe_control.minimise.uf_tables
pipe_control.selection.uf_tables
prompt.uf_docstring.uf_tables
specific_analyses.consistency_tests.uf_tables
specific_analyses.jw_mapping.uf_tables
specific_analyses.model_free.macro_base.uf_tables
specific_analyses.model_free.main.uf_tables
specific_analyses.n_state_model.uf_tables
specific_analyses.noe.main.uf_tables
specific_analyses.relax_fit.uf_tables
user_functions.dx.uf_tables
user_functions.minimisation.uf_tables
user_functions.spectrum.uf_tables
user_functions.structure.uf_tables
user_functions.value.uf_tables" class="py-name" href="#" onclick="return doclink('link-816', 'uf_tables', 'link-109');">uf_tables</a></tt><tt class="py-op">.</tt><tt id="link-817" class="py-name"><a title="gui.pipe_editor.Pipe_editor.add_table
user_functions.data.Uf_tables.add_table
user_functions.objects.Desc_container.add_table" class="py-name" href="#" onclick="return doclink('link-817', 'add_table', 'link-595');">add_table</a></tt><tt class="py-op">(</tt><tt id="link-818" class="py-name"><a title="bmrblib.assembly_supercategory.entity.EntitySaveframe.label
bmrblib.citations.citations.CitationsSaveframe.label
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.label
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.label
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.label
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.label
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.label
gui.analyses.auto_noe.Auto_noe.label
gui.analyses.auto_r1.Auto_r1.label
gui.analyses.auto_r2.Auto_r2.label
gui.analyses.auto_rx_base.Auto_rx.label" class="py-name" href="#" onclick="return doclink('link-818', 'label', 'link-596');">label</a></tt><tt class="py-op">=</tt><tt class="py-string">"table: N-state data type patterns"</tt><tt class="py-op">,</tt> <tt class="py-name">caption</tt><tt class="py-op">=</tt><tt class="py-string">"N-state model data type string matching patterns."</tt><tt class="py-op">)</tt> </tt>
<a name="L1493"></a><tt class="py-lineno">1493</tt>  <tt class="py-line">    <tt id="link-819" class="py-name"><a title="specific_analyses.consistency_tests.Consistency_tests._table
specific_analyses.jw_mapping.Jw_mapping._table
specific_analyses.model_free.main.Model_free_main._table
specific_analyses.n_state_model.N_state_model._table
specific_analyses.noe.main.Noe_main._table
specific_analyses.relax_fit.Relax_fit._table" class="py-name" href="#" onclick="return doclink('link-819', '_table', 'link-593');">_table</a></tt><tt class="py-op">.</tt><tt id="link-820" class="py-name"><a title="user_functions.objects.Table.add_headings" class="py-name" href="#" onclick="return doclink('link-820', 'add_headings', 'link-598');">add_headings</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-string">"Data type"</tt><tt class="py-op">,</tt> <tt class="py-string">"Object name"</tt><tt class="py-op">,</tt> <tt class="py-string">"Patterns"</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1494"></a><tt class="py-lineno">1494</tt>  <tt class="py-line">    <tt id="link-821" class="py-name"><a title="specific_analyses.consistency_tests.Consistency_tests._table
specific_analyses.jw_mapping.Jw_mapping._table
specific_analyses.model_free.main.Model_free_main._table
specific_analyses.n_state_model.N_state_model._table
specific_analyses.noe.main.Noe_main._table
specific_analyses.relax_fit.Relax_fit._table" class="py-name" href="#" onclick="return doclink('link-821', '_table', 'link-593');">_table</a></tt><tt class="py-op">.</tt><tt id="link-822" class="py-name"><a title="user_functions.objects.Table.add_row" class="py-name" href="#" onclick="return doclink('link-822', 'add_row', 'link-600');">add_row</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-string">"Probabilities"</tt><tt class="py-op">,</tt> <tt class="py-string">"'probs'"</tt><tt class="py-op">,</tt> <tt class="py-string">"'p0', 'p1', 'p2', ..., 'pN'"</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1495"></a><tt class="py-lineno">1495</tt>  <tt class="py-line">    <tt id="link-823" class="py-name"><a title="specific_analyses.consistency_tests.Consistency_tests._table
specific_analyses.jw_mapping.Jw_mapping._table
specific_analyses.model_free.main.Model_free_main._table
specific_analyses.n_state_model.N_state_model._table
specific_analyses.noe.main.Noe_main._table
specific_analyses.relax_fit.Relax_fit._table" class="py-name" href="#" onclick="return doclink('link-823', '_table', 'link-593');">_table</a></tt><tt class="py-op">.</tt><tt id="link-824" class="py-name"><a title="user_functions.objects.Table.add_row" class="py-name" href="#" onclick="return doclink('link-824', 'add_row', 'link-600');">add_row</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-string">"Euler angle alpha"</tt><tt class="py-op">,</tt> <tt class="py-string">"'alpha'"</tt><tt class="py-op">,</tt> <tt class="py-string">"'alpha0', 'alpha1', ..."</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1496"></a><tt class="py-lineno">1496</tt>  <tt class="py-line">    <tt id="link-825" class="py-name"><a title="specific_analyses.consistency_tests.Consistency_tests._table
specific_analyses.jw_mapping.Jw_mapping._table
specific_analyses.model_free.main.Model_free_main._table
specific_analyses.n_state_model.N_state_model._table
specific_analyses.noe.main.Noe_main._table
specific_analyses.relax_fit.Relax_fit._table" class="py-name" href="#" onclick="return doclink('link-825', '_table', 'link-593');">_table</a></tt><tt class="py-op">.</tt><tt id="link-826" class="py-name"><a title="user_functions.objects.Table.add_row" class="py-name" href="#" onclick="return doclink('link-826', 'add_row', 'link-600');">add_row</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-string">"Euler angle beta"</tt><tt class="py-op">,</tt> <tt class="py-string">"'beta'"</tt><tt class="py-op">,</tt> <tt class="py-string">"'beta0', 'beta1', ..."</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1497"></a><tt class="py-lineno">1497</tt>  <tt class="py-line">    <tt id="link-827" class="py-name"><a title="specific_analyses.consistency_tests.Consistency_tests._table
specific_analyses.jw_mapping.Jw_mapping._table
specific_analyses.model_free.main.Model_free_main._table
specific_analyses.n_state_model.N_state_model._table
specific_analyses.noe.main.Noe_main._table
specific_analyses.relax_fit.Relax_fit._table" class="py-name" href="#" onclick="return doclink('link-827', '_table', 'link-593');">_table</a></tt><tt class="py-op">.</tt><tt id="link-828" class="py-name"><a title="user_functions.objects.Table.add_row" class="py-name" href="#" onclick="return doclink('link-828', 'add_row', 'link-600');">add_row</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-string">"Euler angle gamma"</tt><tt class="py-op">,</tt> <tt class="py-string">"'gamma'"</tt><tt class="py-op">,</tt> <tt class="py-string">"'gamma0', 'gamma1', ..."</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1498"></a><tt class="py-lineno">1498</tt>  <tt class="py-line">    <tt id="link-829" class="py-name"><a title="specific_analyses.consistency_tests.Consistency_tests._table
specific_analyses.jw_mapping.Jw_mapping._table
specific_analyses.model_free.main.Model_free_main._table
specific_analyses.n_state_model.N_state_model._table
specific_analyses.noe.main.Noe_main._table
specific_analyses.relax_fit.Relax_fit._table" class="py-name" href="#" onclick="return doclink('link-829', '_table', 'link-593');">_table</a></tt><tt class="py-op">.</tt><tt id="link-830" class="py-name"><a title="user_functions.objects.Table.add_row" class="py-name" href="#" onclick="return doclink('link-830', 'add_row', 'link-600');">add_row</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-string">"Bond length"</tt><tt class="py-op">,</tt> <tt class="py-string">"'r'"</tt><tt class="py-op">,</tt> <tt class="py-string">"'^r$' or '[Bb]ond[ -_][Ll]ength'"</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1499"></a><tt class="py-lineno">1499</tt>  <tt class="py-line">    <tt id="link-831" class="py-name"><a title="specific_analyses.consistency_tests.Consistency_tests._table
specific_analyses.jw_mapping.Jw_mapping._table
specific_analyses.model_free.main.Model_free_main._table
specific_analyses.n_state_model.N_state_model._table
specific_analyses.noe.main.Noe_main._table
specific_analyses.relax_fit.Relax_fit._table" class="py-name" href="#" onclick="return doclink('link-831', '_table', 'link-593');">_table</a></tt><tt class="py-op">.</tt><tt id="link-832" class="py-name"><a title="user_functions.objects.Table.add_row" class="py-name" href="#" onclick="return doclink('link-832', 'add_row', 'link-600');">add_row</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-string">"Heteronucleus type"</tt><tt class="py-op">,</tt> <tt class="py-string">"'heteronuc_type'"</tt><tt class="py-op">,</tt> <tt class="py-string">"'^[Hh]eteronucleus$'"</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1500"></a><tt class="py-lineno">1500</tt>  <tt class="py-line">    <tt id="link-833" class="py-name"><a title="specific_analyses.consistency_tests.Consistency_tests._table
specific_analyses.jw_mapping.Jw_mapping._table
specific_analyses.model_free.main.Model_free_main._table
specific_analyses.n_state_model.N_state_model._table
specific_analyses.noe.main.Noe_main._table
specific_analyses.relax_fit.Relax_fit._table" class="py-name" href="#" onclick="return doclink('link-833', '_table', 'link-593');">_table</a></tt><tt class="py-op">.</tt><tt id="link-834" class="py-name"><a title="user_functions.objects.Table.add_row" class="py-name" href="#" onclick="return doclink('link-834', 'add_row', 'link-600');">add_row</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-string">"Proton type"</tt><tt class="py-op">,</tt> <tt class="py-string">"'proton_type'"</tt><tt class="py-op">,</tt> <tt class="py-string">"'^[Pp]roton$'"</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1501"></a><tt class="py-lineno">1501</tt>  <tt class="py-line">    <tt id="link-835" class="py-name"><a title="pipe_control.minimise.return_data_name_doc
specific_analyses.api_base.API_base.return_data_name_doc
specific_analyses.consistency_tests.Consistency_tests.return_data_name_doc
specific_analyses.jw_mapping.Jw_mapping.return_data_name_doc
specific_analyses.model_free.main.Model_free_main.return_data_name_doc
specific_analyses.n_state_model.N_state_model.return_data_name_doc
specific_analyses.noe.main.Noe_main.return_data_name_doc
specific_analyses.relax_fit.Relax_fit.return_data_name_doc" class="py-name" href="#" onclick="return doclink('link-835', 'return_data_name_doc', 'link-813');">return_data_name_doc</a></tt><tt class="py-op">.</tt><tt id="link-836" class="py-name"><a title="gui.pipe_editor.Pipe_editor.add_table
user_functions.data.Uf_tables.add_table
user_functions.objects.Desc_container.add_table" class="py-name" href="#" onclick="return doclink('link-836', 'add_table', 'link-595');">add_table</a></tt><tt class="py-op">(</tt><tt id="link-837" class="py-name"><a title="specific_analyses.consistency_tests.Consistency_tests._table
specific_analyses.jw_mapping.Jw_mapping._table
specific_analyses.model_free.main.Model_free_main._table
specific_analyses.n_state_model.N_state_model._table
specific_analyses.noe.main.Noe_main._table
specific_analyses.relax_fit.Relax_fit._table" class="py-name" href="#" onclick="return doclink('link-837', '_table', 'link-593');">_table</a></tt><tt class="py-op">.</tt><tt id="link-838" class="py-name"><a title="bmrblib.assembly_supercategory.entity.EntitySaveframe.label
bmrblib.citations.citations.CitationsSaveframe.label
bmrblib.kinetics.heteronucl_NOEs_v2_1.HeteronuclNOESaveframe_v2_1.label
bmrblib.kinetics.heteronucl_T1_relaxation_v2_1.HeteronuclT1Saveframe_v2_1.label
bmrblib.kinetics.heteronucl_T1_relaxation_v3_1.HeteronuclT1Saveframe_v3_1.label
bmrblib.kinetics.heteronucl_T2_relaxation_v2_1.HeteronuclT2Saveframe_v2_1.label
bmrblib.kinetics.heteronucl_T2_relaxation_v3_1.HeteronuclT2Saveframe_v3_1.label
gui.analyses.auto_noe.Auto_noe.label
gui.analyses.auto_r1.Auto_r1.label
gui.analyses.auto_r2.Auto_r2.label
gui.analyses.auto_rx_base.Auto_rx.label" class="py-name" href="#" onclick="return doclink('link-838', 'label', 'link-596');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L1502"></a><tt class="py-lineno">1502</tt>  <tt class="py-line">    <tt id="link-839" class="py-name"><a title="pipe_control.minimise.return_data_name_doc
specific_analyses.api_base.API_base.return_data_name_doc
specific_analyses.consistency_tests.Consistency_tests.return_data_name_doc
specific_analyses.jw_mapping.Jw_mapping.return_data_name_doc
specific_analyses.model_free.main.Model_free_main.return_data_name_doc
specific_analyses.n_state_model.N_state_model.return_data_name_doc
specific_analyses.noe.main.Noe_main.return_data_name_doc
specific_analyses.relax_fit.Relax_fit.return_data_name_doc" class="py-name" href="#" onclick="return doclink('link-839', 'return_data_name_doc', 'link-813');">return_data_name_doc</a></tt><tt class="py-op">.</tt><tt id="link-840" class="py-name"><a title="user_functions.objects.Desc_container.add_paragraph" class="py-name" href="#" onclick="return doclink('link-840', 'add_paragraph', 'link-612');">add_paragraph</a></tt><tt class="py-op">(</tt><tt class="py-string">"The objects corresponding to the object names are lists (or arrays) with each element corrsponding to each state."</tt><tt class="py-op">)</tt> </tt>
<a name="L1503"></a><tt class="py-lineno">1503</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.return_data_name"></a><div id="N_state_model.return_data_name-def"><a name="L1504"></a><tt class="py-lineno">1504</tt> <a class="py-toggle" href="#" id="N_state_model.return_data_name-toggle" onclick="return toggle('N_state_model.return_data_name');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#return_data_name">return_data_name</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">param</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.return_data_name-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model.return_data_name-expanded"><a name="L1505"></a><tt class="py-lineno">1505</tt>  <tt class="py-line">        <tt class="py-docstring">"""Return a unique identifying string for the N-state model parameter.</tt> </tt>
<a name="L1506"></a><tt class="py-lineno">1506</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1507"></a><tt class="py-lineno">1507</tt>  <tt class="py-line"><tt class="py-docstring">        @param param:   The N-state model parameter.</tt> </tt>
<a name="L1508"></a><tt class="py-lineno">1508</tt>  <tt class="py-line"><tt class="py-docstring">        @type param:    str</tt> </tt>
<a name="L1509"></a><tt class="py-lineno">1509</tt>  <tt class="py-line"><tt class="py-docstring">        @return:        The unique parameter identifying string.</tt> </tt>
<a name="L1510"></a><tt class="py-lineno">1510</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:         str</tt> </tt>
<a name="L1511"></a><tt class="py-lineno">1511</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L1512"></a><tt class="py-lineno">1512</tt>  <tt class="py-line"> </tt>
<a name="L1513"></a><tt class="py-lineno">1513</tt>  <tt class="py-line">        <tt class="py-comment"># Probability.</tt> </tt>
<a name="L1514"></a><tt class="py-lineno">1514</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-841" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-841', 'search', 'link-7');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'^p[0-9]*$'</tt><tt class="py-op">,</tt> <tt class="py-name">param</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1515"></a><tt class="py-lineno">1515</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-string">'probs'</tt> </tt>
<a name="L1516"></a><tt class="py-lineno">1516</tt>  <tt class="py-line"> </tt>
<a name="L1517"></a><tt class="py-lineno">1517</tt>  <tt class="py-line">        <tt class="py-comment"># Alpha Euler angle.</tt> </tt>
<a name="L1518"></a><tt class="py-lineno">1518</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-842" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-842', 'search', 'link-7');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'^alpha'</tt><tt class="py-op">,</tt> <tt class="py-name">param</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1519"></a><tt class="py-lineno">1519</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-string">'alpha'</tt> </tt>
<a name="L1520"></a><tt class="py-lineno">1520</tt>  <tt class="py-line"> </tt>
<a name="L1521"></a><tt class="py-lineno">1521</tt>  <tt class="py-line">        <tt class="py-comment"># Beta Euler angle.</tt> </tt>
<a name="L1522"></a><tt class="py-lineno">1522</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-843" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-843', 'search', 'link-7');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'^beta'</tt><tt class="py-op">,</tt> <tt class="py-name">param</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1523"></a><tt class="py-lineno">1523</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-string">'beta'</tt> </tt>
<a name="L1524"></a><tt class="py-lineno">1524</tt>  <tt class="py-line"> </tt>
<a name="L1525"></a><tt class="py-lineno">1525</tt>  <tt class="py-line">        <tt class="py-comment"># Gamma Euler angle.</tt> </tt>
<a name="L1526"></a><tt class="py-lineno">1526</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-844" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-844', 'search', 'link-7');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'^gamma'</tt><tt class="py-op">,</tt> <tt class="py-name">param</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1527"></a><tt class="py-lineno">1527</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-string">'gamma'</tt> </tt>
<a name="L1528"></a><tt class="py-lineno">1528</tt>  <tt class="py-line"> </tt>
<a name="L1529"></a><tt class="py-lineno">1529</tt>  <tt class="py-line">        <tt class="py-comment"># Bond length.</tt> </tt>
<a name="L1530"></a><tt class="py-lineno">1530</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-845" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-845', 'search', 'link-7');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'^r$'</tt><tt class="py-op">,</tt> <tt class="py-name">param</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt id="link-846" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-846', 'search', 'link-7');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'[Bb]ond[ -_][Ll]ength'</tt><tt class="py-op">,</tt> <tt class="py-name">param</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1531"></a><tt class="py-lineno">1531</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-string">'r'</tt> </tt>
<a name="L1532"></a><tt class="py-lineno">1532</tt>  <tt class="py-line"> </tt>
<a name="L1533"></a><tt class="py-lineno">1533</tt>  <tt class="py-line">        <tt class="py-comment"># Heteronucleus type.</tt> </tt>
<a name="L1534"></a><tt class="py-lineno">1534</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">param</tt> <tt class="py-op">==</tt> <tt class="py-string">'heteronuc_type'</tt><tt class="py-op">:</tt> </tt>
<a name="L1535"></a><tt class="py-lineno">1535</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-string">'heteronuc_type'</tt> </tt>
<a name="L1536"></a><tt class="py-lineno">1536</tt>  <tt class="py-line"> </tt>
<a name="L1537"></a><tt class="py-lineno">1537</tt>  <tt class="py-line">        <tt class="py-comment"># Proton type.</tt> </tt>
<a name="L1538"></a><tt class="py-lineno">1538</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">param</tt> <tt class="py-op">==</tt> <tt class="py-string">'proton_type'</tt><tt class="py-op">:</tt> </tt>
<a name="L1539"></a><tt class="py-lineno">1539</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-string">'proton_type'</tt> </tt>
<a name="L1540"></a><tt class="py-lineno">1540</tt>  <tt class="py-line"> </tt>
<a name="L1541"></a><tt class="py-lineno">1541</tt>  <tt class="py-line">        <tt class="py-comment"># Paramagnetic centre.</tt> </tt>
<a name="L1542"></a><tt class="py-lineno">1542</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-847" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-847', 'search', 'link-7');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'^paramag_[xyz]$'</tt><tt class="py-op">,</tt> <tt class="py-name">param</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1543"></a><tt class="py-lineno">1543</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">param</tt> </tt>
</div><a name="L1544"></a><tt class="py-lineno">1544</tt>  <tt class="py-line"> </tt>
<a name="L1545"></a><tt class="py-lineno">1545</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.return_error"></a><div id="N_state_model.return_error-def"><a name="L1546"></a><tt class="py-lineno">1546</tt> <a class="py-toggle" href="#" id="N_state_model.return_error-toggle" onclick="return toggle('N_state_model.return_error');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#return_error">return_error</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">data_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.return_error-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model.return_error-expanded"><a name="L1547"></a><tt class="py-lineno">1547</tt>  <tt class="py-line">        <tt class="py-docstring">"""Create and return the spin specific Monte Carlo Ri error structure.</tt> </tt>
<a name="L1548"></a><tt class="py-lineno">1548</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1549"></a><tt class="py-lineno">1549</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword data_id:   The list of spin ID, data type, and alignment ID, as yielded by the base_data_loop() generator method.</tt> </tt>
<a name="L1550"></a><tt class="py-lineno">1550</tt>  <tt class="py-line"><tt class="py-docstring">        @type data_id:      str</tt> </tt>
<a name="L1551"></a><tt class="py-lineno">1551</tt>  <tt class="py-line"><tt class="py-docstring">        @return:            The Monte Carlo simulation data errors.</tt> </tt>
<a name="L1552"></a><tt class="py-lineno">1552</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:             list of float</tt> </tt>
<a name="L1553"></a><tt class="py-lineno">1553</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L1554"></a><tt class="py-lineno">1554</tt>  <tt class="py-line"> </tt>
<a name="L1555"></a><tt class="py-lineno">1555</tt>  <tt class="py-line">        <tt class="py-comment"># Initialise the MC data structure.</tt> </tt>
<a name="L1556"></a><tt class="py-lineno">1556</tt>  <tt class="py-line">        <tt class="py-name">mc_errors</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L1557"></a><tt class="py-lineno">1557</tt>  <tt class="py-line"> </tt>
<a name="L1558"></a><tt class="py-lineno">1558</tt>  <tt class="py-line">        <tt class="py-comment"># Alias the spin or interatomic data container.</tt> </tt>
<a name="L1559"></a><tt class="py-lineno">1559</tt>  <tt class="py-line">        <tt id="link-848" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-848', 'container', 'link-565');">container</a></tt> <tt class="py-op">=</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L1560"></a><tt class="py-lineno">1560</tt>  <tt class="py-line"> </tt>
<a name="L1561"></a><tt class="py-lineno">1561</tt>  <tt class="py-line">        <tt class="py-comment"># Skip deselected spins.</tt> </tt>
<a name="L1562"></a><tt class="py-lineno">1562</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'pcs'</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt id="link-849" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-849', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt id="link-850" class="py-name"><a title="pipe_control.model_selection.select
user_functions.select" class="py-name" href="#" onclick="return doclink('link-850', 'select', 'link-196');">select</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1563"></a><tt class="py-lineno">1563</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
<a name="L1564"></a><tt class="py-lineno">1564</tt>  <tt class="py-line"> </tt>
<a name="L1565"></a><tt class="py-lineno">1565</tt>  <tt class="py-line">        <tt class="py-comment"># RDC data.</tt> </tt>
<a name="L1566"></a><tt class="py-lineno">1566</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'rdc'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-851" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-851', 'container', 'link-565');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'rdc'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1567"></a><tt class="py-lineno">1567</tt>  <tt class="py-line">            <tt class="py-comment"># Do errors exist?</tt> </tt>
<a name="L1568"></a><tt class="py-lineno">1568</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-852" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-852', 'container', 'link-565');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'rdc_err'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1569"></a><tt class="py-lineno">1569</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-853" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-853', 'RelaxError', 'link-13');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The RDC errors are missing for the spin pair '%s' and '%s'."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt id="link-854" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-854', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">spin_id1</tt><tt class="py-op">,</tt> <tt id="link-855" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-855', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">spin_id2</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1570"></a><tt class="py-lineno">1570</tt>  <tt class="py-line"> </tt>
<a name="L1571"></a><tt class="py-lineno">1571</tt>  <tt class="py-line">            <tt class="py-comment"># The error.</tt> </tt>
<a name="L1572"></a><tt class="py-lineno">1572</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt id="link-856" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-856', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_err</tt><tt class="py-op">:</tt> </tt>
<a name="L1573"></a><tt class="py-lineno">1573</tt>  <tt class="py-line">                <tt class="py-name">err</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L1574"></a><tt class="py-lineno">1574</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1575"></a><tt class="py-lineno">1575</tt>  <tt class="py-line">                <tt class="py-name">err</tt> <tt class="py-op">=</tt> <tt id="link-857" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-857', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_err</tt><tt class="py-op">[</tt><tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">]</tt> </tt>
<a name="L1576"></a><tt class="py-lineno">1576</tt>  <tt class="py-line"> </tt>
<a name="L1577"></a><tt class="py-lineno">1577</tt>  <tt class="py-line">            <tt class="py-comment"># Append the data.</tt> </tt>
<a name="L1578"></a><tt class="py-lineno">1578</tt>  <tt class="py-line">            <tt class="py-name">mc_errors</tt><tt class="py-op">.</tt><tt id="link-858" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-858', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">err</tt><tt class="py-op">)</tt> </tt>
<a name="L1579"></a><tt class="py-lineno">1579</tt>  <tt class="py-line"> </tt>
<a name="L1580"></a><tt class="py-lineno">1580</tt>  <tt class="py-line">        <tt class="py-comment"># NOESY data.</tt> </tt>
<a name="L1581"></a><tt class="py-lineno">1581</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'noesy'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-859" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-859', 'container', 'link-565');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'noesy'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1582"></a><tt class="py-lineno">1582</tt>  <tt class="py-line">            <tt class="py-comment"># Do errors exist?</tt> </tt>
<a name="L1583"></a><tt class="py-lineno">1583</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-860" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-860', 'container', 'link-565');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'noesy_err'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1584"></a><tt class="py-lineno">1584</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-861" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-861', 'RelaxError', 'link-13');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The NOESY errors are missing for the spin pair '%s' and '%s'."</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt id="link-862" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-862', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">spin_id1</tt><tt class="py-op">,</tt> <tt id="link-863" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-863', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">spin_id2</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L1585"></a><tt class="py-lineno">1585</tt>  <tt class="py-line"> </tt>
<a name="L1586"></a><tt class="py-lineno">1586</tt>  <tt class="py-line">            <tt class="py-comment"># Append the data.</tt> </tt>
<a name="L1587"></a><tt class="py-lineno">1587</tt>  <tt class="py-line">            <tt class="py-name">mc_errors</tt><tt class="py-op">.</tt><tt id="link-864" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-864', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt id="link-865" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-865', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">noesy_err</tt><tt class="py-op">)</tt> </tt>
<a name="L1588"></a><tt class="py-lineno">1588</tt>  <tt class="py-line"> </tt>
<a name="L1589"></a><tt class="py-lineno">1589</tt>  <tt class="py-line">        <tt class="py-comment"># PCS data.</tt> </tt>
<a name="L1590"></a><tt class="py-lineno">1590</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'pcs'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-866" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-866', 'container', 'link-565');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1591"></a><tt class="py-lineno">1591</tt>  <tt class="py-line">            <tt class="py-comment"># Do errors exist?</tt> </tt>
<a name="L1592"></a><tt class="py-lineno">1592</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-867" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-867', 'container', 'link-565');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_err'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1593"></a><tt class="py-lineno">1593</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-868" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-868', 'RelaxError', 'link-13');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The PCS errors are missing for spin '%s'."</tt> <tt class="py-op">%</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1594"></a><tt class="py-lineno">1594</tt>  <tt class="py-line"> </tt>
<a name="L1595"></a><tt class="py-lineno">1595</tt>  <tt class="py-line">            <tt class="py-comment"># The error.</tt> </tt>
<a name="L1596"></a><tt class="py-lineno">1596</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt id="link-869" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-869', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt><tt class="py-op">:</tt> </tt>
<a name="L1597"></a><tt class="py-lineno">1597</tt>  <tt class="py-line">                <tt class="py-name">err</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L1598"></a><tt class="py-lineno">1598</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1599"></a><tt class="py-lineno">1599</tt>  <tt class="py-line">                <tt class="py-name">err</tt> <tt class="py-op">=</tt> <tt id="link-870" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-870', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_err</tt><tt class="py-op">[</tt><tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">]</tt> </tt>
<a name="L1600"></a><tt class="py-lineno">1600</tt>  <tt class="py-line"> </tt>
<a name="L1601"></a><tt class="py-lineno">1601</tt>  <tt class="py-line">            <tt class="py-comment"># Append the data.</tt> </tt>
<a name="L1602"></a><tt class="py-lineno">1602</tt>  <tt class="py-line">            <tt class="py-name">mc_errors</tt><tt class="py-op">.</tt><tt id="link-871" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-871', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">err</tt><tt class="py-op">)</tt> </tt>
<a name="L1603"></a><tt class="py-lineno">1603</tt>  <tt class="py-line"> </tt>
<a name="L1604"></a><tt class="py-lineno">1604</tt>  <tt class="py-line">        <tt class="py-comment"># Return the errors.</tt> </tt>
<a name="L1605"></a><tt class="py-lineno">1605</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">mc_errors</tt> </tt>
</div><a name="L1606"></a><tt class="py-lineno">1606</tt>  <tt class="py-line"> </tt>
<a name="L1607"></a><tt class="py-lineno">1607</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.return_grace_string"></a><div id="N_state_model.return_grace_string-def"><a name="L1608"></a><tt class="py-lineno">1608</tt> <a class="py-toggle" href="#" id="N_state_model.return_grace_string-toggle" onclick="return toggle('N_state_model.return_grace_string');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#return_grace_string">return_grace_string</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">param</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.return_grace_string-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model.return_grace_string-expanded"><a name="L1609"></a><tt class="py-lineno">1609</tt>  <tt class="py-line">        <tt class="py-docstring">"""Return the Grace string representation of the parameter.</tt> </tt>
<a name="L1610"></a><tt class="py-lineno">1610</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1611"></a><tt class="py-lineno">1611</tt>  <tt class="py-line"><tt class="py-docstring">        This is used for axis labelling.</tt> </tt>
<a name="L1612"></a><tt class="py-lineno">1612</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1613"></a><tt class="py-lineno">1613</tt>  <tt class="py-line"><tt class="py-docstring">        @param param:   The specific analysis parameter.</tt> </tt>
<a name="L1614"></a><tt class="py-lineno">1614</tt>  <tt class="py-line"><tt class="py-docstring">        @type param:    str</tt> </tt>
<a name="L1615"></a><tt class="py-lineno">1615</tt>  <tt class="py-line"><tt class="py-docstring">        @return:        The Grace string representation of the parameter.</tt> </tt>
<a name="L1616"></a><tt class="py-lineno">1616</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:         str</tt> </tt>
<a name="L1617"></a><tt class="py-lineno">1617</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L1618"></a><tt class="py-lineno">1618</tt>  <tt class="py-line"> </tt>
<a name="L1619"></a><tt class="py-lineno">1619</tt>  <tt class="py-line">        <tt class="py-comment"># The measured PCS.</tt> </tt>
<a name="L1620"></a><tt class="py-lineno">1620</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">param</tt> <tt class="py-op">==</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">:</tt> </tt>
<a name="L1621"></a><tt class="py-lineno">1621</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-string">"Measured PCS"</tt> </tt>
<a name="L1622"></a><tt class="py-lineno">1622</tt>  <tt class="py-line"> </tt>
<a name="L1623"></a><tt class="py-lineno">1623</tt>  <tt class="py-line">        <tt class="py-comment"># The back-calculated PCS.</tt> </tt>
<a name="L1624"></a><tt class="py-lineno">1624</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">param</tt> <tt class="py-op">==</tt> <tt class="py-string">'pcs_bc'</tt><tt class="py-op">:</tt> </tt>
<a name="L1625"></a><tt class="py-lineno">1625</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-string">"Back-calculated PCS"</tt> </tt>
<a name="L1626"></a><tt class="py-lineno">1626</tt>  <tt class="py-line"> </tt>
<a name="L1627"></a><tt class="py-lineno">1627</tt>  <tt class="py-line">        <tt class="py-comment"># The measured RDC.</tt> </tt>
<a name="L1628"></a><tt class="py-lineno">1628</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">param</tt> <tt class="py-op">==</tt> <tt class="py-string">'rdc'</tt><tt class="py-op">:</tt> </tt>
<a name="L1629"></a><tt class="py-lineno">1629</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-string">"Measured RDC"</tt> </tt>
<a name="L1630"></a><tt class="py-lineno">1630</tt>  <tt class="py-line"> </tt>
<a name="L1631"></a><tt class="py-lineno">1631</tt>  <tt class="py-line">        <tt class="py-comment"># The back-calculated RDC.</tt> </tt>
<a name="L1632"></a><tt class="py-lineno">1632</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">param</tt> <tt class="py-op">==</tt> <tt class="py-string">'rdc_bc'</tt><tt class="py-op">:</tt> </tt>
<a name="L1633"></a><tt class="py-lineno">1633</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-string">"Back-calculated RDC"</tt> </tt>
</div><a name="L1634"></a><tt class="py-lineno">1634</tt>  <tt class="py-line"> </tt>
<a name="L1635"></a><tt class="py-lineno">1635</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.return_units"></a><div id="N_state_model.return_units-def"><a name="L1636"></a><tt class="py-lineno">1636</tt> <a class="py-toggle" href="#" id="N_state_model.return_units-toggle" onclick="return toggle('N_state_model.return_units');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#return_units">return_units</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">param</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.return_units-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model.return_units-expanded"><a name="L1637"></a><tt class="py-lineno">1637</tt>  <tt class="py-line">        <tt class="py-docstring">"""Return a string representing the parameters units.</tt> </tt>
<a name="L1638"></a><tt class="py-lineno">1638</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1639"></a><tt class="py-lineno">1639</tt>  <tt class="py-line"><tt class="py-docstring">        @param param:   The name of the parameter to return the units string for.</tt> </tt>
<a name="L1640"></a><tt class="py-lineno">1640</tt>  <tt class="py-line"><tt class="py-docstring">        @type param:    str</tt> </tt>
<a name="L1641"></a><tt class="py-lineno">1641</tt>  <tt class="py-line"><tt class="py-docstring">        @return:        The parameter units string.</tt> </tt>
<a name="L1642"></a><tt class="py-lineno">1642</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:         str</tt> </tt>
<a name="L1643"></a><tt class="py-lineno">1643</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L1644"></a><tt class="py-lineno">1644</tt>  <tt class="py-line"> </tt>
<a name="L1645"></a><tt class="py-lineno">1645</tt>  <tt class="py-line">        <tt class="py-comment"># PCSs.</tt> </tt>
<a name="L1646"></a><tt class="py-lineno">1646</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">param</tt> <tt class="py-op">==</tt> <tt class="py-string">'pcs'</tt> <tt class="py-keyword">or</tt> <tt class="py-name">param</tt> <tt class="py-op">==</tt> <tt class="py-string">'pcs_bc'</tt><tt class="py-op">:</tt> </tt>
<a name="L1647"></a><tt class="py-lineno">1647</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-string">'ppm'</tt> </tt>
<a name="L1648"></a><tt class="py-lineno">1648</tt>  <tt class="py-line"> </tt>
<a name="L1649"></a><tt class="py-lineno">1649</tt>  <tt class="py-line">        <tt class="py-comment"># RDCs.</tt> </tt>
<a name="L1650"></a><tt class="py-lineno">1650</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">param</tt> <tt class="py-op">==</tt> <tt class="py-string">'rdc'</tt> <tt class="py-keyword">or</tt> <tt class="py-name">param</tt> <tt class="py-op">==</tt> <tt class="py-string">'rdc_bc'</tt><tt class="py-op">:</tt> </tt>
<a name="L1651"></a><tt class="py-lineno">1651</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-string">'Hz'</tt> </tt>
</div><a name="L1652"></a><tt class="py-lineno">1652</tt>  <tt class="py-line"> </tt>
<a name="L1653"></a><tt class="py-lineno">1653</tt>  <tt class="py-line"> </tt>
<a name="L1654"></a><tt class="py-lineno">1654</tt>  <tt class="py-line">    <tt id="link-872" class="py-name" targets="Variable pipe_control.minimise.set_doc=pipe_control.minimise-module.html#set_doc,Variable specific_analyses.api_base.API_base.set_doc=specific_analyses.api_base.API_base-class.html#set_doc,Variable specific_analyses.consistency_tests.Consistency_tests.set_doc=specific_analyses.consistency_tests.Consistency_tests-class.html#set_doc,Variable specific_analyses.jw_mapping.Jw_mapping.set_doc=specific_analyses.jw_mapping.Jw_mapping-class.html#set_doc,Variable specific_analyses.model_free.main.Model_free_main.set_doc=specific_analyses.model_free.main.Model_free_main-class.html#set_doc,Variable specific_analyses.n_state_model.N_state_model.set_doc=specific_analyses.n_state_model.N_state_model-class.html#set_doc,Variable specific_analyses.relax_fit.Relax_fit.set_doc=specific_analyses.relax_fit.Relax_fit-class.html#set_doc"><a title="pipe_control.minimise.set_doc
specific_analyses.api_base.API_base.set_doc
specific_analyses.consistency_tests.Consistency_tests.set_doc
specific_analyses.jw_mapping.Jw_mapping.set_doc
specific_analyses.model_free.main.Model_free_main.set_doc
specific_analyses.n_state_model.N_state_model.set_doc
specific_analyses.relax_fit.Relax_fit.set_doc" class="py-name" href="#" onclick="return doclink('link-872', 'set_doc', 'link-872');">set_doc</a></tt> <tt class="py-op">=</tt> <tt id="link-873" class="py-name"><a title="user_functions.objects.Desc_container" class="py-name" href="#" onclick="return doclink('link-873', 'Desc_container', 'link-113');">Desc_container</a></tt><tt class="py-op">(</tt><tt class="py-string">"N-state model set details"</tt><tt class="py-op">)</tt> </tt>
<a name="L1655"></a><tt class="py-lineno">1655</tt>  <tt class="py-line">    <tt id="link-874" class="py-name"><a title="pipe_control.minimise.set_doc
specific_analyses.api_base.API_base.set_doc
specific_analyses.consistency_tests.Consistency_tests.set_doc
specific_analyses.jw_mapping.Jw_mapping.set_doc
specific_analyses.model_free.main.Model_free_main.set_doc
specific_analyses.n_state_model.N_state_model.set_doc
specific_analyses.relax_fit.Relax_fit.set_doc" class="py-name" href="#" onclick="return doclink('link-874', 'set_doc', 'link-872');">set_doc</a></tt><tt class="py-op">.</tt><tt id="link-875" class="py-name"><a title="user_functions.objects.Desc_container.add_paragraph" class="py-name" href="#" onclick="return doclink('link-875', 'add_paragraph', 'link-612');">add_paragraph</a></tt><tt class="py-op">(</tt><tt class="py-string">"Setting parameters for the N-state model is a little different from the other type of analyses as each state has a set of parameters with the same names as the other states. To set the parameters for a specific state c (ranging from 0 for the first to N-1 for the last, the number c should be added to the end of the parameter name.  So the Euler angle gamma of the third state is specified using the string 'gamma2'."</tt><tt class="py-op">)</tt> </tt>
<a name="L1656"></a><tt class="py-lineno">1656</tt>  <tt class="py-line"> </tt>
<a name="L1657"></a><tt class="py-lineno">1657</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.set_error"></a><div id="N_state_model.set_error-def"><a name="L1658"></a><tt class="py-lineno">1658</tt> <a class="py-toggle" href="#" id="N_state_model.set_error-toggle" onclick="return toggle('N_state_model.set_error');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#set_error">set_error</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">model_info</tt><tt class="py-op">,</tt> <tt class="py-param">index</tt><tt class="py-op">,</tt> <tt class="py-param">error</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.set_error-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model.set_error-expanded"><a name="L1659"></a><tt class="py-lineno">1659</tt>  <tt class="py-line">        <tt class="py-docstring">"""Set the parameter errors.</tt> </tt>
<a name="L1660"></a><tt class="py-lineno">1660</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1661"></a><tt class="py-lineno">1661</tt>  <tt class="py-line"><tt class="py-docstring">        @param model_info:  The global model index originating from model_loop().</tt> </tt>
<a name="L1662"></a><tt class="py-lineno">1662</tt>  <tt class="py-line"><tt class="py-docstring">        @type model_info:   int</tt> </tt>
<a name="L1663"></a><tt class="py-lineno">1663</tt>  <tt class="py-line"><tt class="py-docstring">        @param index:       The index of the parameter to set the errors for.</tt> </tt>
<a name="L1664"></a><tt class="py-lineno">1664</tt>  <tt class="py-line"><tt class="py-docstring">        @type index:        int</tt> </tt>
<a name="L1665"></a><tt class="py-lineno">1665</tt>  <tt class="py-line"><tt class="py-docstring">        @param error:       The error value.</tt> </tt>
<a name="L1666"></a><tt class="py-lineno">1666</tt>  <tt class="py-line"><tt class="py-docstring">        @type error:        float</tt> </tt>
<a name="L1667"></a><tt class="py-lineno">1667</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L1668"></a><tt class="py-lineno">1668</tt>  <tt class="py-line"> </tt>
<a name="L1669"></a><tt class="py-lineno">1669</tt>  <tt class="py-line">        <tt class="py-comment"># Align parameters.</tt> </tt>
<a name="L1670"></a><tt class="py-lineno">1670</tt>  <tt class="py-line">        <tt id="link-876" class="py-name" targets="Method data_store.align_tensor.AlignTensorList.names()=data_store.align_tensor.AlignTensorList-class.html#names"><a title="data_store.align_tensor.AlignTensorList.names" class="py-name" href="#" onclick="return doclink('link-876', 'names', 'link-876');">names</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-string">'Axx'</tt><tt class="py-op">,</tt> <tt class="py-string">'Ayy'</tt><tt class="py-op">,</tt> <tt class="py-string">'Axy'</tt><tt class="py-op">,</tt> <tt class="py-string">'Axz'</tt><tt class="py-op">,</tt> <tt class="py-string">'Ayz'</tt><tt class="py-op">]</tt> </tt>
<a name="L1671"></a><tt class="py-lineno">1671</tt>  <tt class="py-line"> </tt>
<a name="L1672"></a><tt class="py-lineno">1672</tt>  <tt class="py-line">        <tt class="py-comment"># Alignment tensor parameters.</tt> </tt>
<a name="L1673"></a><tt class="py-lineno">1673</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">index</tt> <tt class="py-op">&lt;</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_ids</tt><tt class="py-op">)</tt><tt class="py-op">*</tt><tt class="py-number">5</tt><tt class="py-op">:</tt> </tt>
<a name="L1674"></a><tt class="py-lineno">1674</tt>  <tt class="py-line">            <tt class="py-comment"># The tensor and parameter index.</tt> </tt>
<a name="L1675"></a><tt class="py-lineno">1675</tt>  <tt class="py-line">            <tt class="py-name">param_index</tt> <tt class="py-op">=</tt> <tt class="py-name">index</tt> <tt class="py-op">%</tt> <tt class="py-number">5</tt> </tt>
<a name="L1676"></a><tt class="py-lineno">1676</tt>  <tt class="py-line">            <tt class="py-name">tensor_index</tt> <tt class="py-op">=</tt> <tt class="py-op">(</tt><tt class="py-name">index</tt> <tt class="py-op">-</tt> <tt class="py-name">index</tt> <tt class="py-op">%</tt> <tt class="py-number">5</tt><tt class="py-op">)</tt> <tt class="py-op">/</tt> <tt class="py-number">5</tt> </tt>
<a name="L1677"></a><tt class="py-lineno">1677</tt>  <tt class="py-line"> </tt>
<a name="L1678"></a><tt class="py-lineno">1678</tt>  <tt class="py-line">            <tt class="py-comment"># Set the error.</tt> </tt>
<a name="L1679"></a><tt class="py-lineno">1679</tt>  <tt class="py-line">            <tt id="link-877" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-877', 'tensor', 'link-387');">tensor</a></tt> <tt class="py-op">=</tt> <tt id="link-878" class="py-name"><a title="data_store.align_tensor
pipe_control.align_tensor
test_suite.system_tests.align_tensor
user_functions.align_tensor" class="py-name" href="#" onclick="return doclink('link-878', 'align_tensor', 'link-55');">align_tensor</a></tt><tt class="py-op">.</tt><tt id="link-879" class="py-name"><a title="pipe_control.align_tensor.return_tensor" class="py-name" href="#" onclick="return doclink('link-879', 'return_tensor', 'link-665');">return_tensor</a></tt><tt class="py-op">(</tt><tt class="py-name">index</tt><tt class="py-op">=</tt><tt class="py-name">tensor_index</tt><tt class="py-op">,</tt> <tt class="py-name">skip_fixed</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L1680"></a><tt class="py-lineno">1680</tt>  <tt class="py-line">            <tt id="link-880" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-880', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">.</tt><tt id="link-881" class="py-name"><a title="data_store.align_tensor.AlignTensorData.set
data_store.diff_tensor.DiffTensorData.set
multi.misc.Verbosity.set
pipe_control.align_tensor.set
pipe_control.diffusion_tensor.set
pipe_control.minimise.set
pipe_control.value.set" class="py-name" href="#" onclick="return doclink('link-881', 'set', 'link-670');">set</a></tt><tt class="py-op">(</tt><tt class="py-name">param</tt><tt class="py-op">=</tt><tt id="link-882" class="py-name"><a title="data_store.align_tensor.AlignTensorList.names" class="py-name" href="#" onclick="return doclink('link-882', 'names', 'link-876');">names</a></tt><tt class="py-op">[</tt><tt class="py-name">param_index</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt id="link-883" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-883', 'value', 'link-336');">value</a></tt><tt class="py-op">=</tt><tt id="link-884" class="py-name"><a title="relax.RelaxParser.error" class="py-name" href="#" onclick="return doclink('link-884', 'error', 'link-337');">error</a></tt><tt class="py-op">,</tt> <tt class="py-name">category</tt><tt class="py-op">=</tt><tt class="py-string">'err'</tt><tt class="py-op">)</tt> </tt>
<a name="L1681"></a><tt class="py-lineno">1681</tt>  <tt class="py-line"> </tt>
<a name="L1682"></a><tt class="py-lineno">1682</tt>  <tt class="py-line">            <tt class="py-comment"># Return the object.</tt> </tt>
<a name="L1683"></a><tt class="py-lineno">1683</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt id="link-885" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-885', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">,</tt> <tt id="link-886" class="py-name"><a title="data_store.align_tensor.AlignTensorList.names" class="py-name" href="#" onclick="return doclink('link-886', 'names', 'link-876');">names</a></tt><tt class="py-op">[</tt><tt class="py-name">param_index</tt><tt class="py-op">]</tt><tt class="py-op">+</tt><tt class="py-string">'_err'</tt><tt class="py-op">)</tt> </tt>
</div><a name="L1684"></a><tt class="py-lineno">1684</tt>  <tt class="py-line"> </tt>
<a name="L1685"></a><tt class="py-lineno">1685</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.set_param_values"></a><div id="N_state_model.set_param_values-def"><a name="L1686"></a><tt class="py-lineno">1686</tt> <a class="py-toggle" href="#" id="N_state_model.set_param_values-toggle" onclick="return toggle('N_state_model.set_param_values');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#set_param_values">set_param_values</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">param</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">value</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">spin_id</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">error</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">,</tt> <tt class="py-param">force</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.set_param_values-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model.set_param_values-expanded"><a name="L1687"></a><tt class="py-lineno">1687</tt>  <tt class="py-line">        <tt class="py-docstring">"""Set the N-state model parameter values.</tt> </tt>
<a name="L1688"></a><tt class="py-lineno">1688</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1689"></a><tt class="py-lineno">1689</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword param:     The parameter name list.</tt> </tt>
<a name="L1690"></a><tt class="py-lineno">1690</tt>  <tt class="py-line"><tt class="py-docstring">        @type param:        list of str</tt> </tt>
<a name="L1691"></a><tt class="py-lineno">1691</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword value:     The parameter value list.</tt> </tt>
<a name="L1692"></a><tt class="py-lineno">1692</tt>  <tt class="py-line"><tt class="py-docstring">        @type value:        list</tt> </tt>
<a name="L1693"></a><tt class="py-lineno">1693</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword spin_id:   The spin identification string (unused).</tt> </tt>
<a name="L1694"></a><tt class="py-lineno">1694</tt>  <tt class="py-line"><tt class="py-docstring">        @type spin_id:      None</tt> </tt>
<a name="L1695"></a><tt class="py-lineno">1695</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword error:     A flag which if True will allow the parameter errors to be set instead of the values.</tt> </tt>
<a name="L1696"></a><tt class="py-lineno">1696</tt>  <tt class="py-line"><tt class="py-docstring">        @type error:        bool</tt> </tt>
<a name="L1697"></a><tt class="py-lineno">1697</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword force:     A flag which if True will cause current values to be overwritten.  If False, a RelaxError will raised if the parameter value is already set.</tt> </tt>
<a name="L1698"></a><tt class="py-lineno">1698</tt>  <tt class="py-line"><tt class="py-docstring">        @type force:        bool</tt> </tt>
<a name="L1699"></a><tt class="py-lineno">1699</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L1700"></a><tt class="py-lineno">1700</tt>  <tt class="py-line"> </tt>
<a name="L1701"></a><tt class="py-lineno">1701</tt>  <tt class="py-line">        <tt class="py-comment"># Checks.</tt> </tt>
<a name="L1702"></a><tt class="py-lineno">1702</tt>  <tt class="py-line">        <tt id="link-887" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-887', 'lib', 'link-9');">lib</a></tt><tt class="py-op">.</tt><tt id="link-888" class="py-name"><a title="lib.arg_check" class="py-name" href="#" onclick="return doclink('link-888', 'arg_check', 'link-10');">arg_check</a></tt><tt class="py-op">.</tt><tt id="link-889" class="py-name" targets="Function lib.arg_check.is_str_list()=lib.arg_check-module.html#is_str_list"><a title="lib.arg_check.is_str_list" class="py-name" href="#" onclick="return doclink('link-889', 'is_str_list', 'link-889');">is_str_list</a></tt><tt class="py-op">(</tt><tt class="py-name">param</tt><tt class="py-op">,</tt> <tt class="py-string">'parameter name'</tt><tt class="py-op">)</tt> </tt>
<a name="L1703"></a><tt class="py-lineno">1703</tt>  <tt class="py-line">        <tt id="link-890" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-890', 'lib', 'link-9');">lib</a></tt><tt class="py-op">.</tt><tt id="link-891" class="py-name"><a title="lib.arg_check" class="py-name" href="#" onclick="return doclink('link-891', 'arg_check', 'link-10');">arg_check</a></tt><tt class="py-op">.</tt><tt id="link-892" class="py-name" targets="Function lib.arg_check.is_list()=lib.arg_check-module.html#is_list"><a title="lib.arg_check.is_list" class="py-name" href="#" onclick="return doclink('link-892', 'is_list', 'link-892');">is_list</a></tt><tt class="py-op">(</tt><tt id="link-893" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-893', 'value', 'link-336');">value</a></tt><tt class="py-op">,</tt> <tt class="py-string">'parameter value'</tt><tt class="py-op">)</tt> </tt>
<a name="L1704"></a><tt class="py-lineno">1704</tt>  <tt class="py-line"> </tt>
<a name="L1705"></a><tt class="py-lineno">1705</tt>  <tt class="py-line">        <tt class="py-comment"># Loop over the parameters.</tt> </tt>
<a name="L1706"></a><tt class="py-lineno">1706</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-894" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-894', 'i', 'link-189');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">param</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1707"></a><tt class="py-lineno">1707</tt>  <tt class="py-line">            <tt class="py-comment"># Get the object's name.</tt> </tt>
<a name="L1708"></a><tt class="py-lineno">1708</tt>  <tt class="py-line">            <tt class="py-name">obj_name</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-895" class="py-name"><a title="pipe_control.align_tensor.return_data_name
pipe_control.diffusion_tensor.return_data_name
pipe_control.minimise.return_data_name
specific_analyses.api_base.API_base.return_data_name
specific_analyses.n_state_model.N_state_model.return_data_name" class="py-name" href="#" onclick="return doclink('link-895', 'return_data_name', 'link-616');">return_data_name</a></tt><tt class="py-op">(</tt><tt class="py-name">param</tt><tt class="py-op">[</tt><tt id="link-896" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-896', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1709"></a><tt class="py-lineno">1709</tt>  <tt class="py-line"> </tt>
<a name="L1710"></a><tt class="py-lineno">1710</tt>  <tt class="py-line">            <tt class="py-comment"># Is the parameter is valid?</tt> </tt>
<a name="L1711"></a><tt class="py-lineno">1711</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">obj_name</tt><tt class="py-op">:</tt> </tt>
<a name="L1712"></a><tt class="py-lineno">1712</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-897" class="py-name"><a title="lib.errors.RelaxError" class="py-name" href="#" onclick="return doclink('link-897', 'RelaxError', 'link-13');">RelaxError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The parameter '%s' is not valid for this data pipe type."</tt> <tt class="py-op">%</tt> <tt class="py-name">param</tt><tt class="py-op">[</tt><tt id="link-898" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-898', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1713"></a><tt class="py-lineno">1713</tt>  <tt class="py-line"> </tt>
<a name="L1714"></a><tt class="py-lineno">1714</tt>  <tt class="py-line">            <tt class="py-comment"># Error object.</tt> </tt>
<a name="L1715"></a><tt class="py-lineno">1715</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-899" class="py-name"><a title="relax.RelaxParser.error" class="py-name" href="#" onclick="return doclink('link-899', 'error', 'link-337');">error</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1716"></a><tt class="py-lineno">1716</tt>  <tt class="py-line">                <tt class="py-name">obj_name</tt> <tt class="py-op">+=</tt> <tt class="py-string">'_err'</tt> </tt>
<a name="L1717"></a><tt class="py-lineno">1717</tt>  <tt class="py-line"> </tt>
<a name="L1718"></a><tt class="py-lineno">1718</tt>  <tt class="py-line">            <tt class="py-comment"># Set the indexed parameter.</tt> </tt>
<a name="L1719"></a><tt class="py-lineno">1719</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">obj_name</tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt class="py-string">'probs'</tt><tt class="py-op">,</tt> <tt class="py-string">'alpha'</tt><tt class="py-op">,</tt> <tt class="py-string">'beta'</tt><tt class="py-op">,</tt> <tt class="py-string">'gamma'</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L1720"></a><tt class="py-lineno">1720</tt>  <tt class="py-line">                <tt class="py-comment"># The index.</tt> </tt>
<a name="L1721"></a><tt class="py-lineno">1721</tt>  <tt class="py-line">                <tt class="py-name">index</tt> <tt class="py-op">=</tt> <tt id="link-900" class="py-name"><a title="specific_analyses.n_state_model.parameters.param_model_index" class="py-name" href="#" onclick="return doclink('link-900', 'param_model_index', 'link-97');">param_model_index</a></tt><tt class="py-op">(</tt><tt class="py-name">param</tt><tt class="py-op">[</tt><tt id="link-901" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-901', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1722"></a><tt class="py-lineno">1722</tt>  <tt class="py-line"> </tt>
<a name="L1723"></a><tt class="py-lineno">1723</tt>  <tt class="py-line">                <tt class="py-comment"># Set.</tt> </tt>
<a name="L1724"></a><tt class="py-lineno">1724</tt>  <tt class="py-line">                <tt class="py-name">obj</tt> <tt class="py-op">=</tt> <tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-name">obj_name</tt><tt class="py-op">)</tt> </tt>
<a name="L1725"></a><tt class="py-lineno">1725</tt>  <tt class="py-line">                <tt class="py-name">obj</tt><tt class="py-op">[</tt><tt class="py-name">index</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-902" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-902', 'value', 'link-336');">value</a></tt><tt class="py-op">[</tt><tt id="link-903" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-903', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt> </tt>
<a name="L1726"></a><tt class="py-lineno">1726</tt>  <tt class="py-line"> </tt>
<a name="L1727"></a><tt class="py-lineno">1727</tt>  <tt class="py-line">            <tt class="py-comment"># The paramagnetic centre.</tt> </tt>
<a name="L1728"></a><tt class="py-lineno">1728</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-904" class="py-name"><a title="lib.regex.search" class="py-name" href="#" onclick="return doclink('link-904', 'search', 'link-7');">search</a></tt><tt class="py-op">(</tt><tt class="py-string">'^paramag_[xyz]$'</tt><tt class="py-op">,</tt> <tt class="py-name">obj_name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1729"></a><tt class="py-lineno">1729</tt>  <tt class="py-line">                <tt class="py-comment"># Init.</tt> </tt>
<a name="L1730"></a><tt class="py-lineno">1730</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'paramagnetic_centre'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1731"></a><tt class="py-lineno">1731</tt>  <tt class="py-line">                    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramagnetic_centre</tt> <tt class="py-op">=</tt> <tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-number">3</tt><tt class="py-op">,</tt> <tt class="py-name">float64</tt><tt class="py-op">)</tt> </tt>
<a name="L1732"></a><tt class="py-lineno">1732</tt>  <tt class="py-line"> </tt>
<a name="L1733"></a><tt class="py-lineno">1733</tt>  <tt class="py-line">                <tt class="py-comment"># Set the coordinate.</tt> </tt>
<a name="L1734"></a><tt class="py-lineno">1734</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">obj_name</tt> <tt class="py-op">==</tt> <tt class="py-string">'paramag_x'</tt><tt class="py-op">:</tt> </tt>
<a name="L1735"></a><tt class="py-lineno">1735</tt>  <tt class="py-line">                    <tt class="py-name">index</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L1736"></a><tt class="py-lineno">1736</tt>  <tt class="py-line">                <tt class="py-keyword">elif</tt> <tt class="py-name">obj_name</tt> <tt class="py-op">==</tt> <tt class="py-string">'paramag_y'</tt><tt class="py-op">:</tt> </tt>
<a name="L1737"></a><tt class="py-lineno">1737</tt>  <tt class="py-line">                    <tt class="py-name">index</tt> <tt class="py-op">=</tt> <tt class="py-number">1</tt> </tt>
<a name="L1738"></a><tt class="py-lineno">1738</tt>  <tt class="py-line">                <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1739"></a><tt class="py-lineno">1739</tt>  <tt class="py-line">                    <tt class="py-name">index</tt> <tt class="py-op">=</tt> <tt class="py-number">2</tt> </tt>
<a name="L1740"></a><tt class="py-lineno">1740</tt>  <tt class="py-line"> </tt>
<a name="L1741"></a><tt class="py-lineno">1741</tt>  <tt class="py-line">                <tt class="py-comment"># Set the value in Angstrom.</tt> </tt>
<a name="L1742"></a><tt class="py-lineno">1742</tt>  <tt class="py-line">                <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramagnetic_centre</tt><tt class="py-op">[</tt><tt class="py-name">index</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-905" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-905', 'value', 'link-336');">value</a></tt><tt class="py-op">[</tt><tt id="link-906" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-906', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt> </tt>
<a name="L1743"></a><tt class="py-lineno">1743</tt>  <tt class="py-line"> </tt>
<a name="L1744"></a><tt class="py-lineno">1744</tt>  <tt class="py-line">            <tt class="py-comment"># Set the spin parameters.</tt> </tt>
<a name="L1745"></a><tt class="py-lineno">1745</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L1746"></a><tt class="py-lineno">1746</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt id="link-907" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-907', 'spin', 'link-193');">spin</a></tt> <tt class="py-keyword">in</tt> <tt id="link-908" class="py-name"><a title="pipe_control.mol_res_spin.spin_loop" class="py-name" href="#" onclick="return doclink('link-908', 'spin_loop', 'link-65');">spin_loop</a></tt><tt class="py-op">(</tt><tt id="link-909" class="py-name" targets="Module gui.input_elements.spin_id=gui.input_elements.spin_id-module.html"><a title="gui.input_elements.spin_id" class="py-name" href="#" onclick="return doclink('link-909', 'spin_id', 'link-909');">spin_id</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1747"></a><tt class="py-lineno">1747</tt>  <tt class="py-line">                    <tt class="py-name">setattr</tt><tt class="py-op">(</tt><tt id="link-910" class="py-name"><a title="test_suite.unit_tests._pipe_control.spin
user_functions.spin" class="py-name" href="#" onclick="return doclink('link-910', 'spin', 'link-193');">spin</a></tt><tt class="py-op">,</tt> <tt class="py-name">obj_name</tt><tt class="py-op">,</tt> <tt id="link-911" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-911', 'value', 'link-336');">value</a></tt><tt class="py-op">[</tt><tt id="link-912" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-912', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
</div><a name="L1748"></a><tt class="py-lineno">1748</tt>  <tt class="py-line"> </tt>
<a name="L1749"></a><tt class="py-lineno">1749</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.sim_init_values"></a><div id="N_state_model.sim_init_values-def"><a name="L1750"></a><tt class="py-lineno">1750</tt> <a class="py-toggle" href="#" id="N_state_model.sim_init_values-toggle" onclick="return toggle('N_state_model.sim_init_values');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#sim_init_values">sim_init_values</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.sim_init_values-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model.sim_init_values-expanded"><a name="L1751"></a><tt class="py-lineno">1751</tt>  <tt class="py-line">        <tt class="py-docstring">"""Initialise the Monte Carlo parameter values."""</tt> </tt>
<a name="L1752"></a><tt class="py-lineno">1752</tt>  <tt class="py-line"> </tt>
<a name="L1753"></a><tt class="py-lineno">1753</tt>  <tt class="py-line">        <tt class="py-comment"># Get the minimisation statistic object names.</tt> </tt>
<a name="L1754"></a><tt class="py-lineno">1754</tt>  <tt class="py-line">        <tt class="py-name">sim_names</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-913" class="py-name" targets="Function pipe_control.align_tensor.data_names()=pipe_control.align_tensor-module.html#data_names,Function pipe_control.diffusion_tensor.data_names()=pipe_control.diffusion_tensor-module.html#data_names,Method specific_analyses.api_base.API_base.data_names()=specific_analyses.api_base.API_base-class.html#data_names"><a title="pipe_control.align_tensor.data_names
pipe_control.diffusion_tensor.data_names
specific_analyses.api_base.API_base.data_names" class="py-name" href="#" onclick="return doclink('link-913', 'data_names', 'link-913');">data_names</a></tt><tt class="py-op">(</tt><tt id="link-914" class="py-name"><a title="data_store.align_tensor.AlignTensorData.set
data_store.diff_tensor.DiffTensorData.set
multi.misc.Verbosity.set
pipe_control.align_tensor.set
pipe_control.diffusion_tensor.set
pipe_control.minimise.set
pipe_control.value.set" class="py-name" href="#" onclick="return doclink('link-914', 'set', 'link-670');">set</a></tt><tt class="py-op">=</tt><tt class="py-string">'min'</tt><tt class="py-op">)</tt> </tt>
<a name="L1755"></a><tt class="py-lineno">1755</tt>  <tt class="py-line"> </tt>
<a name="L1756"></a><tt class="py-lineno">1756</tt>  <tt class="py-line">        <tt class="py-comment"># Add the paramagnetic centre, if optimised.</tt> </tt>
<a name="L1757"></a><tt class="py-lineno">1757</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'paramag_centre_fixed'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramag_centre_fixed</tt><tt class="py-op">:</tt> </tt>
<a name="L1758"></a><tt class="py-lineno">1758</tt>  <tt class="py-line">            <tt class="py-name">sim_names</tt> <tt class="py-op">+=</tt> <tt class="py-op">[</tt><tt class="py-string">'paramagnetic_centre'</tt><tt class="py-op">]</tt> </tt>
<a name="L1759"></a><tt class="py-lineno">1759</tt>  <tt class="py-line"> </tt>
<a name="L1760"></a><tt class="py-lineno">1760</tt>  <tt class="py-line">        <tt class="py-comment"># Alignments.</tt> </tt>
<a name="L1761"></a><tt class="py-lineno">1761</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'align_tensors'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1762"></a><tt class="py-lineno">1762</tt>  <tt class="py-line">            <tt class="py-comment"># The parameter names.</tt> </tt>
<a name="L1763"></a><tt class="py-lineno">1763</tt>  <tt class="py-line">            <tt id="link-915" class="py-name"><a title="data_store.align_tensor.AlignTensorList.names" class="py-name" href="#" onclick="return doclink('link-915', 'names', 'link-876');">names</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-string">'Axx'</tt><tt class="py-op">,</tt> <tt class="py-string">'Ayy'</tt><tt class="py-op">,</tt> <tt class="py-string">'Axy'</tt><tt class="py-op">,</tt> <tt class="py-string">'Axz'</tt><tt class="py-op">,</tt> <tt class="py-string">'Ayz'</tt><tt class="py-op">]</tt> </tt>
<a name="L1764"></a><tt class="py-lineno">1764</tt>  <tt class="py-line"> </tt>
<a name="L1765"></a><tt class="py-lineno">1765</tt>  <tt class="py-line">            <tt class="py-comment"># Loop over the alignments, adding the alignment tensor parameters to the tensor data container.</tt> </tt>
<a name="L1766"></a><tt class="py-lineno">1766</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-916" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-916', 'i', 'link-189');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1767"></a><tt class="py-lineno">1767</tt>  <tt class="py-line">                <tt class="py-comment"># Skip non-optimised tensors.</tt> </tt>
<a name="L1768"></a><tt class="py-lineno">1768</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-917" class="py-name"><a title="specific_analyses.n_state_model.data.opt_tensor" class="py-name" href="#" onclick="return doclink('link-917', 'opt_tensor', 'link-86');">opt_tensor</a></tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">[</tt><tt id="link-918" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-918', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1769"></a><tt class="py-lineno">1769</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L1770"></a><tt class="py-lineno">1770</tt>  <tt class="py-line"> </tt>
<a name="L1771"></a><tt class="py-lineno">1771</tt>  <tt class="py-line">                <tt class="py-comment"># Set up the number of simulations.</tt> </tt>
<a name="L1772"></a><tt class="py-lineno">1772</tt>  <tt class="py-line">                <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">[</tt><tt id="link-919" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-919', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-920" class="py-name" targets="Method data_store.align_tensor.AlignTensorData.set_sim_num()=data_store.align_tensor.AlignTensorData-class.html#set_sim_num,Method data_store.diff_tensor.DiffTensorData.set_sim_num()=data_store.diff_tensor.DiffTensorData-class.html#set_sim_num"><a title="data_store.align_tensor.AlignTensorData.set_sim_num
data_store.diff_tensor.DiffTensorData.set_sim_num" class="py-name" href="#" onclick="return doclink('link-920', 'set_sim_num', 'link-920');">set_sim_num</a></tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">sim_number</tt><tt class="py-op">)</tt> </tt>
<a name="L1773"></a><tt class="py-lineno">1773</tt>  <tt class="py-line"> </tt>
<a name="L1774"></a><tt class="py-lineno">1774</tt>  <tt class="py-line">                <tt class="py-comment"># Loop over all the parameter names, setting the initial simulation values to those of the parameter value.</tt> </tt>
<a name="L1775"></a><tt class="py-lineno">1775</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">object_name</tt> <tt class="py-keyword">in</tt> <tt id="link-921" class="py-name"><a title="data_store.align_tensor.AlignTensorList.names" class="py-name" href="#" onclick="return doclink('link-921', 'names', 'link-876');">names</a></tt><tt class="py-op">:</tt> </tt>
<a name="L1776"></a><tt class="py-lineno">1776</tt>  <tt class="py-line">                    <tt class="py-keyword">for</tt> <tt class="py-name">j</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">sim_number</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1777"></a><tt class="py-lineno">1777</tt>  <tt class="py-line">                        <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">[</tt><tt id="link-922" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-922', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-923" class="py-name"><a title="data_store.align_tensor.AlignTensorData.set
data_store.diff_tensor.DiffTensorData.set
multi.misc.Verbosity.set
pipe_control.align_tensor.set
pipe_control.diffusion_tensor.set
pipe_control.minimise.set
pipe_control.value.set" class="py-name" href="#" onclick="return doclink('link-923', 'set', 'link-670');">set</a></tt><tt class="py-op">(</tt><tt class="py-name">param</tt><tt class="py-op">=</tt><tt class="py-name">object_name</tt><tt class="py-op">,</tt> <tt id="link-924" class="py-name"><a title="gui.input_elements.value
pipe_control.value
test_suite.system_tests.value
user_functions.value" class="py-name" href="#" onclick="return doclink('link-924', 'value', 'link-336');">value</a></tt><tt class="py-op">=</tt><tt class="py-name">deepcopy</tt><tt class="py-op">(</tt><tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">align_tensors</tt><tt class="py-op">[</tt><tt id="link-925" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-925', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">object_name</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">category</tt><tt class="py-op">=</tt><tt class="py-string">'sim'</tt><tt class="py-op">,</tt> <tt class="py-name">sim_index</tt><tt class="py-op">=</tt><tt class="py-name">j</tt><tt class="py-op">)</tt> </tt>
<a name="L1778"></a><tt class="py-lineno">1778</tt>  <tt class="py-line"> </tt>
<a name="L1779"></a><tt class="py-lineno">1779</tt>  <tt class="py-line">            <tt class="py-comment"># Create all other simulation objects.</tt> </tt>
<a name="L1780"></a><tt class="py-lineno">1780</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">object_name</tt> <tt class="py-keyword">in</tt> <tt class="py-name">sim_names</tt><tt class="py-op">:</tt> </tt>
<a name="L1781"></a><tt class="py-lineno">1781</tt>  <tt class="py-line">                <tt class="py-comment"># Name for the simulation object.</tt> </tt>
<a name="L1782"></a><tt class="py-lineno">1782</tt>  <tt class="py-line">                <tt class="py-name">sim_object_name</tt> <tt class="py-op">=</tt> <tt class="py-name">object_name</tt> <tt class="py-op">+</tt> <tt class="py-string">'_sim'</tt> </tt>
<a name="L1783"></a><tt class="py-lineno">1783</tt>  <tt class="py-line"> </tt>
<a name="L1784"></a><tt class="py-lineno">1784</tt>  <tt class="py-line">                <tt class="py-comment"># Create the simulation object.</tt> </tt>
<a name="L1785"></a><tt class="py-lineno">1785</tt>  <tt class="py-line">                <tt class="py-name">setattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-name">sim_object_name</tt><tt class="py-op">,</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1786"></a><tt class="py-lineno">1786</tt>  <tt class="py-line"> </tt>
<a name="L1787"></a><tt class="py-lineno">1787</tt>  <tt class="py-line">                <tt class="py-comment"># Get the simulation object.</tt> </tt>
<a name="L1788"></a><tt class="py-lineno">1788</tt>  <tt class="py-line">                <tt class="py-name">sim_object</tt> <tt class="py-op">=</tt> <tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-name">sim_object_name</tt><tt class="py-op">)</tt> </tt>
<a name="L1789"></a><tt class="py-lineno">1789</tt>  <tt class="py-line"> </tt>
<a name="L1790"></a><tt class="py-lineno">1790</tt>  <tt class="py-line">                <tt class="py-comment"># Loop over the simulations.</tt> </tt>
<a name="L1791"></a><tt class="py-lineno">1791</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">j</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">sim_number</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1792"></a><tt class="py-lineno">1792</tt>  <tt class="py-line">                    <tt class="py-comment"># Append None to fill the structure.</tt> </tt>
<a name="L1793"></a><tt class="py-lineno">1793</tt>  <tt class="py-line">                    <tt class="py-name">sim_object</tt><tt class="py-op">.</tt><tt id="link-926" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-926', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">None</tt><tt class="py-op">)</tt> </tt>
<a name="L1794"></a><tt class="py-lineno">1794</tt>  <tt class="py-line"> </tt>
<a name="L1795"></a><tt class="py-lineno">1795</tt>  <tt class="py-line">            <tt class="py-comment"># Set the simulation paramagnetic centre positions to the optimised values.</tt> </tt>
<a name="L1796"></a><tt class="py-lineno">1796</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">,</tt> <tt class="py-string">'paramag_centre_fixed'</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramag_centre_fixed</tt><tt class="py-op">:</tt> </tt>
<a name="L1797"></a><tt class="py-lineno">1797</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">j</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">sim_number</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1798"></a><tt class="py-lineno">1798</tt>  <tt class="py-line">                    <tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramagnetic_centre_sim</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">deepcopy</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">paramagnetic_centre</tt><tt class="py-op">)</tt> </tt>
</div><a name="L1799"></a><tt class="py-lineno">1799</tt>  <tt class="py-line"> </tt>
<a name="L1800"></a><tt class="py-lineno">1800</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.sim_pack_data"></a><div id="N_state_model.sim_pack_data-def"><a name="L1801"></a><tt class="py-lineno">1801</tt> <a class="py-toggle" href="#" id="N_state_model.sim_pack_data-toggle" onclick="return toggle('N_state_model.sim_pack_data');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#sim_pack_data">sim_pack_data</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">data_id</tt><tt class="py-op">,</tt> <tt class="py-param">sim_data</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.sim_pack_data-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model.sim_pack_data-expanded"><a name="L1802"></a><tt class="py-lineno">1802</tt>  <tt class="py-line">        <tt class="py-docstring">"""Pack the Monte Carlo simulation data.</tt> </tt>
<a name="L1803"></a><tt class="py-lineno">1803</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1804"></a><tt class="py-lineno">1804</tt>  <tt class="py-line"><tt class="py-docstring">        @keyword data_id:   The list of spin ID, data type, and alignment ID, as yielded by the base_data_loop() generator method.</tt> </tt>
<a name="L1805"></a><tt class="py-lineno">1805</tt>  <tt class="py-line"><tt class="py-docstring">        @type data_id:      list of str</tt> </tt>
<a name="L1806"></a><tt class="py-lineno">1806</tt>  <tt class="py-line"><tt class="py-docstring">        @param sim_data:    The Monte Carlo simulation data.</tt> </tt>
<a name="L1807"></a><tt class="py-lineno">1807</tt>  <tt class="py-line"><tt class="py-docstring">        @type sim_data:     list of float</tt> </tt>
<a name="L1808"></a><tt class="py-lineno">1808</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L1809"></a><tt class="py-lineno">1809</tt>  <tt class="py-line"> </tt>
<a name="L1810"></a><tt class="py-lineno">1810</tt>  <tt class="py-line">        <tt class="py-comment"># Alias the spin or interatomic data container.</tt> </tt>
<a name="L1811"></a><tt class="py-lineno">1811</tt>  <tt class="py-line">        <tt id="link-927" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-927', 'container', 'link-565');">container</a></tt> <tt class="py-op">=</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L1812"></a><tt class="py-lineno">1812</tt>  <tt class="py-line"> </tt>
<a name="L1813"></a><tt class="py-lineno">1813</tt>  <tt class="py-line">        <tt class="py-comment"># RDC data.</tt> </tt>
<a name="L1814"></a><tt class="py-lineno">1814</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'rdc'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-928" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-928', 'container', 'link-565');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'rdc'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1815"></a><tt class="py-lineno">1815</tt>  <tt class="py-line">            <tt class="py-comment"># Initialise.</tt> </tt>
<a name="L1816"></a><tt class="py-lineno">1816</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-929" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-929', 'container', 'link-565');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'rdc_sim'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1817"></a><tt class="py-lineno">1817</tt>  <tt class="py-line">                <tt id="link-930" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-930', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_sim</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L1818"></a><tt class="py-lineno">1818</tt>  <tt class="py-line">                 </tt>
<a name="L1819"></a><tt class="py-lineno">1819</tt>  <tt class="py-line">            <tt class="py-comment"># Store the data structure.</tt> </tt>
<a name="L1820"></a><tt class="py-lineno">1820</tt>  <tt class="py-line">            <tt id="link-931" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-931', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_sim</tt><tt class="py-op">[</tt><tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L1821"></a><tt class="py-lineno">1821</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-932" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-932', 'i', 'link-189');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">sim_number</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1822"></a><tt class="py-lineno">1822</tt>  <tt class="py-line">                <tt id="link-933" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-933', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">rdc_sim</tt><tt class="py-op">[</tt><tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-934" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-934', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">sim_data</tt><tt class="py-op">[</tt><tt id="link-935" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-935', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1823"></a><tt class="py-lineno">1823</tt>  <tt class="py-line"> </tt>
<a name="L1824"></a><tt class="py-lineno">1824</tt>  <tt class="py-line">        <tt class="py-comment"># NOESY data.</tt> </tt>
<a name="L1825"></a><tt class="py-lineno">1825</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'noesy'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-936" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-936', 'container', 'link-565');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'noesy'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1826"></a><tt class="py-lineno">1826</tt>  <tt class="py-line">            <tt class="py-comment"># Store the data structure.</tt> </tt>
<a name="L1827"></a><tt class="py-lineno">1827</tt>  <tt class="py-line">            <tt id="link-937" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-937', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">noesy_sim</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L1828"></a><tt class="py-lineno">1828</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-938" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-938', 'i', 'link-189');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">sim_number</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1829"></a><tt class="py-lineno">1829</tt>  <tt class="py-line">                <tt id="link-939" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-939', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">noesy_sim</tt><tt class="py-op">[</tt><tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-940" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-940', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">sim_data</tt><tt class="py-op">[</tt><tt id="link-941" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-941', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L1830"></a><tt class="py-lineno">1830</tt>  <tt class="py-line"> </tt>
<a name="L1831"></a><tt class="py-lineno">1831</tt>  <tt class="py-line">        <tt class="py-comment"># PCS data.</tt> </tt>
<a name="L1832"></a><tt class="py-lineno">1832</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">'pcs'</tt> <tt class="py-keyword">and</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-942" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-942', 'container', 'link-565');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1833"></a><tt class="py-lineno">1833</tt>  <tt class="py-line">            <tt class="py-comment"># Initialise.</tt> </tt>
<a name="L1834"></a><tt class="py-lineno">1834</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt id="link-943" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-943', 'container', 'link-565');">container</a></tt><tt class="py-op">,</tt> <tt class="py-string">'pcs_sim'</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1835"></a><tt class="py-lineno">1835</tt>  <tt class="py-line">                <tt id="link-944" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-944', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_sim</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L1836"></a><tt class="py-lineno">1836</tt>  <tt class="py-line">                 </tt>
<a name="L1837"></a><tt class="py-lineno">1837</tt>  <tt class="py-line">            <tt class="py-comment"># Store the data structure.</tt> </tt>
<a name="L1838"></a><tt class="py-lineno">1838</tt>  <tt class="py-line">            <tt id="link-945" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-945', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_sim</tt><tt class="py-op">[</tt><tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L1839"></a><tt class="py-lineno">1839</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-946" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-946', 'i', 'link-189');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">cdp</tt><tt class="py-op">.</tt><tt class="py-name">sim_number</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L1840"></a><tt class="py-lineno">1840</tt>  <tt class="py-line">                <tt id="link-947" class="py-name"><a title="test_suite.unit_tests._prompt.container" class="py-name" href="#" onclick="return doclink('link-947', 'container', 'link-565');">container</a></tt><tt class="py-op">.</tt><tt class="py-name">pcs_sim</tt><tt class="py-op">[</tt><tt class="py-name">data_id</tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-948" class="py-name"><a title="data_store.align_tensor.AlignTensorSimList.append
data_store.diff_tensor.DiffTensorSimList.append" class="py-name" href="#" onclick="return doclink('link-948', 'append', 'link-224');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">sim_data</tt><tt class="py-op">[</tt><tt id="link-949" class="py-name"><a title="user_functions.molecule.i" class="py-name" href="#" onclick="return doclink('link-949', 'i', 'link-189');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
</div><a name="L1841"></a><tt class="py-lineno">1841</tt>  <tt class="py-line"> </tt>
<a name="L1842"></a><tt class="py-lineno">1842</tt>  <tt class="py-line"> </tt>
<a name="N_state_model.sim_return_param"></a><div id="N_state_model.sim_return_param-def"><a name="L1843"></a><tt class="py-lineno">1843</tt> <a class="py-toggle" href="#" id="N_state_model.sim_return_param-toggle" onclick="return toggle('N_state_model.sim_return_param');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="specific_analyses.n_state_model.N_state_model-class.html#sim_return_param">sim_return_param</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">model_info</tt><tt class="py-op">,</tt> <tt class="py-param">index</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="N_state_model.sim_return_param-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="N_state_model.sim_return_param-expanded"><a name="L1844"></a><tt class="py-lineno">1844</tt>  <tt class="py-line">        <tt class="py-docstring">"""Return the array of simulation parameter values.</tt> </tt>
<a name="L1845"></a><tt class="py-lineno">1845</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L1846"></a><tt class="py-lineno">1846</tt>  <tt class="py-line"><tt class="py-docstring">        @param model_info:  The global model index originating from model_loop().</tt> </tt>
<a name="L1847"></a><tt class="py-lineno">1847</tt>  <tt class="py-line"><tt class="py-docstring">        @type model_info:   int</tt> </tt>
<a name="L1848"></a><tt class="py-lineno">1848</tt>  <tt class="py-line"><tt class="py-docstring">        @param index:       The index of the parameter to return the array of values for.</tt> </tt>
<a name="L1849"></a><tt class="py-lineno">1849</tt>  <tt class="py-line"><tt class="py-docstring">        @type index:        int</tt> </tt>
<a name="L1850"></a><tt class="py-lineno">1850</tt>  <tt class="py-line"><tt class="py-docstring">        @return:            The array of simulation parameter values.</tt> </tt>
<a name="L1851"></a><tt class="py-lineno">1851</tt>  <tt class="py-line"><tt class="py-docstring">        @rtype:             list of float</tt> </tt>
<a name="L1852"></a><tt class="py-lineno">1852</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L1853"></a><tt class="py-lineno">1853</tt>  <tt class="py-line"> </tt>
<a name="L1854"></a><tt class="py-lineno">1854</tt>  <tt class="py-line">        <tt class="py-comment"># Align parameters.</tt> </tt>
<a name="L1855"></a><tt class="py-lineno">1855</tt>  <tt class="py-line">        <tt id="link-950" class="py-name"><a title="data_store.align_tensor.AlignTensorList.names" class="py-name" href="#" onclick="return doclink('link-950', 'names', 'link-876');">names</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-string">'Axx'</tt><tt class="py-op">,</tt> <tt class="py-string">'Ayy'</tt><tt class="py-op">,</tt> <tt class="py-string">'Axy'</tt><tt class="py-op">,</tt> <tt class="py-string">'Axz'</tt><tt class="py-op">,</tt> <tt class="py-string">'Ayz'</tt><tt class="py-op">]</tt> </tt>
<a name="L1856"></a><tt class="py-lineno">1856</tt>  <tt class="py-line"> </tt>
<a name="L1857"></a><tt class="py-lineno">1857</tt>  <tt class="py-line">        <tt class="py-comment"># Alignment tensor parameters.</tt> </tt>
<a name="L1858"></a><tt class="py-lineno">1858</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">index</tt> <tt class="py-op">&lt;</tt> <tt id="link-951" class="py-name"><a title="data_store.align_tensor
pipe_control.align_tensor
test_suite.system_tests.align_tensor
user_functions.align_tensor" class="py-name" href="#" onclick="return doclink('link-951', 'align_tensor', 'link-55');">align_tensor</a></tt><tt class="py-op">.</tt><tt id="link-952" class="py-name"><a title="pipe_control.align_tensor.num_tensors" class="py-name" href="#" onclick="return doclink('link-952', 'num_tensors', 'link-438');">num_tensors</a></tt><tt class="py-op">(</tt><tt class="py-name">skip_fixed</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">*</tt><tt class="py-number">5</tt><tt class="py-op">:</tt> </tt>
<a name="L1859"></a><tt class="py-lineno">1859</tt>  <tt class="py-line">            <tt class="py-comment"># The tensor and parameter index.</tt> </tt>
<a name="L1860"></a><tt class="py-lineno">1860</tt>  <tt class="py-line">            <tt class="py-name">param_index</tt> <tt class="py-op">=</tt> <tt class="py-name">index</tt> <tt class="py-op">%</tt> <tt class="py-number">5</tt> </tt>
<a name="L1861"></a><tt class="py-lineno">1861</tt>  <tt class="py-line">            <tt class="py-name">tensor_index</tt> <tt class="py-op">=</tt> <tt class="py-op">(</tt><tt class="py-name">index</tt> <tt class="py-op">-</tt> <tt class="py-name">index</tt> <tt class="py-op">%</tt> <tt class="py-number">5</tt><tt class="py-op">)</tt> <tt class="py-op">/</tt> <tt class="py-number">5</tt> </tt>
<a name="L1862"></a><tt class="py-lineno">1862</tt>  <tt class="py-line"> </tt>
<a name="L1863"></a><tt class="py-lineno">1863</tt>  <tt class="py-line">            <tt class="py-comment"># Return the simulation parameter array.</tt> </tt>
<a name="L1864"></a><tt class="py-lineno">1864</tt>  <tt class="py-line">            <tt id="link-953" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-953', 'tensor', 'link-387');">tensor</a></tt> <tt class="py-op">=</tt> <tt id="link-954" class="py-name"><a title="data_store.align_tensor
pipe_control.align_tensor
test_suite.system_tests.align_tensor
user_functions.align_tensor" class="py-name" href="#" onclick="return doclink('link-954', 'align_tensor', 'link-55');">align_tensor</a></tt><tt class="py-op">.</tt><tt id="link-955" class="py-name"><a title="pipe_control.align_tensor.return_tensor" class="py-name" href="#" onclick="return doclink('link-955', 'return_tensor', 'link-665');">return_tensor</a></tt><tt class="py-op">(</tt><tt class="py-name">index</tt><tt class="py-op">=</tt><tt class="py-name">tensor_index</tt><tt class="py-op">,</tt> <tt class="py-name">skip_fixed</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L1865"></a><tt class="py-lineno">1865</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt id="link-956" class="py-name"><a title="bmrblib.structure.tensor" class="py-name" href="#" onclick="return doclink('link-956', 'tensor', 'link-387');">tensor</a></tt><tt class="py-op">,</tt> <tt id="link-957" class="py-name"><a title="data_store.align_tensor.AlignTensorList.names" class="py-name" href="#" onclick="return doclink('link-957', 'names', 'link-876');">names</a></tt><tt class="py-op">[</tt><tt class="py-name">param_index</tt><tt class="py-op">]</tt><tt class="py-op">+</tt><tt class="py-string">'_sim'</tt><tt class="py-op">)</tt> </tt>
</div></div><a name="L1866"></a><tt class="py-lineno">1866</tt>  <tt class="py-line"> </tt><script type="text/javascript">
<!--
expandto(location.href);
// -->
</script>
</pre>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://www.nmr-relax.com">relax</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Thu Oct 17 17:54:03 2013
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
