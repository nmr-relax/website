<!-- MHonArc v2.6.16 -->
<!--X-Subject: STAR format file writer and parser &#45; generating output for BMRB	submission and reading the data out of the Palmer's Modefree	mfout file. -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneq.qnhiretarNtznvy.pbz> -->
<!--X-Date: Thu, 03 Apr 2008 17:44:28 +0200 -->
<!--X-Message-Id: 7f080ed10804030844y6f6539cdsf043c46ceec0be36@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>STAR format file writer and parser - generating output for BMRB	submission and reading the data out of the Palmer's Modefree	mfout file. -- April 03, 2008 - 17:44</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />STAR format file writer and parser - generating output for BMRB	submission and reading the data out of the Palmer's Modefree	mfout file.</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00009" class="tabs">Index by Date</a> | <a href="threads.html#00009" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00008.html">Date Prev</a>] [<a href="msg00010.html">Date Next</a>] [<a href="msg00001.html">Thread Prev</a>] [<a href="msg00010.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Sébastien Morin&quot; &lt;sebastien.morin.1@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Thu, 3 Apr 2008 17:44:15 +0200</li>
<li class="menuitem">
<em>Cc</em>: relax-users@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00009.html">7f080ed10804030844y6f6539cdsf043c46ceec0be36@mail.gmail.com</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on April 03, 2008 - 17:44:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi,

This post starts a new thread, but it follows on from the post at
<a  rel="nofollow" href="https://mail.gna.org/public/relax-users/2008-04/msg00005.html">https://mail.gna.org/public/relax-users/2008-04/msg00005.html</a>.  The
parent of the previous thread is located at
<a  rel="nofollow" href="https://mail.gna.org/public/relax-users/2008-04/msg00001.html">https://mail.gna.org/public/relax-users/2008-04/msg00001.html</a>.


On Wed, Apr 2, 2008 at 7:11 PM, Sébastien Morin
&lt;sebastien.morin.1@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">

 Hi,

 I tried to use the palmer.extract() function, with no real success...
</pre></blockquote><pre style="margin: 0em;">

I have to admit that my Modelfree star format parser is not of very
high quality.  It woks if you use the palmer.py sample script, but
obviously not in this situation.  Nothing that's not fixable though.


</pre><blockquote class="blockquote"><pre style="margin: 0em;"> I had several error message during my first tries and manage to get rid of
them with a script like :

 =======================================

 runs = ['m1', 'm2', 'm3', 'm4', 'm5']
 diff_tensor_Phi = 22.4
 diff_tensor_Theta = -3.49
 diff_tensor_Dratio = 1.22
 diff_tensor_tm = 1.242e-08

 for name in runs:
     run.create(name, 'mf')
     sequence.read(name, 'sequence')
     diffusion_tensor.init(name, (diff_tensor_tm, diff_tensor_Dratio,
diff_tensor_Theta, diff_tensor_Phi), param_types=2, spheroid_type='prolate',
fixed=1)
     palmer.extract(run=name)

 name = 'aic'
 run.create(name, 'mf')
 sequence.read(name, 'sequence')
 relax_data.read(name, 'R1', '800', 799.812 * 1e6,
'800_R1.dat_plus_sequence')
 relax_data.read(name, 'R2', '800', 799.812 * 1e6,
'800_R2.dat_plus_sequence')
 relax_data.read(name, 'R1', '600', 599.739 * 1e6,
'600_R1.dat_plus_sequence')
 relax_data.read(name, 'R2', '600', 599.739 * 1e6,
'600_R2.dat_plus_sequence')
 relax_data.read(name, 'NOE', '600', 599.739 * 1e6,
'600_NOE.dat_plus_sequence')
 relax_data.read(name, 'R1', '500', 499.827 * 1e6,
'500_R1.dat_plus_sequence')
 relax_data.read(name, 'R2', '500', 499.827 * 1e6,
'500_R2.dat_plus_sequence')
 relax_data.read(name, 'NOE', '500', 499.827 * 1e6,
'500_NOE.dat_plus_sequence')
 diffusion_tensor.init(name, (diff_tensor_tm, diff_tensor_Dratio,
diff_tensor_Theta, diff_tensor_Phi), param_types=2, spheroid_type='prolate',
fixed=1)
 model_selection(method='AIC', modsel_run=name)
 results.write(run=name, file='results', force=1)

 =======================================
</pre></blockquote><pre style="margin: 0em;">

It is a little strange that you need to read in the sequence and the
relaxation data for the 'aic' run.  If you look at the palmer.py
sample script in the exec_stage_2() function, you'll see that none of
this is done.  The following should also work:


=======================================

runs = ['m1', 'm2', 'm3', 'm4', 'm5']
diff_tensor_Phi = 22.4
diff_tensor_Theta = -3.49
diff_tensor_Dratio = 1.22
diff_tensor_tm = 1.242e-08

for name in runs:
    run.create(name, 'mf')
    sequence.read(name, 'sequence')
    diffusion_tensor.init(name, (diff_tensor_tm, diff_tensor_Dratio,
diff_tensor_Theta, diff_tensor_Phi), param_types=2,
spheroid_type='prolate', fixed=1)
    palmer.extract(run=name)

name = 'aic'
run.create(name, 'mf')
model_selection(method='AIC', modsel_run=name)
results.write(run=name, file='results', force=1)

=======================================

</pre><blockquote class="blockquote"><pre style="margin: 0em;"> However, there is one problem still present : no model is chosen during AIC
selection... Here is what I get after the command
&quot;model_selection(method='AIC', modsel_run=name)&quot; :

 =======================================

 ...

 Instance 261.

 Run                  Num_params_(k)       Num_data_sets_(n)    Chi2
Criterion

 The model from the run None has been selected.

 ...

 =======================================
</pre></blockquote><pre style="margin: 0em;">

Is this for all spins?  Maybe running relax with the --debug flag will
give more information.


</pre><blockquote class="blockquote"><pre style="margin: 0em;"> It seems the mfout (which are all located in their respective folder : m1,
m2 , m3, m4 and m5) are not loaded properly...

 Do you have any clue about this issue ?
</pre></blockquote><pre style="margin: 0em;">

Sorry, I don't have any idea.  This will require investigation of the
relax data storage object to see what data is loaded from the mfout
file, and quite likely a little bit of coding, if you wish to do so.
I think the 1.3 line would be best for any changes in this code.
Almost all of the user functions you've used here have been updated to
the new relax design and the rest should simply involve the removal of
the run object from the relevant functions.


</pre><blockquote class="blockquote"><pre style="margin: 0em;"> Also, is there a way of extracting information from a mfout with relax
without inputing any sequence, diffusion tensor, or data..? I thought it
would be possible to use palmer.extract() in a short script like this :
</pre></blockquote><pre style="margin: 0em;">

As of yet, no.  The parser behind palmer.extract() will need to be
significantly improved.  The mfout file is STAR (Self Defining Text
Archival and Retrieval) formatted.  But the parser for this is very
basic and hacky.  If the mfout file is not as expected,
palmer.extract() will fail.

The star format is used in a number of other places as well.  For
example I plan to better incorporate relax with the BRMB
(<a  rel="nofollow" href="http://www.bmrb.wisc.edu">http://www.bmrb.wisc.edu</a>) which uses the STAR format.  And CIF files
are also STAR formatted.  So, ideally in the end I would like to
create a STAR format writer and parser for relax.  Or, if there is a
STAR format reader already that is open source and can easily be
imported into relax, then bundle that with relax.  As far as I can
tell, there is no official python package for reading and writing this
format.

But this will take time and will be very incremental.  So if you would
like to update the current code to read more of the mfout file
details, please feel free.  This STAR parser part in
generic_fns/palmer.py

</pre><blockquote class="blockquote"><pre style="margin: 0em;">

 =======================================

 runs = ['m1', 'm2', 'm3', 'm4', 'm5']

 for name in runs:
     palmer.extract(run=name)

 name = 'aic'
 run.create(name, 'mf')
 model_selection(method='AIC', modsel_run=name)
 results.write(run=name, file='results', force=1)

 =======================================


 Do you see anything I do wrong ?

 Thanks !


 Séb  :)







 Edward d'Auvergne wrote:
 Hi,

This is simple enough to do. The user function palmer.extract() will
extract all the data (well that used by relax) out of Modelfree's
mfout files.

Regards,

Edward


On Tue, Apr 1, 2008 at 11:41 PM, Sébastien Morin
&lt;sebastien.morin.1@xxxxxxxxx&gt; wrote:


 Hi,

 I have different model-free analysis that originated from the program
 ModelFree (with results in a 'mfout' file).

 I would like to know if there is a way of loading these data to proceed
 to model selection by AIC using relax.

 I there ain't any way of doing this, I'll turn to the palmer.py script
 and start from the beginning...

 Thanks !


 Sébastien


 _______________________________________________
 relax (<a  rel="nofollow" href="http://nmr-relax.com">http://nmr-relax.com</a>)

 This is the relax-users mailing list
 relax-users@xxxxxxx

 To unsubscribe from this list, get a password
 reminder, or change your subscription options,
 visit the list information page at
 <a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-users">https://mail.gna.org/listinfo/relax-users</a>





</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00010" href="msg00010.html">Re: STAR format file writer and parser - generating output for BMRB	submission and reading the data out of the Palmer's Modefree	mfout file.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Wed Apr 09 16:02:18 2008</div>  
</body>
</html>
