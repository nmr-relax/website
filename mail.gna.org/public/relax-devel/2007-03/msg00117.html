<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: Vote for the design of the relax data storage object singleton. -->
<!--X-From-R13: Quevf [npDnvyq <p.n.znpenvyqNyrrqf.np.hx> -->
<!--X-Date: Wed, 21 Mar 2007 19:50:51 +0100 -->
<!--X-Message-Id: 1174502990.8066.478.camel@mrspell -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 7f080ed10703140609p70d35295ye10ee5939da494a2@mail.gmail.com -->
<!--X-Reference: 1173960604.8066.341.camel@mrspell -->
<!--X-Reference: 7f080ed10703150700v2c7296behc146501949d618bf@mail.gmail.com -->
<!--X-Reference: 1173968940.8066.351.camel@mrspell -->
<!--X-Reference: 7f080ed10703150750k3c2b765fpfad3030a1db9ed12@mail.gmail.com -->
<!--X-Reference: 1173971938.8066.377.camel@mrspell -->
<!--X-Reference: 7f080ed10703150921g7469b0d6ia5506c3c47c537c8@mail.gmail.com -->
<!--X-Reference: 45F98244.4080902@bmb.leeds.ac.uk -->
<!--X-Reference: 7f080ed10703161827h7ff085ffu8ccdcdc232db3241@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Vote for the design of the relax data storage object singleton. -- March 21, 2007 - 19:50</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Vote for the design of the relax data storage object singleton.</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00117" class="tabs">Index by Date</a> | <a href="threads.html#00117" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00116.html">Date Prev</a>] [<a href="msg00118.html">Date Next</a>] [<a href="msg00077.html">Thread Prev</a>] [<a href="msg00119.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Wed, 21 Mar 2007 18:49:50 +0000</li>
<li class="menuitem">
<em>Cc</em>: &quot;Gary S. Thompson&quot; &lt;garyt@xxxxxxxxxxxxxxx&gt;, relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00117.html">1174502990.8066.478.camel@mrspell</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;<a href="msg00046.html">7f080ed10703140609p70d35295ye10ee5939da494a2@mail.gmail.com</a>&gt;	&lt;<a href="msg00057.html">1173960604.8066.341.camel@mrspell</a>&gt;	&lt;<a href="msg00058.html">7f080ed10703150700v2c7296behc146501949d618bf@mail.gmail.com</a>&gt;	&lt;<a href="msg00063.html">1173968940.8066.351.camel@mrspell</a>&gt;	&lt;<a href="msg00065.html">7f080ed10703150750k3c2b765fpfad3030a1db9ed12@mail.gmail.com</a>&gt;	&lt;<a href="msg00066.html">1173971938.8066.377.camel@mrspell</a>&gt;	&lt;<a href="msg00068.html">7f080ed10703150921g7469b0d6ia5506c3c47c537c8@mail.gmail.com</a>&gt;	&lt;<a href="msg00070.html">45F98244.4080902@bmb.leeds.ac.uk</a>&gt;	&lt;<a href="msg00077.html">7f080ed10703161827h7ff085ffu8ccdcdc232db3241@mail.gmail.com</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Chris MacRaild</strong> on March 21, 2007 - 19:50:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">On Sat, 2007-03-17 at 12:27 +1100, Edward d'Auvergne wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">The attached file is a Python module, try importing it and then
playing with its contents.  The module contains two singletons -
'Singleton' and 'NewSingleton'.  Both are instantiated in the same
manner as new relax data storage object (implementation B which we
voted for), the class name being masked by the instance reference.
NewSingleton is derived from the Singleton base class demonstrating
inheritance.  QID!

These singletons are two completely different objects (in different
memory space) which can be used for completely different tasks and can
be used by completely different parts of the program all while being
true singletons - only one instance of each will ever exist in the
program.  If you cannot see this, I challenge you to write a counter
example module demonstrating that what this extremely basic module is
doing cannot be done. 
</pre></blockquote><pre style="margin: 0em;">

What this module is doing can be done (of course), but it breaks the
Singleton design because:

</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">isinstance(NewSingleton, Singleton.__class__)
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">True

Contrary to your previous assertions, isinstance is aptly named, and
correctly identifies the inheritance relationship between these two
objects. In other words, because NewSingleton inherits from
Singleton.__class__ (ie. the class, not the instance of the same name),
NewSingleton is an instance of Singleton.__class__

This is fundamental to the nature of inheritance, and is the basis of
our dissagreements. Again, the classic inheritance metaphor: class Apple
is a subclass of the class Fruit, and GrannySmith is a subclass of the
Apple. Your argument that an object cannot be an instance of more than
one class flies in the face of reason - quite clearly, any object which
is an instance of the class GrannySmith, is also an instance of Apple
and of Fruit. This is essential to the nature of sub-classing, in both
common logic and in OO programing.

Perhaps it is helpful to consider the distinction between Inheritance
and Delegation. Both achieve similar things in terms of code reuse and
behavioural modification, but they do so in quite different ways, and
have important functional differences. Given some base class with lots
of methods that I want to access, while making a few changes:

</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">class Base:
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">...     def methodA(self):
...         print &quot;A&quot;
...     def methodB(self):
...         print &quot;B&quot;
...     # lots more methods...

I could inherit from Base, and change the functionality:

</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">class Inherited(Base):
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">...     def methodA(self):
...         print &quot;a\n&quot;

Or I could delegate to Base those methods that I don't redefine:

</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">class Delegated:
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">...     def methodA(self):
...         print &quot;a\n&quot;
...     def __getattr__(self, attr):
...         # If attribute lookup fails, delegate to Base
...         return getattr(Base(), attr)

Instances of the two classes, Inherited and Delegated, are functionally
very similar: they have all of the same methods, most of which are
identical to those of Base. There is one important difference:

</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">isinstance(Inherited, Base)
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">True
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">isinstance(Delegated, Base)
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">False

A great example of inheritance in the sense I am describing comes from
the Python exceptions system. All python exceptions are an instance of
the base class Exception, and from there ther exists a hierachy of
exceptions: ArithmeticError is a subclass of Exception, and in turn is a
base class for all of the standard maths errors (OverflowError,
ZeroDivisionError, etc); likewise LookupError derives from Exception,
and is base class for KeyError and IndexError. This hierachy is very
powerful, because it allows us to handle different types of error in
different ways:

</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">try:
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">...     errorProneFunction(args)
... except LookupError:
...     dealWithLookupError(args)
... except ArithmeticError:
...     dealWithArithmeticError(args)
... except:
...     # All other errors
...     dealWithOtherError(args)

Suppose there is a case that I want to catch as an exception, that is
maths-related. Although it is not one of the standard maths errors, I
want to handle it in the same way (with the function
dealWithArithmeticError() ). I simply need to subclass from
ArithmeticError:

</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">class MyMathsError(ArithmeticError):
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">...     pass

This works because an exception which is an instance of MyMathsError is
also an instance of ArithmeticError, so the statement except
ArithmeticError will catch MyMathsError, as well as OverflowError,
ZeroDivisionError and the rest. Importantly, no amount of delegation
will make this work:

</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">class AnotherMathsError:
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">...     def __getattr__(self, attr):
...         # If attribute lookup fails, delegate to Base
...         return getattr(ArithmeticError(), attr)

AnotherMathsError is not caught by except ArithmeticError, because it
lacks the requisite inheritance relationship - it is not an instance of
ArithmeticError.

So, to restate what I think is the orthodox OO understanding of
inheritance: any object which is an instance of a sub-class S is also an
instance of all of the classes which are base-classes of S. This is
stated somewhat obtusely at <a  href="http://en.wikipedia.org/wiki/Inheritance_%">http://en.wikipedia.org/wiki/Inheritance_%</a>
28computer_science%29 in the second paragraph:

&quot;Inheritance is also sometimes called generalization, because the is-a
relationships represent a hierarchy between classes of objects. For
instance, a &quot;fruit&quot; is a generalization of &quot;apple&quot;, &quot;orange&quot;, &quot;mango&quot;
and many others. One can consider fruit to be an abstraction of apple,
orange, etc. Conversely, since apples are fruit (i.e. an apple is-a
fruit), apples may naturally inherit all the properties common to all
fruit, such as being a fleshy container for the seed of a plant.&quot;

and (similarly obscurely) in almost all basic descriptions of Object
Orientated coding. This is critically important, because it allows
client code to use instances of the sub-class as if they were instances
of the base-class, without knowing anything about the properties (or
even the existance) of the sub-class.

Chris






</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00119" href="msg00119.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00046" href="msg00046.html">Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00057" href="msg00057.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00058" href="msg00058.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00063" href="msg00063.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00065" href="msg00065.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00066" href="msg00066.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00068" href="msg00068.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00070" href="msg00070.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Gary S. Thompson</li></ul></li>
<li><strong><a name="00077" href="msg00077.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu Mar 22 05:20:40 2007</div>  
</body>
</html>
