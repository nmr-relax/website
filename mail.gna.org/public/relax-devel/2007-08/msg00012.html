<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: Data set format -->
<!--X-From-R13: Eronfgvra [beva <fronfgvra.zbeva.1Nhyniny.pn> -->
<!--X-Date: Wed, 29 Aug 2007 23:23:49 +0200 -->
<!--X-Message-Id: 46D5E3B6.80902@ulaval.ca -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: 46CB1881.6080009@ulaval.ca -->
<!--X-Reference: 7f080ed10708270516y434f0ed3ncd45ec9918a6fa71@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Data set format -- August 29, 2007 - 23:23</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Data set format</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00012" class="tabs">Index by Date</a> | <a href="threads.html#00012" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00011.html">Date Prev</a>] [<a href="msg00013.html">Date Next</a>] [<a href="msg00010.html">Thread Prev</a>] [<a href="msg00014.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Edward d'Auvergne &lt;edward.dauvergne@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Wed, 29 Aug 2007 17:23:02 -0400</li>
<li class="menuitem">
<em>Cc</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00012.html">46D5E3B6.80902@ulaval.ca</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;46CB1881.6080009@xxxxxxxxx&gt;	&lt;7f080ed10708270516y434f0ed3ncd45ec9918a6fa71@xxxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>User-agent</em>: Thunderbird 2.0.0.6 (X11/20070802)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Sebastien Morin</strong> on August 29, 2007 - 23:23:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<table width="100%"><tr><td bgcolor="#ffffff" style="background-color: #ffffff; color: #000000; "><font color="#000000">



Hi,<br>
<br>
I just made different tests with badly formated datasets.<br>
<br>
<br>
With a dataset of this format :<br>
<br>
res_number&nbsp;&nbsp;&nbsp; value&nbsp;&nbsp;&nbsp; error<br>
<br>
running the jw_mapping using the sample script (slightly modified), I
get the following error :<br>
<br>
<br>
<small>Traceback (most recent call last):<br>
&nbsp; File "/home/semor/packages/relax-1.2/relax", line 454, in ?<br>
&nbsp;&nbsp;&nbsp; Relax()<br>
&nbsp; File "/home/semor/packages/relax-1.2/relax", line 166, in __init__<br>
&nbsp;&nbsp;&nbsp; self.interpreter.run()<br>
&nbsp; File "/home/semor/packages/relax-1.2/prompt/interpreter.py", line
213, in run<br>
&nbsp;&nbsp;&nbsp; run_script(intro=self.relax.intro_string, local=self.local,
script_file=self.relax.script_file, quit=1)<br>
&nbsp; File "/home/semor/packages/relax-1.2/prompt/interpreter.py", line
388, in run_script<br>
&nbsp;&nbsp;&nbsp; console.interact(intro, local, script_file, quit)<br>
&nbsp; File "/home/semor/packages/relax-1.2/prompt/interpreter.py", line
340, in interact_script<br>
&nbsp;&nbsp;&nbsp; execfile(script_file, local)<br>
&nbsp; File "./jw_mapping_600.py", line 35, in ?<br>
&nbsp;&nbsp;&nbsp; grace.write(name, y_data_type='j0', file='j0_600.agr', force=1)<br>
&nbsp; File "/home/semor/packages/relax-1.2/prompt/grace.py", line 252, in
write<br>
&nbsp;&nbsp;&nbsp; self.__relax__.generic.grace.write(run=run,
x_data_type=x_data_type, y_data_type=y_data_type, res_num=res_num,
res_name=res_name, plot_data=plot_data, norm=norm, file=file, dir=dir,
force=force)<br>
&nbsp; File "/home/semor/packages/relax-1.2/generic_fns/grace.py", line 256,
in write<br>
&nbsp;&nbsp;&nbsp; len(self.data[0][2])<br>
IndexError: list index out of range</small><br>
<br>
<br>
The following error message arises if I turn off the options related to
grace plotting...<br>
<br>
<br>
<small>Traceback (most recent call last):<br>
&nbsp; File "/home/semor/packages/relax-1.2/relax", line 454, in ?<br>
&nbsp;&nbsp;&nbsp; Relax()<br>
&nbsp; File "/home/semor/packages/relax-1.2/relax", line 166, in __init__<br>
&nbsp;&nbsp;&nbsp; self.interpreter.run()<br>
&nbsp; File "/home/semor/packages/relax-1.2/prompt/interpreter.py", line
213, in run<br>
&nbsp;&nbsp;&nbsp; run_script(intro=self.relax.intro_string, local=self.local,
script_file=self.relax.script_file, quit=1)<br>
&nbsp; File "/home/semor/packages/relax-1.2/prompt/interpreter.py", line
388, in run_script<br>
&nbsp;&nbsp;&nbsp; console.interact(intro, local, script_file, quit)<br>
&nbsp; File "/home/semor/packages/relax-1.2/prompt/interpreter.py", line
340, in interact_script<br>
&nbsp;&nbsp;&nbsp; execfile(script_file, local)<br>
&nbsp; File "./jw_mapping_600.py", line 45, in ?<br>
&nbsp;&nbsp;&nbsp; results.write(run=name, file='results_600', force=1)<br>
&nbsp; File "/home/semor/packages/relax-1.2/prompt/results.py", line 201, in
write<br>
&nbsp;&nbsp;&nbsp; self.__relax__.generic.results.write(run=run, file=file,
directory=dir, force=force, format=format, compress_type=compress_type)<br>
&nbsp; File "/home/semor/packages/relax-1.2/generic_fns/results.py", line
166, in write<br>
&nbsp;&nbsp;&nbsp; self.write_function(results_file, run)<br>
&nbsp; File "/home/semor/packages/relax-1.2/specific_fns/jw_mapping.py",
line 661, in write_columnar_results<br>
&nbsp;&nbsp;&nbsp; for j in xrange(data.num_ri):<br>
AttributeError: Element instance has no attribute 'num_ri'<br>
</small><br>
<br>
As you can see, I don't get any RelaxError, but harder-to-fix error
messages...<br>
<br>
<br>
However, if a dataset of the following format is used :<br>
<br>
res_type&nbsp;&nbsp;&nbsp; value&nbsp;&nbsp;&nbsp; error<br>
<br>
the following error message arises :<br>
<br>
<br>
<small>RelaxError: The file contains no data.</small><br>
<br>
<br>
which is what one should get.<br>
<br>
<br>
With a dataset of the following format :<br>
<br>
res_number&nbsp;&nbsp;&nbsp; value&nbsp;&nbsp; error&nbsp;&nbsp;&nbsp; res_type<br>
<br>
the error message is again correct :<br>
<br>
<br>
<small>RelaxError: The relaxation data is invalid (num=1,
name=0.798308, data="" error=trp).</small><br>
<br>
<br>
Finally, with a dataset of the format :<br>
<br>
res_number&nbsp;&nbsp; res_type&nbsp;&nbsp; value<br>
<br>
the user still gets a strange error message :<br>
<br>
<br>
<small>Traceback (most recent call last):<br>
&nbsp; File "/home/semor/packages/relax-1.2/relax", line 454, in ?<br>
&nbsp;&nbsp;&nbsp; Relax()<br>
&nbsp; File "/home/semor/packages/relax-1.2/relax", line 166, in __init__<br>
&nbsp;&nbsp;&nbsp; self.interpreter.run()<br>
&nbsp; File "/home/semor/packages/relax-1.2/prompt/interpreter.py", line
213, in run<br>
&nbsp;&nbsp;&nbsp; run_script(intro=self.relax.intro_string, local=self.local,
script_file=self.relax.script_file, quit=1)<br>
&nbsp; File "/home/semor/packages/relax-1.2/prompt/interpreter.py", line
388, in run_script<br>
&nbsp;&nbsp;&nbsp; console.interact(intro, local, script_file, quit)<br>
&nbsp; File "/home/semor/packages/relax-1.2/prompt/interpreter.py", line
340, in interact_script<br>
&nbsp;&nbsp;&nbsp; execfile(script_file, local)<br>
&nbsp; File "./jw_mapping_600.py", line 35, in ?<br>
&nbsp;&nbsp;&nbsp; grace.write(name, y_data_type='j0', file='j0_600.agr', force=1)<br>
&nbsp; File "/home/semor/packages/relax-1.2/prompt/grace.py", line 252, in
write<br>
&nbsp;&nbsp;&nbsp; self.__relax__.generic.grace.write(run=run,
x_data_type=x_data_type, y_data_type=y_data_type, res_num=res_num,
res_name=res_name, plot_data=plot_data, norm=norm, file=file, dir=dir,
force=force)<br>
&nbsp; File "/home/semor/packages/relax-1.2/generic_fns/grace.py", line 256,
in write<br>
&nbsp;&nbsp;&nbsp; len(self.data[0][2])<br>
IndexError: list index out of range</small><br>
<br>
<br>
So, the problem seems to arise only in certain circumstances when a
field is missing in the dataset.<br>
<br>
Maybe some error definitions should be added. This could be especially
useful for people used with ModelFree where input files are formatted
as :<br>
<br>
res_number&nbsp;&nbsp; value&nbsp;&nbsp; error<br>
<br>
<br>
Cheers !<br>
<br>
<br>
S&eacute;bastien&nbsp; :)<br>
<br>
<br>
<br>
<br>
<br>
Edward d'Auvergne wrote:
<blockquote
 cite=""
 type="cite">
  <pre wrap="">Hi,

For the reading in of data, such as the R1 relaxation rates, the only
requirement for the format is that the data is in a column formatted
text file.  The different columns can be changed by the num_col=0,
name_col=1, data_col=2, and error_col=3 arguments.  The column
separator changed by the 'sep' argument.  In the future, even more
diverse formats will be accepted as these arise and are reported on
the mailing lists.

With this in mind, coming up with a more descriptive error message
would be worthwhile.  Currently you will get something such as:

RelaxError:  "The relaxation data is invalid (num=" +
file_data[i][num_col] + ", name=" + file_data[i][name_col] + ", data="", error=" + file_data[i][error_col] + ")."

This could probably be broken into simpler messages for different
types of error.  The checks are currently for the residue number being
an integer, and the data and error being floating point numbers.
Would anyone have any suggestions or ideas for how this could be
better reported to the user?  What tests and what types of messages
would you use?  The system has to be flexible enough to handle
absolutely all rubbish thrown at it by a user ;)

Cheers,

Edward



On 8/21/07, Sebastien Morin <a rel="nofollow" class="moz-txt-link-rfc2396E" href="mailto:sebastien.morin.1@xxxxxxxxx">&lt;sebastien.morin.1@xxxxxxxxx&gt;</a> wrote:
  </pre>
  <blockquote type="cite">
    <pre wrap="">Hi all !

I am now analysing data using relax (line 1.2, branch consistency-tests,
revision 3354).

I realized (when using the consistency tests function) that it could be
nice to check data set format and output a error message when the format
isn't like the one requested.

For example, a data set of the following format wouldn't work :

1 0.90 0.05
2 0.79 0.05
3 0.6  0.1

neither would it work with the following format :

Gly  1  0.90  0.05
Gly  2  0.79  0.05
Gly  3  0.6    0.1


However, a dataset of the following format would work as it is the
format required :

1  Gly  0.90  0.05
2  Gly  0.79  0.05
3  Gly  0.6    0.1


This type of error is long to find out for a standard user as the error
messages yielded are not very helpful.

So, would it be a good idea to add a kind of test for the data set
format ? Maybe this has been already proposed for the 1.3 line. If so,
sorry for the duplicate request...

Cheers !


S&eacute;bastien  :)

--
         ______________________________________
     _______________________________________________
    |                                               |
   || Sebastien Morin                               ||
  ||| Etudiant au PhD en biochimie                  |||
 |||| Laboratoire de resonance magnetique nucleaire ||||
||||| Dr Stephane Gagne                             |||||
 |||| CREFSIP (Universite Laval, Quebec, CANADA)    ||||
  ||| 1-418-656-2131 #4530                          |||
   ||                                               ||
    |_______________________________________________|
         ______________________________________



_______________________________________________
relax (<a rel="nofollow" class="moz-txt-link-freetext" href="http://nmr-relax.com">http://nmr-relax.com</a>)

This is the relax-devel mailing list
<a rel="nofollow" class="moz-txt-link-abbreviated" href="mailto:relax-devel@xxxxxxx">relax-devel@xxxxxxx</a>

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a rel="nofollow" class="moz-txt-link-freetext" href="https://mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a>

    </pre>
  </blockquote>
  <pre wrap=""><!---->
  </pre>
</blockquote>
<br>
<pre class="moz-signature" cols="72">-- 
         ______________________________________    
     _______________________________________________
    |                                               |
   || Sebastien Morin                               ||
  ||| Etudiant au PhD en biochimie                  |||
 |||| Laboratoire de resonance magnetique nucleaire ||||
||||| Dr Stephane Gagne                             |||||
 |||| CREFSIP (Universite Laval, Quebec, CANADA)    ||||
  ||| 1-418-656-2131 #4530                          |||
   ||                                               ||
    |_______________________________________________|
         ______________________________________    
</pre>


</font></td></tr></table>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00014" href="msg00014.html">Re: Data set format</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00009" href="msg00009.html">Data set format</a></strong>
<ul><li><em>From:</em> Sebastien Morin</li></ul></li>
<li><strong><a name="00010" href="msg00010.html">Re: Data set format</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu Aug 30 11:01:03 2007</div>  
</body>
</html>
