<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: r25238 &#45; /trunk/test_suite/system_tests/relax_disp.py -->
<!--X-From-R13: "Sqjneq q'Ohiretar" &#60;rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Mon, 25 Aug 2014 16:36:07 +0200 -->
<!--X-Message-Id: CAED9pY_swchzuSUfszDdpCS_b_bc6dxJPARddkVEg0bAC5_fBQ@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: E1XLhGf&#45;0000vn&#45;HG@subversion.gna.org -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: r25238 - /trunk/test_suite/system_tests/relax_disp.py -- August 25, 2014 - 16:36</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: r25238 - /trunk/test_suite/system_tests/relax_disp.py</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00274" class="tabs">Index by Date</a> | <a href="threads.html#00274" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00273.html">Date Prev</a>] [<a href="msg00275.html">Date Next</a>] [<a href="msg00273.html">Thread Prev</a>] [<a href="msg00277.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Mon, 25 Aug 2014 16:35:36 +0200</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113; h=mime-version:sender:in-reply-to:references:date:message-id:subject :from:to:content-type; bh=89qksDN7tjxqXCHEF7dfnLl/tFY2KuqfWzxohpr7PIU=; b=KcMlVLwnzELcTfn+UE4lDm133vEWxk8ddZTDP/lGcUve7xLX3xQaGHwCdyPKuoCDHv aGXueyKnkp3frvQ4EFho8zwcWIsL4KpuwzHA5+gwTVdjAnOdO1kKFR3ZDcq4Px3Cbhyr BdMsYJLxQdoVI7eUe16QrIIJ0eRyFWLQbl8Or6+6ewTUQHSzd4xJzq+GTfBQqyzrQMsy fxD4VAB5UkljP2cdVieEgbHUxoYkJd7X7RhSa+ranqwjtPZa45LvTeV2iow/xDLYnfCf enJY71YgsOzNEUWZgKe/OZNwTVieVJe/Cfl6waVOz05+SQwl/8I81RfhvN9982YrEccS Z7XQ==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00274.html">CAED9pY_swchzuSUfszDdpCS_b_bc6dxJPARddkVEg0bAC5_fBQ@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;E1XLhGf-0000vn-HG@subversion.gna.org&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on August 25, 2014 - 16:36:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi,

The errors from the covariance matrix estimate, via
scipy.optimize.leastsq() should be similar or even identical to the
Monte Carlo simulation errors, not double.  Is this still the case?

Regards,

Edward

On 25 August 2014 01:32,  &lt;tlinnet@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Author: tlinnet
Date: Mon Aug 25 01:32:13 2014
New Revision: 25238

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=25238&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=25238&amp;view=rev</a>
Log:
Modified systemtest Relax_disp.test_estimate_r2eff.

This is to compare against errors simulated with 2000 MC.

The paramaters are comparable, but not equal.
Mostly, it seems that the errors from scipy.optimize.leastsq, are twice as 
high than the Monte Carlo simulations.
This affect model fitting, and the calculated chi2 value.

Left column is 2000 Monte Carlo, right column is scipy.optimize.leastsq.

Optimised parameters for spin: 52V @N
Model: No Rex
Parameter: r1     Value: 1.46138806 - 1.46328102
Parameter: r2     Value: 11.48392438 - 11.48040934
Parameter: chi2   Value: 848.42015672 - 3363.95829122

Model: DPL94
Parameter: r1     Value: 1.44845743 - 1.45019848
Parameter: r2     Value: 10.15688373 - 10.16304892
Parameter: phi_ex Value: 0.07599563 - 0.07561937
Parameter: kex    Value: 4460.43707304 - 4419.03906628
Parameter: chi2   Value: 179.47041255 - 710.24767560

Model: TP02
Parameter: r1     Value: 1.54354392 - 1.54352369
Parameter: r2     Value: 9.72654895 - 9.72772727
Parameter: pA     Value: 0.88827039 - 0.88807488
Parameter: dw     Value: 1.08875836 - 1.08765645
Parameter: kex    Value: 4921.28597928 - 4904.70134941
Parameter: chi2   Value: 29.33882481 - 114.47142772

Model: TAP03
Parameter: r1     Value: 1.54356410 - 1.54354368
Parameter: r2     Value: 9.72641885 - 9.72759371
Parameter: pA     Value: 0.88828925 - 0.88809317
Parameter: dw     Value: 1.08837248 - 1.08726695
Parameter: kex    Value: 4926.42974479 - 4909.86896567
Parameter: chi2   Value: 29.29050624 - 114.27987534

Model: MP05
Parameter: r1     Value: 1.54356415 - 1.54354372
Parameter: r2     Value: 9.72641730 - 9.72759220
Parameter: pA     Value: 0.88828927 - 0.88809322
Parameter: dw     Value: 1.08837250 - 1.08726707
Parameter: kex    Value: 4926.44228958 - 4909.88128236
Parameter: chi2   Value: 29.29054252 - 114.28002272

Model: NS R1rho 2-site
Parameter: r1     Value: 1.41359226 - 1.41321968
Parameter: r2     Value: 9.34531364 - 9.34602793
Parameter: pA     Value: 0.94504369 - 0.94496541
Parameter: dw     Value: 1.56001843 - 1.55833321
Parameter: kex    Value: 5628.66529504 - 5610.20221435
Parameter: chi2   Value: 34.44010458 - 134.14368365

task #7822(<a  rel="nofollow" href="https://web.archive.org/web/https://gna.org/task/index.php?7822">https://gna.org/task/index.php?7822</a>): Implement user function to 
estimate R2eff and associated errors for exponential curve fitting.

Modified:
    trunk/test_suite/system_tests/relax_disp.py

Modified: trunk/test_suite/system_tests/relax_disp.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/trunk/test_suite/system_tests/relax_disp.py?rev=25238&amp;r1=25237&amp;r2=25238&amp;view=diff">http://svn.gna.org/viewcvs/relax/trunk/test_suite/system_tests/relax_disp.py?rev=25238&amp;r1=25237&amp;r2=25238&amp;view=diff</a>
==============================================================================
--- trunk/test_suite/system_tests/relax_disp.py (original)
+++ trunk/test_suite/system_tests/relax_disp.py Mon Aug 25 01:32:13 2014
@@ -2679,7 +2679,7 @@
         self.setup_r1rho_kjaergaard(cluster_ids=cluster_ids, read_R1=False)

         # The dispersion models.
-        MODELS = [MODEL_NOREX, MODEL_DPL94]
+        MODELS = [MODEL_NOREX, MODEL_DPL94, MODEL_TP02, MODEL_TAP03, 
MODEL_MP05, MODEL_NS_R1RHO_2SITE]

         # The grid search size (the number of increments per dimension).
         GRID_INC = None
@@ -2723,6 +2723,9 @@

         # Run the analysis.
         relax_disp.Relax_disp(pipe_name=ds.pipe_name, 
pipe_bundle=ds.pipe_bundle, results_dir=result_dir_name, models=MODELS, 
grid_inc=GRID_INC, mc_sim_num=MC_NUM, modsel=MODSEL)
+
+        # Verify the data.
+        self.verify_r1rho_kjaergaard_missing_r1(models=MODELS, 
result_dir_name=result_dir_name, do_assert=False)


     def test_exp_fit(self):
@@ -7343,7 +7346,7 @@
         w_eff_file.close()


-    def verify_r1rho_kjaergaard_missing_r1(self, models=None, 
result_dir_name=None):
+    def verify_r1rho_kjaergaard_missing_r1(self, models=None, 
result_dir_name=None, do_assert=True):
         &quot;&quot;&quot;Verification of test_r1rho_kjaergaard_missing_r1.&quot;&quot;&quot;

         # Check the kex value of residue 52
@@ -7382,35 +7385,36 @@
                             # Print value.
                             print(&quot;%-10s %-6s %-6s %3.8f&quot; % (&quot;Parameter:&quot;, 
param, &quot;Value:&quot;, value))

-                            # Compare values.
-                            if spin_id == ':52@N':
-                                if param == 'r1':
-                                    if model == MODEL_NOREX:
-                                        self.assertAlmostEqual(value, 
1.46328102)
-                                    elif model == MODEL_DPL94:
-                                        self.assertAlmostEqual(value, 
1.45019848)
-                                    elif model == MODEL_TP02:
-                                        self.assertAlmostEqual(value, 
1.54352369)
-                                    elif model == MODEL_TAP03:
-                                        self.assertAlmostEqual(value, 
1.54354367)
-                                    elif model == MODEL_MP05:
-                                        self.assertAlmostEqual(value, 
1.54354372)
-                                    elif model == MODEL_NS_R1RHO_2SITE:
-                                        self.assertAlmostEqual(value, 
1.41321968, 6)
-
-                                elif param == 'r2':
-                                    if model == MODEL_NOREX:
-                                        self.assertAlmostEqual(value, 
11.48040934)
-                                    elif model == MODEL_DPL94:
-                                        self.assertAlmostEqual(value, 
10.16304887, 6)
-                                    elif model == MODEL_TP02:
-                                        self.assertAlmostEqual(value, 
9.72772726, 6)
-                                    elif model == MODEL_TAP03:
-                                        self.assertAlmostEqual(value, 
9.72759374, 6)
-                                    elif model == MODEL_MP05:
-                                        self.assertAlmostEqual(value, 
9.72759220, 6)
-                                    elif model == MODEL_NS_R1RHO_2SITE:
-                                        self.assertAlmostEqual(value, 
9.34602793, 5)
+                            if do_assert:
+                                # Compare values.
+                                if spin_id == ':52@N':
+                                    if param == 'r1':
+                                        if model == MODEL_NOREX:
+                                            self.assertAlmostEqual(value, 
1.46328102)
+                                        elif model == MODEL_DPL94:
+                                            self.assertAlmostEqual(value, 
1.45019848)
+                                        elif model == MODEL_TP02:
+                                            self.assertAlmostEqual(value, 
1.54352369)
+                                        elif model == MODEL_TAP03:
+                                            self.assertAlmostEqual(value, 
1.54354367)
+                                        elif model == MODEL_MP05:
+                                            self.assertAlmostEqual(value, 
1.54354372)
+                                        elif model == MODEL_NS_R1RHO_2SITE:
+                                            self.assertAlmostEqual(value, 
1.41321968, 6)
+
+                                    elif param == 'r2':
+                                        if model == MODEL_NOREX:
+                                            self.assertAlmostEqual(value, 
11.48040934)
+                                        elif model == MODEL_DPL94:
+                                            self.assertAlmostEqual(value, 
10.16304887, 6)
+                                        elif model == MODEL_TP02:
+                                            self.assertAlmostEqual(value, 
9.72772726, 6)
+                                        elif model == MODEL_TAP03:
+                                            self.assertAlmostEqual(value, 
9.72759374, 6)
+                                        elif model == MODEL_MP05:
+                                            self.assertAlmostEqual(value, 
9.72759220, 6)
+                                        elif model == MODEL_NS_R1RHO_2SITE:
+                                            self.assertAlmostEqual(value, 
9.34602793, 5)

                     # For all other parameters.
                     else:
@@ -7420,57 +7424,58 @@
                         # Print value.
                         print(&quot;%-10s %-6s %-6s %3.8f&quot; % (&quot;Parameter:&quot;, 
param, &quot;Value:&quot;, value))

-                        # Compare values.
-                        if spin_id == ':52@N':
-                            if param == 'phi_ex':
-                                if model == MODEL_DPL94:
-                                    self.assertAlmostEqual(value, 
0.07561937)
-
-                            elif param == 'pA':
-                                if model == MODEL_TP02:
-                                    self.assertAlmostEqual(value, 
0.88807487)
-                                elif model == MODEL_TAP03:
-                                    self.assertAlmostEqual(value, 
0.88809318)
-                                elif model == MODEL_MP05:
-                                    self.assertAlmostEqual(value, 
0.88809321)
-                                elif model == MODEL_NS_R1RHO_2SITE:
-                                    self.assertAlmostEqual(value, 
0.94496541, 6)
-
-                            elif param == 'dw':
-                                if model == MODEL_TP02:
-                                    self.assertAlmostEqual(value, 
1.08765638, 6)
-                                elif model == MODEL_TAP03:
-                                    self.assertAlmostEqual(value, 
1.08726698, 6)
-                                elif model == MODEL_MP05:
-                                    self.assertAlmostEqual(value, 
1.08726706, 6)
-                                elif model == MODEL_NS_R1RHO_2SITE:
-                                    self.assertAlmostEqual(value, 
1.55833321, 5)
-
-                            elif param == 'kex':
-                                if model == MODEL_DPL94:
-                                    self.assertAlmostEqual(value, 
4419.03917195, 2)
-                                elif model == MODEL_TP02:
-                                    self.assertAlmostEqual(value, 
4904.70144883, 3)
-                                elif model == MODEL_TAP03:
-                                    self.assertAlmostEqual(value, 
4909.86877150, 3)
-                                elif model == MODEL_MP05:
-                                    self.assertAlmostEqual(value, 
4909.88110195, 3)
-                                elif model == MODEL_NS_R1RHO_2SITE:
-                                    self.assertAlmostEqual(value, 
5610.20221435, 2)
-
-                            elif param == 'chi2':
-                                if model == MODEL_NOREX:
-                                    self.assertAlmostEqual(value, 
3363.95829122)
-                                elif model == MODEL_DPL94:
-                                    self.assertAlmostEqual(value, 
710.24767560)
-                                elif model == MODEL_TP02:
-                                    self.assertAlmostEqual(value, 
114.47142772)
-                                elif model == MODEL_TAP03:
-                                    self.assertAlmostEqual(value, 
114.27987534)
-                                elif model == MODEL_MP05:
-                                    self.assertAlmostEqual(value, 
114.28002272)
-                                elif model == MODEL_NS_R1RHO_2SITE:
-                                    self.assertAlmostEqual(value, 
134.14368365)
+                        if do_assert:
+                            # Compare values.
+                            if spin_id == ':52@N':
+                                if param == 'phi_ex':
+                                    if model == MODEL_DPL94:
+                                        self.assertAlmostEqual(value, 
0.07561937)
+
+                                elif param == 'pA':
+                                    if model == MODEL_TP02:
+                                        self.assertAlmostEqual(value, 
0.88807487)
+                                    elif model == MODEL_TAP03:
+                                        self.assertAlmostEqual(value, 
0.88809318)
+                                    elif model == MODEL_MP05:
+                                        self.assertAlmostEqual(value, 
0.88809321)
+                                    elif model == MODEL_NS_R1RHO_2SITE:
+                                        self.assertAlmostEqual(value, 
0.94496541, 6)
+
+                                elif param == 'dw':
+                                    if model == MODEL_TP02:
+                                        self.assertAlmostEqual(value, 
1.08765638, 6)
+                                    elif model == MODEL_TAP03:
+                                        self.assertAlmostEqual(value, 
1.08726698, 6)
+                                    elif model == MODEL_MP05:
+                                        self.assertAlmostEqual(value, 
1.08726706, 6)
+                                    elif model == MODEL_NS_R1RHO_2SITE:
+                                        self.assertAlmostEqual(value, 
1.55833321, 5)
+
+                                elif param == 'kex':
+                                    if model == MODEL_DPL94:
+                                        self.assertAlmostEqual(value, 
4419.03917195, 2)
+                                    elif model == MODEL_TP02:
+                                        self.assertAlmostEqual(value, 
4904.70144883, 3)
+                                    elif model == MODEL_TAP03:
+                                        self.assertAlmostEqual(value, 
4909.86877150, 3)
+                                    elif model == MODEL_MP05:
+                                        self.assertAlmostEqual(value, 
4909.88110195, 3)
+                                    elif model == MODEL_NS_R1RHO_2SITE:
+                                        self.assertAlmostEqual(value, 
5610.20221435, 2)
+
+                                elif param == 'chi2':
+                                    if model == MODEL_NOREX:
+                                        self.assertAlmostEqual(value, 
3363.95829122)
+                                    elif model == MODEL_DPL94:
+                                        self.assertAlmostEqual(value, 
710.24767560)
+                                    elif model == MODEL_TP02:
+                                        self.assertAlmostEqual(value, 
114.47142772)
+                                    elif model == MODEL_TAP03:
+                                        self.assertAlmostEqual(value, 
114.27987534)
+                                    elif model == MODEL_MP05:
+                                        self.assertAlmostEqual(value, 
114.28002272)
+                                    elif model == MODEL_NS_R1RHO_2SITE:
+                                        self.assertAlmostEqual(value, 
134.14368365)


         # Print the final pipe.
@@ -7524,7 +7529,7 @@

                 # Assign the split of the line.
                 mol_name, res_num, res_name, spin_num, spin_name, val, 
sd_error = line_split
-                print mol_name, res_num, res_name, spin_num, spin_name, 
val, sd_error
+                print(mol_name, res_num, res_name, spin_num, spin_name, 
val, sd_error)

                 if res_num == '52':
                     # Assert that the value is not None.


_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-commits mailing list
relax-commits@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-commits">https://mail.gna.org/listinfo/relax-commits</a>
</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00277" href="msg00277.html">Re: r25238 - /trunk/test_suite/system_tests/relax_disp.py</a></strong>
<ul><li><em>From:</em> Troels Emtek√¶r Linnet</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Tue Aug 26 10:00:30 2014</div>  
</body>
</html>
