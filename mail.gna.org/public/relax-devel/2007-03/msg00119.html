<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: Vote for the design of the relax data storage object singleton. -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Thu, 22 Mar 2007 05:10:51 +0100 -->
<!--X-Message-Id: 7f080ed10703212109pdaf2a1dge7bbe7ac1a2292e6@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 7f080ed10703140609p70d35295ye10ee5939da494a2@mail.gmail.com -->
<!--X-Reference: 1173960604.8066.341.camel@mrspell -->
<!--X-Reference: 7f080ed10703150700v2c7296behc146501949d618bf@mail.gmail.com -->
<!--X-Reference: 1173968940.8066.351.camel@mrspell -->
<!--X-Reference: 7f080ed10703150750k3c2b765fpfad3030a1db9ed12@mail.gmail.com -->
<!--X-Reference: 1173971938.8066.377.camel@mrspell -->
<!--X-Reference: 7f080ed10703150921g7469b0d6ia5506c3c47c537c8@mail.gmail.com -->
<!--X-Reference: 45F98244.4080902@bmb.leeds.ac.uk -->
<!--X-Reference: 7f080ed10703161827h7ff085ffu8ccdcdc232db3241@mail.gmail.com -->
<!--X-Reference: 1174502990.8066.478.camel@mrspell -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Vote for the design of the relax data storage object singleton. -- March 22, 2007 - 05:10</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: Vote for the design of the relax data storage object singleton.</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00119" class="tabs">Index by Date</a> | <a href="threads.html#00119" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00118.html">Date Prev</a>] [<a href="msg00120.html">Date Next</a>] [<a href="msg00117.html">Thread Prev</a>] [<a href="msg00120.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Chris MacRaild&quot; &lt;c.a.macraild@xxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Thu, 22 Mar 2007 15:09:58 +1100</li>
<li class="menuitem">
<em>Cc</em>: &quot;Gary S. Thompson&quot; &lt;garyt@xxxxxxxxxxxxxxx&gt;, relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Dkim-signature</em>: a=rsa-sha1; c=relaxed/relaxed; d=gmail.com; s=beta;	h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:cc:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;	b=COyhouSxKy+hmuoyeltyovQqFqnIJNptixFdD+BgbXIkwEaxTh8sDBqodZuZtQ3PNnggTo1jhOrxHRu3bDj0xuEhgEFVAm9tnILdKOYTM5CVRaMVVbG13M9cyqOuiHPQqpF1dQvXLG7WtcZsA0dXq4vay+bof0HrNgAO2KOUZ5M=</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00119.html">7f080ed10703212109pdaf2a1dge7bbe7ac1a2292e6@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;<a href="msg00046.html">7f080ed10703140609p70d35295ye10ee5939da494a2@mail.gmail.com</a>&gt;	&lt;<a href="msg00057.html">1173960604.8066.341.camel@mrspell</a>&gt;	&lt;<a href="msg00058.html">7f080ed10703150700v2c7296behc146501949d618bf@mail.gmail.com</a>&gt;	&lt;<a href="msg00063.html">1173968940.8066.351.camel@mrspell</a>&gt;	&lt;<a href="msg00065.html">7f080ed10703150750k3c2b765fpfad3030a1db9ed12@mail.gmail.com</a>&gt;	&lt;<a href="msg00066.html">1173971938.8066.377.camel@mrspell</a>&gt;	&lt;<a href="msg00068.html">7f080ed10703150921g7469b0d6ia5506c3c47c537c8@mail.gmail.com</a>&gt;	&lt;<a href="msg00070.html">45F98244.4080902@bmb.leeds.ac.uk</a>&gt;	&lt;<a href="msg00077.html">7f080ed10703161827h7ff085ffu8ccdcdc232db3241@mail.gmail.com</a>&gt;	&lt;<a href="msg00117.html">1174502990.8066.478.camel@mrspell</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on March 22, 2007 - 05:10:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">As far as I'm concerned there is absolutely nothing stopping me in
Python from creating a base class with singleton properties and then
subclassing this to create independent singletons that I can use for
different purposes.  An example of a singleton base class and
inheritance could be as follows.  Say I create a base class
SingletonQueue that has advanced queuing properties (say to be thread
safe) together with the properties of being a singleton.  Then I
create ResultsQueue(SingletonQueue) to queue model-free optimisation
results coming in from remote machines on a grid (there is only one
instance of this queue in the program).  I also create
OptimisationQueue(SingletonQueue) which is a queue for each
optimisation to be sent out to a grid computer (again there is only
one instance of this queue in the program).  These two queues benefit
from being thread safe.  Now, what exactly is stopping me from doing
this?  And what is stopping me from using SingletonQueue as a third
singleton object for a completely unrelated purpose?  What if
SingletonQueue was actually named ThreadQueue and was used as a queue
of threads awaiting execution?  I could use all these three queues,
they would be singletons, and their namespaces will never clash!</pre><br>
<pre style="margin: 0em;">For discussions about inheritance of singletons, see the Python
cookbook (<a  href="http://aspn.activestate.com/ASPN/Cookbook/Python">http://aspn.activestate.com/ASPN/Cookbook/Python</a>).  Examples
include:</pre><br>
<pre style="margin: 0em;"><a  href="http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/102187">http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/102187</a> (see
the comments section).
<a  href="http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/66531">http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/66531</a> (see the
comment with the title 'Singletons using new-style classes')
<a  href="http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/113657">http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/113657</a> (this
singleton 'behaves well with inheritance')</pre><br>
<pre style="margin: 0em;">As for instances of base classes, towards the bottom of the Wikipedia
page <a  href="http://en.wikipedia.org/wiki/Inheritance_">http://en.wikipedia.org/wiki/Inheritance_</a>(computer_science) there
is the text:</pre><br>
<pre style="margin: 0em;">&quot;In most quarters, class inheritance for the sole purpose of code
re-use has fallen out of favor. The primary concern is that
implementation inheritance does not provide any assurance of
polymorphic substitutabilityâ€”an instance of the re-using class cannot
necessarily be substituted for an instance of the inherited class. An
alternative technique, delegation, requires more programming effort
but avoids the substitutability issue.&quot;</pre><br>
<pre style="margin: 0em;">According to this statement 'an instance of the re-using class' is
different to the 'instance of the inherited class'.  The rest of this
text is opinion.  Now according to
<a  href="http://en.wikipedia.org/wiki/Instantiation_">http://en.wikipedia.org/wiki/Instantiation_</a>(computer_science):</pre><br>
<pre style="margin: 0em;">&quot;Instantiation is the process of creating a specific object which is a
member or instance of a class.&quot;</pre><br>
<pre style="margin: 0em;">Hence the instance is a specific object.  As the specific object lies
at a specific point in memory space, then if two variables point to
the same instance then the Python the 'id()' function will return the
same number.  According to that function's docstring:</pre><br>
<pre style="margin: 0em;">Help on built-in function id in module __builtin__:</pre><br>
<pre style="margin: 0em;">id(...)
   id(object) -&gt; integer</pre><br>
<pre style="margin: 0em;">   Return the identity of an object.  This is guaranteed to be unique among
   simultaneously existing objects.  (Hint: it's the object's memory address.)</pre><br>
<pre style="margin: 0em;">To demonstrate this, try importing the 'singleton_inheritance' module
attached to my message at
<a  href="http://www.nmr-relax.com/mail.gna.org/public/relax-devel/2007-03/msg00077.html">https://mail.gna.org/public/relax-devel/2007-03/msg00077.html</a> (the
text at the very bottom) and running the id() functions on the two
singletons:</pre><br>
<pre style="margin: 0em;">relax&gt; import singleton_inheritance</pre><br>
<pre style="margin: 0em;">Singleton is NewSingleton: False
Contents of Singleton:    ['__doc__', '__init__', '__module__', 'a',
'base_fn', 'x']
Contents of NewSingleton: ['__doc__', '__init__', '__module__', 'a',
'base_fn', 'new_fn', 'x', 'y']
Singleton.base_fn is NewSingleton.base_fn: False</pre><br>
<pre style="margin: 0em;">Singleton.a:    1
NewSingleton.a: -1
Singleton.x:    2
NewSingleton.x: 3</pre><br>
<pre style="margin: 0em;">Singleton.base_fn():
Hello
NewSingleton.base_fn():
Hello
NewSingleton.new_fn():
Bye
relax&gt; id(singleton_inheritance.Singleton)
1080385452
relax&gt; id(singleton_inheritance.NewSingleton)
1083092716</pre><br>
<pre style="margin: 0em;">These are two different memory addresses.  Hence these are two
different objects.  They are also 'simultaneously existing objects'.
As an instance is a specific object, and here with have two specific
objects, we have two instances.  QID!</pre><br>
<pre style="margin: 0em;">Bye,</pre><br>
<pre style="margin: 0em;">Edward</pre><br>
<tt><br>On 3/22/07, Chris MacRaild &lt;c.a.macraild@xxxxxxxxxxx&gt; wrote:
</tt><blockquote class="blockquote"><pre style="margin: 0em;">On Sat, 2007-03-17 at 12:27 +1100, Edward d'Auvergne wrote:
&gt; The attached file is a Python module, try importing it and then
&gt; playing with its contents.  The module contains two singletons -
&gt; 'Singleton' and 'NewSingleton'.  Both are instantiated in the same
&gt; manner as new relax data storage object (implementation B which we
&gt; voted for), the class name being masked by the instance reference.
&gt; NewSingleton is derived from the Singleton base class demonstrating
&gt; inheritance.  QID!
&gt;
&gt; These singletons are two completely different objects (in different
&gt; memory space) which can be used for completely different tasks and can
&gt; be used by completely different parts of the program all while being
&gt; true singletons - only one instance of each will ever exist in the
&gt; program.  If you cannot see this, I challenge you to write a counter
&gt; example module demonstrating that what this extremely basic module is
&gt; doing cannot be done.</pre><br>
<pre style="margin: 0em;">What this module is doing can be done (of course), but it breaks the
Singleton design because:</pre><br>
<pre style="margin: 0em;">&gt;&gt;&gt; isinstance(NewSingleton, Singleton.__class__)
True</pre><br>
<pre style="margin: 0em;">Contrary to your previous assertions, isinstance is aptly named, and
correctly identifies the inheritance relationship between these two
objects. In other words, because NewSingleton inherits from
Singleton.__class__ (ie. the class, not the instance of the same name),
NewSingleton is an instance of Singleton.__class__</pre><br>
<pre style="margin: 0em;">This is fundamental to the nature of inheritance, and is the basis of
our dissagreements. Again, the classic inheritance metaphor: class Apple
is a subclass of the class Fruit, and GrannySmith is a subclass of the
Apple. Your argument that an object cannot be an instance of more than
one class flies in the face of reason - quite clearly, any object which
is an instance of the class GrannySmith, is also an instance of Apple
and of Fruit. This is essential to the nature of sub-classing, in both
common logic and in OO programing.</pre><br>
<pre style="margin: 0em;">Perhaps it is helpful to consider the distinction between Inheritance
and Delegation. Both achieve similar things in terms of code reuse and
behavioural modification, but they do so in quite different ways, and
have important functional differences. Given some base class with lots
of methods that I want to access, while making a few changes:</pre><br>
<pre style="margin: 0em;">&gt;&gt;&gt; class Base:
...     def methodA(self):
...         print &quot;A&quot;
...     def methodB(self):
...         print &quot;B&quot;
...     # lots more methods...</pre><br>
<pre style="margin: 0em;">I could inherit from Base, and change the functionality:</pre><br>
<pre style="margin: 0em;">&gt;&gt;&gt; class Inherited(Base):
...     def methodA(self):
...         print &quot;a\n&quot;</pre><br>
<pre style="margin: 0em;">Or I could delegate to Base those methods that I don't redefine:</pre><br>
<pre style="margin: 0em;">&gt;&gt;&gt; class Delegated:
...     def methodA(self):
...         print &quot;a\n&quot;
...     def __getattr__(self, attr):
...         # If attribute lookup fails, delegate to Base
...         return getattr(Base(), attr)</pre><br>
<pre style="margin: 0em;">Instances of the two classes, Inherited and Delegated, are functionally
very similar: they have all of the same methods, most of which are
identical to those of Base. There is one important difference:</pre><br>
<pre style="margin: 0em;">&gt;&gt;&gt; isinstance(Inherited, Base)
True
&gt;&gt;&gt; isinstance(Delegated, Base)
False</pre><br>
<pre style="margin: 0em;">A great example of inheritance in the sense I am describing comes from
the Python exceptions system. All python exceptions are an instance of
the base class Exception, and from there ther exists a hierachy of
exceptions: ArithmeticError is a subclass of Exception, and in turn is a
base class for all of the standard maths errors (OverflowError,
ZeroDivisionError, etc); likewise LookupError derives from Exception,
and is base class for KeyError and IndexError. This hierachy is very
powerful, because it allows us to handle different types of error in
different ways:</pre><br>
<pre style="margin: 0em;">&gt;&gt;&gt; try:
...     errorProneFunction(args)
... except LookupError:
...     dealWithLookupError(args)
... except ArithmeticError:
...     dealWithArithmeticError(args)
... except:
...     # All other errors
...     dealWithOtherError(args)</pre><br>
<pre style="margin: 0em;">Suppose there is a case that I want to catch as an exception, that is
maths-related. Although it is not one of the standard maths errors, I
want to handle it in the same way (with the function
dealWithArithmeticError() ). I simply need to subclass from
ArithmeticError:</pre><br>
<pre style="margin: 0em;">&gt;&gt;&gt; class MyMathsError(ArithmeticError):
...     pass</pre><br>
<pre style="margin: 0em;">This works because an exception which is an instance of MyMathsError is
also an instance of ArithmeticError, so the statement except
ArithmeticError will catch MyMathsError, as well as OverflowError,
ZeroDivisionError and the rest. Importantly, no amount of delegation
will make this work:</pre><br>
<pre style="margin: 0em;">&gt;&gt;&gt; class AnotherMathsError:
...     def __getattr__(self, attr):
...         # If attribute lookup fails, delegate to Base
...         return getattr(ArithmeticError(), attr)</pre><br>
<pre style="margin: 0em;">AnotherMathsError is not caught by except ArithmeticError, because it
lacks the requisite inheritance relationship - it is not an instance of
ArithmeticError.</pre><br>
<pre style="margin: 0em;">So, to restate what I think is the orthodox OO understanding of
inheritance: any object which is an instance of a sub-class S is also an
instance of all of the classes which are base-classes of S. This is
stated somewhat obtusely at <a  href="http://en.wikipedia.org/wiki/Inheritance_%">http://en.wikipedia.org/wiki/Inheritance_%</a>
28computer_science%29 in the second paragraph:</pre><br>
<pre style="margin: 0em;">&quot;Inheritance is also sometimes called generalization, because the is-a
relationships represent a hierarchy between classes of objects. For
instance, a &quot;fruit&quot; is a generalization of &quot;apple&quot;, &quot;orange&quot;, &quot;mango&quot;
and many others. One can consider fruit to be an abstraction of apple,
orange, etc. Conversely, since apples are fruit (i.e. an apple is-a
fruit), apples may naturally inherit all the properties common to all
fruit, such as being a fleshy container for the seed of a plant.&quot;</pre><br>
<pre style="margin: 0em;">and (similarly obscurely) in almost all basic descriptions of Object
Orientated coding. This is critically important, because it allows
client code to use instances of the sub-class as if they were instances
of the base-class, without knowing anything about the properties (or
even the existance) of the sub-class.</pre><br>
<pre style="margin: 0em;">Chris</pre><br>
<pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;"><br></pre><br>
</blockquote><pre style="margin: 0em;"><br></pre><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00120" href="msg00120.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00046" href="msg00046.html">Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00057" href="msg00057.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00058" href="msg00058.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00063" href="msg00063.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00065" href="msg00065.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00066" href="msg00066.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00068" href="msg00068.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00070" href="msg00070.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Gary S. Thompson</li></ul></li>
<li><strong><a name="00077" href="msg00077.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00117" href="msg00117.html">Re: Vote for the design of the relax data storage object singleton.</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu Mar 22 13:00:46 2007</div>  
</body>
</html>
