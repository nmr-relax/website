<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: how to parallelise model_free minimise -->
<!--X-From-R13: "Unel E. Fubzcfba" <tnelgNozo.yrrqf.np.hx> -->
<!--X-Date: Tue, 27 Mar 2007 17:56:31 +0200 -->
<!--X-Message-Id: 46093E87.40409@bmb.leeds.ac.uk -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 7f080ed10703191030h79036e06w56912aa1d9130f48@mail.gmail.com -->
<!--X-Reference: 7f080ed10703200727l5fad8e72if4cf9aff74bc21@mail.gmail.com -->
<!--X-Reference: 45FFF714.7070903@bmb.leeds.ac.uk -->
<!--X-Reference: 7f080ed10703200813x323ec212l471796641855a7ff@mail.gmail.com -->
<!--X-Reference: 4603EA08.60801@bmb.leeds.ac.uk -->
<!--X-Reference: 7f080ed10703252217x7db43e6bxfe7324ad0379c778@mail.gmail.com -->
<!--X-Reference: 4607F0AB.6000807@bmb.leeds.ac.uk -->
<!--X-Reference: 7f080ed10703261002i7cc384a6n8bf20be7aaad4e0e@mail.gmail.com -->
<!--X-Reference: f001463a0703270015n76d1b728m749f70fba54d8213@mail.gmail.com -->
<!--X-Reference: f001463a0703270022iec6830fs2aec68f942d16cb2@mail.gmail.com -->
<!--X-Reference: 7f080ed10703270813k47c210d5j841f738be32941a@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: how to parallelise model_free minimise -- March 27, 2007 - 17:56</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: how to parallelise model_free minimise</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00138" class="tabs">Index by Date</a> | <a href="threads.html#00138" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00137.html">Date Prev</a>] [<a href="msg00139.html">Date Next</a>] [<a href="msg00136.html">Thread Prev</a>] [<a href="msg00139.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Edward d'Auvergne &lt;edward.dauvergne@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Tue, 27 Mar 2007 16:55:51 +0100</li>
<li class="menuitem">
<em>Cc</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00138.html">46093E87.40409@bmb.leeds.ac.uk</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;<a href="msg00092.html">7f080ed10703191030h79036e06w56912aa1d9130f48@mail.gmail.com</a>&gt;	&lt;<a href="msg00110.html">7f080ed10703200727l5fad8e72if4cf9aff74bc21@mail.gmail.com</a>&gt;	&lt;<a href="msg00112.html">45FFF714.7070903@bmb.leeds.ac.uk</a>&gt;	&lt;<a href="msg00114.html">7f080ed10703200813x323ec212l471796641855a7ff@mail.gmail.com</a>&gt;	&lt;<a href="msg00124.html">4603EA08.60801@bmb.leeds.ac.uk</a>&gt;	&lt;<a href="msg00126.html">7f080ed10703252217x7db43e6bxfe7324ad0379c778@mail.gmail.com</a>&gt;	&lt;<a href="msg00128.html">4607F0AB.6000807@bmb.leeds.ac.uk</a>&gt;	&lt;<a href="msg00129.html">7f080ed10703261002i7cc384a6n8bf20be7aaad4e0e@mail.gmail.com</a>&gt;	&lt;<a href="msg00131.html">f001463a0703270015n76d1b728m749f70fba54d8213@mail.gmail.com</a>&gt;	&lt;<a href="msg00133.html">f001463a0703270022iec6830fs2aec68f942d16cb2@mail.gmail.com</a>&gt;	&lt;<a href="msg00136.html">7f080ed10703270813k47c210d5j841f738be32941a@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>User-agent</em>: Mozilla Thunderbird 1.0.8 (X11/20060411)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Gary S. Thompson</strong> on March 27, 2007 - 17:56:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<tt>Edward d'Auvergne wrote:
</tt><blockquote class="blockquote"><tt>On 3/27/07, gary thompson &lt;garyt@xxxxxxxxxxxxxxx&gt; wrote:
</tt><blockquote class="blockquote"><tt>On 3/26/07, Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt; wrote:<br>
&gt; On 3/27/07, Gary S. Thompson &lt;garyt@xxxxxxxxxxxxxxx&gt; wrote:<br>
&gt; &gt; Edward d'Auvergne wrote:<br>
&gt; &gt; &gt; On 3/24/07, Gary S. Thompson &lt;garyt@xxxxxxxxxxxxxxx&gt; wrote:<br>
&gt;<br>
&gt; &gt; &gt;&gt; 2. what is going to change between runs or even over runs of 
the relax<br>
&gt; &gt; &gt;&gt; program.<br>
&gt; &gt; &gt;<br>
&gt; &gt; &gt; For each iteration of the main loop, these arguments and 
parameters<br>
&gt; &gt; &gt; will change.<br>
&gt; &gt; &gt;<br>
&gt; &gt; Not necessarily? certainly things such as remap_table, ri_labels, 
etc do<br>
&gt; &gt; not seem to change between passes through the loop<br>
&gt;<br>
&gt; These actually change if you have a data set missing for a single spin<br>
&gt; system because of peak overlap, etc.  Most of the time you don't see<br>
&gt; this though.<br>
&gt;<br>
&gt;</tt><br>
<br>
<pre style="margin: 0em;">Ah now I see! Well the answer here is to preprocess the data in the
master process
minimise  loop and look for shared instances and only send
the shared instances over the wire along with some tokens defining
what to replace with what.
</pre></blockquote><pre style="margin: 0em;"><br>Sort of.  I'd prefer to keep out of the language of 'shared instances'
and 'tokens', mainly because I cannot relate these terms to what is
actually happening.  Each spin system has a container with data
specific to it.  In the old code you are working with the residue
containers.  In the new code it will be spin containers located in the
nested mol-res-spin data structure.</pre><br>
<pre style="margin: 0em;">For the 'mf' and 'local_tm' parameter sets, the data sent for each
calculation is mainly the relevant variables and arrays in the spin
container.  For the 'all' and 'diff' parameter sets, the data for each
spin system needs to be merged into a number of large data sets (by
looping over the new spin_loop() function).  The initialisation of the
Mf class of the 'maths_fns.mf' module then sorts all of this data out.</pre><br>
</blockquote><tt>No I am afraid my explanation wasn't clear enough! This is a purely 
local thing for reducing the amount of data that goes over the wire (and 
it may be an optimisation that doesn't work, premature optimisation is 
the root of all evil etc... after all) So all i would do is at one end 
of the data transfer note what is common between the objects being sent  
and relpace it by a shared instance before i pickle the data to send to 
another processor.Then at the  other end i would  unshare it (if 
necessary and in a lot of cases I guess it would be uneccessary) before 
calculation commenced....</tt><br>
<br>
<br>
<blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">Then we put it all back together at the end
(i.e. we unshare things  by replacing tokens with unique instances
(this is a form of the flyweight pattern in one way but not another)
</pre></blockquote><br>
</blockquote><br>
<blockquote class="blockquote"><pre style="margin: 0em;">Not quite.  At the end you get a parameter vector and minimisation
stats.  This needs to be unpacked and placed into the relax data
storage object in the correct location.
</pre></blockquote><tt>sorry I wasn't quite clear enough again. At the other end isn't at the 
end of the computation, it is on the slave processor (i.e. at the other 
end of the interprocess communication)
</tt><blockquote class="blockquote"><pre style="margin: 0em;"><br></pre><br>
<blockquote class="blockquote"><tt>&gt; &gt; &gt;&gt; As an aside when the redesign of the spin_loops and minimise 
/model<br>
&gt; &gt; &gt;&gt; loops cuts in it would be a good idea 9from the paralle point 
of view)<br>
&gt; &gt; &gt;&gt; to have the spin loop  running faster than the minimse/model loop<br>
&gt; &gt; &gt;<br>
&gt; &gt; Sorry I wasn't quite clear here, its not comuptational speed I am<br>
&gt; &gt; talking about but the speed of the 'loop counter'<br>
&gt;<br>
&gt; Sorry, I don't quite understand what the speed of a 'loop counter' is.<br>
&gt;<br>
&gt;</tt><br>
<br>
<pre style="margin: 0em;">loop counter: a number that increases linearly each time you make a
new pass through the loop
</pre></blockquote><pre style="margin: 0em;"><br>That's what I though.  Wouldn't the computational speed of the
execution of one iteration of the main loop affect this ;)  I'll get
to the rest of your message in a second post.</pre><br>
</blockquote><tt>no it is a virtual loop counter used in dicussing which you loop through 
faster morels or spins/minimisation instances....
</tt><blockquote class="blockquote"><pre style="margin: 0em;">Cheers,</pre><br>
<pre style="margin: 0em;">Edward</pre><br>
<pre style="margin: 0em;">.</pre><br>
</blockquote><pre style="margin: 0em;"><br>regards
gary
--
-------------------------------------------------------------------
Dr Gary Thompson
Astbury Centre for Structural Molecular Biology,
University of Leeds, Astbury Building,
Leeds, LS2 9JT, West-Yorkshire, UK             Tel. +44-113-3433024
email: garyt@xxxxxxxxxxxxxxx                   Fax  +44-113-2331407
-------------------------------------------------------------------</pre><br>
<pre style="margin: 0em;"><br></pre><br>
<br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00092" href="msg00092.html">relax and Grid computing.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00110" href="msg00110.html">Re: relax, MPI, and Grid computing.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00112" href="msg00112.html">Re: relax, MPI, and Grid computing.</a></strong>
<ul><li><em>From:</em> Gary S. Thompson</li></ul></li>
<li><strong><a name="00114" href="msg00114.html">Re: relax, MPI, and Grid computing.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00124" href="msg00124.html">how to parallelise model_free minimise</a></strong>
<ul><li><em>From:</em> Gary S. Thompson</li></ul></li>
<li><strong><a name="00126" href="msg00126.html">Re: how to parallelise model_free minimise</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00128" href="msg00128.html">Re: how to parallelise model_free minimise</a></strong>
<ul><li><em>From:</em> Gary S. Thompson</li></ul></li>
<li><strong><a name="00129" href="msg00129.html">Re: how to parallelise model_free minimise</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00131" href="msg00131.html">Re: how to parallelise model_free minimise</a></strong>
<ul><li><em>From:</em> gary thompson</li></ul></li>
<li><strong><a name="00133" href="msg00133.html">Fwd: how to parallelise model_free minimise</a></strong>
<ul><li><em>From:</em> gary thompson</li></ul></li>
<li><strong><a name="00136" href="msg00136.html">Re: how to parallelise model_free minimise</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Tue Mar 27 18:23:13 2007</div>  
</body>
</html>
