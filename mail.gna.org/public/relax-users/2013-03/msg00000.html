<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: m0 models -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Wed, 13 Mar 2013 10:20:15 +0100 -->
<!--X-Message-Id: CAED9pY9+SCWP1ysg4Dmjzbv8HEAJeXVA6B+og0Z2StEF0FUSiw@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: C9F76B95&#45;81A2&#45;4400&#45;8639&#45;6B2F6D8580C6@fmp&#45;berlin.de -->
<!--X-Reference: CAED9pY8FE0s5Dnag=z+Urhj9G_5Fcjo0TZoRsyfOYOGXHC0OvQ@mail.gmail.com -->
<!--X-Reference: B679CA23&#45;C45A&#45;45E7&#45;BF00&#45;4A7C6895FD67@fmp&#45;berlin.de -->
<!--X-Reference: CAED9pY9w3Tz7TYvDnxeW5WCO18WBUZXBKDVd0ktA848nED99mw@mail.gmail.com -->
<!--X-Reference: 9D1C53DF&#45;FBC5&#45;4746&#45;9AFF&#45;6782B2D71BC8@fmp&#45;berlin.de -->
<!--X-Reference: CAED9pY9d1e+BcaS2XUJphaynyQKvQ6nrY6pUo2AyD3raYksf4Q@mail.gmail.com -->
<!--X-Reference: 19EEF4DB&#45;6A81&#45;427B&#45;94CF&#45;ABB563022028@fmp&#45;berlin.de -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: m0 models -- March 13, 2013 - 10:20</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: m0 models</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00000" class="tabs">Index by Date</a> | <a href="threads.html#00000" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[Date Prev] [<a href="msg00001.html">Date Next</a>] [Thread Prev] [<a href="msg00001.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Martin Ballaschk &lt;ballaschk@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Wed, 13 Mar 2013 10:19:42 +0100</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-users@xxxxxxx&quot; &lt;relax-users@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113;	h=mime-version:x-received:sender:in-reply-to:references:date	:x-google-sender-auth:message-id:subject:from:to:cc:content-type	:content-transfer-encoding;	bh=kgCAYuznk1TjNqvIejAZM7Vvj2JYXBs2ayLPEGQAG+I=;	b=BE8N0yoL+SVMh3VdNQH1e6TL+UiX/q44u2XFcA4xLuoVFoB0Ywx4+kM6zqUGxU7Ixr	+Ey0JKpuVsl44IUhH0AFVcBLy5PVqzCVlmqPek73GvyYZz7lHG1bLfrevZmhDRYHr7lF	u8UXedkeJ4tadJQ9JrBs2cebOQEmTVb6pcYEjFy8YnDyaatjRTg+QkCl+KYUK9CtxFl1	LUSPQg6uP92/hrCqr/EFBtfqnRVvwKdHorY/6Up2//8gzp1stQrqDD5DXh/cqpIBzFjw	LPEQGWn8sfelZfNdfATNUXAXvzLG69MzFnJ4T/EdnylcMiFq+YEplOs90rk+prVm54A6	okow==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00000.html">CAED9pY9+SCWP1ysg4Dmjzbv8HEAJeXVA6B+og0Z2StEF0FUSiw@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;C9F76B95-81A2-4400-8639-6B2F6D8580C6@xxxxxxxxxxxxx&gt;	&lt;CAED9pY8FE0s5Dnag=z+Urhj9G_5Fcjo0TZoRsyfOYOGXHC0OvQ@xxxxxxxxxxxxxx&gt;	&lt;B679CA23-C45A-45E7-BF00-4A7C6895FD67@xxxxxxxxxxxxx&gt;	&lt;CAED9pY9w3Tz7TYvDnxeW5WCO18WBUZXBKDVd0ktA848nED99mw@xxxxxxxxxxxxxx&gt;	&lt;9D1C53DF-FBC5-4746-9AFF-6782B2D71BC8@xxxxxxxxxxxxx&gt;	&lt;CAED9pY9d1e+BcaS2XUJphaynyQKvQ6nrY6pUo2AyD3raYksf4Q@xxxxxxxxxxxxxx&gt;	&lt;19EEF4DB-6A81-427B-94CF-ABB563022028@xxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on March 13, 2013 - 10:20:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi,

Sorry about the late response, I've been incredibly busy lately.
Please see below for some comments:


</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">Rex of around 10^-18 (=nearly zero)
</pre></blockquote><pre style="margin: 0em;">sigma_ex = Rex / omega**2
</pre></blockquote><pre style="margin: 0em;">

I extract Rex with the following command, I guess this is then the 
already field-corrected value?
</pre><blockquote class="blockquote"><pre style="margin: 0em;">value.write( param = 'rex', file = 'example/rex.txt')
</pre></blockquote></blockquote><pre style="margin: 0em;">

This is clearly a bug!  For example on an 800, you should multiply
1e-18 with the value of ~2.6e17.  Could you file a bug report for
this?  A value of 1e-18 should give a significant, yet low, Rex value
of 0.15-0.3 rad.s^-1.
</pre></blockquote><pre style="margin: 0em;">

I'm not sure what kind of data / dump would be helpful as an attachment. 
I'm also not sure if this is really a bug?
</pre></blockquote><pre style="margin: 0em;">

I'll have to think about this one.  In the documentation for the
value.set user function
(<a  rel="nofollow" href="http://www.nmr-relax.com/manual/value_set.html">http://www.nmr-relax.com/manual/value_set.html</a>) it says that you need
to input the Rex value as the field strength independent value, so you
need to scale with:

    value = rex / (2.0 * pi * frequency) ** 2

The value.read user function also says this
(<a  rel="nofollow" href="http://www.nmr-relax.com/manual/value_read.html">http://www.nmr-relax.com/manual/value_read.html</a>).  So maybe it makes
sense that if the field strength independent value is input, then this
value should also be output.  But the grace.write user function scales
to the first spectrometer frequency.  This is confusing and I don't
know a solution yet.  Maybe I just need to add a description of the
field strength independent Rex value to the value.write user function
documentation (and value.display).  Do you have any ideas?


</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;"> chi^2 and AIC values do not converge but differ by only a factor of 
10^10 [in fact, the fluctuations are small, and in the range of approx 
1e-10] from each other in the last ~20 rounds.
</pre></blockquote><pre style="margin: 0em;">

How many rounds is it up to?  If it runs infinitely, then maybe you
have run into a chaotic system.  Now that would be fascinating!
Theoretically anyway, biologically it would be irrelevant.
</pre></blockquote><pre style="margin: 0em;">

Hooray chaos! I finally killed it after 190 rounds. That poor workstation 
would have worked forever I guess.

</pre><blockquote class="blockquote"><pre style="margin: 0em;">I'm guessing you mean 1e-10.  Can you see which models are changing?
</pre></blockquote><pre style="margin: 0em;">

Models are not changing at all.

Link to a plot of assigned models over the iterations (every plot 
corresponds to a single residue, y axis corresponds to models 0-9):

<a  rel="nofollow" href="https://gna.org/support/download.php?file_id=17287">https://gna.org/support/download.php?file_id=17287</a>

</pre><blockquote class="blockquote"><pre style="margin: 0em;">Can you find any chi2 or AIC values which match between the rounds?
</pre></blockquote><pre style="margin: 0em;">

</pre><blockquote class="blockquote"><pre style="margin: 0em;">If you make a table of total parameter number, chi2, and AIC, can you
see any patterns?
</pre></blockquote><pre style="margin: 0em;">

Have a look for yourself: I can't see any patterns. Looks like random to me.

Link to tab-seperated table of parameters:
<a  rel="nofollow" href="https://gna.org/support/download.php?file_id=17284">https://gna.org/support/download.php?file_id=17284</a>

Link to plot of parameters over iterations:
<a  rel="nofollow" href="https://gna.org/support/download.php?file_id=17286">https://gna.org/support/download.php?file_id=17286</a>

Link to plot of parameters over iterations, zoomed in:
<a  rel="nofollow" href="https://gna.org/support/download.php?file_id=17287">https://gna.org/support/download.php?file_id=17287</a>
</pre></blockquote><pre style="margin: 0em;">

There are some clear patterns in the chi-squared value.  However this
is a bizarre problem!  It looks like it's jumping around chaotically
with the chi2 value and Rex value varying significantly above machine
precision, but not significantly from a dynamics perspective.  I don't
know if this is caused by strangeness in the system you are studying
or strangeness due to the CPU architecture + C library version +
Python version + numpy version.  You could look at these plots and
judge where you think the changes are no longer significant, and then
use the maximum iteration argument in the dauvergne_protocol
auto-analysis to terminate early.


</pre><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">However I don't
think I've seen a problem which runs forever - that would just be
theoretically weird.
</pre></blockquote><pre style="margin: 0em;">

*sigh*
</pre></blockquote><pre style="margin: 0em;">

You can say that again!


</pre><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">Those are quite interesting plots.  Though I'm not sure why m0 is
selected so often.  I've never seen such a phenomenon.
</pre></blockquote><pre style="margin: 0em;">

Maybe you should come around for a visit, talk to Peter Schmieder, Hartmut 
Oschkinat and Phil Selenko and then you can crush my dreams of doing 
anything useful with our system.

That would be fun.
</pre></blockquote><pre style="margin: 0em;">

Lol, that might be an option.  I was wondering if you had the latest
Bruker pulse sequences for R1 and R2 from Wolfgang Bermel?  They come
with the latest topspin version, or you can just ask him about them.
My old boss, Paul Gooley and I talked to him and got him to create
sequences with single scan interleaving and temperature compensation
blocks - both in the same experiment.  I'm guessing that your pulse
sequences are at this level anyway.


</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">I can only recommend switching to Sparky for this type of analysis.
</pre></blockquote></blockquote><pre style="margin: 0em;">You can use Topspin to split up the file and create a set of 2D fids.
These can then be used for processing in nmrPipe, if you like, and
converted to Sparky format.
</pre></blockquote><pre style="margin: 0em;">

I process with Topspin, (zero-fill for 8k, baseline correction, forward 
prediction, set the right nc_proc, etc etc), convert to ucsf with 
bruk2ucsf, corrected for the sfo1 with ucsfdata and imported the spectra 
one-by-one into Sparky. Then copied my reference peak list onto all single 
spectra and saved the resulting peak heights.

<a  rel="nofollow" href="https://gna.org/support/download.php?file_id=17290">https://gna.org/support/download.php?file_id=17290</a>
<a  rel="nofollow" href="https://gna.org/support/download.php?file_id=17291">https://gna.org/support/download.php?file_id=17291</a>
<a  rel="nofollow" href="https://gna.org/support/download.php?file_id=17292">https://gna.org/support/download.php?file_id=17292</a>
<a  rel="nofollow" href="https://gna.org/support/download.php?file_id=17293">https://gna.org/support/download.php?file_id=17293</a>

(some of the plots are truncated for outliers)

I don't see an indication that there are significant differences between 
picking with sparky or picking with ccpn ...
</pre></blockquote><pre style="margin: 0em;">

If you calculate the correlation coefficient for the plot of
<a  rel="nofollow" href="https://gna.org/support/download.php?file_id=17291">https://gna.org/support/download.php?file_id=17291</a>, I think you'll
notice some bias there.  And some of the outliers appear to have value
differences up to 10 rad.s^-1.  These differences are not
insignificant and could influence the model-free results.

For Sparky (and Topspin for that matter), when extracting such precise
peak height data data I would recommend zero filling to 16k*16k.  You
may need to turn off polynomial baseline corrections when zero-filling
so much.  And why do you use forward prediction?  Linear prediction
should be avoided when you want accurate peak heights.

Regards,

Edward


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Mon Mar 18 11:00:08 2013</div>  
</body>
</html>
