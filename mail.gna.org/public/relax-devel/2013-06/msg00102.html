<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: [bug #20821] Optimisation failure / round error on windows 64 bit -->
<!--X-From-R13: Febryf Szgrxæe Zvaarg <gyvaargNtznvy.pbz> -->
<!--X-Date: Wed, 19 Jun 2013 07:43:50 +0200 -->
<!--X-Message-Id: CA+CBx2NB9Zt0Ft8dwLX6x4hUrSYE=3rCObSrA_bXHA1k3BZ2CQ@mail.gmail.com -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: 20130516&#45;220427.sv20529.24009@gna.org -->
<!--X-Reference: 20130517&#45;081119.sv2782.89797@gna.org -->
<!--X-Reference: 20130618&#45;160441.sv20529.22737@gna.org -->
<!--X-Reference: CAED9pY__dgZvY0+KPH3R4yiLG4Xehiz4k6eFSdBvBNRhEqaP8w@mail.gmail.com -->
<!--X-Reference: CA+CBx2NChCA4d8o8TBx_pc9JSnGxCTnFqWaUMSB1FLfTSgei6g@mail.gmail.com -->
<!--X-Reference: CAED9pY&#45;6zmEdHfQT6KUKPLuwEMuCxoYH9MR=9um+zQBOzBhGHQ@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [bug #20821] Optimisation failure / round error on windows 64 bit -- June 19, 2013 - 07:43</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: [bug #20821] Optimisation failure / round error on windows 64 bit</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00102" class="tabs">Index by Date</a> | <a href="threads.html#00102" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00101.html">Date Prev</a>] [<a href="msg00103.html">Date Next</a>] [<a href="msg00097.html">Thread Prev</a>] [<a href="msg00124.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Edward d'Auvergne&quot; &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Wed, 19 Jun 2013 07:42:59 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113;	h=mime-version:in-reply-to:references:from:date:message-id:subject:to	:cc:content-type;	bh=UvzC7pjamMGm1n+6+wFqDTP24owceIbAgTFe2XQR1d0=;	b=JBDwCybLnlGXuKlg3EDrkcs9eXpeI4/wQtoKMpMNgHGrp+LQB/p268wJHSfDEUYnGz	iErUkJ0A287UMg7MncVuqPGMHvU/SVtRVFF97GIWzgoT3m/m77cVWN3jeg06kxhoF4zl	LyvEu5aCoz3WrGSsgVE8pl+ZwYgQoxgExS9hIvHMhrPGPfrMqM58kNiGYblKIofM0R+K	HbQnqqsjlFUIODHv07TAtANV1zCiRASNGSQPNm0c8p74yntOW3dCPs/AdxC9LnrX7+P3	Cv8TAzW76Iz1tHZtfz7pALgb4orEkvMftDhkwdZnVxFrOpScqtE2PD+bRYS0JcktMW5n	DdeA==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00102.html">CA+CBx2NB9Zt0Ft8dwLX6x4hUrSYE=3rCObSrA_bXHA1k3BZ2CQ@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;20130516-220427.sv20529.24009@xxxxxxx&gt;	&lt;20130517-081119.sv2782.89797@xxxxxxx&gt;	&lt;20130618-160441.sv20529.22737@xxxxxxx&gt;	&lt;CAED9pY__dgZvY0+KPH3R4yiLG4Xehiz4k6eFSdBvBNRhEqaP8w@xxxxxxxxxxxxxx&gt;	&lt;CA+CBx2NChCA4d8o8TBx_pc9JSnGxCTnFqWaUMSB1FLfTSgei6g@xxxxxxxxxxxxxx&gt;	&lt;CAED9pY-6zmEdHfQT6KUKPLuwEMuCxoYH9MR=9um+zQBOzBhGHQ@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Troels Emtekær Linnet</strong> on June 19, 2013 - 07:43:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
Hi Edward.<br><br>I will fix it.<br><br>Just to make it clear.<br><br>I use the winpython system on my windows computer, not EPD.<br>That is to produce a total &quot;standalone&quot; python/relax program, without the necessity to have<br>

admin rights for installation. And the possibility to drag it along on a USB stick with me.<br>And to easily put it on teaching computers, without to involve the IT department.<br>I still need to figure out, if you can build relax with mingw, which would be<br>

very nice. The necessicity for Install of Visual Studio Express 2012, which is several gigabytes,<div>is quite unwanted.<br><br>On linux, I have used EPD to solve not to install wxpython on all lab computers, and<br>solve python dependencies for all of them. Just installing it in the EPD python.</div>

<div>The entropy has grown in our linux installations, and so I am looking for a central solution.<br><br>Best<br>Troels<br><br><br>Troels Emtekær Linnet<br><br><br>2013/6/18 Edward d&#39;Auvergne &lt;<a rel="nofollow" href="mailto:edward@xxxxxxxxxxxxx">edward@xxxxxxxxxxxxx</a>&gt;:<br>

&gt; Exactly, that is the solution!  I&#39;ve noticed in general that MS<br>&gt; Windows has roughly the same precision as the other systems.  You can<br>&gt; see that in the comments of the other tests.  I also do not see this<br>

&gt; precision failure on 32-bit Windows 2000 or 64-bit Windows Vista and<br>&gt; 7.  Why your specific system is 4 orders of magnitude less precise is<br>&gt; completely unclear to me.  Maybe it is the use of the EPD distribution<br>

&gt; (<a rel="nofollow" href="https://www.enthought.com/products/epd/">https://www.enthought.com/products/epd/</a>), as this is the biggest<br>&gt; difference with the systems.  I really don&#39;t know.  But in any case,<br>&gt; the results are precise enough for any analysis of real data.<br>

&gt;<br>&gt; Regards,<br>&gt;<br>&gt; Edward<br>&gt;<br>&gt;<br>&gt;<br>&gt;<br>&gt; On 18 June 2013 18:42, Troels Emtekær Linnet &lt;<a rel="nofollow" href="mailto:tlinnet@xxxxxxxxx">tlinnet@xxxxxxxxx</a>&gt; wrote:<br>&gt;&gt; Allright.<br>

&gt;&gt;<br>&gt;&gt; The problem lies in:<br>&gt;&gt; test_opt_constr_cd_mt_S2_0_970_te_2048_Rex_0_149<br>&gt;&gt;<br>&gt;&gt; From comments:<br>&gt;&gt; 32-bit i686 Linux. s2                    = 0.9700000000219662<br>&gt;&gt; 64-bit x86_64 Linux. s2              = 0.9700000000219674<br>

&gt;&gt; 32-bit powerpc Darwin  S2        = 0.9700000000219674<br>&gt;&gt; 64-bit i386 Darwin                      = 0.9700000000219674<br>&gt;&gt;<br>&gt;&gt; Matched value                            = 0.9700000000219674<br>

&gt;&gt;<br>&gt;&gt; windows 7                                    = 0.9700002183674102<br>&gt;&gt;<br>&gt;&gt; The assert equal as standard goes to 7 decimals.<br>&gt;&gt;&gt;&gt;&gt; a = 0.9700000000219674<br>&gt;&gt;&gt;&gt;&gt; b = 0.9700002183674102<br>

&gt;&gt;&gt;&gt;&gt; print a-b<br>&gt;&gt; -2.18345442837e-07<br>&gt;&gt;<br>&gt;&gt; So, if the solution would be lower the assert equal to 6 decimal, it<br>&gt;&gt; will go fine.<br>&gt;&gt; Is that the solution?<br>&gt;&gt;<br>

&gt;&gt; And I do not understand why windows go so crazy wrong, compare to the<br>&gt;&gt; other systems.<br>&gt;&gt;<br>&gt;&gt; System:           Windows<br>&gt;&gt; Release:          7<br>&gt;&gt; Version:          6.1.7601<br>

&gt;&gt; Win32 version:    7 6.1.7601 SP1 Multiprocessor Free<br>&gt;&gt; Distribution:<br>&gt;&gt; Architecture:     64bit WindowsPE<br>&gt;&gt; Machine:          AMD64<br>&gt;&gt; Processor:        Intel64 Family 6 Model 37 Stepping 2, GenuineIntel<br>

&gt;&gt; Python version:   2.7.5<br>&gt;&gt; Numpy version:    1.7.1<br>&gt;&gt; Libc version:<br>&gt;&gt;<br>&gt;&gt; s2:                         0.9700002183674102<br>&gt;&gt; te (ps):                        2048.015293187<br>

&gt;&gt; rex:                       0.14899473115727899<br>&gt;&gt; chi2:                   2.3195994119090742e-10<br>&gt;&gt; iter:                                      116<br>&gt;&gt; f_count:                                   411<br>

&gt;&gt; g_count:                                   411<br>&gt;&gt; h_count:                                     0<br>&gt;&gt; warning:                                  None<br>&gt;&gt;<br>&gt;&gt;<br>&gt;&gt; Troels Emtekær Linnet<br>

&gt;&gt;<br>&gt;&gt;<br>&gt;&gt; 2013/6/18 Edward d&#39;Auvergne &lt;<a rel="nofollow" href="mailto:edward@xxxxxxxxxxxxx">edward@xxxxxxxxxxxxx</a>&gt;<br>&gt;&gt;&gt;<br>&gt;&gt;&gt; Yes, the problem is a precision issue.  Your system ends up with<br>

&gt;&gt;&gt; slightly different results from the perfect synthetic values.  This is<br>&gt;&gt;&gt; not an issue though, as 0.9700002183674102 is pretty much the same as<br>&gt;&gt;&gt; 0.970.  Note the comments in that system test - it would be useful to<br>

&gt;&gt;&gt; add an entry for the results from your system.  These comments are<br>&gt;&gt;&gt; used to track and act as a record of how optimisation is different on<br>&gt;&gt;&gt; each system.  It is useful to see which systems are not so accurate.<br>

&gt;&gt;&gt; This is not the fix though.<br>&gt;&gt;&gt;<br>&gt;&gt;&gt; The problem is within the value_test() method.  Look carefully at how<br>&gt;&gt;&gt; the precision is set to 5 decimal places for model-free order<br>

&gt;&gt;&gt; parameters and 4 for correlation times.  Then look at which parameter<br>&gt;&gt;&gt; is failing.  I&#39;ll give you another hint if this is not enough.<br>&gt;&gt;&gt;<br>&gt;&gt;&gt; Regards,<br>&gt;&gt;&gt;<br>

&gt;&gt;&gt; Edward<br>&gt;&gt;&gt;<br>&gt;&gt;&gt;<br>&gt;&gt;&gt;<br>&gt;&gt;&gt; On 18 June 2013 18:04, Troels E. Linnet<br>&gt;&gt;&gt; &lt;<a rel="nofollow" href="mailto:NO-REPLY.INVALID-ADDRESS@xxxxxxx">NO-REPLY.INVALID-ADDRESS@xxxxxxx</a>&gt; wrote:<br>

&gt;&gt;&gt; &gt; Follow-up Comment #1, bug #20821 (project relax):<br>&gt;&gt;&gt; &gt;<br>&gt;&gt;&gt; &gt; It seems from the log file, that the precision on the windows compiled system<br>&gt;&gt;&gt; &gt; is bad.<br>
&gt;&gt;&gt; &gt;<br>
&gt;&gt;&gt; &gt; The true value should be:<br>&gt;&gt;&gt; &gt; S2=0.970, te=2048, Rex=0.149<br>&gt;&gt;&gt; &gt;<br>&gt;&gt;&gt; &gt; Windows compiled minimise to: s2 0.9700002183674102<br>&gt;&gt;&gt; &gt; which is bad.<br>

&gt;&gt;&gt; &gt;<br>&gt;&gt;&gt; &gt; But, I don&#39;t know where to start?<br>&gt;&gt;&gt; &gt; Is it something with the compilation?<br>&gt;&gt;&gt; &gt; This is 64 bit compiled, and not 32 bit compiled.<br>&gt;&gt;&gt; &gt;<br>

&gt;&gt;&gt; &gt; Log file is provided.<br>&gt;&gt;&gt; &gt;<br>&gt;&gt;&gt; &gt;<br>&gt;&gt;&gt; &gt;<br>&gt;&gt;&gt; &gt; (file #18115)<br>&gt;&gt;&gt; &gt;     _______________________________________________________<br>

&gt;&gt;&gt; &gt;<br>&gt;&gt;&gt; &gt; Additional Item Attachment:<br>&gt;&gt;&gt; &gt;<br>&gt;&gt;&gt; &gt; File name: 20130618_relax_disp_testsuite.txt Size:273 KB<br>&gt;&gt;&gt; &gt;<br>&gt;&gt;&gt; &gt;<br>&gt;&gt;&gt; &gt;     _______________________________________________________<br>

&gt;&gt;&gt; &gt;<br>&gt;&gt;&gt; &gt; Reply to this item at:<br>&gt;&gt;&gt; &gt;<br>&gt;&gt;&gt; &gt;   &lt;<a rel="nofollow" href="http://gna.org/bugs/?20821">http://gna.org/bugs/?20821</a>&gt;<br>&gt;&gt;&gt; &gt;<br>&gt;&gt;&gt; &gt; _______________________________________________<br>

&gt;&gt;&gt; &gt;   Message sent via/by Gna!<br>&gt;&gt;&gt; &gt;   <a rel="nofollow" href="http://gna.org/">http://gna.org/</a><br>&gt;&gt;&gt; &gt;<br>&gt;&gt;&gt; &gt;<br>&gt;&gt;&gt; &gt; _______________________________________________<br>

&gt;&gt;&gt; &gt; relax (<a rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)<br>&gt;&gt;&gt; &gt;<br>&gt;&gt;&gt; &gt; This is the relax-devel mailing list<br>&gt;&gt;&gt; &gt; <a rel="nofollow" href="mailto:relax-devel@xxxxxxx">relax-devel@xxxxxxx</a><br>

&gt;&gt;&gt; &gt;<br>&gt;&gt;&gt; &gt; To unsubscribe from this list, get a password<br>&gt;&gt;&gt; &gt; reminder, or change your subscription options,<br>&gt;&gt;&gt; &gt; visit the list information page at<br>&gt;&gt;&gt; &gt; <a rel="nofollow" href="https://mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a><br>

</div>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00094" href="msg00094.html">[bug #20821] Optimisation failure / round error on windows 64 bit</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00095" href="msg00095.html">Re: [bug #20821] Optimisation failure / round error on windows 64 bit</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00096" href="msg00096.html">Re: [bug #20821] Optimisation failure / round error on windows 64 bit</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
<li><strong><a name="00097" href="msg00097.html">Re: [bug #20821] Optimisation failure / round error on windows 64 bit</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Wed Jun 19 20:00:11 2013</div>  
</body>
</html>
