<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: r24942 &#45; /branches/R1_fitting/specific_analyses/relax_disp/variables.py -->
<!--X-From-R13: "Sqjneq q'Ohiretar" &#60;rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Mon, 18 Aug 2014 11:35:02 +0200 -->
<!--X-Message-Id: CAED9pY&#45;rGE7bPOatyMEFy&#45;_cE6tAWnOvTUZnHYe+_Uab9nW4fA@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: E1XELxV&#45;0007pU&#45;1l@subversion.gna.org -->
<!--X-Reference: CAED9pY_0PmcnoXtHo2VaX9RRNn82koCcSFi4UTmtW0JhskiM4A@mail.gmail.com -->
<!--X-Reference: CA+CBx2N33H0H+h3Vh7U2p1cLwdWhBEbr2NJx&#45;PvfYDm4U+H2ng@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: r24942 - /branches/R1_fitting/specific_analyses/relax_disp/variables.py -- August 18, 2014 - 11:35</title>
<link rel="stylesheet" type="text/css" href="/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="https://gna.org/images/gna.theme/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: r24942 - /branches/R1_fitting/specific_analyses/relax_disp/variables.py</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00084" class="tabs">Index by Date</a> | <a href="threads.html#00084" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00083.html">Date Prev</a>] [<a href="msg00085.html">Date Next</a>] [<a href="msg00081.html">Thread Prev</a>] [<a href="msg00073.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Mon, 18 Aug 2014 11:34:31 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113; h=mime-version:sender:in-reply-to:references:date:message-id:subject :from:to:cc:content-type:content-transfer-encoding; bh=9mltWAeGs4JnZAj4QFTEyzGx6b1FtvcPRGIEsKGRan0=; b=Ct6of790wM7+fNNJbE5GdtqNEnm2TUtBBiW39nN+8SpCcc9K+GRCYgrtEJUmGvSdDU O4CdD0Icj6BXLvKPOsXytUTB0ypNNxTOvwJRW/VwVV/yrvilx8AkrYs9QDrDqyg9w0xr hOwGOU3l88owGHn/u/razLcCcK3vK2d9l1JFVLelCZWRn5ySobg/lcTy88JedxbO7X4g ZyPVAm2E+D+EBWWZp6ljO1DLMcpgVYqptl1Vhd4GjYJH5am+zeL5hgtXucMjUySMsTaG G5LM8V2UZa1bB87U7Wb9yZYKNKqj5rAN458Q+KJr7U50923C+D/+JmauKtuKhUDOsGYT AC8Q==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00084.html">CAED9pY-rGE7bPOatyMEFy-_cE6tAWnOvTUZnHYe+_Uab9nW4fA@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;E1XELxV-0007pU-1l@subversion.gna.org&gt; &lt;<a href="msg00071.html">CAED9pY_0PmcnoXtHo2VaX9RRNn82koCcSFi4UTmtW0JhskiM4A@mail.gmail.com</a>&gt; &lt;<a href="msg00081.html">CA+CBx2N33H0H+h3Vh7U2p1cLwdWhBEbr2NJx-PvfYDm4U+H2ng@mail.gmail.com</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on August 18, 2014 - 11:35:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi,

Yes, this is just the frontend.  The backend just requires one new
function to work out how to handle the 'No Rex' model for the user.  I
would summarise it as the following 6 cases:

On-res CPMG (unused R1):  When exp_type is set to CPMG by the user,
then we default to func_NOREX().
CPMG fixed R1:  Reserved for the future when off-res data is handled.
CPMG fit R1:  Reserved for the future when off-res data is handled.
On-res R1rho (unused R1):  When exp_type is R1rho and no offset data
or chemical shift data is loaded, then use func_NOREX().
R1rho fixed R1:  When exp_type is R1rho and R1 data has been loaded by
the user, then default to func_NOREX_R1RHO().
R1rho fit R1:  When exp_type is R1rho and R1 data has not been loaded,
then use func_NOREX_R1RHO_FIT_R1().

I think that covers the logic.  What do you think?  The user can the
choose which behaviour will occur simply by what data they load into
relax.  There is no need for allowing the user to choose the different
models/behaviours as RelaxErrors will occur if they don't load the
correct data.  The above cases could be added to the user function
documentation, well using completely different text, so the user is
clear as to how the behaviour is to be selected.  The function that
determines which behaviour would be used could then print out a line
for user feedback.

Regards,

Edward



On 18 August 2014 11:15, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Edward.

The issue you are rising, is then only a front-end problem.

I would be the information present in either:
help(relax_disp.select_model)
or in the GUI.

I think in:
&quot;relax_disp.select_mode&quot;
it should stay as it is, giving all the flexibility for scripting, but
in the GUI, it could be eliminated.

For the auto_analysis, we can make a check of self.models, and replace
models with the fit_r1 or 'No Rex' depending on selected models.

Best
Troels

2014-08-18 10:52 GMT+02:00 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Hi Troels,

Pity I couldn't see this early to discuss it.  But the
MODEL_NOREX_R1RHO model should be merged into MODEL_NOREX.  We can
make the decision for the user if on or off-resonance is handled.
This again is for the future support of off-resonance effects in the
CPMG experiments.  Part of the relax design is to minimise what is
presented to the user.  If they select the 'No Rex' model, then this
model should work for on-resonance and off-resonance R1rho data, as
well as CPMG data, without them having to think about it.  We are
fully capable of handling this in the backend for the user.

'No Rex' is simple for a user to understand as it means no chemical
exchange.  Having multiple 'No Rex' models will be confusing.
Allowing R1 to be optimised via another 'No Rex' model could be
useful.  Though again we can handle this in the backend - if no R1
data is present, we present a warning &quot;No R1 data has been loaded,
optimising this as a parameter of the model&quot; and then just optimise it
for them.  The backend would just have a few different target
functions for the same model.  The simpler we make the interface for
the user, without taking away any functionality, the more powerful the
software will become.

Cheers,

Edward


On 4 August 2014 19:22,  &lt;tlinnet@xxxxxxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Author: tlinnet
Date: Mon Aug  4 19:22:04 2014
New Revision: 24942

URL: <a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax?rev=24942&amp;view=rev">http://svn.gna.org/viewcvs/relax?rev=24942&amp;view=rev</a>
Log:
Added 2 new models, MODEL_NOREX_R1RHO and MODEL_NOREX_R1RHO_FIT_R1.

The &quot;NOREX&quot; model is not covering R1rho models.
The target function for &quot;NOREX&quot; is calculated as:
back_calc = R20

R20 is for R1hro models equivalent to R1rho prime (R1rho'), which for 
example in the model of DPL94 would mean:
R1rho = R1rho'

But for the &quot;NOREX&quot; case, the return should be
R1rho = R1 * cos^2(theta) + (R1rho' + 0) * sin^2(theta)

This affects all off-resonance model calculations.

These two target functions will be implemented.

bug #22440(<a  rel="nofollow" href="https://gna.org/bugs/?22440">https://gna.org/bugs/?22440</a>): The &quot;NOREX&quot; model is not 
covering R1rho models.
sr #3135(<a  rel="nofollow" href="https://gna.org/support/?3135">https://gna.org/support/?3135</a>): Optimisation of the R1 
relaxation rate for the off-resonance R1rho relaxation dispersion models.

Modified:
    branches/R1_fitting/specific_analyses/relax_disp/variables.py

Modified: branches/R1_fitting/specific_analyses/relax_disp/variables.py
URL: 
<a  rel="nofollow" href="http://svn.gna.org/viewcvs/relax/branches/R1_fitting/specific_analyses/relax_disp/variables.py?rev=24942&amp;r1=24941&amp;r2=24942&amp;view=diff">http://svn.gna.org/viewcvs/relax/branches/R1_fitting/specific_analyses/relax_disp/variables.py?rev=24942&amp;r1=24941&amp;r2=24942&amp;view=diff</a>
==============================================================================
--- branches/R1_fitting/specific_analyses/relax_disp/variables.py       
(original)
+++ branches/R1_fitting/specific_analyses/relax_disp/variables.py       
Mon Aug  4 19:22:04 2014
@@ -64,6 +64,14 @@
 MODEL_DESC_NOREX = &quot;The model for no chemical exchange relaxation.&quot;
 MODEL_PARAMS_NOREX = ['r2']

+MODEL_NOREX_R1RHO = &quot;No_Rex_R1rho_off_res&quot;
+MODEL_DESC_NOREX_R1RHO = &quot;The model for no chemical exchange relaxation, 
for R1rho off resonance models.&quot;
+MODEL_PARAMS_NOREX_R1RHO = ['r2']
+
+MODEL_NOREX_R1RHO_FIT_R1 = &quot;%s_fit_r1&quot;%MODEL_NOREX_R1RHO
+MODEL_DESC_NOREX_R1RHO_FIT_R1 = &quot;The model for no chemical exchange 
relaxation, for R1rho off resonance models, where R1 is fitted.&quot;
+MODEL_PARAMS_NOREX_R1RHO_FIT_R1 = ['r1_fit', 'r2']
+
 MODEL_LM63 = 'LM63'
 MODEL_DESC_LM63 = &quot;The Luz and Meiboom (1963) 2-site fast exchange model 
for SQ-CPMG experiments.&quot;
 MODEL_PARAMS_LM63 = ['r2', 'phi_ex', 'kex']
@@ -196,16 +204,16 @@
 MODEL_LIST_CPMG_FULL = [MODEL_R2EFF, MODEL_NOREX, MODEL_LM63, 
MODEL_LM63_3SITE, MODEL_CR72, MODEL_CR72_FULL, MODEL_IT99, MODEL_TSMFK01, 
MODEL_B14, MODEL_B14_FULL, MODEL_NS_CPMG_2SITE_3D, 
MODEL_NS_CPMG_2SITE_3D_FULL, MODEL_NS_CPMG_2SITE_STAR, 
MODEL_NS_CPMG_2SITE_STAR_FULL, MODEL_NS_CPMG_2SITE_EXPANDED]
 &quot;&quot;&quot;The list of the R2eff model together with all dispersion models 
specifically for CPMG-type experiments.&quot;&quot;&quot;

-MODEL_LIST_R1RHO = [MODEL_NOREX, MODEL_M61, MODEL_M61B, MODEL_DPL94, 
MODEL_DPL94_FIT_R1, MODEL_TP02, MODEL_TAP03, MODEL_MP05, 
MODEL_NS_R1RHO_2SITE, MODEL_NS_R1RHO_3SITE, MODEL_NS_R1RHO_3SITE_LINEAR]
+MODEL_LIST_R1RHO = [MODEL_NOREX, MODEL_NOREX_R1RHO, 
MODEL_NOREX_R1RHO_FIT_R1, MODEL_M61, MODEL_M61B, MODEL_DPL94, 
MODEL_DPL94_FIT_R1, MODEL_TP02, MODEL_TAP03, MODEL_MP05, 
MODEL_NS_R1RHO_2SITE, MODEL_NS_R1RHO_3SITE, MODEL_NS_R1RHO_3SITE_LINEAR]
 &quot;&quot;&quot;The list of all dispersion models specifically for R1rho-type 
experiments (excluding the R2eff model).&quot;&quot;&quot;

-MODEL_LIST_R1RHO_FULL = [MODEL_R2EFF, MODEL_NOREX, MODEL_M61, 
MODEL_M61B, MODEL_DPL94, MODEL_DPL94_FIT_R1, MODEL_TP02, MODEL_TAP03, 
MODEL_MP05, MODEL_NS_R1RHO_2SITE, MODEL_NS_R1RHO_3SITE, 
MODEL_NS_R1RHO_3SITE_LINEAR]
+MODEL_LIST_R1RHO_FULL = [MODEL_R2EFF, MODEL_NOREX, MODEL_NOREX_R1RHO, 
MODEL_NOREX_R1RHO_FIT_R1, MODEL_M61, MODEL_M61B, MODEL_DPL94, 
MODEL_DPL94_FIT_R1, MODEL_TP02, MODEL_TAP03, MODEL_MP05, 
MODEL_NS_R1RHO_2SITE, MODEL_NS_R1RHO_3SITE, MODEL_NS_R1RHO_3SITE_LINEAR]
 &quot;&quot;&quot;The list of the R2eff model together with all dispersion models 
specifically for R1rho-type experiments.&quot;&quot;&quot;

-MODEL_LIST_R1RHO_W_R1 = [MODEL_DPL94, MODEL_TP02, MODEL_TAP03, 
MODEL_MP05, MODEL_NS_R1RHO_2SITE, MODEL_NS_R1RHO_3SITE, 
MODEL_NS_R1RHO_3SITE_LINEAR]
+MODEL_LIST_R1RHO_W_R1 = [MODEL_NOREX_R1RHO, MODEL_DPL94, MODEL_TP02, 
MODEL_TAP03, MODEL_MP05, MODEL_NS_R1RHO_2SITE, MODEL_NS_R1RHO_3SITE, 
MODEL_NS_R1RHO_3SITE_LINEAR]
 &quot;&quot;&quot;The list of all dispersion models specifically for R1rho-type 
experiments which use R1 in their equations.&quot;&quot;&quot;

-MODEL_LIST_R1RHO_FIT_R1 = [MODEL_DPL94_FIT_R1]
+MODEL_LIST_R1RHO_FIT_R1 = [MODEL_NOREX_R1RHO_FIT_R1, MODEL_DPL94_FIT_R1]
 &quot;&quot;&quot;The list of all dispersion models specifically for R1rho-type 
experiments which fit R1 in their equations.&quot;&quot;&quot;

 MODEL_LIST_MQ_CPMG = [MODEL_NOREX, MODEL_MMQ_CR72, MODEL_NS_MMQ_2SITE, 
MODEL_NS_MMQ_3SITE, MODEL_NS_MMQ_3SITE_LINEAR]
@@ -245,6 +253,8 @@
 MODEL_DESC = {
     MODEL_R2EFF: MODEL_DESC_R2EFF,
     MODEL_NOREX: MODEL_DESC_NOREX,
+    MODEL_NOREX_R1RHO: MODEL_DESC_NOREX_R1RHO,
+    MODEL_NOREX_R1RHO_FIT_R1: MODEL_DESC_NOREX_R1RHO_FIT_R1,
     MODEL_LM63: MODEL_DESC_LM63,
     MODEL_LM63_3SITE: MODEL_DESC_LM63_3SITE,
     MODEL_CR72: MODEL_DESC_CR72,
@@ -278,6 +288,8 @@
 MODEL_PARAMS = {
     MODEL_R2EFF: MODEL_PARAMS_R2EFF,
     MODEL_NOREX: MODEL_PARAMS_NOREX,
+    MODEL_NOREX_R1RHO: MODEL_PARAMS_NOREX_R1RHO,
+    MODEL_NOREX_R1RHO_FIT_R1: MODEL_PARAMS_NOREX_R1RHO_FIT_R1,
     MODEL_LM63: MODEL_PARAMS_LM63,
     MODEL_LM63_3SITE: MODEL_PARAMS_LM63_3SITE,
     MODEL_CR72: MODEL_PARAMS_CR72,


_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-commits mailing list
relax-commits@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-commits">https://mail.gna.org/listinfo/relax-commits</a>
</pre></blockquote><pre style="margin: 0em;">

_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-devel mailing list
relax-devel@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a>
</pre></blockquote></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00071" href="msg00071.html">Re: r24942 - /branches/R1_fitting/specific_analyses/relax_disp/variables.py</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00081" href="msg00081.html">Re: r24942 - /branches/R1_fitting/specific_analyses/relax_disp/variables.py</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer">You are on the <a href="http://gna.org">Gna!</a> mail server.</div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Mon Aug 18 12:00:13 2014</div>  
</body>
</html>
