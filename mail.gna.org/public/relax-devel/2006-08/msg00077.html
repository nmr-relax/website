<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: RelaxWarnings -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneq.qnhiretarNtznvy.pbz> -->
<!--X-Date: Wed, 16 Aug 2006 19:17:24 +0200 -->
<!--X-Message-Id: 7f080ed10608161016y136083efybb5034dd32ddb5ff@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 7f080ed10608100336r3dc92d80h1ce3251e55b49347@mail.gmail.com -->
<!--X-Reference: 7f080ed10608140727s4ef65461yd336c032f690fc1d@mail.gmail.com -->
<!--X-Reference: 1155569275.28764.654.camel@fbsdpcu021 -->
<!--X-Reference: 7f080ed10608142258t2e4d4c02hf4859c8f29b400c3@mail.gmail.com -->
<!--X-Reference: 1155637306.28764.740.camel@fbsdpcu021 -->
<!--X-Reference: 7f080ed10608160054ta16d3c7mbfd858f61df9ddce@mail.gmail.com -->
<!--X-Reference: 1155722684.28764.797.camel@fbsdpcu021 -->
<!--X-Reference: 7f080ed10608160917g38780203s650432c7112ef866@mail.gmail.com -->
<!--X-Reference: 1155747684.28764.827.camel@fbsdpcu021 -->
<!--X-Reference: 7f080ed10608161015p595f274dl792721dc236695c5@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: RelaxWarnings -- August 16, 2006 - 19:17</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: RelaxWarnings</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00077" class="tabs">Index by Date</a> | <a href="threads.html#00077" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00076.html">Date Prev</a>] [<a href="msg00078.html">Date Next</a>] [<a href="msg00076.html">Thread Prev</a>] [<a href="msg00079.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Chris MacRaild&quot; &lt;c.a.macraild@xxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Thu, 17 Aug 2006 03:16:46 +1000</li>
<li class="menuitem">
<em>Cc</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00077.html">7f080ed10608161016y136083efybb5034dd32ddb5ff@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;<a href="msg00052.html">7f080ed10608100336r3dc92d80h1ce3251e55b49347@mail.gmail.com</a>&gt;	&lt;<a href="msg00066.html">7f080ed10608140727s4ef65461yd336c032f690fc1d@mail.gmail.com</a>&gt;	&lt;<a href="msg00067.html">1155569275.28764.654.camel@fbsdpcu021</a>&gt;	&lt;<a href="msg00068.html">7f080ed10608142258t2e4d4c02hf4859c8f29b400c3@mail.gmail.com</a>&gt;	&lt;<a href="msg00069.html">1155637306.28764.740.camel@fbsdpcu021</a>&gt;	&lt;<a href="msg00070.html">7f080ed10608160054ta16d3c7mbfd858f61df9ddce@mail.gmail.com</a>&gt;	&lt;<a href="msg00071.html">1155722684.28764.797.camel@fbsdpcu021</a>&gt;	&lt;<a href="msg00072.html">7f080ed10608160917g38780203s650432c7112ef866@mail.gmail.com</a>&gt;	&lt;<a href="msg00074.html">1155747684.28764.827.camel@fbsdpcu021</a>&gt;	&lt;<a href="msg00076.html">7f080ed10608161015p595f274dl792721dc236695c5@mail.gmail.com</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on August 16, 2006 - 19:17:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">One more thing, the message argument which will be a string containing
the name of the Warning object can be ignored.</pre><br>
<pre style="margin: 0em;"><br></pre><br>
<tt>On 8/17/06, Edward d'Auvergne &lt;edward.dauvergne@xxxxxxxxx&gt; wrote:
</tt><blockquote class="blockquote"><pre style="margin: 0em;">&gt; &gt; relax&gt; import warnings
&gt; &gt; relax&gt; def format(message, category, filename, lineno):
&gt; &gt; relax|     return &quot;RelaxWarning: %s\n&quot; % message
&gt; &gt; relax|
&gt; &gt; relax&gt; warnings.formatwarning = format
&gt; &gt; relax&gt; warnings.warn('Hello')
&gt; &gt; RelaxWarning: Hello
&gt; &gt; relax&gt; help(warnings.formatwarning)
&gt; &gt; relax&gt; warnings.warn('Hello')
&gt; &gt; relax&gt;
&gt; &gt;
&gt; &gt; Huh???  Where did RelaxWarning disappear to??? Same thing happens if
&gt; &gt; you use the real Python help function on any 'warnings' objects,
&gt; &gt; including itself???  I'm pretty sure this should not happen!
&gt;
&gt; I think the problem is that the default warning behaviour is to print a
&gt; given warning only once from a specific location in the code. Because
&gt; you are working at the interactive prompt, it always looks like the same
&gt; location, so the warning will only be printed once (it has nothing to do
&gt; with help). Try:
&gt;
&gt; relax&gt; import warnings
&gt; relax&gt; warnings.filterwarnings('always')
&gt; relax&gt; def format(message, category, filename, lineno):
&gt; relax|     return &quot;RelaxWarning: %s\n&quot; % message
&gt; relax|
&gt; relax&gt; warnings.formatwarning = format
&gt; relax&gt; warnings.warn('Hello')
&gt; RelaxWarning: Hello
&gt; relax&gt; help(warnings.formatwarning)
&gt; relax&gt; warnings.warn('Hello')
&gt; RelaxWarning: Hello</pre><br>
<pre style="margin: 0em;">Of course!  I should have seen that one.</pre><br>
<pre style="margin: 0em;">&gt; &gt; If there are too many problems caused by bugs in the Python warning
&gt; &gt; system we can write our own warning system in the future.  Anyway,
&gt; &gt; enough bashing of the Python warning system.
&gt; &gt;
&gt; &gt; A problem that needs to be solved is how do we implement specific
&gt; &gt; warnings?  For example if two distant areas of relax test for zero
&gt; &gt; length XH bond vectors, there should be one function which takes the
&gt; &gt; residue number and formats a standard message for that warning.
&gt; &gt; However the 'warn()' function expects a message?  What if we have a
&gt; &gt; class object called RelaxZeroLengthWarning which has a __call__()
&gt; &gt; method which returns the formatted string?  You could then, from
&gt; &gt; within different parts of relax, generate an error by having the code:
&gt; &gt;
&gt; &gt; if len(xh) == 0.0:
&gt; &gt;     warn(RelaxZeroLengthWarning(res))
&gt; &gt;
&gt; &gt; where warn was placed into __builtin__ by relax (see the
&gt; &gt; 'nan_catch_test' branch) and 'res' is the residue number.  There
&gt; &gt; might, however, be a much better way to implement specific warnings.
&gt; &gt; The rest of the system could be setup as in the 'nan_catch_test'
&gt; &gt; branch.
&gt; &gt;
&gt;
&gt; This is a good point. After some head-scratching, I think the 'correct'
&gt; way to do it is to treat each warning category specifically in the
&gt; formatwarning function. So we would have something more like:
&gt;
&gt; def format(message, category, filename, lineno):
&gt;     if issubclass(category, RelaxZeroLengthWarning):
&gt;         message = &quot;Zero length vector at residue %s&quot; % message
&gt;
&gt;     # ...lots more specific warning cases...
&gt;
&gt;     if issubclass(category, BaseWarning):
&gt;         message = &quot;RelaxWarning: %s\n&quot; % message
&gt;
&gt;     return message
&gt;
&gt; warnings.formatwarning = format
&gt;
&gt;
&gt; Then the 'message' for RelaxZeroLengthWarning when we do warn() is just
&gt; the residue, and format() does the rest.</pre><br>
<pre style="margin: 0em;">A number of RelaxErrors take a number of arguments and from my reading
of the docs I would guess that the warning system would assert that
the 'message' argument to 'warn()' must be a string.  How about using
the '__call__()' function to pass in the relevant data to the class
using keywords and then store it within the object.  Then the
subsequently called format function can use the else-if chain to pull
out and format the stored data?</pre><br>
<pre style="margin: 0em;">Edward</pre><br>
</blockquote><pre style="margin: 0em;"><br></pre><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00052" href="msg00052.html">RelaxWarnings and RelaxErrors.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00066" href="msg00066.html">Re: RelaxWarnings and RelaxErrors.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00067" href="msg00067.html">Re: RelaxWarnings and RelaxErrors.</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00068" href="msg00068.html">Re: RelaxWarnings and RelaxErrors.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00069" href="msg00069.html">Re: RelaxWarnings and RelaxErrors.</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00070" href="msg00070.html">Re: RelaxWarnings and RelaxErrors.</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00071" href="msg00071.html">RelaxWarnings</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00072" href="msg00072.html">Re: RelaxWarnings</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00074" href="msg00074.html">Re: RelaxWarnings</a></strong>
<ul><li><em>From:</em> Chris MacRaild</li></ul></li>
<li><strong><a name="00076" href="msg00076.html">Re: RelaxWarnings</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Thu Aug 17 12:40:41 2006</div>  
</body>
</html>
