<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>prompt.structure.Structure</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://nmr-relax.com">relax</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="prompt-module.html">Package&nbsp;prompt</a> ::
        <a href="prompt.structure-module.html">Module&nbsp;structure</a> ::
        Class&nbsp;Structure
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="prompt.structure.Structure-class.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== CLASS DESCRIPTION ==================== -->
<h1 class="epydoc">Class Structure</h1><span class="codelink"><a href="prompt.structure-pysrc.html#Structure">source&nbsp;code</a></span><br /><br />
<!-- ==================== INSTANCE METHODS ==================== -->
<a name="section-InstanceMethods"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Instance Methods</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-InstanceMethods"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
  <td width="15%" align="right" valign="top" class="summary">
    <span class="summary-type">&nbsp;</span>
  </td><td class="summary">
    <span class="summary-sig"><a href="prompt.structure.Structure-class.html#__init__" class="summary-sig-name">__init__</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">relax</span>)</span>
  </td>
</tr>
<tr>
  <td width="15%" align="right" valign="top" class="summary">
    <span class="summary-type">&nbsp;</span>
  </td><td class="summary">
    <span class="summary-sig"><a href="prompt.structure.Structure-class.html#create_diff_tensor_pdb" class="summary-sig-name">create_diff_tensor_pdb</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">run</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">scale</span>=<span class="summary-sig-default">1.8e-6</span>,
        <span class="summary-sig-arg">file</span>=<span class="summary-sig-default">'tensor.pdb'</span>,
        <span class="summary-sig-arg">dir</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">force</span>=<span class="summary-sig-default">0</span>)</span><br />
      Create a PDB file to represent the diffusion tensor.
  </td>
</tr>
<tr>
  <td width="15%" align="right" valign="top" class="summary">
    <span class="summary-type">&nbsp;</span>
  </td><td class="summary">
    <span class="summary-sig"><a href="prompt.structure.Structure-class.html#create_vector_dist" class="summary-sig-name">create_vector_dist</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">run</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">length</span>=<span class="summary-sig-default">2e-9</span>,
        <span class="summary-sig-arg">symmetry</span>=<span class="summary-sig-default">1</span>,
        <span class="summary-sig-arg">file</span>=<span class="summary-sig-default">'XH_dist.pdb'</span>,
        <span class="summary-sig-arg">dir</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">force</span>=<span class="summary-sig-default">0</span>)</span><br />
      Create a PDB file representation of the distribution of XH bond vectors.
  </td>
</tr>
<tr>
  <td width="15%" align="right" valign="top" class="summary">
    <span class="summary-type">&nbsp;</span>
  </td><td class="summary">
    <span class="summary-sig"><a href="prompt.structure.Structure-class.html#read_pdb" class="summary-sig-name">read_pdb</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">run</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">file</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">dir</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">model</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">load_seq</span>=<span class="summary-sig-default">1</span>)</span><br />
      The pdb loading function.
  </td>
</tr>
<tr>
  <td width="15%" align="right" valign="top" class="summary">
    <span class="summary-type">&nbsp;</span>
  </td><td class="summary">
    <span class="summary-sig"><a href="prompt.structure.Structure-class.html#vectors" class="summary-sig-name">vectors</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">run</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">heteronuc</span>=<span class="summary-sig-default">'N'</span>,
        <span class="summary-sig-arg">proton</span>=<span class="summary-sig-default">'H'</span>,
        <span class="summary-sig-arg">res_num</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">res_name</span>=<span class="summary-sig-default">None</span>)</span><br />
      Function for calculating/extracting XH vectors from the structure.
  </td>
</tr>
</table>

<br />
<!-- ==================== METHOD DETAILS ==================== -->
<a name="section-MethodDetails"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Method Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-MethodDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="__init__"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">__init__</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">relax</span>)</span>
    <br /><em class="fname">(Constructor)</em>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="prompt.structure-pysrc.html#Structure.__init__">source&nbsp;code</a></span>&nbsp;
    </td>
  </table>
  
  
  <dl><dt></dt><dd>
  </dd></dl>
</td></tr></table>
</div>
<a name="create_diff_tensor_pdb"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">create_diff_tensor_pdb</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">run</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">scale</span>=<span class="sig-default">1.8e-6</span>,
        <span class="sig-arg">file</span>=<span class="sig-default">'tensor.pdb'</span>,
        <span class="sig-arg">dir</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">force</span>=<span class="sig-default">0</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="prompt.structure-pysrc.html#Structure.create_diff_tensor_pdb">source&nbsp;code</a></span>&nbsp;
    </td>
  </table>
  
  <br /><pre class="literalblock">
Create a PDB file to represent the diffusion tensor.

Keyword Arguments
~~~~~~~~~~~~~~~~~

run:  The run to assign the structure to.

scale:  Value for scaling the diffusion rates.

file:  The name of the PDB file.

dir:  The directory where the file is located.

force:  A flag which, if set to 1, will overwrite the any pre-existing file.


Description
~~~~~~~~~~~

This function creates a PDB file containing an artificial geometric structure to represent
the diffusion tensor.  A structure must have previously been read into relax.  The diffusion
tensor is represented by an ellipsoidal, spheroidal, or spherical geometric object with its
origin located at the centre of mass (of the selected residues).  This diffusion tensor PDB
file can subsequently read into any molecular viewer.

There are four different types of residue within the PDB.  The centre of mass of the
selected residues is represented as a single carbon atom of the residue 'COM'.  The
ellipsoidal geometric shape consists of numerous H atoms of the residue 'TNS'.  The axes
of the tensor, when defined, are presented as the residue 'AXS' and consist of carbon atoms:
one at the centre of mass and one at the end of each eigenvector.  Finally, if Monte Carlo
simulations were run and the diffusion tensor parameters were allowed to vary then there
will be multiple 'SIM' residues, one for each simulation.  These are essentially the same as
the 'AXS' residue, representing the axes of the simulated tensors, and they will appear as a
distribution.

As the Brownian rotational diffusion tensor is a measure of the rate of rotation about
different axes - the larger the geometric object, the faster the diffusion of a molecule.
For example the diffusion tensor of a water molecule is much larger than that of a
macromolecule.

The effective global correlation time experienced by an XH bond vector, not to be confused
with the Lipari and Szabo parameter tau_e, will be approximately proportional to the
component of the diffusion tensor parallel to it.  The approximation is not exact due to the
multiexponential form of the correlation function of Brownian rotational diffusion.  If an
XH bond vector is parallel to the longest axis of the tensor, it will be unaffected by
rotations about that axis, which are the fastest rotations of the molecule, and therefore
its effective global correlation time will be maximal.

To set the size of the diffusion tensor within the PDB frame the unit vectors used to
generate the geometric object are first multiplied by the diffusion tensor (which has the
units of inverse seconds) then by the scaling factor (which has the units of second
Angstroms and has the default value of 1.8e-6 s.Angstrom).  Therefore the rotational
diffusion rate per Angstrom is equal the inverse of the scale value (which defaults to
5.56e5 s^-1.Angstrom^-1).  Using the default scaling value for spherical diffusion, the
correspondence between global correlation time, Diso diffusion rate, and the radius of the
sphere for a number of discrete cases will be:

_________________________________________________
|           |               |                   |
| tm (ns)   | Diso (s^-1)   | Radius (Angstrom) |
|___________|_______________|___________________|
|           |               |                   |
| 1         | 1.67e8        | 300               |
|           |               |                   |
| 3         | 5.56e7        | 100               |
|           |               |                   |
| 10        | 1.67e7        | 30                |
|           |               |                   |
| 30        | 5.56e6        | 10                |
|___________|_______________|___________________|


The scaling value has been fixed to facilitate comparisons within or between publications,
but can be changed to vary the size of the tensor geometric object if necessary.  Reporting
the rotational diffusion rate per Angstrom within figure legends would be useful.

To create the tensor PDB representation, a number of algorithms are utilised.  Firstly the
centre of mass is calculated for the selected residues and is represented in the PDB by a C
atom.  Then the axes of the diffusion are calculated, as unit vectors scaled to the
appropriate length (multiplied by the eigenvalue Dx, Dy, Dz, Dpar, Dper, or Diso as well as
the scale value), and a C atom placed at the position of this vector plus the centre of
mass.  Finally a uniform distribution of vectors on a sphere is generated using spherical
coordinates.  By incrementing the polar angle using an arccos distribution, a radial array
of vectors representing latitude are created while incrementing the azimuthal angle evenly
creates the longitudinal vectors.  These unit vectors, which are distributed within the PDB
frame and are of 1 Angstrom in length, are first rotated into the diffusion frame using a
rotation matrix (the spherical diffusion tensor is not rotated).  Then they are multiplied
by the diffusion tensor matrix to extend the vector out to the correct length, and finally
multiplied by the scale value so that the vectors reasonably superimpose onto the
macromolecular structure.  The last set of algorithms place all this information into a PDB
file.  The distribution of vectors are represented by H atoms and are all connected using
PDB CONECT records.  Each H atom is connected to its two neighbours on the both the
longitude and latitude.  This creates a geometric PDB object with longitudinal and
latitudinal lines.

</pre>
  <dl><dt></dt><dd>
  </dd></dl>
</td></tr></table>
</div>
<a name="create_vector_dist"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">create_vector_dist</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">run</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">length</span>=<span class="sig-default">2e-9</span>,
        <span class="sig-arg">symmetry</span>=<span class="sig-default">1</span>,
        <span class="sig-arg">file</span>=<span class="sig-default">'XH_dist.pdb'</span>,
        <span class="sig-arg">dir</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">force</span>=<span class="sig-default">0</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="prompt.structure-pysrc.html#Structure.create_vector_dist">source&nbsp;code</a></span>&nbsp;
    </td>
  </table>
  
  <br /><pre class="literalblock">
Create a PDB file representation of the distribution of XH bond vectors.

Keyword Arguments
~~~~~~~~~~~~~~~~~

run:  The run to assign the structure to.

length:  The length of the vectors in the PDB representation (meters).

symmetry:  A flag which, if set to 1, will create a second chain with reversed XH bond
    orientations.

file:  The name of the PDB file.

dir:  The directory to place the file into.

force:  A flag which, if set to 1, will overwrite the file if it already exists.


Description
~~~~~~~~~~~

This function creates a PDB file containing an artificial vectors, the length of which
default to the length argument of 20 Angstrom.  A structure must have previously been read
into relax.  The origin of the vector distribution is located at the centre of mass (of the
selected residues).  This vector distribution PDB file can subsequently be read into any
molecular viewer.

Because of the symmetry of the diffusion tensor reversing the orientation of the XH bond
vector has no effect.  Therefore by setting the symmetry flag two chains 'A' and 'B' will
be added to the PDB file whereby chain 'B' is chain 'A' with the XH bonds reversed.

</pre>
  <dl><dt></dt><dd>
  </dd></dl>
</td></tr></table>
</div>
<a name="read_pdb"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">read_pdb</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">run</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">file</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">dir</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">model</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">load_seq</span>=<span class="sig-default">1</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="prompt.structure-pysrc.html#Structure.read_pdb">source&nbsp;code</a></span>&nbsp;
    </td>
  </table>
  
  <br /><pre class="literalblock">
The pdb loading function.

Keyword Arguments
~~~~~~~~~~~~~~~~~

run:  The run to assign the structure to.

file:  The name of the PDB file.

dir:  The directory where the file is located.

model:  The PDB model number.

load_seq:  A flag specifying whether the sequence should be loaded from the PDB file.


Description
~~~~~~~~~~~

To load a specific model from the PDB file, set the model flag to an integer i.  The
structure beginning with the line 'MODEL i' in the PDB file will be loaded.  Otherwise all
structures will be loaded starting from the model number 1.

To load the sequence from the PDB file, set the 'load_seq' flag to 1.  If the sequence has
previously been loaded, then this flag will be ignored.


Example
~~~~~~~

To load all structures from the PDB file 'test.pdb' in the directory '~/pdb' for use in the
model-free analysis run 'm8', type:

relax&gt; structure.read_pdb('m8', 'test.pdb', '~/pdb', 1)
relax&gt; structure.read_pdb(run='m8', file='test.pdb', dir='pdb', model=1)


To load the 10th model from the file 'test.pdb', use:

relax&gt; structure.read_pdb('m1', 'test.pdb', model=10)
relax&gt; structure.read_pdb(run='m1', file='test.pdb', model=10)

</pre>
  <dl><dt></dt><dd>
  </dd></dl>
</td></tr></table>
</div>
<a name="vectors"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">vectors</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">run</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">heteronuc</span>=<span class="sig-default">'N'</span>,
        <span class="sig-arg">proton</span>=<span class="sig-default">'H'</span>,
        <span class="sig-arg">res_num</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">res_name</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="prompt.structure-pysrc.html#Structure.vectors">source&nbsp;code</a></span>&nbsp;
    </td>
  </table>
  
  <br /><pre class="literalblock">
Function for calculating/extracting XH vectors from the structure.

Keyword arguments
~~~~~~~~~~~~~~~~~

run:  The run to assign the vectors to.

heteronuc:  The heteronucleus name as specified in the PDB file.

proton:  The name of the proton as specified in the PDB file.

res_num:  The residue number.

res_name:  The name of the residue.


Description
~~~~~~~~~~~

Once the PDB structures have been loaded, the unit XH bond vectors must be calculated for
the non-spherical diffusion models.  The vectors are calculated using the atomic coordinates
of the atoms specified by the arguments heteronuc and proton.  If more than one model
structure is loaded, the unit XH vectors for each model will be calculated and the final
unit XH vector will be taken as the average.


Example
~~~~~~~

To calculate the XH vectors of the backbone amide nitrogens where in the PDB file the
backbone nitrogen is called 'N' and the attached proton is called 'H', assuming the run
'test', type:

relax&gt; structure.vectors('test')
relax&gt; structure.vectors('test', 'N')
relax&gt; structure.vectors('test', 'N', 'H')
relax&gt; structure.vectors('test', heteronuc='N', proton='H')

If the attached proton is called 'HN', type:

relax&gt; structure.vectors('test', proton='HN')

If you are working with RNA, you can use the residue name identifier to calculate the
vectors for each residue separately.  For example:

relax&gt; structure.vectors('m1', 'N1', 'H1', res_name='G')
relax&gt; structure.vectors('m1', 'N3', 'H3', res_name='U')

</pre>
  <dl><dt></dt><dd>
  </dd></dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://nmr-relax.com">relax</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">Generated by Epydoc
        3.0alpha3 on Mon Feb 19 20:57:44 2007</td>
    <td align="right" class="footer">
      <a href="http://epydoc.sourceforge.net">http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie()
  // -->
</script>
  
</body>
</html>
