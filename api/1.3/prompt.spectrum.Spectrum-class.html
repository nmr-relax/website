<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>prompt.spectrum.Spectrum</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://nmr-relax.com">relax</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="prompt-module.html">Package&nbsp;prompt</a> ::
        <a href="prompt.spectrum-module.html">Module&nbsp;spectrum</a> ::
        Class&nbsp;Spectrum
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="prompt.spectrum.Spectrum-class.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== CLASS DESCRIPTION ==================== -->
<h1 class="epydoc">Class Spectrum</h1><p class="nomargin-top"><span class="codelink"><a href="prompt.spectrum-pysrc.html#Spectrum">source&nbsp;code</a></span></p>
<center>
<center>  <map id="uml_class_diagram_for_prompt_s_3" name="uml_class_diagram_for_prompt_s_3">
<area shape="rect" id="node358" href="prompt.spectrum.Spectrum-class.html#baseplane_rmsd" title="Set the baseplane RMSD of a given spin in a spectrum for error analysis." alt="" coords="17,116,1731,135"/>
<area shape="rect" id="node358" href="prompt.spectrum.Spectrum-class.html#error_analysis" title="Function for performing an error analysis for peak intensities." alt="" coords="17,135,1731,153"/>
<area shape="rect" id="node358" href="prompt.spectrum.Spectrum-class.html#integration_points" title="Set the number of summed points used in volume integration of a given spin in a spectrum." alt="" coords="17,153,1731,172"/>
<area shape="rect" id="node358" href="prompt.spectrum.Spectrum-class.html#read_intensities" title="Function for reading peak intensities from a file for NOE calculations." alt="" coords="17,172,1731,191"/>
<area shape="rect" id="node358" href="prompt.spectrum.Spectrum-class.html#replicated" title="Function for specifying which spectra are replicates." alt="" coords="17,191,1731,209"/>
<area shape="rect" id="node1" href="prompt.spectrum.Spectrum-class.html" title="Class for supporting the input of spectral data." alt="" coords="5,83,1741,215"/>
<area shape="rect" id="node359" href="prompt.base_class.User_fn_class-class.html#__init__" title="Initialise the user function class, compiling the help string." alt="" coords="784,39,965,57"/>
<area shape="rect" id="node2" href="prompt.base_class.User_fn_class-class.html" title="prompt.base_class.User_fn_class" alt="" coords="772,6,977,63"/>
</map>
  <img src="uml_class_diagram_for_prompt_s_3.gif" alt='' usemap="#uml_class_diagram_for_prompt_s_3" ismap="ismap" class="graph-without-title" />
</center>
</center>
<hr />
<pre class="literalblock">
Class for supporting the input of spectral data.

</pre>

<!-- ==================== INSTANCE METHODS ==================== -->
<a name="section-InstanceMethods"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Instance Methods</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-InstanceMethods"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="prompt.spectrum.Spectrum-class.html#baseplane_rmsd" class="summary-sig-name">baseplane_rmsd</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">error</span>=<span class="summary-sig-default">0.0</span>,
        <span class="summary-sig-arg">spectrum_id</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">spin_id</span>=<span class="summary-sig-default">None</span>)</span><br />
      Set the baseplane RMSD of a given spin in a spectrum for error analysis.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="prompt.spectrum-pysrc.html#Spectrum.baseplane_rmsd">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="prompt.spectrum.Spectrum-class.html#error_analysis" class="summary-sig-name">error_analysis</a>(<span class="summary-sig-arg">self</span>)</span><br />
      Function for performing an error analysis for peak intensities.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="prompt.spectrum-pysrc.html#Spectrum.error_analysis">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="prompt.spectrum.Spectrum-class.html#integration_points" class="summary-sig-name">integration_points</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">N</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">spectrum_id</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">spin_id</span>=<span class="summary-sig-default">None</span>)</span><br />
      Set the number of summed points used in volume integration of a given spin in a spectrum.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="prompt.spectrum-pysrc.html#Spectrum.integration_points">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="prompt.spectrum.Spectrum-class.html#read_intensities" class="summary-sig-name">read_intensities</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">file</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">dir</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">spectrum_id</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">heteronuc</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">N</code><code class="variable-quote">'</code></span>,
        <span class="summary-sig-arg">proton</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">HN</code><code class="variable-quote">'</code></span>,
        <span class="summary-sig-arg">int_col</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">int_method</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">height</code><code class="variable-quote">'</code></span>,
        <span class="summary-sig-arg">spin_id_col</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">mol_name_col</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">res_num_col</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">res_name_col</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">spin_num_col</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">spin_name_col</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">sep</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">spin_id</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">ncproc</span>=<span class="summary-sig-default">None</span>)</span><br />
      Function for reading peak intensities from a file for NOE calculations.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="prompt.spectrum-pysrc.html#Spectrum.read_intensities">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="prompt.spectrum.Spectrum-class.html#replicated" class="summary-sig-name">replicated</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">spectrum_ids</span>=<span class="summary-sig-default">None</span>)</span><br />
      Function for specifying which spectra are replicates.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="prompt.spectrum-pysrc.html#Spectrum.replicated">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code><a href="prompt.base_class.User_fn_class-class.html">base_class.User_fn_class</a></code></b>:
      <code><a href="prompt.base_class.User_fn_class-class.html#__init__">__init__</a></code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== METHOD DETAILS ==================== -->
<a name="section-MethodDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Method Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-MethodDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="baseplane_rmsd"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">baseplane_rmsd</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">error</span>=<span class="sig-default">0.0</span>,
        <span class="sig-arg">spectrum_id</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">spin_id</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="prompt.spectrum-pysrc.html#Spectrum.baseplane_rmsd">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
Set the baseplane RMSD of a given spin in a spectrum for error analysis.

Keyword Arguments
~~~~~~~~~~~~~~~~~

error:  The baseplane RMSD error value.

spectrum_id:  The spectrum identification string.

spin_id:  The spin identification string.


Description
~~~~~~~~~~~

The spectrum_id argument identifies the spectrum associated with the error and must
correspond to a previously loaded set of intensities.  If the 'spin_id' argument is left on
the default of None, then the error value for all spins will be set to the supplied value.

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="error_analysis"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">error_analysis</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="prompt.spectrum-pysrc.html#Spectrum.error_analysis">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
Function for performing an error analysis for peak intensities.

Description
~~~~~~~~~~~

This user function must only be called after all peak intensities have been loaded and all
other necessary spectral information set.  This includes the baseplane RMSD and the number
of points used in volume integration, both of which are only used if spectra have not been
replicated.

Six different types of error analysis are supported depending on whether peak heights or
volumes are supplied, whether noise is determined from replicated spectra or the RMSD of the
baseplane noise, and whether all spectra or only a subset have been duplicated.  These are:

____________________________________________________________________________________________
|          |                                        |                                      |
| Int type | Noise source                           | Error scope                          |
|__________|________________________________________|______________________________________|
|          |                                        |                                      |
| Heights  | RMSD baseplane                         | One sigma per peak per spectrum      |
|          |                                        |                                      |
| Heights  | Partial duplicate + variance averaging | One sigma for all peaks, all spectra |
|          |                                        |                                      |
| Heights  | All replicated + variance averaging    | One sigma per replicated spectra set |
|          |                                        |                                      |
| Volumes  | RMSD baseplane                         | One sigma per peak per spectrum      |
|          |                                        |                                      |
| Volumes  | Partial duplicate + variance averaging | One sigma for all peaks, all spectra |
|          |                                        |                                      |
| Volumes  | All replicated + variance averaging    | One sigma per replicated spectra set |
|__________|________________________________________|______________________________________|


Peak heights with baseplane noise RMSD
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

When none of the spectra have been replicated, then the peak height errors are calculated
using the RMSD of the baseplane noise, the value of which is set by the
spectrum.baseplane_rmsd() user function.  This results in a different error per peak per
spectrum.  The standard deviation error measure for the peak height, sigma_I, is set to the
RMSD value.


Peak heights with partially replicated spectra
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

When spectra are replicated, the variance for a single spin at a single replicated spectra
set is calculated by the formula

-----

    sigma^2 =  sum({Ii - Iav}^2) / (n - 1) ,

-----

where sigma^2 is the variance, sigma is the standard deviation, n is the size of the
replicated spectra set with i being the corresponding index, Ii is the peak intensity for
spectrum i, and Iav is the mean over all spectra i.e. the sum of all peak intensities
divided by n.

As the value of n in the above equation is always very low since normally only a couple of
spectra are collected per replicated spectra set, the variance of all spins is averaged for
a single replicated spectra set.  Although this results in all spins having the same error,
the accuracy of the error estimate is significantly improved.

If there are in addition to the replicated spectra loaded peak intensities which only
consist of a single spectrum, i.e. not all spectra are replicated, then the variances of
replicated replicated spectra sets will be averaged.  This will be used for the entire
experiment so that there will be only a single error value for all spins and for all
spectra.


Peak heights with all spectra replicated
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

If all spectra are collected in duplicate (triplicate or higher number of spectra are
supported), the each replicated spectra set will have its own error estimate.  The error
for a single peak is calculated as when partially replicated spectra are collected, and
these are again averaged to give a single error per replicated spectra set.  However as all
replicated spectra sets will have their own error estimate, variance averaging across all
spectra sets will not be performed.


Peak volumes with baseplane noise RMSD
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The method of error analysis when no spectra have been replicated and peak volumes are used
is highly dependent on the integration method.  Many methods simply sum the number of points
within a fixed region, either a box or oval object.  The number of points used, N, must be
specified by another user function in this class.  Then the error is simply given by the sum
of variances:

-----

    sigma_vol^2 = sigma_i^2 * N,

-----

where sigma_vol is the standard deviation of the volume, sigma_i is the standard deviation
of a single point assumed to be equal to the RMSD of the baseplane noise, and N is the total
number of points used in the summation integration method.  For a box integration method,
this converts to the Nicholson, Kay, Baldisseri, Arango, Young, Bax, and Torchia (1992)
Biochemistry, 31: 5253-5263 equation:

-----

    sigma_vol = sigma_i * sqrt(n*m),

-----

where n and m are the dimensions of the box.  Note that a number of programs, for example
peakint (http://hugin.ethz.ch/wuthrich/software/xeasy/xeasy_m15.html) does not use all
points within the box.  And if the number N can not be determined, this category of error
analysis is not possible.

Also note that non-point summation methods, for example when line shape fitting is used to
determine peak volumes, the equations above cannot be used.  Hence again this category of
error analysis cannot be used.  This is the case for one of the three integration methods
used by Sparky (http://www.cgl.ucsf.edu/home/sparky/manual/peaks.html#Integration).  And
if fancy techniques are used, for example as Cara does to deconvolute overlapping peaks
(http://www.cara.ethz.ch/Wiki/Integration), this again makes this error analysis impossible.


Peak volumes with partially replicated spectra
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

When peak volumes are measured by any integration method and a few of the spectra are
replicated, then the intensity errors are calculated identically as described in the 'Peak
heights with partially replicated spectra' section above.


Peak volumes with all spectra replicated
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

With all spectra replicated and again using any integration methodology, the intensity
errors can be calculated as described in the 'Peak heights with all spectra replicated'
section above.

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="integration_points"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">integration_points</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">N</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">spectrum_id</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">spin_id</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="prompt.spectrum-pysrc.html#Spectrum.integration_points">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
Set the number of summed points used in volume integration of a given spin in a spectrum.

Keyword Arguments
~~~~~~~~~~~~~~~~~

N:  The number of points used by the summation volume integration method.

spectrum_id:  The spectrum identification string.

spin_id:  The spin identification string.


Description
~~~~~~~~~~~

For a complete description of which integration methods and how many points N are used for
different integration techniques, please read the spectrum.error_analysis() documentation.

The spectrum_id argument identifies the spectrum associated with the value of N and must
correspond to a previously loaded set of intensities.  If the 'spin_id' argument is left on
the default of None, then the number of summed points for all spins will be set to the
supplied value.

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="read_intensities"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">read_intensities</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">file</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">dir</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">spectrum_id</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">heteronuc</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">N</code><code class="variable-quote">'</code></span>,
        <span class="sig-arg">proton</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">HN</code><code class="variable-quote">'</code></span>,
        <span class="sig-arg">int_col</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">int_method</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">height</code><code class="variable-quote">'</code></span>,
        <span class="sig-arg">spin_id_col</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">mol_name_col</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">res_num_col</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">res_name_col</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">spin_num_col</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">spin_name_col</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">sep</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">spin_id</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">ncproc</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="prompt.spectrum-pysrc.html#Spectrum.read_intensities">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
Function for reading peak intensities from a file for NOE calculations.

Keyword Arguments
~~~~~~~~~~~~~~~~~

file:  The name of the file containing the intensity data.

dir:  The directory where the file is located.

spectrum_id:  The spectrum identification string.

heteronuc:  The name of the heteronucleus as specified in the peak intensity file.

proton:  The name of the proton as specified in the peak intensity file.

int_col:  The column containing the peak intensity data (used by the generic intensity file
    format).

int_method:  The integration method.

spin_id_col:  The spin ID string column used by the generic intensity file format (an
    alternative to the mol, res, and spin name and number columns).

mol_name_col:  The molecule name column used by the generic intensity file format
    (alternative to the spin_id_col).

res_num_col:  The residue number column used by the generic intensity file format
    (alternative to the spin_id_col).

res_name_col:  The residue name column used by the generic intensity file format
    (alternative to the spin_id_col).

spin_num_col:  The spin number column used by the generic intensity file format
    (alternative to the spin_id_col).

spin_name_col:  The spin name column used by the generic intensity file format
    (alternative to the spin_id_col).

sep:  The column separator used by the generic intensity format (the default is white
    space).

spin_id:  The spin ID string used by the generic intensity file format to restrict the
    loading of data to certain spin subsets.

ncproc:  The Bruker specific FID intensity scaling factor.


Description
~~~~~~~~~~~

The peak intensity can either be from peak heights or peak volumes.


The 'spectrum_id' argument is a label which is subsequently utilised by other user
functions.  If this identifier matches that of a previously loaded set of intensities, then
this indicates a replicated spectrum.

The 'heteronuc' and 'proton' arguments should be set respectively to the name of the
heteronucleus and proton in the file.  Only those lines which match these labels will be
used.

The 'int_method' argument is required for the subsequent error analysis.  When peak heights
are measured, this argument should be set to 'height'.  Volume integration methods are a bit
varied and hence two values are accepted.  If the volume integration involves pure point
summation, with no deconvolution algorithms or other methods affecting peak heights, then
the argument should be set to 'point sum'.  All other volume integration methods, e.g. line
shape fitting, the argument should be set to 'other'.

If a series of intensities extracted from Bruker FID files processed in Topspin or XWinNMR
are to be compared, the ncproc parameter may need to be supplied.  This is because this FID
is stored using integer representation and is scaled using ncproc to avoid numerical
truncation artifacts.  If two spectra have significantly different maximal intensities, then
ncproc will be different for both.  The intensity scaling is binary, i.e. 2**ncproc.
Therefore if spectrum A has an ncproc of 6 and and spectrum B a value of 7, then a reference
intensity in B will be double that of A.  Internally, relax stores the intensities scaled by
2**ncproc.


File formats
~~~~~~~~~~~~

The peak list or intensity file will be automatically determined.

Sparky peak list:  The file should be a Sparky peak list saved after typing the command
'lt'.  The default is to assume that columns 0, 1, 2, and 3 (1st, 2nd, 3rd, and 4th) contain
the Sparky assignment, w1, w2, and peak intensity data respectively.  The frequency data w1
and w2 are ignored while the peak intensity data can either be the peak height or volume
displayed by changing the window options.  If the peak intensity data is not within column
3, set the argument 'int_col' to the appropriate value (column numbering starts from 0
rather than 1).

XEasy peak list:  The file should be the saved XEasy text window output of the list peak
entries command, 'tw' followed by 'le'.  As the columns are fixed, the peak intensity column
is hardwired to number 10 (the 11th column) which contains either the peak height or peak
volume data.  Because the columns are fixed, the 'int_col' argument will be ignored.

NMRView:  The file should be a NMRView peak list. The default is to use column 16 (which
contains peak heights) for peak intensities. To use use peak volumes (or evolumes), int_col
must be set to 15.

Generic intensity file:  This is a generic format which can be created by scripting to
support non-supported peak lists.  It should contain in the first few columns enough
information to identify the spin.  This can include columns for the molecule name, residue
number, residue name, spin number, and spin name, with each optional type positioned with
the *name_col and *num_col arguments.  Alternatively a spin ID string column can be used.
The peak intensities can be placed in another column specified by the int_col argument.
Intensities from multiple spectra can be placed into different columns, and these can then
be specified simultaneously by setting the int_col argument to a list of columns.  This list
must be matched by setting the spectrum_id argument to list of the same length.  If columns
are delimited by a character other than whitespace, this can be specified with the sep
argument.  The spin_id argument can be used to restrict the loading to specific spin
subsets.


Examples
~~~~~~~~

To read the reference and saturated spectra peak heights from the Sparky formatted files
'ref.list' and 'sat.list', type:

relax&gt; spectrum.read_intensities(file='ref.list', spectrum_id='ref')
relax&gt; spectrum.read_intensities(file='sat.list', spectrum_id='sat')

To read the reference and saturated spectra peak heights from the XEasy formatted files
'ref.text' and 'sat.text', type:

relax&gt; spectrum.read_intensities(file='ref.text', spectrum_id='ref')
relax&gt; spectrum.read_intensities(file='sat.text', spectrum_id='sat')

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="replicated"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">replicated</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">spectrum_ids</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="prompt.spectrum-pysrc.html#Spectrum.replicated">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
Function for specifying which spectra are replicates.

Keyword Arguments
~~~~~~~~~~~~~~~~~

spectrum_ids:  The list of replicated spectra identification strings.


Description
~~~~~~~~~~~

This user function is used to identify which loaded spectra are replicates of each other.
This is very important for error analysis.


Examples
~~~~~~~~

To specify that the NOE spectra labelled 'ref1', 'ref2', and 'ref3' are the same spectrum
replicated, type one of:

relax&gt; spectrum.replicated(['ref1', 'ref2', 'ref3'])
relax&gt; spectrum.replicated(spectrum_ids=['ref1', 'ref2', 'ref3'])

To specify that the two R2 spectra 'ncyc2' and 'ncyc2b' are the same time point, type:

relax&gt; spectrum.replicated(['ncyc2', 'ncyc2b'])

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://nmr-relax.com">relax</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Fri Dec 31 12:41:33 2010
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
