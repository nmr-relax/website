<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: CST branch -->
<!--X-From-R13: Bniry Ynqrenirx <cniry.xnqrenirxNtznvy.pbz> -->
<!--X-Date: Fri, 25 Feb 2011 18:10:04 +0100 -->
<!--X-Message-Id: AANLkTim1gTBVKDQPK=+aM1SHnuF7ZyKQTUzjpqBMt4xo@mail.gmail.com -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: p2l6052a51004080823g94a64268lf8af8d3e332c2a03@mail.gmail.com -->
<!--X-Reference: j2i7f080ed11004120000r80bba9bch9556be67b0c1707@mail.gmail.com -->
<!--X-Reference: g2v6052a51004131048sb5c01509sfc9a77045ad33310@mail.gmail.com -->
<!--X-Reference: r2g7f080ed11004131113mb209905eh63ff1eb61c171fee@mail.gmail.com -->
<!--X-Reference: l2q6052a51004301221h9ad09886ha016465129beb516@mail.gmail.com -->
<!--X-Reference: g2m7f080ed11005050153y2ad8b4bfjb4eb8191b0efd0cc@mail.gmail.com -->
<!--X-Reference: AANLkTin4nzkkOCxs94vUKCpT00R7ak22gLaL5rK&#45;VjPN@mail.gmail.com -->
<!--X-Reference: AANLkTinF4yNXoJQS&#45;rd81VBi3keRURUNeb&#45;_GdkxqqsG@mail.gmail.com -->
<!--X-Reference: AANLkTinibyBQvsoG1&#45;0vmzOXFmRJxD95VMF3eGxzSMMB@mail.gmail.com -->
<!--X-Reference: AANLkTimFT0&#45;Kbgdz_U5LeOW5Ln22mPBZBC8FL68n6CeF@mail.gmail.com -->
<!--X-Reference: AANLkTikhknBoHTc7B7GCRULkrEnxSx+PpqPP=x6KrDOH@mail.gmail.com -->
<!--X-Reference: AANLkTim0B&#45;E6kMW9Nn47o+u+atxrm38540u1Xhaoe6j0@mail.gmail.com -->
<!--X-Reference: AANLkTi=m5S08Nd1F5VDnMGTOu2s+j2Euz1t&#45;ytw0zOAf@mail.gmail.com -->
<!--X-Reference: AANLkTinxUWLu2N19dc3eaPgh22igv_SGy=6qmVnJN=Qj@mail.gmail.com -->
<!--X-Reference: AANLkTik0K3B7huKE8hJtAkXL_yzJmNa9BFxfczu8Sfx9@mail.gmail.com -->
<!--X-Reference: AANLkTin1JfUtMoVqR4c&#45;5dRHTf58N&#45;FAcv4_bc=LpH2b@mail.gmail.com -->
<!--X-Reference: AANLkTimBsSm504qysJd8&#45;e0O_thUdcwvciKrNhMTdoQW@mail.gmail.com -->
<!--X-Reference: AANLkTikf&#45;g23EPV+R2&#45;7inSpXbT5fqv5vDO8nL+DZrwA@mail.gmail.com -->
<!--X-Reference: AANLkTikNh5FTMmeQPqkSiX8ieG5oUw5UcuG83k8PeAiM@mail.gmail.com -->
<!--X-Reference: AANLkTimADCpNAJG4Pg02_UukH5hFW5eQfr&#45;SymzqXrc=@mail.gmail.com -->
<!--X-Reference: AANLkTi=8_288HiMhVQDwpFUCqMp+aBotECez44s44q7z@mail.gmail.com -->
<!--X-Reference: AANLkTi=vSTA2B&#45;jpTzShJab84W=&#45;z1YBzvhW10wTXg_P@mail.gmail.com -->
<!--X-Reference: AANLkTikXiEtqtDWOycdJdyYSG+KfxAARiXhtDwrQm_v+@mail.gmail.com -->
<!--X-Reference: AANLkTinWS1m+j069Y+sTXrae&#45;J5DamkkNTp&#45;Wx8u7OTX@mail.gmail.com -->
<!--X-Reference: AANLkTinNsF7fA3Va=&#45;63bYBE3EoOeZ21OOO8ZYunU0uR@mail.gmail.com -->
<!--X-Reference: AANLkTinw8sg3staDqr+=mBGqLgB0joQwKzKbFNGY_5sF@mail.gmail.com -->
<!--X-Reference: AANLkTi=aZJDUcj0+p_0Or_P1v3xwSvk=7=s=+DjHFRcA@mail.gmail.com -->
<!--X-Reference: AANLkTinB0kczjTRe5etQtviQ0p9sxu&#45;fmeh3FJ&#45;Lx6Pg@mail.gmail.com -->
<!--X-Reference: AANLkTikwqUH6Z&#45;NmxNmj02ysSaYYAQ_cuS5&#45;kJ6K4U5u@mail.gmail.com -->
<!--X-Reference: AANLkTikZXALuxeob=_YvJjE5&#45;ZyRrLTNqG&#45;wTf_nxgqf@mail.gmail.com -->
<!--X-Reference: AANLkTi=o2jzDfj+Y=WMMBTL=YpOT++n2X0sN=G4_S25+@mail.gmail.com -->
<!--X-Reference: AANLkTimthyxNok+Fsv94fnF8JVdia6VXJ6M0sDQYAAzT@mail.gmail.com -->
<!--X-Reference: AANLkTinydi7mCO0EeWvGOOyOw1a_h3f3618tC_+9FOF5@mail.gmail.com -->
<!--X-Reference: AANLkTimyoJqYWVk8Y7x3Y5UDWr_GaMa_dDVJ9492OEht@mail.gmail.com -->
<!--X-Reference: AANLkTi=DQ9KGP+e0ONhZ66XhSzKhuQzFoQcQNwXnVsgG@mail.gmail.com -->
<!--X-Reference: AANLkTind0EOBhSi_G=M_+LVY_WmLC=03f0&#45;TMrvzs6zs@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: CST branch -- February 25, 2011 - 18:10</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: CST branch</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00081" class="tabs">Index by Date</a> | <a href="threads.html#00081" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00080.html">Date Prev</a>] [<a href="msg00082.html">Date Next</a>] [<a href="msg00076.html">Thread Prev</a>] [<a href="msg00082.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: &quot;Edward d'Auvergne&quot; &lt;edward@xxxxxxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Fri, 25 Feb 2011 18:09:33 +0100</li>
<li class="menuitem">
<em>Cc</em>: relax-devel@xxxxxxx</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;	h=domainkey-signature:mime-version:in-reply-to:references:date	:message-id:subject:from:to:cc:content-type;	bh=HQ47/8u4jGl3mxMX2uv8GmjsLN+wiYsIJHS5cMfyW48=;	b=vEWVdu5FYX8EwMy/So2phjparYj/L1j2vFji6YpTSdS1pa+BXy2tjvNVnlRqiBcS2g	vlG0kxie60ZmnGh33iMAEgKqyTP1BVPa8reVcDB0WgTIGKOCf9TCFYkdcAqFFePTLqNj	DL0riTkBeRJYsGTkijEfqpQqnB1DDMD1CI6ew=</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00081.html">AANLkTim1gTBVKDQPK=+aM1SHnuF7ZyKQTUzjpqBMt4xo@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;p2l6052a51004080823g94a64268lf8af8d3e332c2a03@xxxxxxxxxxxxxx&gt;	&lt;j2i7f080ed11004120000r80bba9bch9556be67b0c1707@xxxxxxxxxxxxxx&gt;	&lt;g2v6052a51004131048sb5c01509sfc9a77045ad33310@xxxxxxxxxxxxxx&gt;	&lt;r2g7f080ed11004131113mb209905eh63ff1eb61c171fee@xxxxxxxxxxxxxx&gt;	&lt;l2q6052a51004301221h9ad09886ha016465129beb516@xxxxxxxxxxxxxx&gt;	&lt;g2m7f080ed11005050153y2ad8b4bfjb4eb8191b0efd0cc@xxxxxxxxxxxxxx&gt;	&lt;AANLkTin4nzkkOCxs94vUKCpT00R7ak22gLaL5rK-VjPN@xxxxxxxxxxxxxx&gt;	&lt;AANLkTinF4yNXoJQS-rd81VBi3keRURUNeb-_GdkxqqsG@xxxxxxxxxxxxxx&gt;	&lt;AANLkTinibyBQvsoG1-0vmzOXFmRJxD95VMF3eGxzSMMB@xxxxxxxxxxxxxx&gt;	&lt;AANLkTimFT0-Kbgdz_U5LeOW5Ln22mPBZBC8FL68n6CeF@xxxxxxxxxxxxxx&gt;	&lt;AANLkTikhknBoHTc7B7GCRULkrEnxSx+PpqPP=x6KrDOH@xxxxxxxxxxxxxx&gt;	&lt;AANLkTim0B-E6kMW9Nn47o+u+atxrm38540u1Xhaoe6j0@xxxxxxxxxxxxxx&gt;	&lt;AANLkTi=m5S08Nd1F5VDnMGTOu2s+j2Euz1t-ytw0zOAf@xxxxxxxxxxxxxx&gt;	&lt;AANLkTinxUWLu2N19dc3eaPgh22igv_SGy=6qmVnJN=Qj@xxxxxxxxxxxxxx&gt;	&lt;AANLkTik0K3B7huKE8hJtAkXL_yzJmNa9BFxfczu8Sfx9@xxxxxxxxxxxxxx&gt;	&lt;AANLkTin1JfUtMoVqR4c-5dRHTf58N-FAcv4_bc=LpH2b@xxxxxxxxxxxxxx&gt;	&lt;AANLkTimBsSm504qysJd8-e0O_thUdcwvciKrNhMTdoQW@xxxxxxxxxxxxxx&gt;	&lt;AANLkTikf-g23EPV+R2-7inSpXbT5fqv5vDO8nL+DZrwA@xxxxxxxxxxxxxx&gt;	&lt;AANLkTikNh5FTMmeQPqkSiX8ieG5oUw5UcuG83k8PeAiM@xxxxxxxxxxxxxx&gt;	&lt;AANLkTimADCpNAJG4Pg02_UukH5hFW5eQfr-SymzqXrc=@xxxxxxxxxxxxxx&gt;	&lt;AANLkTi=8_288HiMhVQDwpFUCqMp+aBotECez44s44q7z@xxxxxxxxxxxxxx&gt;	&lt;AANLkTi=vSTA2B-jpTzShJab84W=-z1YBzvhW10wTXg_P@xxxxxxxxxxxxxx&gt;	&lt;AANLkTikXiEtqtDWOycdJdyYSG+KfxAARiXhtDwrQm_v+@xxxxxxxxxxxxxx&gt;	&lt;AANLkTinWS1m+j069Y+sTXrae-J5DamkkNTp-Wx8u7OTX@xxxxxxxxxxxxxx&gt;	&lt;AANLkTinNsF7fA3Va=-63bYBE3EoOeZ21OOO8ZYunU0uR@xxxxxxxxxxxxxx&gt;	&lt;AANLkTinw8sg3staDqr+=mBGqLgB0joQwKzKbFNGY_5sF@xxxxxxxxxxxxxx&gt;	&lt;AANLkTi=aZJDUcj0+p_0Or_P1v3xwSvk=7=s=+DjHFRcA@xxxxxxxxxxxxxx&gt;	&lt;AANLkTinB0kczjTRe5etQtviQ0p9sxu-fmeh3FJ-Lx6Pg@xxxxxxxxxxxxxx&gt;	&lt;AANLkTikwqUH6Z-NmxNmj02ysSaYYAQ_cuS5-kJ6K4U5u@xxxxxxxxxxxxxx&gt;	&lt;AANLkTikZXALuxeob=_YvJjE5-ZyRrLTNqG-wTf_nxgqf@xxxxxxxxxxxxxx&gt;	&lt;AANLkTi=o2jzDfj+Y=WMMBTL=YpOT++n2X0sN=G4_S25+@xxxxxxxxxxxxxx&gt;	&lt;AANLkTimthyxNok+Fsv94fnF8JVdia6VXJ6M0sDQYAAzT@xxxxxxxxxxxxxx&gt;	&lt;AANLkTinydi7mCO0EeWvGOOyOw1a_h3f3618tC_+9FOF5@xxxxxxxxxxxxxx&gt;	&lt;AANLkTimyoJqYWVk8Y7x3Y5UDWr_GaMa_dDVJ9492OEht@xxxxxxxxxxxxxx&gt;	&lt;AANLkTi=DQ9KGP+e0ONhZ66XhSzKhuQzFoQcQNwXnVsgG@xxxxxxxxxxxxxx&gt;	&lt;AANLkTind0EOBhSi_G=M_+LVY_WmLC=03f0-TMrvzs6zs@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Pavel Kaderavek</strong> on February 25, 2011 - 18:10:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
This change is related to the task #6397 (<a rel="nofollow" href="https://gna.org/task/?6397" target="_blank">https://gna.org/task/?6397</a>)<br><br>kada _at_ chemi _dot_ muni _dot_ cz<br><br><a rel="nofollow" href="https://mail.gna.org/public/relax-devel/2011-02/msg00076.html">https://mail.gna.org/public/relax-devel/2011-02/msg00076.html</a><br>
<a rel="nofollow" href="https://gna.org/support/download.php?file_id=12556">https://gna.org/support/download.php?file_id=12556</a><br><br>This
patch
includes change in  func_mf, func_local_tm, func_diff, func_all,
dfunc_mf, dfunc_local_tm, dfunc_diff, dfunc_all, d2func_mf,
d2func_local_tm, d2func_diff, d2func_all functions of class Mf in a
file
maths_fns/mf.py. The functions were modified in order to handle data for
more
interactions. <br>Due to the equality of (d,d2)ri and (d,d2)ri_prime variables, the (d,d2)ri_prime were replaced by (d,d2)ri and the equality was removed. Moreover, (d,d2)ri was redefined as a cumulative sum of individual interaction contributions to the total relaxation rate or corresponding derivatives. <br>
 <br><br><div class="gmail_quote">On 24 February 2011 12:26, Edward d&#39;Auvergne <span dir="ltr">&lt;<a rel="nofollow" href="mailto:edward@xxxxxxxxxxxxx">edward@xxxxxxxxxxxxx</a>&gt;</span> wrote:<br><blockquote class="gmail_quote" style="border-left: 1px solid rgb(204, 204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;">
Hi,<br>
<br>
Please see below:<br>
<div class="im"><br>
<br>
On 24 February 2011 10:02, Pavel Kaderavek &lt;<a rel="nofollow" href="mailto:pavel.kaderavek@xxxxxxxxx">pavel.kaderavek@xxxxxxxxx</a>&gt; wrote:<br>
&gt; Hi,<br>
&gt;<br>
</div><div class="im">&gt; We realized a problem during the preparation of the following patch.<br>
&gt; Currently, it is impossible to initialize variables in the originally<br>
&gt; suggested way:<br>
&gt;<br>
&gt; data = "">
&gt; data.ri_prime = 0.0<br>
&gt;<br>
&gt; in the function func_mf (maths_fns/mf.py) and other similar functions<br>
&gt; (func_local_tm, func_diff, func_all, and their equivalents for a first and<br>
&gt; second derivatives).<br>
<br>
</div>Ah, yes.  &#39;data&#39; here is a list rather than a container, so you can&#39;t<br>
do this.  If you like, what I can do is create a special list-like<br>
object for this.  The you can access list elements, but also place<br>
variables inside it.<br>
<br>
The other problem is that ri_prime returned by<br>
maths_fns.ri_prime.func_ri_prime() is not a number but a numpy array.<br>
Its dimensions are Nx1, where N is the number of relaxation data<br>
points.  So the initialisation will have to be at the very start<br>
rather than in the func_mf() methods, and it needs to be initialised<br>
to the correct numpy object using something like &#39;zeros(num_ri[i],<br>
float64)&#39;.  The dri_prime, d2ri_prime, ri, dri, and d2ri prime will<br>
have similar problems.<br>
<br>
I would suggest that &#39;ri_prime&#39; does not need to be summed, but only<br>
&#39;ri&#39;.  Or am I missing something?  The difference between ri and<br>
ri_prime is that ri contains the steady-state NOE whereas ri_prime<br>
contains sigma_NOE.  Do we need to store and sum ri_prime at all?<br>
<div class="im"><br>
<br>
&gt; It is not possible because of the approved changes of __init__ function in<br>
&gt; the class Mf (file maths_fns/mf.py). The array used to store data is created<br>
&gt; in the following way:<br>
&gt;<br>
&gt;         self.data = "">
&gt;         for i in xrange(self.num_spins):<br>
&gt;             ...<br>
&gt;             self.data.append([])<br>
&gt;             ...<br>
&gt;             # Loop over the relaxation interactions.<br>
&gt;             for j in xrange(self.num_interactions[i]):<br>
&gt;                 self.data[i].append(Data()) # This is a list dedicated for<br>
&gt; the storage of interaction specific parameters (i.e. type of interaction,<br>
&gt; internuclei distance, ...)<br>
&gt;                 self.data[i][j].interactions=interactions[i][j]<br>
&gt;<br>
&gt; self.data[i][j].internuclei_distance=internuclei_distance[i][j]<br>
&gt;                 ...<br>
&gt;<br>
&gt;<br>
&gt; Thus, the list for a storage of spin specific data does not exist and the<br>
&gt; suggested variable location does not exist:<br>
&gt; self.data[0].ri_prime<br>
<br>
</div>This can be created, if I make this special Python list-like object.<br>
There is already one special object, the Data class at the very end of<br>
the file.  I can create a list-like object here as well, and<br>
initialise each spin object to this.  Ok, I&#39;ve just added this code in<br>
r12618.  This should fix the problem and not cause too many problems<br>
with your current code.<br>
<div class="im"><br>
<br>
&gt; We found some possible ways to solve the problem. However we do not think,<br>
&gt; they are ideal.<br>
&gt; First, we can add for each spin a new list except those which store the<br>
&gt; interaction specific data. Data_spin list would be at the beginning of the<br>
&gt; array and therefore every loop over interactions in the code has to keep it<br>
&gt; in mind and start from index 1 not 0 to avoid Data_spin list.<br>
&gt;<br>
&gt; The second possibility is based on the idea to declare for each spin a class<br>
&gt; Spin_data. The Spin_data would contain all spin specific variables<br>
&gt; (ri_prime, chi2, ...) and also a class Data which would contain interaction<br>
&gt; specific data.<br>
&gt;<br>
&gt; What do you think about these suggestions? We will be glad for any better<br>
&gt; suggestion, than ours.<br>
<br>
</div>I have taken your second idea, but it is inbuilt into the self.data[i]<br>
structure itself rather than a separate object inside self.data.  I<br>
hope this solution will be ok.<br>
<br>
Cheers,<br>
<font color="#888888"><br>
Edward<br>
</font></blockquote></div><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00082" href="msg00082.html">Re: CST branch</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00047" href="msg00047.html">Re: CST branch</a></strong>
<ul><li><em>From:</em> Pavel Kaderavek</li></ul></li>
<li><strong><a name="00052" href="msg00052.html">Re: CST branch</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00071" href="msg00071.html">Re: CST branch</a></strong>
<ul><li><em>From:</em> Pavel Kaderavek</li></ul></li>
<li><strong><a name="00076" href="msg00076.html">Re: CST branch</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Fri Feb 25 18:20:13 2011</div>  
</body>
</html>
