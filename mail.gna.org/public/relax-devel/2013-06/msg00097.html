<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: [bug #20821] Optimisation failure / round error on windows 64 bit -->
<!--X-From-R13: "Sqjneq q'Ohiretar" <rqjneqNaze&#45;erynk.pbz> -->
<!--X-Date: Tue, 18 Jun 2013 19:07:18 +0200 -->
<!--X-Message-Id: CAED9pY&#45;6zmEdHfQT6KUKPLuwEMuCxoYH9MR=9um+zQBOzBhGHQ@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20130516&#45;220427.sv20529.24009@gna.org -->
<!--X-Reference: 20130517&#45;081119.sv2782.89797@gna.org -->
<!--X-Reference: 20130618&#45;160441.sv20529.22737@gna.org -->
<!--X-Reference: CAED9pY__dgZvY0+KPH3R4yiLG4Xehiz4k6eFSdBvBNRhEqaP8w@mail.gmail.com -->
<!--X-Reference: CA+CBx2NChCA4d8o8TBx_pc9JSnGxCTnFqWaUMSB1FLfTSgei6g@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [bug #20821] Optimisation failure / round error on windows 64 bit -- June 18, 2013 - 19:07</title>
<link rel="stylesheet" type="text/css" href="/mail.gna.org/archives-color-gna.css"> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<h2><img src="/mail.gna.org/images/mail.orig.png" width="48" height="48"
alt="mail" class="pageicon" />Re: [bug #20821] Optimisation failure / round error on windows 64 bit</h2>
<br />
<div class="topmenu">
<a href="../" class="tabs">Others Months</a> | <a href="index.html#00097" class="tabs">Index by Date</a> | <a href="threads.html#00097" class="tabs">Thread Index</a><br />
<span class="smaller">&gt;&gt;&nbsp;&nbsp;
[<a href="msg00096.html">Date Prev</a>] [<a href="msg00098.html">Date Next</a>] [<a href="msg00096.html">Thread Prev</a>] [<a href="msg00102.html">Thread Next</a>]
</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h3><a name="header" href="#header">Header</a></h3>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul class="headdata">
<li class="menuitem">
<em>To</em>: Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxx&gt;</li>
<li class="menuitem">
<em>Date</em>: Tue, 18 Jun 2013 19:06:47 +0200</li>
<li class="menuitem">
<em>Cc</em>: &quot;relax-devel@xxxxxxx&quot; &lt;relax-devel@xxxxxxx&gt;</li>
<li class="menuitem">
<em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113;	h=mime-version:sender:in-reply-to:references:date	:x-google-sender-auth:message-id:subject:from:to:cc:content-type	:content-transfer-encoding;	bh=OGNZrrN2tr366WiPncoIsD6HMOkkNTGAUYXuydu93sw=;	b=JthALJrNEWecTwzLFDCZo+NZsQxmkJKcvkq2ZAS8KLb4rmtXQZKwas9XmJMSp4bdUR	bI/qPbQRFUqPXuv4uq5FBshYeer3rglwe1+c4rQaiQqnlmg0TzDD4/BLnjw05fBiIWsz	yXy/z24zOYRRjfVEmkoNCJBt53BGmMMNOeGL6f7EEgfqMxNtVPKecYeparU1JXIc99uK	fzMp0jMaqc9UMURSuP/IimIm9XiPgOvZGRK/Zm9eYHfJ2jI1whuHfUNNleaVliZyyBwZ	O63ci8NcIdtIIJuQibAgq2U73qM4vtAizbGV+XPdsYaykv3C77JWrUIfiP7BnoDq+PmL	KT/g==</li>
<li class="menuitem">
<em>Message-id</em>: &lt;<a href="msg00097.html">CAED9pY-6zmEdHfQT6KUKPLuwEMuCxoYH9MR=9um+zQBOzBhGHQ@mail.gmail.com</a>&gt;</li>
<li class="menuitem">
<em>References</em>: &lt;20130516-220427.sv20529.24009@xxxxxxx&gt;	&lt;20130517-081119.sv2782.89797@xxxxxxx&gt;	&lt;20130618-160441.sv20529.22737@xxxxxxx&gt;	&lt;CAED9pY__dgZvY0+KPH3R4yiLG4Xehiz4k6eFSdBvBNRhEqaP8w@xxxxxxxxxxxxxx&gt;	&lt;CA+CBx2NChCA4d8o8TBx_pc9JSnGxCTnFqWaUMSB1FLfTSgei6g@xxxxxxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div><!-- end headdata -->
<br />
<h3><a name="content" href="#content">Content</a></h3>
<div class="postedby">Posted by <strong>Edward d'Auvergne</strong> on June 18, 2013 - 19:07:</div>
<div class="msgdata">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Exactly, that is the solution!  I've noticed in general that MS
Windows has roughly the same precision as the other systems.  You can
see that in the comments of the other tests.  I also do not see this
precision failure on 32-bit Windows 2000 or 64-bit Windows Vista and
7.  Why your specific system is 4 orders of magnitude less precise is
completely unclear to me.  Maybe it is the use of the EPD distribution
(<a  rel="nofollow" href="https://www.enthought.com/products/epd/">https://www.enthought.com/products/epd/</a>), as this is the biggest
difference with the systems.  I really don't know.  But in any case,
the results are precise enough for any analysis of real data.

Regards,

Edward




On 18 June 2013 18:42, Troels Emtekær Linnet &lt;tlinnet@xxxxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Allright.

The problem lies in:
test_opt_constr_cd_mt_S2_0_970_te_2048_Rex_0_149

From comments:
32-bit i686 Linux. s2                    = 0.9700000000219662
64-bit x86_64 Linux. s2              = 0.9700000000219674
32-bit powerpc Darwin  S2        = 0.9700000000219674
64-bit i386 Darwin                      = 0.9700000000219674

Matched value                            = 0.9700000000219674

windows 7                                    = 0.9700002183674102

The assert equal as standard goes to 7 decimals.
</pre><blockquote class="blockquote"><blockquote class="blockquote"><blockquote class="blockquote"><pre style="margin: 0em;">a = 0.9700000000219674
b = 0.9700002183674102
print a-b
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">-2.18345442837e-07

So, if the solution would be lower the assert equal to 6 decimal, it
will go fine.
Is that the solution?

And I do not understand why windows go so crazy wrong, compare to the
other systems.

System:           Windows
Release:          7
Version:          6.1.7601
Win32 version:    7 6.1.7601 SP1 Multiprocessor Free
Distribution:
Architecture:     64bit WindowsPE
Machine:          AMD64
Processor:        Intel64 Family 6 Model 37 Stepping 2, GenuineIntel
Python version:   2.7.5
Numpy version:    1.7.1
Libc version:

s2:                         0.9700002183674102
te (ps):                        2048.015293187
rex:                       0.14899473115727899
chi2:                   2.3195994119090742e-10
iter:                                      116
f_count:                                   411
g_count:                                   411
h_count:                                     0
warning:                                  None


Troels Emtekær Linnet


2013/6/18 Edward d'Auvergne &lt;edward@xxxxxxxxxxxxx&gt;
</pre><blockquote class="blockquote"><pre style="margin: 0em;">

Yes, the problem is a precision issue.  Your system ends up with
slightly different results from the perfect synthetic values.  This is
not an issue though, as 0.9700002183674102 is pretty much the same as
0.970.  Note the comments in that system test - it would be useful to
add an entry for the results from your system.  These comments are
used to track and act as a record of how optimisation is different on
each system.  It is useful to see which systems are not so accurate.
This is not the fix though.

The problem is within the value_test() method.  Look carefully at how
the precision is set to 5 decimal places for model-free order
parameters and 4 for correlation times.  Then look at which parameter
is failing.  I'll give you another hint if this is not enough.

Regards,

Edward



On 18 June 2013 18:04, Troels E. Linnet
&lt;NO-REPLY.INVALID-ADDRESS@xxxxxxx&gt; wrote:
</pre><blockquote class="blockquote"><pre style="margin: 0em;">Follow-up Comment #1, bug #20821 (project relax):

It seems from the log file, that the precision on the windows compiled 
system
is bad.

The true value should be:
S2=0.970, te=2048, Rex=0.149

Windows compiled minimise to: s2 0.9700002183674102
which is bad.

But, I don't know where to start?
Is it something with the compilation?
This is 64 bit compiled, and not 32 bit compiled.

Log file is provided.



(file #18115)
    _______________________________________________________

Additional Item Attachment:

File name: 20130618_relax_disp_testsuite.txt Size:273 KB


    _______________________________________________________

Reply to this item at:

  &lt;<a  rel="nofollow" href="http://gna.org/bugs/?20821">http://gna.org/bugs/?20821</a>&gt;

_______________________________________________
  Message sent via/by Gna!
  <a  rel="nofollow" href="http://gna.org/">http://gna.org/</a>


_______________________________________________
relax (<a  rel="nofollow" href="http://www.nmr-relax.com">http://www.nmr-relax.com</a>)

This is the relax-devel mailing list
relax-devel@xxxxxxx

To unsubscribe from this list, get a password
reminder, or change your subscription options,
visit the list information page at
<a  rel="nofollow" href="https://mail.gna.org/listinfo/relax-devel">https://mail.gna.org/listinfo/relax-devel</a>
</pre></blockquote></blockquote></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div><!-- end msgdata -->
<br />
<h3><a name="related" href="#related">Related Messages</a></h3>
<div class="relateddata">
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00102" href="msg00102.html">Re: [bug #20821] Optimisation failure / round error on windows 64 bit</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00094" href="msg00094.html">[bug #20821] Optimisation failure / round error on windows 64 bit</a></strong>
<ul><li><em>From:</em> Troels E. Linnet</li></ul></li>
<li><strong><a name="00095" href="msg00095.html">Re: [bug #20821] Optimisation failure / round error on windows 64 bit</a></strong>
<ul><li><em>From:</em> Edward d'Auvergne</li></ul></li>
<li><strong><a name="00096" href="msg00096.html">Re: [bug #20821] Optimisation failure / round error on windows 64 bit</a></strong>
<ul><li><em>From:</em> Troels Emtekær Linnet</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
</div><!-- end relateddata -->
<!-- NoBotLinksApartFromRelatedMessages -->

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<div class="footer"></div><br />
<div class="right">Powered by <a href="http://www.mhonarc.org">MHonArc</a>, Updated Wed Jun 19 08:00:10 2013</div>  
</body>
</html>
